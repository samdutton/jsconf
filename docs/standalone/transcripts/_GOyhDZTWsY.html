<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="JSConf transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>_GOyhDZTWsY</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/_GOyhDZTWsY?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="0" data-end="4.04">um so yeah hi my name is Adam Brett's</span> <span data-start="4.04" data-end="7.95">that's a or b on github and a or b on</span> <span data-start="7.95" data-end="11.16">IRC and the happy channel and Adam</span> <span data-start="11.16" data-end="14.13">Brett's on the Twitter so I work at</span> <span data-start="14.13" data-end="16.65">Walmart on the open source team believe</span> <span data-start="16.65" data-end="19.439">it or not that is a real thing and so I</span> <span data-start="19.439" data-end="22.5">pretty much spent my day working on the</span> <span data-start="22.5" data-end="24.869">happy basically universe and everything</span> <span data-start="24.869" data-end="27.48">that sort of goes along with it if you</span> <span data-start="27.48" data-end="30.689">follow any of the activity stream for</span> <span data-start="30.689" data-end="32.16">that you'll notice I do a lot of work on</span> <span data-start="32.16" data-end="36.059">the good ops monitoring plug-in and sort</span> <span data-start="36.059" data-end="38.55">of the the pieces that make that up so</span> <span data-start="38.55" data-end="40.02">as you can probably guess I'm here to</span> <span data-start="40.02" data-end="44.1">talk to you about lab so lab is the</span> <span data-start="44.1" data-end="47.07">testing framework that we use at walmart</span> <span data-start="47.07" data-end="49.969">we use it both internally and externally</span> <span data-start="49.969" data-end="53.82">for the entire happy j/s stack before i</span> <span data-start="53.82" data-end="57.05">get too far into this all the examples</span> <span data-start="57.05" data-end="60.18">are for lab version 5 so if you're using</span> <span data-start="60.18" data-end="63.3">an older version yeah you're encouraged</span> <span data-start="63.3" data-end="67.32">to move to five there's read me Thanks</span> <span data-start="67.32" data-end="69.75">there's read Me's and sort of help as to</span> <span data-start="69.75" data-end="71.49">how to do that it's it's pretty easy</span> <span data-start="71.49" data-end="75.27">though so today I'm going to talk</span> <span data-start="75.27" data-end="78.27">basically about three things why use lab</span> <span data-start="78.27" data-end="82.049">at all talk about a new assertion module</span> <span data-start="82.049" data-end="84.57">named code and then I'm going to give</span> <span data-start="84.57" data-end="90.78">you a pep talk so why use lab three</span> <span data-start="90.78" data-end="93.42">things three main points really it's</span> <span data-start="93.42" data-end="97.02">been battle-tested it's easy to use like</span> <span data-start="97.02" data-end="98.49">hopefully you find the other happy</span> <span data-start="98.49" data-end="101.759">modules to use and it's got useful</span> <span data-start="101.759" data-end="104.13">options and features that are you know</span> <span data-start="104.13" data-end="111.39">enterprise-grade so all the all the 30</span> <span data-start="111.39" data-end="114.36">or more it keeps changing open-source</span> <span data-start="114.36" data-end="117">repos under the happy j/s umbrella all</span> <span data-start="117" data-end="120.119">use lab in addition to that every</span> <span data-start="120.119" data-end="123.95">project inside walmart uses lab as well</span> <span data-start="123.95" data-end="127.11">so you know labs been built to test high</span> <span data-start="127.11" data-end="129.989">demand high uptime systems like happy</span> <span data-start="129.989" data-end="133.47">and the servers that run inside</span> <span data-start="133.47" data-end="136.23">that that power the walmart sites so you</span> <span data-start="136.23" data-end="138.21">know it's really been been run through</span> <span data-start="138.21" data-end="143.73">the ringer so um these are just two</span> <span data-start="143.73" data-end="145.76">examples to make sure that one plus one</span> <span data-start="145.76" data-end="150.75">does equal to and if you look at them</span> <span data-start="150.75" data-end="154.02">one is TDD ones BDD I don't know which</span> <span data-start="154.02" data-end="155.43">one I don't really understand the</span> <span data-start="155.43" data-end="157.62">difference but ones one and one is the</span> <span data-start="157.62" data-end="162.21">other so it's on a pit onion opinionated</span> <span data-start="162.21" data-end="164.22">how you build and lay out your tests if</span> <span data-start="164.22" data-end="167.4">you can see you kind of sort of can it's</span> <span data-start="167.4" data-end="169.23">basically just aliases you flip around</span> <span data-start="169.23" data-end="173.64">to make it TDD or BDD and so change it</span> <span data-start="173.64" data-end="177.54">to to suit suit your needs all right so</span> <span data-start="177.54" data-end="179.31">some of those features i mentioned</span> <span data-start="179.31" data-end="181.29">earlier we have talked about some of the</span> <span data-start="181.29" data-end="185.19">really handy ones these are all like CLI</span> <span data-start="185.19" data-end="188.4">options the dash C and T sets this is</span> <span data-start="188.4" data-end="191.91">all CLI stuff the next few slides so</span> <span data-start="191.91" data-end="194.91">dash C and dash T for coverage and</span> <span data-start="194.91" data-end="198.51">threshold so r out of the box lad gives</span> <span data-start="198.51" data-end="201.84">you code coverage basically is their cup</span> <span data-start="201.84" data-end="204.3">is their lines of code being hit in the</span> <span data-start="204.3" data-end="207.12">test context that you have define yes or</span> <span data-start="207.12" data-end="211.17">no the dash t sets up the threshold for</span> <span data-start="211.17" data-end="213.84">a failed versus passed test so if your</span> <span data-start="213.84" data-end="216.66">code coverage is less than X then you</span> <span data-start="216.66" data-end="219.84">get you know a frowny face your tests do</span> <span data-start="219.84" data-end="222.75">not pass once you start using it you</span> <span data-start="222.75" data-end="224.519">will find that the code coverage is</span> <span data-start="224.519" data-end="228.18">annoyingly thorough so in this example</span> </p>
<p><span data-start="228.18" data-end="230.61">I've got here you will need code that</span> <span data-start="230.61" data-end="232.739">exercises both sides of that or</span> <span data-start="232.739" data-end="235.5">statement for settings both sides of the</span> <span data-start="235.5" data-end="237.81">ternary operator for results and all</span> <span data-start="237.81" data-end="242.61">three sides of that if statement it's</span> <span data-start="242.61" data-end="244.62">annoying but it's no way to know for</span> <span data-start="244.62" data-end="248.31">sure that you've hit everything so</span> <span data-start="248.31" data-end="250.44">there's built-in linting right out of</span> <span data-start="250.44" data-end="254.04">the box it comes lab comes default with</span> <span data-start="254.04" data-end="258.12">a as a lint file that sort of matches</span> <span data-start="258.12" data-end="261.299">the happy style guide it uses es Lynn as</span> <span data-start="261.299" data-end="264.06">the rule engine if you don't like our</span> <span data-start="264.06" data-end="265.41">style guide which I don't know why you</span> <span data-start="265.41" data-end="267.03">wouldn't but if you don't</span> <span data-start="267.03" data-end="270.03">you can override it with your own es</span> <span data-start="270.03" data-end="271.83">lint our C file at the root of your</span> <span data-start="271.83" data-end="274.98">project and one thing I want to note</span> <span data-start="274.98" data-end="276.54">there if you do that you need to supply</span> <span data-start="276.54" data-end="278.55">your own entire file it doesn't like</span> <span data-start="278.55" data-end="280.62">merge or anything wacky like that so if</span> <span data-start="280.62" data-end="281.82">you want to use your own you've got</span> <span data-start="281.82" data-end="283.889">right you're your own and this example</span> <span data-start="283.889" data-end="285.69">here is basically what what it looks</span> <span data-start="285.69" data-end="291.33">like if lint is mad so this is new in</span> <span data-start="291.33" data-end="293.97">five the dash a option you basically</span> <span data-start="293.97" data-end="296.639">tell lab the name of the assertion</span> <span data-start="296.639" data-end="299.43">library using and that is helpful</span> <span data-start="299.43" data-end="300.96">because then it can keep track of how</span> <span data-start="300.96" data-end="304.14">many assertions you've run it doesn't</span> <span data-start="304.14" data-end="306.06">sound very useful but sometimes you</span> <span data-start="306.06" data-end="307.59">think you've run an assertion but you</span> <span data-start="307.59" data-end="309.57">actually don't and you can sometimes get</span> <span data-start="309.57" data-end="311.79">like a mysterious test that pasts but</span> <span data-start="311.79" data-end="313.29">you don't end up actually testing</span> <span data-start="313.29" data-end="315.66">anything so the dash day is a very</span> <span data-start="315.66" data-end="322.02">powerful new feature to lab so we got</span> <span data-start="322.02" data-end="324.81">verbose and ID verbose prints out all</span> <span data-start="324.81" data-end="327.3">that test verbiage you spent time</span> <span data-start="327.3" data-end="330.54">reading for your t dds and BDDs it</span> <span data-start="330.54" data-end="333.419">prints out you know math module shump</span> <span data-start="333.419" data-end="335.43">sums numbers it does not crash on empty</span> <span data-start="335.43" data-end="337.44">raised it prints out how long it took to</span> <span data-start="337.44" data-end="340.05">run the test a little glyph for past</span> <span data-start="340.05" data-end="343.31">fails and it also prints out a test ID</span> <span data-start="343.31" data-end="346.8">that test ID is useful for the ID flag</span> <span data-start="346.8" data-end="349.979">so that lets you basically run specific</span> <span data-start="349.979" data-end="352.919">subsets of tests if you're trying to get</span> <span data-start="352.919" data-end="354.75">coverage or make a particular feature</span> <span data-start="354.75" data-end="357.36">work you can run an ID and just keep</span> <span data-start="357.36" data-end="359.58">hitting the one or two tests over and</span> <span data-start="359.58" data-end="360.72">over again instead of rewriting the</span> <span data-start="360.72" data-end="364.65">entire suite and I'll take a range 1</span> <span data-start="364.65" data-end="367.56">through 2 1 & 2 it'll also take a little</span> <span data-start="367.56" data-end="370.14">mix and match so you can do 1 comma 2 3</span> <span data-start="370.14" data-end="374.76">through four let's see so there's a few</span> <span data-start="374.76" data-end="377.16">other quick features that I want to</span> <span data-start="377.16" data-end="378.77">mention that don't need a whole slide</span> <span data-start="378.77" data-end="381.57">async testing is easy because every test</span> <span data-start="381.57" data-end="383.97">is passed a call back I know some other</span> <span data-start="383.97" data-end="386.669">testing frameworks it's you do something</span> <span data-start="386.669" data-end="388.47">a little different to get a sink testing</span> <span data-start="388.47" data-end="390.84">in lab everything's already assumed to</span> <span data-start="390.84" data-end="392.82">be a sink you have a bunch of different</span> <span data-start="392.82" data-end="395.31">output options not just console so if</span> <span data-start="395.31" data-end="397.86">you have a very involved project manager</span> <span data-start="397.86" data-end="400.09">who wants to see graphs and charts</span> <span data-start="400.09" data-end="402.6">you can print it out to HTML or</span> <span data-start="402.6" data-end="405.07">coveralls there's a bunch of different</span> <span data-start="405.07" data-end="411.34">reporting options as well so how we use</span> <span data-start="411.34" data-end="413.59">lab and again when i say we i really</span> <span data-start="413.59" data-end="415.54">mean walmart internally and externally</span> <span data-start="415.54" data-end="419.47">and again it's the same pretty much in</span> <span data-start="419.47" data-end="421.9">both cases so that dash t option i</span> <span data-start="421.9" data-end="425.26">talked about threshold is 100 so the</span> <span data-start="425.26" data-end="427.12">threshold for code coverage always has</span> <span data-start="427.12" data-end="429.76">to be a hundred if you've ever made any</span> </p>
<p><span data-start="429.76" data-end="432.49">PRS into the happy universe and I hope</span> <span data-start="432.49" data-end="434.61">you have and encourage you to do so you</span> <span data-start="434.61" data-end="437.77">will probably get comments about hey</span> <span data-start="437.77" data-end="440.139">this is missing coverage or tests don't</span> <span data-start="440.139" data-end="442.45">pass taking you to add test it's the</span> <span data-start="442.45" data-end="446.229">dash t 100 that that's doing that to you</span> <span data-start="446.229" data-end="449.19">so that that's where that comes from</span> <span data-start="449.19" data-end="451.99">always use a CI server that runs a</span> <span data-start="451.99" data-end="455.169">designated test command and we have we</span> <span data-start="455.169" data-end="456.58">use a make file but the make thought</span> <span data-start="456.58" data-end="458.729">really just has different lab configs</span> <span data-start="458.729" data-end="461.74">but NPM test is usually fine for most</span> <span data-start="461.74" data-end="466.03">people and nothing ever no PR ever gets</span> <span data-start="466.03" data-end="468.34">merged in unless the CI server says that</span> <span data-start="468.34" data-end="470.86">everything passed so you have to meet</span> <span data-start="470.86" data-end="472.87">that coverage dress threshold you have</span> <span data-start="472.87" data-end="474.599">to pass linting rules if you use it</span> <span data-start="474.599" data-end="476.8">unless your errand then you can merge</span> <span data-start="476.8" data-end="480.82">anything so what you get from all this</span> <span data-start="480.82" data-end="484.45">you get the sort of neat automatic</span> <span data-start="484.45" data-end="485.889">feedback loop that doesn't require</span> <span data-start="485.889" data-end="488.77">humans so you open a pull request</span> <span data-start="488.77" data-end="491.44">against something your CI server will</span> <span data-start="491.44" data-end="494.56">run and you'll see that little glyph on</span> <span data-start="494.56" data-end="496.9">github warning you that it can't be</span> <span data-start="496.9" data-end="499.51">merged in and so then hopefully you look</span> <span data-start="499.51" data-end="501.25">at the details and see hey coverage is</span> <span data-start="501.25" data-end="503.08">less than one hundred percent or your</span> <span data-start="503.08" data-end="505.36">linting failed or you know you're</span> <span data-start="505.36" data-end="508.57">missing a test entirely and so the you</span> <span data-start="508.57" data-end="510.039">know the cool thing there is that you</span> <span data-start="510.039" data-end="511.63">have this feedback loop it's pretty much</span> <span data-start="511.63" data-end="514.36">automatic and you kind of pull people</span> <span data-start="514.36" data-end="517.15">through writing better code without</span> <span data-start="517.15" data-end="519.88">having to harass them to do it so it's a</span> <span data-start="519.88" data-end="522.729">pretty pretty nice little cycle and it's</span> <span data-start="522.729" data-end="524.29">definitely worth setting up just for</span> <span data-start="524.29" data-end="525.88">that alone you get higher quality code</span> <span data-start="525.88" data-end="528.94">and you sort of get that for free by</span> <span data-start="528.94" data-end="530.95">having this sort of come continuous</span> <span data-start="530.95" data-end="533.47">feedback loop</span> <span data-start="533.47" data-end="536.27">so quickly going to touch on the this</span> <span data-start="536.27" data-end="539.72">code module I talked about so that's a</span> <span data-start="539.72" data-end="543.17">new one and yeah it's just a base a</span> <span data-start="543.17" data-end="546.11">pretty simple assertion library lab</span> <span data-start="546.11" data-end="550.16">formally came bundled with chai but but</span> <span data-start="550.16" data-end="552.14">we broke that out because child was kind</span> <span data-start="552.14" data-end="554.27">of a little more than what we really</span> <span data-start="554.27" data-end="558.08">needed at a lab and it was also he sort</span> <span data-start="558.08" data-end="560.36">of this problem here where you couldn't</span> <span data-start="560.36" data-end="562.07">remember if it was a property or a</span> <span data-start="562.07" data-end="565.82">method so encode every like assertion is</span> <span data-start="565.82" data-end="568.28">always a method and this also goes back</span> <span data-start="568.28" data-end="570.83">to that assert command I mentioned</span> <span data-start="570.83" data-end="573.62">earlier where this expect property</span> <span data-start="573.62" data-end="577.13">versus expect method if you didn't if it</span> <span data-start="577.13" data-end="578.57">was a method but it wasn't supposed to</span> <span data-start="578.57" data-end="581.42">be you could inadvertently get a a true</span> <span data-start="581.42" data-end="583.31">test when you actually didn't assert</span> <span data-start="583.31" data-end="585.68">anything because that exists might not</span> <span data-start="585.68" data-end="588.89">actually be a property so yeah codes</span> <span data-start="588.89" data-end="591.14">cool it's consistent everything is</span> <span data-start="591.14" data-end="592.84">always a method and there's a lot fewer</span> <span data-start="592.84" data-end="595.22">human words to sort memorized so it's</span> <span data-start="595.22" data-end="601.91">easy to to commit to memory okay so how</span> <span data-start="601.91" data-end="604.43">can you get started hopefully you have</span> <span data-start="604.43" data-end="607.01">tests already but if you don't this is</span> <span data-start="607.01" data-end="608.66">supposed to make you go and do that now</span> <span data-start="608.66" data-end="614.56">if you don't so number one do something</span> <span data-start="614.56" data-end="616.79">yeah you're not getting one hundred</span> <span data-start="616.79" data-end="619.25">percent coverage and tests that say it</span> <span data-start="619.25" data-end="622.01">work is going to take some time so just</span> <span data-start="622.01" data-end="625.73">start small write the test that the it</span> <span data-start="625.73" data-end="628.82">works type of tests and you know just</span> <span data-start="628.82" data-end="630.53">the simple sort of integration tests</span> <span data-start="630.53" data-end="633.2">like that you'll probably hit 50 60 even</span> <span data-start="633.2" data-end="634.91">70 percent code coverage right out of</span> <span data-start="634.91" data-end="639.05">the gate once you get there you know</span> <span data-start="639.05" data-end="641.51">change your process if you don't if</span> <span data-start="641.51" data-end="643.19">testing is not part of your process now</span> <span data-start="643.19" data-end="645.47">make it part your process new feature</span> <span data-start="645.47" data-end="647.84">you you don't nothing ever happens and I</span> <span data-start="647.84" data-end="649.01">should have a test to prove the feature</span> <span data-start="649.01" data-end="651.89">works if you fix a bug either create or</span> <span data-start="651.89" data-end="654.8">add a test to make sure that the test is</span> <span data-start="654.8" data-end="656.39">good and doesn't cause any regressions</span> <span data-start="656.39" data-end="658.52">once you change your process and get</span> <span data-start="658.52" data-end="660.77">that part of it code coverage will go up</span> <span data-start="660.77" data-end="665.3">and and you'll be happy and once you put</span> <span data-start="665.3" data-end="666.17">that time into</span> <span data-start="666.17" data-end="668.45">get you know testing built in your</span> <span data-start="668.45" data-end="670.61">process get coverage up the rest is easy</span> <span data-start="670.61" data-end="675.269">it's just maintenance from there and</span> <span data-start="675.279" data-end="679.79">yeah so 87.5 percent they probably</span> <span data-start="679.79" data-end="681.38">thought this truck was okay but it</span> <span data-start="681.38" data-end="682.79">doesn't really look like it still works</span> <span data-start="682.79" data-end="685.94">so one hundred percent should probably</span> <span data-start="685.94" data-end="689.209">be your goal or close to it and that's</span> <span data-start="689.209" data-end="693.92">probably not good enough 87.5 okay</span> <span data-start="693.92" data-end="696.199">that's the end if you want this deck</span> <span data-start="696.199" data-end="697.73">i'll send it out there's some links to</span> <span data-start="697.73" data-end="701.87">the deck to the lab repo and to the code</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
