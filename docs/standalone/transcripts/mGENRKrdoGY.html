<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="JSConf transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>mGENRKrdoGY</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/mGENRKrdoGY?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="15.65" data-end="19.08">yeah it's going to be exciting it's also</span> <span data-start="19.08" data-end="25.91">going to be a lot of material and yeah</span> <span data-start="25.91" data-end="29.61">imagine you're building Gmail and you</span> <span data-start="29.61" data-end="31.47">know we both work on Google+ so this is</span> <span data-start="31.47" data-end="34.41">as much as a mind game for us than it is</span> <span data-start="34.41" data-end="37.35">for everybody here except this guy who's</span> <span data-start="37.35" data-end="40.53">actually working on Gmail and so most of</span> <span data-start="40.53" data-end="42.93">you guys probably know Gmail it looks</span> <span data-start="42.93" data-end="46.98">somehow like you know this it's fake</span> <span data-start="46.98" data-end="48.6">right so there's megabytes of JavaScript</span> <span data-start="48.6" data-end="51.269">and you would think that you probably</span> <span data-start="51.269" data-end="52.949">don't eat all of it right away</span> <span data-start="52.949" data-end="55.379">right so initially you might draw</span> <span data-start="55.379" data-end="56.97">something and then you know the user</span> <span data-start="56.97" data-end="58.17">does something need a little more code</span> <span data-start="58.17" data-end="61.229">so it you know that's that's kind of how</span> <span data-start="61.229" data-end="63.659">it looks and you know we can probably</span> <span data-start="63.659" data-end="64.769">agree on that</span> <span data-start="64.769" data-end="66.659">downloading lots of JavaScript is you</span> <span data-start="66.659" data-end="68.58">know it can be really slow and that</span> <span data-start="68.58" data-end="70.29">compilation of JavaScript is also</span> <span data-start="70.29" data-end="74.159">something that may be slow so to follow</span> <span data-start="74.159" data-end="77.46">along this is our example app you know</span> <span data-start="77.46" data-end="79.2">it's Gmail it has an inbox and has a</span> <span data-start="79.2" data-end="82.05">compose you and kind of our assumption</span> <span data-start="82.05" data-end="84.45">is that not everybody always composed</span> <span data-start="84.45" data-end="86.43">emails so it's kind of wasteful to load</span> <span data-start="86.43" data-end="87.93">all the code you need to compose emails</span> <span data-start="87.93" data-end="91.53">right and then we make this completely</span> <span data-start="91.53" data-end="95.1">arbitrary made-up dependency tree that</span> <span data-start="95.1" data-end="96.84">has you know this thing that we call</span> <span data-start="96.84" data-end="99.33">inbox app at the top and then it's like</span> <span data-start="99.33" data-end="101.25">an inbox model and an inbox view and the</span> <span data-start="101.25" data-end="103.05">inbox model depends on the Ajax thing</span> <span data-start="103.05" data-end="105.42">and the thread Porter and the URL module</span> <span data-start="105.42" data-end="107.76">is a dependency of the Ajax module can</span> <span data-start="107.76" data-end="109.68">you see that yeah and then it's like the</span> <span data-start="109.68" data-end="111.51">template renderer and the text Kade and</span> <span data-start="111.51" data-end="114.33">it's yeah doesn't really matter it's all</span> <span data-start="114.33" data-end="116.25">just things we made up it's a dependency</span> <span data-start="116.25" data-end="117.9">tree you know you have modules to kind</span> <span data-start="117.9" data-end="121.56">of need other stuff and when you act the</span> <span data-start="121.56" data-end="124.92">compose app you get you know these two</span> <span data-start="124.92" data-end="126.81">other things like the email sender and</span> <span data-start="126.81" data-end="128.759">the compose view and the compost view</span> <span data-start="128.759" data-end="130.229">also depends on the same thing the</span> <span data-start="130.229" data-end="132.03">template renderer and the text get thing</span> <span data-start="132.03" data-end="134.22">and the email sender needs Ajax so</span> <span data-start="134.22" data-end="135.78">there's you know there's some overlap</span> <span data-start="135.78" data-end="137.25">and the dependencies between those two</span> <span data-start="137.25" data-end="140.94">apps so and we talk about JavaScript</span> <span data-start="140.94" data-end="143.43">loading so let's imagine we're building</span> <span data-start="143.43" data-end="144.81">our app with require.js</span> <span data-start="144.81" data-end="147.209">now requirejs is two ways to load</span> </p>
<p><span data-start="147.209" data-end="149.13">JavaScript that's the HR</span> <span data-start="149.13" data-end="150.72">kind of built in and this is the first</span> <span data-start="150.72" data-end="152.31">one that you would used in development</span> <span data-start="152.31" data-end="154.65">and it's recursive downloading so you</span> <span data-start="154.65" data-end="156.75">say you know your abscess I want the</span> <span data-start="156.75" data-end="158.85">inbox app so it figures you know there's</span> <span data-start="158.85" data-end="160.95">these two things that I know I need</span> <span data-start="160.95" data-end="162.51">because they're like defined to be my</span> <span data-start="162.51" data-end="166.14">dependencies it downloads them then they</span> <span data-start="166.14" data-end="168.54">go and say yeah I actually do need a</span> <span data-start="168.54" data-end="170.67">couple more modules and download them</span> <span data-start="170.67" data-end="173.1">and then a Jake says yeah I also need</span> <span data-start="173.1" data-end="174.84">the URL module and there's another step</span> <span data-start="174.84" data-end="177.39">so loading JavaScript like this is</span> <span data-start="177.39" data-end="180.75">really really bad its overall hhb</span> <span data-start="180.75" data-end="182.28">requests and there's a four step</span> <span data-start="182.28" data-end="183.72">waterfall so assuming you have like a</span> <span data-start="183.72" data-end="185.58">round-trip time of like 100 milliseconds</span> <span data-start="185.58" data-end="187.71">it takes 400 seconds just to do these</span> <span data-start="187.71" data-end="192.11">like trivial module loading which is bad</span> <span data-start="192.11" data-end="194.61">let's look at the incremental load so</span> <span data-start="194.61" data-end="197.07">now let's say like we want to load the</span> <span data-start="197.07" data-end="199.14">compost app and that's actually really</span> <span data-start="199.14" data-end="201.99">easy in with AMD say like you load it</span> <span data-start="201.99" data-end="204.45">and then it figures out okay then email</span> <span data-start="204.45" data-end="206.07">sender and the compose for you and then</span> <span data-start="206.07" data-end="207.69">you have all this other dependencies but</span> <span data-start="207.69" data-end="208.71">they're already there so it doesn't</span> <span data-start="208.71" data-end="209.58">download them anymore</span> <span data-start="209.58" data-end="210.72">so it's a little bit better in the</span> <span data-start="210.72" data-end="212.31">incremental load so it's three HTTP</span> <span data-start="212.31" data-end="214.83">requests and still two-step waterfall</span> <span data-start="214.83" data-end="218.13">really really bad so what can you do</span> <span data-start="218.13" data-end="221.97">require.js has this you know thing where</span> </p>
<p><span data-start="221.97" data-end="223.77">I say you compile it all into one big</span> <span data-start="223.77" data-end="226.38">file you know you have your entry module</span> <span data-start="226.38" data-end="227.61">and they figured out all dependencies</span> <span data-start="227.61" data-end="229.5">makes it one thing right and you deliver</span> <span data-start="229.5" data-end="231.39">that in production and that's actually a</span> <span data-start="231.39" data-end="233.49">very very very good way to deliver</span> <span data-start="233.49" data-end="235.2">JavaScript that's totally what you want</span> <span data-start="235.2" data-end="237.57">to do it's super super efficient for</span> <span data-start="237.57" data-end="240.54">small to medium and we don't really know</span> <span data-start="240.54" data-end="243.48">where the cutoff is apps so but it</span> <span data-start="243.48" data-end="245.22">doesn't scale there's some point where</span> <span data-start="245.22" data-end="248.43">you know and it certainly reached if you</span> <span data-start="248.43" data-end="251.76">are at a megabyte where you do not want</span> <span data-start="251.76" data-end="253.11">to do this anymore because it's just too</span> <span data-start="253.11" data-end="256.98">big right and so we figured like how can</span> <span data-start="256.98" data-end="258.87">we fix this yeah so we're talking about</span> </p>
<p><span data-start="258.87" data-end="261.03">JavaScript serving and the Gmail team</span> <span data-start="261.03" data-end="262.1">actually came up with the initial</span> <span data-start="262.1" data-end="264.42">implementation of a solution to this</span> <span data-start="264.42" data-end="266.22">which is basically to teach the server a</span> <span data-start="266.22" data-end="267.69">couple of things about how to serve</span> <span data-start="267.69" data-end="270.42">javascript the themes here are first of</span> <span data-start="270.42" data-end="272.04">all teach the server the dependency tree</span> <span data-start="272.04" data-end="273.78">the server can know it the client does</span> <span data-start="273.78" data-end="275.25">not need to figure it out and by</span> <span data-start="275.25" data-end="276.54">teaching the server the dependency tree</span> <span data-start="276.54" data-end="278.01">we can get rid of the recursive sort of</span> <span data-start="278.01" data-end="280.26">downloading from a client perspective we</span> <span data-start="280.26" data-end="281.58">want it to be as simple as possible just</span> <span data-start="281.58" data-end="282.9">ask for what you need</span> <span data-start="282.9" data-end="285.27">actly when you need it and then we pair</span> <span data-start="285.27" data-end="286.86">this with closure compiler for</span> <span data-start="286.86" data-end="288.21">minification and various other benefits</span> <span data-start="288.21" data-end="291.36">that I will go on to talk about so the</span> <span data-start="291.36" data-end="292.68">initial request ends up looking</span> <span data-start="292.68" data-end="294.449">something like this which is kind of</span> <span data-start="294.449" data-end="296.009">like the one big file that melted was</span> <span data-start="296.009" data-end="298.71">talking about which is to say you asked</span> <span data-start="298.71" data-end="301.199">for inbox app and then the URL jebaited</span> <span data-start="301.199" data-end="303.24">just directs the server give me all the</span> <span data-start="303.24" data-end="305.61">dependencies that inbox app also has the</span> <span data-start="305.61" data-end="307.38">server resolves this concatenates theme</span> <span data-start="307.38" data-end="310.169">spits it out out of the socket browser</span> <span data-start="310.169" data-end="311.88">loads it up well and good</span> <span data-start="311.88" data-end="315.57">so for incremental loading our initial</span> <span data-start="315.57" data-end="317.31">implementation was basically just to</span> <span data-start="317.31" data-end="320.97">have that initial boot payload the</span> <span data-start="320.97" data-end="323.43">server emitted the module graph to the</span> <span data-start="323.43" data-end="325.56">client and says hey look in addition to</span> <span data-start="325.56" data-end="327.93">inbox app and all of its contents here's</span> <span data-start="327.93" data-end="329.039">the module graph for the entire</span> <span data-start="329.039" data-end="330.3">application the module graph is a lot</span> <span data-start="330.3" data-end="333.41">smaller than the code of course and so</span> <span data-start="333.41" data-end="336.87">the client is able to construct a URL</span> <span data-start="336.87" data-end="338.91">for the incremental load for compose app</span> <span data-start="338.91" data-end="340.59">by simply just traversing the module</span> <span data-start="340.59" data-end="342.06">graph and asking for the individual</span> <span data-start="342.06" data-end="344.669">library modules without other</span> <span data-start="344.669" data-end="346.59">dependencies so that's our first cut now</span> <span data-start="346.59" data-end="348.78">the client calculates it all of our</span> <span data-start="348.78" data-end="353.039">requests are still 1 HP 1hp or requests</span> <span data-start="353.039" data-end="354.63">and things are still are fairly</span> <span data-start="354.63" data-end="356.46">efficient but there's downsides in</span> <span data-start="356.46" data-end="358.62">particular the client needs to download</span> <span data-start="358.62" data-end="360.3">the whole dependency tree that can get a</span> <span data-start="360.3" data-end="362.13">little bit large more importantly the</span> <span data-start="362.13" data-end="364.05">client code required for incremental</span> <span data-start="364.05" data-end="366.06">loading needs to be able to parse it</span> <span data-start="366.06" data-end="367.5">keep track of all various data</span> <span data-start="367.5" data-end="369.449">structures the client ends up getting a</span> <span data-start="369.449" data-end="373.08">lot more complicated so we came up with</span> <span data-start="373.08" data-end="374.699">this idea actually John did but I talked</span> <span data-start="374.699" data-end="377.82">about it- loading which is super crazy</span> <span data-start="377.82" data-end="379.68">easy and awesome</span> <span data-start="379.68" data-end="381.87">so the first request is the exact same</span> <span data-start="381.87" data-end="384">with the other module you say you know I</span> <span data-start="384" data-end="385.65">want inbox app and the server goes and</span> <span data-start="385.65" data-end="387.15">fetched all the dependencies give it to</span> <span data-start="387.15" data-end="390.659">you and on the incremental load the</span> <span data-start="390.659" data-end="392.97">super-crazy inside comes you tell the</span> <span data-start="392.97" data-end="396.24">server I want compose app but I already</span> <span data-start="396.24" data-end="398.01">have inbox app and then the server is</span> <span data-start="398.01" data-end="399.87">really smart and can tell you know</span> <span data-start="399.87" data-end="401.699">figures are dependencies of those two</span> <span data-start="401.699" data-end="403.68">things subtract them that's why we call</span> <span data-start="403.68" data-end="405.72">it negative loading and only gives you</span> <span data-start="405.72" data-end="408.449">the Delta that you really need so let's</span> <span data-start="408.449" data-end="411.27">look at a couple example URLs we</span> <span data-start="411.27" data-end="413.49">invented this you know slash a slash and</span> <span data-start="413.49" data-end="415.56">then plus inbox apps that's the first</span> <span data-start="415.56" data-end="416.319">request</span> <span data-start="416.319" data-end="418.839">on the second request say we want to</span> <span data-start="418.839" data-end="421.33">allow composer we say compose app -</span> <span data-start="421.33" data-end="424.749">inbox app and the third request where we</span> <span data-start="424.749" data-end="426.999">invented cent app we say okay we want</span> <span data-start="426.999" data-end="429.129">cent app we already have inbox app and</span> <span data-start="429.129" data-end="433.809">compose app so the nice thing is that</span> <span data-start="433.809" data-end="436.419">this makes this client super super</span> <span data-start="436.419" data-end="439.719">stupid simple so constructing like a URL</span> <span data-start="439.719" data-end="441.819">just says you know whatever module you</span> <span data-start="441.819" data-end="444.369">want and then you join all the requested</span> <span data-start="444.369" data-end="446.289">module you have and immediately push the</span> <span data-start="446.289" data-end="447.999">module you request it onto the requested</span> <span data-start="447.999" data-end="450.039">thing and the next request just you know</span> <span data-start="450.039" data-end="451.509">keeps on adding goes so that's that</span> <span data-start="451.509" data-end="452.919">that's that's your JavaScript loader</span> <span data-start="452.919" data-end="454.469">it's the one is like two lines of code</span> <span data-start="454.469" data-end="458.499">which is I think super awesome but</span> <span data-start="458.499" data-end="459.639">there's one problem that there's no</span> <span data-start="459.639" data-end="461.889">there's a conserved concurrency thing</span> <span data-start="461.889" data-end="464.379">right and so each one of these requests</span> <span data-start="464.379" data-end="466.419">needs to execute right after the other</span> <span data-start="466.419" data-end="468.129">so if you're adding adding them</span> <span data-start="468.129" data-end="470.05">dynamically to the Dom browser can</span> <span data-start="470.05" data-end="471.039">download them in any particular order</span> <span data-start="471.039" data-end="472.93">execute them in whatever order shows up</span> <span data-start="472.93" data-end="476.139">obviously that not only is suboptimal in</span> <span data-start="476.139" data-end="477.279">terms of performance you'd like to be</span> <span data-start="477.279" data-end="478.599">able to download as much as you can at</span> <span data-start="478.599" data-end="479.949">the same time in cases where it makes</span> <span data-start="479.949" data-end="481.569">sense it also adds complexity to the</span> <span data-start="481.569" data-end="482.889">loader and that you need to detect</span> <span data-start="482.889" data-end="484.689">somehow and there's various mechanisms</span> <span data-start="484.689" data-end="487.779">to do this when each one of the FEM each</span> <span data-start="487.779" data-end="489.37">one of these payloads has completed so</span> <span data-start="489.37" data-end="490.83">that it can kick off the next request</span> <span data-start="490.83" data-end="494.319">thereby serializing them together so we</span> <span data-start="494.319" data-end="495.759">try we wanted to do a little bit better</span> <span data-start="495.759" data-end="497.62">and so we introduced something called</span> <span data-start="497.62" data-end="500.649">callback loading it's my name I take</span> <span data-start="500.649" data-end="503.019">responsibility for it if you have if you</span> <span data-start="503.019" data-end="504.849">know anybody who's good at marketing and</span> <span data-start="504.849" data-end="506.469">has a better name for it please tell me</span> <span data-start="506.469" data-end="509.649">because it's not the most fantastic name</span> <span data-start="509.649" data-end="511.029">but basically you can think of it as</span> </p>
<p><span data-start="511.029" data-end="514.63">Jason p4 for JavaScript code so the</span> <span data-start="514.63" data-end="516.25">loader is responsible for setting up a</span> <span data-start="516.25" data-end="519.159">loading function that is that wraps the</span> <span data-start="519.159" data-end="522.279">JavaScript that comes in now in the</span> <span data-start="522.279" data-end="523.389">naive implementation you can basically</span> <span data-start="523.389" data-end="525.88">just stringify all your j s eval it in</span> <span data-start="525.88" data-end="528.519">in the loader and the loader callback</span> <span data-start="528.519" data-end="530.139">needs to just be smart enough to know I</span> <span data-start="530.139" data-end="532.36">cannot execute until everything that was</span> <span data-start="532.36" data-end="533.98">supposed to have executed before me is</span> <span data-start="533.98" data-end="536.589">complete so here's an example of some of</span> <span data-start="536.589" data-end="538.209">a couple of the URLs sort of translated</span> <span data-start="538.209" data-end="540.699">a little bit of the incremental loads so</span> <span data-start="540.699" data-end="543.009">we want to compose app — the inbox app</span> <span data-start="543.009" data-end="544.839">and we and basically just say hey look</span> <span data-start="544.839" data-end="547.51">server I've set up a callback called</span> <span data-start="547.51" data-end="548.74">load underbar one you could also</span> <span data-start="548.74" data-end="550.089">namespace it too</span> <span data-start="550.089" data-end="552.819">pollute that global namespace less that</span> <span data-start="552.819" data-end="554.529">is responsible for actually executing</span> <span data-start="554.529" data-end="556.149">the code that comes back from the server</span> <span data-start="556.149" data-end="558.61">likewise loading send app a little bit</span> <span data-start="558.61" data-end="562.389">later I'm indicating to subtract inbox</span> <span data-start="562.389" data-end="564.189">app and compose app load to function is</span> <span data-start="564.189" data-end="566.11">responsible for doing this so what does</span> <span data-start="566.11" data-end="568.66">the code look like this is not the</span> <span data-start="568.66" data-end="570.699">actual code I wrote this basically just</span> <span data-start="570.699" data-end="572.379">to demonstrate that it can be written</span> <span data-start="572.379" data-end="574.24">tersely I'll describe kind of what it</span> <span data-start="574.24" data-end="577.389">does and you can implant it much more</span> <span data-start="577.389" data-end="579.309">clearly but the idea is that the loader</span> <span data-start="579.309" data-end="581.589">sets up the load underbar some index</span> <span data-start="581.589" data-end="585.67">method which in turn sets up any exact</span> <span data-start="585.67" data-end="587.079">method that is responsible for executing</span> <span data-start="587.079" data-end="589.6">the jeaious that it that it picked up if</span> <span data-start="589.6" data-end="594.339">a payload comes in out of order then</span> <span data-start="594.339" data-end="596.079">what it for instance if payload one</span> <span data-start="596.079" data-end="598.269">comes in after payload zero it just says</span> <span data-start="598.269" data-end="599.319">hey look I'm not ready yet</span> <span data-start="599.319" data-end="600.97">payload zero is not complete yet or to</span> <span data-start="600.97" data-end="602.8">you know before one but when one comes</span> <span data-start="602.8" data-end="605.17">in later it executes its own payload</span> <span data-start="605.17" data-end="606.79">saying hey I'm ready I'm ready now all</span> <span data-start="606.79" data-end="608.92">of my dependencies are executed and I'm</span> <span data-start="608.92" data-end="610.12">going to keep forward executing</span> <span data-start="610.12" data-end="611.47">everything else that's already been set</span> <span data-start="611.47" data-end="615.939">up and the executor deletes itself after</span> <span data-start="615.939" data-end="617.259">executing to make sure that you don't</span> <span data-start="617.259" data-end="620.11">dual execute so the example I just kind</span> <span data-start="620.11" data-end="621.759">of walk through is like this load 1</span> <span data-start="621.759" data-end="624.279">followed by load zero you define the</span> <span data-start="624.279" data-end="626.74">load 1 in the function R 0 then 1 and</span> <span data-start="626.74" data-end="629.41">then the last loaded bit says well 1 is</span> <span data-start="629.41" data-end="630.55">the last one that's kind of like</span> <span data-start="630.55" data-end="633.16">outstanding load 1 shows up and says hey</span> <span data-start="633.16" data-end="636.55">look zero hasn't executed yet I'm just</span> <span data-start="636.55" data-end="638.98">going to kind of put a placeholder there</span> <span data-start="638.98" data-end="641.05">saying that you know call this function</span> <span data-start="641.05" data-end="643.449">whenever you want to execute you see</span> <span data-start="643.449" data-end="645.49">where this is going load zero comes in</span> <span data-start="645.49" data-end="647.92">gets the code says alright I'm ready</span> <span data-start="647.92" data-end="650.499">it executes itself and it executes load</span> <span data-start="650.499" data-end="655.269">one thereby achieving concurrency so the</span> <span data-start="655.269" data-end="656.769">one one issue with this and the native</span> <span data-start="656.769" data-end="659.319">implementation is that we get code as in</span> <span data-start="659.319" data-end="662.379">a string representation via eval that's</span> <span data-start="662.379" data-end="664.899">not a huge problem there's very you know</span> <span data-start="664.899" data-end="667.48">that there's pros and cons to this but</span> <span data-start="667.48" data-end="668.98">among some of the issues that we ran</span> <span data-start="668.98" data-end="671.019">into particularly in the Google+ world</span> <span data-start="671.019" data-end="672.61">is that we really wanted to make sure</span> <span data-start="672.61" data-end="674.259">not to pollute the global namespace so</span> <span data-start="674.259" data-end="675.97">we tried to kill two birds with one</span> <span data-start="675.97" data-end="678.279">stone avoiding eval all at the same time</span> <span data-start="678.279" data-end="680.439">not polluting global name space with a</span> <span data-start="680.439" data-end="682.629">closure compiler passed that multi wrote</span> <span data-start="682.629" data-end="684.12">called reefs cope global symbol</span> <span data-start="684.12" data-end="687.13">yeah the way this works is it's actually</span> <span data-start="687.13" data-end="689.38">super simple so imagine you have a</span> <span data-start="689.38" data-end="692.73">global symbol like var x equals zero and</span> <span data-start="692.73" data-end="695.26">what we do is we find all those global</span> <span data-start="695.26" data-end="697.75">symbols and then we put them in a</span> <span data-start="697.75" data-end="699.79">namespace in this case it's called NS in</span> <span data-start="699.79" data-end="701.11">our real implementation we call it</span> <span data-start="701.11" data-end="702.43">underscore because underscores are</span> <span data-start="702.43" data-end="704.65">awesome and then it finds all the</span> <span data-start="704.65" data-end="707.44">references to this symbol and and always</span> <span data-start="707.44" data-end="712.99">says n I start X and s dot plot and what</span> <span data-start="712.99" data-end="715.93">this allows you is to wrap your response</span> <span data-start="715.93" data-end="721.12">in a closure and you inject the</span> <span data-start="721.12" data-end="723.67">namespace NS from into this closure and</span> <span data-start="723.67" data-end="725.74">the nice thing about this is you can do</span> <span data-start="725.74" data-end="727.33">incremental loads so you get more</span> </p>
<p><span data-start="727.33" data-end="729.07">JavaScript and if you wrapped up in</span> <span data-start="729.07" data-end="730.99">closures it's not visible anymore so it</span> <span data-start="730.99" data-end="732.37">doesn't work if you have if you're in an</span> <span data-start="732.37" data-end="734.2">incremental loading scenario but with</span> <span data-start="734.2" data-end="738.52">this basically you get the same like you</span> <span data-start="738.52" data-end="740.5">get the this thing we call a synthetic</span> <span data-start="740.5" data-end="742.99">namespace that's accessible to all the</span> <span data-start="742.99" data-end="744.72">payloads that are being loaded</span> <span data-start="744.72" data-end="748.3">individually and only if you if you say</span> <span data-start="748.3" data-end="751.45">window dot something explicitly it goes</span> <span data-start="751.45" data-end="753.88">into the actual global scope you know</span> <span data-start="753.88" data-end="755.53">we're working on the plus one team and</span> <span data-start="755.53" data-end="757.6">we never ever want to put stuff in like</span> <span data-start="757.6" data-end="760.09">namespaces of people if they embed plus</span> <span data-start="760.09" data-end="761.5">one so this is like super important for</span> <span data-start="761.5" data-end="763.84">us it might not be super important for</span> <span data-start="763.84" data-end="769.69">everybody yeah and the benefits are that</span> <span data-start="769.69" data-end="772.69">you get super hyper guaranteed you know</span> <span data-start="772.69" data-end="773.95">execution order but you can load</span> <span data-start="773.95" data-end="775.72">everything apparel and you know it's</span> <span data-start="775.72" data-end="777.27">only executed when you need it and</span> <span data-start="777.27" data-end="780.3">there's no change of any symbol</span> <span data-start="780.3" data-end="785.61">conflicts whatsoever we just decide</span> <span data-start="785.61" data-end="788.14">don't have to like dwell too much in</span> <span data-start="788.14" data-end="791.89">this way we then realized if we put var</span> <span data-start="791.89" data-end="793.87">window equals this at the beginning and</span> <span data-start="793.87" data-end="796.3">then go and find all the external</span> <span data-start="796.3" data-end="798.25">symbols from the environment and prefix</span> <span data-start="798.25" data-end="800.77">them with window dot that's an identity</span> <span data-start="800.77" data-end="802.24">transformation so the program still</span> <span data-start="802.24" data-end="803.83">works everybody with me</span> <span data-start="803.83" data-end="807.82">so what's awesome is you can now go and</span> <span data-start="807.82" data-end="810.85">apply this to be a different iframe and</span> <span data-start="810.85" data-end="813.67">we use this to essentially take this</span> <span data-start="813.67" data-end="815.53">code that's being rewritten and apply to</span> <span data-start="815.53" data-end="817.81">different iframes so you can</span> <span data-start="817.81" data-end="819.16">if you happen to have more than one</span> <span data-start="819.16" data-end="822.22">iframe and because your Remi and you</span> <span data-start="822.22" data-end="824.59">know you don't want to like compile or</span> <span data-start="824.59" data-end="825.76">like code more than once you can do</span> <span data-start="825.76" data-end="827.41">ding-ding-ding and apply to all them</span> <span data-start="827.41" data-end="832.6">kind of cool potential problems oh do</span> <span data-start="832.6" data-end="833.92">you want to know it I'll take it I'll</span> <span data-start="833.92" data-end="836.29">take this one and so what a couple of</span> <span data-start="836.29" data-end="837.67">the potential problems with this</span> <span data-start="837.67" data-end="838.93">approach just to kind of walk through</span> <span data-start="838.93" data-end="841.87">some of the implications is for one if</span> <span data-start="841.87" data-end="842.95">you have an independent incremental</span> <span data-start="842.95" data-end="844.21">requests the client doesn't know</span> <span data-start="844.21" data-end="845.92">anything about this and the default</span> <span data-start="845.92" data-end="847.72">loader basically just says all right</span> <span data-start="847.72" data-end="850">well one one needs to load before to</span> <span data-start="850" data-end="853.839">vice versa so but if you load solo one +</span> <span data-start="853.839" data-end="856">solo2 in this toy dependency graph here</span> <span data-start="856" data-end="857.95">in theory they could actually they get</span> <span data-start="857.95" data-end="860.62">it execute at the same time so how could</span> <span data-start="860.62" data-end="861.94">we ameliorate this we haven't actually</span> <span data-start="861.94" data-end="863.29">implemented this but just kind of what I</span> <span data-start="863.29" data-end="864.67">wanted to walk through it basically the</span> <span data-start="864.67" data-end="867.4">server could inject the dependencies</span> <span data-start="867.4" data-end="870.46">that it used among among what it what</span> <span data-start="870.46" data-end="872.5">the request indicated to subtract what</span> <span data-start="872.5" data-end="875.08">it was already requested the client is</span> <span data-start="875.08" data-end="876.22">smart enough to know what already is</span> <span data-start="876.22" data-end="878.8">loaded so if there's no overlap based</span> <span data-start="878.8" data-end="881.68">execute the payload right away another</span> <span data-start="881.68" data-end="883.75">potential problem is wasteful increment</span> <span data-start="883.75" data-end="886.45">incremental requests if you have as here</span> <span data-start="886.45" data-end="888.7">top depends on middle depends on bottom</span> <span data-start="888.7" data-end="890.17">you start with a request for top and</span> <span data-start="890.17" data-end="893.08">then you say now I want middle one way</span> <span data-start="893.08" data-end="894.61">to implement this naively is just doing</span> <span data-start="894.61" data-end="896.56">a simple check if some symbol you know</span> <span data-start="896.56" data-end="899.83">in middle whatever but you don't want to</span> <span data-start="899.83" data-end="900.94">pepper your code with that too much so</span> <span data-start="900.94" data-end="902.62">basically you just do load middle and</span> <span data-start="902.62" data-end="904.48">then start using it what that would do</span> <span data-start="904.48" data-end="906.94">in the naive implementation is say well</span> <span data-start="906.94" data-end="909.01">load middle — top which basically just</span> <span data-start="909.01" data-end="913.12">emits a zero pay zero byte request that</span> <span data-start="913.12" data-end="915.01">executes the payload it still works but</span> <span data-start="915.01" data-end="916.75">there's no particular point to it a</span> <span data-start="916.75" data-end="918.82">similar optimization could be used for</span> <span data-start="918.82" data-end="920.92">this basically just to omit the true the</span> <span data-start="920.92" data-end="923.68">tree of dependency is for any given</span> <span data-start="923.68" data-end="925.48">request that comes in and we're kind of</span> <span data-start="925.48" data-end="926.77">look looking at some of these</span> <span data-start="926.77" data-end="929.44">optimizations right now so the question</span> <span data-start="929.44" data-end="934.06">is how can you guys build this so what</span> <span data-start="934.06" data-end="935.2">you basically need is this data</span> <span data-start="935.2" data-end="936.76">structure that represents your</span> <span data-start="936.76" data-end="938.88">dependency tree and your server needs it</span> <span data-start="938.88" data-end="942.25">so from this you built this kind of flat</span> <span data-start="942.25" data-end="944.26">dependency graph for you basically for</span> <span data-start="944.26" data-end="945.7">like inbox app you have this list of</span> <span data-start="945.7" data-end="947.68">things you need and for your you know</span> <span data-start="947.68" data-end="950.2">and and and so on and and then</span> <span data-start="950.2" data-end="952.06">you have this you know you basically</span> <span data-start="952.06" data-end="954.61">need all your modules in one file and</span> <span data-start="954.61" data-end="957.46">have that in memory and you just go you</span> <span data-start="957.46" data-end="959.38">know what does the Pennsy tree say and</span> <span data-start="959.38" data-end="960.46">then you have your server emit those</span> <span data-start="960.46" data-end="964.18">ding-ding-ding one by one so this is</span> <span data-start="964.18" data-end="965.86">basically what what serving looks like</span> <span data-start="965.86" data-end="968.98">so you know let's say you want the</span> <span data-start="968.98" data-end="970.57">requested module so you get their</span> <span data-start="970.57" data-end="973.51">requested modules then you have you know</span> <span data-start="973.51" data-end="975.49">what's already loaded that's the — part</span> <span data-start="975.49" data-end="978.22">you get them and in order to find the</span> <span data-start="978.22" data-end="980.89">ones you want to serve you calculate the</span> <span data-start="980.89" data-end="984.36">intersection between those two lists and</span> <span data-start="984.36" data-end="987.01">you know recruit remove that from the</span> <span data-start="987.01" data-end="989.8">thing from the new list and then you</span> <span data-start="989.8" data-end="992.14">search them that's all so that's you</span> <span data-start="992.14" data-end="993.46">know also on the server side quite a</span> <span data-start="993.46" data-end="996.64">quite a simple implementation one thing</span> <span data-start="996.64" data-end="998.38">so we are using closure compiler which</span> <span data-start="998.38" data-end="1000.66">is you know one of the more popular</span> <span data-start="1000.66" data-end="1004.86">minifiers and closure compiler has one</span> <span data-start="1004.86" data-end="1006.03">little-known feature is that it's</span> <span data-start="1006.03" data-end="1008.58">actually you know first-class support</span> <span data-start="1008.58" data-end="1012.51">for modules and so normal magnifier is</span> <span data-start="1012.51" data-end="1014.34">you put like n like a lot of JavaScript</span> <span data-start="1014.34" data-end="1016.44">files in and you get one file out close</span> <span data-start="1016.44" data-end="1019.47">to compile like heading minify lots of</span> <span data-start="1019.47" data-end="1020.97">files and then give you the files back</span> <span data-start="1020.97" data-end="1023.28">but they're consistently minified so it</span> <span data-start="1023.28" data-end="1025.26">renamed my like a global function to a</span> <span data-start="1025.26" data-end="1026.82">and then they've made it like they named</span> <span data-start="1026.82" data-end="1028.77">a and all of them so but you still have</span> <span data-start="1028.77" data-end="1030.209">the files and that's important for the</span> <span data-start="1030.209" data-end="1031.56">serving model because then you can come</span> <span data-start="1031.56" data-end="1033.99">you can defer the actual concatenation</span> <span data-start="1033.99" data-end="1035.64">to runtime which is you know basically</span> <span data-start="1035.64" data-end="1038.73">what we not want and yeah so it's</span> <span data-start="1038.73" data-end="1040.29">uncouples minification from</span> <span data-start="1040.29" data-end="1042">concatenation which when you think about</span> <span data-start="1042" data-end="1044.25">it it's kind of a neat way and just</span> <span data-start="1044.25" data-end="1045.69">because you know nobody used to do this</span> </p>
<p><span data-start="1045.69" data-end="1048.03">I think nobody had the idea to go with</span> <span data-start="1048.03" data-end="1052.08">this and so one thing you know I did in</span> <span data-start="1052.08" data-end="1053.76">my free time it's not super robust but</span> <span data-start="1053.76" data-end="1054.21">it works</span> <span data-start="1054.21" data-end="1057.75">it's a edit both support for common J's</span> <span data-start="1057.75" data-end="1059.82">modules and for AMD modules to closure</span> <span data-start="1059.82" data-end="1062.31">compiler so it can go and say you know</span> <span data-start="1062.31" data-end="1065.46">this is my module and then it finds all</span> <span data-start="1065.46" data-end="1067.62">the dependencies builds the module graph</span> <span data-start="1067.62" data-end="1069.69">and like does all this computation and</span> <span data-start="1069.69" data-end="1073.29">if you're interested it does it in a way</span> <span data-start="1073.29" data-end="1075.54">that it's trying to be super efficient</span> <span data-start="1075.54" data-end="1077.4">and it actually looks similar to the</span> <span data-start="1077.4" data-end="1080.21">generated code that you saw this morning</span> <span data-start="1080.21" data-end="1083.07">from the folks from typescript how they</span> <span data-start="1083.07" data-end="1083.879">represent module</span> <span data-start="1083.879" data-end="1085.739">so essentially every time you do a</span> <span data-start="1085.739" data-end="1088.169">require it actually just stupidly</span> <span data-start="1088.169" data-end="1089.819">replaces it with a name of the variable</span> <span data-start="1089.819" data-end="1091.919">and it guesses the name of the variable</span> <span data-start="1091.919" data-end="1094.589">from the module name and then when you</span> <span data-start="1094.589" data-end="1097.559">actually define the module exports equal</span> <span data-start="1097.559" data-end="1100.409">becomes an assignment to that variable</span> <span data-start="1100.409" data-end="1103.109">name so exports gets also replaced with</span> <span data-start="1103.109" data-end="1104.609">a variable name and then you can just</span> <span data-start="1104.609" data-end="1107.219">cognate it the program it works without</span> <span data-start="1107.219" data-end="1110.699">any like so the whole notion of modules</span> <span data-start="1110.699" data-end="1113.179">goes away which is kind of freaky but</span> <span data-start="1113.179" data-end="1115.44">kind of works and I think it's worth</span> <span data-start="1115.44" data-end="1118.109">noting actually that our hope anyway</span> <span data-start="1118.109" data-end="1119.519">with this is to set up a protocol</span> <span data-start="1119.519" data-end="1122.069">whereby nej s can be served in this way</span> <span data-start="1122.069" data-end="1124.109">so long as you can define some notion of</span> <span data-start="1124.109" data-end="1126.389">a named library all the compiler passes</span> <span data-start="1126.389" data-end="1128.339">work on arbitrary J s and whatnot but we</span> <span data-start="1128.339" data-end="1129.869">do want it to be as flexible as possible</span> <span data-start="1129.869" data-end="1134.029">with and is sort of convenient and</span> <span data-start="1134.029" data-end="1135.809">understandable as possible to people who</span> <span data-start="1135.809" data-end="1137.849">already are using require J's common J's</span> <span data-start="1137.849" data-end="1142.019">and so on so what's the current study so</span> <span data-start="1142.019" data-end="1144.269">we use this as Google we're from the</span> <span data-start="1144.269" data-end="1147.179">social widget team what means like +1</span> <span data-start="1147.179" data-end="1151.109">and some more and so we use this the the</span> </p>
<p><span data-start="1151.109" data-end="1154.169">G+ you know proper side they still use</span> <span data-start="1154.169" data-end="1155.94">this other version that we talked about</span> <span data-start="1155.94" data-end="1157.649">that where the client side does the</span> <span data-start="1157.649" data-end="1159.509">calculation so you get still 1hb</span> <span data-start="1159.509" data-end="1161.669">requests but more complicated and we</span> <span data-start="1161.669" data-end="1163.199">hope to roll out a lot some more</span> <span data-start="1163.199" data-end="1165.569">properties soon actually so our current</span> <span data-start="1165.569" data-end="1167.659">server side implementation is in in Java</span> <span data-start="1167.659" data-end="1169.799">we're currently reporting to see bus</span> <span data-start="1169.799" data-end="1173.309">dressed to save some electricity but you</span> <span data-start="1173.309" data-end="1175.799">know both not our favorite programming</span> <span data-start="1175.799" data-end="1179.429">language so this slide essentially def</span> <span data-start="1179.429" data-end="1181.199">bank I was hoping for</span> <span data-start="1181.199" data-end="1184.229">thunderstorms but there is a github.com</span> <span data-start="1184.229" data-end="1187.859">slash Google slash module server which</span> <span data-start="1187.859" data-end="1190.409">is an open source implementation of all</span> <span data-start="1190.409" data-end="1191.879">everything we talked about today</span> <span data-start="1191.879" data-end="1195.929">very very written in node.js so you can</span> <span data-start="1195.929" data-end="1199.499">use it in your own project it's you know</span> <span data-start="1199.499" data-end="1201.779">super duper alpha untested because we</span> <span data-start="1201.779" data-end="1204.209">kind of wrote it not for ourselves but</span> <span data-start="1204.209" data-end="1207.69">you you guys sorry feel free to make it</span> <span data-start="1207.69" data-end="1209.519">actually using all the other projects</span> <span data-start="1209.519" data-end="1212.579">yeah so it's you know it's not that it's</span> <span data-start="1212.579" data-end="1214.679">not battle tested so it has unit tests</span> <span data-start="1214.679" data-end="1217.12">basically that's what it says it was</span> <span data-start="1217.12" data-end="1218.74">but it's designed to be fast you still</span> <span data-start="1218.74" data-end="1221.58">get this like only mem copy runtime</span> <span data-start="1221.58" data-end="1225.25">there's full source map support so while</span> <span data-start="1225.25" data-end="1227.68">you have the single file serving you in</span> <span data-start="1227.68" data-end="1229.51">the like in your dev tools it all looks</span> <span data-start="1229.51" data-end="1232.48">awesome it includes a client lower lip</span> <span data-start="1232.48" data-end="1234.55">which is actually based on lap GS</span> <span data-start="1234.55" data-end="1237.1">because there was two you know a lap</span> </p>
<p><span data-start="1237.1" data-end="1239.11">Jace's get if I JavaScript loader</span> <span data-start="1239.11" data-end="1240.94">because I was like you know I didn't</span> <span data-start="1240.94" data-end="1242.17">want to write a JavaScript loader this</span> <span data-start="1242.17" data-end="1243.67">is a module loader so it's a module</span> <span data-start="1243.67" data-end="1245.53">lower later layered on a JavaScript</span> <span data-start="1245.53" data-end="1248.26">loader and it also reps closure compiler</span> <span data-start="1248.26" data-end="1249.7">so it's super easy to use because</span> <span data-start="1249.7" data-end="1251.14">closure compiler can be kind of like</span> <span data-start="1251.14" data-end="1253.33">weird with all those command line</span> <span data-start="1253.33" data-end="1264.71">parameters yeah let's let's take a look</span> <span data-start="1264.72" data-end="1268.149">github so i'm meltus doing this I will</span> <span data-start="1268.149" data-end="1269.5">admit that some of the potential</span> <span data-start="1269.5" data-end="1271.24">downsides and enhancements and whatnot</span> <span data-start="1271.24" data-end="1273.429">we put in this deck under the hope that</span> <span data-start="1273.429" data-end="1275.44">somebody here is possibly interested in</span> <span data-start="1275.44" data-end="1278.799">say helping to implement it with us so</span> <span data-start="1278.799" data-end="1281.049">feel free to contact us if anybody is</span> <span data-start="1281.049" data-end="1282.34">interested in contributing to the</span> <span data-start="1282.34" data-end="1284.35">project I love — I'm just super pumped</span> <span data-start="1284.35" data-end="1286.029">about using this in production Google -</span> <span data-start="1286.029" data-end="1288.7">maybe not I don't know I think I would</span> <span data-start="1288.7" data-end="1295.27">so yeah this is the the project there's</span> <span data-start="1295.27" data-end="1297.399">basically so there's this file called</span> <span data-start="1297.399" data-end="1300.07">demo server j/s so because I know like</span> <span data-start="1300.07" data-end="1301.45">people are using like Express or they</span> <span data-start="1301.45" data-end="1302.71">hate Express or they using something</span> <span data-start="1302.71" data-end="1306.01">else you know this is something you need</span> <span data-start="1306.01" data-end="1307.63">to integrate into your serving stacks so</span> <span data-start="1307.63" data-end="1309.76">this demo server is a no dependency</span> <span data-start="1309.76" data-end="1312.25">thing written a note that source stuff</span> <span data-start="1312.25" data-end="1313.84">but it you know might not be suitable</span> <span data-start="1313.84" data-end="1316.24">for whatever middle-way you're using so</span> <span data-start="1316.24" data-end="1318.22">you you write your you know maybe</span> <span data-start="1318.22" data-end="1320.02">somebody writes an Express integration</span> <span data-start="1320.02" data-end="1323.409">that reps this module server j/s and the</span> <span data-start="1323.409" data-end="1327.7">module graph thing yeah let's let's uh</span> <span data-start="1327.7" data-end="1329.95">you know I don't have the best demo in</span> <span data-start="1329.95" data-end="1337.059">the world this is the demo you can load</span> <span data-start="1337.059" data-end="1341.59">more code well as you can see you know</span> <span data-start="1341.59" data-end="1346.36">these are the there's like the ugly URLs</span> <span data-start="1346.36" data-end="1349.299">for the incremental loads but you know</span> <span data-start="1349.299" data-end="1353.02">because with source Maps you</span> <span data-start="1353.02" data-end="1356.02">you know they actual I think we can do</span> <span data-start="1356.02" data-end="1359.67">this much better</span> <span data-start="1359.68" data-end="1361.57">you know these are the actual you know</span> <span data-start="1361.57" data-end="1364.81">standard common J's modules and so it</span> <span data-start="1364.81" data-end="1366.55">should even be nice in developing but</span> <span data-start="1366.55" data-end="1368.79">you can also like just use AMD</span> <span data-start="1368.79" data-end="1371.23">require.js and development and then you</span> <span data-start="1371.23" data-end="1373.93">know when when you go to oh you know</span> </p>
<p><span data-start="1373.93" data-end="1375.58">I wrote a megabyte of JavaScript</span> <span data-start="1375.58" data-end="1378.19">I wrote a megabyte of JavaScript eventually you port to this for</span> <span data-start="1378.19" data-end="1383.47">production and I think that's it thank</span> <span data-start="1383.47" data-end="1395.08">you we did want to mention that you know</span> <span data-start="1395.08" data-end="1397.36">this was kinda lot of input will be at</span> <span data-start="1397.36" data-end="1399.67">the google boost in the next break but</span> <span data-start="1399.67" data-end="1407.56">now we are open for questions so closure</span> <span data-start="1407.56" data-end="1410.17">already provides module loader along</span> <span data-start="1410.17" data-end="1411.64">with the modules ation in the</span> <span data-start="1411.64" data-end="1414.91">compilation as as you stressed it so is</span> <span data-start="1414.91" data-end="1417.25">the advantage here that you can change</span> <span data-start="1417.25" data-end="1419.71">the which dependencies you pull in at</span> <span data-start="1419.71" data-end="1421.12">run time rather than statically</span> <span data-start="1421.12" data-end="1424.75">beforehand so I mean dependency and that</span> <span data-start="1424.75" data-end="1428.44">was static but at runtime you say you</span> <span data-start="1428.44" data-end="1429.49">know</span> <span data-start="1429.49" data-end="1431.95">so you basically say this is my whole</span> <span data-start="1431.95" data-end="1435.01">app universe but you start with a subset</span> <span data-start="1435.01" data-end="1437.08">and then at runtime you say now I load</span> <span data-start="1437.08" data-end="1439.98">this other subset of my application and</span> <span data-start="1439.98" data-end="1442.18">you know that's the incremental thing</span> <span data-start="1442.18" data-end="1445.09">also so the closure library which is</span> <span data-start="1445.09" data-end="1446.11">nothing to do with the closure compiler</span> <span data-start="1446.11" data-end="1448.99">has some kind of a module loader in it</span> <span data-start="1448.99" data-end="1450.61">but it's not meant to be used outside</span> <span data-start="1450.61" data-end="1454.42">development except when you compile into</span> <span data-start="1454.42" data-end="1455.95">one big file which is awesome you know</span> <span data-start="1455.95" data-end="1457.54">but this was kind of a point that you</span> <span data-start="1457.54" data-end="1458.59">don't have to and we've been working</span> <span data-start="1458.59" data-end="1460.39">with them to possibly integrate some of</span> <span data-start="1460.39" data-end="1461.8">these techniques into that lawyer as</span> <span data-start="1461.8" data-end="1471.04">well okay</span> </p>
<p><span data-start="1471.05" data-end="1473.93">Hey expect you to have some long</span> <span data-start="1473.93" data-end="1476.39">expiration time on the for caching on</span> <span data-start="1476.39" data-end="1478.67">those goods so how do you change the URL</span> <span data-start="1478.67" data-end="1480.38">when you release or patch out new</span> <span data-start="1480.38" data-end="1482.27">versions so there's a couple of</span> <span data-start="1482.27" data-end="1483.62">different scheme schemes for doing that</span> <span data-start="1483.62" data-end="1486.26">the way that we happen to have implanted</span> <span data-start="1486.26" data-end="1488.45">it within Plus is basically we send</span> <span data-start="1488.45" data-end="1490.25">along a URL template with every request</span> <span data-start="1490.25" data-end="1492.68">in that template basically has encoded</span> <span data-start="1492.68" data-end="1495.32">within it the version which is basically</span> <span data-start="1495.32" data-end="1498.59">just a hash of all the content of the</span> <span data-start="1498.59" data-end="1502.88">entire set of code so it's a template</span> <span data-start="1502.88" data-end="1505.43">because you the modules that you want to</span> <span data-start="1505.43" data-end="1507.8">load are what's template template it in</span> <span data-start="1507.8" data-end="1510.41">so from there but basically we just push</span> <span data-start="1510.41" data-end="1518.22">a new template and you get a new code</span> <span data-start="1518.23" data-end="1521.89">one more</span> <span data-start="1521.9" data-end="1525.02">one more question separate topic how</span> <span data-start="1525.02" data-end="1527.75">much does how much size impact does the</span> <span data-start="1527.75" data-end="1531.08">global name spacing add so we when we</span> <span data-start="1531.08" data-end="1531.919">took a look at this</span> <span data-start="1531.919" data-end="1536.48">we noticed so it's roughly 2 or maybe 3</span> <span data-start="1536.48" data-end="1541.13">bytes per property access like on we use</span> <span data-start="1541.13" data-end="1542.659">underbar it can be an S dot or something</span> <span data-start="1542.659" data-end="1544.85">of that nature so our increase was</span> <span data-start="1544.85" data-end="1546.26">something on the order of like 3 to 4</span> <span data-start="1546.26" data-end="1547.85">percent but at G zips to essentially</span> <span data-start="1547.85" data-end="1550.61">zero because the the underbar dot is</span> <span data-start="1550.61" data-end="1552.47">repeated so many times and the same is</span> <span data-start="1552.47" data-end="1554.029">true actually for the window dot prefix</span> <span data-start="1554.029" data-end="1556.1">you just get window dot everywhere so</span> <span data-start="1556.1" data-end="1560.13">gzip stole most nothing</span> <span data-start="1560.14" data-end="1563.51">okay that's but also tanika's there is a</span> <span data-start="1563.51" data-end="1566.809">performance problem if any v8 people are</span> <span data-start="1566.809" data-end="1568.309">listening maybe they can fix it because</span> <span data-start="1568.309" data-end="1569.69">we add like all these properties on this</span> <span data-start="1569.69" data-end="1572.57">one thing we always said so we don't</span> <span data-start="1572.57" data-end="1574.52">currently use this and if you know you</span> <span data-start="1574.52" data-end="1576.23">don't need it and so where were you</span> <span data-start="1576.23" data-end="1577.88">performance critical we don't need it we</span> <span data-start="1577.88" data-end="1581.929">don't use it but you could think about</span> <span data-start="1581.929" data-end="1583.97">using erase instead and that'll be super</span> <span data-start="1583.97" data-end="1589.49">fast too but a bit bigger okay all right</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
