<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="JSConf transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NGxVLnJKhP8</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/NGxVLnJKhP8?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="13.809" data-end="17.93">hi everyone I'm Lin Clark and I make</span> <span data-start="17.93" data-end="21.02">Coke cartoons and I also work at Mozilla</span> <span data-start="21.02" data-end="24.25">of course we make the Firefox browser</span> <span data-start="24.25" data-end="26.75">but you might not know we have a few</span> <span data-start="26.75" data-end="28.399">other browser projects in the works at</span> <span data-start="28.399" data-end="30.2">the moment too and one of them uses</span> <span data-start="30.2" data-end="32.87">react so I was working on this project I</span> <span data-start="32.87" data-end="34.76">was hacking on it I thought I should</span> <span data-start="34.76" data-end="37.07">really dive more deeply into Reax</span> <span data-start="37.07" data-end="39.05">internals to see how it's doing things</span> <span data-start="39.05" data-end="41.059">so that I can make our project more</span> <span data-start="41.059" data-end="44.149">performant and what happened when I do</span> <span data-start="44.149" data-end="45.23">that is I had to step through the</span> <span data-start="45.23" data-end="47.749">virtual Dom algorithm over and over and</span> <span data-start="47.749" data-end="49.67">over and over and over and over again</span> <span data-start="49.67" data-end="51.71">and so I figured as long as I had gone</span> <span data-start="51.71" data-end="53.239">through that process I might as well</span> <span data-start="53.239" data-end="54.92">write it down and turn it into a cartoon</span> <span data-start="54.92" data-end="56.989">so that other people could share the</span> <span data-start="56.989" data-end="59.839">benefit of that so that is what started</span> <span data-start="59.839" data-end="63.199">this talk I'm gonna be focusing on the</span> <span data-start="63.199" data-end="65.54">performance what you can do to make your</span> <span data-start="65.54" data-end="67.67">react apps more performant and I should</span> <span data-start="67.67" data-end="69.59">start by saying that I'm not gonna be</span> <span data-start="69.59" data-end="70.67">telling you anything that you don't</span> <span data-start="70.67" data-end="72.799">already know I'm gonna be talking about</span> <span data-start="72.799" data-end="75.02">things like keys and should component</span> <span data-start="75.02" data-end="78.47">update and immutability the reason I</span> <span data-start="78.47" data-end="80.44">wanted to talk about them though is</span> <span data-start="80.44" data-end="83.69">because I think that we often have this</span> <span data-start="83.69" data-end="86.69">fuzzy concept of the ideas around</span> <span data-start="86.69" data-end="88.46">performance again we don't really take</span> <span data-start="88.46" data-end="90.47">the time to bring those concepts into</span> <span data-start="90.47" data-end="94.37">focus so this means that the knowledge</span> <span data-start="94.37" data-end="95.72">about these ideas</span> <span data-start="95.72" data-end="98.81">it's just received knowledge you know</span> <span data-start="98.81" data-end="100.43">you just add a show component update</span> <span data-start="100.43" data-end="102.38">because somebody told you on was</span> <span data-start="102.38" data-end="103.91">standing on a stage and they told you to</span> <span data-start="103.91" data-end="107.45">do that but not all recommendations work</span> <span data-start="107.45" data-end="110.45">the same in all situations so I want to</span> <span data-start="110.45" data-end="112.07">bring these concepts around performance</span> <span data-start="112.07" data-end="114.92">into focus so that you can have a better</span> <span data-start="114.92" data-end="117.2">understanding of the why behind each</span> <span data-start="117.2" data-end="120.68">recommendation and I should also say</span> <span data-start="120.68" data-end="122.39">before I start that I'm focusing on a</span> <span data-start="122.39" data-end="125.12">very specific part of render perform of</span> <span data-start="125.12" data-end="127.1">performance and react and that is</span> <span data-start="127.1" data-end="129.709">performance during the render cycle so</span> <span data-start="129.709" data-end="131.09">other things that you can do to make</span> <span data-start="131.09" data-end="133.43">react more performant are things like if</span> <span data-start="133.43" data-end="135.349">you're in production use the production</span> <span data-start="135.349" data-end="137.03">version of react those kinds of things</span> <span data-start="137.03" data-end="138.86">does have a huge impact and a lot of</span> <span data-start="138.86" data-end="140.42">people slip up and don't realize that</span> <span data-start="140.42" data-end="142.73">they're doing that but</span> </p>
<p><span data-start="142.73" data-end="143.93">I'm not gonna talk about those little</span> <span data-start="143.93" data-end="148.61">gotchas so the talks gonna go a little</span> <span data-start="148.61" data-end="149.45">something like this</span> <span data-start="149.45" data-end="151.94">first I'm gonna talk about the basics of</span> <span data-start="151.94" data-end="153.47">rendering in the browser so how the</span> <span data-start="153.47" data-end="155">browser actually renders your web page</span> <span data-start="155" data-end="156.98">and what parts of that can possibly be</span> <span data-start="156.98" data-end="160.459">slow and then I'm gonna talk about what</span> <span data-start="160.459" data-end="162.86">react does to minimize and batch Dom</span> <span data-start="162.86" data-end="165.319">changes with the virtual Dom to make it</span> <span data-start="165.319" data-end="168.799">a little bit faster and then I'm gonna</span> <span data-start="168.799" data-end="173.09">cover what you can do to make react even</span> <span data-start="173.09" data-end="177.86">faster than that so let's start with</span> <span data-start="177.86" data-end="179.93">number one how the browser builds your</span> <span data-start="179.93" data-end="181.79">web page how it actually renders the</span> <span data-start="181.79" data-end="185.81">page and what parts are slow and you can</span> <span data-start="185.81" data-end="187.34">kind of think of this in the same way</span> <span data-start="187.34" data-end="189.799">that you think of developing the website</span> <span data-start="189.799" data-end="192.47">yourself so there's work that takes</span> <span data-start="192.47" data-end="194.599">place over time and there's an initial</span> <span data-start="194.599" data-end="196.64">period of work this would be before the</span> <span data-start="196.64" data-end="198.23">initial launch if you were developing</span> <span data-start="198.23" data-end="200.019">you know in the development process and</span> <span data-start="200.019" data-end="203.23">in react this is the initial render and</span> <span data-start="203.23" data-end="206.54">then there are updates that happen after</span> <span data-start="206.54" data-end="209.54">that so in if you were working on a</span> <span data-start="209.54" data-end="211.04">project that would be any feature</span> <span data-start="211.04" data-end="214.669">updates if you're working in react that</span> <span data-start="214.669" data-end="215.78">is gonna be something like this that</span> <span data-start="215.78" data-end="220.669">says date updating the UI to extend this</span> <span data-start="220.669" data-end="222.29">metaphor your code is kind of like the</span> <span data-start="222.29" data-end="223.88">project Li planning the project and</span> <span data-start="223.88" data-end="226.72">telling folks what to do unfortunately</span> <span data-start="226.72" data-end="229.94">your code only has one person working on</span> <span data-start="229.94" data-end="232.25">this project for it and that's the main</span> <span data-start="232.25" data-end="236.18">thread so the main thread is kind of</span> <span data-start="236.18" data-end="239.48">like a JavaScript developer it err sorry</span> <span data-start="239.48" data-end="240.819">it's kind of like a full-stack developer</span> <span data-start="240.819" data-end="244.419">it covers JavaScript the Dom and layout</span> <span data-start="244.419" data-end="246.349">just as when you're working on a project</span> <span data-start="246.349" data-end="248.84">in real life if you only have one person</span> <span data-start="248.84" data-end="250.28">working on the project you're gonna</span> <span data-start="250.28" data-end="252.739">limit the number of tasks that you</span> <span data-start="252.739" data-end="255.169">assign to that one person if you want</span> <span data-start="255.169" data-end="259.039">that project to be delivered on time but</span> <span data-start="259.039" data-end="260.84">before we know how to reduce the amount</span> <span data-start="260.84" data-end="262.669">of work that the main thread is doing we</span> <span data-start="262.669" data-end="264.65">need to know more about the work that</span> <span data-start="264.65" data-end="267.44">the main thread does so as I mentioned</span> <span data-start="267.44" data-end="269.449">before the main thread is in charge of</span> </p>
<p><span data-start="269.449" data-end="271.88">JavaScript so this is you know you're</span> <span data-start="271.88" data-end="273.11">familiar with JavaScript this is where</span> <span data-start="273.11" data-end="274.64">you define your functions where you call</span> <span data-start="274.64" data-end="278.34">functions</span> <span data-start="278.35" data-end="282.02">the DOM is the way the functions tell</span> <span data-start="282.02" data-end="283.57">the page what to do</span> <span data-start="283.57" data-end="285.68">basically the Dom gives you a set of</span> <span data-start="285.68" data-end="287.39">objects that you can move around and</span> <span data-start="287.39" data-end="289.85">manipulate in order to change what the</span> <span data-start="289.85" data-end="292.49">browsers rendering and the way that this</span> <span data-start="292.49" data-end="293.84">works is that there's something behind</span> <span data-start="293.84" data-end="296.36">the scenes called the render tree and so</span> <span data-start="296.36" data-end="298.37">the main thread combines the Dom with</span> </p>
<p><span data-start="298.37" data-end="301.22">CSS to create the render tree and it</span> <span data-start="301.22" data-end="302.54">figures out a thing from that called the</span> <span data-start="302.54" data-end="305.33">box model and this is what it passes off</span> <span data-start="305.33" data-end="306.95">to the thing that actually passes the</span> <span data-start="306.95" data-end="310.31">pixels to the page this little process</span> <span data-start="310.31" data-end="312.47">is called a reflow and that computation</span> <span data-start="312.47" data-end="314.93">takes a bit of time so the main thread</span> <span data-start="314.93" data-end="316.88">doesn't do it on every single Dom change</span> <span data-start="316.88" data-end="318.59">instead what it tries to do is bash</span> <span data-start="318.59" data-end="320.69">those changes together so that it can</span> <span data-start="320.69" data-end="323.24">cover more of them in a single pass</span> <span data-start="323.24" data-end="326.9">through computing the render tree so the</span> <span data-start="326.9" data-end="328.73">way this works is you know your code</span> <span data-start="328.73" data-end="330.8">might say change the class name on that</span> <span data-start="330.8" data-end="333.98">button and then the main thread goes</span> <span data-start="333.98" data-end="338.12">over and does it and then additive the</span> <span data-start="338.12" data-end="339.59">main thread goes over and does it and</span> <span data-start="339.59" data-end="341.75">then add another button the main thread</span> <span data-start="341.75" data-end="344.78">goes over and does it the main thread</span> <span data-start="344.78" data-end="347.51">will also meet a note to itself sometime</span> <span data-start="347.51" data-end="349.4">in the future I need to recalculate that</span> <span data-start="349.4" data-end="351.68">render tree and so when that time in the</span> <span data-start="351.68" data-end="353.93">future comes is going to go over to the</span> <span data-start="353.93" data-end="356.69">render tree and calculate all of those</span> <span data-start="356.69" data-end="360.68">things together so we want to reduce the</span> <span data-start="360.68" data-end="361.82">amount of work that the main thread is</span> <span data-start="361.82" data-end="364.58">doing here you might have figured out</span> <span data-start="364.58" data-end="367.94">two good ways one way is to reduce the</span> <span data-start="367.94" data-end="371.12">number of Dom changes and another way is</span> <span data-start="371.12" data-end="373.49">to batch those Dom changes together in</span> <span data-start="373.49" data-end="375.47">time so that the main thread can take</span> <span data-start="375.47" data-end="376.88">care of all that recalculation on the</span> <span data-start="376.88" data-end="379.88">same reflow and this is something that</span> <span data-start="379.88" data-end="382.85">react helps you do now I want to be</span> <span data-start="382.85" data-end="384.98">clear react isn't the only way to do</span> <span data-start="384.98" data-end="386.78">this it's actually not even a necessary</span> <span data-start="386.78" data-end="389.57">way of doing this these ideas have been</span> <span data-start="389.57" data-end="392.12">around since well before react so it's</span> <span data-start="392.12" data-end="393.68">not that react is necessarily more</span> <span data-start="393.68" data-end="397.64">performant than vanilla JavaScript the</span> <span data-start="397.64" data-end="399.65">thing is in order to get these</span> <span data-start="399.65" data-end="401.81">performance gains your code has to be</span> <span data-start="401.81" data-end="404.36">smart your code needs to know how to</span> <span data-start="404.36" data-end="406.7">direct the main thread pretty precisely</span> <span data-start="406.7" data-end="408.66">to do these things</span> <span data-start="408.66" data-end="411.01">so go back to the metaphor your code</span> <span data-start="411.01" data-end="412.15">needs to be able it's a really really</span> <span data-start="412.15" data-end="414.58">good product manager it needs to know</span> <span data-start="414.58" data-end="418.33">what to display in this webpage and it</span> <span data-start="418.33" data-end="419.71">also needs to be a really really good</span> <span data-start="419.71" data-end="421.69">tech lead it needs to know how to build</span> <span data-start="421.69" data-end="425.33">the page in the most efficient way of</span> <span data-start="425.34" data-end="427.75">course your code is only as smart as you</span> <span data-start="427.75" data-end="429.67">make it so that means that all of the</span> <span data-start="429.67" data-end="430.93">developers on your team have to have a</span> <span data-start="430.93" data-end="433.54">really solid understanding of how these</span> <span data-start="433.54" data-end="435.85">things work together and they need to</span> <span data-start="435.85" data-end="437.59">not be prone to making mistakes they</span> <span data-start="437.59" data-end="439.24">always need to be on their game on top</span> <span data-start="439.24" data-end="439.93">of their game</span> <span data-start="439.93" data-end="441.97">so what react does for you is it</span> <span data-start="441.97" data-end="444.97">offloads that work it's kind of like</span> <span data-start="444.97" data-end="446.95">your code brings in the consultant to do</span> <span data-start="446.95" data-end="449.62">all the tech leave work and that frees</span> <span data-start="449.62" data-end="450.94">up your code just to be a good product</span> <span data-start="450.94" data-end="453.25">manager so that your code can just focus</span> <span data-start="453.25" data-end="455.26">on what needs to be displayed not on how</span> <span data-start="455.26" data-end="458.8">to make it happen so let's take a look</span> <span data-start="458.8" data-end="460.99">at how these to react in your code work</span> <span data-start="460.99" data-end="463.24">together to direct the main thread in</span> <span data-start="463.24" data-end="466.75">shipping and I won't be showing the main</span> <span data-start="466.75" data-end="467.92">thread through the rest of the slides</span> <span data-start="467.92" data-end="469.63">but just assume wherever you're seeing</span> <span data-start="469.63" data-end="473.1">work being done the main thread is there</span> <span data-start="473.1" data-end="475.87">so this brings us to part two how react</span> <span data-start="475.87" data-end="478.68">minimizes work using the virtual DOM and</span> </p>
<p><span data-start="478.68" data-end="481.54">I'm going to start this off with a UI</span> <span data-start="481.54" data-end="485.05">that we're gonna build so this UI is</span> <span data-start="485.05" data-end="487">just a list of numbers and when you</span> <span data-start="487" data-end="490.03">click the button the numbers multiply by</span> <span data-start="490.03" data-end="492.82">itself so let's walk through the initial</span> <span data-start="492.82" data-end="495.49">render on this most are from the very</span> <span data-start="495.49" data-end="498.64">beginning a user is downloaded some HTML</span> <span data-start="498.64" data-end="501.37">and it's been parsed and there is an</span> <span data-start="501.37" data-end="502.84">HTML element that's going to serve as</span> <span data-start="502.84" data-end="506.83">the container for the react app and your</span> <span data-start="506.83" data-end="508.36">code has been loaded and react has been</span> <span data-start="508.36" data-end="510.04">loaded along with your code these things</span> <span data-start="510.04" data-end="512.169">called components have been loaded and</span> <span data-start="512.169" data-end="513.61">so these are kind of like deputy product</span> <span data-start="513.61" data-end="515.229">managers that know about specific parts</span> <span data-start="515.229" data-end="517.08">of the page and what they should render</span> <span data-start="517.08" data-end="520.93">and in case you aren't familiar this is</span> <span data-start="520.93" data-end="523.96">what code that corresponds to react Dom</span> <span data-start="523.96" data-end="526.93">render and then the first parameter is</span> <span data-start="526.93" data-end="530.77">list asking as a react element and then</span> <span data-start="530.77" data-end="533.2">the second parameter is the HTML</span> <span data-start="533.2" data-end="534.49">container that we were just talking</span> <span data-start="534.49" data-end="536.02">about so we covered that HTML container</span> <span data-start="536.02" data-end="540.76">but what is the react element</span> <span data-start="540.77" data-end="542.72">it's a way for your code to handoff</span> <span data-start="542.72" data-end="545.3">requirements to react to tell react what</span> <span data-start="545.3" data-end="548.18">needs to be displayed so following the</span> <span data-start="548.18" data-end="550.52">analogy it's like a little note card</span> <span data-start="550.52" data-end="552.2">that has a few notes about what react</span> <span data-start="552.2" data-end="555.95">needs to build it has the type which is</span> <span data-start="555.95" data-end="557.33">the component that's gonna be used to</span> <span data-start="557.33" data-end="559.459">build the thing and has the props and</span> <span data-start="559.459" data-end="562.31">children and reacts gonna hold on to the</span> <span data-start="562.31" data-end="563.63">style element is just gonna tuck this</span> <span data-start="563.63" data-end="565.37">note card away until it's ready to build</span> <span data-start="565.37" data-end="569.72">the thing the thing that it builds using</span> <span data-start="569.72" data-end="571.19">these specs using this these</span> <span data-start="571.19" data-end="573.5">requirements is an instance of the</span> <span data-start="573.5" data-end="576.38">component so an instance is the thing</span> <span data-start="576.38" data-end="578.66">that holds on to the state is the thing</span> <span data-start="578.66" data-end="580.37">that you call this dot set state on the</span> <span data-start="580.37" data-end="583.24">thing that holds on to the Refs</span> <span data-start="583.24" data-end="585.98">it's the thing that react uses to figure</span> <span data-start="585.98" data-end="587.18">out whether or not it means to update</span> <span data-start="587.18" data-end="590.3">the Dom but you don't actually interact</span> <span data-start="590.3" data-end="591.74">with instances too much you don't need</span> <span data-start="591.74" data-end="593.75">to manage instances react manages the</span> <span data-start="593.75" data-end="596.12">instances for you you just need to give</span> <span data-start="596.12" data-end="597.98">it these requirements and form of</span> <span data-start="597.98" data-end="601.49">elements so your code asks for an</span> <span data-start="601.49" data-end="605.51">element and react creates it and then</span> <span data-start="605.51" data-end="607.25">your code tells react to start rendering</span> <span data-start="607.25" data-end="609.35">this is react Dom render your code tells</span> <span data-start="609.35" data-end="611.3">react to start rendering that element</span> <span data-start="611.3" data-end="614.089">into the container and this begins</span> <span data-start="614.089" data-end="617.839">construction of reacts render tree now</span> <span data-start="617.839" data-end="619.399">if you don't follow I'm gonna have to</span> <span data-start="619.399" data-end="621.17">move through this pretty quickly but</span> <span data-start="621.17" data-end="623.06">this is being recorded so you can catch</span> <span data-start="623.06" data-end="625.22">up on it there and if you want a version</span> <span data-start="625.22" data-end="628.13">of this for yourself I've posted it on</span> </p>
<p><span data-start="628.13" data-end="630.74">Twitter both Lin Clark & Co cartoons so</span> <span data-start="630.74" data-end="632.42">you can go there and download a version</span> <span data-start="632.42" data-end="636.14">of this I should say say before I start</span> <span data-start="636.14" data-end="638.029">going through this algorithm it has</span> <span data-start="638.029" data-end="639.95">changed it actually has changed since I</span> <span data-start="639.95" data-end="641.87">started writing this talk and it will</span> <span data-start="641.87" data-end="644.089">change again there are some pretty big</span> <span data-start="644.089" data-end="645.56">changes to this algorithm in the</span> <span data-start="645.56" data-end="648.44">pipeline currently but for now this is</span> <span data-start="648.44" data-end="651.709">how it works so react starts by creating</span> <span data-start="651.709" data-end="653.329">this thing called a top level wrapper</span> <span data-start="653.329" data-end="656.63">and it's just a little implementation</span> <span data-start="656.63" data-end="658.22">detail it makes it easier for react to</span> <span data-start="658.22" data-end="661.91">wrap up some stuff together then it</span> <span data-start="661.91" data-end="663.32">creates an instance of that top level</span> <span data-start="663.32" data-end="665.24">wrapper and it sets it so that when it</span> <span data-start="665.24" data-end="666.86">calls render on that top level wrapper</span> <span data-start="666.86" data-end="670.22">is going to render to the list this is</span> <span data-start="670.22" data-end="672.65">the raft element that was passed in</span> <span data-start="672.65" data-end="674.57">which has now been instantiated</span> <span data-start="674.57" data-end="676.73">so it's that's the province date on the</span> <span data-start="676.73" data-end="678.59">list and then it wants to create the</span> <span data-start="678.59" data-end="682.07">corresponding Dom for the list but</span> <span data-start="682.07" data-end="684.11">unfortunately it doesn't know how you</span> <span data-start="684.11" data-end="687.2">know if this were a div react knows</span> <span data-start="687.2" data-end="689.57">about divs and knows what Dom it needs</span> <span data-start="689.57" data-end="691.31">to create for a div react element it</span> <span data-start="691.31" data-end="694.55">needs to create a div HTML element but</span> <span data-start="694.55" data-end="695.75">since this is something that it doesn't</span> <span data-start="695.75" data-end="698.54">know about it's gonna have to ask so it</span> <span data-start="698.54" data-end="701.6">asks the component and list responds</span> <span data-start="701.6" data-end="703.64">okay well I'm gonna need you to create</span> <span data-start="703.64" data-end="705.26">some elements for me I need you to</span> <span data-start="705.26" data-end="707.39">create a button element and I need you</span> <span data-start="707.39" data-end="709.19">to create for each thing that's in my</span> <span data-start="709.19" data-end="712.43">this dot state items list I need you to</span> <span data-start="712.43" data-end="715.58">create an item element and then I need</span> <span data-start="715.58" data-end="718.87">you to create a div to wrap all of those</span> <span data-start="718.87" data-end="721.79">so reactive takes all those elements</span> <span data-start="721.79" data-end="724.49">builds them out and then tucks them away</span> <span data-start="724.49" data-end="725.81">and the only one that it cares about</span> <span data-start="725.81" data-end="728.21">right now is that wrapping div so it'll</span> <span data-start="728.21" data-end="731.45">pull that out of the pile and create the</span> <span data-start="731.45" data-end="735.71">instance for that and because this is a</span> <span data-start="735.71" data-end="737.18">div it knows what the AMA needs to</span> <span data-start="737.18" data-end="738.77">create for the div so it goes over to</span> <span data-start="738.77" data-end="741.5">the Dom and creates that no note it</span> <span data-start="741.5" data-end="744.91">didn't actually make that div a child of</span> <span data-start="744.91" data-end="748.25">the container that's there that would</span> <span data-start="748.25" data-end="751.13">have scheduled that reflow instead what</span> <span data-start="751.13" data-end="752.84">it wants to do is wait until all of the</span> <span data-start="752.84" data-end="754.64">nodes are there before it schedules that</span> <span data-start="754.64" data-end="758.66">reflow so now to do that to get all</span> <span data-start="758.66" data-end="759.92">those dominoes there is gonna need to</span> <span data-start="759.92" data-end="761.6">create instances of all of the children</span> <span data-start="761.6" data-end="764.42">and for this that goes from a complex to</span> <span data-start="764.42" data-end="766.75">a simple structure it goes from this</span> <span data-start="766.75" data-end="771.49">nested array into an object and that</span> <span data-start="771.49" data-end="774.32">object has property names that</span> <span data-start="774.32" data-end="775.7">correspond to the structure of that</span> <span data-start="775.7" data-end="779.24">array so the first item is dot 0 the the</span> <span data-start="779.24" data-end="781.1">name of the first item is dot 0 and</span> <span data-start="781.1" data-end="783.35">that's because the button was the 0th</span> <span data-start="783.35" data-end="787.16">item in that array now the items they</span> <span data-start="787.16" data-end="789.77">have more complex names because they're</span> <span data-start="789.77" data-end="792.65">in a nested structure so dot one dot 0</span> <span data-start="792.65" data-end="794.75">is the first item dot one dot one is the</span> <span data-start="794.75" data-end="798.47">second item so react takes this</span> <span data-start="798.47" data-end="800.03">flattened list increased the instances</span> <span data-start="800.03" data-end="802.7">from that now it's time to make the Dom</span> <span data-start="802.7" data-end="805.36">elements</span> <span data-start="805.37" data-end="808.04">so react knows how to create the Dom for</span> <span data-start="808.04" data-end="810.61">a button and it goes over and does that</span> <span data-start="810.61" data-end="813.77">then it gets the items and once again</span> <span data-start="813.77" data-end="815.18">these are things that it doesn't know</span> <span data-start="815.18" data-end="816.98">how to create the Dom for so it has to</span> <span data-start="816.98" data-end="819.41">ask again and so the item is going to</span> <span data-start="819.41" data-end="820.58">say okay I need you to create a div</span> <span data-start="820.58" data-end="822.83">element and take the prop that was</span> <span data-start="822.83" data-end="824.33">passed in to me and turn that into text</span> <span data-start="824.33" data-end="828.62">content so we got crease the element and</span> <span data-start="828.62" data-end="831.5">then the instance and then the Dom node</span> <span data-start="831.5" data-end="833.78">it does this two more times to get that</span> <span data-start="833.78" data-end="838.13">full set of Dom nodes then it goes over</span> <span data-start="838.13" data-end="839.9">to the Dom and it wires up all of those</span> <span data-start="839.9" data-end="843.08">children to their parent and then hooks</span> <span data-start="843.08" data-end="845.03">up the wrapper div to the container div</span> <span data-start="845.03" data-end="848.06">and this is what's gonna trigger that</span> <span data-start="848.06" data-end="852.38">reflow but you notice that it waited to</span> <span data-start="852.38" data-end="854.3">the end to trigger that that's that</span> <span data-start="854.3" data-end="856.57">batching that I was talking about before</span> <span data-start="856.57" data-end="859.16">that way the main thread can handle</span> <span data-start="859.16" data-end="864.29">these changes all at once so we get our</span> <span data-start="864.29" data-end="866.12">riu I and it's ready for people to</span> <span data-start="866.12" data-end="870.53">interact with it let's see how the how</span> <span data-start="870.53" data-end="872.12">the virtual Dom actually handles that</span> <span data-start="872.12" data-end="875.72">user interaction so the users going to</span> <span data-start="875.72" data-end="878.96">click the button and react figures out</span> <span data-start="878.96" data-end="881.45">the onclick handler for the click and it</span> <span data-start="881.45" data-end="883.73">does this using something called event</span> <span data-start="883.73" data-end="885.59">delegation unfortunately I don't have</span> <span data-start="885.59" data-end="888.23">time to go into what event delegation is</span> <span data-start="888.23" data-end="890.66">but you can find an explanation of it</span> <span data-start="890.66" data-end="893.96">and the react Doc's so from there calls</span> <span data-start="893.96" data-end="895.97">the handler and the handler would be</span> <span data-start="895.97" data-end="897.47">code like this you know you get a list</span> <span data-start="897.47" data-end="899.24">of items from the state perform</span> <span data-start="899.24" data-end="901.67">operations on the items then call set</span> <span data-start="901.67" data-end="904.04">state with the items and if he thinks</span> <span data-start="904.04" data-end="905.78">that you see a possible bug with this</span> <span data-start="905.78" data-end="909.25">code we're gonna get to that later</span> <span data-start="909.25" data-end="911.48">so the handler would have been defined</span> <span data-start="911.48" data-end="915.05">in the list component it would have been</span> <span data-start="915.05" data-end="918.98">bound to the list instance when it calls</span> <span data-start="918.98" data-end="923.96">this thought set state it calls set</span> <span data-start="923.96" data-end="928.04">state on that list instance so what</span> <span data-start="928.04" data-end="931.31">happens when set state is called what</span> <span data-start="931.31" data-end="934.04">react does is it sets up a few different</span> <span data-start="934.04" data-end="937.58">lists it takes the partial state that</span> <span data-start="937.58" data-end="939.17">was passed in with this dot set state</span> <span data-start="939.17" data-end="940.939">and it adds it to an array on the</span> <span data-start="940.939" data-end="943.309">instance of pending state changes and</span> <span data-start="943.309" data-end="946.249">then it takes that instance and it adds</span> <span data-start="946.249" data-end="947.509">it to this thing called the dirty</span> <span data-start="947.509" data-end="949.939">components array and these are all of</span> <span data-start="949.939" data-end="951.529">the things that are going to need to be</span> <span data-start="951.529" data-end="953.209">updated but it doesn't take care of</span> <span data-start="953.209" data-end="955.669">those yet it waits to see if that</span> <span data-start="955.669" data-end="957.29">clickhandler might have done any other</span> <span data-start="957.29" data-end="959.6">things might have set ste on any other</span> <span data-start="959.6" data-end="961.579">instances before it actually starts</span> <span data-start="961.579" data-end="965.209">processing this once it's figured out if</span> <span data-start="965.209" data-end="966.98">there have or haven't been any other</span> <span data-start="966.98" data-end="968.839">updates it goes through and it flushes</span> <span data-start="968.839" data-end="972.709">this cue and since this is the only</span> <span data-start="972.709" data-end="973.999">thing on this cue this is the only thing</span> <span data-start="973.999" data-end="978.589">that we're going to process so we start</span> <span data-start="978.589" data-end="979.85">with the instance that had sets they</span> <span data-start="979.85" data-end="983.179">called and work down from there I'm just</span> <span data-start="983.179" data-end="985.549">praying everything out react hold on to</span> <span data-start="985.549" data-end="986.629">all of these things so it can do</span> <span data-start="986.629" data-end="987.98">comparisons between the previous and the</span> <span data-start="987.98" data-end="990.949">next but this will make it easier for</span> <span data-start="990.949" data-end="996.199">you to see what's going on so react</span> <span data-start="996.199" data-end="998.359">calculates the next state on the</span> <span data-start="998.359" data-end="1002.649">instance and sets that and then it has</span> <span data-start="1002.649" data-end="1006.309">to ask the component okay now that you</span> <span data-start="1006.309" data-end="1008.049">have this new state what are you gonna</span> <span data-start="1008.049" data-end="1010.749">rend you to now and so the component</span> <span data-start="1010.749" data-end="1013.689">responds and it creates the new elements</span> <span data-start="1013.689" data-end="1015.16">the new set of elements that it would</span> <span data-start="1015.16" data-end="1019.36">render to and from there it updates the</span> <span data-start="1019.36" data-end="1022.119">instances and then it compares the</span> <span data-start="1022.119" data-end="1024.22">instances the previous instances to the</span> <span data-start="1024.22" data-end="1026.139">new ones and figures out whether or not</span> <span data-start="1026.139" data-end="1028.569">easy to make Dom changes so for the</span> <span data-start="1028.569" data-end="1030.25">button it doesn't need to make any Dom</span> <span data-start="1030.25" data-end="1032.589">changes because the button hasn't</span> <span data-start="1032.589" data-end="1035.47">changed at all that gets to the first</span> <span data-start="1035.47" data-end="1037.419">item and it's gonna have to ask the item</span> <span data-start="1037.419" data-end="1039.1">again what do you render to before it</span> <span data-start="1039.1" data-end="1041.559">figures out whether or not item is has</span> <span data-start="1041.559" data-end="1044.38">changed or not so item responds that</span> <span data-start="1044.38" data-end="1047.319">creates the element for that updates the</span> <span data-start="1047.319" data-end="1052.48">div instance and since there were no</span> <span data-start="1052.48" data-end="1054.97">changes you know in the previous list it</span> <span data-start="1054.97" data-end="1057.1">was one in the new list is one that text</span> <span data-start="1057.1" data-end="1059.11">content hasn't changed it figures it can</span> <span data-start="1059.11" data-end="1061.24">save a little work by not going over to</span> <span data-start="1061.24" data-end="1062.799">them not making any changes to the Dom</span> <span data-start="1062.799" data-end="1066.789">for that so then for the second one it</span> <span data-start="1066.789" data-end="1068.289">has to go through that same process it</span> <span data-start="1068.289" data-end="1070.809">updates the instance and figures out</span> <span data-start="1070.809" data-end="1072.129">actually there is a change between these</span> <span data-start="1072.129" data-end="1073.18">two so</span> <span data-start="1073.18" data-end="1074.53">goes over to the domina makes the change</span> <span data-start="1074.53" data-end="1077.47">and then it does the same thing for the</span> <span data-start="1077.47" data-end="1080.44">third one and that's when you get that</span> <span data-start="1080.44" data-end="1083.16">reflow because those two happened in</span> <span data-start="1083.16" data-end="1085.78">pretty quick succession they probably</span> <span data-start="1085.78" data-end="1089.59">hit the same reflow so this is how react</span> <span data-start="1089.59" data-end="1091.12">makes things faster figures up the</span> <span data-start="1091.12" data-end="1092.59">smallest number of changes that it needs</span> <span data-start="1092.59" data-end="1094.09">to make to the Dom and it batches them</span> <span data-start="1094.09" data-end="1095.92">all together so that the browser can do</span> <span data-start="1095.92" data-end="1098.56">a smaller number of reflows but there's</span> <span data-start="1098.56" data-end="1099.7">still a good amount of work happening</span> <span data-start="1099.7" data-end="1104.04">here so how could we reduce this and</span> <span data-start="1104.04" data-end="1106.18">this brings us to the third part of the</span> <span data-start="1106.18" data-end="1108.52">talk which is what you can do to make</span> <span data-start="1108.52" data-end="1112.93">react faster and the first technique is</span> <span data-start="1112.93" data-end="1114.64">one that you probably already know</span> <span data-start="1114.64" data-end="1117.19">because react yells at you if you don't</span> <span data-start="1117.19" data-end="1119.65">do it whenever you're creating an array</span> <span data-start="1119.65" data-end="1121.63">of children it's going to tell you that</span> <span data-start="1121.63" data-end="1122.95">you should be using keys for those</span> <span data-start="1122.95" data-end="1125.62">children so I want to show you why this</span> <span data-start="1125.62" data-end="1129.94">can help your performance to do this I'm</span> <span data-start="1129.94" data-end="1131.19">going to need to switch up my example</span> <span data-start="1131.19" data-end="1134.23">we're going to be we're gonna have a</span> <span data-start="1134.23" data-end="1136.36">list of fruits in alphabetical order and</span> <span data-start="1136.36" data-end="1138.22">when you click the button they're gonna</span> <span data-start="1138.22" data-end="1143.47">reverse order so we've gotten part of</span> <span data-start="1143.47" data-end="1144.67">the way through the set state process</span> <span data-start="1144.67" data-end="1145.63">this is where it starts to get</span> <span data-start="1145.63" data-end="1148.48">interesting this is where react is</span> <span data-start="1148.48" data-end="1150.49">actually dealing with the children those</span> <span data-start="1150.49" data-end="1153.4">items that have changed order so if you</span> <span data-start="1153.4" data-end="1155.86">remember when it was flattening them it</span> <span data-start="1155.86" data-end="1157.48">was turning that nested array into a</span> <span data-start="1157.48" data-end="1159.64">flat object and assigning these property</span> <span data-start="1159.64" data-end="1163.54">names and from that it updated the</span> <span data-start="1163.54" data-end="1165.37">instance of instances of the children</span> <span data-start="1165.37" data-end="1167.29">and then compared the old instances to</span> <span data-start="1167.29" data-end="1170.77">the new instances let's look more</span> <span data-start="1170.77" data-end="1173.7">closely at how that comparison happens</span> <span data-start="1173.7" data-end="1177.64">so reacts looking at the old set and the</span> <span data-start="1177.64" data-end="1181.72">new set and it's going to look at the</span> <span data-start="1181.72" data-end="1184.35">two things that have the same name so</span> <span data-start="1184.35" data-end="1187.72">dot one zero and one zero and each of</span> <span data-start="1187.72" data-end="1191.38">these lists so the name is just the</span> <span data-start="1191.38" data-end="1194.38">index of the array and we reversed the</span> <span data-start="1194.38" data-end="1198.13">order this means that react is comparing</span> <span data-start="1198.13" data-end="1199.75">apples to oranges quite literally in</span> <span data-start="1199.75" data-end="1202.42">this case Apple was at position zero</span> <span data-start="1202.42" data-end="1205.66">before and now oranges so when it</span> <span data-start="1205.66" data-end="1206.89">compares these two lists</span> <span data-start="1206.89" data-end="1208.87">it thinks it needs to update the values</span> <span data-start="1208.87" data-end="1210.67">of all of the items that are in the list</span> <span data-start="1210.67" data-end="1212.38">except for the middle one because they</span> <span data-start="1212.38" data-end="1217.6">all look different than they used to now</span> <span data-start="1217.6" data-end="1218.77">let's say that we had given react</span> <span data-start="1218.77" data-end="1221.08">meaningful keys something like the</span> <span data-start="1221.08" data-end="1225.01">actual name of the fruit the key would</span> <span data-start="1225.01" data-end="1228.22">then be used in that name and then react</span> <span data-start="1228.22" data-end="1231.43">can tell which of the previous instances</span> <span data-start="1231.43" data-end="1232.78">corresponds to which of the next</span> <span data-start="1232.78" data-end="1235.27">instances and you can tell that nothing</span> <span data-start="1235.27" data-end="1238.39">but change changed about the order so we</span> <span data-start="1238.39" data-end="1240.07">know that I can just reorder those Dom</span> <span data-start="1240.07" data-end="1243.1">nodes now in this case it's not a huge</span> <span data-start="1243.1" data-end="1245.89">difference but just imagine if each of</span> <span data-start="1245.89" data-end="1248.95">these were a complex Dom structure that</span> <span data-start="1248.95" data-end="1251.35">could be a real time savings only moving</span> <span data-start="1251.35" data-end="1253.83">them around instead of recreating them</span> <span data-start="1253.83" data-end="1257.08">but it's only really a time savings if</span> <span data-start="1257.08" data-end="1260.26">your list is gonna be reordered like if</span> <span data-start="1260.26" data-end="1263.08">you're going to reverse the order or</span> <span data-start="1263.08" data-end="1264.79">take something out of the middle of the</span> <span data-start="1264.79" data-end="1266.77">array if you aren't changing the order</span> <span data-start="1266.77" data-end="1268.99">then there's no real performance impact</span> <span data-start="1268.99" data-end="1271.24">to this and that's one of the reasons</span> <span data-start="1271.24" data-end="1273.37">why it's important to understand the why</span> <span data-start="1273.37" data-end="1276.07">behind any recommendation because</span> <span data-start="1276.07" data-end="1277.72">recommendations don't always have the</span> <span data-start="1277.72" data-end="1281.66">same impact across different use cases</span> <span data-start="1281.67" data-end="1284.41">so let's look at a use case where this</span> <span data-start="1284.41" data-end="1286.45">adding keys wouldn't have as much of a</span> <span data-start="1286.45" data-end="1287.95">performance impact but we're another</span> <span data-start="1287.95" data-end="1290.86">trick would so it's a list where items</span> <span data-start="1290.86" data-end="1292.27">are being fetched from a server and</span> <span data-start="1292.27" data-end="1295.27">added to the end of a list and let's say</span> <span data-start="1295.27" data-end="1297.55">the user pushes the button but there are</span> <span data-start="1297.55" data-end="1299.91">no new messages</span> <span data-start="1299.91" data-end="1302.41">so racks gonna go through the entire</span> <span data-start="1302.41" data-end="1304.3">process of building out this render tree</span> <span data-start="1304.3" data-end="1306.19">of building out the elements and the</span> <span data-start="1306.19" data-end="1309.52">instances and everything but it's not</span> <span data-start="1309.52" data-end="1312.28">going to change anything in the Dom so</span> <span data-start="1312.28" data-end="1314.23">this is called wasted time you can see</span> <span data-start="1314.23" data-end="1316.93">it react perf tools and how can we avoid</span> <span data-start="1316.93" data-end="1318.66">wasting time like this</span> </p>
<p><span data-start="1318.66" data-end="1321.1">I'm sure you've heard of one way and</span> <span data-start="1321.1" data-end="1324.85">that's should component update what</span> <span data-start="1324.85" data-end="1327.73">happens is when the user clicks and this</span> <span data-start="1327.73" data-end="1329.68">dots that state is called before</span> <span data-start="1329.68" data-end="1331.96">building up the render tree below the</span> <span data-start="1331.96" data-end="1333.58">list react will ask the component a</span> <span data-start="1333.58" data-end="1336.52">question it'll say if I give you these</span> <span data-start="1336.52" data-end="1338.59">next props and next state do you need an</span> <span data-start="1338.59" data-end="1339.57">update</span> <span data-start="1339.57" data-end="1342.799">and then the list will say no I'm good</span> <span data-start="1342.799" data-end="1345.84">so react won't call render or do</span> <span data-start="1345.84" data-end="1347.519">anything else on that component or</span> <span data-start="1347.519" data-end="1351.45">children so this is great because we can</span> <span data-start="1351.45" data-end="1353.399">skip computing the list and everything</span> <span data-start="1353.399" data-end="1354.899">under it we can save a whole lot of</span> <span data-start="1354.899" data-end="1360.149">processing there but if you were looking</span> <span data-start="1360.149" data-end="1362.389">closely at that should component update</span> <span data-start="1362.389" data-end="1364.799">you might have noticed a potential bug</span> <span data-start="1364.799" data-end="1366.809">and this works hand-in-hand with the</span> <span data-start="1366.809" data-end="1368.22">potential bug I was calling out in the</span> <span data-start="1368.22" data-end="1372.69">handler before it depends on how you're</span> <span data-start="1372.69" data-end="1375.239">updating the state so let's say you that</span> <span data-start="1375.239" data-end="1376.799">you were updating it the way that I was</span> <span data-start="1376.799" data-end="1379.049">saying where you set a new variable next</span> <span data-start="1379.049" data-end="1382.83">items to this dot state items and then</span> <span data-start="1382.83" data-end="1384.539">you push an item on the array and then</span> <span data-start="1384.539" data-end="1386.22">call set state with that next items</span> <span data-start="1386.22" data-end="1390.149">variable what would happen here is that</span> <span data-start="1390.149" data-end="1392.099">you'd never see the new items rendered</span> <span data-start="1392.099" data-end="1395.009">in your UI your should component update</span> <span data-start="1395.009" data-end="1398.629">would always return false why is that</span> <span data-start="1398.629" data-end="1400.889">it's because even though you have two</span> <span data-start="1400.889" data-end="1402.929">names for this thing they're both</span> <span data-start="1402.929" data-end="1405.899">pointing at the same object the exact</span> <span data-start="1405.899" data-end="1407.909">same thing and when you do an equals</span> <span data-start="1407.909" data-end="1410.609">check in JavaScript on object variables</span> <span data-start="1410.609" data-end="1412.379">it just checks that the two variables</span> <span data-start="1412.379" data-end="1414.629">point to the same object so even if you</span> <span data-start="1414.629" data-end="1417.57">make a change the should component</span> <span data-start="1417.57" data-end="1419.549">update is going to think that the old</span> <span data-start="1419.549" data-end="1422.729">state and the new state are the same so</span> <span data-start="1422.729" data-end="1426.809">it's not gonna see this change now you</span> <span data-start="1426.809" data-end="1428.789">could make it so that whenever you do</span> <span data-start="1428.789" data-end="1430.259">call that handler whenever you are</span> <span data-start="1430.259" data-end="1432.149">calling this offset state what you're</span> <span data-start="1432.149" data-end="1434.94">doing is creating a new object from the</span> <span data-start="1434.94" data-end="1436.169">old one using something like object</span> <span data-start="1436.169" data-end="1439.019">assign then your she'd component update</span> <span data-start="1439.019" data-end="1440.369">would see that the previous and the new</span> <span data-start="1440.369" data-end="1443.07">one are different the problem is it</span> <span data-start="1443.07" data-end="1444.69">would think that they're worth always</span> <span data-start="1444.69" data-end="1445.799">something that was different between</span> <span data-start="1445.799" data-end="1447.84">them because it was always pointing to a</span> <span data-start="1447.84" data-end="1450.359">new object so it would never return</span> <span data-start="1450.359" data-end="1451.889">false your should component update would</span> <span data-start="1451.889" data-end="1454.619">be completely ineffective now you could</span> <span data-start="1454.619" data-end="1456.809">do a deep equality check where you</span> <span data-start="1456.809" data-end="1459.599">compare the actual values but depending</span> <span data-start="1459.599" data-end="1460.919">on how heavy that is it might actually</span> <span data-start="1460.919" data-end="1467.099">take more time so be nice to have that</span> <span data-start="1467.099" data-end="1469.86">simple quick qualities check</span> <span data-start="1469.86" data-end="1473.58">but still catch changes in the data and</span> <span data-start="1473.58" data-end="1477.45">this is what immutability gives you so</span> <span data-start="1477.45" data-end="1479.28">with immutable data if two variables are</span> <span data-start="1479.28" data-end="1481.29">pointing to the same object you know</span> <span data-start="1481.29" data-end="1484.62">that the data hasn't changed and if it</span> <span data-start="1484.62" data-end="1485.79">does need to change you create a new</span> <span data-start="1485.79" data-end="1488.22">object so if you're using immutable data</span> <span data-start="1488.22" data-end="1490.17">then you can do these quick Equality</span> <span data-start="1490.17" data-end="1491.429">checks which are fast and should</span> <span data-start="1491.429" data-end="1495.03">component update so with should</span> <span data-start="1495.03" data-end="1496.17">component update you can short-circuit</span> <span data-start="1496.17" data-end="1498.27">work lower in the tree than the place</span> <span data-start="1498.27" data-end="1500.37">where you call this not that state but</span> <span data-start="1500.37" data-end="1502.08">what if the change happens in one of the</span> <span data-start="1502.08" data-end="1505.11">children do you still need to compute</span> <span data-start="1505.11" data-end="1508.98">this whole set of things let's walk</span> <span data-start="1508.98" data-end="1512.16">through that case so we have a to do</span> <span data-start="1512.16" data-end="1516.62">list and we check off one of the items</span> <span data-start="1516.62" data-end="1519.75">that item has to change but the rest of</span> <span data-start="1519.75" data-end="1521.25">the list the other items in the list and</span> </p>
<p><span data-start="1521.25" data-end="1522.48">Alyssa itself they don't really need to</span> <span data-start="1522.48" data-end="1527.429">change so how can you make sure that you</span> <span data-start="1527.429" data-end="1531.36">aren't updating those other things when</span> <span data-start="1531.36" data-end="1533.79">you're using vanilla react with local</span> <span data-start="1533.79" data-end="1535.049">component State it's actually pretty</span> <span data-start="1535.049" data-end="1537.96">easy you just restructure your state so</span> <span data-start="1537.96" data-end="1539.73">that you can call set state lowering the</span> <span data-start="1539.73" data-end="1542.429">tree but when you're using something</span> <span data-start="1542.429" data-end="1544.549">like Redux this can be harder to do</span> <span data-start="1544.549" data-end="1547.169">that's because you're firing off actions</span> <span data-start="1547.169" data-end="1549.39">and then the state is coming in through</span> <span data-start="1549.39" data-end="1551.79">connect and most people will use connect</span> <span data-start="1551.79" data-end="1554.25">at the top level of their tree or many</span> <span data-start="1554.25" data-end="1557.97">people well there is a way to do this</span> <span data-start="1557.97" data-end="1560.61">though and that's the using connect at</span> <span data-start="1560.61" data-end="1563.79">lower levels of the tree now if you're</span> <span data-start="1563.79" data-end="1565.44">gonna do this you'll probably need to</span> <span data-start="1565.44" data-end="1566.73">rethink how you're handling your data</span> <span data-start="1566.73" data-end="1569.64">for this to work because you'd have a</span> <span data-start="1569.64" data-end="1572.79">component structure like this and most</span> <span data-start="1572.79" data-end="1574.169">people would pass in their array of</span> <span data-start="1574.169" data-end="1577.679">items to the list and then those would</span> <span data-start="1577.679" data-end="1584.549">be passed down to each item component so</span> <span data-start="1584.549" data-end="1586.53">when an item needs to be changed it not</span> <span data-start="1586.53" data-end="1588.54">only needs to change in the item itself</span> <span data-start="1588.54" data-end="1590.34">but also in the array that's being</span> <span data-start="1590.34" data-end="1593.97">passed to list so that's trigging</span> <span data-start="1593.97" data-end="1595.65">triggering an update at the list level</span> <span data-start="1595.65" data-end="1598.08">but you can reduce the work here and the</span> <span data-start="1598.08" data-end="1600.809">way you do that is by passing in IDs to</span> <span data-start="1600.809" data-end="1603.54">the list and then passing those ids down</span> <span data-start="1603.54" data-end="1603.81">to the</span> <span data-start="1603.81" data-end="1606.72">items and from there you can actually</span> <span data-start="1606.72" data-end="1609.75">use the ID and map map state two props</span> <span data-start="1609.75" data-end="1613.08">to convert that ID into the item and so</span> <span data-start="1613.08" data-end="1616.86">then when the item is changed you only</span> <span data-start="1616.86" data-end="1621.69">see that change in the item itself so</span> <span data-start="1621.69" data-end="1623.04">this is how you can save them work at</span> <span data-start="1623.04" data-end="1625.02">higher levels and sibling levels of the</span> <span data-start="1625.02" data-end="1629.28">tree I wish I've had time to cover other</span> <span data-start="1629.28" data-end="1630.54">performance tricks things like</span> <span data-start="1630.54" data-end="1632.64">memoization and virtualization and</span> <span data-start="1632.64" data-end="1634.65">incremental rendering and how you could</span> <span data-start="1634.65" data-end="1636.48">use observables which things like mob X</span> <span data-start="1636.48" data-end="1638.34">and relay used to notify components of</span> <span data-start="1638.34" data-end="1639.6">changes but this is gonna have to be it</span> <span data-start="1639.6" data-end="1642.6">for now so here are the techniques that</span> <span data-start="1642.6" data-end="1645.39">we covered using keys to help react</span> <span data-start="1645.39" data-end="1647.48">match previous instances to me once</span> <span data-start="1647.48" data-end="1649.89">using should component updates a short</span> <span data-start="1649.89" data-end="1651.77">circuit to work lower in the tree and</span> <span data-start="1651.77" data-end="1654.89">how immutability factors into that and</span> <span data-start="1654.89" data-end="1657.84">using set seed or connect lower in the</span> <span data-start="1657.84" data-end="1659.91">tree so you can reduce work higher in</span> <span data-start="1659.91" data-end="1664.29">the tree so I hope this has given you a</span> <span data-start="1664.29" data-end="1666.45">good overview of a few starting points</span> <span data-start="1666.45" data-end="1668.13">as you can see there are lots of tweaks</span> <span data-start="1668.13" data-end="1670.41">that you can make some of them are a for</span> <span data-start="1670.41" data-end="1671.88">some cases some of them are a for other</span> <span data-start="1671.88" data-end="1673.98">cases and some actually had negative</span> <span data-start="1673.98" data-end="1675.78">impacts if they're used in the wrong way</span> <span data-start="1675.78" data-end="1678.51">in the wrong circumstances so this is</span> <span data-start="1678.51" data-end="1680.51">why people say it's good to measure and</span> <span data-start="1680.51" data-end="1682.77">hopefully this talk is giving you a good</span> <span data-start="1682.77" data-end="1685.05">framework for understanding what it is</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
