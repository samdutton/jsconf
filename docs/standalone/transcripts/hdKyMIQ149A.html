<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="JSConf transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>hdKyMIQ149A</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/hdKyMIQ149A?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="17.31" data-end="22.12">I'm to be a Schneider from unique Toby</span> <span data-start="22.12" data-end="25.63">Taylor and Twitter I haven't repaired a</span> <span data-start="25.63" data-end="27.58">lot of slides so actually that's my only</span> <span data-start="27.58" data-end="31.3">slide for today so I have to watch it</span> <span data-start="31.3" data-end="41.11">for the next 20 minutes no okay yeah I</span> <span data-start="41.11" data-end="43.12">haven't repaired a lot of sliders said</span> <span data-start="43.12" data-end="45.37">am I just want to demo you a project</span> <span data-start="45.37" data-end="47.64">I've been working on for a while</span> <span data-start="47.64" data-end="50.31">actually I'm working on it seems about</span> <span data-start="50.31" data-end="58.329">four or five years so and it all started</span> <span data-start="58.329" data-end="61.48">with the idea to create and VNC viewer</span> <span data-start="61.48" data-end="65.199">in JavaScript all of you guys know what</span> </p>
<p><span data-start="65.199" data-end="71.259">VNC is probably okay so it started the</span> <span data-start="71.259" data-end="73.03">first version of that means if you in</span> <span data-start="73.03" data-end="79.78">JavaScript five years ago and bought and</span> <span data-start="79.78" data-end="83.44">it worked well but it wasn't really sexy</span> <span data-start="83.44" data-end="88.24">enough to release it so I was waiting</span> <span data-start="88.24" data-end="94.03">for some sugar to push it out and that</span> <span data-start="94.03" data-end="102.31">chica came in form of noches so if you</span> <span data-start="102.31" data-end="105.459">have expected to see a remote desktop</span> <span data-start="105.459" data-end="107.259">solution which our script that's not</span> <span data-start="107.259" data-end="108.58">what I'm showing you what I'm showing</span> <span data-start="108.58" data-end="111.22">you a tool that lets you create your own</span> <span data-start="111.22" data-end="114.16">services based on wii and see with no</span> <span data-start="114.16" data-end="123.92">chairs so</span> <span data-start="123.93" data-end="127.47">so I think the most of you has used VNC</span> <span data-start="127.47" data-end="129.95">in the past as a remote desktop solution</span> <span data-start="129.95" data-end="133.86">but under the roof what it basically</span> <span data-start="133.86" data-end="137.88">does means he it's just a frame buffer</span> <span data-start="137.88" data-end="140.88">that is shared with the clients that are</span> <span data-start="140.88" data-end="150.41">connected to it so it's switch to the</span> <span data-start="150.41" data-end="156.239">text mode and reduce chosen some demo so</span> <span data-start="156.239" data-end="161.31">what I first created is a implementation</span> <span data-start="161.31" data-end="163.2">of the remote frame buffer protocol</span> <span data-start="163.2" data-end="166.5">which is the protocol that is used by</span> </p>
<p><span data-start="166.5" data-end="171.33">VNC to stream all the changes on a on a</span> <span data-start="171.33" data-end="174.62">screen or on a buffer to all its clients</span> <span data-start="174.62" data-end="179.69">so I can show you a little demo of that</span> <span data-start="179.69" data-end="187.06">so just start a little vincy server</span> <span data-start="187.07" data-end="201.6">adventure and first using a native in</span> <span data-start="201.6" data-end="204.57">decline to connect it just to see how it</span> <span data-start="204.57" data-end="208.35">looks like with a regular VNC client so</span> <span data-start="208.35" data-end="216.89">let's connect to local host okay nice</span> <span data-start="216.89" data-end="220.95">that is just a little trying demo now</span> <span data-start="220.95" data-end="222.87">you connect to the ravine see climbing</span> <span data-start="222.87" data-end="228.23">can draw on a screen and you can also</span> <span data-start="228.23" data-end="234.9">connect to it let the Chavez with a</span> <span data-start="234.9" data-end="237.09">shell script view well let's see if it</span> <span data-start="237.09" data-end="245.67">works yet so</span> <span data-start="245.68" data-end="249.189">so what you see here at the left is Oh</span> <span data-start="249.189" data-end="256.07">where's my mouse pointer here this is</span> <span data-start="256.07" data-end="259.13">the browser is the VNC implementation in</span> </p>
<p><span data-start="259.13" data-end="260.69">JavaScript which using web socket to</span> <span data-start="260.69" data-end="264.59">connect to the VNC server for the</span> <span data-start="264.59" data-end="267.229">project I'm using a modified version of</span> <span data-start="267.229" data-end="269.539">a modified version of living seas</span> <span data-start="269.539" data-end="273.35">library that is a native c library which</span> <span data-start="273.35" data-end="281.18">is used by by ro rhe in CT server and as</span> <span data-start="281.18" data-end="290.87">you can see and I let's reconnect so you</span> <span data-start="290.87" data-end="293.18">can see you can draw on the right that's</span> <span data-start="293.18" data-end="294.68">the native in C server and that's the</span> <span data-start="294.68" data-end="300.32">choice between c0m0 all the changes are</span> <span data-start="300.32" data-end="308.12">in retail but that's not all so as I</span> <span data-start="308.12" data-end="311.81">said before you can with my to you can</span> <span data-start="311.81" data-end="315.32">create your own services with note based</span> <span data-start="315.32" data-end="317.33">on the VNC or the remote frame buffer</span> <span data-start="317.33" data-end="322.13">protocol so and I give you a little demo</span> <span data-start="322.13" data-end="331.4">how easy it is so after you checked out</span> <span data-start="331.4" data-end="334.849">the project and get up you can start a</span> <span data-start="334.849" data-end="340.22">new project and first you have to</span> <span data-start="340.22" data-end="345.74">require the note screen module so let's</span> <span data-start="345.74" data-end="349.48">do this</span> <span data-start="349.49" data-end="351.83">hmm</span> <span data-start="351.83" data-end="358.7">okay and then you can create a VNC</span> <span data-start="358.7" data-end="366.8">server a frame buffer just by let's save</span> <span data-start="366.8" data-end="379.32">it in a real so screen that crude server</span> </p>
<p><span data-start="379.33" data-end="383.08">I'm passing an object and an option and</span> <span data-start="383.08" data-end="387.62">keyboard object as the first parameter</span> <span data-start="387.62" data-end="390.23">and let's set the dimensions of the</span> <span data-start="390.23" data-end="396.49">frame buffer so with 800 and height of</span> <span data-start="396.49" data-end="401.96">600 and the second argument is a</span> <span data-start="401.96" data-end="404.78">callback which gets fired every time a</span> <span data-start="404.78" data-end="406.64">new client is connecting to the VNC</span> <span data-start="406.64" data-end="410.96">server and that callback is taking a</span> <span data-start="410.96" data-end="422.58">client object as its argument so this so</span> <span data-start="422.59" data-end="427.04">so let's print out a little console</span> <span data-start="427.04" data-end="429.32">message every time a new client is</span> <span data-start="429.32" data-end="437.09">connecting to sue sue and then you can</span> <span data-start="437.09" data-end="443.68">start a server on localhost</span> <span data-start="443.69" data-end="455.66">on port so let's start this over ouch</span> </p>
<p><span data-start="455.66" data-end="467.189">Charles what is narrow</span> <span data-start="467.199" data-end="470.93">mm-hmm let's just let's have a look in</span> <span data-start="470.93" data-end="476.65">here</span> <span data-start="476.66" data-end="484.6">what happens okay yeah I did port first</span> <span data-start="484.6" data-end="491.96">hostname a second so okay so now our VNC</span> <span data-start="491.96" data-end="496.61">server is running and we can't connect</span> <span data-start="496.61" data-end="501.37">to it first with the native VNC client</span> <span data-start="501.37" data-end="507.11">today so it's an empty screams let's</span> <span data-start="507.11" data-end="511.85">just just a black screen having the</span> <span data-start="511.85" data-end="514.849">dimensions we pass to the create several</span> <span data-start="514.849" data-end="519.41">method we can also connect to it with</span> <span data-start="519.41" data-end="533.96">the new JavaScript viewer so rip so once</span> <span data-start="533.96" data-end="536.63">a new client is connected and it fires</span> <span data-start="536.63" data-end="539.96">the the callback you pass to the create</span> <span data-start="539.96" data-end="543.22">server function as the second argument</span> <span data-start="543.22" data-end="546.05">you can listen on that client object you</span> <span data-start="546.05" data-end="547.7">can add event listener and callbacks and</span> <span data-start="547.7" data-end="549.53">can listen to all Mouse events and</span> <span data-start="549.53" data-end="552.83">pointer events so for example you can</span> <span data-start="552.83" data-end="569.43">say client on pointer move</span> <span data-start="569.44" data-end="576.74">yep three star server</span> <span data-start="576.75" data-end="582.82">reconnecting should I should use this</span> <span data-start="582.82" data-end="589.51">like I know what okay let's connect into</span> <span data-start="589.51" data-end="600.889">it move it a little bit with a mouse</span> <span data-start="600.899" data-end="613.06">oh yeah let's go damn it sorry yeah</span> <span data-start="613.07" data-end="617.63">so we connect and you can see all the</span> <span data-start="617.63" data-end="621.77">pounder events or fired we can also lock</span> <span data-start="621.77" data-end="627.23">the current mouse position by this minor</span> <span data-start="627.23" data-end="641.92">works</span> <span data-start="641.93" data-end="644.57">term</span> <span data-start="644.57" data-end="654.59">hip</span> <span data-start="654.6" data-end="657.63">so now we've graded our first green sea</span> <span data-start="657.63" data-end="662.279">server and what a note screen provides</span> <span data-start="662.279" data-end="667.05">you is access to a frame buffer in form</span> <span data-start="667.05" data-end="671.029">of a node buffer which is just a</span> <span data-start="671.029" data-end="673.709">allocated bunch of memory which presents</span> <span data-start="673.709" data-end="676.5">a frame of it just presents a pixel</span> <span data-start="676.5" data-end="679.829">array when you have worked with a canvas</span> <span data-start="679.829" data-end="681.54">on client site or canvas in the browser</span> <span data-start="681.54" data-end="683.31">you know the pixel array when you have a</span> <span data-start="683.31" data-end="686.37">2d context and you're calling the metal</span> <span data-start="686.37" data-end="689.61">get image data and accessing the data</span> <span data-start="689.61" data-end="694.05">property so then you get back kind of</span> <span data-start="694.05" data-end="695.91">array which represents the pixels in the</span> <span data-start="695.91" data-end="705.779">canvas so and that's what you get in not</span> <span data-start="705.779" data-end="710.99">screen and once you've created a server</span> <span data-start="710.99" data-end="718.5">you can listen to refresh event and that</span> <span data-start="718.5" data-end="724.319">event is fired 25 times per second you</span> <span data-start="724.319" data-end="726.63">can define that frame rate by passing it</span> <span data-start="726.63" data-end="730.939">here in that option object you can see</span> <span data-start="730.939" data-end="736.47">refresh rate 10 so that's that means</span> <span data-start="736.47" data-end="737.939">daddy with the Refresh you when it gets</span> <span data-start="737.939" data-end="745.079">fired 10 times per second and the frame</span> <span data-start="745.079" data-end="750.089">buffer the pixel array is passed to that</span> <span data-start="750.089" data-end="752.639">call back as the first argument so</span> <span data-start="752.639" data-end="760.73">that's the frame buffer</span> <span data-start="760.74" data-end="763.5">so now at that point you can put any</span> <span data-start="763.5" data-end="765.91">pixel the sources you want into that</span> <span data-start="765.91" data-end="768.16">frame buffer and it gets synced with all</span> <span data-start="768.16" data-end="770.35">the clients that are connected to the</span> <span data-start="770.35" data-end="776.2">server so I mean let's make a little</span> <span data-start="776.2" data-end="781.089">little game which just puts a white</span> <span data-start="781.089" data-end="783.01">rectangle on the screen for each client</span> <span data-start="783.01" data-end="784.75">that is connected to the VNC server and</span> <span data-start="784.75" data-end="787.54">all the connected clients can just move</span> <span data-start="787.54" data-end="795.829">their own rectangle over the screen so</span> <span data-start="795.839" data-end="798.73">so frame buffer is just a regular bother</span> <span data-start="798.73" data-end="800.91">you can put in there whatever you want</span> <span data-start="800.91" data-end="810.31">that's so we can't use for example note</span> <span data-start="810.31" data-end="814.72">canvas to draw into the buffer so let's</span> <span data-start="814.72" data-end="822.73">require no cameras of course you have to</span> <span data-start="822.73" data-end="826.9">install it first wire NPM I did that</span> <span data-start="826.9" data-end="834.94">before so let's have an array of players</span> <span data-start="834.94" data-end="838.06">that are connected to the game just an</span> <span data-start="838.06" data-end="841">arrow so when every time a new client is</span> <span data-start="841" data-end="844">gay connects to the server we create a</span> <span data-start="844" data-end="851.74">new player object I'm storing the</span> <span data-start="851.74" data-end="859.6">current position started 0-0 adding at</span> <span data-start="859.6" data-end="869.589">it to the list of players so and let us</span> <span data-start="869.589" data-end="872.17">control our rectangle with the arrow</span> <span data-start="872.17" data-end="881.83">keys so that's at some look un's on it</span> <span data-start="881.83" data-end="889.23">on key down</span> <span data-start="889.24" data-end="896.93">so we check in a switch block which key</span> <span data-start="896.93" data-end="904.79">we have breast this q sim case screen</span> <span data-start="904.79" data-end="913.31">key no chain also provides some key</span> <span data-start="913.31" data-end="915.17">constants because we don't have to know</span> <span data-start="915.17" data-end="918.47">which key fires which kick-out so you</span> <span data-start="918.47" data-end="922.94">can just use the key object which is</span> <span data-start="922.94" data-end="924.47">exported by not scream by the note</span> <span data-start="924.47" data-end="929.49">scream module so you can say I'm down</span> <span data-start="929.5" data-end="940.66">just increase the stakes by 50 pixels so</span> <span data-start="940.66" data-end="953.05">let's copy that okay on up that's</span> <span data-start="953.05" data-end="961.31">decrease it okay and we add on for damn</span> <span data-start="961.31" data-end="969.5">it I hate text made for right okay put</span> <span data-start="969.5" data-end="982.259">you increase why not x plus</span> <span data-start="982.269" data-end="990.759">when you put a left is it okay okay and</span> <span data-start="990.759" data-end="994.069">he in the Refresh loop we draw all the</span> <span data-start="994.069" data-end="999.5">players on the canvas so first we have</span> <span data-start="999.5" data-end="1006.19">to get T now that's wrong here canis so</span> <span data-start="1006.19" data-end="1014.8">we can create a canvas 800 600 and we</span> <span data-start="1014.8" data-end="1032.02">need a context 2d ok let's clear the</span> <span data-start="1032.02" data-end="1035.799">screen first maybe that's not the most</span> <span data-start="1035.799" data-end="1040.14">efficient code but it's okay for demo I</span> <span data-start="1040.14" data-end="1058.38">sorry clear right 600</span> <span data-start="1058.39" data-end="1060.57">nope</span> <span data-start="1060.57" data-end="1065.49">okay so let's iterate through the</span> <span data-start="1065.49" data-end="1068.039">players array and throw by electric</span> <span data-start="1068.039" data-end="1071.909">rectangle for each player let's do a</span> <span data-start="1071.909" data-end="1079.94">fill style let's make them all white CDX</span> <span data-start="1079.94" data-end="1090.659">correct we're position let's make 100</span> <span data-start="1090.659" data-end="1099.389">and 100 white height said okay okay and</span> <span data-start="1099.389" data-end="1101.7">then we have to copy the pixel data out</span> <span data-start="1101.7" data-end="1104">of the canvas in India or frame buffer</span> <span data-start="1104" data-end="1106.559">so let's do that by creating a new</span> <span data-start="1106.559" data-end="1113.09">buffer out of the pixel data image data</span> <span data-start="1113.09" data-end="1119.72">position know so just wonder you have to</span> </p>
<p><span data-start="1119.72" data-end="1125.549">Jehol cameras and copy it into the frame</span> <span data-start="1125.549" data-end="1128.98">buffer</span> <span data-start="1128.99" data-end="1135.289">looks good let's give it a try okay</span> <span data-start="1135.289" data-end="1146.9">let's connect with the native plant okay</span> <span data-start="1146.9" data-end="1152.94">there's our white rectangle it's not</span> <span data-start="1152.94" data-end="1160.559">working why is it not working okay it's</span> <span data-start="1160.559" data-end="1173.08">not this it's player of course</span> <span data-start="1173.09" data-end="1184.62">so let's see if it works now yeah you</span> <span data-start="1184.62" data-end="1191.429">can control it so let's connect with the</span> <span data-start="1191.429" data-end="1200.46">web client let's damn it over there</span> <span data-start="1200.46" data-end="1222.6">it is Oh mr. school yeah here you can</span> <span data-start="1222.6" data-end="1224.58">grade your own games you can grade your</span> <span data-start="1224.58" data-end="1227.669">own remote desktop solution base w just</span> <span data-start="1227.669" data-end="1229.62">have to write some simple note bindings</span> <span data-start="1229.62" data-end="1232.919">that perhaps your your mac screen or</span> <span data-start="1232.919" data-end="1237.36">your x11 screen and and cup just copy</span> <span data-start="1237.36" data-end="1240.45">that into the frame buffer and it synced</span> <span data-start="1240.45" data-end="1242.19">to all the clients using the VNC</span> <span data-start="1242.19" data-end="1250.19">protocol and or creating a super fancy</span> <span data-start="1250.19" data-end="1255.98">canvas super mario game or whatever and</span> <span data-start="1255.98" data-end="1261.48">let it run on the outside or on browsers</span> <span data-start="1261.48" data-end="1263.1">that support canvas you can run it and</span> <span data-start="1263.1" data-end="1265.289">client site in the web browser and for</span> <span data-start="1265.289" data-end="1266.549">clients that doesn't support canvas you</span> <span data-start="1266.549" data-end="1269.7">can run it on outside and connecting</span> <span data-start="1269.7" data-end="1272.159">with even with all the devices like a</span> </p>
<p><span data-start="1272.159" data-end="1275.549">Nokia Symbian s60 device they all have</span> <span data-start="1275.549" data-end="1279.6">been seat lines in Java and you can play</span> <span data-start="1279.6" data-end="1281.309">together with other with iphone users</span> <span data-start="1281.309" data-end="1285.12">with chrome or WebKit users or Firefox</span> <span data-start="1285.12" data-end="1290.07">use whatever yeah I will release it the</span> <span data-start="1290.07" data-end="1291.9">next days and get up so just download it</span> <span data-start="1291.9" data-end="1296.49">modify it make cool stuff with it may be</span> <span data-start="1296.49" data-end="1302.31">cool remote desktop solution</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
