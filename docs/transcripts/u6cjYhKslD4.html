<section>
<p><span data-start="19.82" data-end="24.72">the web forward and my what I want to</span> <span data-start="24.72" data-end="26.58">encourage everyone to do is to open up</span> <span data-start="26.58" data-end="28.83">your favorite projects on github or</span> <span data-start="28.83" data-end="30.81">wherever they're at and get pull</span> <span data-start="30.81" data-end="33">requests and issues ready because I'll</span> <span data-start="33" data-end="36.48">be discussing a common performance over</span> <span data-start="36.48" data-end="39.84">sites in popular libraries and possibly</span> <span data-start="39.84" data-end="42.449">in your own code so if you find</span> <span data-start="42.449" data-end="44.64">something that's useful tweet it there's</span> <span data-start="44.64" data-end="49.019">hashtag / forward and at the end of the</span> <span data-start="49.019" data-end="50.64">talk I'd like to see like a list of</span> <span data-start="50.64" data-end="52.17">hands of how many our show of hands to</span> <span data-start="52.17" data-end="55.11">see how many issues have been reported</span> <span data-start="55.11" data-end="59.07">or poor requests have been started so</span> <span data-start="59.07" data-end="65.369">cool all right a little bit about me I'm</span> <span data-start="65.369" data-end="68.04">co maintainer of Jasper com how many</span> <span data-start="68.04" data-end="70.229">people have used Jas perf com awesome</span> <span data-start="70.229" data-end="74.939">cool Wow I'm also the lead dev on lodash</span> <span data-start="74.939" data-end="76.77">solo dash is an underscore alternative</span> <span data-start="76.77" data-end="77.84">how many people have heard of allah desh</span> <span data-start="77.84" data-end="81.119">awesome sweet and then benchmark Jas and</span> <span data-start="81.119" data-end="83.189">benchmark Jas is what powers j/s perf</span> <span data-start="83.189" data-end="85.14">and it also allows you to do things on</span> <span data-start="85.14" data-end="89.45">knowed Ringo Rhino all the browsers and</span> <span data-start="89.45" data-end="92.399">then i'm also a perf p.m. at microsoft</span> <span data-start="92.399" data-end="94.259">so I helped make chakra the JavaScript</span> <span data-start="94.259" data-end="104.009">engine faster alright I'm back kind of</span> <span data-start="104.009" data-end="107.99">cool and by by looking at patterns</span> <span data-start="107.99" data-end="111.659">popular patterns on the web and helping</span> <span data-start="111.659" data-end="115.189">relay them to the C++ Java engine devs</span> <span data-start="115.189" data-end="120.42">and i am a javascript fanboy so before i</span> <span data-start="120.42" data-end="122.369">begin and talk about the specific</span> <span data-start="122.369" data-end="125.069">performance tweaks there's a couple of</span> <span data-start="125.069" data-end="126.899">themes that i'll be trying to reiterate</span> <span data-start="126.899" data-end="129.45">throughout the talk and that's optimized</span> <span data-start="129.45" data-end="131.25">for the common case optimized for the</span> <span data-start="131.25" data-end="133.92">common case whenever you're implementing</span> <span data-start="133.92" data-end="138.09">a API design or using a library if you</span> <span data-start="138.09" data-end="141.06">are a library author think about the</span> <span data-start="141.06" data-end="143.16">most common case for that API to be used</span> <span data-start="143.16" data-end="145.62">and and optimized for it everything else</span> <span data-start="145.62" data-end="148.14">is secondary at that point a lot of</span> <span data-start="148.14" data-end="150.96">mistakes I've seen when debs are doing</span> </p>
<p><span data-start="150.96" data-end="152.1">API is is they</span> <span data-start="152.1" data-end="154.59">they're putting things in their code</span> <span data-start="154.59" data-end="158.46">that slow things down for no for no</span> <span data-start="158.46" data-end="160.92">reason or for this edge case the</span> <span data-start="160.92" data-end="164.39">scenario next is is using natives wisely</span> <span data-start="164.39" data-end="167.7">last year I gave a talk at jfcom called</span> <span data-start="167.7" data-end="170.67">the hidden cost of natives and that was</span> <span data-start="170.67" data-end="174.15">looking at the performance of native</span> <span data-start="174.15" data-end="178.08">methods like array for each filter map</span> <span data-start="178.08" data-end="181.07">and then comparing them to alternatives</span> <span data-start="181.07" data-end="184.2">written with four loops also things like</span> <span data-start="184.2" data-end="187.53">bind as well and then avoid abstraction</span> <span data-start="187.53" data-end="189.51">one of the easiest ways to gain</span> <span data-start="189.51" data-end="191.73">performance in a JavaScript library or a</span> </p>
<p><span data-start="191.73" data-end="193.68">JavaScript project is to just peel back</span> <span data-start="193.68" data-end="196.65">a layer of abstraction reduce those</span> <span data-start="196.65" data-end="198.45">function calls you don't have to go</span> <span data-start="198.45" data-end="201.69">crazy you don't have to compile all the</span> <span data-start="201.69" data-end="204.42">things like method compilation but just</span> <span data-start="204.42" data-end="205.29">pulling back the layer of abstraction</span> <span data-start="205.29" data-end="207.48">can can help you with your perf and then</span> <span data-start="207.48" data-end="208.91">the balance the pros and the cons</span> <span data-start="208.91" data-end="212.01">everything I'm talking about here is is</span> <span data-start="212.01" data-end="214.44">just advice if you're not seeing a</span> <span data-start="214.44" data-end="215.58">performance issue then you certainly</span> <span data-start="215.58" data-end="217.29">don't have to refactor your code and run</span> <span data-start="217.29" data-end="220.14">out and do it I work with a lot of like</span> <span data-start="220.14" data-end="222.93">low-level library functions where they</span> <span data-start="222.93" data-end="224.28">have to be fast because you don't know</span> <span data-start="224.28" data-end="225.72">what's going to be built on top of it</span> <span data-start="225.72" data-end="227.88">it's the baseline for a lot of projects</span> <span data-start="227.88" data-end="231.99">and so keep that in mind when I show</span> <span data-start="231.99" data-end="233.64">like I'll show one way to implement</span> <span data-start="233.64" data-end="235.83">something and then I'll show another way</span> <span data-start="235.83" data-end="237.03">to implement it that gets a little bit</span> <span data-start="237.03" data-end="239.76">deeper and then you know code in kind of</span> <span data-start="239.76" data-end="241.86">increases in complexity increases so you</span> <span data-start="241.86" data-end="243.78">just have to judge for yourself do I</span> <span data-start="243.78" data-end="245.79">want to pre compile all things or do I</span> <span data-start="245.79" data-end="247.41">just want to maybe just remove one layer</span> <span data-start="247.41" data-end="251.64">of abstraction so cool now that that's</span> <span data-start="251.64" data-end="254.55">out of the way all right so I also hope</span> <span data-start="254.55" data-end="255.96">to blow some minds and I just love this</span> </p>
<p><span data-start="255.96" data-end="260.31">Jeff so I said let's just let's just</span> <span data-start="260.31" data-end="263.46">absorb this for a second how awesome it</span> <span data-start="263.46" data-end="267.54">repeats forever too I love it okay okay</span> <span data-start="267.54" data-end="271.65">so the first technique is to hoist out</span> <span data-start="271.65" data-end="276">dot call and apply from your iteration</span> <span data-start="276" data-end="278.49">functions and I put a little key down</span> <span data-start="278.49" data-end="280.83">here at the bottom that shows the</span> <span data-start="280.83" data-end="282.54">libraries that this applies to so if you</span> <span data-start="282.54" data-end="283.979">use any of these libraries this</span> <span data-start="283.979" data-end="285.45">technique applies to that and you can</span> <span data-start="285.45" data-end="285.66">create</span> <span data-start="285.66" data-end="287.43">patch for it or an issue for that</span> <span data-start="287.43" data-end="291.18">library so that's backbone dojo ember</span> <span data-start="291.18" data-end="295.29">jquery prime which is mu tools to and</span> <span data-start="295.29" data-end="296.76">then underscore and i'm sure there's</span> <span data-start="296.76" data-end="298.68">more every every library has some kind</span> <span data-start="298.68" data-end="300.72">of iteration utility every library has</span> <span data-start="300.72" data-end="302.88">some kind of event loop or event emitter</span> <span data-start="302.88" data-end="304.86">and this technique can be applied to</span> <span data-start="304.86" data-end="307.26">those so the general gist is we've all</span> <span data-start="307.26" data-end="309.45">seen code like this while loop call back</span> <span data-start="309.45" data-end="311.52">call and what it's doing is it's doing</span> <span data-start="311.52" data-end="313.77">the dot call for the this the disarm</span> <span data-start="313.77" data-end="315.42">your this context but if you don't pass</span> <span data-start="315.42" data-end="317.91">it this context it's still or this argh</span> <span data-start="317.91" data-end="320.16">it's still doing a dot call and that is</span> <span data-start="320.16" data-end="322.26">slower than just a straight function</span> <span data-start="322.26" data-end="324.3">call so one way to do it like we all</span> <span data-start="324.3" data-end="327.09">know like when you have loops you move</span> <span data-start="327.09" data-end="330.51">the the hard work out of the loop and in</span> <span data-start="330.51" data-end="333.27">this case you can move that call out of</span> <span data-start="333.27" data-end="338.37">the loop by doing something like this so</span> <span data-start="338.37" data-end="342.83">this create call back allows you to</span> <span data-start="342.83" data-end="346.41">evaluate and do the binding inside this</span> <span data-start="346.41" data-end="349.74">function here and then in your main loop</span> <span data-start="349.74" data-end="352.23">you've just got a straight function call</span> <span data-start="352.23" data-end="355.74">and so that increases your your</span> <span data-start="355.74" data-end="358.17">iteration performance and your event</span> <span data-start="358.17" data-end="360.81">emitter performance and the inside of</span> <span data-start="360.81" data-end="361.98">that function there that I've</span> <span data-start="361.98" data-end="369.69">highlighted looks like this AHA there it</span> <span data-start="369.69" data-end="373.86">is like this if you don't pass it this</span> <span data-start="373.86" data-end="375.66">arc it just returns the call back and if</span> <span data-start="375.66" data-end="378.24">you do it wraps the function and does</span> <span data-start="378.24" data-end="381.18">the call now this makes your common case</span> <span data-start="381.18" data-end="383.31">very very fast and I'll show you I'll</span> <span data-start="383.31" data-end="386">step back this is I applied this</span> <span data-start="386" data-end="388.14">optimization to backbone which already</span> <span data-start="388.14" data-end="391.35">has a very fast event system like they</span> <span data-start="391.35" data-end="393.12">go out of their way to really fine-tune</span> <span data-start="393.12" data-end="395.82">it and you're still able to get</span> <span data-start="395.82" data-end="399.66">performance gains in various browsers</span> <span data-start="399.66" data-end="404.1">because of this and I'll step back or</span> <span data-start="404.1" data-end="408.21">forward there's trade-offs for this this</span> <span data-start="408.21" data-end="409.83">makes your comment case very fast this</span> <span data-start="409.83" data-end="411.63">makes your case where you pass at this</span> <span data-start="411.63" data-end="414.539">argh very slow because it is having to</span> <span data-start="414.539" data-end="416.1">do a function rapper so there's there's</span> <span data-start="416.1" data-end="417.99">variations you can do on this</span> <span data-start="417.99" data-end="420.3">what you can do is you can check to see</span> <span data-start="420.3" data-end="424.17">if there is if this file show you here</span> <span data-start="424.17" data-end="427.62">if there is a this binding and then in</span> <span data-start="427.62" data-end="430.8">your loop do a conditional sure like a</span> <span data-start="430.8" data-end="432.48">ternary operator that says hey if</span> <span data-start="432.48" data-end="435.15">there's a binding do the call if not or</span> <span data-start="435.15" data-end="437.49">do the function call wit call if not</span> <span data-start="437.49" data-end="439.8">then dude alcohol and that will give you</span> <span data-start="439.8" data-end="441.63">a little bit better performance and not</span> <span data-start="441.63" data-end="443.55">as bad a big of a per penalty so it's</span> <span data-start="443.55" data-end="445.23">just up to you to weigh the pros and</span> <span data-start="445.23" data-end="447.39">cons of your approach one of the good</span> <span data-start="447.39" data-end="451.43">things about using create callback is</span> <span data-start="451.43" data-end="455.43">that with this approach you could then</span> <span data-start="455.43" data-end="458.01">add extra functionality without having</span> <span data-start="458.01" data-end="459.99">to modify this function you could just</span> <span data-start="459.99" data-end="462.87">modify create call back so I did this</span> <span data-start="462.87" data-end="466.35">with lodash for our map function usually</span> <span data-start="466.35" data-end="467.64">there's a function called pluck which</span> <span data-start="467.64" data-end="469.38">would then you you give it a collection</span> <span data-start="469.38" data-end="472.17">or an array of objects let's say and you</span> <span data-start="472.17" data-end="474.75">want to get the the name property value</span> <span data-start="474.75" data-end="476.25">off of all the objects there's a</span> <span data-start="476.25" data-end="477.42">function called pluck which would do</span> <span data-start="477.42" data-end="479.63">that well instead you could have map</span> <span data-start="479.63" data-end="482.01">which we all know whatever a map is you</span> <span data-start="482.01" data-end="484.32">could have map that accepts a string a</span> <span data-start="484.32" data-end="487.23">string for callback and it would pass</span> <span data-start="487.23" data-end="488.94">here it would automatically create the</span> <span data-start="488.94" data-end="491.79">callback that does the object property</span> <span data-start="491.79" data-end="494.7">retrieval for you and it's at zero perf</span> <span data-start="494.7" data-end="497.34">cost so you're able to extend your your</span> <span data-start="497.34" data-end="499.95">existing iteration function without any</span> <span data-start="499.95" data-end="502.53">extra perf cost and it's optimized for</span> <span data-start="502.53" data-end="504.96">the common case so you get win win win</span> <span data-start="504.96" data-end="512.43">win win out of that</span> <span data-start="512.44" data-end="514.599">all right before i get into the next one</span> <span data-start="514.599" data-end="517.81">i also want to touch on event systems</span> <span data-start="517.81" data-end="520.18">like jquery so if we looked at back at</span> <span data-start="520.18" data-end="523.15">this chart here you saw that so this is</span> <span data-start="523.15" data-end="525.58">higher is better so the longer the bar</span> <span data-start="525.58" data-end="527.92">the better backbone alt is my</span> <span data-start="527.92" data-end="531.07">implementation you'll see like jquery's</span> <span data-start="531.07" data-end="533.41">version here there there event system is</span> <span data-start="533.41" data-end="535.6">considerably slower but they're doing a</span> <span data-start="535.6" data-end="537.37">lot more they've got a more robust event</span> <span data-start="537.37" data-end="538.9">system it's for handling elements it's</span> <span data-start="538.9" data-end="542.44">not just generic objects and with this</span> <span data-start="542.44" data-end="545.88">technique you can improve jquery's event</span> <span data-start="545.88" data-end="549.43">iteration by like eighteen percent which</span> <span data-start="549.43" data-end="551.5">considering how much other stuff they</span> <span data-start="551.5" data-end="553.87">have around just removing that call and</span> <span data-start="553.87" data-end="556.99">dot apply is a pretty easy tweak so if</span> <span data-start="556.99" data-end="558.91">anyone digs jquery wants to optimize</span> <span data-start="558.91" data-end="562.15">that this would help their event system</span> <span data-start="562.15" data-end="567.26">this would help their dot each cool</span> <span data-start="567.27" data-end="570.46">alright i really like this this</span> <span data-start="570.46" data-end="572.44">technique and so I you'll see a lot of</span> <span data-start="572.44" data-end="574.24">this stuff is I've taken out of low dash</span> <span data-start="574.24" data-end="577.12">because I'm not just like coming up with</span> <span data-start="577.12" data-end="579.16">ideas for optimizations I use these in</span> <span data-start="579.16" data-end="581.8">my own projects and I've tested them</span> </p>
<p><span data-start="581.8" data-end="584.98">I've refined them to try to gain</span> <span data-start="584.98" data-end="587.71">performance and to offset the cost of</span> <span data-start="587.71" data-end="591.64">like bug fixes or compliance alright so</span> <span data-start="591.64" data-end="594.76">avoiding binding how many people know</span> <span data-start="594.76" data-end="596.2">that you can coerce a function to a</span> <span data-start="596.2" data-end="599.17">string and access its function source ok</span> <span data-start="599.17" data-end="601.45">cool you may also know that it's</span> <span data-start="601.45" data-end="604.48">non-standard technically but it's like a</span> <span data-start="604.48" data-end="606.61">de facto standard like everyone kind of</span> <span data-start="606.61" data-end="611.71">does it so I found a way to avoid the</span> <span data-start="611.71" data-end="614.53">this binding if you can detect that the</span> <span data-start="614.53" data-end="616.98">function isn't using the this keyword</span> <span data-start="616.98" data-end="626.14">and so so so so check this out you yeah</span> <span data-start="626.14" data-end="629.92">so it's so by the way this is going to</span> <span data-start="629.92" data-end="633.85">be in lodash as well so expected for</span> <span data-start="633.85" data-end="635.35">those that are like wow that's on stand</span> <span data-start="635.35" data-end="636.97">that's not standard I'm kind of scared</span> <span data-start="636.97" data-end="639.01">of it I in another slide I show you how</span> <span data-start="639.01" data-end="640.42">to do a feature detection for it so you</span> <span data-start="640.42" data-end="643.75">can get this benefit if it exists and</span> <span data-start="643.75" data-end="644.769">you can drop</span> <span data-start="644.769" data-end="648.069">it doesn't but the the the gist is and</span> <span data-start="648.069" data-end="649.72">this is me showing like a generic event</span> <span data-start="649.72" data-end="651.67">system but you could patch so you could</span> <span data-start="651.67" data-end="653.589">do this with jquery event system for</span> <span data-start="653.589" data-end="656.92">example or backbones of its system and</span> <span data-start="656.92" data-end="659.079">usually when you're registering an event</span> <span data-start="659.079" data-end="662.019">listener you you might pass intimated</span> <span data-start="662.019" data-end="663.489">that metadata so like right now I'm</span> <span data-start="663.489" data-end="665.049">passing in like the function and its</span> <span data-start="665.049" data-end="667.029">context but what I'm doing is I'm</span> <span data-start="667.029" data-end="669.85">testing to see if the function is using</span> <span data-start="669.85" data-end="672.459">this reference if it's not then I'm not</span> <span data-start="672.459" data-end="675.819">going to do a binding to it and so that</span> <span data-start="675.819" data-end="677.23">will let will speed up the iteration</span> <span data-start="677.23" data-end="678.67">there because it's not just doing this</span> <span data-start="678.67" data-end="680.709">implicit this binding if you're not</span> <span data-start="680.709" data-end="683.019">using this this also allows you to say</span> <span data-start="683.019" data-end="684.67">to your dad's that if they do care about</span> <span data-start="684.67" data-end="687.369">performance but you can you can actually</span> <span data-start="687.369" data-end="689.379">enforce a different coding pattern for</span> <span data-start="689.379" data-end="690.79">them and say all right well then just do</span> <span data-start="690.79" data-end="692.379">their that equals this which is you know</span> <span data-start="692.379" data-end="694.329">gross some people hate it but if you</span> <span data-start="694.329" data-end="696.579">need it your system will now allow for</span> <span data-start="696.579" data-end="697.809">it and actually have optimism</span> <span data-start="697.809" data-end="700.119">optimizations for it kind of backed into</span> <span data-start="700.119" data-end="704.079">it so that's that's this technique i'm</span> <span data-start="704.079" data-end="706.569">using functioned up prototype to string</span> <span data-start="706.569" data-end="708.069">because this avoids issues if the</span> <span data-start="708.069" data-end="710.589">function has a custom to string so like</span> </p>
<p><span data-start="710.589" data-end="713.889">I've seen charting libraries do that to</span> <span data-start="713.889" data-end="714.97">their instances and objects and</span> <span data-start="714.97" data-end="716.499">functions and so this way that even</span> <span data-start="716.499" data-end="719.35">avoids that gotcha there what this will</span> <span data-start="719.35" data-end="721.689">do is this may have false positives if</span> <span data-start="721.689" data-end="724.839">you have a comment that has dot this but</span> <span data-start="724.839" data-end="727.569">in that case the worst case scenario is</span> <span data-start="727.569" data-end="729.309">that it's treated like every every other</span> <span data-start="729.309" data-end="732.999">function and wrapped or bound so just if</span> <span data-start="732.999" data-end="734.23">you know that this could be a pattern</span> <span data-start="734.23" data-end="736.029">for you to increase performance so what</span> </p>
<p><span data-start="736.029" data-end="738.629">I'm doing is I'm adding this to my</span> <span data-start="738.629" data-end="743.11">iteration sugar in lodash so if you pass</span> <span data-start="743.11" data-end="744.819">at this binding but your callback isn't</span> <span data-start="744.819" data-end="746.679">using it it's not going to actually do</span> <span data-start="746.679" data-end="748.029">the bind so it's going to hit the fast</span> <span data-start="748.029" data-end="750.22">path because I showed you that that slow</span> <span data-start="750.22" data-end="752.619">path is considerably slower for me</span> <span data-start="752.619" data-end="753.939">because I do the create callback</span> <span data-start="753.939" data-end="757.629">technique all right so here's the</span> <span data-start="757.629" data-end="760.209">feature test for example that one up</span> <span data-start="760.209" data-end="762.579">there so I do an assignment I test to</span> <span data-start="762.579" data-end="764.559">see if i can find the this value if i</span> <span data-start="764.559" data-end="767.559">can then i return the value else it'll</span> <span data-start="767.559" data-end="769.48">be false then you can do something</span> <span data-start="769.48" data-end="771.459">similar this was just a cheap way to do</span> <span data-start="771.459" data-end="774.61">this what I've done in lodash is to use</span> <span data-start="774.61" data-end="776.74">the the running context method because</span> <span data-start="776.74" data-end="777.99">that's the method that wraps</span> <span data-start="777.99" data-end="779.97">everything so it's a it's a very big</span> <span data-start="779.97" data-end="782.04">function body and this allows me to</span> <span data-start="782.04" data-end="783.899">detect issues with mobile browsers that</span> <span data-start="783.899" data-end="786.6">may truncate function string function</span> <span data-start="786.6" data-end="789.75">body strings and so I reference this</span> <span data-start="789.75" data-end="791.49">like way down there in the bottom so</span> <span data-start="791.49" data-end="792.99">they can catch it then I know it's it's</span> <span data-start="792.99" data-end="799.35">probably safe to use all right let's see</span> <span data-start="799.35" data-end="801.48">this is me actually showing the inside</span> <span data-start="801.48" data-end="804.57">of the listener so before I showed how</span> <span data-start="804.57" data-end="805.98">to register it and this is an</span> <span data-start="805.98" data-end="808.8">implementation of it using that that</span> <span data-start="808.8" data-end="810.54">information now now that I know that I</span> <span data-start="810.54" data-end="813.54">can conditionally if there is a context</span> <span data-start="813.54" data-end="815.94">call it if not do a straight function</span> <span data-start="815.94" data-end="818.19">call and that is how you get your</span> <span data-start="818.19" data-end="820.67">performance now this is kind of like the</span> <span data-start="820.67" data-end="823.62">backbones implementation where they do a</span> <span data-start="823.62" data-end="825.99">switch statement on a number of</span> <span data-start="825.99" data-end="829.08">arguments I just did up to one but you</span> <span data-start="829.08" data-end="831.12">they do it like up to three you may</span> <span data-start="831.12" data-end="834.69">would do for it manuf eyes to almost</span> <span data-start="834.69" data-end="837.48">nothing so if you're totally grossed out</span> <span data-start="837.48" data-end="839.209">about that just say it's for perch and</span> <span data-start="839.209" data-end="848.18">and move on oh yeah okay all right so</span> <span data-start="848.18" data-end="851.97">the the next technique i have is reduce</span> <span data-start="851.97" data-end="854.1">your searches so a lot of people when</span> <span data-start="854.1" data-end="857.93">you they have a lot a large array or a</span> <span data-start="857.93" data-end="860.01">group of a race they want to do</span> <span data-start="860.01" data-end="865.94">operations like without or union or</span> <span data-start="865.94" data-end="869.67">unique on their arrays but that's doing</span> <span data-start="869.67" data-end="872.13">a lot of linear searches index of values</span> <span data-start="872.13" data-end="874.74">going through the collection every time</span> <span data-start="874.74" data-end="878.279">and that's very very slow and to fix</span> <span data-start="878.279" data-end="880.17">that you may think well i'll just use an</span> <span data-start="880.17" data-end="884.43">object cache so if the if the value in</span> <span data-start="884.43" data-end="887.16">this case turns the value into a</span> <span data-start="887.16" data-end="889.829">property name and they set its result to</span> <span data-start="889.829" data-end="892.079">true so then if it does exist as a</span> <span data-start="892.079" data-end="894.24">property then they know it's there and</span> <span data-start="894.24" data-end="896.25">they can they can continue on their way</span> <span data-start="896.25" data-end="899.37">they found the property or the value but</span> <span data-start="899.37" data-end="900.329">there's there's a couple of problems</span> <span data-start="900.329" data-end="902.64">with that it conflates things that look</span> <span data-start="902.64" data-end="905.73">like identical at strings so like the</span> <span data-start="905.73" data-end="908.25">number string are the number two and the</span> <span data-start="908.25" data-end="911.13">string to look the same and so</span> <span data-start="911.13" data-end="912.99">if you're doing something that's is like</span> <span data-start="912.99" data-end="914.91">a unique operation it's going to treat</span> <span data-start="914.91" data-end="917.58">them as equal when they are not or even</span> <span data-start="917.58" data-end="920.34">a function that coerced to the for some</span> <span data-start="920.34" data-end="922.14">reason course to a number it would with</span> <span data-start="922.14" data-end="924.54">two string would do it so that that</span> <span data-start="924.54" data-end="928.8">approach doesn't work well for generic</span> <span data-start="928.8" data-end="931.02">use now if that is your only use case</span> <span data-start="931.02" data-end="933.36">then maybe maybe you could do it but</span> <span data-start="933.36" data-end="935.34">this is how you could tweak that so</span> <span data-start="935.34" data-end="937.11">here's the first one where it's index of</span> <span data-start="937.11" data-end="941.34">and you'll also see that I've got a</span> <span data-start="941.34" data-end="943.32">little bit of something up here but I'll</span> <span data-start="943.32" data-end="946.77">talk about that later and then the the</span> <span data-start="946.77" data-end="949.32">tweak is what I've done is I've in this</span> <span data-start="949.32" data-end="952.62">example created a cache of that value</span> <span data-start="952.62" data-end="954.33">and then I just look to see if it's</span> <span data-start="954.33" data-end="958.35">contained in that cache or if it's not</span> <span data-start="958.35" data-end="961.38">contained in this case now I'm going to</span> <span data-start="961.38" data-end="962.55">go into actually showing you how i</span> <span data-start="962.55" data-end="965.7">create the object cache for that so this</span> <span data-start="965.7" data-end="968.25">is what the idea is is instead of doing</span> <span data-start="968.25" data-end="970.95">a long linear search you're breaking</span> <span data-start="970.95" data-end="972.87">that massive array into two smaller</span> <span data-start="972.87" data-end="976.11">buckets so you're taking all of the in</span> <span data-start="976.11" data-end="980.13">my previous example of two like values</span> <span data-start="980.13" data-end="981.72">so all of your number two's and string</span> <span data-start="981.72" data-end="983.76">tues and sticking them into a smaller</span> <span data-start="983.76" data-end="986.58">array so you have less of an array to</span> <span data-start="986.58" data-end="988.71">search so that should be faster and it</span> <span data-start="988.71" data-end="991.26">is it's considerably faster and so now</span> <span data-start="991.26" data-end="994.59">here's just a small code that shows you</span> <span data-start="994.59" data-end="998.07">an implementation of this what I do is I</span> <span data-start="998.07" data-end="1000.41">detect if the array is large and what is</span> <span data-start="1000.41" data-end="1004.87">large it's an arbitrary number that I've</span> <span data-start="1004.87" data-end="1008.81">created based on research so in my case</span> <span data-start="1008.81" data-end="1012.58">my implementation the large array size</span> <span data-start="1012.58" data-end="1016.37">was at one time 200 so anything over 200</span> <span data-start="1016.37" data-end="1018.89">got this optimization now it's reduced</span> <span data-start="1018.89" data-end="1021.98">to 75 so now any array over 75 gets this</span> <span data-start="1021.98" data-end="1025.52">optimization but what it is is it's the</span> <span data-start="1025.52" data-end="1029.35">point at which your cost for doing this</span> <span data-start="1029.35" data-end="1031.64">actually gives you a perf win because</span> <span data-start="1031.64" data-end="1033.439">you're having to sit there and create an</span> <span data-start="1033.439" data-end="1035.209">object and populate it with properties</span> <span data-start="1035.209" data-end="1038.12">and if you if your array is for items</span> <span data-start="1038.12" data-end="1040.1">long then it's not going to be a big not</span> <span data-start="1040.1" data-end="1041.63">going to be a win so what this is doing</span> <span data-start="1041.63" data-end="1044.75">is I'm doing a prefix here for the</span> <span data-start="1044.75" data-end="1047.209">you to avoid issues with object</span> <span data-start="1047.209" data-end="1050.21">properties on objects of prototype so to</span> <span data-start="1050.21" data-end="1052.4">string has owned property it also avoids</span> <span data-start="1052.4" data-end="1054.2">issues with the magic proto property</span> <span data-start="1054.2" data-end="1055.43">double underscore proto double</span> <span data-start="1055.43" data-end="1058.04">underscore and that is the</span> <span data-start="1058.04" data-end="1059.78">implementation there I basically push</span> <span data-start="1059.78" data-end="1061.69">the values into their smaller buckets in</span> <span data-start="1061.69" data-end="1065.63">this cash and then in this function here</span> </p>
<p><span data-start="1065.63" data-end="1068.15">I check to see if it is in that smaller</span> <span data-start="1068.15" data-end="1071.35">array so instead of doing let's say 200</span> <span data-start="1071.35" data-end="1073.82">search over 200 items it's doing a</span> <span data-start="1073.82" data-end="1077.62">search over four so it makes it faster</span> <span data-start="1077.62" data-end="1082.61">now this is me zooming into that chunk</span> <span data-start="1082.61" data-end="1084.29">right there that that is what's actually</span> <span data-start="1084.29" data-end="1087.05">creating the cash but it was pretty</span> <span data-start="1087.05" data-end="1091.1">pretty clear before so there's an</span> <span data-start="1091.1" data-end="1092.99">alternative technique that you can do</span> <span data-start="1092.99" data-end="1096.08">that takes it another step further and</span> <span data-start="1096.08" data-end="1097.34">this is what I'm doing in the next</span> <span data-start="1097.34" data-end="1099.92">version of lodash and what this is is</span> <span data-start="1099.92" data-end="1102.74">instead of creating a bunch of smaller</span> <span data-start="1102.74" data-end="1106.55">arrays what it's doing a hybrid approach</span> <span data-start="1106.55" data-end="1108.5">of that the first naive approach which</span> <span data-start="1108.5" data-end="1111.92">was to do object properties and it's</span> <span data-start="1111.92" data-end="1114.41">also doing a race so object properties</span> <span data-start="1114.41" data-end="1117.2">for things like boolean values false and</span> <span data-start="1117.2" data-end="1122.87">true no  and I only do those</span> <span data-start="1122.87" data-end="1125.3">lookups if i'm looking for a value that</span> <span data-start="1125.3" data-end="1128.12">is one of those so it's not going to get</span> <span data-start="1128.12" data-end="1130.07">a false positive like with the number</span> <span data-start="1130.07" data-end="1132.56">two and string two and then I have an</span> <span data-start="1132.56" data-end="1135.62">object cash for anything else that's an</span> <span data-start="1135.62" data-end="1137.54">object so they'll get the their own</span> <span data-start="1137.54" data-end="1141.92">arrays there and this is just me</span> <span data-start="1141.92" data-end="1145.34">creating that cash again still you know</span> <span data-start="1145.34" data-end="1147.05">if it's an object it's getting pushed</span> <span data-start="1147.05" data-end="1149.18">into the smaller array if it's one of</span> <span data-start="1149.18" data-end="1150.83">the other primitive values it's being</span> <span data-start="1150.83" data-end="1153.11">set to true so that's the hybrid of the</span> <span data-start="1153.11" data-end="1155.78">naive approach and the the smaller</span> <span data-start="1155.78" data-end="1157.16">bucket approach and this gets</span> <span data-start="1157.16" data-end="1159.14">considerable ones this was this allowed</span> <span data-start="1159.14" data-end="1162.68">me to remove to reduce the size of my</span> <span data-start="1162.68" data-end="1165.26">large array limit from 200 down to 75 so</span> <span data-start="1165.26" data-end="1167.45">that means more arrays are impacted and</span> <span data-start="1167.45" data-end="1170.27">more you get better performance out of</span> <span data-start="1170.27" data-end="1172.22">it because the optimization kicks in</span> <span data-start="1172.22" data-end="1174.38">earlier</span> <span data-start="1174.38" data-end="1178.19">cool all right another another technique</span> <span data-start="1178.19" data-end="1181.31">is cool by the way that that</span> <span data-start="1181.31" data-end="1184">optimization can be used in underscore</span> <span data-start="1184" data-end="1188.63">and possibly jQuery another thing you</span> <span data-start="1188.63" data-end="1192.46">can do here is coerce values with care a</span> <span data-start="1192.46" data-end="1194.96">lot of times debs will get in the habit</span> <span data-start="1194.96" data-end="1197.15">of doing sliced call arguments all the</span> <span data-start="1197.15" data-end="1200">time just whether they need to or not</span> <span data-start="1200" data-end="1202.28">they're sliced up calling arguments and</span> <span data-start="1202.28" data-end="1203.87">in many cases you don't have two</span> <span data-start="1203.87" data-end="1205.79">arguments are an array-like object if</span> <span data-start="1205.79" data-end="1208.31">you're about to iterate over arguments</span> <span data-start="1208.31" data-end="1209.54">you don't have to convert them to an</span> <span data-start="1209.54" data-end="1210.89">array you can just iterate over them</span> <span data-start="1210.89" data-end="1213.14">straight up and many times you can avoid</span> <span data-start="1213.14" data-end="1215.96">slicing them if you just if your are</span> <span data-start="1215.96" data-end="1217.64">going to iterate over them just set your</span> <span data-start="1217.64" data-end="1220.85">eye index or your your index value to</span> <span data-start="1220.85" data-end="1222.32">one or something so you don't have to</span> <span data-start="1222.32" data-end="1226.52">slice them there's an example here where</span> </p>
<p><span data-start="1226.52" data-end="1228.47">I've done that where instead of instead</span> <span data-start="1228.47" data-end="1230.48">of slicing your arguments and doing an</span> <span data-start="1230.48" data-end="1233.33">index search actually I missed a value</span> <span data-start="1233.33" data-end="1235.37">there but use your imagination there's</span> <span data-start="1235.37" data-end="1238.1">about you the argument instead of that</span> <span data-start="1238.1" data-end="1240.56">I'm leveraging the the from index of</span> <span data-start="1240.56" data-end="1243.59">index of so index of an array index of</span> <span data-start="1243.59" data-end="1246.11">in this case the library index m allows</span> <span data-start="1246.11" data-end="1247.76">you to set a from index where you start</span> <span data-start="1247.76" data-end="1249.89">your linear search from so it doesn't</span> <span data-start="1249.89" data-end="1251.06">always have to start from zero we can</span> <span data-start="1251.06" data-end="1252.59">start forward so you don't have to slice</span> <span data-start="1252.59" data-end="1255.86">things there you can also avoid things</span> <span data-start="1255.86" data-end="1261.42">like concat so let's see</span> </p>
<p><span data-start="1261.42" data-end="1266.61">I have a typo which is lame but I'll</span> <span data-start="1266.61" data-end="1268.97">jump down to this example over here</span> <span data-start="1268.97" data-end="1271.17">instead of flattening a lot of times</span> <span data-start="1271.17" data-end="1273.27">Deb's will include a Lib to flatten</span> <span data-start="1273.27" data-end="1276.99">arrays and you don't have to you can use</span> <span data-start="1276.99" data-end="1280.44">native can cat concatenate so in this</span> <span data-start="1280.44" data-end="1282.84">case I'm having a variable reference to</span> <span data-start="1282.84" data-end="1287.91">concatenate anything that's me storing</span> <span data-start="1287.91" data-end="1289.83">their slice equals or rate up prototype</span> <span data-start="1289.83" data-end="1294.12">nestlings and instead you can use concat</span> <span data-start="1294.12" data-end="1296.43">to flatten your arrays and you don't</span> <span data-start="1296.43" data-end="1298.65">have to pass it an array as it's this</span> <span data-start="1298.65" data-end="1300.87">argh so I've seen many lives do this</span> <span data-start="1300.87" data-end="1303.3">where they're just creating garbage like</span> <span data-start="1303.3" data-end="1305.67">extra unneeded arrays there and you can</span> <span data-start="1305.67" data-end="1307.38">tidy that up the array dot prototype</span> <span data-start="1307.38" data-end="1309.84">itself is an array so you can use that</span> <span data-start="1309.84" data-end="1311.91">as the despot as that this value there</span> <span data-start="1311.91" data-end="1314.85">which is what i do in lodash too and i</span> <span data-start="1314.85" data-end="1316.5">believe it's been added to underscore</span> <span data-start="1316.5" data-end="1320.3">but this that pattern there is from</span> <span data-start="1320.3" data-end="1323.19">jQuery so if you're a jquery fans you</span> <span data-start="1323.19" data-end="1325.68">can go and patch that up and I'm sure</span> <span data-start="1325.68" data-end="1327.36">you could find it in all the other lips</span> <span data-start="1327.36" data-end="1329.34">too they all kind of do similar things</span> <span data-start="1329.34" data-end="1331.67">there and you can you can tighten up</span> <span data-start="1331.67" data-end="1336.75">their object creation and then the</span> <span data-start="1336.75" data-end="1339.63">bottom one is avoiding can cat when it's</span> <span data-start="1339.63" data-end="1341.43">not needed so in this case they were</span> <span data-start="1341.43" data-end="1345.87">doing food.com cat slice arrays /</span> <span data-start="1345.87" data-end="1348.45">arguments and you can you can avoid that</span> <span data-start="1348.45" data-end="1352.5">and do like push that apply and push</span> <span data-start="1352.5" data-end="1354.51">because push accepts more than just one</span> <span data-start="1354.51" data-end="1356.97">argument to push I don't know of many of</span> <span data-start="1356.97" data-end="1358.17">how many people knew that you could push</span> <span data-start="1358.17" data-end="1360.9">more than one argument okay cool well</span> <span data-start="1360.9" data-end="1362.55">you can and so you can leverage that</span> <span data-start="1362.55" data-end="1364.47">apply there and push all of your</span> <span data-start="1364.47" data-end="1366.12">arguments on to the array without having</span> <span data-start="1366.12" data-end="1367.5">the dukan cat and creating all these</span> <span data-start="1367.5" data-end="1371.46">intermediate arrays so try that instead</span> <span data-start="1371.46" data-end="1373.44">and that's me again having a reference</span> <span data-start="1373.44" data-end="1376.2">to array dot prototype top push assigned</span> <span data-start="1376.2" data-end="1382.2">to a variable push okay sugar in</span> <span data-start="1382.2" data-end="1386.91">moderation how many people use a jquery</span> <span data-start="1386.91" data-end="1388.77">straining syntax and not J queries</span> <span data-start="1388.77" data-end="1390.659">underscores changing syntax</span> <span data-start="1390.659" data-end="1394.919">okay a few if you're using a lib that's</span> <span data-start="1394.919" data-end="1398.309">optimized for the generic use you need</span> <span data-start="1398.309" data-end="1400.619">to be aware that the chaining syntax the</span> <span data-start="1400.619" data-end="1402.419">non-common syntax has a performance</span> <span data-start="1402.419" data-end="1404.009">penalty so if you have an animation</span> <span data-start="1404.009" data-end="1407.279">framework or tight loop try pulling it</span> <span data-start="1407.279" data-end="1410.609">back to the API that is is optimized for</span> <span data-start="1410.609" data-end="1414.239">that library before you even have to</span> <span data-start="1414.239" data-end="1415.799">roll it back to like four loops or go</span> <span data-start="1415.799" data-end="1419.039">crazy other optimizations and in this</span> <span data-start="1419.039" data-end="1420.479">case I've shown the the difference</span> <span data-start="1420.479" data-end="1423.769">between the two there you've got the the</span> <span data-start="1423.769" data-end="1427.679">chain version versus the generic version</span> <span data-start="1427.679" data-end="1429.389">and there's a trade-off there one is</span> <span data-start="1429.389" data-end="1432.479">pretty and in the chaining API is very</span> <span data-start="1432.479" data-end="1434.489">pretty but the other one is actually how</span> <span data-start="1434.489" data-end="1438.029">it was designed to be used from its core</span> <span data-start="1438.029" data-end="1441.299">so it's faster this way keep in mind the</span> <span data-start="1441.299" data-end="1443.159">differences underscore and lodash are</span> <span data-start="1443.159" data-end="1446.039">optimized for their generic use but mood</span> <span data-start="1446.039" data-end="1447.809">tools and anything but operates on a</span> <span data-start="1447.809" data-end="1449.7">prototype so that even means jQuery are</span> <span data-start="1449.7" data-end="1453.69">optimized for the chaining syntax so be</span> <span data-start="1453.69" data-end="1456.479">aware of the libs you're using be aware</span> <span data-start="1456.479" data-end="1458.639">of that in your own code to like if</span> <span data-start="1458.639" data-end="1459.84">you're doing something that's a</span> <span data-start="1459.84" data-end="1462.33">moderately performance intensive or</span> <span data-start="1462.33" data-end="1464.249">could be make sure you're using the API</span> <span data-start="1464.249" data-end="1468.299">that's appropriate for your your use all</span> <span data-start="1468.299" data-end="1476.429">right next I wanted to say is with the</span> <span data-start="1476.429" data-end="1478.109">chaining syntax if you do have a</span> <span data-start="1478.109" data-end="1480.149">chaining syntax there's an optimization</span> <span data-start="1480.149" data-end="1483.359">opportunity there and that is deferred</span> <span data-start="1483.359" data-end="1486.239">evaluation so just a week or two ago I</span> <span data-start="1486.239" data-end="1488.849">saw a library come out that was called</span> <span data-start="1488.849" data-end="1491.07">lazy j s which was boasting better</span> <span data-start="1491.07" data-end="1493.47">performance than lodash aha it caught my</span> <span data-start="1493.47" data-end="1495.64">attention</span> <span data-start="1495.65" data-end="1498.62">because uh because yeah I'm pretty</span> <span data-start="1498.62" data-end="1501.88">competitive in that in that space and</span> <span data-start="1501.88" data-end="1505.46">now normal usage normal usage you could</span> <span data-start="1505.46" data-end="1508.73">see I I beat them I'd be a beat</span> <span data-start="1508.73" data-end="1510.17">underscore two underscores the little</span> <span data-start="1510.17" data-end="1516.11">book I'm the big blue but but but as the</span> <span data-start="1516.11" data-end="1518.18">co as the complexity of the chain</span> <span data-start="1518.18" data-end="1520.76">functions increases this one starts to</span> <span data-start="1520.76" data-end="1524.06">win and win by a considerable amount and</span> <span data-start="1524.06" data-end="1526.76">that's because what they're doing is</span> <span data-start="1526.76" data-end="1529.19">instead of doing two hundred iterations</span> <span data-start="1529.19" data-end="1531.32">for map and then doing two hundred</span> <span data-start="1531.32" data-end="1532.97">iterations for filter and then doing</span> <span data-start="1532.97" data-end="1534.95">some other things in their collections</span> <span data-start="1534.95" data-end="1536.81">so iteration iteration iteration and</span> <span data-start="1536.81" data-end="1538.76">then at the end only getting build the</span> <span data-start="1538.76" data-end="1542.69">the last five values lazy evaluation at</span> <span data-start="1542.69" data-end="1544.91">that time doesn't execute that at all it</span> <span data-start="1544.91" data-end="1546.74">adds it to a queue and then whenever you</span> <span data-start="1546.74" data-end="1548.93">call to array or in this case like if</span> <span data-start="1548.93" data-end="1550.4">you're familiar with the underscore</span> <span data-start="1550.4" data-end="1552.47">lodash chaining syntax the value command</span> <span data-start="1552.47" data-end="1554.69">or the value method that's when it</span> <span data-start="1554.69" data-end="1558.38">flattens that down and instead of it</span> <span data-start="1558.38" data-end="1561.77">being 200 or 400 or 600 iterations since</span> <span data-start="1561.77" data-end="1564.05">you're only needing five values at the</span> <span data-start="1564.05" data-end="1565.52">end because you're saying like take the</span> <span data-start="1565.52" data-end="1567.35">last five values it only does five</span> <span data-start="1567.35" data-end="1570.59">iterations and so that gives you massive</span> <span data-start="1570.59" data-end="1572.18">performance wins so as you're chaining</span> <span data-start="1572.18" data-end="1576.8">gets longer you get better wins now i'm</span> <span data-start="1576.8" data-end="1578.54">experimenting with adding support for</span> <span data-start="1578.54" data-end="1580.46">this because i like this so much and i</span> <span data-start="1580.46" data-end="1583.28">like the performance opportunity my</span> <span data-start="1583.28" data-end="1585.62">chaining syntax is usually a perf hit</span> <span data-start="1585.62" data-end="1587.9">because it seemed like i said lodash and</span> <span data-start="1587.9" data-end="1591.59">underscore are optimized for the generic</span> <span data-start="1591.59" data-end="1597.14">use but i can back this in whoops hey</span> <span data-start="1597.14" data-end="1605.08">hey Matt no it's cool let's see Boop</span> <span data-start="1605.09" data-end="1610.07">someone's birthday all right yeah all</span> <span data-start="1610.07" data-end="1625.139">right and that's it questions yeah</span> <span data-start="1625.149" data-end="1633.91">mm-hmm</span> <span data-start="1633.92" data-end="1637.43">so general use case is the use case I've</span> <span data-start="1637.43" data-end="1639.68">seen promoted throughout like</span> <span data-start="1639.68" data-end="1642.77">documentation or through tutorials so in</span> <span data-start="1642.77" data-end="1644.66">my case I know that that most most</span> <span data-start="1644.66" data-end="1645.83">deaths aren't passing that this value</span> <span data-start="1645.83" data-end="1647.93">there so I know that the common case is</span> <span data-start="1647.93" data-end="1650.48">not to do that it's being familiar with</span> <span data-start="1650.48" data-end="1652.55">your own lib being familiar especially</span> <span data-start="1652.55" data-end="1654.05">if you're the lib author being familiar</span> <span data-start="1654.05" data-end="1656.3">with how you want your Deb's to use that</span> </p>
<p><span data-start="1656.3" data-end="1657.83">API and how you're promoting it through</span> <span data-start="1657.83" data-end="1660.74">your your evangelism and then you know</span> <span data-start="1660.74" data-end="1662.78">what the the common case would be so you</span> <span data-start="1662.78" data-end="1665.09">can optimize for what going back to the</span> <span data-start="1665.09" data-end="1667.58">themes again where I said optimized for</span> <span data-start="1667.58" data-end="1670.94">the common case jquery has an implicit</span> <span data-start="1670.94" data-end="1673.91">this binding in its event system because</span> <span data-start="1673.91" data-end="1675.95">if you know if you're doing each or</span> <span data-start="1675.95" data-end="1678.56">whatever you'll see this equals is is</span> <span data-start="1678.56" data-end="1680.06">the element that's currently being in</span> <span data-start="1680.06" data-end="1684.38">rated over something and that was baked</span> <span data-start="1684.38" data-end="1686">in from the beginning so it's hard to</span> <span data-start="1686" data-end="1687.71">kind of back in perf there because</span> <span data-start="1687.71" data-end="1689.71">they're always doing call or not apply</span> <span data-start="1689.71" data-end="1691.9">but if you want that eighteen percent</span> <span data-start="1691.9" data-end="1696.05">boost oh what you can do is do that that</span> <span data-start="1696.05" data-end="1698.06">function sniff inference where you can</span> <span data-start="1698.06" data-end="1700.06">detect if the dis binding is there and</span> <span data-start="1700.06" data-end="1703.4">in toggling but you wouldn't have to go</span> <span data-start="1703.4" data-end="1705.17">to that length if at the beginning you</span> <span data-start="1705.17" data-end="1707.78">said oh okay maybe not all going to use</span> <span data-start="1707.78" data-end="1710.24">this or maybe this will become an</span> <span data-start="1710.24" data-end="1712.43">anti-pattern or whatever and they get</span> <span data-start="1712.43" data-end="1715.76">instead have put that property on the</span> <span data-start="1715.76" data-end="1716.81">event object that they're already</span> <span data-start="1716.81" data-end="1718.49">passing down and so that would have</span> <span data-start="1718.49" data-end="1719.93">avoided it about call to begin with so</span> <span data-start="1719.93" data-end="1721.55">when you're doing like your event system</span> <span data-start="1721.55" data-end="1723.23">you could think oh maybe I don't need an</span> <span data-start="1723.23" data-end="1724.49">implicit this I could just add a</span> <span data-start="1724.49" data-end="1726.38">property to the event object that I'm</span> <span data-start="1726.38" data-end="1729.47">passing to every call back anyways so</span> <span data-start="1729.47" data-end="1730.76">that just kind of keep these things in</span> <span data-start="1730.76" data-end="1733.06">your head as you're developing your</span> <span data-start="1733.06" data-end="1736.66">libraries or your own code bases cool</span> <span data-start="1736.66" data-end="1743.74">yeah</span> <span data-start="1743.75" data-end="1746.13">so the question was have you looked at</span> <span data-start="1746.13" data-end="1749.19">any of these anti-patterns in</span> </p>
<p><span data-start="1749.19" data-end="1754.41">CoffeeScript I don't use coffee script</span> <span data-start="1754.41" data-end="1757.62">so no I haven't what's nice about copy</span> <span data-start="1757.62" data-end="1760.11">script is it just come boils down to</span> <span data-start="1760.11" data-end="1765.42">basic JavaScript and in many cases it's</span> <span data-start="1765.42" data-end="1767.76">sugar boils down to two for loops so</span> <span data-start="1767.76" data-end="1769.41">that's right up my alley like it doesn't</span> <span data-start="1769.41" data-end="1771.24">defer to native methods it turns it into</span> <span data-start="1771.24" data-end="1773.19">four loops and it has small utility</span> <span data-start="1773.19" data-end="1777.12">functions which are very nice also I'll</span> <span data-start="1777.12" data-end="1778.92">be positive about CoffeeScript and Sarah</span> <span data-start="1778.92" data-end="1793.26">like its class abstraction but yeah yes</span> </p>
<p><span data-start="1793.27" data-end="1801.04">I need to do more research there but I</span> <span data-start="1801.04" data-end="1803.35">do have a big function on line I only do</span> <span data-start="1803.35" data-end="1805.27">it once though for the future detect but</span> <span data-start="1805.27" data-end="1807.25">so far it's given perf games in the test</span> <span data-start="1807.25" data-end="1811">that I've done you could always do more</span> <span data-start="1811" data-end="1812.56">research dig into it I'm going to try it</span> <span data-start="1812.56" data-end="1814.06">I'm going to give it a shot because i</span> <span data-start="1814.06" data-end="1816.28">think it's relatively safe and stable</span> <span data-start="1816.28" data-end="1818.38">especially for modern builds so what I'm</span> <span data-start="1818.38" data-end="1820.3">doing is I'm opting that into just learn</span> <span data-start="1820.3" data-end="1824.29">so just ie9 up and modern modern</span> <span data-start="1824.29" data-end="1826.72">browsers will do this not old browsers</span> <span data-start="1826.72" data-end="1828.7">because if that just means bugs just</span> <span data-start="1828.7" data-end="1831.85">yeah man bugs get big but the idea is</span> <span data-start="1831.85" data-end="1833.44">that I'm doing that load that work</span> <span data-start="1833.44" data-end="1836.02">outside the loop so it's done once</span> <span data-start="1836.02" data-end="1838.3">outside the loop instead of like every</span> <span data-start="1838.3" data-end="1839.74">time inside the loop so it's again</span> <span data-start="1839.74" data-end="1842.28">hoisting things out of your loop cool</span> <span data-start="1842.28" data-end="1851.1">yes</span> <span data-start="1851.11" data-end="1853.75">yeah good good good good question so the</span> <span data-start="1853.75" data-end="1857.14">the the question was in create callback</span> <span data-start="1857.14" data-end="1860.82">which was the the code i have up here</span> <span data-start="1860.82" data-end="1864.82">and i'm going to get to it I can't speak</span> <span data-start="1864.82" data-end="1870.16">and move at the same time okay the</span> <span data-start="1870.16" data-end="1871.75">question was in create callback why not</span> <span data-start="1871.75" data-end="1873.4">use function dot prototype top bind</span> <span data-start="1873.4" data-end="1876.69">instead of wrapping and that's because</span> <span data-start="1876.69" data-end="1879.97">many times in most browser</span> <span data-start="1879.97" data-end="1881.59">implementations function dot prototype</span> <span data-start="1881.59" data-end="1884.5">that bind is actually slower especially</span> <span data-start="1884.5" data-end="1887.41">like in v8 it's considerably slower and</span> <span data-start="1887.41" data-end="1889.99">in lodash actually is aware of this and</span> <span data-start="1889.99" data-end="1892.9">will not use native bind in the eighth i</span> <span data-start="1892.9" data-end="1895.419">do an inference for its engine which is</span> <span data-start="1895.419" data-end="1897.429">really cool because i can detect the j s</span> <span data-start="1897.429" data-end="1901.35">engine through a little inference but</span> <span data-start="1901.35" data-end="1903.4">even in browsers where it's relatively</span> <span data-start="1903.4" data-end="1908.59">fast or faster than then then a fully</span> <span data-start="1908.59" data-end="1912.25">spec compliant buying alternative bind</span> <span data-start="1912.25" data-end="1914.47">is still slower than just wrapping it so</span> <span data-start="1914.47" data-end="1915.58">i thought i was going to get a perf</span> <span data-start="1915.58" data-end="1916.84">boost there too and i was really</span> <span data-start="1916.84" data-end="1918.94">surprised that it didn't it didn't do it</span> <span data-start="1918.94" data-end="1920.19">or else i would have yet done that</span> <span data-start="1920.19" data-end="1927.72">what's up yes</span> </p>
<p><span data-start="1927.73" data-end="1931.67">I for the purpose of this this</span> <span data-start="1931.67" data-end="1932.99">demonstration I kind of wanted it really</span> <span data-start="1932.99" data-end="1934.7">simple to just do word boundary this</span> <span data-start="1934.7" data-end="1936.98">word boundary you can experiment with</span> <span data-start="1936.98" data-end="1940.22">with other variations of it if you see</span> <span data-start="1940.22" data-end="1941.39">that as a problem I don't know if I'm</span> <span data-start="1941.39" data-end="1944.54">going to see a lot of people having that</span> <span data-start="1944.54" data-end="1947.42">issue but if it is and if it's a concern</span> <span data-start="1947.42" data-end="1949.19">I would I still kept it simple that way</span> <span data-start="1949.19" data-end="1951.2">it's just a quick reg ex that just finds</span> <span data-start="1951.2" data-end="1953.87">it or fails fast but yeah you could you</span> <span data-start="1953.87" data-end="1957.19">could modify the reg ex to detect</span> <span data-start="1957.19" data-end="1959.39">comments I don't know if I repeated the</span> <span data-start="1959.39" data-end="1961.75">question but it was could you modify the</span> <span data-start="1961.75" data-end="1965.05">this reg ex to look for comments instead</span> <span data-start="1965.05" data-end="1985.5">another any other questions yes</span> <span data-start="1985.51" data-end="1991.389">hit</span> <span data-start="1991.399" data-end="1994.879">yeah so I had a slide here that I</span> <span data-start="1994.879" data-end="1999.499">removed which was how to better how'd</span> <span data-start="1999.499" data-end="2001.96">the cab create call be better detected</span> <span data-start="2001.96" data-end="2004.57">for inlining because some engines have</span> <span data-start="2004.57" data-end="2006.369">an issue with that function call out</span> <span data-start="2006.369" data-end="2009.94">there and so what you would do is do a</span> <span data-start="2009.94" data-end="2014.169">check for if this is  don't do</span> <span data-start="2014.169" data-end="2015.789">the function call at all and just have</span> <span data-start="2015.789" data-end="2018.489">it do the habit do they have it be the</span> <span data-start="2018.489" data-end="2022.469">callback so a ternary operation of that</span> <span data-start="2022.469" data-end="2025.089">engines are tricky engines under the</span> <span data-start="2025.089" data-end="2027.009">hood are there doing all kinds of crazy</span> <span data-start="2027.009" data-end="2029.229">stuff to just get the result and get it</span> <span data-start="2029.229" data-end="2033.309">fast and jit and what what gets</span> <span data-start="2033.309" data-end="2036.219">optimized and what doesn't this is why I</span> <span data-start="2036.219" data-end="2039.549">said it's a balance of how deep you want</span> <span data-start="2039.549" data-end="2041.979">to go into it and I think this is a</span> <span data-start="2041.979" data-end="2045.099">decent trade off because it's not just</span> <span data-start="2045.099" data-end="2047.379">it's it's it's giving me win on top of</span> <span data-start="2047.379" data-end="2049.839">win here because it's optimizing for the</span> <span data-start="2049.839" data-end="2052.059">common case and allowing me to extend</span> <span data-start="2052.059" data-end="2054.25">functionality for each two and other</span> <span data-start="2054.25" data-end="2055.75">iteration methods to have like the</span> <span data-start="2055.75" data-end="2058.149">callback shorthand sugar of the property</span> <span data-start="2058.149" data-end="2064.899">access or partial object filtering so</span> <span data-start="2064.899" data-end="2068.02">that's that's what I dig a side note is</span> <span data-start="2068.02" data-end="2069.73">since we're talking about engines is</span> <span data-start="2069.73" data-end="2072.569">that I've noticed that minified code</span> <span data-start="2072.569" data-end="2076.359">will have different performance profiles</span> <span data-start="2076.359" data-end="2078.549">than your non minified code potentially</span> <span data-start="2078.549" data-end="2080.559">in different engines so if you're</span> <span data-start="2080.559" data-end="2082.929">developing a project and you have a</span> <span data-start="2082.929" data-end="2084.909">performance critical thing like an</span> <span data-start="2084.909" data-end="2086.74">animation lab or something you want to</span> <span data-start="2086.74" data-end="2088.24">test your men ified code in your</span> <span data-start="2088.24" data-end="2090.7">benchmarks as well as your non minify i</span> <span data-start="2090.7" data-end="2093.609">found issues with uglify j/s and closure</span> <span data-start="2093.609" data-end="2096.73">compiler where they because of their</span> <span data-start="2096.73" data-end="2098.289">patterns they're using when they minify</span> <span data-start="2098.289" data-end="2100.66">d optimize like safari and mobile safari</span> <span data-start="2100.66" data-end="2104.279">so again really really good to test that</span> <span data-start="2104.279" data-end="2107.589">and what I've done is in lodash I have a</span> <span data-start="2107.589" data-end="2110.079">min efficacious system where I run all</span> <span data-start="2110.079" data-end="2111.339">these many fires and then get the</span> <span data-start="2111.339" data-end="2113.02">smallest build but then I also go back</span> <span data-start="2113.02" data-end="2116.23">and I fix the the patterns that the</span> <span data-start="2116.23" data-end="2117.549">minnow fires are doing that slow down</span> <span data-start="2117.549" data-end="2119.859">the engine so I avoid the D ops but it's</span> <span data-start="2119.859" data-end="2121.299">something to do like if you're you don't</span> <span data-start="2121.299" data-end="2123.94">have a perf suite for your library you</span> <span data-start="2123.94" data-end="2124.96">should create one and</span> <span data-start="2124.96" data-end="2126.82">if you have a favorite library and they</span> <span data-start="2126.82" data-end="2128.53">don't have a perf sweet you should add</span> <span data-start="2128.53" data-end="2130.33">one and a perfect lib to do that is</span> <span data-start="2130.33" data-end="2133.089">benchmark Jas and you can look at low</span> <span data-start="2133.089" data-end="2135.43">dashes implementation of example of a</span> <span data-start="2135.43" data-end="2151.549">prick blood the other questions yes</span> <span data-start="2151.559" data-end="2155.969">no without you just had each engine is</span> <span data-start="2155.969" data-end="2157.349">different each engine has its own rules</span> <span data-start="2157.349" data-end="2160.079">with that minification issue what was</span> <span data-start="2160.079" data-end="2161.849">happening was I believe what was</span> <span data-start="2161.849" data-end="2165.029">happening was that the minified code was</span> <span data-start="2165.029" data-end="2167.099">not getting in line for some reason it</span> <span data-start="2167.099" data-end="2170.039">was passing some threshold of byte code</span> <span data-start="2170.039" data-end="2172.709">or whatever and it was missing the</span> <span data-start="2172.709" data-end="2174.719">inlining opportunity there and so it was</span> <span data-start="2174.719" data-end="2177.029">d it was reducing its performance by</span> <span data-start="2177.029" data-end="2179.339">thirty percent so it was pretty pretty</span> <span data-start="2179.339" data-end="2182.309">glaring but as to what gets in line and</span> <span data-start="2182.309" data-end="2184.499">what doesn't the the general rule is to</span> <span data-start="2184.499" data-end="2186.959">keep your functions small and then they</span> <span data-start="2186.959" data-end="2188.63">have a better chance of being in line</span> <span data-start="2188.63" data-end="2192.989">and that kind of goes at odds with my</span> <span data-start="2192.989" data-end="2195.059">other point which is reduce abstraction</span> <span data-start="2195.059" data-end="2197.16">because you're going to have all these</span> <span data-start="2197.16" data-end="2199.68">function calls so I would say profile</span> <span data-start="2199.68" data-end="2202.38">and then make your decision don't just</span> <span data-start="2202.38" data-end="2203.969">take my word for it that's why I also</span> <span data-start="2203.969" data-end="2205.729">didn't include a lot of performance</span> <span data-start="2205.729" data-end="2208.349">charts because all you see is these bars</span> <span data-start="2208.349" data-end="2211.109">with them being really big over here and</span> <span data-start="2211.109" data-end="2213.15">really small over there and I want you</span> <span data-start="2213.15" data-end="2214.979">to not take my word for it to actually</span> <span data-start="2214.979" data-end="2216.66">go out and use j/s perf and other</span> <span data-start="2216.66" data-end="2218.819">benchmarks in and verify that you get</span> <span data-start="2218.819" data-end="2223.019">these wins like don't don't if you do a</span> <span data-start="2223.019" data-end="2224.579">pull request back it up with a</span> <span data-start="2224.579" data-end="2226.949">performance benchmark so you can say hey</span> <span data-start="2226.949" data-end="2228.749">this actually does this and if it</span> <span data-start="2228.749" data-end="2230.549">doesn't then it's still good you've</span> <span data-start="2230.549" data-end="2232.079">learned something and you know not to do</span> </p>
</section>