<section>
<p><span data-start="0.05" data-end="6.08">[Applause]</span> <span data-start="6.08" data-end="11">hello your r√©guel keeper knock I'll try</span> <span data-start="11" data-end="15.269">sir good morning my name is Jorge and</span> <span data-start="15.269" data-end="17.43">today I'm going to talk about testing in</span> <span data-start="17.43" data-end="20.85">production with JavaScript welcome two</span> <span data-start="20.85" data-end="22.59">years conf Budapest and thank you for</span> <span data-start="22.59" data-end="25.38">coming to my talk hidden slide doesn't</span> <span data-start="25.38" data-end="27.689">matter I promise the talk it's not gonna</span> <span data-start="27.689" data-end="32.21">be too heavy and let's get started so</span> <span data-start="32.21" data-end="34.98">quick about me my name is Jorge I'm an</span> <span data-start="34.98" data-end="37.29">engineer I'm from Spain and I'm</span> <span data-start="37.29" data-end="40.77">currently working in Bristol started</span> <span data-start="40.77" data-end="42.719">working on autonomous indoor navigation</span> <span data-start="42.719" data-end="45.96">new abs and money area baekho's fronts</span> <span data-start="45.96" data-end="48.51">and then got back to the cloud space for</span> <span data-start="48.51" data-end="50.85">years working at I start back called</span> <span data-start="50.85" data-end="52.77">bitNami that just got acquired by BM</span> <span data-start="52.77" data-end="54.899">words so kudos to my team and now</span> <span data-start="54.899" data-end="58.68">currently working at Dyson so I always</span> <span data-start="58.68" data-end="61.559">like to store the talks with a quick</span> <span data-start="61.559" data-end="64.979">poll to know how the audience is doing</span> <span data-start="64.979" data-end="67.83">on on this topic I want to know how many</span> <span data-start="67.83" data-end="71.58">of you know what javascript is okay</span> <span data-start="71.58" data-end="73.38">thank you you know raising the hands</span> <span data-start="73.38" data-end="77.28">over there are here for the city the</span> <span data-start="77.28" data-end="79.71">food the party and just a bit of</span> </p>
<p><span data-start="79.71" data-end="82.729">JavaScript okay that's fine</span> <span data-start="82.729" data-end="86.49">know what testing is we're raising the</span> <span data-start="86.49" data-end="89.759">bar know about the testing pyramid or</span> <span data-start="89.759" data-end="91.17">any other way of classifying the</span> <span data-start="91.17" data-end="93.93">different testing levels yeah most of</span> <span data-start="93.93" data-end="96.96">you thank you who has a production</span> <span data-start="96.96" data-end="99.99">environment again every one of you</span> <span data-start="99.99" data-end="104.13">amazing who is afraid of testing in</span> <span data-start="104.13" data-end="108.869">production who is not afraid of testing</span> <span data-start="108.869" data-end="112.409">in production good give this is coming</span> <span data-start="112.409" data-end="115.2">so are you testing your services in</span> <span data-start="115.2" data-end="119.159">production not so many but there are</span> <span data-start="119.159" data-end="121.829">quite a few that's great the final</span> <span data-start="121.829" data-end="125.67">preferred spaces two tops yes spaces</span> <span data-start="125.67" data-end="127.47">right</span> <span data-start="127.47" data-end="130.56">so this this talk about this talk is</span> <span data-start="130.56" data-end="133.28">about I'm gonna try to answer some</span> <span data-start="133.28" data-end="136.98">frequently asked questions about testing</span> <span data-start="136.98" data-end="140.61">and your production workloads not going</span> <span data-start="140.61" data-end="142.68">to be too technical and not going too</span> <span data-start="142.68" data-end="145.62">deep inside any JavaScript code and it's</span> <span data-start="145.62" data-end="147.33">all based on the experience I gained</span> <span data-start="147.33" data-end="149.28">working I dance at Dyson I've been</span> <span data-start="149.28" data-end="151.14">working at Dyson for almost two years</span> <span data-start="151.14" data-end="155.16">now and Anna has been great and we have</span> <span data-start="155.16" data-end="156.33">learned a lot about testing in</span> <span data-start="156.33" data-end="159.93">production so this is a quick summary of</span> <span data-start="159.93" data-end="162.96">where I'm going I'm going to answer why</span> <span data-start="162.96" data-end="164.43">do you need testing testing production</span> <span data-start="164.43" data-end="168.21">was the right testing level how can you</span> <span data-start="168.21" data-end="171">escape or noise no js' work help with</span> <span data-start="171" data-end="173.82">this how to avoid disrupting the real</span> <span data-start="173.82" data-end="175.38">users because if you're testing in</span> <span data-start="175.38" data-end="178.5">production you're gonna be part of your</span> <span data-start="178.5" data-end="180.42">users and you're going to be using</span> <span data-start="180.42" data-end="184.2">production systems how to keep how to</span> <span data-start="184.2" data-end="185.88">keep your tests out of the statistics</span> <span data-start="185.88" data-end="189.03">reports and out of metrics so when you</span> <span data-start="189.03" data-end="192.27">report your to your manager to hire the</span> <span data-start="192.27" data-end="196.91">business didn't get you results and then</span> <span data-start="196.91" data-end="200.31">why you should clean up and what happens</span> <span data-start="200.31" data-end="202.68">if you don't because that happened to us</span> <span data-start="202.68" data-end="207.48">so yeah let's dive in a bit why do you</span> <span data-start="207.48" data-end="209.76">need testing in production well that's a</span> <span data-start="209.76" data-end="211.86">good question by how most of you can</span> <span data-start="211.86" data-end="214.92">answer that but really what do I mean</span> <span data-start="214.92" data-end="216.989">why what do I mean by testing in</span> <span data-start="216.989" data-end="219.33">production when you deploy your</span> <span data-start="219.33" data-end="221.91">application it could be an application a</span> <span data-start="221.91" data-end="223.86">service could be a lambda whatever thing</span> <span data-start="223.86" data-end="226.29">you deploy to production and has so the</span> <span data-start="226.29" data-end="229.26">public has access to is you need to</span> <span data-start="229.26" data-end="233.4">guarantee it's continues to work over</span> <span data-start="233.4" data-end="236.76">the days and over the hours and it's not</span> <span data-start="236.76" data-end="239.28">just it passed the unit test it passed</span> <span data-start="239.28" data-end="241.53">the service level test or whatever and</span> <span data-start="241.53" data-end="243.9">then I deploy and I don't care about my</span> <span data-start="243.9" data-end="245.37">service the service is running in</span> <span data-start="245.37" data-end="247.05">production and if something happens to</span> <span data-start="247.05" data-end="250.32">it you want to get notified not at the</span> <span data-start="250.32" data-end="254.91">user but by some automated system so the</span> <span data-start="254.91" data-end="257.28">idea about this is to have some kind of</span> <span data-start="257.28" data-end="260.19">testing tool that runs on a scheduled</span> <span data-start="260.19" data-end="261.41">basis</span> <span data-start="261.41" data-end="264.75">so it's testing your service like it was</span> <span data-start="264.75" data-end="267.479">a real user and if something happens so</span> <span data-start="267.479" data-end="269.759">the tests fail it means that a real user</span> <span data-start="269.759" data-end="272.4">wasn't able to do one of the actions you</span> <span data-start="272.4" data-end="273.84">have defined for your production</span> <span data-start="273.84" data-end="276.03">services and and then you get a</span> <span data-start="276.03" data-end="278.699">notification so let's let's dive into it</span> <span data-start="278.699" data-end="282.81">a bit why really do you need a testing</span> <span data-start="282.81" data-end="284.94">you need testing in production so here's</span> <span data-start="284.94" data-end="287.91">a quick sample it might seem dumb but it</span> <span data-start="287.91" data-end="289.62">can happen so imagine you have a lambda</span> <span data-start="289.62" data-end="291.199">function that we change the current date</span> <span data-start="291.199" data-end="295.13">right and it doesn't cut it for the year</span> <span data-start="295.13" data-end="297.93">2038 problem which is when you are</span> <span data-start="297.93" data-end="302.12">storing your date in a sign it 32-bits</span> <span data-start="302.12" data-end="305.52">variable you've run out of space to</span> <span data-start="305.52" data-end="308.52">store the date and then you overflow</span> <span data-start="308.52" data-end="313.49">right on the 16th of january 2038</span> <span data-start="313.49" data-end="316.68">so yeah you do your deployment you write</span> <span data-start="316.68" data-end="319.139">unit tests for it issue which on a date</span> <span data-start="319.139" data-end="321.389">if you query for the date again you</span> <span data-start="321.389" data-end="322.979">should return a different number should</span> <span data-start="322.979" data-end="325.83">return a different date yeah do you know</span> <span data-start="325.83" data-end="326.729">unit tests are fine</span> <span data-start="326.729" data-end="328.8">do you deploy it and after a handful of</span> <span data-start="328.8" data-end="332.639">years is stuff failing and it's because</span> <span data-start="332.639" data-end="335.55">a it has dynamic input/output it depends</span> <span data-start="335.55" data-end="340.11">on the current time on how the users are</span> <span data-start="340.11" data-end="342.24">interacting with the service or what the</span> <span data-start="342.24" data-end="344.97">service is returning dynamically but</span> <span data-start="344.97" data-end="348.33">going to a more real situation imagine</span> <span data-start="348.33" data-end="350.34">one of your stateful services so it's a</span> <span data-start="350.34" data-end="352.56">service that store some state on your</span> <span data-start="352.56" data-end="355.889">users or in your database or on the</span> <span data-start="355.889" data-end="358.59">state of your system then suddenly by a</span> <span data-start="358.59" data-end="361.05">bug or whatever becomes inconsistent and</span> <span data-start="361.05" data-end="362.82">then starts failing for all the</span> <span data-start="362.82" data-end="366.75">customers then when you have is a horde</span> <span data-start="366.75" data-end="370.86">of customers chasing you angry customers</span> <span data-start="370.86" data-end="374.09">saying this is not working I pay for it</span> <span data-start="374.09" data-end="377.09">but you don't want that you want</span> <span data-start="377.09" data-end="379.56">something that it's not going to get</span> <span data-start="379.56" data-end="382.259">angry at you and it's a robot an</span> <span data-start="382.259" data-end="385.02">automated process that's gonna behave</span> <span data-start="385.02" data-end="387.3">like a user it's going to test your</span> <span data-start="387.3" data-end="389.76">things your services in production and</span> <span data-start="389.76" data-end="391.919">tell you when something bad happens so</span> <span data-start="391.919" data-end="394.05">you don't get the feedback</span> <span data-start="394.05" data-end="399.479">from the users and so if you compare</span> <span data-start="399.479" data-end="401.729">these two situations so imagine you are</span> <span data-start="401.729" data-end="403.319">in the first situation where you don't</span> <span data-start="403.319" data-end="404.849">have an automated test system in</span> <span data-start="404.849" data-end="407.25">production and then something bad</span> <span data-start="407.25" data-end="409.349">happens and all your customers come to</span> <span data-start="409.349" data-end="411.44">you saying this is no working and</span> <span data-start="411.44" data-end="415.83">claiming back the money it's gonna take</span> <span data-start="415.83" data-end="418.289">some time for the users to report to you</span> <span data-start="418.289" data-end="420.24">that I know is happening and they have</span> <span data-start="420.24" data-end="424.8">to go to your service helpdesk or log an</span> <span data-start="424.8" data-end="427.02">issue or log a ticket or send you an</span> <span data-start="427.02" data-end="429.21">email or whatever so it's slow you don't</span> <span data-start="429.21" data-end="432.09">know your service is failing until you</span> <span data-start="432.09" data-end="435.719">get the feedback from the users but if</span> <span data-start="435.719" data-end="437.52">you have an automated system that runs</span> <span data-start="437.52" data-end="439.83">every minute every 10 minute every 20</span> <span data-start="439.83" data-end="442.62">minutes every 30 minute you can</span> <span data-start="442.62" data-end="444.09">notifications about your system not</span> <span data-start="444.09" data-end="447.81">working like this and also if you're in</span> <span data-start="447.81" data-end="450.659">the first situation you're losing money</span> <span data-start="450.659" data-end="453.509">because then the more time you last in</span> <span data-start="453.509" data-end="455.4">detecting that your systems are not</span> <span data-start="455.4" data-end="457.74">working that's money that you are losing</span> <span data-start="457.74" data-end="460.38">and and also you're paying the support</span> <span data-start="460.38" data-end="463.8">the supporting a lot for dealing with</span> <span data-start="463.8" data-end="465.9">those things while you could have catch</span> <span data-start="465.9" data-end="469.65">the Europe beforehand and also the final</span> <span data-start="469.65" data-end="472.8">the final comparison is about the</span> <span data-start="472.8" data-end="475.259">company reputation so if you have all</span> <span data-start="475.259" data-end="477.33">the users coming back at you and saying</span> <span data-start="477.33" data-end="478.83">this is not working this is a high pay</span> <span data-start="478.83" data-end="480.84">for this blah blah blah your company</span> <span data-start="480.84" data-end="483.449">reputation is over the over the floor</span> <span data-start="483.449" data-end="486.449">and then if you have an automated system</span> <span data-start="486.449" data-end="490.5">that notifies you by the way of an issue</span> <span data-start="490.5" data-end="492.15">in your production systems</span> <span data-start="492.15" data-end="496.289">nobody needs to notice it and then you</span> <span data-start="496.289" data-end="498.81">fix it quickly and then customers are</span> <span data-start="498.81" data-end="501.93">happy so that's the comparison and why</span> <span data-start="501.93" data-end="505.86">do you need testing in production so</span> <span data-start="505.86" data-end="508.409">what really is the right level of</span> <span data-start="508.409" data-end="509.639">testing you want to perform in</span> <span data-start="509.639" data-end="512.849">production because you don't want to</span> <span data-start="512.849" data-end="515.399">mess with real data but you're using</span> <span data-start="515.399" data-end="518.789">real systems yeah so this is a the</span> <span data-start="518.789" data-end="521.399">testing pyramid well one of the many</span> <span data-start="521.399" data-end="527.14">testing permits are but let me focus</span> <span data-start="527.14" data-end="529.63">let me focus on this one because it's</span> <span data-start="529.63" data-end="532.09">one of the simplest that I found it</span> <span data-start="532.09" data-end="534.88">comes from Superman article in from</span> <span data-start="534.88" data-end="536.32">ultimate from their website ultimate</span> <span data-start="536.32" data-end="540.31">home automation Panda and at the bottom</span> <span data-start="540.31" data-end="542.77">you have unit test then integration test</span> <span data-start="542.77" data-end="545.11">or service level test however you want</span> <span data-start="545.11" data-end="546.55">to call them and then the end-to-end</span> <span data-start="546.55" data-end="550.24">test so what happens when you have a</span> <span data-start="550.24" data-end="552.25">unit test you want a unit test before</span> <span data-start="552.25" data-end="554.26">you deploy your application so you test</span> <span data-start="554.26" data-end="556">a single functions of your application</span> <span data-start="556" data-end="557.98">or your service and then you deploy your</span> <span data-start="557.98" data-end="559.96">application because you are confident</span> <span data-start="559.96" data-end="561.79">that your application is working fine</span> <span data-start="561.79" data-end="565.24">because you have unit tested it but then</span> <span data-start="565.24" data-end="568.48">when you deploy you perform some</span> <span data-start="568.48" data-end="570.31">integration tests or service level tests</span> <span data-start="570.31" data-end="572.62">so you're focusing on a single service</span> <span data-start="572.62" data-end="575.8">the single service is the minimum unit</span> <span data-start="575.8" data-end="577.87">after deployment for us the engineers</span> <span data-start="577.87" data-end="581.02">you deploy several services and so this</span> <span data-start="581.02" data-end="583.78">end-to-end test so this integration test</span> <span data-start="583.78" data-end="586.21">or survey level test for those single</span> <span data-start="586.21" data-end="589.27">units from the engineering side but what</span> <span data-start="589.27" data-end="592.15">the user sees is like the whole system</span> <span data-start="592.15" data-end="594.76">and the user has user intense user</span> <span data-start="594.76" data-end="597.6">actions or also called user journeys</span> <span data-start="597.6" data-end="600.46">they are testing things across all the</span> <span data-start="600.46" data-end="603.25">system across all your services so</span> <span data-start="603.25" data-end="606.46">that's the kind of level I'm referring</span> <span data-start="606.46" data-end="607.75">when I'm talking about testing in</span> <span data-start="607.75" data-end="609.97">production you want to become a real</span> <span data-start="609.97" data-end="611.92">user you want to be in the skin of a</span> <span data-start="611.92" data-end="614.56">user and try all the possible actions a</span> <span data-start="614.56" data-end="616.48">user can do to make sure your system</span> <span data-start="616.48" data-end="622.31">still works as expected</span> <span data-start="622.32" data-end="625.51">how can JavaScript or Nadia's help with</span> <span data-start="625.51" data-end="629.23">that well this is where my example comes</span> <span data-start="629.23" data-end="633.04">into into show so at the moment I'm</span> <span data-start="633.04" data-end="636.43">working at Tyson and we have more than 1</span> <span data-start="636.43" data-end="638.26">million connected machine performing</span> <span data-start="638.26" data-end="641.11">actions against the cloud and calling</span> <span data-start="641.11" data-end="643.03">our services calling our Web API or</span> <span data-start="643.03" data-end="646.15">lambdas blah blah blah and and also uses</span> <span data-start="646.15" data-end="649.45">all around the globe doing actions and</span> <span data-start="649.45" data-end="651.4">performing actions just like renaming</span> <span data-start="651.4" data-end="654.46">your robot from Dyson 360 i2 mega ii</span> <span data-start="654.46" data-end="660.22">9000 whatever and then what happens is</span> <span data-start="660.22" data-end="661">that</span> <span data-start="661" data-end="664.87">it's a big system it's a form of several</span> <span data-start="664.87" data-end="667.18">moving parts and I want to make sure</span> <span data-start="667.18" data-end="669.31">that users can change the name of the</span> <span data-start="669.31" data-end="671.5">robot and don't get an error right so I</span> <span data-start="671.5" data-end="675.819">need a tool that's fast that's easy to</span> <span data-start="675.819" data-end="678.879">run in production so when I want to</span> <span data-start="678.879" data-end="681.819">verify that all the user actions all the</span> <span data-start="681.819" data-end="683.86">user journeys are working in production</span> </p>
<p><span data-start="683.86" data-end="686.86">I run the tool like this docker</span> <span data-start="686.86" data-end="688.54">container whatever it's not difficult to</span> <span data-start="688.54" data-end="691.05">deploy I want it to be extendable also</span> <span data-start="691.05" data-end="693.67">so when I write new services I write new</span> <span data-start="693.67" data-end="697">web api's whatever I can add new</span> <span data-start="697" data-end="699.55">libraries or new files and having those</span> <span data-start="699.55" data-end="704.319">testing situations and also I would like</span> <span data-start="704.319" data-end="706.689">to have the ability to write behavior</span> <span data-start="706.689" data-end="709.81">driven development tests if you want to</span> <span data-start="709.81" data-end="713.35">call them like that so really what I</span> <span data-start="713.35" data-end="716.949">want to find what they a scenario for</span> <span data-start="716.949" data-end="719.529">real user is what real users gonna how I</span> <span data-start="719.529" data-end="721.36">really use is going to interact with my</span> <span data-start="721.36" data-end="725.589">systems and and then try to reproduce</span> <span data-start="725.589" data-end="728.829">that automated simulating those paid to</span> <span data-start="728.829" data-end="731.5">a user simulating everything but no</span> <span data-start="731.5" data-end="733.449">emulates in the cloud emulating my</span> <span data-start="733.449" data-end="737.92">services the solution that we come to a</span> <span data-start="737.92" data-end="742.059">place was a tool written in JavaScript</span> <span data-start="742.059" data-end="746.019">using nodejs and the main libraries that</span> <span data-start="746.019" data-end="748.839">we are using are koo kumba a Jas and the</span> <span data-start="748.839" data-end="751.42">request library was also a bit of the</span> <span data-start="751.42" data-end="755.259">user library and basically what we try</span> <span data-start="755.259" data-end="758.35">to define a lot of singular steps a lot</span> <span data-start="758.35" data-end="761.23">of single actions and then using koo</span> <span data-start="761.23" data-end="764.019">kumba areas and then putting all those</span> <span data-start="764.019" data-end="766.569">actions together into a group to form an</span> <span data-start="766.569" data-end="771.009">x scenario you're gonna see now and yeah</span> <span data-start="771.009" data-end="773.019">then using the request library just to</span> <span data-start="773.019" data-end="775.959">make requests over the Internet HTTP or</span> </p>
<p><span data-start="775.959" data-end="778.629">HTTPS requests and the SL library to</span> <span data-start="778.629" data-end="780.279">assert that the values we are getting</span> <span data-start="780.279" data-end="783.87">back are they the ones that we expect</span> <span data-start="783.87" data-end="788.259">this is an example of of the cucumber of</span> <span data-start="788.259" data-end="790.839">a scenario written in cucumber yes or</span> <span data-start="790.839" data-end="793.689">what our next scenario really I want to</span> <span data-start="793.689" data-end="794.44">test</span> <span data-start="794.44" data-end="796.93">that given an existing user with this</span> <span data-start="796.93" data-end="799.389">configuration and the user locks in and</span> <span data-start="799.389" data-end="801.879">the user changes the robot name to</span> <span data-start="801.879" data-end="804.31">whatever then the one the robot name has</span> <span data-start="804.31" data-end="806.589">changed I want to test that that's a</span> <span data-start="806.589" data-end="809.17">it's an user action I'm not testing one</span> <span data-start="809.17" data-end="809.74">service</span> </p>
<p><span data-start="809.74" data-end="811.209">I'm not test I'm not testing one</span> <span data-start="811.209" data-end="813.759">function I'm testing the use of uranium</span> <span data-start="813.759" data-end="816.939">testing the user intent and that's what</span> <span data-start="816.939" data-end="821.199">we want we want to try and do what the</span> <span data-start="821.199" data-end="823.42">users will be doing in in production</span> <span data-start="823.42" data-end="827.8">with our systems this is a very simple</span> <span data-start="827.8" data-end="830.589">schema of how it works</span> <span data-start="830.589" data-end="833.139">we have the users the users at the</span> <span data-start="833.139" data-end="835.48">moment interact with a smartphone</span> <span data-start="835.48" data-end="838.66">application that smartphone application</span> <span data-start="838.66" data-end="841.029">sends commands to the cloud and then the</span> <span data-start="841.029" data-end="843.25">cloud communicates the comments back to</span> <span data-start="843.25" data-end="845.17">the to the robot to the cleaning robot</span> <span data-start="845.17" data-end="848.439">for example and I was testing to and</span> </p>
<p><span data-start="848.439" data-end="854.379">Mason tested to a ki ATT has built well</span> <span data-start="854.379" data-end="856.6">users because there are no real users</span> <span data-start="856.6" data-end="858.819">have a bitch world a smartphone app and</span> <span data-start="858.819" data-end="861.399">that's making the calls to the cloud and</span> <span data-start="861.399" data-end="864.329">back and it's also emulating the robot</span> <span data-start="864.329" data-end="867.88">so we are simulating all the points in</span> <span data-start="867.88" data-end="870.339">production except the cloud our services</span> <span data-start="870.339" data-end="872.29">in production does we want to behave</span> <span data-start="872.29" data-end="881.069">like users but if you test in production</span> <span data-start="881.069" data-end="883.3">basically you are stressing your</span> <span data-start="883.3" data-end="885.279">production systems you are becoming a</span> <span data-start="885.279" data-end="887.35">user and if you run your testing</span> <span data-start="887.35" data-end="889.389">production very fast or you do a lot of</span> <span data-start="889.389" data-end="892.66">actions you become like a million users</span> <span data-start="892.66" data-end="895.209">talking to your services at a given time</span> <span data-start="895.209" data-end="898.24">and you don't want that so you need to</span> <span data-start="898.24" data-end="901.509">keep a balance between what you are</span> <span data-start="901.509" data-end="903.1">testing in production and what you want</span> <span data-start="903.1" data-end="907.75">to assert you don't want it's good that</span> <span data-start="907.75" data-end="909.819">you are very close to the to the user</span> <span data-start="909.819" data-end="911.8">and to the real actions but you need to</span> <span data-start="911.8" data-end="915.22">to balance it right so for it as an</span> <span data-start="915.22" data-end="918.879">example of this when we were writing the</span> <span data-start="918.879" data-end="920.58">test and</span> <span data-start="920.58" data-end="923.64">we started doing tests like every five</span> <span data-start="923.64" data-end="926.91">minutes I guess if I recall and what</span> <span data-start="926.91" data-end="928.19">happened is that we started getting</span> <span data-start="928.19" data-end="931.38">getting slowdowns on our web api because</span> <span data-start="931.38" data-end="933.269">we were quite in the way API so every</span> <span data-start="933.269" data-end="935.07">five minutes doing a lot of tests and</span> <span data-start="935.07" data-end="937.17">then it was a slowing down our</span> <span data-start="937.17" data-end="939.51">productions services and we don't want</span> <span data-start="939.51" data-end="941.519">we don't want that for the users and</span> <span data-start="941.519" data-end="943.47">also we experienced it</span> <span data-start="943.47" data-end="946.74">some DynamoDB throttling so database</span> <span data-start="946.74" data-end="949.5">throttling as I was testing was doing</span> <span data-start="949.5" data-end="952.44">cost to the API very fast and and today</span> <span data-start="952.44" data-end="955.89">and read and write to DynamoDB or the</span> <span data-start="955.89" data-end="958.709">database then we got throttle and that</span> <span data-start="958.709" data-end="961.92">was affecting users so you need to be</span> <span data-start="961.92" data-end="964.05">careful about that you need to a space a</span> <span data-start="964.05" data-end="967.92">bit your end-to-end test so the more</span> <span data-start="967.92" data-end="969.63">things you run them the faster you're</span> <span data-start="969.63" data-end="971.01">going to realize that you have an issue</span> <span data-start="971.01" data-end="975.329">if there's an issue but then you get</span> <span data-start="975.329" data-end="977.399">more noise because you get more noise</span> <span data-start="977.399" data-end="979.62">unless you get more noise on the matrix</span> <span data-start="979.62" data-end="982.279">you get motion more noise everywhere and</span> <span data-start="982.279" data-end="983.519">slowdowns</span> <span data-start="983.519" data-end="986.16">it slows down your production system and</span> <span data-start="986.16" data-end="989.329">so you want to keep a balance about that</span> <span data-start="989.329" data-end="992.97">and and just this is another another</span> <span data-start="992.97" data-end="997.68">quick bit when for this testing tool we</span> <span data-start="997.68" data-end="1002.06">are simulating these users so we have</span> <span data-start="1002.06" data-end="1003.89">code in JavaScript how a user will</span> <span data-start="1003.89" data-end="1004.399">behave</span> <span data-start="1004.399" data-end="1007.49">what API schooled the user hit and what</span> <span data-start="1007.49" data-end="1010.19">does the user want to do like for</span> <span data-start="1010.19" data-end="1012.14">example changing the name of the robot</span> <span data-start="1012.14" data-end="1015.47">and yeah as I said we want to test a</span> <span data-start="1015.47" data-end="1022.579">real user behavior okay so basically</span> <span data-start="1022.579" data-end="1024.949">yeah again when you run your test in</span> <span data-start="1024.949" data-end="1028.459">production you are becoming another user</span> <span data-start="1028.459" data-end="1033.64">you are becoming part of the system and</span> <span data-start="1033.64" data-end="1039.11">equal skew your matrix for example the</span> <span data-start="1039.11" data-end="1040.429">number of users are interacting with</span> <span data-start="1040.429" data-end="1042.62">your system you want to report to your</span> <span data-start="1042.62" data-end="1045.35">manager or to the business how many</span> <span data-start="1045.35" data-end="1047.9">users are using your your production</span> <span data-start="1047.9" data-end="1049.85">services but if you have this end-to-end</span> <span data-start="1049.85" data-end="1052.79">test running in production then that's</span> <span data-start="1052.79" data-end="1054.37">giving your result also</span> <span data-start="1054.37" data-end="1057.309">if you want to know how many calls to an</span> </p>
<p><span data-start="1057.309" data-end="1061.029">API and also the error count so for</span> <span data-start="1061.029" data-end="1062.83">example you are very interested on how</span> <span data-start="1062.83" data-end="1066.73">many times your API switch on in a 500</span> <span data-start="1066.73" data-end="1068.89">or switch on in a 400 if you have the</span> <span data-start="1068.89" data-end="1070.809">end-to-end test that's gonna skew your</span> <span data-start="1070.809" data-end="1073.39">whistle so you need a way of keeping</span> <span data-start="1073.39" data-end="1076.029">those tests that you know about them</span> <span data-start="1076.029" data-end="1077.65">that you are generating them keeping</span> <span data-start="1077.65" data-end="1080.83">them out of the statistics and you could</span> <span data-start="1080.83" data-end="1082.63">also get mixed locks so if you have a</span> <span data-start="1082.63" data-end="1084.73">login utility that's put that puts all</span> <span data-start="1084.73" data-end="1089.14">the locks together like plank or</span> <span data-start="1089.14" data-end="1093.61">elasticsearch how do you discern which</span> <span data-start="1093.61" data-end="1095.919">locks were part of the end-to-end tests</span> <span data-start="1095.919" data-end="1098.59">or which locks were power of real users</span> <span data-start="1098.59" data-end="1102.58">doing real actions so yeah you need to</span> <span data-start="1102.58" data-end="1106.539">be careful with that how can we how can</span> <span data-start="1106.539" data-end="1108.73">we keep our test out of the stylistics</span> <span data-start="1108.73" data-end="1111.64">we could use a correlation ID so with</span> <span data-start="1111.64" data-end="1115.299">every request we would send as part of</span> <span data-start="1115.299" data-end="1117.49">the request a correlation ID or we will</span> <span data-start="1117.49" data-end="1120.01">generate a correlation ID that's going</span> <span data-start="1120.01" data-end="1122.169">to be pass between the different</span> <span data-start="1122.169" data-end="1125.11">services internally so every service if</span> <span data-start="1125.11" data-end="1127.059">they see the correlation idea starting</span> <span data-start="1127.059" data-end="1130.899">by end-to-end ffffff' they gonna know</span> <span data-start="1130.899" data-end="1133.809">it's part of the test they shouldn't</span> <span data-start="1133.809" data-end="1136.33">behave differently but at least not log</span> <span data-start="1136.33" data-end="1138.34">in matrix for example or log in matrix</span> <span data-start="1138.34" data-end="1140.95">to a different name space we could also</span> <span data-start="1140.95" data-end="1143.799">change the user alien in case of web api</span> <span data-start="1143.799" data-end="1148.169">s ‚Äî  by yeah specifying instead of being</span> <span data-start="1148.169" data-end="1152.649">mozilla gecko whatever you have your</span> <span data-start="1152.649" data-end="1154.75">application and twin test and the</span> <span data-start="1154.75" data-end="1157.36">version and finally you can also add new</span> </p>
<p><span data-start="1157.36" data-end="1162.25">HTTP headers that nobody is gonna freak</span> <span data-start="1162.25" data-end="1164.5">about that you just put test to version</span> <span data-start="1164.5" data-end="1167.32">one point one point two or whatever and</span> <span data-start="1167.32" data-end="1171.909">then you treat them differently you not</span> <span data-start="1171.909" data-end="1173.77">treat them differently you don't lock</span> <span data-start="1173.77" data-end="1175.57">the metrics if you see the header coming</span> <span data-start="1175.57" data-end="1180.94">in into your production systems right so</span> <span data-start="1180.94" data-end="1185.08">after everything this this was a quick</span> <span data-start="1185.08" data-end="1186.789">introduction to how to run end-to-end</span> <span data-start="1186.789" data-end="1188.35">test and production</span> <span data-start="1188.35" data-end="1190.87">you now have you end-to-end test running</span> <span data-start="1190.87" data-end="1193.059">in production they are executing every</span> <span data-start="1193.059" data-end="1195.48">15 minutes every 20 minutes 30 minutes</span> <span data-start="1195.48" data-end="1199.95">and they are passing that's great but</span> <span data-start="1199.95" data-end="1202.45">what about all the fake that they have</span> <span data-start="1202.45" data-end="1205.96">generated so they they were built well</span> <span data-start="1205.96" data-end="1208.51">users or built on machines built or</span> <span data-start="1208.51" data-end="1210.82">smartphone apps that were creating new</span> <span data-start="1210.82" data-end="1214.21">users that were creating new cleans new</span> <span data-start="1214.21" data-end="1218.4">new data to our production systems and</span> <span data-start="1218.4" data-end="1221.71">that's fake data with them really wanted</span> <span data-start="1221.71" data-end="1225.88">into in the system and it's making some</span> <span data-start="1225.88" data-end="1228.46">it's it's it's going to cause a problem</span> <span data-start="1228.46" data-end="1233.74">in the long run so for example we were</span> <span data-start="1233.74" data-end="1238.929">login when you register a machine into</span> <span data-start="1238.929" data-end="1242.5">the cloud into the services we store a</span> <span data-start="1242.5" data-end="1246.16">row in the database saying this machine</span> <span data-start="1246.16" data-end="1249.13">is now just now six and belongs to this</span> <span data-start="1249.13" data-end="1253">user so as we were executing the</span> <span data-start="1253" data-end="1254.38">end-to-end test in production we were</span> <span data-start="1254.38" data-end="1256.179">creating new machines with new user</span> <span data-start="1256.179" data-end="1258.79">random machines random users bla bla bla</span> <span data-start="1258.79" data-end="1258.97">bla</span> <span data-start="1258.97" data-end="1263.08">we were filling the database and what</span> <span data-start="1263.08" data-end="1264.76">happened was that our services in</span> <span data-start="1264.76" data-end="1266.2">production were querying the database</span> <span data-start="1266.2" data-end="1272.29">and and getting all those users and the</span> <span data-start="1272.29" data-end="1274.51">services were expecting to find between</span> <span data-start="1274.51" data-end="1279.01">one and ninety and twist different</span> <span data-start="1279.01" data-end="1281.17">entries in production but we were</span> <span data-start="1281.17" data-end="1283.15">generating a lot of entries every single</span> <span data-start="1283.15" data-end="1285.25">day so the entries ended up like being</span> <span data-start="1285.25" data-end="1288.1">in the order of thousand entries what</span> <span data-start="1288.1" data-end="1289.66">happened that our service was not</span> <span data-start="1289.66" data-end="1292.6">prepared to do any pagination and then</span> <span data-start="1292.6" data-end="1294.55">it started failing for the customers</span> <span data-start="1294.55" data-end="1296.71">because we couldn't find their entries</span> <span data-start="1296.71" data-end="1299.17">because they were in their page six or</span> <span data-start="1299.17" data-end="1301.48">page seven because all the tests all the</span> <span data-start="1301.48" data-end="1303.04">testing production were generating more</span> <span data-start="1303.04" data-end="1305.74">data and filling up the database under</span> <span data-start="1305.74" data-end="1310.72">sub problems so yeah you need to clean</span> <span data-start="1310.72" data-end="1314.47">that data it's very important and you</span> <span data-start="1314.47" data-end="1317.14">want to do that automatically if</span> <span data-start="1317.14" data-end="1321.37">possible after every single test run</span> <span data-start="1321.37" data-end="1325.52">so it it helps to to keep your</span> <span data-start="1325.52" data-end="1327.62">environment clean it helps to start the</span> <span data-start="1327.62" data-end="1329.84">test the next test to start them from a</span> <span data-start="1329.84" data-end="1333.59">clean state avoid cluttering your your</span> <span data-start="1333.59" data-end="1337.66">databases or cluttering your services or</span> <span data-start="1337.66" data-end="1340.55">exhausting any of the limited resources</span> <span data-start="1340.55" data-end="1346.13">like IDs or yeah any any any other</span> <span data-start="1346.13" data-end="1348.05">limited resources you you could have in</span> <span data-start="1348.05" data-end="1351.02">your production system and and also</span> <span data-start="1351.02" data-end="1354.32">avoid as an example I just put about</span> <span data-start="1354.32" data-end="1356.57">it's making weird hm more difficult to</span> <span data-start="1356.57" data-end="1363.02">query to retrieve and to search so as a</span> <span data-start="1363.02" data-end="1365.99">recap testing in production is good and</span> <span data-start="1365.99" data-end="1368.33">necessary please do it if you are not</span> <span data-start="1368.33" data-end="1371.84">doing it you need to think as a real use</span> <span data-start="1371.84" data-end="1373.76">it to put yourself in in the skin of a</span> <span data-start="1373.76" data-end="1376.64">user and act like a user so that you</span> <span data-start="1376.64" data-end="1378.68">have really testing your your system</span> <span data-start="1378.68" data-end="1381.62">then using the framework cucumber yes</span> <span data-start="1381.62" data-end="1384.2">it's a good start and we found that it</span> <span data-start="1384.2" data-end="1387.65">work for us and it's it's amazing you</span> <span data-start="1387.65" data-end="1389.12">need to think also about your system</span> <span data-start="1389.12" data-end="1392.48">capacity so if your system cannot handle</span> <span data-start="1392.48" data-end="1394.97">a thousand requests per second then you</span> <span data-start="1394.97" data-end="1396.95">shouldn't be doing that many end to end</span> <span data-start="1396.95" data-end="1399.92">test space them a bit every half an hour</span> <span data-start="1399.92" data-end="1404.9">every 45 minutes whatever fits you you</span> <span data-start="1404.9" data-end="1407.99">also want to mark your test intents to</span> <span data-start="1407.99" data-end="1410.42">differentiate them from the from the</span> <span data-start="1410.42" data-end="1412.88">production load from the real users with</span> <span data-start="1412.88" data-end="1415.79">a correlation ID or with the HTTP header</span> <span data-start="1415.79" data-end="1419.03">or any other any other solution and</span> <span data-start="1419.03" data-end="1421.22">after that you want to clean your test</span> <span data-start="1421.22" data-end="1424.43">data and we set every connections or</span> <span data-start="1424.43" data-end="1427.31">every any status you might have changed</span> <span data-start="1427.31" data-end="1432.38">after after this test and the so</span> <span data-start="1432.38" data-end="1436.75">basically thank you for for listening</span> <span data-start="1436.75" data-end="1438.89">one more thing I would like to take a</span> <span data-start="1438.89" data-end="1441.08">bit boring job I will smile for the gram</span> <span data-start="1441.08" data-end="1444.35">selfie and then ever now because I have</span> <span data-start="1444.35" data-end="1451.13">plenty of spare time so now smile I hope</span> </p>
<p><span data-start="1451.13" data-end="1453.61">I can fit everyone</span> <span data-start="1453.61" data-end="1458.73">amazing and way</span> <span data-start="1458.74" data-end="1462.169">thank you but just wait are you brave</span> <span data-start="1462.169" data-end="1465.679">enough to test in production are you can</span> <span data-start="1465.679" data-end="1470.84">I hear you well yeah so now the applause</span> <span data-start="1470.84" data-end="1471.44">thank you</span> </p>
</section>