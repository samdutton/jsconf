<section>
<p><span data-start="9.019" data-end="11.7">my name is Guillermo ouch i'm the</span> <span data-start="11.7" data-end="14.91">creator of socket i/o also co-founder</span> <span data-start="14.91" data-end="17.359">and CTO of a startup called Lauren boost</span> <span data-start="17.359" data-end="24.029">in the education space so I assume as</span> <span data-start="24.029" data-end="26.58">many of you might be aware of socket i/o</span> <span data-start="26.58" data-end="28.47">is a way of doing real-time applications</span> <span data-start="28.47" data-end="33">on every browser also a server now with</span> <span data-start="33" data-end="35.07">a simple API that resembles WebSocket a</span> <span data-start="35.07" data-end="38.04">lot so so far we've seen a lot of</span> <span data-start="38.04" data-end="41.01">adoption and many applications deployed</span> <span data-start="41.01" data-end="42.899">to production with it and many projects</span> <span data-start="42.899" data-end="45">created with it and with that we've</span> <span data-start="45" data-end="50.879">learned some lessons and we've finally</span> <span data-start="50.879" data-end="53.34">come up with a speck of how other people</span> <span data-start="53.34" data-end="55.05">that might want Sokka Dale and the saga</span> <span data-start="55.05" data-end="58.289">do protocol on other servers and other</span> <span data-start="58.289" data-end="61.23">languages might go about creating it so</span> <span data-start="61.23" data-end="64.619">they go for the next release of socket</span> <span data-start="64.619" data-end="68.07">i/o that has been already pushed to get</span> <span data-start="68.07" data-end="71.22">having an alpha State is sort of</span> <span data-start="71.22" data-end="74.04">implementing this spec implementing sort</span> <span data-start="74.04" data-end="75.33">of new features that are going to be the</span> <span data-start="75.33" data-end="79.35">foundation of socket i/o and so that's</span> <span data-start="79.35" data-end="83.34">what I'm going to talk about today first</span> <span data-start="83.34" data-end="87.59">of all I made some architectural changes</span> <span data-start="87.59" data-end="90.54">the like I said the prodigal the socket</span> <span data-start="90.54" data-end="92.67">a protocol which is what we need</span> <span data-start="92.67" data-end="95.43">essentially to make web socket and long</span> <span data-start="95.43" data-end="98.07">polling or other transports converge and</span> <span data-start="98.07" data-end="101.43">maintain sessions for users so they we</span> <span data-start="101.43" data-end="103.829">can for example buffer messages from the</span> <span data-start="103.829" data-end="107.97">server and the client we have we have</span> <span data-start="107.97" data-end="110.49">made some API changes so that it's</span> <span data-start="110.49" data-end="113.7">easier to get up and running we haven't</span> <span data-start="113.7" data-end="116.46">a new way of doing tests which basically</span> <span data-start="116.46" data-end="120.84">is I created on node client that I'm</span> <span data-start="120.84" data-end="122.49">going to use to test the node server and</span> <span data-start="122.49" data-end="127.979">vice versa so before each time you would</span> <span data-start="127.979" data-end="129.619">run socket i/o you were limited to</span> <span data-start="129.619" data-end="132.39">storing every message and every user and</span> <span data-start="132.39" data-end="133.46">every session ID</span> <span data-start="133.46" data-end="137.24">on one process of one computer so if</span> <span data-start="137.24" data-end="139.28">that process were to die or you wanted</span> <span data-start="139.28" data-end="141.38">to use two computers to handle a number</span> <span data-start="141.38" data-end="143.42">a higher number of messages per second</span> <span data-start="143.42" data-end="146.5">or a higher number of connected users</span> <span data-start="146.5" data-end="150.26">you basically had to create a message</span> <span data-start="150.26" data-end="151.73">you basically implement a message</span> <span data-start="151.73" data-end="153.71">dispatcher yourself you would subscribe</span> <span data-start="153.71" data-end="157.7">clients to a Redis set or pops up or you</span> <span data-start="157.7" data-end="161.87">would use RabbitMQ so today so k is</span> <span data-start="161.87" data-end="164.59">going to take care of that for you and</span> <span data-start="164.59" data-end="169.07">also another important thing is many</span> <span data-start="169.07" data-end="171.04">people have different needs as far as</span> <span data-start="171.04" data-end="174.14">how much latency they can afford for</span> <span data-start="174.14" data-end="175.79">their applications so some people might</span> <span data-start="175.79" data-end="178.55">want to just completely ditch the flash</span> <span data-start="178.55" data-end="180.38">transport because it adds a lot of bloat</span> <span data-start="180.38" data-end="183.38">and they can afford to use long polling</span> <span data-start="183.38" data-end="187.13">and said fallback transport so I've made</span> <span data-start="187.13" data-end="188.9">the hell shake process and it made the</span> <span data-start="188.9" data-end="190.76">socket interface is more configurable so</span> <span data-start="190.76" data-end="193.01">that you can easily decide what</span> <span data-start="193.01" data-end="194.78">transports you want to use and other</span> <span data-start="194.78" data-end="197.12">options I'm going to talk a little bit</span> <span data-start="197.12" data-end="203.45">about the new API so I we made some we</span> <span data-start="203.45" data-end="205.61">made it easier to run a socket server</span> <span data-start="205.61" data-end="208.04">that is not tied to a particular HTTP</span> <span data-start="208.04" data-end="209.63">server so before you have to instantiate</span> <span data-start="209.63" data-end="213.32">it yourself now you can simply call I oh</span> <span data-start="213.32" data-end="215.81">listen or pass it a port and you'll have</span> <span data-start="215.81" data-end="218.62">your own standalone socket i/o server</span> <span data-start="218.62" data-end="221.78">before you would have to pass this huge</span> <span data-start="221.78" data-end="225.26">object of options with nested objects of</span> <span data-start="225.26" data-end="228.82">options and now we have expressed like</span> <span data-start="228.82" data-end="231.59">configuration so we can have you can</span> <span data-start="231.59" data-end="233.6">have different settings for development</span> <span data-start="233.6" data-end="235.82">and production which for a project like</span> </p>
<p><span data-start="235.82" data-end="237.85">Sokka do is extremely important</span> <span data-start="237.85" data-end="240.38">sometimes your clients might be dropping</span> <span data-start="240.38" data-end="242.42">because of network latency or you're</span> <span data-start="242.42" data-end="244.85">testing a mobile device so you want to</span> <span data-start="244.85" data-end="247.22">make sure you know why a certain clients</span> <span data-start="247.22" data-end="249.14">dropping is it because a heartbeat</span> <span data-start="249.14" data-end="252.62">wasn't received or is it because the</span> <span data-start="252.62" data-end="254.96">client is too slow for this for your</span> <span data-start="254.96" data-end="257.78">settings so you can customize things as</span> <span data-start="257.78" data-end="261.24">the logger the log level</span> <span data-start="261.25" data-end="265.24">so like I said up until today you were</span> <span data-start="265.24" data-end="270.4">constructed to one process in one server</span> <span data-start="270.4" data-end="274.4">we made some changes to make that more</span> <span data-start="274.4" data-end="277.04">flexible so by default you'll still it</span> <span data-start="277.04" data-end="278.54">is going to continue to store everything</span> <span data-start="278.54" data-end="280.64">in memory the main reasons that not</span> <span data-start="280.64" data-end="282.83">everyone has requirements to set up</span> </p>
<p><span data-start="282.83" data-end="286.1">Sokka do in a cluster or perform worker</span> <span data-start="286.1" data-end="288.59">process replacements with tools like</span> <span data-start="288.59" data-end="294.38">cluster or multi-node like like I said</span> <span data-start="294.38" data-end="295.94">it defaults to memory and one thing that</span> <span data-start="295.94" data-end="297.65">we have to change in order to make this</span> <span data-start="297.65" data-end="300.5">two modes of operating compatible is</span> <span data-start="300.5" data-end="305.5">that every signature that before was</span> <span data-start="305.5" data-end="309.2">chance accessing memory now is an async</span> <span data-start="309.2" data-end="311.18">call back so from your socket i/o</span> <span data-start="311.18" data-end="312.71">instance if you needed to access a</span> <span data-start="312.71" data-end="315.26">client list before you would go sacate</span> <span data-start="315.26" data-end="317.09">other clients and now you're going to go</span> <span data-start="317.09" data-end="318.53">suck at a the clients and positive</span> <span data-start="318.53" data-end="323.33">function something really useful as well</span> <span data-start="323.33" data-end="325.97">is the ability to associate data with a</span> <span data-start="325.97" data-end="327.83">particular client so when someone</span> <span data-start="327.83" data-end="331.52">connects we can for example set and</span> <span data-start="331.52" data-end="333.14">nickname and that's going to leverage</span> <span data-start="333.14" data-end="334.88">the same existing storage that you're</span> <span data-start="334.88" data-end="337.52">using for your messages and for your</span> <span data-start="337.52" data-end="340.1">message queues so if someone connects</span> <span data-start="340.1" data-end="341.12">and you want to sort the nickname</span> <span data-start="341.12" data-end="342.29">they're going to have for the session</span> <span data-start="342.29" data-end="344.57">you can do that directly from Sokka do</span> <span data-start="344.57" data-end="350">as well another thing that is really</span> <span data-start="350" data-end="353.48">important is the ability to send</span> <span data-start="353.48" data-end="357.26">messages that can be dropped and should</span> <span data-start="357.26" data-end="359.12">not be buffered so for example if you</span> <span data-start="359.12" data-end="360.26">are creating an application that</span> <span data-start="360.26" data-end="362.9">displays tweets or you're creating an</span> <span data-start="362.9" data-end="365.3">application that you want to show the</span> <span data-start="365.3" data-end="367.61">latest stock prices to the users you</span> <span data-start="367.61" data-end="368.81">don't want it and you're retrieving</span> <span data-start="368.81" data-end="371.15">stock prices every second but you have a</span> <span data-start="371.15" data-end="372.44">client that is only taking messages</span> <span data-start="372.44" data-end="374.78">every five seconds or so you don't want</span> <span data-start="374.78" data-end="376.97">to buffer every single message you you</span> <span data-start="376.97" data-end="379.28">want Sokka do to drop some of them so</span> <span data-start="379.28" data-end="382.1">that you always receive the latest so</span> <span data-start="382.1" data-end="385.07">that's what the volatile flag does and</span> <span data-start="385.07" data-end="387.14">it's really easy to use so before you</span> <span data-start="387.14" data-end="391.07">would you would say sockets and and you</span> <span data-start="391.07" data-end="391.4">would send</span> <span data-start="391.4" data-end="394.58">message to the user so now by simply for</span> <span data-start="394.58" data-end="396.62">fixing it with volatile you can make</span> <span data-start="396.62" data-end="400.4">that message forgettable so if Sokka do</span> <span data-start="400.4" data-end="402.91">cannot write it to the user which is</span> <span data-start="402.91" data-end="405.1">important for example for long polling</span> <span data-start="405.1" data-end="407.78">where the client is opening request and</span> <span data-start="407.78" data-end="409.94">response cycles and we're only able to</span> <span data-start="409.94" data-end="411.8">write data to the user whenever they</span> <span data-start="411.8" data-end="414.259">open their request but between between</span> <span data-start="414.259" data-end="416.81">two requests and sorry between a request</span> <span data-start="416.81" data-end="418.97">and response we cannot write to the user</span> <span data-start="418.97" data-end="422.06">because it's not server push so those</span> <span data-start="422.06" data-end="423.77">messages would be dropped while the user</span> <span data-start="423.77" data-end="429.56">is temporarily not connected another</span> <span data-start="429.56" data-end="432.289">flag that i'm adding is called Jason so</span> <span data-start="432.289" data-end="434.69">before Sokka do was smart enough to</span> <span data-start="434.69" data-end="437.03">detect that you were sending something</span> <span data-start="437.03" data-end="439.52">that was not a string and serialized it</span> <span data-start="439.52" data-end="443.03">into Jason so the problem is that even</span> <span data-start="443.03" data-end="445.25">strings can be serialized in to Jayson</span> <span data-start="445.25" data-end="448.07">so if you want to force one hundred</span> <span data-start="448.07" data-end="449.57">percent Jason encoding you can also use</span> <span data-start="449.57" data-end="452.3">the Jason flag and you can combine them</span> <span data-start="452.3" data-end="454.759">so if you want to send Jason as a</span> <span data-start="454.759" data-end="457.28">volatile message you just concatenate</span> <span data-start="457.28" data-end="462.5">them and I really useful thing is</span> <span data-start="462.5" data-end="465.229">acknowledgments so sometime so the way</span> <span data-start="465.229" data-end="466.76">that WebSocket works you write a message</span> <span data-start="466.76" data-end="469.099">you never get a call back unless you</span> <span data-start="469.099" data-end="471.169">implement it yourself so you can send a</span> <span data-start="471.169" data-end="473.479">message that is prefixed by an ID and</span> <span data-start="473.479" data-end="475.88">then have your server respond with that</span> <span data-start="475.88" data-end="477.729">particular ID so you would get an</span> <span data-start="477.729" data-end="479.36">acknowledgement that your message has</span> <span data-start="479.36" data-end="482.57">been received by the server so i built</span> <span data-start="482.57" data-end="485.12">the machinery for acknowledgments into</span> <span data-start="485.12" data-end="487.669">the socket 80 protocol and implementing</span> <span data-start="487.669" data-end="489.56">it as a developer as a user of the</span> <span data-start="489.56" data-end="492.44">library is extremely easy so every time</span> <span data-start="492.44" data-end="494.15">you send a message if you pass a</span> <span data-start="494.15" data-end="497.18">function as the last parameter that's</span> <span data-start="497.18" data-end="498.59">going to send that that's going to</span> <span data-start="498.59" data-end="501.08">append an ID to the to the message that</span> <span data-start="501.08" data-end="504.86">is being sent through the wire and the</span> <span data-start="504.86" data-end="507.08">client will respond and it's also</span> <span data-start="507.08" data-end="509.33">symmetrical so a client can send a</span> <span data-start="509.33" data-end="511.46">message that has a callback associated</span> <span data-start="511.46" data-end="513.62">with it and the server will respond with</span> <span data-start="513.62" data-end="519.32">an acknowledgement another thing that it</span> <span data-start="519.32" data-end="523.32">was actually requested many times</span> <span data-start="523.32" data-end="526.27">it really doesn't add any blow to the</span> <span data-start="526.27" data-end="527.98">prodigal and that's the main reason that</span> <span data-start="527.98" data-end="530.02">it's been added is the ability to define</span> <span data-start="530.02" data-end="533.11">your custom events so you can still use</span> </p>
<p><span data-start="533.11" data-end="536.29">Sokka do as a unconnect on message and</span> <span data-start="536.29" data-end="539.26">on disconnect but certain applications</span> <span data-start="539.26" data-end="541.63">will fit other semantics better so if</span> <span data-start="541.63" data-end="543.73">you're creating a chat application you</span> <span data-start="543.73" data-end="546.46">might want user connected user joined</span> <span data-start="546.46" data-end="549.4">Rome user sending private messages so</span> <span data-start="549.4" data-end="551.95">now you can define these events and they</span> <span data-start="551.95" data-end="553.45">are sent through the socket a prodigal</span> <span data-start="553.45" data-end="556.57">in a very lightweight way so instead of</span> <span data-start="556.57" data-end="562.33">going sorry here is not io on chat</span> <span data-start="562.33" data-end="564.96">messages socket dot on chat message</span> <span data-start="564.96" data-end="568.24">essentially you can define chasm the</span> <span data-start="568.24" data-end="570.22">event emitter is overridden for sacate</span> <span data-start="570.22" data-end="571.81">oh so you can define your custom events</span> <span data-start="571.81" data-end="576.82">and omit custom events for events that</span> <span data-start="576.82" data-end="580.48">are user defined the parameters that you</span> <span data-start="580.48" data-end="583.3">send our JSON encoded that means that</span> <span data-start="583.3" data-end="585.1">you can send objects you can send</span> <span data-start="585.1" data-end="588.52">strings dates on it or any other in co</span> <span data-start="588.52" data-end="592.81">double entity so like I said events have</span> <span data-start="592.81" data-end="595.3">no protocol overhead they are optional</span> <span data-start="595.3" data-end="597.22">you can still use socket i/o as a cross</span> <span data-start="597.22" data-end="599.529">browser web socket if you like constrain</span> <span data-start="599.529" data-end="601.54">yourself to like the three basic events</span> <span data-start="601.54" data-end="605.38">and again it's compatible with flags and</span> <span data-start="605.38" data-end="608.5">acknowledgments so like I said it's</span> <span data-start="608.5" data-end="610.93">always events always use JSON but if you</span> <span data-start="610.93" data-end="613.3">want to send that volatile event so if</span> <span data-start="613.3" data-end="615.339">you're listening on a Twitter stream and</span> <span data-start="615.339" data-end="617.65">you want to send a tweet event and you</span> <span data-start="617.65" data-end="619.42">might want to drop some of them you can</span> <span data-start="619.42" data-end="622.93">do that by prefixing the emit by with a</span> <span data-start="622.93" data-end="626.47">volatile flag and something interesting</span> <span data-start="626.47" data-end="628.66">is that an acknowledgment from an</span> <span data-start="628.66" data-end="630.16">implementation point of view is just the</span> <span data-start="630.16" data-end="633.19">server sending us a packet back that is</span> <span data-start="633.19" data-end="635.98">basically an empty string but sometimes</span> <span data-start="635.98" data-end="637.33">you might want to acknowledge with</span> <span data-start="637.33" data-end="640">actual data so you might want to you</span> <span data-start="640" data-end="642.31">might want to say amid a nickname event</span> <span data-start="642.31" data-end="646.029">and as as part of the result get get a</span> <span data-start="646.029" data-end="648.13">response of whether the nickname could</span> <span data-start="648.13" data-end="649.69">be said or not or if it was being used</span> <span data-start="649.69" data-end="652.03">by another user in the case of a chat</span> <span data-start="652.03" data-end="655.87">application and that's also something</span> <span data-start="655.87" data-end="656.59">that is</span> <span data-start="656.59" data-end="661.18">empower essentially when you when you</span> <span data-start="661.18" data-end="666.09">emit an event if the function arity</span> <span data-start="666.09" data-end="668.95">meaning the number of arguments that are</span> <span data-start="668.95" data-end="670.57">defining the function that you pass it</span> <span data-start="670.57" data-end="672.7">as a callback for the acknowledgement is</span> <span data-start="672.7" data-end="675.07">greater than zero so in this case I'm</span> <span data-start="675.07" data-end="676.78">setting and emitting a nickname event</span> <span data-start="676.78" data-end="680.32">and the function expects at response</span> <span data-start="680.32" data-end="683.86">object so Sokka do will know that your</span> <span data-start="683.86" data-end="685.75">function the server side has responded</span> <span data-start="685.75" data-end="687.85">with data so in this case I'm performing</span> <span data-start="687.85" data-end="689.68">in a synchronous task which is checking</span> <span data-start="689.68" data-end="691.35">for the availability of that nickname</span> <span data-start="691.35" data-end="693.66">and this is really powerful because</span> <span data-start="693.66" data-end="696.04">there's many semantics that do not</span> <span data-start="696.04" data-end="697.6">require acknowledgement and do not</span> <span data-start="697.6" data-end="699.61">require data back from the server so for</span> <span data-start="699.61" data-end="701.53">example publishing a message to a stream</span> <span data-start="701.53" data-end="704.74">but there's many that do and events give</span> <span data-start="704.74" data-end="710.64">you this functionality now so finally</span> <span data-start="710.64" data-end="713.5">moving forward with the project one</span> <span data-start="713.5" data-end="714.67">thing I would like to see is people</span> <span data-start="714.67" data-end="717.58">creating reusable applications and not</span> <span data-start="717.58" data-end="720.12">just frameworks so today we have</span> <span data-start="720.12" data-end="723.67">frameworks like D node and juggernaut</span> <span data-start="723.67" data-end="728.17">which are awesome but if if we want this</span> <span data-start="728.17" data-end="729.64">to become mainstream and we want to</span> <span data-start="729.64" data-end="732.16">really enable people that are creating</span> <span data-start="732.16" data-end="734.26">web two point O applications doing start</span> <span data-start="734.26" data-end="736.36">inserting components of the real time</span> <span data-start="736.36" data-end="739">web we need to make sure that we can</span> <span data-start="739" data-end="742.69">distribute pre packaged applications and</span> <span data-start="742.69" data-end="745.09">to that end we need to solve to</span> <span data-start="745.09" data-end="746.8">basically one problem which is</span> <span data-start="746.8" data-end="749.71">preventing collisions and if you have a</span> <span data-start="749.71" data-end="752.62">particular eye socket AO instance you</span> <span data-start="752.62" data-end="755.59">need some machinery for two different</span> <span data-start="755.59" data-end="757.39">applications to share that without</span> <span data-start="757.39" data-end="759.25">having to initialize two different ones</span> <span data-start="759.25" data-end="763.36">so if two particular parts of your</span> <span data-start="763.36" data-end="765.58">website depend on web socket that's fine</span> <span data-start="765.58" data-end="768.04">you have two connections but if they</span> <span data-start="768.04" data-end="770.65">depend on long polling depending on the</span> <span data-start="770.65" data-end="772.51">browser and how many resources are being</span> <span data-start="772.51" data-end="774.28">loaded and how many people I've sockets</span> <span data-start="774.28" data-end="776.47">are open you might end up with like four</span> <span data-start="776.47" data-end="778.39">different connections just for your two</span> <span data-start="778.39" data-end="781">sockets so the idea is that we want to</span> <span data-start="781" data-end="783.28">be able to reuse a particular sicario</span> <span data-start="783.28" data-end="787.88">instance but be able to namespace it</span> <span data-start="787.89" data-end="792.28">and to that end I added the ability to</span> <span data-start="792.28" data-end="795.31">like sockets subscribe to channels</span> <span data-start="795.31" data-end="798.52">without the user knowing or having to</span> <span data-start="798.52" data-end="801.43">particularly subscribe or understand the</span> <span data-start="801.43" data-end="807.28">pops of kind of mechanism and the way it</span> <span data-start="807.28" data-end="810.13">works is really simple so by default the</span> <span data-start="810.13" data-end="812.61">when you define a socket it's going to</span> <span data-start="812.61" data-end="817.21">subscribe to the empty namespace that's</span> <span data-start="817.21" data-end="819.37">the default again you can continue use</span> </p>
<p><span data-start="819.37" data-end="822.88">Sokka do with as basically a WebSocket</span> <span data-start="822.88" data-end="825.13">it all the messages go through the same</span> <span data-start="825.13" data-end="828.46">stream but you can also define a</span> <span data-start="828.46" data-end="831.58">namespace just by prefixing your event</span> <span data-start="831.58" data-end="834.55">listeners with four so that part to your</span> <span data-start="834.55" data-end="837.1">socket for the news endpoint is going to</span> <span data-start="837.1" data-end="839.41">act as a standalone socket even though</span> <span data-start="839.41" data-end="840.76">it's going to go through the through the</span> <span data-start="840.76" data-end="845.68">same TCP connections a multiplexing is</span> <span data-start="845.68" data-end="849.04">automatic even on the client side if on</span> <span data-start="849.04" data-end="850.75">the clients that you define the same</span> <span data-start="850.75" data-end="852.52">hostname the same port and the same</span> <span data-start="852.52" data-end="854.29">protocol but you only change this</span> <span data-start="854.29" data-end="856.54">resource part of the URL then</span> <span data-start="856.54" data-end="858.75">multiplexing will be enabled for you and</span> <span data-start="858.75" data-end="861.01">packets that signal connection in this</span> <span data-start="861.01" data-end="863.77">connection of events of this socket will</span> <span data-start="863.77" data-end="866.04">be sent which means you can actually</span> <span data-start="866.04" data-end="868.839">disconnect the chat socket and keep the</span> <span data-start="868.839" data-end="874.48">new socket connected and that means that</span> <span data-start="874.48" data-end="876.16">every single event or every single</span> <span data-start="876.16" data-end="878.17">message that you send is constrained to</span> <span data-start="878.17" data-end="880.54">that particular namespace so this also</span> <span data-start="880.54" data-end="883.33">fits really well into how you could make</span> <span data-start="883.33" data-end="885.31">your own applications even if you're not</span> <span data-start="885.31" data-end="888.58">reusing third-party code so you might</span> <span data-start="888.58" data-end="890.65">have an event called item or an event</span> <span data-start="890.65" data-end="892.51">called message but they are actually two</span> <span data-start="892.51" data-end="894.04">different things in two different</span> <span data-start="894.04" data-end="901.51">namespaces and as far as where what</span> <span data-start="901.51" data-end="902.98">we're working on right now and what's</span> <span data-start="902.98" data-end="907.96">coming for the project so it it's</span> <span data-start="907.96" data-end="910.14">obvious that expresses the mainstream</span> <span data-start="910.14" data-end="913.39">web framework for node is the framework</span> <span data-start="913.39" data-end="916.06">that the community chose and we need</span> <span data-start="916.06" data-end="917.62">that really easy way to leverage and</span> <span data-start="917.62" data-end="921.04">connect session data with sockets so I</span> <span data-start="921.04" data-end="921.67">really</span> <span data-start="921.67" data-end="924.48">need is like okay so someone connected</span> <span data-start="924.48" data-end="926.71">through a socket and a particular page</span> <span data-start="926.71" data-end="929.11">but I want to retrieve what's his</span> <span data-start="929.11" data-end="931.21">username or what's his email from the</span> <span data-start="931.21" data-end="934.72">database and to this end the solution is</span> <span data-start="934.72" data-end="938.71">really simple by having a token of</span> <span data-start="938.71" data-end="941.5">authentication that expressed and Sokka</span> <span data-start="941.5" data-end="944.74">do can enter exchange they you can know</span> <span data-start="944.74" data-end="947.14">on what page the user is when what part</span> <span data-start="947.14" data-end="949.56">what particular out and who the user is</span> <span data-start="949.56" data-end="951.82">so this is a separate project that's</span> <span data-start="951.82" data-end="961.39">coming for express users another thing</span> <span data-start="961.39" data-end="964">that is challenging right now is testing</span> <span data-start="964" data-end="966.97">different browsers so every time you</span> <span data-start="966.97" data-end="968.47">make a change to the client in the order</span> <span data-start="968.47" data-end="972.01">server we need to see if I six works and</span> <span data-start="972.01" data-end="975.19">today to till today it's been largely a</span> <span data-start="975.19" data-end="977.62">manual process combined with really</span> <span data-start="977.62" data-end="980.2">simple unit testing and obviously unit</span> <span data-start="980.2" data-end="982.36">testing is not enough considering the</span> <span data-start="982.36" data-end="987.1">many quirks that browsers have so one</span> <span data-start="987.1" data-end="988.44">thing I'm going to do is set up</span> <span data-start="988.44" data-end="992.98">automatic cloud testing on selenium so</span> <span data-start="992.98" data-end="995.95">that we're going to be able to as soon</span> <span data-start="995.95" data-end="997.63">as we push to github we're going to be</span> <span data-start="997.63" data-end="998.98">able to test on all the browsers who</span> <span data-start="998.98" data-end="1003.63">want to support there's been also many</span> <span data-start="1003.63" data-end="1005.63">problems related to the flash fallback</span> <span data-start="1005.63" data-end="1009.45">that range from sometimes increasing the</span> <span data-start="1009.45" data-end="1011.97">latency to a really high memory</span> <span data-start="1011.97" data-end="1018">consumption to RIT slowness when HTTPS</span> <span data-start="1018" data-end="1022.44">and ssl are used and also the fact that</span> </p>
<p><span data-start="1022.44" data-end="1026.37">Sokka do without flash is around 8</span> <span data-start="1026.37" data-end="1029.46">kilobytes and with flash is like I know</span> <span data-start="1029.46" data-end="1032.49">like 200 kilobytes and that's a problem</span> <span data-start="1032.49" data-end="1037.02">so we're going to be working on our own</span> <span data-start="1037.02" data-end="1039.81">flash fall back and we're probably not</span> <span data-start="1039.81" data-end="1041.61">going to be supporting as a cell with it</span> <span data-start="1041.61" data-end="1044.13">because that's what adds the most bloat</span> <span data-start="1044.13" data-end="1048.57">to to the Flash movie is the fact that</span> <span data-start="1048.57" data-end="1051.48">the ssl crypto libraries are not built</span> <span data-start="1051.48" data-end="1054.369">in into action script</span> <span data-start="1054.369" data-end="1057.08">there is also an upcoming WebSockets</span> <span data-start="1057.08" data-end="1060.349">back that browsers will be supporting</span> <span data-start="1060.349" data-end="1064.309">soon including Firefox 4 and as soon as</span> <span data-start="1064.309" data-end="1066.979">a major stable browser supports it we</span> <span data-start="1066.979" data-end="1072.049">want to support it and so that's it you</span> <span data-start="1072.049" data-end="1073.94">can check out the repo for the latest</span> <span data-start="1073.94" data-end="1078.619">code and if you have any questions so</span> <span data-start="1078.619" data-end="1081.08">you're asking if it should be connect al</span> <span data-start="1081.08" data-end="1083.919">or so yeah that's a great question and</span> <span data-start="1083.919" data-end="1088.219">so the session middleware which is one</span> <span data-start="1088.219" data-end="1089.269">of the things that we want to connect</span> <span data-start="1089.269" data-end="1092.719">with Sokka do is basically connect it's</span> <span data-start="1092.719" data-end="1096.71">not expressed so to that end we yeah and</span> <span data-start="1096.71" data-end="1099.109">there is a project already for that but</span> <span data-start="1099.109" data-end="1102.559">my other thing is the ability to create</span> <span data-start="1102.559" data-end="1105.229">to connect the templates to real-time</span> <span data-start="1105.229" data-end="1107.899">events and to that end we need to make</span> <span data-start="1107.899" data-end="1109.82">it express and there's also the fact</span> <span data-start="1109.82" data-end="1111.82">that not many people use connect without</span> <span data-start="1111.82" data-end="1115.009">express while leveraging the session</span> <span data-start="1115.009" data-end="1116.659">middleware you might want to use Kinect</span> <span data-start="1116.659" data-end="1118.58">if you're like just serving static files</span> <span data-start="1118.58" data-end="1122.719">or static pages like HTML and some</span> <span data-start="1122.719" data-end="1124.339">images you might just want to use</span> <span data-start="1124.339" data-end="1126.019">connect but when you're actually</span> <span data-start="1126.019" data-end="1128.389">leveraging the session middleware you're</span> <span data-start="1128.389" data-end="1132.769">probably using Express so I just went</span> <span data-start="1132.769" data-end="1136.609">with express today oh so he's asking</span> <span data-start="1136.609" data-end="1137.539">about how we're going to do</span> <span data-start="1137.539" data-end="1141.549">cross-browser cross-platform testing so</span> <span data-start="1141.549" data-end="1143.899">for a company we also have the problem</span> <span data-start="1143.899" data-end="1146.479">of supporting multiple browsers and we</span> <span data-start="1146.479" data-end="1148.429">want to have acceptance testing that</span> <span data-start="1148.429" data-end="1151.129">where that makes sure that things work</span> <span data-start="1151.129" data-end="1153.019">on WebKit which is the presser we</span> <span data-start="1153.019" data-end="1155.989">develop on but also Isaac's so we</span> <span data-start="1155.989" data-end="1159.159">created an adapter for node called soda</span> <span data-start="1159.159" data-end="1163.719">what soda does is implement selenium and</span> <span data-start="1163.719" data-end="1166.399">potentially if you want to use sauce</span> <span data-start="1166.399" data-end="1168.409">labs sauce labs is a starter that</span> <span data-start="1168.409" data-end="1171.169">provides a service for automating</span> <span data-start="1171.169" data-end="1173.539">testing with selenium on the cloud in</span> <span data-start="1173.539" data-end="1176.869">the cloud so instead of you setting up</span> <span data-start="1176.869" data-end="1178.999">your own cluster and you're like set of</span> <span data-start="1178.999" data-end="1183.649">computers running Windows and ie and all</span> <span data-start="1183.649" data-end="1185.96">the different variations of combinations</span> <span data-start="1185.96" data-end="1187.64">you can use sauce labs</span> <span data-start="1187.64" data-end="1190.16">and you pay per minute and it's also</span> <span data-start="1190.16" data-end="1193.13">free for linux and firefox so you can</span> <span data-start="1193.13" data-end="1194.93">get started doing acceptance testing</span> <span data-start="1194.93" data-end="1197.48">with that way and that's what we're</span> <span data-start="1197.48" data-end="1198.71">going to leverage so we're going to</span> <span data-start="1198.71" data-end="1202.13">write unit tests and we're also going to</span> <span data-start="1202.13" data-end="1204.77">connect to like a fixed socket i/o</span> <span data-start="1204.77" data-end="1206.54">server and we're going to just basically</span> <span data-start="1206.54" data-end="1209.35">produce output to the add page then</span> <span data-start="1209.35" data-end="1211.37">selenium will connect to that page and</span> <span data-start="1211.37" data-end="1213.89">check for a number of positives and</span> <span data-start="1213.89" data-end="1217.4">negatives and if it fails sauce labs</span> <span data-start="1217.4" data-end="1218.99">will give you a video of what happened</span> <span data-start="1218.99" data-end="1221.42">so you can know exactly like okay what</span> <span data-start="1221.42" data-end="1223.52">test failed or what's the output or</span> <span data-start="1223.52" data-end="1226.72">what's the JavaScript console saying</span> <span data-start="1226.72" data-end="1229.61">he's asking if it's been difficult to</span> <span data-start="1229.61" data-end="1233.96">keep up with the WebSockets back and the</span> <span data-start="1233.96" data-end="1236.75">answer is actually no because at first</span> <span data-start="1236.75" data-end="1241.37">we had up so in the very first node days</span> <span data-start="1241.37" data-end="1245.72">we there was no HTTP upgrade event so we</span> <span data-start="1245.72" data-end="1248.39">had to implement WebSocket as net server</span> <span data-start="1248.39" data-end="1251.63">so the HTTP parser and the HTTP note</span> <span data-start="1251.63" data-end="1253.64">implementation didn't give us the hooks</span> <span data-start="1253.64" data-end="1257">to have a WebSocket server without a</span> <span data-start="1257" data-end="1259.43">patch so initially saucony you had to</span> <span data-start="1259.43" data-end="1263.33">like patch node to have a WebSocket</span> <span data-start="1263.33" data-end="1265.09">server on top of the HTTP server</span> <span data-start="1265.09" data-end="1267.02">otherwise you would have to run it in a</span> <span data-start="1267.02" data-end="1269.75">different port so then we had to support</span> <span data-start="1269.75" data-end="1272.8">the initial spec which was draft 75 and</span> <span data-start="1272.8" data-end="1275.3">after that shortly after we had to</span> <span data-start="1275.3" data-end="1278.87">support draft draft 76 and since then</span> <span data-start="1278.87" data-end="1282.05">the spec hasn't changed at all now it's</span> <span data-start="1282.05" data-end="1283.43">going to change and it's going to change</span> <span data-start="1283.43" data-end="1286.88">in some pretty major ways but the</span> <span data-start="1286.88" data-end="1289.63">struggles with WebSocket have not been</span> <span data-start="1289.63" data-end="1292.55">mostly implementing this back it's been</span> <span data-start="1292.55" data-end="1293.9">for example the fact that they are</span> <span data-start="1293.9" data-end="1296.42">supposed to bypass proxies that's one of</span> <span data-start="1296.42" data-end="1297.86">the design goals of the WebSocket</span> <span data-start="1297.86" data-end="1300.56">protocol was what we need to make this</span> <span data-start="1300.56" data-end="1303.53">thing bypass proxies that are in on the</span> </p>
<p><span data-start="1303.53" data-end="1305.68">Internet today which is not the case so</span> <span data-start="1305.68" data-end="1308.93">WebSocket fails so socket i/o needed the</span> <span data-start="1308.93" data-end="1312.05">machinery to determine oh I couldn't</span> <span data-start="1312.05" data-end="1313.37">connect with WebSocket i'm going to try</span> <span data-start="1313.37" data-end="1316.04">something else so on that end it's been</span> <span data-start="1316.04" data-end="1317.84">a difficult decision to make WebSocket</span> <span data-start="1317.84" data-end="1321.26">the first choice because long polling</span> <span data-start="1321.26" data-end="1323.57">ends up being more reliable for most use</span> <span data-start="1323.57" data-end="1326.93">cases but hopefully that's going to</span> <span data-start="1326.93" data-end="1330.89">change now with a new spec and it and</span> <span data-start="1330.89" data-end="1332.54">that should be a definite one that</span> </p>
<p><span data-start="1332.54" data-end="1335.15">Firefox expressed interest in</span> <span data-start="1335.15" data-end="1337.52">implementing and so that's Chrome and</span> <span data-start="1337.52" data-end="1341.23">Safari and ie9 so I nine has the same</span> <span data-start="1341.23" data-end="1343.49">ambition to implement this aspect and</span> <span data-start="1343.49" data-end="1347.63">today they are doing it with silverlight</span> <span data-start="1347.63" data-end="1351.89">or through like labs plugins but</span> <span data-start="1351.89" data-end="1353.72">hopefully it's also going to be part of</span> <span data-start="1353.72" data-end="1365.06">by nine alright thank you so much yeah</span> <span data-start="1365.06" data-end="1367.1">I'm going to post the slides to Twitter</span> </p>
</section>