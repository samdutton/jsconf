<section>
<p><span data-start="1.08" data-end="8.429">[Music]</span> <span data-start="8.429" data-end="11.49">so hi my name is Ryan J Salva I am a</span> <span data-start="11.49" data-end="14.309">product manager on the visual studio</span> <span data-start="14.309" data-end="17.16">team I'm also a JavaScript developer of</span> <span data-start="17.16" data-end="20.64">about 15 years and a committer to the</span> <span data-start="20.64" data-end="23.31">Apache Cordova project today I'm gonna</span> <span data-start="23.31" data-end="25.859">take the next 30 minutes or so to talk</span> <span data-start="25.859" data-end="27.72">to you a little bit about performance</span> <span data-start="27.72" data-end="30.119">and a lot of the lessons that I talk</span> <span data-start="30.119" data-end="32.579">about today will apply to Cordova but</span> <span data-start="32.579" data-end="34.8">they apply equally well to the mobile</span> <span data-start="34.8" data-end="37.53">web and so really this is just gonna be</span> <span data-start="37.53" data-end="40.5">a a tour of a bunch of science that</span> <span data-start="40.5" data-end="42.239">we've conducted and I mean that like</span> <span data-start="42.239" data-end="43.98">science with a capital S really</span> <span data-start="43.98" data-end="46.35">important science to better understand</span> <span data-start="46.35" data-end="49.86">how exactly per Forks for mobile</span> <span data-start="49.86" data-end="51.3">applications when they're using web</span> <span data-start="51.3" data-end="54.149">technologies sound like a good time yeah</span> <span data-start="54.149" data-end="56.16">sounds like a good time awesome all</span> <span data-start="56.16" data-end="59.399">right sweet so hey if along this you</span> <span data-start="59.399" data-end="60.87">learn anything that you didn't know</span> <span data-start="60.87" data-end="63.18">before use the hash tag perf matters on</span> </p>
<p><span data-start="63.18" data-end="65.22">Twitter and share it with your friends</span> <span data-start="65.22" data-end="69">because science is everyone's awesome</span> <span data-start="69" data-end="72.21">thing to learn all right so like I said</span> <span data-start="72.21" data-end="73.92">before the lessons we learned today are</span> <span data-start="73.92" data-end="75.869">gonna apply equally well between hybrid</span> <span data-start="75.869" data-end="78.869">applications in mobile web and just a</span> <span data-start="78.869" data-end="80.31">kind of level set I want to make sure</span> <span data-start="80.31" data-end="81.78">that everyone understands when I talk</span> <span data-start="81.78" data-end="83.88">about hybrid applications what I'm</span> <span data-start="83.88" data-end="87.03">really talking about here so this is the</span> <span data-start="87.03" data-end="89.729">primary technology is Cordova most</span> <span data-start="89.729" data-end="91.32">people know what Cordova is or PhoneGap</span> <span data-start="91.32" data-end="96.15">yeah yeah yar okay good excellent so the</span> <span data-start="96.15" data-end="99.63">basic idea behind it is that Cordova its</span> <span data-start="99.63" data-end="102.03">core is a web application that sits</span> <span data-start="102.03" data-end="104.009">inside of a webview inside of a native</span> <span data-start="104.009" data-end="107.159">application and as a web application all</span> <span data-start="107.159" data-end="108.99">of the HTML the CSS and the JavaScript</span> <span data-start="108.99" data-end="113.009">are packaged locally but they kind of</span> <span data-start="113.009" data-end="115.95">talk back to native api's whether it be</span> <span data-start="115.95" data-end="118.29">the camera API or the address book or</span> <span data-start="118.29" data-end="120.24">the accelerometer through these</span> <span data-start="120.24" data-end="122.219">asynchronous calls that bridge the</span> <span data-start="122.219" data-end="124.89">webview and talk back to native code the</span> <span data-start="124.89" data-end="126.659">brilliant thing about this is that it</span> <span data-start="126.659" data-end="128.52">kind of gives you like a browser on</span> <span data-start="128.52" data-end="130.14">steroids you get access to all these</span> <span data-start="130.14" data-end="131.64">native api's that you wouldn't have</span> <span data-start="131.64" data-end="133.39">access to otherwise</span> <span data-start="133.39" data-end="135.07">and you get support for offline by</span> <span data-start="135.07" data-end="136.96">virtue of the fact that all of that HTML</span> </p>
<p><span data-start="136.96" data-end="138.85">CSS and JavaScript have been packaged</span> <span data-start="138.85" data-end="141.16">locally so that's the basic architecture</span> <span data-start="141.16" data-end="144.94">and we're gonna kind of use that to</span> <span data-start="144.94" data-end="147.52">explore like there's this perception</span> <span data-start="147.52" data-end="149.8">there's this general kind of ickiness</span> <span data-start="149.8" data-end="152.95">this feeling that web applications and</span> <span data-start="152.95" data-end="154.81">hybrid applications when compared to</span> <span data-start="154.81" data-end="157.84">native applications don't quite stand up</span> <span data-start="157.84" data-end="160.12">they don't really cut the butter as it</span> <span data-start="160.12" data-end="162.73">were and so in the next 30 minutes we're</span> <span data-start="162.73" data-end="164.49">gonna try and dispel some of those myths</span> <span data-start="164.49" data-end="170.56">using science all right to understand</span> <span data-start="170.56" data-end="172.239">performance you first need to understand</span> <span data-start="172.239" data-end="174.4">what it actually means to be fast and</span> <span data-start="174.4" data-end="176.32">responsive so here's what I want you</span> <span data-start="176.32" data-end="177.64">guys to do here's how I want you to</span> <span data-start="177.64" data-end="179.14">think about it I got a nice little graph</span> <span data-start="179.14" data-end="180.94">here and there's lots of different</span> <span data-start="180.94" data-end="182.8">flavors and versions of this graph that</span> <span data-start="182.8" data-end="184.42">you might have seen online I think I</span> <span data-start="184.42" data-end="186.31">stole this one from the Nielsen Norman</span> <span data-start="186.31" data-end="188.5">group and they probably created this</span> <span data-start="188.5" data-end="191.14">back in 1995 or something like that</span> <span data-start="191.14" data-end="193.54">but I've actually expanded it to put</span> <span data-start="193.54" data-end="195.64">some real millisecond measurements on</span> <span data-start="195.64" data-end="197.95">this so in the far left hand side that's</span> <span data-start="197.95" data-end="200.049">17 milliseconds everything that's under</span> <span data-start="200.049" data-end="203.14">fluid that's really not about user</span> <span data-start="203.14" data-end="205">interaction with your app but that's</span> <span data-start="205" data-end="206.98">about the way that your app moves</span> <span data-start="206.98" data-end="209.38">that's about animations being fluid</span> <span data-start="209.38" data-end="212.59">transitions kind of silky smooth flowing</span> <span data-start="212.59" data-end="215.2">through right and if you do the math</span> <span data-start="215.2" data-end="218.14">that 17 milliseconds actually calculates</span> <span data-start="218.14" data-end="220.75">out to be 60 frames per second that's</span> <span data-start="220.75" data-end="222.58">what that's about getting that magical</span> <span data-start="222.58" data-end="224.98">60 frames per second just to the right</span> <span data-start="224.98" data-end="227.62">of that instantaneous okay this is when</span> <span data-start="227.62" data-end="229.51">you're actually got your finger on the</span> <span data-start="229.51" data-end="231.489">mobile device you're dragging it around</span> <span data-start="231.489" data-end="234.04">and the object actually sticks to your</span> <span data-start="234.04" data-end="235.69">finger so this is really important to</span> <span data-start="235.69" data-end="237.549">make sure that like you actually feel</span> <span data-start="237.549" data-end="239.08">like you're in control of the</span> <span data-start="239.08" data-end="242.019">application beyond that actions which</span> <span data-start="242.019" data-end="245.17">are fast these are maybe like navigation</span> <span data-start="245.17" data-end="248.32">events going from one particular page to</span> <span data-start="248.32" data-end="250.93">the next loading a new view beyond that</span> <span data-start="250.93" data-end="253.959">everything to the right buddy if if</span> <span data-start="253.959" data-end="255.549">you've got something that takes that</span> <span data-start="255.549" data-end="257.38">long to react you better be throwing up</span> <span data-start="257.38" data-end="259.63">a spinner or something like that to let</span> <span data-start="259.63" data-end="262.03">people know that work is being done in</span> <span data-start="262.03" data-end="265.36">the background for this talk for the</span> <span data-start="265.36" data-end="267.13">next 20 30 minutes or so what</span> <span data-start="267.13" data-end="268.99">we care about is everything on that</span> <span data-start="268.99" data-end="271.48">right-hand side that far right-hand side</span> <span data-start="271.48" data-end="273.25">what we care about actually for you guys</span> <span data-start="273.25" data-end="275.64">wait that's left that's your left okay</span> <span data-start="275.64" data-end="278.44">our left-hand side from your left hand</span> <span data-start="278.44" data-end="280.63">side we care about fluid and</span> <span data-start="280.63" data-end="283.45">instantaneous because frankly everything</span> <span data-start="283.45" data-end="285.7">on the right hand side of that there's</span> <span data-start="285.7" data-end="290.98">no question that JavaScript CSS HTML are</span> <span data-start="290.98" data-end="292.63">capable of delivering that kind of</span> <span data-start="292.63" data-end="297.37">performance right so what is the</span> <span data-start="297.37" data-end="300.61">methodology behind our science so we</span> <span data-start="300.61" data-end="303.55">took a look at a bunch of different</span> <span data-start="303.55" data-end="306.1">applications and we and we kind of</span> <span data-start="306.1" data-end="307.96">looked at different approaches that</span> <span data-start="307.96" data-end="309.97">developers took to building out those</span> <span data-start="309.97" data-end="312.82">applications and we also took a look at</span> <span data-start="312.82" data-end="315.37">some of the major makers of the popular</span> </p>
<p><span data-start="315.37" data-end="318.16">UX frameworks that are out there so I'm</span> <span data-start="318.16" data-end="320.47">thinking of people here like ionic or</span> <span data-start="320.47" data-end="323.02">onsen or kendo and not the MV star</span> <span data-start="323.02" data-end="324.79">frameworks not the angular's of the</span> <span data-start="324.79" data-end="326.2">world of a reacts of the worlds but the</span> <span data-start="326.2" data-end="328.03">people that are making UX controls</span> <span data-start="328.03" data-end="330.61">because those are the things that end up</span> <span data-start="330.61" data-end="333.01">driving user interaction and we said you</span> <span data-start="333.01" data-end="334.51">know what is there any difference</span> <span data-start="334.51" data-end="336.58">between the way that average Joe</span> <span data-start="336.58" data-end="338.38">developer is building things today</span> <span data-start="338.38" data-end="340.87">versus the way that these people who are</span> <span data-start="340.87" data-end="343.18">creating the best-of-breed UX frameworks</span> <span data-start="343.18" data-end="344.47">are actually thinking about performance</span> <span data-start="344.47" data-end="346.99">and where there are differences between</span> <span data-start="346.99" data-end="349.18">the two what are the differences that</span> <span data-start="349.18" data-end="351.91">are contributing to poor performance</span> <span data-start="351.91" data-end="353.47">does that make sense</span> <span data-start="353.47" data-end="357.97">yeah and so from that we identified six</span> <span data-start="357.97" data-end="361.63">issues by the way the all of the tests</span> <span data-start="361.63" data-end="363.13">that we performed here because you need</span> <span data-start="363.13" data-end="365.8">to control four devices here we used</span> <span data-start="365.8" data-end="369.58">three kind of you know recent but not</span> <span data-start="369.58" data-end="372.07">too recent devices because we wanted to</span> <span data-start="372.07" data-end="374.11">find devices that were out there being</span> <span data-start="374.11" data-end="377.08">used by our mothers and our fathers and</span> <span data-start="377.08" data-end="378.79">our sisters and people that are not just</span> <span data-start="378.79" data-end="380.65">spending all of their time in the tech</span> <span data-start="380.65" data-end="382.72">world investing in the next greatest</span> <span data-start="382.72" data-end="385.03">thing right so they're slightly older</span> <span data-start="385.03" data-end="386.73">devices</span> <span data-start="386.73" data-end="391.66">so here the six different areas where we</span> <span data-start="391.66" data-end="393.58">found that there were discrepancies</span> <span data-start="393.58" data-end="395.38">between the way that the common</span> <span data-start="395.38" data-end="397.18">developer might go about building an</span> <span data-start="397.18" data-end="400.24">application and the kind of the best of</span> <span data-start="400.24" data-end="400.689">the back</span> <span data-start="400.689" data-end="404.949">so UX developers so webview tax document</span> <span data-start="404.949" data-end="407.379">object model images animation garbage</span> <span data-start="407.379" data-end="409.509">collection and UI controls these are the</span> <span data-start="409.509" data-end="411.209">areas where we found differences now</span> <span data-start="411.209" data-end="416.319">because I'm a sneaky guy I'm only going</span> <span data-start="416.319" data-end="417.789">to tell you about four of those today</span> <span data-start="417.789" data-end="421.419">really that's my way of tempting all of</span> <span data-start="421.419" data-end="423.039">you to come up and talk to me afterwards</span> <span data-start="423.039" data-end="425.169">so that you can find out the hidden</span> <span data-start="425.169" data-end="427.389">secrets behind animation and UI controls</span> <span data-start="427.389" data-end="429.699">we'll start by talking about these four</span> <span data-start="429.699" data-end="434.619">though sound good all right so the web</span> <span data-start="434.619" data-end="437.739">view tax now this first part this is</span> <span data-start="437.739" data-end="439.899">really specific to Cordova this is the</span> <span data-start="439.899" data-end="442.599">one piece of the talk that is only going</span> <span data-start="442.599" data-end="445.329">to apply to hybrid applications now as I</span> <span data-start="445.329" data-end="448.329">said before Cordova application has the</span> <span data-start="448.329" data-end="450.669">web application running inside of a</span> <span data-start="450.669" data-end="452.769">webview that's hosted inside of a native</span> <span data-start="452.769" data-end="456.219">control and because it kind of operates</span> <span data-start="456.219" data-end="458.319">inside of that webview there's a tax</span> <span data-start="458.319" data-end="461.709">that you got to pay and so here's what</span> <span data-start="461.709" data-end="464.619">we did first we said you know what let's</span> <span data-start="464.619" data-end="467.289">take a baseline let's measure the memory</span> <span data-start="467.289" data-end="469.539">footprint of a native application and</span> <span data-start="469.539" data-end="472.629">the native Java for Android objective-c</span> <span data-start="472.629" data-end="475.659">for iOS c-sharp for Windows and</span> </p>
<p><span data-start="475.659" data-end="477.909">Silverlight for Windows Phone right we</span> <span data-start="477.909" data-end="480.159">said okay if you were just to create a</span> <span data-start="480.159" data-end="482.679">hello world using the native language</span> <span data-start="482.679" data-end="484.449">what would the memory footprint being</span> <span data-start="484.449" data-end="488.769">and we said you know what I bet that</span> <span data-start="488.769" data-end="491.349">since a webview is essentially just a</span> <span data-start="491.349" data-end="494.529">browser that the memory footprint of a</span> <span data-start="494.529" data-end="496.899">Cordova app would probably be the native</span> <span data-start="496.899" data-end="499.209">application plus the memory footprint of</span> <span data-start="499.209" data-end="501.339">the browser and that would probably give</span> <span data-start="501.339" data-end="503.05">you the memory footprint of a Cordova</span> <span data-start="503.05" data-end="504.249">app and that could kind of give us an</span> <span data-start="504.249" data-end="505.919">idea of what the taxes that we pay there</span> <span data-start="505.919" data-end="508.869">so we did a measurement of a browser on</span> <span data-start="508.869" data-end="511.059">each of the devices so that's the memory</span> <span data-start="511.059" data-end="513.25">footprint of about blank in a web</span> <span data-start="513.25" data-end="515.74">browser on an Android phone and iOS</span> <span data-start="515.74" data-end="518.889">phone and Windows Device then we</span> <span data-start="518.889" data-end="521.43">measured the Cordova application now</span> <span data-start="521.43" data-end="523.779">there's some interesting things going on</span> <span data-start="523.779" data-end="527.74">here clearly androids got something</span> <span data-start="527.74" data-end="529.839">going on here there's like a World Trade</span> </p>
<p><span data-start="529.839" data-end="532.18">Center tower going up there</span> <span data-start="532.18" data-end="534.7">says the Cordova application has got</span> <span data-start="534.7" data-end="537.67">giant memory consumption problems on the</span> <span data-start="537.67" data-end="538.81">iOS side</span> <span data-start="538.81" data-end="541.45">well a plus B does not equal C they're</span> <span data-start="541.45" data-end="543.61">actually the memory footprint is about</span> <span data-start="543.61" data-end="546.67">the same as the browser Windows Store</span> <span data-start="546.67" data-end="548.83">glory be I don't even know how this is</span> <span data-start="548.83" data-end="551.95">possible but the memory footprint is</span> <span data-start="551.95" data-end="554.41">lower than the native app and lower than</span> <span data-start="554.41" data-end="556.75">the browser and then Windows Phone okay</span> <span data-start="556.75" data-end="559.75">it's kind of about the same now all</span> <span data-start="559.75" data-end="562.48">right so I want you all to remember that</span> <span data-start="562.48" data-end="565.48">giant Tower that's there next to Android</span> <span data-start="565.48" data-end="567.01">that's gonna come up later in some</span> <span data-start="567.01" data-end="569.62">interesting ways but just remember big</span> <span data-start="569.62" data-end="573.37">memory footprint on Android so here's</span> <span data-start="573.37" data-end="575.26">the thing it's lovely to talk about</span> <span data-start="575.26" data-end="576.37">memory but we're here to talk about</span> <span data-start="576.37" data-end="579.22">performance today and memory is not</span> <span data-start="579.22" data-end="582.07">something you can see where you can see</span> <span data-start="582.07" data-end="584.32">it has an effect is on startup time so</span> <span data-start="584.32" data-end="587.77">here's what we did took a slow motion</span> <span data-start="587.77" data-end="589.69">camera in this case I actually just used</span> <span data-start="589.69" data-end="591.79">my iPhone 6 it has a nice little slow</span> <span data-start="591.79" data-end="595.209">motion camera in it and filmed actually</span> <span data-start="595.209" data-end="598.27">starting up an application so hopefully</span> <span data-start="598.27" data-end="599.709">you can see this on the left-hand side</span> <span data-start="599.709" data-end="602.11">you can see us using a nice little touch</span> <span data-start="602.11" data-end="604.24">pin to click on the hello world app on</span> <span data-start="604.24" data-end="606.64">the right-hand side you can start to see</span> <span data-start="606.64" data-end="608.44">a little bit of ghosting where the</span> <span data-start="608.44" data-end="610.63">applications starting to launch we</span> <span data-start="610.63" data-end="612.459">measured the number of frames in between</span> <span data-start="612.459" data-end="615.4">the touch moment and the launch moment</span> <span data-start="615.4" data-end="618.52">because it was filmed at 240 frames per</span> <span data-start="618.52" data-end="620.17">second that meant that each frame</span> <span data-start="620.17" data-end="622.209">accounted for 4 milliseconds and we</span> <span data-start="622.209" data-end="623.83">could figure out how long it took to</span> <span data-start="623.83" data-end="629.64">actually launch the application ah now</span> <span data-start="629.64" data-end="631.3">remember how I asked you to remember</span> <span data-start="631.3" data-end="633.79">that giant kind of increase on the</span> </p>
<p><span data-start="633.79" data-end="634.87">Android side of things</span> <span data-start="634.87" data-end="639.43">look how tall or how long it took for</span> <span data-start="639.43" data-end="641.98">those Android Cordova apps to start up</span> <span data-start="641.98" data-end="645.1">so the memory and the startup time have</span> <span data-start="645.1" data-end="648.339">a strong correlation here on the iOS</span> <span data-start="648.339" data-end="653.11">side ok this tall pillar right here</span> <span data-start="653.11" data-end="656.11">that's the native app starting up I want</span> <span data-start="656.11" data-end="657.49">to put a little caveat next to that</span> <span data-start="657.49" data-end="659.2">that's why I put a little asterisk up at</span> <span data-start="659.2" data-end="661.029">the top we actually just used the</span> <span data-start="661.029" data-end="663.31">default hello world iOS app that came</span> <span data-start="663.31" data-end="665.84">out of Xcode the way that that app is</span> <span data-start="665.84" data-end="667.88">figured out of the box it has a 500</span> <span data-start="667.88" data-end="670.79">millisecond delay that is configurable</span> <span data-start="670.79" data-end="673.04">and so I believe that that number there</span> <span data-start="673.04" data-end="674.39">is actually a bit of a false</span> <span data-start="674.39" data-end="676.97">representation of what the actual native</span> <span data-start="676.97" data-end="679.91">implementation would would kind of cause</span> <span data-start="679.91" data-end="682.01">if we had adjusted that configuration</span> <span data-start="682.01" data-end="685.88">setting iOS is iOS warm is pretty good</span> <span data-start="685.88" data-end="687.65">when does phone cold is pretty good in</span> </p>
<p><span data-start="687.65" data-end="689.6">Windows Phone warm is pretty good these</span> <span data-start="689.6" data-end="692.69">cold versus warm so let me kind of give</span> <span data-start="692.69" data-end="693.68">a little bit of insight into the</span> <span data-start="693.68" data-end="697.34">methodology there cold means that we</span> <span data-start="697.34" data-end="699.74">shut the phone completely down then</span> <span data-start="699.74" data-end="701.63">started it up and then immediately</span> <span data-start="701.63" data-end="705.5">started the application warm means that</span> <span data-start="705.5" data-end="708.53">we shut the phone down turn it back on</span> <span data-start="708.53" data-end="711.23">started the application shut the</span> <span data-start="711.23" data-end="713.93">application down and then open the</span> <span data-start="713.93" data-end="716.12">application up again because each of the</span> <span data-start="716.12" data-end="719.18">devices makes some some sort of memory</span> <span data-start="719.18" data-end="721.64">optimizations for the cold horses warm</span> <span data-start="721.64" data-end="724.01">scenario we wanted to make sure that we</span> <span data-start="724.01" data-end="725.69">controlled for that depending upon the</span> <span data-start="725.69" data-end="730.61">actual usage so big takeaway here memory</span> <span data-start="730.61" data-end="733.97">consumption high correlation with slower</span> <span data-start="733.97" data-end="736.22">performance we're gonna see that theme</span> <span data-start="736.22" data-end="738.38">repeat again and again over the course</span> <span data-start="738.38" data-end="742.43">of the next 20 minutes so takeaway</span> </p>
<p><span data-start="742.43" data-end="744.71">Android tends to be slower and it tends</span> <span data-start="744.71" data-end="747.14">to be slower because we think because of</span> <span data-start="747.14" data-end="750.83">memory consumption all right there's one</span> <span data-start="750.83" data-end="753.29">more place that in a Cordova application</span> <span data-start="753.29" data-end="756.02">you're actually paying a tax and that's</span> <span data-start="756.02" data-end="759.08">in that xhr request that a synchronous</span> <span data-start="759.08" data-end="760.82">call that needs to go from the webview</span> <span data-start="760.82" data-end="764.06">to the native code and back again so</span> <span data-start="764.06" data-end="766.96">imagine for a moment that you are</span> <span data-start="766.96" data-end="771.41">sending a request for geolocation data</span> <span data-start="771.41" data-end="774.83">or for accelerometer data your web your</span> </p>
<p><span data-start="774.83" data-end="777.29">JavaScript needs to make the request at</span> <span data-start="777.29" data-end="779.51">asynchronous a synchronously crosses the</span> <span data-start="779.51" data-end="782.09">webview talks to the native code then</span> <span data-start="782.09" data-end="783.59">the native code needs to send that</span> <span data-start="783.59" data-end="785.39">response back with an XY and z</span> <span data-start="785.39" data-end="788.92">coordinate right so here's what we did</span> <span data-start="788.92" data-end="793.31">we created a cordova plugin whose only</span> <span data-start="793.31" data-end="797.06">job in this big wide world was just to</span> <span data-start="797.06" data-end="798.81">receive data and to</span> <span data-start="798.81" data-end="800.88">that data back it didn't perform any</span> <span data-start="800.88" data-end="803.19">processing on the data whatsoever it</span> <span data-start="803.19" data-end="807.18">just was there to measure the impact on</span> <span data-start="807.18" data-end="809.88">data size as it crossed over that web</span> <span data-start="809.88" data-end="813.18">view bridge and what we see here is a</span> <span data-start="813.18" data-end="815.67">nice linear line look at this</span> <span data-start="815.67" data-end="818.73">so for iOS Android and Windows Phone</span> <span data-start="818.73" data-end="822.06">using C sharp as the data increases</span> <span data-start="822.06" data-end="825.51">along the x-axis the time also increases</span> <span data-start="825.51" data-end="827.69">along the y-axis in a linear fashion</span> <span data-start="827.69" data-end="831.51">note however crossing the very bottom of</span> <span data-start="831.51" data-end="833.19">that line there's a kind of a yellow</span> <span data-start="833.19" data-end="835.65">line there that's windows phone using</span> <span data-start="835.65" data-end="838.05">javascript because windows devices are</span> <span data-start="838.05" data-end="841.5">able to run JavaScript as a native</span> <span data-start="841.5" data-end="843.68">language like you don't there's no</span> <span data-start="843.68" data-end="845.52">compilation that happens there</span> <span data-start="845.52" data-end="848.79">there's no webview to cross and so the</span> <span data-start="848.79" data-end="851.13">time to kind of interact with the</span> <span data-start="851.13" data-end="854.339">plug-in is zero no matter how large the</span> <span data-start="854.339" data-end="856.92">data set gets what I want to call your</span> <span data-start="856.92" data-end="859.76">attention to here though is that this</span> <span data-start="859.76" data-end="863.76">500k actually this is more than 500 K</span> <span data-start="863.76" data-end="867.86">this is 5,000 K in order for you to</span> <span data-start="867.86" data-end="870.96">transfer that over the webview is a</span> <span data-start="870.96" data-end="872.73">period of less than was that 300</span> <span data-start="872.73" data-end="874.98">milliseconds or so it's a very very</span> <span data-start="874.98" data-end="877.53">small amount of time and so even if you</span> <span data-start="877.53" data-end="879.36">were transferring a large amount of data</span> <span data-start="879.36" data-end="882.68">for example an image taken from a camera</span> <span data-start="882.68" data-end="886.08">it's going to happen in a practically</span> <span data-start="886.08" data-end="888.51">non noticeable period of time if you're</span> <span data-start="888.51" data-end="891.15">transferring smaller bits of data for</span> <span data-start="891.15" data-end="893.4">example accelerometer or geolocation</span> <span data-start="893.4" data-end="897">data it's going to be 2 3 4 milliseconds</span> <span data-start="897" data-end="900.36">very very tiny so what that tells us</span> <span data-start="900.36" data-end="902.67">that is that javascript in terms of</span> <span data-start="902.67" data-end="905.28">being able to deliver high performance</span> <span data-start="905.28" data-end="908.31">is able to really deliver right you</span> <span data-start="908.31" data-end="910.94">don't there's no waiting around for it</span> <span data-start="910.94" data-end="914.31">ok that's it for the Cordova specific</span> <span data-start="914.31" data-end="916.62">stuff now let's actually get into the</span> <span data-start="916.62" data-end="918.209">kind of the stuff that's applicable to</span> <span data-start="918.209" data-end="921.87">both Cordova and to mobile web so I</span> <span data-start="921.87" data-end="923.279">don't need to tell you guys too much</span> <span data-start="923.279" data-end="926.22">about what the DOM is you all know let's</span> <span data-start="926.22" data-end="929.06">see a dumb or rather an example here and</span> <span data-start="929.06" data-end="931.5">a bit about how this is going to</span> <span data-start="931.5" data-end="933.36">just to make sure that we had enough</span> <span data-start="933.36" data-end="935.4">time to show all the experiments what I</span> <span data-start="935.4" data-end="937.62">did is I did a screen recording of me</span> <span data-start="937.62" data-end="939.93">conducting these experiments when I</span> <span data-start="939.93" data-end="941.91">actually conduct them in the lab I'm</span> <span data-start="941.91" data-end="944.28">performing these experiments thousands</span> <span data-start="944.28" data-end="946.95">and thousands and thousands of times to</span> <span data-start="946.95" data-end="949.29">make sure that we get a good median and</span> <span data-start="949.29" data-end="951.45">a good baseline for each of them each</span> <span data-start="951.45" data-end="953.58">one of these is exemplary of those</span> <span data-start="953.58" data-end="959.43">thousands of runs ok so in this one I'm</span> <span data-start="959.43" data-end="961.83">going to conduct an experiment where I'm</span> <span data-start="961.83" data-end="965.01">performing Dom manipulation first using</span> <span data-start="965.01" data-end="968.01">a simple DOM and then using a complex</span> <span data-start="968.01" data-end="971.13">tone and what I mean by that a simple</span> </p>
<p><span data-start="971.13" data-end="975.06">Dom has fewer elements and no nesting</span> <span data-start="975.06" data-end="978.33">the complex Dom has very deep nesting</span> <span data-start="978.33" data-end="981">hundreds of nodes deep and multiple</span> <span data-start="981" data-end="983.94">elements for this I'm actually running</span> <span data-start="983.94" data-end="986.73">them on a nexus 9 that Nexus 9 this is</span> <span data-start="986.73" data-end="988.2">the case with all the experiments that</span> <span data-start="988.2" data-end="991.14">Nexus 9 is just being screencast to my</span> <span data-start="991.14" data-end="994.26">to my desktop via a fun little</span> <span data-start="994.26" data-end="997.41">application called mobizen all of the</span> <span data-start="997.41" data-end="999.06">experiments I'm going to show using</span> </p>
<p><span data-start="999.06" data-end="1002.18">Android but the results tend to be</span> <span data-start="1002.18" data-end="1011.33">similar for iOS and Windows okay all</span> <span data-start="1011.33" data-end="1013.61">right for this I'm just gonna bring up</span> <span data-start="1013.61" data-end="1015.65">the chrome dev tools and the first one</span> <span data-start="1015.65" data-end="1016.43">that I'm gonna do is I'm going to</span> <span data-start="1016.43" data-end="1018.23">trigger manipulations of the simple Dom</span> <span data-start="1018.23" data-end="1020.24">and you can see here I'm just outputting</span> <span data-start="1020.24" data-end="1021.8">to the console the amount of time</span> <span data-start="1021.8" data-end="1023.66">required to perform each one of the</span> <span data-start="1023.66" data-end="1025.459">manipulations I've moved on to the</span> <span data-start="1025.459" data-end="1028.64">complex Dom using app in child then</span> <span data-start="1028.64" data-end="1031.22">complex Dom modifications using inner</span> </p>
<p><span data-start="1031.22" data-end="1034.67">HTML and then finally complex Dom</span> <span data-start="1034.67" data-end="1037.189">modifications using document fragment</span> <span data-start="1037.189" data-end="1038.839">right so everyone pretty much knows</span> <span data-start="1038.839" data-end="1041.93">those methods appendchild enter HTML</span> <span data-start="1041.93" data-end="1043.91">what I want to call your attention to is</span> <span data-start="1043.91" data-end="1046.13">the amount of time that it required to</span> <span data-start="1046.13" data-end="1048.74">perform a simple Dom manipulation versus</span> <span data-start="1048.74" data-end="1051.26">a complex Dom manipulation that's point</span> <span data-start="1051.26" data-end="1053.96">zero two six milliseconds compared to</span> <span data-start="1053.96" data-end="1057.38">point zero five four milliseconds now I</span> <span data-start="1057.38" data-end="1060.02">know I know I know</span> <span data-start="1060.02" data-end="1062.48">point zero two six milliseconds is just</span> <span data-start="1062.48" data-end="1063.83">not that much time</span> <span data-start="1063.83" data-end="1068.11">right it's it's nanoseconds right but</span> <span data-start="1068.11" data-end="1071.72">those will add up over time as your Dom</span> <span data-start="1071.72" data-end="1073.46">gets more and more complex and we're</span> <span data-start="1073.46" data-end="1075.26">actually gonna see that happen here in</span> <span data-start="1075.26" data-end="1079.909">just a minute so now we know surprise I</span> <span data-start="1079.909" data-end="1081.529">mean like this is almost common sense</span> <span data-start="1081.529" data-end="1083.99">simple Dom manipulations require less</span> <span data-start="1083.99" data-end="1086.96">time time than complex ones but that can</span> <span data-start="1086.96" data-end="1090.35">lead to some interesting choices about</span> <span data-start="1090.35" data-end="1095.09">how you write your code now like this is</span> <span data-start="1095.09" data-end="1102.59">all most unintelligent them whatever but</span> <span data-start="1102.59" data-end="1104.539">you're gonna make some different</span> <span data-start="1104.539" data-end="1107.059">decisions when you optimize for</span> <span data-start="1107.059" data-end="1110.029">performance versus optimizing for code</span> <span data-start="1110.029" data-end="1112.58">maintainability or code legibility in</span> <span data-start="1112.58" data-end="1115.46">this particular case I've reduced the</span> <span data-start="1115.46" data-end="1119.6">number of elements by 30% and by</span> <span data-start="1119.6" data-end="1121.46">reducing the number of elements as that</span> <span data-start="1121.46" data-end="1124.279">multiplies out over the broad scope of</span> <span data-start="1124.279" data-end="1126.95">an application that conservation of</span> <span data-start="1126.95" data-end="1128.57">elements is going to help me</span> <span data-start="1128.57" data-end="1130.519">tremendously so in this case it is</span> <span data-start="1130.519" data-end="1134.23">functionally equivalent but 30% fewer</span> <span data-start="1134.23" data-end="1139.61">actual Dom elements takeaway reduce your</span> <span data-start="1139.61" data-end="1143.929">element count all right so let's talk</span> <span data-start="1143.929" data-end="1146.659">about another little idiosyncrasy of Dom</span> <span data-start="1146.659" data-end="1148.669">manipulation and many of you may be</span> <span data-start="1148.669" data-end="1150.799">familiar with this kind of technique</span> <span data-start="1150.799" data-end="1152.69">before layout thrashing is basically</span> <span data-start="1152.69" data-end="1157.25">when you set a CSS property at the same</span> <span data-start="1157.25" data-end="1159.2">time as on the opposite side you're</span> <span data-start="1159.2" data-end="1162.559">reading the CSS property so let's see</span> <span data-start="1162.559" data-end="1165.5">how this actually works here right so I</span> <span data-start="1165.5" data-end="1168.169">got another video and in this particular</span> <span data-start="1168.169" data-end="1170.12">one you'll see that on the left hand</span> <span data-start="1170.12" data-end="1173.51">side I am setting my style to on the</span> <span data-start="1173.51" data-end="1175.22">right-hand side of the equal sign and</span> <span data-start="1175.22" data-end="1177.62">read a command so I'm just looping</span> <span data-start="1177.62" data-end="1179.059">through again and again and again</span> <span data-start="1179.059" data-end="1182.539">setting to a read in the second case and</span> <span data-start="1182.539" data-end="1185.57">this one I'm looping through I'm reading</span> <span data-start="1185.57" data-end="1187.61">all of the values first and then I have</span> <span data-start="1187.61" data-end="1190.94">a separate loop to set right now that</span> <span data-start="1190.94" data-end="1192.86">seems like a relatively small change and</span> <span data-start="1192.86" data-end="1194.51">again from a legibility or code</span> <span data-start="1194.51" data-end="1196.519">maintainability perspective it all</span> <span data-start="1196.519" data-end="1198.859">seems like the first is better so what</span> <span data-start="1198.859" data-end="1201.559">i'm doing here is first i'm going to</span> <span data-start="1201.559" data-end="1203.779">perform an action where it lets you know</span> <span data-start="1203.779" data-end="1206.989">that one i am using the thrashing so i'm</span> <span data-start="1206.989" data-end="1210.529">actually the very first one I read to my</span> <span data-start="1210.529" data-end="1212.629">set and in the second one I do the two</span> <span data-start="1212.629" data-end="1215.33">four loops now look at the comparison</span> <span data-start="1215.33" data-end="1218.629">here with thrashing that took nearly</span> <span data-start="1218.629" data-end="1221.69">four seconds without thrashing it took</span> <span data-start="1221.69" data-end="1224.809">only 56 milliseconds right that's a</span> <span data-start="1224.809" data-end="1227.659">eight fold improvement something like</span> <span data-start="1227.659" data-end="1230.539">that just by changing the order by which</span> <span data-start="1230.539" data-end="1237.589">we set and read so real quick here just</span> <span data-start="1237.589" data-end="1241.009">to reinforce it bad don't read it and</span> <span data-start="1241.009" data-end="1246.079">set it in the same line good read it</span> <span data-start="1246.079" data-end="1251.659">first set it later batch your layout</span> <span data-start="1251.659" data-end="1255.409">operations all the read at once all the</span> <span data-start="1255.409" data-end="1259.729">set at once okay let's talk about fast</span> <span data-start="1259.729" data-end="1262.219">list scrolling so this is essentially</span> <span data-start="1262.219" data-end="1264.649">when you've got thousands of elements on</span> <span data-start="1264.649" data-end="1266.989">a page and you need to be able to scroll</span> <span data-start="1266.989" data-end="1268.489">through them quickly in an infinite</span> <span data-start="1268.489" data-end="1271.489">scroll think here of something like I</span> <span data-start="1271.489" data-end="1273.349">don't know Facebook right where you're</span> <span data-start="1273.349" data-end="1274.82">just kind of scrolling forever and ever</span> <span data-start="1274.82" data-end="1276.44">and ever or Twitter or whatever your</span> <span data-start="1276.44" data-end="1279.799">favorite social media network is so in</span> <span data-start="1279.799" data-end="1283.489">this particular one in the first one I</span> <span data-start="1283.489" data-end="1285.649">am going to use just those I think it's</span> </p>
<p><span data-start="1285.649" data-end="1287.359">I think actually is a thousand elements</span> <span data-start="1287.359" data-end="1289.159">and I'm just gonna scroll through them</span> <span data-start="1289.159" data-end="1291.049">without any kind of optimizations</span> <span data-start="1291.049" data-end="1293.389">whatsoever it's just Dom elements on the</span> <span data-start="1293.389" data-end="1296.659">page iterating down in the second case</span> <span data-start="1296.659" data-end="1298.839">I'm going to use virtualization</span> <span data-start="1298.839" data-end="1300.799">virtualization is a technique where we</span> <span data-start="1300.799" data-end="1303.739">essentially simplify the Dom by removing</span> <span data-start="1303.739" data-end="1307.07">elements that are before and after the</span> <span data-start="1307.07" data-end="1309.529">visible screen so that there are less</span> <span data-start="1309.529" data-end="1311.839">elements on the page and remember back</span> <span data-start="1311.839" data-end="1314.389">before we had our lesson about when</span> <span data-start="1314.389" data-end="1315.889">there were fewer elements on the page</span> <span data-start="1315.889" data-end="1318.739">when we have a simple Dom it's the the</span> <span data-start="1318.739" data-end="1320.749">the actual browser is faster when we</span> <span data-start="1320.749" data-end="1322.94">have a complex Dom the browser tends to</span> <span data-start="1322.94" data-end="1325.69">be slower this is that same lesson</span> <span data-start="1325.69" data-end="1327.829">multiplied out in a way that you can</span> <span data-start="1327.829" data-end="1329.659">actually see it in a way that the user</span> <span data-start="1329.659" data-end="1330.26">would</span> <span data-start="1330.26" data-end="1332.929">so here we are we're actually launching</span> <span data-start="1332.929" data-end="1336.23">it up the in this particular case I just</span> <span data-start="1336.23" data-end="1338.179">got a little image of some fruit and</span> <span data-start="1338.179" data-end="1340.37">you'll see I'm kinda through here it</span> <span data-start="1340.37" data-end="1341.99">almost looks like the screen is</span> <span data-start="1341.99" data-end="1343.78">disappearing it's just going blank</span> <span data-start="1343.78" data-end="1346.88">that's not like a quirk of the video</span> <span data-start="1346.88" data-end="1349.34">that's because the elements the the</span> <span data-start="1349.34" data-end="1351.38">browser itself isn't able to keep up</span> <span data-start="1351.38" data-end="1353.299">with the paint and so they just</span> <span data-start="1353.299" data-end="1355.549">disappear as I quickly quickly quickly</span> <span data-start="1355.549" data-end="1357.47">move back and forth in it right and</span> <span data-start="1357.47" data-end="1359.69">sometimes they disappear for seconds at</span> <span data-start="1359.69" data-end="1362.72">a time so in this next one I'm actually</span> <span data-start="1362.72" data-end="1364.549">gonna launch it again and this time I'm</span> <span data-start="1364.549" data-end="1367.1">gonna use a virtualization so I'm only</span> <span data-start="1367.1" data-end="1370.34">keeping in memory elements that are one</span> <span data-start="1370.34" data-end="1373.37">or two maybe three screens before or</span> <span data-start="1373.37" data-end="1376.73">after the visible screen right in this</span> <span data-start="1376.73" data-end="1379.13">particular case I'm think what I was</span> <span data-start="1379.13" data-end="1381.169">using here was when Jay s is my</span> <span data-start="1381.169" data-end="1383.36">virtualization engine when Jay s happens</span> <span data-start="1383.36" data-end="1384.98">to have really good list scrolling but</span> <span data-start="1384.98" data-end="1386.299">there are lots of other frameworks that</span> <span data-start="1386.299" data-end="1389.9">provide virtualization for it alright</span> <span data-start="1389.9" data-end="1393.98">let's get it up here one of the other</span> <span data-start="1393.98" data-end="1395.299">things that I want you to know is here</span> <span data-start="1395.299" data-end="1396.5">is one of the other tricks of</span> <span data-start="1396.5" data-end="1400.28">virtualization is that as the as the</span> <span data-start="1400.28" data-end="1402.049">browser gets to a place where it no</span> <span data-start="1402.049" data-end="1404">longer has those elements in memory what</span> <span data-start="1404" data-end="1405.47">it will start to do you see those gray</span> <span data-start="1405.47" data-end="1408.41">gray boxes essentially what it's doing</span> <span data-start="1408.41" data-end="1411.169">is putting in dummy elements so that you</span> <span data-start="1411.169" data-end="1413.96">feel like the the application is able to</span> <span data-start="1413.96" data-end="1415.669">keep up with it think here I'll use</span> </p>
<p><span data-start="1415.669" data-end="1417.71">Facebook again as an example when you</span> <span data-start="1417.71" data-end="1419.57">first load facebook on your mobile phone</span> <span data-start="1419.57" data-end="1422.179">it's got a couple of placeholder kind of</span> <span data-start="1422.179" data-end="1424.88">posts in there same idea this is really</span> <span data-start="1424.88" data-end="1426.89">all about of improving the perception of</span> <span data-start="1426.89" data-end="1431.78">performance and when we measure this out</span> <span data-start="1431.78" data-end="1433.94">we actually measured the memory of these</span> <span data-start="1433.94" data-end="1435.919">guys the virtualized list</span> <span data-start="1435.919" data-end="1438.669">less than a hundred megabytes of memory</span> <span data-start="1438.669" data-end="1441.08">for that particular application at</span> <span data-start="1441.08" data-end="1443.87">runtime the non-virtualized list over</span> <span data-start="1443.87" data-end="1446.21">was that nearly three hundred and fifty</span> <span data-start="1446.21" data-end="1449.84">megabytes and again we see a strong</span> <span data-start="1449.84" data-end="1452.12">correlation between the memory</span> <span data-start="1452.12" data-end="1454.16">consumption and the actual performance</span> <span data-start="1454.16" data-end="1457.13">itself and so any time that you find</span> <span data-start="1457.13" data-end="1458.299">yourself in a position where you're</span> <span data-start="1458.299" data-end="1461.09">trying to measure for performance and</span> <span data-start="1461.09" data-end="1462.429">trying to optimize for</span> <span data-start="1462.429" data-end="1465.009">formants measuring frames per second</span> <span data-start="1465.009" data-end="1467.86">great you should do that but as a proxy</span> <span data-start="1467.86" data-end="1469.779">it can sometimes be helpful to also look</span> <span data-start="1469.779" data-end="1473.32">at your memory consumption as well all</span> <span data-start="1473.32" data-end="1475.749">right take away use virtualization when</span> <span data-start="1475.749" data-end="1476.32">you can</span> <span data-start="1476.32" data-end="1478.45">lots of frameworks do it my advice don't</span> <span data-start="1478.45" data-end="1479.86">try to do this yourself writing</span> <span data-start="1479.86" data-end="1481.96">virtualization is hard it's super hard</span> <span data-start="1481.96" data-end="1490.45">just use another framework ok images so</span> <span data-start="1490.45" data-end="1492.759">here's a funny one this is like</span> <span data-start="1492.759" data-end="1494.95">completely this this blows my mind when</span> </p>
<p><span data-start="1494.95" data-end="1496.929">I see this one it's it's totally weird</span> <span data-start="1496.929" data-end="1499.659">so I didn't know how long have CSS</span> <span data-start="1499.659" data-end="1501.46">Graydon's gradients been around this is</span> <span data-start="1501.46" data-end="1505.149">like can anyone remember 2008 I don't</span> <span data-start="1505.149" data-end="1507.07">know something like that CSS gradients</span> <span data-start="1507.07" data-end="1509.499">are super super helpful they allow us to</span> <span data-start="1509.499" data-end="1510.82">be a little bit more responsive in our</span> <span data-start="1510.82" data-end="1513.07">design it we don't have to cut like a</span> <span data-start="1513.07" data-end="1514.24">one by one</span> <span data-start="1514.24" data-end="1516.999">you know pixel tile to kind of grayed</span> <span data-start="1516.999" data-end="1520.99">across but just like before when we were</span> <span data-start="1520.99" data-end="1522.639">looking at how we might reduce our</span> <span data-start="1522.639" data-end="1524.259">overall element count there are</span> <span data-start="1524.259" data-end="1526.149">different decisions that you might make</span> <span data-start="1526.149" data-end="1528.1">when you're optimizing for performance</span> <span data-start="1528.1" data-end="1530.47">versus when you're maintaining for or</span> <span data-start="1530.47" data-end="1531.369">when you're writing for code</span> <span data-start="1531.369" data-end="1533.98">maintainability so in this particular</span> <span data-start="1533.98" data-end="1536.649">case I've got two objects the first</span> <span data-start="1536.649" data-end="1539.32">object just uses a regular old CSS</span> <span data-start="1539.32" data-end="1542.799">gradient the second object uses a PNG</span> <span data-start="1542.799" data-end="1545.919">file to create my gradient alright what</span> </p>
<p><span data-start="1545.919" data-end="1547.21">I'm gonna do is I'm gonna animate these</span> <span data-start="1547.21" data-end="1549.909">guys and when I animate these guys I'm</span> <span data-start="1549.909" data-end="1551.619">gonna use the chrome dev tools to</span> <span data-start="1551.619" data-end="1555.009">measure frames per second and I hope</span> <span data-start="1555.009" data-end="1556.779">that many of you are familiar with the</span> <span data-start="1556.779" data-end="1558.58">chrome dev tools performance</span> <span data-start="1558.58" data-end="1561.97">optimization tools if you're not the</span> <span data-start="1561.97" data-end="1566.2">quick rule here is that tall bars up</span> <span data-start="1566.2" data-end="1570.039">there or bad low bars are good right so</span> <span data-start="1570.039" data-end="1572.139">in the first case where you see all</span> <span data-start="1572.139" data-end="1575.019">those giant green skyscrapers that's</span> <span data-start="1575.019" data-end="1577.389">what I'm animating the CSS gradient on</span> <span data-start="1577.389" data-end="1579.82">the right hand side when I'm animating</span> <span data-start="1579.82" data-end="1582.82">the image all those low bars that's when</span> </p>
<p><span data-start="1582.82" data-end="1586.559">I'm animating the bitmapped ping like</span> <span data-start="1586.559" data-end="1589.21">what what's up with that</span> <span data-start="1589.21" data-end="1591.6">like seriously what's up with that so</span> <span data-start="1591.6" data-end="1593.769">here's what I think is actually</span> <span data-start="1593.769" data-end="1595.929">happening right and I like here</span> <span data-start="1595.929" data-end="1597.309">actually you no need to call my friends</span> <span data-start="1597.309" data-end="1599.019">over at Google and verify this but</span> <span data-start="1599.019" data-end="1601.419">here's what I think is happening when</span> <span data-start="1601.419" data-end="1604.33">you animate that CSS gradient every time</span> <span data-start="1604.33" data-end="1606.7">it moves a frame over it needs to redraw</span> <span data-start="1606.7" data-end="1609.429">the gradient each time when it's</span> <span data-start="1609.429" data-end="1612.22">animating the bitmap or the ping in this</span> <span data-start="1612.22" data-end="1614.799">particular case that already exists it</span> <span data-start="1614.799" data-end="1616.929">doesn't need to redraw it every time and</span> <span data-start="1616.929" data-end="1619.36">so you get better animation when you're</span> <span data-start="1619.36" data-end="1622.11">moving the already in memory image</span> <span data-start="1622.11" data-end="1625.24">compared to what's essentially creating</span> <span data-start="1625.24" data-end="1627.789">an image for each for each frame of the</span> </p>
<p><span data-start="1627.789" data-end="1632.409">CSS and so if there's a kind of a a bad</span> <span data-start="1632.409" data-end="1634.779">version of this again like can't believe</span> <span data-start="1634.779" data-end="1637.24">I'm putting this up there bad CSS</span> <span data-start="1637.24" data-end="1639.129">gradients but somehow that is the case</span> <span data-start="1639.129" data-end="1642.029">when you're optimizing for performance</span> <span data-start="1642.029" data-end="1646.059">versus blow your mind good why in the</span> <span data-start="1646.059" data-end="1648.1">world is this but it once again when</span> <span data-start="1648.1" data-end="1649.99">you're optimizing for performance you're</span> <span data-start="1649.99" data-end="1651.85">going to make different decisions than</span> <span data-start="1651.85" data-end="1653.909">you would otherwise</span> <span data-start="1653.909" data-end="1658.84">all right so use images Oh garbage</span> <span data-start="1658.84" data-end="1661.659">collection everybody loves the garbage</span> <span data-start="1661.659" data-end="1663.249">collector he takes all of our dirty</span> <span data-start="1663.249" data-end="1666.999">memory away so garbage collectors have</span> <span data-start="1666.999" data-end="1669.639">been around for you know since browsers</span> <span data-start="1669.639" data-end="1671.499">were around and and generally they're</span> <span data-start="1671.499" data-end="1673.99">pretty efficient but when you're dealing</span> <span data-start="1673.99" data-end="1676.09">with a mobile application and I would</span> <span data-start="1676.09" data-end="1678.009">say that this is particularly poignant</span> <span data-start="1678.009" data-end="1681.7">for hybrid applications where the app</span> <span data-start="1681.7" data-end="1683.559">itself is going to be a single page</span> <span data-start="1683.559" data-end="1686.23">application that rarely shuts down</span> <span data-start="1686.23" data-end="1688.72">memory management becomes really really</span> <span data-start="1688.72" data-end="1692.23">important and that garbage collector it</span> <span data-start="1692.23" data-end="1693.73">does run automatically but you can get</span> <span data-start="1693.73" data-end="1696.82">yourself into a bad spot where it's um</span> <span data-start="1696.82" data-end="1700.539">it's it's unable to do its job so here's</span> <span data-start="1700.539" data-end="1701.83">what we're gonna do I want to kind of</span> <span data-start="1701.83" data-end="1703.269">show this in action and in this</span> <span data-start="1703.269" data-end="1707.59">particular one hit play here what I'm</span> <span data-start="1707.59" data-end="1708.909">going to do is I'm going to create a</span> <span data-start="1708.909" data-end="1711.129">bunch of elements and I'm going to</span> <span data-start="1711.129" data-end="1713.289">attach event handlers to those elements</span> <span data-start="1713.289" data-end="1714.909">just in the loops you see there add</span> <span data-start="1714.909" data-end="1717.249">event listener and then I'm just going</span> <span data-start="1717.249" data-end="1718.99">to destroy them by saying enter HTML</span> <span data-start="1718.99" data-end="1721.659">equals to blank what that means is that</span> <span data-start="1721.659" data-end="1725.47">as I destroy those my event handler is</span> <span data-start="1725.47" data-end="1728.139">still sticking around in memory and the</span> <span data-start="1728.139" data-end="1729.56">garbage collector has a</span> <span data-start="1729.56" data-end="1731.93">really tough time getting back to it so</span> <span data-start="1731.93" data-end="1732.95">what I'm gonna do here is I'm gonna</span> <span data-start="1732.95" data-end="1735.26">start running this guy and once again in</span> <span data-start="1735.26" data-end="1736.94">our friend chrome dev tools I want you</span> <span data-start="1736.94" data-end="1738.41">to notice once I start running it</span> <span data-start="1738.41" data-end="1741.5">there's gonna be a ramp that blue ramp</span> <span data-start="1741.5" data-end="1744.77">that starts to get bigger and bigger and</span> <span data-start="1744.77" data-end="1753.02">bigger bigger again that is death that</span> <span data-start="1753.02" data-end="1755.15">is death for your application over time</span> <span data-start="1755.15" data-end="1758.78">as memory just balloons out of scale now</span> <span data-start="1758.78" data-end="1761.84">granted here I am creating thousands and</span> <span data-start="1761.84" data-end="1764.71">thousands and thousands over again right</span> <span data-start="1764.71" data-end="1767.57">and you might think to yourself well and</span> <span data-start="1767.57" data-end="1768.95">my web application</span> </p>
<p><span data-start="1768.95" data-end="1770.45">I'm never gonna be creating these</span> <span data-start="1770.45" data-end="1771.95">thousands of elements again and again</span> <span data-start="1771.95" data-end="1775.25">and again but but you actually you are</span> <span data-start="1775.25" data-end="1776.93">especially if you've got a single page</span> <span data-start="1776.93" data-end="1779.54">application that guy could stay open for</span> <span data-start="1779.54" data-end="1781.46">a long time you may never shut it down</span> <span data-start="1781.46" data-end="1784.91">for months and as the memory grows and</span> <span data-start="1784.91" data-end="1786.77">those event handlers stick around behind</span> <span data-start="1786.77" data-end="1790.46">you're basically just signing up for a</span> <span data-start="1790.46" data-end="1799.68">browser crash at some point so bad here</span> <span data-start="1799.69" data-end="1800.96">eventlistener</span> <span data-start="1800.96" data-end="1802.97">still hanging around even after we</span> <span data-start="1802.97" data-end="1807.26">destroyed our element good be</span> <span data-start="1807.26" data-end="1809.57">responsible boys and girls destroy your</span> <span data-start="1809.57" data-end="1812.63">event handlers right remove event hit</span> <span data-start="1812.63" data-end="1815.36">event listener right there then</span> <span data-start="1815.36" data-end="1820.18">responsibly remove your child all right</span> <span data-start="1820.18" data-end="1822.95">now while we're on the subject of event</span> <span data-start="1822.95" data-end="1825.11">listeners let's talk about how we can</span> <span data-start="1825.11" data-end="1827.48">actually not just irresponsible create</span> <span data-start="1827.48" data-end="1829.52">and destroy them but also how we can</span> <span data-start="1829.52" data-end="1832.58">minimize the total number of them now I</span> <span data-start="1832.58" data-end="1836.21">don't know about you guys but um I often</span> <span data-start="1836.21" data-end="1839.57">like I go out I do a query selector all</span> <span data-start="1839.57" data-end="1841.64">or a dollar sign dollar sign I go get a</span> <span data-start="1841.64" data-end="1843.08">big collection of elements that loop</span> <span data-start="1843.08" data-end="1844.85">through them and as I loop through them</span> </p>
<p><span data-start="1844.85" data-end="1847.01">I just add in an event handler teach one</span> <span data-start="1847.01" data-end="1849.65">on click event handler on click event</span> <span data-start="1849.65" data-end="1852.74">handler and what that ends up doing is</span> <span data-start="1852.74" data-end="1854.59">that ends up creating a rubber-stamp</span> <span data-start="1854.59" data-end="1857.54">duplicate of every function again and</span> <span data-start="1857.54" data-end="1860.53">again and again and again and that</span> <span data-start="1860.53" data-end="1863.03">multiplicity that that giant collection</span> <span data-start="1863.03" data-end="1863.299">of</span> <span data-start="1863.299" data-end="1865.94">handlers are once again just consuming</span> <span data-start="1865.94" data-end="1869.6">more memory and so what I want you to to</span> <span data-start="1869.6" data-end="1871.519">encourage you to do here is rather than</span> <span data-start="1871.519" data-end="1873.769">create an event listener or event</span> <span data-start="1873.769" data-end="1877.279">handler for each element instead think</span> <span data-start="1877.279" data-end="1880.19">about using a single event handler for</span> <span data-start="1880.19" data-end="1882.289">all of your objects within a node tree</span> <span data-start="1882.289" data-end="1883.73">let me let me kind of explain what I</span> <span data-start="1883.73" data-end="1886.159">mean here a little bit so one two three</span> <span data-start="1886.159" data-end="1888.59">four and five those little elements down</span> <span data-start="1888.59" data-end="1890.779">at the bottom they've all got a common</span> <span data-start="1890.779" data-end="1894.889">ancestor in this case the dude right so</span> <span data-start="1894.889" data-end="1897.32">that dude through the magic of event</span> <span data-start="1897.32" data-end="1900.23">bubbling receives all the same events</span> <span data-start="1900.23" data-end="1902.679">that one two three four and five receive</span> <span data-start="1902.679" data-end="1904.909">so what I want to encourage you to do is</span> <span data-start="1904.909" data-end="1907.399">think about how you can use event</span> <span data-start="1907.399" data-end="1909.259">handlers or event listeners on the dude</span> <span data-start="1909.259" data-end="1912.799">to respond to events that occur on its</span> <span data-start="1912.799" data-end="1916.399">children so here's what we're gonna do</span> <span data-start="1916.399" data-end="1922.279">we're actually show this in action so</span> </p>
<p><span data-start="1922.279" data-end="1924.22">I'm gonna have a couple of different</span> <span data-start="1924.22" data-end="1928.07">scenarios here in scenario one I'm going</span> <span data-start="1928.07" data-end="1931.279">to have one event handler for each</span> <span data-start="1931.279" data-end="1935.96">element in scenario two I'm going to use</span> <span data-start="1935.96" data-end="1939.129">event bubbling and then attach a</span> <span data-start="1939.129" data-end="1942.889">essentially a switch case to my event</span> <span data-start="1942.889" data-end="1945.259">handler to say what did you click on</span> <span data-start="1945.259" data-end="1947.539">oh you clicked on ancestor or rather</span> <span data-start="1947.539" data-end="1951.47">child a then do this and then in case</span> <span data-start="1951.47" data-end="1954.32">three I'm going to have that same kind</span> <span data-start="1954.32" data-end="1957.529">of one-to-one relationship between event</span> <span data-start="1957.529" data-end="1960.289">listeners and objects but this time I'm</span> <span data-start="1960.289" data-end="1962.33">going to use a common function for all</span> <span data-start="1962.33" data-end="1965.149">of them so here's what I've done I've</span> <span data-start="1965.149" data-end="1966.35">just executed the first of those</span> <span data-start="1966.35" data-end="1968.869">scenarios that is one event handler per</span> <span data-start="1968.869" data-end="1971.72">element and I've taken a little snapshot</span> <span data-start="1971.72" data-end="1975.82">of memory now I'm executing scenario two</span> <span data-start="1975.82" data-end="1978.379">this is the one with event bubbling</span> <span data-start="1978.379" data-end="1981.679">where we use a switch case on the top</span> <span data-start="1981.679" data-end="1985.119">level element to identify the actual</span> <span data-start="1985.119" data-end="1987.109">element that it was clicked upon and</span> <span data-start="1987.109" data-end="1989.72">then okay we're taking that snap shot</span> <span data-start="1989.72" data-end="1992.509">now and now snap shot three where we</span> <span data-start="1992.509" data-end="1995.509">actually have an event listener for</span> <span data-start="1995.509" data-end="1996.59">every element</span> <span data-start="1996.59" data-end="1999.89">but it all points to the same common</span> <span data-start="1999.89" data-end="2002.11">eventhandler the same common function</span> <span data-start="2002.11" data-end="2005.11">what I want to point to in this we're</span> <span data-start="2005.11" data-end="2007">gonna kind of drag it around here I want</span> <span data-start="2007" data-end="2009.64">you to take a look at the retained size</span> <span data-start="2009.64" data-end="2012.309">that's that far column right there so</span> <span data-start="2012.309" data-end="2015.52">look at that 257 K or 8% of the total</span> <span data-start="2015.52" data-end="2018.84">memory is dedicated to the Dom okay</span> <span data-start="2018.84" data-end="2021.94">snapshot  this is the one where we use</span> <span data-start="2021.94" data-end="2026.2">the one-to-one relationship oh man that</span> <span data-start="2026.2" data-end="2030.61">was 468 K and then snapshot one this is</span> <span data-start="2030.61" data-end="2033.46">the one oh that's that that's the bad</span> <span data-start="2033.46" data-end="2035.38">one right that's one two one one event</span> <span data-start="2035.38" data-end="2038.679">handler per object and here we can see</span> </p>
<p><span data-start="2038.679" data-end="2040.539">I'm actually gonna open it up and you'll</span> <span data-start="2040.539" data-end="2042.61">be able to see one event handler per</span> <span data-start="2042.61" data-end="2048.31">object there there it is that native</span> <span data-start="2048.31" data-end="2050.71">function right there that's one per</span> <span data-start="2050.71" data-end="2053.29">object and then in snapshots one and</span> <span data-start="2053.29" data-end="2055.179">three those are the ones where I've got</span> <span data-start="2055.179" data-end="2058.839">a common event handler for each element</span> <span data-start="2058.839" data-end="2063.76">right through that I realize what's here</span> <span data-start="2063.76" data-end="2067.29">I'll rewind it a bit so you can see it</span> <span data-start="2067.29" data-end="2071.8">mmm there we are the 257 there right it</span> <span data-start="2071.8" data-end="2074.47">is about half of the retained memory</span> <span data-start="2074.47" data-end="2077.589">size when I use either a common event</span> <span data-start="2077.589" data-end="2080.409">handler for each event listener or I do</span> <span data-start="2080.409" data-end="2084.099">the handler on the parent element when</span> <span data-start="2084.099" data-end="2086.22">this this it's helpful if you see a</span> <span data-start="2086.22" data-end="2089.139">quick little code example here right so</span> <span data-start="2089.139" data-end="2091.21">for this one bad</span> </p>
<p><span data-start="2091.21" data-end="2093.429">I'm just doing a loop I'm attaching a</span> <span data-start="2093.429" data-end="2096.849">single an event handler to each object</span> <span data-start="2096.849" data-end="2099.19">and each of those event handlers is</span> <span data-start="2099.19" data-end="2101.58">essentially a clone of the one before it</span> <span data-start="2101.58" data-end="2105.369">whereas good I'm attaching an event</span> <span data-start="2105.369" data-end="2108.369">listener to the parent and in this case</span> <span data-start="2108.369" data-end="2111.19">I just use an if statement I could be a</span> <span data-start="2111.19" data-end="2112.96">little bit more sophisticated use a</span> <span data-start="2112.96" data-end="2114.55">switch statement to figure out which</span> <span data-start="2114.55" data-end="2117.67">child I clicked on again that resulted</span> <span data-start="2117.67" data-end="2119.83">in about half of the retained memory</span> <span data-start="2119.83" data-end="2122.38">size a win not only for memory but also</span> <span data-start="2122.38" data-end="2126.64">for your performance so take advantage</span> <span data-start="2126.64" data-end="2129.71">of event bubbling</span> <span data-start="2129.72" data-end="2132.81">pay attention to memory leaks</span> <span data-start="2132.81" data-end="2136.72">okay memory leaks so this is kind of a</span> <span data-start="2136.72" data-end="2138.91">variation of what we saw earlier with</span> <span data-start="2138.91" data-end="2141.28">the event that we left kind of hanging</span> <span data-start="2141.28" data-end="2142.84">on right where we created a lot of</span> <span data-start="2142.84" data-end="2144.46">elements destroy them and left an event</span> <span data-start="2144.46" data-end="2148.48">handler sticking around so in this</span> <span data-start="2148.48" data-end="2151.6">particular one what I'm going to do what</span> </p>
<p><span data-start="2151.6" data-end="2153.73">I'm going to do is I'm going to cycle</span> <span data-start="2153.73" data-end="2155.53">through and create a bunch of elements</span> <span data-start="2155.53" data-end="2157.54">and then for those elements I'm going to</span> <span data-start="2157.54" data-end="2160.93">keep each one of the elements scoped to</span> <span data-start="2160.93" data-end="2165.31">the private function right and this</span> <span data-start="2165.31" data-end="2167.11">first time around because it's scoped to</span> <span data-start="2167.11" data-end="2170.17">the private function those functions and</span> <span data-start="2170.17" data-end="2172.93">those objects will will will be</span> <span data-start="2172.93" data-end="2174.97">destroyed when the function itself is</span> <span data-start="2174.97" data-end="2177.4">destroyed and so here we're gonna launch</span> <span data-start="2177.4" data-end="2188.41">it up there we go here it comes</span> <span data-start="2188.42" data-end="2191.33">little heap snapshot there alright and</span> <span data-start="2191.33" data-end="2193.61">so as I'm navigating from page to page</span> <span data-start="2193.61" data-end="2195.35">what it's essentially doing is creating</span> <span data-start="2195.35" data-end="2197.69">those objects destroying those objects</span> <span data-start="2197.69" data-end="2200.03">creating those objects destroying those</span> <span data-start="2200.03" data-end="2203.21">objects right and as it does so because</span> <span data-start="2203.21" data-end="2205.01">the objects are created as part of the</span> <span data-start="2205.01" data-end="2207.41">private function the objects are</span> <span data-start="2207.41" data-end="2209.21">destroyed with a lifetime of the</span> <span data-start="2209.21" data-end="2214.16">function itself and so here what I want</span> <span data-start="2214.16" data-end="2216.62">you to see look it's a nice clean Dom</span> <span data-start="2216.62" data-end="2219.56">here there are no unparent 'add div</span> <span data-start="2219.56" data-end="2222.08">elements those are all white white is</span> <span data-start="2222.08" data-end="2227">good you like white all right now what</span> </p>
<p><span data-start="2227" data-end="2229.19">I'm gonna do is I'm gonna switch it up a</span> <span data-start="2229.19" data-end="2231.8">little bit this time just by removing</span> <span data-start="2231.8" data-end="2234.08">the VAR declaration from within the</span> <span data-start="2234.08" data-end="2236.57">function scope I'm immediately putting</span> <span data-start="2236.57" data-end="2238.22">each one of the div elements into the</span> <span data-start="2238.22" data-end="2240.35">global scope because they are in the</span> <span data-start="2240.35" data-end="2243.74">global scope they are not destroyed when</span> <span data-start="2243.74" data-end="2246.38">you destroy the function as well and so</span> <span data-start="2246.38" data-end="2249.58">those will end up hanging around as</span> <span data-start="2249.58" data-end="2252.5">unparent ated Dom fragments sticking</span> <span data-start="2252.5" data-end="2254.03">around in my application so here we go</span> <span data-start="2254.03" data-end="2260.96">we're gonna do the navigation again I'm</span> <span data-start="2260.96" data-end="2262.55">gonna fast forward just a little bit</span> <span data-start="2262.55" data-end="2268.92">there we go</span> <span data-start="2268.93" data-end="2271.01">navigate back and forth once again</span> <span data-start="2271.01" data-end="2273.41">creating destroying each of the</span> <span data-start="2273.41" data-end="2275.9">functions but this time because all of</span> <span data-start="2275.9" data-end="2277.28">my elements are being created in the</span> <span data-start="2277.28" data-end="2279.38">global scope when I create an destroy my</span> <span data-start="2279.38" data-end="2281.48">functions my objects are still sticking</span> <span data-start="2281.48" data-end="2283.16">around my Dom objects are still sticking</span> <span data-start="2283.16" data-end="2288.17">around all right let the snapshot do its</span> <span data-start="2288.17" data-end="2292.43">computational powers and when we expose</span> <span data-start="2292.43" data-end="2295.73">this look at all of that read each one</span> <span data-start="2295.73" data-end="2297.98">of those objects that's marked as kind</span> <span data-start="2297.98" data-end="2300.5">of with a pinkish red background these</span> <span data-start="2300.5" data-end="2302.57">are objects that are just polluting your</span> </p>
<p><span data-start="2302.57" data-end="2305.26">Dom taking up space taking up memory and</span> <span data-start="2305.26" data-end="2310.37">dragging you down right so a good kind</span> <span data-start="2310.37" data-end="2312.74">of check for yourself is run your</span> <span data-start="2312.74" data-end="2314.66">application for a little while go back</span> <span data-start="2314.66" data-end="2317.12">into chrome dev tools see if you can</span> <span data-start="2317.12" data-end="2319.57">find into these objects that are red and</span> <span data-start="2319.57" data-end="2322.23">try and find out where those get created</span> <span data-start="2322.23" data-end="2324.93">how you can destroy them because over</span> <span data-start="2324.93" data-end="2326.55">time they're just going to increase your</span> <span data-start="2326.55" data-end="2328.8">overall memory footprint and ultimately</span> <span data-start="2328.8" data-end="2332.63">drag down your performance as well so</span> <span data-start="2332.63" data-end="2336.81">bad in this particular case we've got</span> <span data-start="2336.81" data-end="2340.19">the element created in the global scope</span> <span data-start="2340.19" data-end="2344.01">outside of the function good we're</span> <span data-start="2344.01" data-end="2345.72">actually creating the element within the</span> <span data-start="2345.72" data-end="2347.91">scope of the function and so it gets</span> <span data-start="2347.91" data-end="2352.44">destroyed with the function destroy all</span> <span data-start="2352.44" data-end="2358.32">your unused objects so we're getting to</span> <span data-start="2358.32" data-end="2359.04">the end of it</span> </p>
<p><span data-start="2359.04" data-end="2362.7">I beg beg of you if you remember</span> <span data-start="2362.7" data-end="2367.5">anything about this talk anyone can</span> <span data-start="2367.5" data-end="2372.119">build slow apps you can you can that guy</span> <span data-start="2372.119" data-end="2375.78">has I know he has back there you can do</span> <span data-start="2375.78" data-end="2376.35">it too</span> <span data-start="2376.35" data-end="2378.9">anyone can build slow apps but you don't</span> <span data-start="2378.9" data-end="2382.2">have to like go into it thinking about</span> <span data-start="2382.2" data-end="2384.66">performance first before it drags you</span> <span data-start="2384.66" data-end="2388.14">down in the end thank you so much once</span> <span data-start="2388.14" data-end="2390.119">again Ryan J Salva come talk to me</span> <span data-start="2390.119" data-end="2391.2">afterwards I'd love to talk to you about</span> <span data-start="2391.2" data-end="2393.09">animation and UI controls and all the</span> <span data-start="2393.09" data-end="2394.44">experiments that I didn't get to share</span> <span data-start="2394.44" data-end="2398.609">with you today thank you so much thank</span> <span data-start="2398.609" data-end="2401.349">you</span> <span data-start="2402.41" data-end="2402.42">you</span> <span data-start="2402.42" data-end="2423.94">[Music]</span> </p>
</section>