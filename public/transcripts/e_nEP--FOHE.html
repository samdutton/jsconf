<section>
<p><span data-start="4.98" data-end="8.309">so this is actually my first crew do</span> <span data-start="8.309" data-end="9.9">conference talk every other talk I've</span> <span data-start="9.9" data-end="13.5">given has been internal or to small</span> <span data-start="13.5" data-end="16.289">meetups or just groups of friends so</span> <span data-start="16.289" data-end="17.99">this is actually kind of exciting for me</span> <span data-start="17.99" data-end="22.71">thank you thank you so I am a developer</span> <span data-start="22.71" data-end="24.779">advocate with the Google Chrome team and</span> <span data-start="24.779" data-end="27.359">my explicit focus is Chrome extensions</span> <span data-start="27.359" data-end="31.439">and the the Chrome Web Store so today</span> </p>
<p><span data-start="31.439" data-end="32.96">I'd like to talk to you a bit about how</span> <span data-start="32.96" data-end="35.34">Chrome is trying to evolve the</span> <span data-start="35.34" data-end="37.68">extensions platform in order to make it</span> <span data-start="37.68" data-end="40.35">more secure stable and reliable friend</span> <span data-start="40.35" data-end="44.46">users so the high-level overview of what</span> <span data-start="44.46" data-end="46.26">I'm going to be talking about is a broad</span> <span data-start="46.26" data-end="49.489">history of an abbreviated history of</span> <span data-start="49.489" data-end="52.05">browser extensions and custom is a</span> <span data-start="52.05" data-end="54.17">customized ability in the browser</span> <span data-start="54.17" data-end="57.23">Chrome's approach to extensions and</span> <span data-start="57.23" data-end="60.39">finally what is changing in manifest v3</span> <span data-start="60.39" data-end="64.739">so onto the browser history browser</span> <span data-start="64.739" data-end="66.45">history is very long very complicated</span> <span data-start="66.45" data-end="67.77">there's a ton of different stuff so I'm</span> <span data-start="67.77" data-end="70.08">gonna be giving a vastly oversimplified</span> <span data-start="70.08" data-end="72.99">history here and if you're expecting</span> <span data-start="72.99" data-end="74.729">something exciting here don't be because</span> <span data-start="74.729" data-end="77.119">it is literally these bullet points so</span> <span data-start="77.119" data-end="79.159">first up we have Netscape Navigator</span> </p>
<p><span data-start="79.159" data-end="81.84">Internet Explorer and then Firefox v1</span> <span data-start="81.84" data-end="84.42">each of these kind of introduces a new</span> <span data-start="84.42" data-end="86.909">concept to browser extension and</span> <span data-start="86.909" data-end="89.1">customization and obviously finally</span> </p>
<p><span data-start="89.1" data-end="91.799">Chrome with its own special take so</span> <span data-start="91.799" data-end="94.079">Netscape Navigator wait before I go on</span> <span data-start="94.079" data-end="95.79">one of my favorite things about this</span> <span data-start="95.79" data-end="99.42">slide is the the animation in the</span> <span data-start="99.42" data-end="101.49">Navigator logo I totally forgot it's</span> <span data-start="101.49" data-end="103.47">been long enough that but when I was</span> <span data-start="103.47" data-end="105.09">doing research for this and looking into</span> <span data-start="105.09" data-end="107.75">the history of browsers I forgot how</span> <span data-start="107.75" data-end="110.189">common these kind of throb animations</span> <span data-start="110.189" data-end="112.5">were and it's an artifact of web history</span> <span data-start="112.5" data-end="116.159">that I kind of miss anyway Netscape</span> <span data-start="116.159" data-end="118.53">Navigator was the first browser that</span> <span data-start="118.53" data-end="121.89">allowed third-party developers to modify</span> <span data-start="121.89" data-end="124.49">what the browser could do post</span> <span data-start="124.49" data-end="126.42">installation after it was actually on</span> <span data-start="126.42" data-end="127.979">the user's machine and they did this</span> <span data-start="127.979" data-end="130.44">through the introduction of a NPAPI or</span> </p>
<p><span data-start="130.44" data-end="132.36">Netscape plug-in application programming</span> <span data-start="132.36" data-end="132.93">interface</span> <span data-start="132.93" data-end="136.22">NPAPI was cool because it allowed</span> <span data-start="136.22" data-end="138.51">third-party developers to register new</span> <span data-start="138.51" data-end="140.42">content types that the browser could</span> <span data-start="140.42" data-end="143.58">display and the user could interact with</span> <span data-start="143.58" data-end="145.58">so this was originally introduced</span> <span data-start="145.58" data-end="148.739">specifically for Java applets but later</span> <span data-start="148.739" data-end="152.459">on folks like Mozilla used this</span> <span data-start="152.459" data-end="155.819">capability to add the ability to for</span> <span data-start="155.819" data-end="158.28">application PDF work to display PDFs in</span> <span data-start="158.28" data-end="162.15">a browser so this capability was reverse</span> <span data-start="162.15" data-end="164.819">engineer able and ultimately extendable</span> <span data-start="164.819" data-end="167.64">by third other third parties but one of</span> <span data-start="167.64" data-end="170.76">the disadvantages of this approach is</span> <span data-start="170.76" data-end="172.769">that fundamentally they didn't really</span> <span data-start="172.769" data-end="174.569">have a security model this was just a</span> <span data-start="174.569" data-end="176.519">some native code running in the browser</span> <span data-start="176.519" data-end="178.62">executed in the browser's process and it</span> <span data-start="178.62" data-end="180.569">had the same capabilities the threat</span> <span data-start="180.569" data-end="181.709">model at the time was very different</span> <span data-start="181.709" data-end="183.78">than we have today so that wasn't too</span> <span data-start="183.78" data-end="186.39">much of a concern but it was something</span> <span data-start="186.39" data-end="189.18">to be aware of the most practical side</span> <span data-start="189.18" data-end="192.56">effect of this is if you had an unstable</span> <span data-start="192.56" data-end="195.569">plugin let's say maybe it was something</span> <span data-start="195.569" data-end="198.54">like a PDF displayer it might crash your</span> <span data-start="198.54" data-end="201.329">browser unexpectedly that was pretty not</span> <span data-start="201.329" data-end="204.599">great as an end user experience the next</span> <span data-start="204.599" data-end="206.459">major phase we have here is internet</span> <span data-start="206.459" data-end="208.379">explorer floor Internet Explorer</span> <span data-start="208.379" data-end="212.129">introduced the first this was the first</span> <span data-start="212.129" data-end="217.2">time a a browser allowed third parties</span> <span data-start="217.2" data-end="218.609">to actually modify the browser's</span> <span data-start="218.609" data-end="220.919">behavior rather than just the the</span> <span data-start="220.919" data-end="223.139">content that it could display and before</span> </p>
<p><span data-start="223.139" data-end="226.47">I go on again logo stuff this in my head</span> <span data-start="226.47" data-end="227.73">is what I think of when I think of</span> <span data-start="227.73" data-end="230.01">Internet Explorer 4 it turns out this is</span> <span data-start="230.01" data-end="232.769">actually like the eye 6 and 7 logo in</span> <span data-start="232.769" data-end="236.129">loading animation ie 4 actually had this</span> <span data-start="236.129" data-end="239.489">modern style logo which I find kind of</span> <span data-start="239.489" data-end="241.98">funny that we started here and then</span> <span data-start="241.98" data-end="243.93">moved away and went skeuomorphic and</span> <span data-start="243.93" data-end="245.639">then came back to this super reduced</span> <span data-start="245.639" data-end="246.9">minimal thing anyway none of that's</span> <span data-start="246.9" data-end="251.01">important so one of the capabilities</span> <span data-start="251.01" data-end="253.65">that they introduced from 94 was this</span> <span data-start="253.65" data-end="255.75">shortcuts menu or context menu when you</span> <span data-start="255.75" data-end="257.43">right-click you were able to go to a</span> <span data-start="257.43" data-end="260.039">menu and take an action that would be</span> <span data-start="260.039" data-end="264.43">invoked in your extension</span> <span data-start="264.44" data-end="266.97">this was a nice bit of functionality but</span> <span data-start="266.97" data-end="268.32">not I don't know</span> <span data-start="268.32" data-end="270.54">the end-all-be-all internet explorer</span> <span data-start="270.54" data-end="273.36">also introduced Explorer VARs or in what</span> <span data-start="273.36" data-end="276.36">some modern browsers call sidebars so</span> <span data-start="276.36" data-end="279.27">this is persistent content that frames</span> <span data-start="279.27" data-end="284.2">the web UI that you're interacting with</span> <span data-start="284.21" data-end="287.73">next up we have toolbars and you can see</span> </p>
<p><span data-start="287.73" data-end="290.37">Google is one of the many providers of</span> <span data-start="290.37" data-end="293.46">toolbars this would typically be things</span> <span data-start="293.46" data-end="296.3">like overriding your search provider</span> <span data-start="296.3" data-end="299.16">adding customization — I don't know</span> <span data-start="299.16" data-end="301.32">common behaviors that you might have or</span> <span data-start="301.32" data-end="305.15">maybe even tabs or uh what do they call</span> <span data-start="305.15" data-end="310.26">bookmarks of course this could be pretty</span> <span data-start="310.26" data-end="311.76">terrible and you ended up with stuff</span> <span data-start="311.76" data-end="314.37">like this where of course Google is a</span> <span data-start="314.37" data-end="317.55">contributor to this mess now one of the</span> <span data-start="317.55" data-end="318.66">reasons that we ended up in this</span> <span data-start="318.66" data-end="322.65">situation is that it in order to install</span> <span data-start="322.65" data-end="324.54">an extension you had to execute an</span> <span data-start="324.54" data-end="327.93">installer and that would drop a binary</span> <span data-start="327.93" data-end="330">in your file system and that would</span> <span data-start="330" data-end="332.85">register you would add a registry</span> <span data-start="332.85" data-end="335.22">interest entry so that I would know</span> <span data-start="335.22" data-end="337.23">where to look — in order to load your</span> <span data-start="337.23" data-end="340.92">extension which made it kind of hard for</span> <span data-start="340.92" data-end="343.53">non tech savvy users to get rid of stuff</span> <span data-start="343.53" data-end="345.93">and with the capabilities of running in</span> <span data-start="345.93" data-end="350.61">a binary it also made it so extension</span> <span data-start="350.61" data-end="352.74">developers could make some bad</span> <span data-start="352.74" data-end="353.73">not-so-great</span> <span data-start="353.73" data-end="355.38">user interface decisions that made it</span> <span data-start="355.38" data-end="358.61">hard to get rid of there their tools</span> <span data-start="358.61" data-end="363.9">their tools and finally the third major</span> <span data-start="363.9" data-end="365.82">or fourth major thing that Internet</span> </p>
<p><span data-start="365.82" data-end="368.07">Explorer introduced was this concept of</span> <span data-start="368.07" data-end="371.13">browser helper objects or be a chose by</span> <span data-start="371.13" data-end="375.03">and large the entire extension feature</span> <span data-start="375.03" data-end="377.85">is commonly referred to as be a chose or</span> <span data-start="377.85" data-end="379.71">in extension was commonly referred to as</span> <span data-start="379.71" data-end="381.86">a Pho even though the first things</span> <span data-start="381.86" data-end="383.79">shortcuts Explorer VARs and toolbars</span> <span data-start="383.79" data-end="386.25">could be provided without a BHO that's</span> <span data-start="386.25" data-end="387.54">kind of an implementation detail but</span> <span data-start="387.54" data-end="391.32">whatever so the way the system worked is</span> <span data-start="391.32" data-end="393.84">you would compile a native dll that used</span> <span data-start="393.84" data-end="396.36">a kind of standardized comm interface in</span> <span data-start="396.36" data-end="397.59">order to communicate with</span> </p>
<p><span data-start="397.59" data-end="400.919">Internet Explorer and BA chose could</span> <span data-start="400.919" data-end="403.74">then have this full set of native</span> <span data-start="403.74" data-end="406.53">capabilities and file system access and</span> <span data-start="406.53" data-end="409.38">you know potentially owning a user's</span> <span data-start="409.38" data-end="412.77">machine not not the best security</span> <span data-start="412.77" data-end="415.169">capabilities anyway this one that we're</span> <span data-start="415.169" data-end="416.88">looking at right now the web accessible</span> <span data-start="416.88" data-end="419.19">web accessibility toolbar produced by</span> <span data-start="419.19" data-end="421.62">Vision Australia it would let you do</span> <span data-start="421.62" data-end="424.97">things like preview a grayscale mode or</span> <span data-start="424.97" data-end="427.26">see what your web experience would be</span> <span data-start="427.26" data-end="429.8">like with for color Brian blind users or</span> <span data-start="429.8" data-end="432.78">expose in a visual way the accessibility</span> <span data-start="432.78" data-end="434.22">tree it was actually a pretty cool</span> <span data-start="434.22" data-end="436.2">extension that helped a lot of</span> <span data-start="436.2" data-end="441.3">developers Firefox is kind of the next</span> <span data-start="441.3" data-end="444.33">major step in the customization of</span> <span data-start="444.33" data-end="447.54">browser extensions in that this was the</span> <span data-start="447.54" data-end="450.15">first time well there were a couple of</span> <span data-start="450.15" data-end="454.65">interesting first with Firefox predating</span> </p>
<p><span data-start="454.65" data-end="458.52">Firefox is a application suite that was</span> <span data-start="458.52" data-end="459.87">produced by Mozilla called Mozilla</span> <span data-start="459.87" data-end="464.1">application suite clever name they they</span> <span data-start="464.1" data-end="466.26">basically had an email client in an RSS</span> <span data-start="466.26" data-end="469.08">reader and a web browser in this package</span> <span data-start="469.08" data-end="471.24">and I think a calendar — of all of this</span> <span data-start="471.24" data-end="474.96">package of tools that a user can use to</span> <span data-start="474.96" data-end="476.78">you know accomplish their day to day</span> <span data-start="476.78" data-end="481.5">native work on their desktop what was</span> <span data-start="481.5" data-end="484.1">really cool about this is they used an</span> <span data-start="484.1" data-end="487.83">user interface language called Zul XML</span> <span data-start="487.83" data-end="490.83">user interface language and it could be</span> <span data-start="490.83" data-end="493.65">scripted or programmed scripted with</span> </p>
<p><span data-start="493.65" data-end="495.78">JavaScript or programmed with xpcom</span> <span data-start="495.78" data-end="498.99">which is a cross-platform component</span> <span data-start="498.99" data-end="501.08">object model basically the same thing as</span> <span data-start="501.08" data-end="503.91">the com model that ie was using except</span> <span data-start="503.91" data-end="507.389">now it's cross platform and you can do</span> <span data-start="507.389" data-end="509.28">more languages rather than just the</span> <span data-start="509.28" data-end="511.47">specific things that would compile to</span> <span data-start="511.47" data-end="518.729">the common interface later on oh right I</span> <span data-start="518.729" data-end="521.19">was talking about Mozilla application</span> <span data-start="521.19" data-end="523.14">suite that's also known as sea monkey if</span> <span data-start="523.14" data-end="525.54">you might have heard that term sea</span> <span data-start="525.54" data-end="526.68">monkey was interesting because the</span> <span data-start="526.68" data-end="528.6">entire thing was scriptable using Zul</span> <span data-start="528.6" data-end="530.93">and one of these languages</span> <span data-start="530.93" data-end="533.33">so they were using web technologies to</span> <span data-start="533.33" data-end="536.18">build an entire web browser an</span> <span data-start="536.18" data-end="541.1">application suite what happened with</span> </p>
<p><span data-start="541.1" data-end="543.08">Firefox is they took those capabilities</span> <span data-start="543.08" data-end="545.48">and formalized them and expose them as</span> <span data-start="545.48" data-end="547.43">the extension platform so it was</span> <span data-start="547.43" data-end="550.46">possible in to use web technologies to</span> <span data-start="550.46" data-end="552.71">build the web browser it was possible to</span> <span data-start="552.71" data-end="554.27">use web technologies to customize the</span> <span data-start="554.27" data-end="555.86">web browser they also tried to do some</span> <span data-start="555.86" data-end="558.74">sandboxing here to limit the nefarious</span> <span data-start="558.74" data-end="560.75">things that extensions could do but</span> <span data-start="560.75" data-end="564.26">ultimately it wasn't that hard to get</span> <span data-start="564.26" data-end="568.4">full control of the browser with xpcom</span> <span data-start="568.4" data-end="572.21">and therefore do terrible things with to</span> <span data-start="572.21" data-end="574.34">the user's machine part of what was</span> <span data-start="574.34" data-end="576.56">novel with Firefox here though is they</span> <span data-start="576.56" data-end="578.03">introduced for the first time the</span> <span data-start="578.03" data-end="580.13">ability to install extensions from the</span> <span data-start="580.13" data-end="583.04">web so this is a whole interesting</span> <span data-start="583.04" data-end="585.98">potential vector for a new class of</span> <span data-start="585.98" data-end="589.25">attacks and again like the previous ones</span> <span data-start="589.25" data-end="593.63">this is the the app the X become DLL</span> <span data-start="593.63" data-end="595.13">that is being loaded in the browser is</span> <span data-start="595.13" data-end="597.14">arbitrary binary so you again you could</span> <span data-start="597.14" data-end="601.01">do some pretty terrible stuff so inter</span> <span data-start="601.01" data-end="603.53">chrome extensions chrome extensions were</span> <span data-start="603.53" data-end="606.59">introduced in chrome 4.0 which is very</span> <span data-start="606.59" data-end="608.75">very early on I think maybe a year or</span> <span data-start="608.75" data-end="611.93">two after chrome was first released the</span> <span data-start="611.93" data-end="614.6">main the goals are listed here the of</span> <span data-start="614.6" data-end="616.37">the Chrome extension platform but the</span> <span data-start="616.37" data-end="618.4">main thing I want to call out is that</span> <span data-start="618.4" data-end="621.86">chrome is Webby it is stable and our</span> </p>
<p><span data-start="621.86" data-end="623.51">Chrome extensions are Webby stable and</span> <span data-start="623.51" data-end="625.31">secure so it's webby in that they're</span> <span data-start="625.31" data-end="626.9">built with web technologies HTML</span> <span data-start="626.9" data-end="631.24">Javascript and CSS it's stable in that a</span> <span data-start="631.24" data-end="633.56">Fault in the extension isn't going to</span> <span data-start="633.56" data-end="635.18">bring down the whole browser process the</span> <span data-start="635.18" data-end="638.42">worst case is the unstable extension</span> <span data-start="638.42" data-end="640.82">will take itself down and you know it'll</span> <span data-start="640.82" data-end="643.07">die on its own in the corner and it's</span> <span data-start="643.07" data-end="645.83">secure in that it adopts the web</span> <span data-start="645.83" data-end="647.74">security model with some additional</span> <span data-start="647.74" data-end="650.69">modifications specific to the extension</span> <span data-start="650.69" data-end="652.7">platform in order to increase the</span> <span data-start="652.7" data-end="654.65">security of the additional capabilities</span> <span data-start="654.65" data-end="657.17">that are exposed there this is a</span> <span data-start="657.17" data-end="660.89">fundamental shift from how everything I</span> <span data-start="660.89" data-end="662.99">guess pre Firefox Firefox had a little</span> <span data-start="662.99" data-end="664.31">bit of ability to do this but</span> <span data-start="664.31" data-end="666.259">they were still something different they</span> <span data-start="666.259" data-end="667.759">were using special technologies to build</span> <span data-start="667.759" data-end="670.279">the extensions platform where Chrome</span> <span data-start="670.279" data-end="671.959">extensions are all just web technologies</span> <span data-start="671.959" data-end="675.589">with some additional api's and I wanted</span> <span data-start="675.589" data-end="677.089">to call out it this breaks away from</span> <span data-start="677.089" data-end="679.759">native api's with the small Astra that</span> <span data-start="679.759" data-end="683.689">content displaying capabilities like we</span> <span data-start="683.689" data-end="687.379">originally discussed with Netscape it</span> <span data-start="687.379" data-end="689.87">still supports it still supported NPAPI</span> <span data-start="689.87" data-end="692.48">and some additional Chrome specific</span> <span data-start="692.48" data-end="695.269">stuff Knakal and pinochle but those are</span> <span data-start="695.269" data-end="697.819">going away in favor of wasm so let's</span> <span data-start="697.819" data-end="699.47">pretend they don't exist I only care</span> <span data-start="699.47" data-end="702.639">about extensions anywhere so moving on</span> <span data-start="702.639" data-end="705.68">no extension platform no software</span> <span data-start="705.68" data-end="709.61">platform is perfect so in the</span> <span data-start="709.61" data-end="712.91">intervening years between the original</span> <span data-start="712.91" data-end="715.699">release of extensions and the current</span> <span data-start="715.699" data-end="718.579">platform as we know it today we started</span> <span data-start="718.579" data-end="721.16">to see some patterns in the extension</span> <span data-start="721.16" data-end="724.339">ecosystem of both abuse and user error</span> <span data-start="724.339" data-end="727.329">on the part of developers where</span> <span data-start="727.329" data-end="731.87">developers would do things that weren't</span> <span data-start="731.87" data-end="734.3">in their best interest they would have</span> <span data-start="734.3" data-end="737.42">accidental vulnerabilities so in order</span> <span data-start="737.42" data-end="739.579">to address some of those we introduced</span> <span data-start="739.579" data-end="742.43">some stuff like a web accessible</span> <span data-start="742.43" data-end="744.559">resources field in your manifest JSON oh</span> </p>
<p><span data-start="744.559" data-end="747.62">I just realized I didn't actually go</span> <span data-start="747.62" data-end="749.029">over all the contents of a Chrome</span> <span data-start="749.029" data-end="750.769">extension we'll get into some details</span> <span data-start="750.769" data-end="751.639">later</span> <span data-start="751.639" data-end="753.98">so the main entry point of a Chrome</span> <span data-start="753.98" data-end="755.629">extension is manifest.json there's a</span> <span data-start="755.629" data-end="758.12">JSON file that defines the name of your</span> <span data-start="758.12" data-end="759.97">extension the current version what files</span> <span data-start="759.97" data-end="762.41">to run in the background what files to</span> <span data-start="762.41" data-end="768.11">inject into the page etc in manifest v2</span> <span data-start="768.11" data-end="770.269">it introduced this web accessible</span> <span data-start="770.269" data-end="773.3">resources so only resources that you</span> <span data-start="773.3" data-end="776.329">want to expose to the web context or</span> <span data-start="776.329" data-end="780.379">other places would actually appear or be</span> <span data-start="780.379" data-end="783.29">accessible and this was addressing a</span> <span data-start="783.29" data-end="785.629">common attack vector where people were</span> <span data-start="785.629" data-end="789.679">able to use signals that are leaked by</span> <span data-start="789.679" data-end="791.149">the extension in order to figure out</span> <span data-start="791.149" data-end="793.879">which extension is running and if</span> <span data-start="793.879" data-end="795.709">knowing the exploits available on that</span> <span data-start="795.709" data-end="796.94">extension could then</span> <span data-start="796.94" data-end="798.86">hook in and didn't do bad things to the</span> <span data-start="798.86" data-end="803.34">user</span> <span data-start="803.35" data-end="805.1">anything else I wanted to cover in that</span> <span data-start="805.1" data-end="810.02">nah again no platform is perfect there</span> <span data-start="810.02" data-end="813.77">were some issues here even as we tried</span> <span data-start="813.77" data-end="816.62">to plug some of these issues are some of</span> <span data-start="816.62" data-end="818.93">the exploits that existed one of which</span> <span data-start="818.93" data-end="821.75">was that if an extension in its</span> <span data-start="821.75" data-end="823.73">background page loaded an iframe of a</span> <span data-start="823.73" data-end="825.59">third-party website that third-party</span> <span data-start="825.59" data-end="828.11">website could use browser exploits to</span> <span data-start="828.11" data-end="829.64">gain control of the extension and</span> <span data-start="829.64" data-end="831.65">therefore have elevated privileges to do</span> <span data-start="831.65" data-end="834.92">bad things to the user the way that the</span> <span data-start="834.92" data-end="836.12">chrome team addressed this was by</span> <span data-start="836.12" data-end="837.89">separating the iframe process from the</span> <span data-start="837.89" data-end="840.74">extension process so they no longer</span> <span data-start="840.74" data-end="842.18">share the same memory and can't be</span> <span data-start="842.18" data-end="845.12">directly accessed more broadly site</span> <span data-start="845.12" data-end="847.28">isolation is something the extension</span> <span data-start="847.28" data-end="850.7">team and chrome team are very concerned</span> <span data-start="850.7" data-end="855.08">about we removed the ability to perform</span> <span data-start="855.08" data-end="857.66">inline installation so previously it was</span> <span data-start="857.66" data-end="859.85">possible to visit some website let's say</span> </p>
<p><span data-start="859.85" data-end="863.66">AFRICOM and to click the install Chrome</span> <span data-start="863.66" data-end="865.49">extension button and then suddenly you</span> <span data-start="865.49" data-end="867.41">would have the buffer extension</span> <span data-start="867.41" data-end="869.15">installed in your web browser of course</span> <span data-start="869.15" data-end="871.91">a malicious actor could have buffer with</span> <span data-start="871.91" data-end="875.33">three FS rather than to directly clone</span> <span data-start="875.33" data-end="877.4">their website clone their extension and</span> <span data-start="877.4" data-end="878.81">then add a little bit of more code that</span> <span data-start="878.81" data-end="881.33">allowed them to exploit the user and the</span> <span data-start="881.33" data-end="883.46">end user would be none the wiser</span> <span data-start="883.46" data-end="885.2">the end user thinks they're doing</span> <span data-start="885.2" data-end="886.46">everything correctly it appears that</span> <span data-start="886.46" data-end="888.22">they're doing everything correctly but</span> <span data-start="888.22" data-end="889.97">unfortunately they've just given</span> <span data-start="889.97" data-end="893.52">somebody else the keys to the kingdom</span> <span data-start="893.53" data-end="895.85">the final thing that I want to call out</span> <span data-start="895.85" data-end="897.23">in improvements that we've made to the</span> <span data-start="897.23" data-end="900.14">current extension platform is changing</span> <span data-start="900.14" data-end="901.88">it so that extensions that are loaded in</span> <span data-start="901.88" data-end="904.16">the browser the user has more control</span> <span data-start="904.16" data-end="907.73">over when and how they run so right here</span> </p>
<p><span data-start="907.73" data-end="911.42">I'm interacting with the posit google</span> <span data-start="911.42" data-end="914.03">dictionary extension which lets you</span> <span data-start="914.03" data-end="917.93">define terms on a page and I know that I</span> <span data-start="917.93" data-end="919.73">work with some sensitive data so I don't</span> <span data-start="919.73" data-end="921.74">want to expose every page that I visit</span> <span data-start="921.74" data-end="923.72">to it I only want to say expose</span> <span data-start="923.72" data-end="925.55">google.com in that case I can</span> <span data-start="925.55" data-end="927.8">right-click the extension go to this can</span> <span data-start="927.8" data-end="930.29">read and change data cite data and</span> <span data-start="930.29" data-end="933.11">then select the specific sites where I</span> <span data-start="933.11" data-end="935.18">want the extension to run or only run</span> <span data-start="935.18" data-end="936.68">the extension in response to clicking</span> <span data-start="936.68" data-end="939.41">the extensions browser action the icon</span> <span data-start="939.41" data-end="941.47">in the toolbar</span> <span data-start="941.47" data-end="943.82">the ultimate goal here is that we're</span> <span data-start="943.82" data-end="946.279">giving users more control this change</span> <span data-start="946.279" data-end="950.18">was made in chrome 70 and in the future</span> <span data-start="950.18" data-end="951.589">we're planning to change it so by</span> <span data-start="951.589" data-end="953.81">default when you install an extension it</span> <span data-start="953.81" data-end="956.48">will not default to all sites that will</span> <span data-start="956.48" data-end="958.16">default to the most limited set of</span> <span data-start="958.16" data-end="963.199">capabilities now I talked about some of</span> <span data-start="963.199" data-end="964.97">the things that we've done to address</span> <span data-start="964.97" data-end="967.279">limitations of manifest v2 but there are</span> <span data-start="967.279" data-end="969.11">other things that we can't quite address</span> <span data-start="969.11" data-end="972.23">here for one there's not enough focus on</span> <span data-start="972.23" data-end="975.319">usability when the chrome team designed</span> <span data-start="975.319" data-end="978.38">the extension interaction patterns the</span> <span data-start="978.38" data-end="981.17">the platform there was a fundamental</span> <span data-start="981.17" data-end="983.839">assumption about how users interact with</span> <span data-start="983.839" data-end="988.13">install prompts and I think in the</span> <span data-start="988.13" data-end="989.66">assumption that people read all the</span> <span data-start="989.66" data-end="992.209">words and understand them and make</span> <span data-start="992.209" data-end="995.48">informed decisions that's not always</span> <span data-start="995.48" data-end="999.29">true unfortunately I think in the</span> <span data-start="999.29" data-end="1001.209">intervening years we've seen that users</span> <span data-start="1001.209" data-end="1005.17">don't quite understand what read and</span> <span data-start="1005.17" data-end="1007.42">modify all site data means for example</span> <span data-start="1007.42" data-end="1010.72">and that's an extremely common thing</span> <span data-start="1010.72" data-end="1013.209">because all URLs is extremely common in</span> <span data-start="1013.209" data-end="1015.97">the extension ecosystem the all URLs</span> <span data-start="1015.97" data-end="1018.73">permission allows an extension to eject</span> <span data-start="1018.73" data-end="1021.699">content scripts on any site that you</span> <span data-start="1021.699" data-end="1024.64">visit and in some cases to kind of</span> <span data-start="1024.64" data-end="1026.409">supercharge other api's that the browser</span> <span data-start="1026.409" data-end="1030.72">exposes so the tabs API for example</span> <span data-start="1030.72" data-end="1033.819">actually tabs is a bad example ignore</span> <span data-start="1033.819" data-end="1037.299">that pretend I didn't say that but in</span> <span data-start="1037.299" data-end="1038.89">general all URLs is too common it is</span> <span data-start="1038.89" data-end="1040.949">very powerful permission it is</span> <span data-start="1040.949" data-end="1043.419">unfortunately currently the only way to</span> <span data-start="1043.419" data-end="1045.429">do some things like passively inject UI</span> <span data-start="1045.429" data-end="1049.96">into a page and when it's too common</span> <span data-start="1049.96" data-end="1052.179">that means that we can't detect</span> <span data-start="1052.179" data-end="1054.82">anomalous use of this permission because</span> <span data-start="1054.82" data-end="1059.799">everybody requests it one of the major</span> <span data-start="1059.799" data-end="1062.049">things that has been in the news and the</span> <span data-start="1062.049" data-end="1064.539">recently is that remote code injection</span> <span data-start="1064.539" data-end="1066.759">in an extension is currently allowed and</span> <span data-start="1066.759" data-end="1069.309">it's kind of a problem but it's a</span> <span data-start="1069.309" data-end="1070.629">problem that we don't think we can</span> <span data-start="1070.629" data-end="1074.019">address on the manifest v2 platform</span> <span data-start="1074.019" data-end="1075.849">because it breaks some fundamental</span> <span data-start="1075.849" data-end="1077.619">assumptions about how extensions work so</span> <span data-start="1077.619" data-end="1080.289">that's why it's going into this this</span> <span data-start="1080.289" data-end="1086.559">platform version bump if effectively if</span> <span data-start="1086.559" data-end="1088.719">a code if an extension loads code that</span> <span data-start="1088.719" data-end="1090.249">isn't bundled in the extensions</span> <span data-start="1090.249" data-end="1093.549">executable then it can do anything at</span> <span data-start="1093.549" data-end="1095.919">any time and we can't know about it or</span> <span data-start="1095.919" data-end="1100.269">react to it very well in fact the thing</span> <span data-start="1100.269" data-end="1101.649">that it does today might not be the same</span> <span data-start="1101.649" data-end="1102.879">thing as it does tomorrow or the thing</span> <span data-start="1102.879" data-end="1104.529">that it does for me might be the same as</span> <span data-start="1104.529" data-end="1106.419">it does for you which is I think a</span> <span data-start="1106.419" data-end="1109.69">pretty bad world to be in I mentioned</span> <span data-start="1109.69" data-end="1111.879">this a bit in discussion of all URLs</span> <span data-start="1111.879" data-end="1114.58">powerful api's are currently your only</span> <span data-start="1114.58" data-end="1117.599">option for a lot of capabilities that is</span> <span data-start="1117.599" data-end="1120.759">for a content blocker say in order to</span> <span data-start="1120.759" data-end="1122.889">allow a content blocker to block a</span> <span data-start="1122.889" data-end="1126.399">website I have to give that that content</span> <span data-start="1126.399" data-end="1129.129">blocker access to the websites that I</span> <span data-start="1129.129" data-end="1132.19">want to block which means that it could</span> <span data-start="1132.19" data-end="1134.889">potentially perform who-knows-what</span> <span data-start="1134.889" data-end="1137.349">actions on those sites without my</span> <span data-start="1137.349" data-end="1142.779">knowledge or consent this is more of a</span> <span data-start="1142.779" data-end="1144.669">chrome issue but extensions can tank</span> <span data-start="1144.669" data-end="1146.379">performance and in tank it in a way</span> <span data-start="1146.379" data-end="1147.729">that's not terribly obvious to the</span> <span data-start="1147.729" data-end="1152.019">end-user so by a developer not coding an</span> <span data-start="1152.019" data-end="1155.399">extension in a performant way they can</span> <span data-start="1155.399" data-end="1157.539">unintentionally make the entire browser</span> <span data-start="1157.539" data-end="1159.009">experience significantly worse and</span> <span data-start="1159.009" data-end="1162.009">finally users don't have enough control</span> <span data-start="1162.009" data-end="1164.589">over their experience we address some of</span> <span data-start="1164.589" data-end="1166.239">this or now trying to work through this</span> <span data-start="1166.239" data-end="1169.179">with the upcoming change I mentioned to</span> <span data-start="1169.179" data-end="1172.979">default to restricting all URLs to only</span> <span data-start="1172.979" data-end="1177.7">unclick but that that again is going to</span> <span data-start="1177.7" data-end="1179.259">require a version font in order to</span> <span data-start="1179.259" data-end="1182.649">actually tackle so I think it's fair to</span> <span data-start="1182.649" data-end="1185.559">say that we are not in a situation that</span> <span data-start="1185.559" data-end="1187.629">we want to be that the extension</span> <span data-start="1187.629" data-end="1190.869">platform is more vulnerable kind of by</span> <span data-start="1190.869" data-end="1193.479">design than it should be and to that end</span> <span data-start="1193.479" data-end="1195.73">we're introducing manifest weak</span> <span data-start="1195.73" data-end="1198.37">which will shift some of these basic</span> <span data-start="1198.37" data-end="1200.039">assumptions about how the platform works</span> <span data-start="1200.039" data-end="1203.98">so the broad strokes the goals of</span> <span data-start="1203.98" data-end="1206.139">manifest v3 are to improve the security</span> <span data-start="1206.139" data-end="1208.12">privacy and performance of the Chrome</span> <span data-start="1208.12" data-end="1211.45">extensions platform for security we want</span> <span data-start="1211.45" data-end="1213.61">to improve the security guarantees that</span> <span data-start="1213.61" data-end="1216.94">is we want to be able to say with</span> <span data-start="1216.94" data-end="1219.19">confidence that it is significantly</span> <span data-start="1219.19" data-end="1220.99">harder or impossible for a malicious</span> <span data-start="1220.99" data-end="1222.94">site or extension to gain control of</span> <span data-start="1222.94" data-end="1226.149">these privileged execution environments</span> <span data-start="1226.149" data-end="1229.269">and by extension to increase end-user</span> <span data-start="1229.269" data-end="1231.61">trust that when they extol in an</span> <span data-start="1231.61" data-end="1233.049">extension it isn't going to do anything</span> <span data-start="1233.049" data-end="1235.659">harmful to them without their without</span> <span data-start="1235.659" data-end="1239.08">their direct involvement and that they</span> <span data-start="1239.08" data-end="1240.789">can easily remove an extension and it</span> <span data-start="1240.789" data-end="1244.019">won't cause any lasting harm for privacy</span> <span data-start="1244.019" data-end="1246.37">we want users to have more control over</span> <span data-start="1246.37" data-end="1250.99">their experience so for privacy we we</span> <span data-start="1250.99" data-end="1252.46">want the user to have more control over</span> <span data-start="1252.46" data-end="1255.159">what sites and extension is executing on</span> <span data-start="1255.159" data-end="1258.01">and part of that is going to be a shift</span> <span data-start="1258.01" data-end="1260.62">in or trying to encourage developers to</span> <span data-start="1260.62" data-end="1264.01">shift how they expect their extensions</span> <span data-start="1264.01" data-end="1266.049">to run rather than passively running all</span> <span data-start="1266.049" data-end="1268.6">the time we want extensions to move to a</span> <span data-start="1268.6" data-end="1270.549">model where they're running in response</span> <span data-start="1270.549" data-end="1272.889">to user action so the user is ultimately</span> <span data-start="1272.889" data-end="1275.289">the one that's in control and for</span> <span data-start="1275.289" data-end="1278.169">performance extensions we want</span> <span data-start="1278.169" data-end="1279.73">extensions to be performed by default we</span> <span data-start="1279.73" data-end="1280.99">want developers to fall into a pit of</span> <span data-start="1280.99" data-end="1283">success where even if they don't know</span> <span data-start="1283" data-end="1284.35">what they're doing and they do some</span> <span data-start="1284.35" data-end="1287.159">anti-patterns worst case scenario that</span> <span data-start="1287.159" data-end="1289.57">things will kind of work out for them</span> <span data-start="1289.57" data-end="1294.49">anyway and by extension reducing the</span> <span data-start="1294.49" data-end="1296.019">amount of resources that an extension is</span> <span data-start="1296.019" data-end="1300.5">using over over the course of its life</span> <span data-start="1300.51" data-end="1304.179">so at this point I want to get a bit</span> <span data-start="1304.179" data-end="1306.279">into the specifics of some of these</span> <span data-start="1306.279" data-end="1309.36">changes runtime host permissions that is</span> <span data-start="1309.36" data-end="1313.919">the ability to inject script into a site</span> <span data-start="1313.919" data-end="1317.98">we want to as I said move to clicked by</span> <span data-start="1317.98" data-end="1320.289">default we have a permissions in the</span> </p>
<p><span data-start="1320.289" data-end="1322.269">Chrome extension platform called active</span> <span data-start="1322.269" data-end="1323.909">tab that</span> <span data-start="1323.909" data-end="1326.129">browser can or an extension can</span> <span data-start="1326.129" data-end="1330.179">currently choose to opt into active tab</span> <span data-start="1330.179" data-end="1332.579">style permissions where when somebody</span> <span data-start="1332.579" data-end="1334.619">clicks a browser action or hits a global</span> <span data-start="1334.619" data-end="1336.659">keyboard shortcut or hits the omnibox</span> <span data-start="1336.659" data-end="1337.979">shortcut that they've read in a store</span> </p>
<p><span data-start="1337.979" data-end="1340.229">Tory triggers the context menu entry</span> <span data-start="1340.229" data-end="1342.389">those are the four ways that you can get</span> <span data-start="1342.389" data-end="1345.329">active tab only then does the extension</span> <span data-start="1345.329" data-end="1347.909">have the ability to run and for</span> <span data-start="1347.909" data-end="1350.999">extensions that do require or need to</span> <span data-start="1350.999" data-end="1352.859">passively inject there will be a way to</span> <span data-start="1352.859" data-end="1354.629">do that but it isn't going to be the</span> <span data-start="1354.629" data-end="1356.369">primary way that most extensions are</span> <span data-start="1356.369" data-end="1359.129">expected to operate this is challenging</span> <span data-start="1359.129" data-end="1361.499">though because it is a shift in the</span> <span data-start="1361.499" data-end="1365.339">extension architecture it will require</span> <span data-start="1365.339" data-end="1366.839">developers to make it a shift in their</span> <span data-start="1366.839" data-end="1368.999">architecture in order to be more evented</span> <span data-start="1368.999" data-end="1371.819">and more contextual so again in the</span> <span data-start="1371.819" data-end="1373.889">future when you click the extension will</span> <span data-start="1373.889" data-end="1376.619">be the default option at install time</span> <span data-start="1376.619" data-end="1378.659">they're still working on the UI for this</span> <span data-start="1378.659" data-end="1381.359">but at install time it will have an</span> <span data-start="1381.359" data-end="1384.989">option it will present the user with an</span> <span data-start="1384.989" data-end="1386.099">option that says when you click the</span> <span data-start="1386.099" data-end="1387.659">extension and they will have a way of</span> <span data-start="1387.659" data-end="1390.509">changing that to to automatically run on</span> <span data-start="1390.509" data-end="1393.089">all sites or on specific sites and then</span> <span data-start="1393.089" data-end="1394.919">developers will also have a way of</span> <span data-start="1394.919" data-end="1396.659">checking their current permissions and</span> <span data-start="1396.659" data-end="1399.539">then re prompting the user if they don't</span> <span data-start="1399.539" data-end="1401.459">have enough if they can't do their job</span> <span data-start="1401.459" data-end="1405.389">basically another significant change</span> <span data-start="1405.389" data-end="1407.519">that we're making is replacing the web</span> <span data-start="1407.519" data-end="1409.559">request block the blocking version of</span> <span data-start="1409.559" data-end="1411.389">the web request API with a new API</span> <span data-start="1411.389" data-end="1414.929">called declarative net request for the</span> <span data-start="1414.929" data-end="1417.679">most part most of the capabilities of</span> <span data-start="1417.679" data-end="1420.509">declarative net request api don't</span> <span data-start="1420.509" data-end="1422.039">actually require host permissions so</span> <span data-start="1422.039" data-end="1424.229">again we're limiting the potential</span> <span data-start="1424.229" data-end="1426.269">vulnerabilities and attack vectors by</span> <span data-start="1426.269" data-end="1428.879">just giving extensions less right out of</span> <span data-start="1428.879" data-end="1432.629">the gate but fundamentally web request</span> <span data-start="1432.629" data-end="1434.009">is more capable because it's a</span> <span data-start="1434.009" data-end="1436.049">imperative API you can literally what</span> <span data-start="1436.049" data-end="1439.169">write whatever code you want and it will</span> <span data-start="1439.169" data-end="1440.999">do it whereas the declarative net</span> <span data-start="1440.999" data-end="1443.249">request API it's declarative so there's</span> <span data-start="1443.249" data-end="1444.869">a limited set of capabilities that you</span> <span data-start="1444.869" data-end="1449.219">can actually execute one of the benefits</span> <span data-start="1449.219" data-end="1450.749">to this from a performance point of view</span> <span data-start="1450.749" data-end="1453.449">is we're getting extensions out of the</span> <span data-start="1453.449" data-end="1455.429">web request flow which means we can</span> <span data-start="1455.429" data-end="1457.93">heavily optimize how</span> <span data-start="1457.93" data-end="1462.08">how network requests are processed by</span> <span data-start="1462.08" data-end="1464.69">extensions currently it takes several</span> <span data-start="1464.69" data-end="1466.94">process hops in order for an extension</span> <span data-start="1466.94" data-end="1470.69">to even get notified that that a request</span> <span data-start="1470.69" data-end="1472.13">is being made and then they have to</span> <span data-start="1472.13" data-end="1475.61">exceed some logic and then pass it back</span> <span data-start="1475.61" data-end="1476.93">to Chrome which takes a couple more</span> <span data-start="1476.93" data-end="1479.6">process hops all of this is potentially</span> <span data-start="1479.6" data-end="1481.37">you know depending on the implementation</span> <span data-start="1481.37" data-end="1483.44">details potentially all able to be</span> <span data-start="1483.44" data-end="1485.24">executed on the network thread meaning</span> <span data-start="1485.24" data-end="1486.95">there's no additional hops that just</span> <span data-start="1486.95" data-end="1488.84">happens immediately as soon as chrome</span> <span data-start="1488.84" data-end="1492.59">executes side so a quick example I'm</span> <span data-start="1492.59" data-end="1495.38">gonna say I have been known to spend too</span> <span data-start="1495.38" data-end="1496.85">much time on Facebook so when I'm at</span> <span data-start="1496.85" data-end="1498.68">work I just don't want it to be</span> <span data-start="1498.68" data-end="1500.45">available at all so I'm going to have a</span> <span data-start="1500.45" data-end="1503.39">simple extension here that requires the</span> <span data-start="1503.39" data-end="1506.12">web request API the request blocking API</span> <span data-start="1506.12" data-end="1510.95">and access to facebook.com so this is</span> <span data-start="1510.95" data-end="1512.39">the manifest.json i mentioned earlier</span> <span data-start="1512.39" data-end="1513.92">and you can see I have a background</span> <span data-start="1513.92" data-end="1516.41">script that I'm going to passively load</span> <span data-start="1516.41" data-end="1519.2">and have running my background script is</span> <span data-start="1519.2" data-end="1522.23">going to receive a details object or a</span> <span data-start="1522.23" data-end="1524.45">request object that contains details</span> <span data-start="1524.45" data-end="1527.15">about the request so this is kind of the</span> <span data-start="1527.15" data-end="1529.19">passive data that's being exposed to the</span> <span data-start="1529.19" data-end="1533.66">extension so any in in this simple</span> <span data-start="1533.66" data-end="1536.36">example anytime I see a request going to</span> <span data-start="1536.36" data-end="1539.42">facebook.com I'm gonna return a object</span> <span data-start="1539.42" data-end="1541.55">that says cancel so the can't request</span> <span data-start="1541.55" data-end="1544.1">will be blocked and otherwise don't do</span> <span data-start="1544.1" data-end="1546.23">any special modification and that's the</span> <span data-start="1546.23" data-end="1548.18">super simple extension the way this</span> <span data-start="1548.18" data-end="1549.65">would look in the declarative net</span> <span data-start="1549.65" data-end="1551.81">requests world is we replace all those</span> <span data-start="1551.81" data-end="1553.43">permissions with a simple one</span> <span data-start="1553.43" data-end="1554.93">declarative net request with no</span> <span data-start="1554.93" data-end="1557.75">additional host permissions no</span> <span data-start="1557.75" data-end="1560.8">additional ability to inject content and</span> <span data-start="1560.8" data-end="1564.77">we're we now have a rules JSON which</span> <span data-start="1564.77" data-end="1567.35">will define the network request</span> <span data-start="1567.35" data-end="1569.39">modification rules that Chrome will</span> <span data-start="1569.39" data-end="1572.96">execute our rules list is pretty simple</span> <span data-start="1572.96" data-end="1575.06">all we're gonna do is if we see a</span> <span data-start="1575.06" data-end="1576.8">request for facebook.com we're gonna</span> <span data-start="1576.8" data-end="1580.75">take the action block that's it</span> <span data-start="1580.76" data-end="1582.56">another major change that is happening</span> <span data-start="1582.56" data-end="1585.02">in chrome manifest v3 is the migration</span> <span data-start="1585.02" data-end="1589.25">from background pages to serviceworkers</span> <span data-start="1589.25" data-end="1590.93">so if you're not familiar with the exten</span> <span data-start="1590.93" data-end="1592.64">and platform the way it currently works</span> <span data-start="1592.64" data-end="1595.43">is if you have when you create an</span> <span data-start="1595.43" data-end="1597.56">extension one of the core pieces that</span> <span data-start="1597.56" data-end="1599.39">you have is a background page or</span> <span data-start="1599.39" data-end="1601.16">background script which has a page</span> <span data-start="1601.16" data-end="1602.69">environment so you you're literally</span> <span data-start="1602.69" data-end="1604.85">running an entire web page headless it</span> <span data-start="1604.85" data-end="1607.37">just doesn't render anything which means</span> <span data-start="1607.37" data-end="1608.6">that you have the full capabilities of</span> <span data-start="1608.6" data-end="1610.04">the web in terms of being able to place</span> <span data-start="1610.04" data-end="1614.45">a audio or being able to use event</span> <span data-start="1614.45" data-end="1617.9">propagation natively in your background</span> <span data-start="1617.9" data-end="1620.18">page in the future we're moving to</span> <span data-start="1620.18" data-end="1623.33">service workers which are web technology</span> <span data-start="1623.33" data-end="1624.53">that's emerging kind of under the</span> <span data-start="1624.53" data-end="1628.04">progressive Web App banner and it allows</span> <span data-start="1628.04" data-end="1631.73">you to have a more ephemeral execution</span> <span data-start="1631.73" data-end="1634.28">environment where your service worker</span> <span data-start="1634.28" data-end="1636.47">gets woken up in response to events it</span> <span data-start="1636.47" data-end="1638.06">has some time that it can execute and</span> <span data-start="1638.06" data-end="1639.35">then when it's no longer doing anything</span> <span data-start="1639.35" data-end="1642.11">it just gets terminated and then frees</span> <span data-start="1642.11" data-end="1647.69">up the resources so this service worker</span> <span data-start="1647.69" data-end="1650.3">environment is extremely similar to the</span> <span data-start="1650.3" data-end="1653.14">current event page system you can have</span> <span data-start="1653.14" data-end="1655.64">today in manifest v2 you can have two</span> <span data-start="1655.64" data-end="1657.14">types of background pages you can have a</span> <span data-start="1657.14" data-end="1659.69">persistent page which lives forever or</span> <span data-start="1659.69" data-end="1661.67">you can have an event page which is only</span> <span data-start="1661.67" data-end="1664.84">woken up in response to events in</span> <span data-start="1664.84" data-end="1666.89">general this is kind of a pattern of</span> <span data-start="1666.89" data-end="1669.17">chrome trying to provide more performant</span> <span data-start="1669.17" data-end="1671.54">options but most people fall back on the</span> <span data-start="1671.54" data-end="1673.73">less performant version so event pages</span> <span data-start="1673.73" data-end="1675.44">have not been as well adopted as we</span> <span data-start="1675.44" data-end="1678.62">would like part of the move to service</span> <span data-start="1678.62" data-end="1680.33">workers is just cleaning up to hit use a</span> <span data-start="1680.33" data-end="1682.58">standardized use the standards that the</span> <span data-start="1682.58" data-end="1684.5">web platform exposes since Chrome</span> <span data-start="1684.5" data-end="1686.18">extensions are webby we want to use the</span> <span data-start="1686.18" data-end="1688.37">web as our default environment with only</span> <span data-start="1688.37" data-end="1690.08">the modifications required to enable</span> <span data-start="1690.08" data-end="1692.6">extensions so some of the challenges</span> <span data-start="1692.6" data-end="1694.37">that this move is going to present to</span> <span data-start="1694.37" data-end="1696.41">developers is they don't have access to</span> <span data-start="1696.41" data-end="1698.15">dom with all of the capabilities that</span> <span data-start="1698.15" data-end="1702.32">involves it requires a more event based</span> <span data-start="1702.32" data-end="1704.27">approach to application development</span> <span data-start="1704.27" data-end="1706.9">which you may or may not currently be</span> <span data-start="1706.9" data-end="1710.93">doing and given that you no longer have</span> <span data-start="1710.93" data-end="1712.91">a persistent global environment you can</span> <span data-start="1712.91" data-end="1715.79">no longer have state sitting there</span> <span data-start="1715.79" data-end="1719.87">passively exposed so let's take a look</span> <span data-start="1719.87" data-end="1723.95">at a couple of examples i am i have a</span> <span data-start="1723.95" data-end="1725.309">simple</span> </p>
<p><span data-start="1725.309" data-end="1728.86">X I have a simple extension here that</span> <span data-start="1728.86" data-end="1730.99">basically is just gonna pass a message</span> <span data-start="1730.99" data-end="1732.49">to the content script that will display</span> <span data-start="1732.49" data-end="1735.13">somebody's name I think in this these</span> <span data-start="1735.13" data-end="1736.66">code samples I left out the content</span> <span data-start="1736.66" data-end="1737.77">script because it's not that important</span> <span data-start="1737.77" data-end="1739.72">but basically it just has a message</span> <span data-start="1739.72" data-end="1741.94">handler that receives a name and then</span> <span data-start="1741.94" data-end="1743.59">logs it nothing fancy</span> <span data-start="1743.59" data-end="1747.19">so here the extension currently has</span> <span data-start="1747.19" data-end="1749.53">persistent persistent true if you don't</span> <span data-start="1749.53" data-end="1751.99">explicitly specify persistent false it</span> <span data-start="1751.99" data-end="1755.86">is by default true and then our</span> <span data-start="1755.86" data-end="1758.98">background script basically if we get a</span> <span data-start="1758.98" data-end="1763.09">message that that sets the user's name</span> <span data-start="1763.09" data-end="1765.87">then we'll set the global name variable</span> <span data-start="1765.87" data-end="1768.16">to whatever them name is that we</span> <span data-start="1768.16" data-end="1771.01">received and then when you click the</span> <span data-start="1771.01" data-end="1772.9">browser action button the icon in your</span> <span data-start="1772.9" data-end="1776.32">the Chrome window then we will send the</span> <span data-start="1776.32" data-end="1778.27">name to the the content script that's</span> <span data-start="1778.27" data-end="1779.799">all that's happening here it's not</span> <span data-start="1779.799" data-end="1782.41">terribly fancy the problem that we're</span> <span data-start="1782.41" data-end="1784.54">gonna have with this in the migration to</span> <span data-start="1784.54" data-end="1786.34">manifest b3 is we're not gonna have</span> <span data-start="1786.34" data-end="1788.44">global state anymore so in order to work</span> <span data-start="1788.44" data-end="1790.24">around that we need to tweak it a little</span> <span data-start="1790.24" data-end="1792.49">bit here we're explicitly calling out</span> <span data-start="1792.49" data-end="1794.32">that persistent is false so now we're</span> <span data-start="1794.32" data-end="1798.13">using an event page and rather than</span> <span data-start="1798.13" data-end="1799.66">having a global variable that we're</span> <span data-start="1799.66" data-end="1801.549">reading and writing we're using chrome</span> <span data-start="1801.549" data-end="1804.58">storage sync to set the user's name when</span> <span data-start="1804.58" data-end="1807.7">they pass it in and we're using criminal</span> <span data-start="1807.7" data-end="1809.59">storage that same tacit to retrieve the</span> <span data-start="1809.59" data-end="1812.53">user's name when when we want to send</span> <span data-start="1812.53" data-end="1815.5">the message to the background page so</span> <span data-start="1815.5" data-end="1818.98">this is basically shifting from global</span> <span data-start="1818.98" data-end="1821.62">state sort in JavaScript to state stored</span> <span data-start="1821.62" data-end="1826.09">in a persistent place the next step in</span> <span data-start="1826.09" data-end="1828.73">the migration is going to be changing</span> <span data-start="1828.73" data-end="1832.57">from an event page to a serviceworker so</span> <span data-start="1832.57" data-end="1835.63">here we have a script it's a single</span> <span data-start="1835.63" data-end="1837.49">person a background page or a single non</span> <span data-start="1837.49" data-end="1839.65">persistent background page here we're</span> <span data-start="1839.65" data-end="1841.419">explicitly declaring a serviceworker and</span> <span data-start="1841.419" data-end="1843.85">it's worth noting here that in the</span> <span data-start="1843.85" data-end="1847.24">introduction of serviceworkers you will</span> <span data-start="1847.24" data-end="1848.38">be able to use service workers with</span> <span data-start="1848.38" data-end="1852.4">manifest v2 this is intended to help</span> <span data-start="1852.4" data-end="1854.559">developers migrate from the current</span> <span data-start="1854.559" data-end="1856.21">platform to the the new version that</span> <span data-start="1856.21" data-end="1858.79">we're going to be using</span> <span data-start="1858.79" data-end="1861.73">the third and I think final change that</span> </p>
<p><span data-start="1861.73" data-end="1862.9">I want to call out is remotely hosted</span> <span data-start="1862.9" data-end="1866.77">code as I said we're not going to allow</span> <span data-start="1866.77" data-end="1869.62">you to execute code that isn't part of</span> <span data-start="1869.62" data-end="1870.73">your extension bundle in the</span> <span data-start="1870.73" data-end="1873.28">not-too-distant future one of the</span> <span data-start="1873.28" data-end="1875.14">challenges that this is going to prevent</span> <span data-start="1875.14" data-end="1877.57">to developers is that it limits the</span> <span data-start="1877.57" data-end="1880.09">dynamism that you can have some people</span> <span data-start="1880.09" data-end="1882.04">are currently using this to not ill</span> <span data-start="1882.04" data-end="1884.5">affect like they're doing good things by</span> <span data-start="1884.5" data-end="1886.45">delivering updates very quickly to users</span> <span data-start="1886.45" data-end="1890.65">or to a be test and make sure that their</span> <span data-start="1890.65" data-end="1892.42">extension is performing as well as it</span> <span data-start="1892.42" data-end="1898.15">can in order to adapt to this developers</span> <span data-start="1898.15" data-end="1899.71">are essentially going to need to bundle</span> <span data-start="1899.71" data-end="1902.97">their third-party code into the art</span> <span data-start="1902.97" data-end="1904.99">bundle the resources that they want to</span> <span data-start="1904.99" data-end="1906.58">load at runtime bundle that into the</span> <span data-start="1906.58" data-end="1908.16">extension and load it from the extension</span> <span data-start="1908.16" data-end="1912.7">so here we're doing a simple incredibly</span> <span data-start="1912.7" data-end="1914.38">simple thing where we have a content</span> <span data-start="1914.38" data-end="1916.51">script that is just going to inject</span> <span data-start="1916.51" data-end="1919.93">jQuery onto the page and as you could</span> <span data-start="1919.93" data-end="1921.73">see we're loading jQuery from the</span> <span data-start="1921.73" data-end="1926.05">official jQuery website all this content</span> <span data-start="1926.05" data-end="1928.3">script does is create an element assign</span> <span data-start="1928.3" data-end="1930.25">the appropriate attributes and then</span> <span data-start="1930.25" data-end="1933.7">append it to the parent document in the</span> <span data-start="1933.7" data-end="1935.98">new world we're going to need to</span> <span data-start="1935.98" data-end="1938.32">explicitly expose the jQuery library</span> <span data-start="1938.32" data-end="1940.6">using web accessible resources and we're</span> <span data-start="1940.6" data-end="1942.1">bundling the library with our extension</span> <span data-start="1942.1" data-end="1945.07">and then when we want to inject it we</span> <span data-start="1945.07" data-end="1948.13">just use chrome runtime get URL to</span> <span data-start="1948.13" data-end="1952.9">retrieve a a URL in order to load the</span> <span data-start="1952.9" data-end="1955.12">specific file the rest is basically the</span> <span data-start="1955.12" data-end="1959.2">same and with that I just want to</span> <span data-start="1959.2" data-end="1961.57">quickly go through the the major changes</span> <span data-start="1961.57" data-end="1964.03">again to the extension platform we're</span> <span data-start="1964.03" data-end="1965.71">trying to move towards an active tab</span> <span data-start="1965.71" data-end="1968.44">style set of permissions so users are in</span> <span data-start="1968.44" data-end="1970.74">control of when the extension is running</span> <span data-start="1970.74" data-end="1974.62">we're moving away from API is that</span> <span data-start="1974.62" data-end="1976.84">leaked data like web requests in order</span> <span data-start="1976.84" data-end="1980.41">to make sure that as little information</span> <span data-start="1980.41" data-end="1982.15">as being exposed to the extension as</span> <span data-start="1982.15" data-end="1984.49">reasonably possible the web requests</span> <span data-start="1984.49" data-end="1986.74">change here is the first of many steps</span> <span data-start="1986.74" data-end="1989.77">in this direction but I think in future</span> <span data-start="1989.77" data-end="1990.88">versions of the</span> <span data-start="1990.88" data-end="1992.38">platform and additional changes in</span> <span data-start="1992.38" data-end="1994.93">manifest v2 or manifest v3 you can</span> <span data-start="1994.93" data-end="1996.88">expect that we're gonna be trying to</span> <span data-start="1996.88" data-end="1997.72">tighten up</span> <span data-start="1997.72" data-end="1999.79">how and when extensions are running and</span> <span data-start="1999.79" data-end="2001.52">what data they're getting access to and</span> <span data-start="2001.52" data-end="2005.55">finally we're replacing a weight this</span> <span data-start="2005.55" data-end="2008.43">there is a fourth one we're replacing</span> <span data-start="2008.43" data-end="2009.93">background pages with service workers</span> <span data-start="2009.93" data-end="2012.15">and that's going to have some impact on</span> <span data-start="2012.15" data-end="2014.91">how extensions are architected and how</span> <span data-start="2014.91" data-end="2016.62">they approach the job that they're doing</span> <span data-start="2016.62" data-end="2019.14">and finally we're removing the ability</span> <span data-start="2019.14" data-end="2020.88">to run remotely hosted code through a</span> <span data-start="2020.88" data-end="2022.53">combination of platform API level</span> <span data-start="2022.53" data-end="2025.73">changes and chrome Chrome Web Store</span> <span data-start="2025.73" data-end="2030.99">policy changes if you are interested in</span> <span data-start="2030.99" data-end="2032.43">continuing to dig into the extension</span> <span data-start="2032.43" data-end="2034.08">ecosystem I'd recommend checking out the</span> </p>
<p><span data-start="2034.08" data-end="2037.53">Google Chrome or Chrome extensions</span> <span data-start="2037.53" data-end="2040.8">google group and also checking out the</span> <span data-start="2040.8" data-end="2043.41">manifest v3 design document the design</span> <span data-start="2043.41" data-end="2045.63">document is public like almost all</span> <span data-start="2045.63" data-end="2047.85">chrome design documents and the</span> <span data-start="2047.85" data-end="2050.31">intention is to this is the launching</span> <span data-start="2050.31" data-end="2051.6">off point this isn't a definitive</span> <span data-start="2051.6" data-end="2053.52">document but it's the starting point</span> <span data-start="2053.52" data-end="2054.929">from which the team is starting to work</span> <span data-start="2054.929" data-end="2058.72">to actually implement these features</span> <span data-start="2058.73" data-end="2061.5">finally if you have any feedback on this</span> <span data-start="2061.5" data-end="2063.659">stuff as the extensions developer</span> <span data-start="2063.659" data-end="2064.139">advocate</span> </p>
<p><span data-start="2064.139" data-end="2065.669">I am extremely interested in it so</span> <span data-start="2065.669" data-end="2068.25">please tell me so I can help make the</span> <span data-start="2068.25" data-end="2070.02">extensions platform as good as possible</span> <span data-start="2070.02" data-end="2071.81">for you and for everyone else</span> <span data-start="2071.81" data-end="2073.889">again the chromium extension Google</span> <span data-start="2073.889" data-end="2075">group or if you want to reach out to me</span> <span data-start="2075" data-end="2075.419">directly</span> </p>
<p><span data-start="2075.419" data-end="2078.21">I'm dot proto on Twitter and you can</span> <span data-start="2078.21" data-end="2080.46">also schedule office hours to do a one</span> <span data-start="2080.46" data-end="2084.06">on one video based session or phone call</span> <span data-start="2084.06" data-end="2087.629">with me using the bitly link here and</span> <span data-start="2087.629" data-end="2089.73">that is it thank you very much</span> <span data-start="2089.73" data-end="2093.3">[Applause]</span> </p>
</section>