<section>
<p><span data-start="14.87" data-end="15.87">Thanks, everyone.</span> <span data-start="15.87" data-end="16.87">So..</span> <span data-start="16.87" data-end="17.87">My name is Parsha.</span> <span data-start="17.87" data-end="20.12">I'm going to talk to you guys about mixing JavaScript and CSS.</span> <span data-start="20.12" data-end="21.12">So..</span> <span data-start="21.12" data-end="27.57">Before I start, I want to warn you.</span> <span data-start="27.57" data-end="31.689">This talk is about ideas, not code.</span> <span data-start="31.689" data-end="35.14">Even though I'm going to be showing you a lot of code, I'm not necessarily saying</span> <span data-start="35.14" data-end="40.48">it's a good idea or that it'll even work.</span> </p>
<p><span data-start="40.48" data-end="44.65">My goal here is to share some ideas and get you guys thinking.</span> <span data-start="44.65" data-end="46.86">So if you hear anything that you think is awesome</span> <span data-start="46.86" data-end="51.01">and might solve your problems, or if you think I'm totally crazy, then you</span> <span data-start="51.01" data-end="53.91">should come find me and tell me about it.</span> <span data-start="53.91" data-end="55.329">So..</span> <span data-start="55.329" data-end="61.23">Before we talk about JavaScript, let's talk about CSS.</span> <span data-start="61.23" data-end="67.61">CSS enables us to take websites that look like this, and</span> <span data-start="67.61" data-end="70.76">turn them into this.</span> <span data-start="70.76" data-end="73.79">CSS even makes Craigslist look better.</span> <span data-start="73.79" data-end="76.27">Going from this to this.</span> <span data-start="76.27" data-end="83.71">I didn't even think Craigslist used CSS.</span> <span data-start="83.71" data-end="87.44">Aside from enabling rich user interfaces, CSS also lets</span> <span data-start="87.44" data-end="95.5">us create cool animations and visual effects.</span> <span data-start="95.5" data-end="96.5">Like whatever this is.</span> </p>
<p><span data-start="96.5" data-end="98.82">It's not showing up on the projector.</span> <span data-start="98.82" data-end="103.06">So I'll show you on my screen.</span> <span data-start="103.06" data-end="107.41">It's kind of neat.</span> <span data-start="107.41" data-end="111.4">This is an animation utilizing the GPU, to compose several layers</span> <span data-start="111.4" data-end="114.79">together and transform them on top of each other.</span> </p>
<p><span data-start="114.79" data-end="119.99">Oh, there it is!</span> <span data-start="119.99" data-end="120.99">So yeah.</span> <span data-start="120.99" data-end="123.05">CSS is pretty awesome.</span> <span data-start="123.05" data-end="124.05">But..</span> <span data-start="124.05" data-end="131.11">CSS has its fair share of issues and limitations too.</span> <span data-start="131.11" data-end="134.47">There's no way to define constants.</span> <span data-start="134.47" data-end="137.98">There's no way to extend the language with your own logic.</span> </p>
<p><span data-start="137.98" data-end="139.75">There's basically no dependency management.</span> <span data-start="139.75" data-end="143.739">We have to implement the rule, but there's limiting performance</span> <span data-start="143.739" data-end="145.81">characteristics there.</span> <span data-start="145.81" data-end="153.64">There's no way to reuse code or do any sort of metaprogramming.</span> <span data-start="153.64" data-end="155.11">And there's no interoperability with the rest</span> <span data-start="155.11" data-end="159.049">of our front-end code, JavaScript.</span> <span data-start="159.049" data-end="160.659">Sometimes these limitations are good.</span> <span data-start="160.659" data-end="166.489">They force us to write easy to understand code, but sometimes, especially</span> <span data-start="166.489" data-end="170.629">in large scale apps, these limitations often lead to copy and pasted</span> <span data-start="170.629" data-end="177.8">code and stuff that's hard to maintain.</span> </p>
<p><span data-start="177.8" data-end="180.159">But we've been able to work around these issues by creating new</span> <span data-start="180.159" data-end="183.89">languages we call CSS pre-processors.</span> <span data-start="183.89" data-end="190.349">Letting us work around some of these issues, at least.</span> <span data-start="190.349" data-end="194.049">But pre-processors are weird.</span> <span data-start="194.049" data-end="200.54">They often have ambiguous syntax and non-standard semantics, and they give us features</span> <span data-start="200.54" data-end="204.88">that look and smell like things we're used to, like functions, but</span> <span data-start="204.88" data-end="207.989">then their behavior is different in unexpected ways.</span> <span data-start="207.989" data-end="214.499">Let me show you a couple of examples of what I mean.</span> <span data-start="214.499" data-end="217.12">Let's take a look at Silas.</span> <span data-start="217.12" data-end="221.91">It has very terse syntax.</span> <span data-start="221.91" data-end="224.98">Basically gets rid of things like semicolons, curly braces, colons</span> <span data-start="224.98" data-end="229.7"> —  basically almost everything.</span> </p>
<p><span data-start="229.7" data-end="232.579">Let's take a look at this example.</span> <span data-start="232.579" data-end="233.829">Here's the compiled output.</span> <span data-start="233.829" data-end="237.489">We get what we would kind of expect.</span> <span data-start="237.489" data-end="242.43">There's a form that gets the color applied to it, and then an awesome font applied</span> <span data-start="242.43" data-end="248.14">to input and text areas inside that form.</span> <span data-start="248.14" data-end="252.019">But what would happen if we accidentally swapped two</span> <span data-start="252.019" data-end="256.68">lines in our stylus source?</span> <span data-start="256.68" data-end="259.04">So in case you didn't see that  —  let me do it</span> <span data-start="259.04" data-end="260.04">again.</span> </p>
<p><span data-start="260.04" data-end="262.97">The top two lines get swapped with each other.</span> <span data-start="262.97" data-end="265.5">Well, this no longer really makes sense.</span> <span data-start="265.5" data-end="266.97">The source doesn't make sense.</span> <span data-start="266.97" data-end="269.53">What do you guys think will happen?</span> </p>
<p><span data-start="269.53" data-end="273.699">Hopefully we get some sort of compile time error.</span> <span data-start="273.699" data-end="276.03">Nope.</span> <span data-start="276.03" data-end="279">Stylus gets a bit confused and instead thinks our color</span> <span data-start="279" data-end="284.23">declaration is actually a selector.</span> <span data-start="284.23" data-end="289.09">This is still valid CSS, so there's no error.</span> <span data-start="289.09" data-end="291.03">Hopefully the developer catches this.</span> <span data-start="291.03" data-end="294.509">But it's going to take some effort to debug.</span> <span data-start="294.509" data-end="300.449">Let's take a look at Less.</span> <span data-start="300.449" data-end="303.65">Less gives us a way to import dependencies.</span> <span data-start="303.65" data-end="308.229">Actually, Less gives us eight ways to import dependencies.</span> <span data-start="308.229" data-end="311.48">And they all have their different semantics.</span> <span data-start="311.48" data-end="314.889">Actually, sometimes they have the same semantics as others, depending on the</span> <span data-start="314.889" data-end="317.68">condition of what we're importing.</span> <span data-start="317.68" data-end="319.411">Basically you end up having to look at the docs, every time you</span> <span data-start="319.411" data-end="322.53">want to import something.</span> <span data-start="322.53" data-end="332.65">Let's look at variables.</span> </p>
<p><span data-start="332.65" data-end="334.96">Sass gives us variables.</span> <span data-start="334.96" data-end="338.919">Here we have a variable defined called heading color, and then we</span> <span data-start="338.919" data-end="343.229">use that to set the color of H2 elements.</span> <span data-start="343.229" data-end="345.169">But we're defining the variable twice.</span> <span data-start="345.169" data-end="348.099">Once before we use it and once after we use it.</span> <span data-start="348.099" data-end="353.251">In the output, Sass uses the first assignment of the</span> <span data-start="353.251" data-end="356.509">variable and we get red.</span> <span data-start="356.509" data-end="361.21">But let's see what Less decides to do.</span> <span data-start="361.21" data-end="367.55">You have the same thing, but here Less does the opposite</span> <span data-start="367.55" data-end="368.55">thing.</span> <span data-start="368.55" data-end="373.27">Less uses the value that we last assigned to the variable, and we get</span> <span data-start="373.27" data-end="376.72">the value white.</span> <span data-start="376.72" data-end="379.38">Weird.</span> </p>
<p><span data-start="379.38" data-end="381.33">Maybe not either of them are wrong..</span> <span data-start="381.33" data-end="385.24">But you've just got to get used to it, and make sure you switch into the right context</span> <span data-start="385.24" data-end="390.11">when you go between languages.</span> <span data-start="390.11" data-end="393.33">Less also lets us do arithmetic.</span> <span data-start="393.33" data-end="399.819">Here we see 10 pixels, minus 2 pixels is 8 pixels.</span> <span data-start="399.819" data-end="401.199">Great.</span> <span data-start="401.199" data-end="404.27">But you'd better be careful with spaces, because adding or</span> <span data-start="404.27" data-end="408.139">removing spaces might change the result.</span> <span data-start="408.139" data-end="409.139">That's right.</span> <span data-start="409.139" data-end="413.669">Whitespace-sensitive math.</span> <span data-start="413.669" data-end="416.259">And you'd better be careful with parentheses too, because parentheses</span> <span data-start="416.259" data-end="422.83">will change the results in an even worse way.</span> <span data-start="422.83" data-end="425.349">So what else can Less do?</span> <span data-start="425.349" data-end="428.11">Less has this awesome feature  —  it can automatically</span> <span data-start="428.11" data-end="430.91">convert units for us.</span> <span data-start="430.91" data-end="435.169">So here we have the same values, but using different</span> <span data-start="435.169" data-end="436.169">units.</span> <span data-start="436.169" data-end="440.56">10 centimeters minus 1 centimeter, and 10 centimeters minus 10</span> <span data-start="440.56" data-end="441.56">millimeters.</span> </p>
<p><span data-start="441.56" data-end="444.71">Both come out to 1 centimeter.</span> <span data-start="444.71" data-end="446.039">Cool!</span> <span data-start="446.039" data-end="450.28">Let's see this in action with division.</span> <span data-start="450.28" data-end="454.229">Here we have the same units on both sides of the operator.</span> <span data-start="454.229" data-end="456.37">10 centimeters divided by 1 centimeter.</span> <span data-start="456.37" data-end="461.099">10 centimeters, as you would expect, but what happens if we mix</span> <span data-start="461.099" data-end="464.97">units like we did with subtraction.</span> <span data-start="464.97" data-end="466.46">Doesn't work!</span> <span data-start="466.46" data-end="472.79">Less silently ignores units on the second operand when you're doing division.</span> <span data-start="472.79" data-end="473.79">So..</span> <span data-start="473.79" data-end="480.169">With Less, we can do arithmetic, but you've got to be really careful.</span> <span data-start="480.169" data-end="483.18">So my point is: language design is hard.</span> <span data-start="483.18" data-end="489.52">Syntax, scoping, types, compilers, error handling  —  all these are really complicated</span> <span data-start="489.52" data-end="490.599">things.</span> <span data-start="490.599" data-end="493.419">It's understandable that these pre-processors have gotten some</span> <span data-start="493.419" data-end="496.439">of them wrong.</span> </p>
<p><span data-start="496.439" data-end="497.84">So..</span> <span data-start="497.84" data-end="502.05">CSS is cool.</span> <span data-start="502.05" data-end="503.419">But it's got issues.</span> <span data-start="503.419" data-end="507.509">We've got pre-processors to solve some of these issues,</span> <span data-start="507.509" data-end="512.53">but pre-processors have their own issues.</span> <span data-start="512.53" data-end="516.06">Is there a better way?</span> <span data-start="516.06" data-end="520.599">Can we use JavaScript to do CSS better?</span> <span data-start="520.599" data-end="527.74">Well, let's take a look at what using JavaScript to write CSS might look like.</span> <span data-start="527.74" data-end="531.49">Let's express a simple rule in JavaScript.</span> <span data-start="531.49" data-end="533.21">Here it is in CSS.</span> <span data-start="533.21" data-end="536.66">You've got a red button.</span> <span data-start="536.66" data-end="540.31">Let's convert it to JavaScript.</span> <span data-start="540.31" data-end="544.4">It's actually not too different.</span> <span data-start="544.4" data-end="549.94">You basically add some quotation marks, change out the semicolon to a comma, and you've</span> <span data-start="549.94" data-end="552.8">got valid JavaScript syntax.</span> <span data-start="552.8" data-end="556.04">All right.</span> </p>
<p><span data-start="556.04" data-end="558.7">That's a pretty basic example.</span> <span data-start="558.7" data-end="560.44">What if we had pseudoselectors?</span> <span data-start="560.44" data-end="563.6">You wanted to have a hover state for our button.</span> <span data-start="563.6" data-end="566.97">Well, it's not too much different from CSS or one of</span> <span data-start="566.97" data-end="571.23">our pre-processors.</span> <span data-start="571.23" data-end="574.35">And we can do even more complicated selectors.</span> <span data-start="574.35" data-end="577.21">Child selectors and descendant selectors.</span> </p>
<p><span data-start="577.21" data-end="583.66">Still nothing too surprising, I hope.</span> <span data-start="583.66" data-end="589.48">And here's the media query.</span> <span data-start="589.48" data-end="592.86">And in CSS, sometimes you want to do something called</span> <span data-start="592.86" data-end="598.2">property fallbacks, where we define a property more than once, so that</span> <span data-start="598.2" data-end="601.7">browsers that don't support a certain value can fall back to previous</span> <span data-start="601.7" data-end="602.72">ones.</span> <span data-start="602.72" data-end="606.24">In JavaScript, we can't define the same property more than once in an</span> <span data-start="606.24" data-end="611.82">object, but we can use arrays to accomplish this.</span> <span data-start="611.82" data-end="618.15">CSS also has a bunch of other @rules.</span> <span data-start="618.15" data-end="623.33">@charset, @fontface.</span> <span data-start="623.33" data-end="630.74">Rest assured we can express all these things using JavaScript.</span> <span data-start="630.74" data-end="634.31">So you've got rules with selectors, you've got</span> <span data-start="634.31" data-end="637.56">pseudoselectors, child selectors, any kind of selector, really.</span> </p>
<p><span data-start="637.56" data-end="642.75">Property fallbacks, media queries, @ rules.</span> <span data-start="642.75" data-end="644.8">That's pretty much all of CSS.</span> <span data-start="644.8" data-end="648.17">So I think it's safe to say we can express CSS using</span> <span data-start="648.17" data-end="649.55">JavaScript.</span> <span data-start="649.55" data-end="652.21">And it's pretty simple too.</span> <span data-start="652.21" data-end="655.2">All we're using are literals.</span> <span data-start="655.2" data-end="656.41">Literal expressions.</span> </p>
<p><span data-start="656.41" data-end="661.05">This is essentially JSON.</span> <span data-start="661.05" data-end="667.14">So we can express CSS in JavaScript, but how do we actually use this</span> <span data-start="667.14" data-end="672.69">JavaScript  —  this JavaScript in a browser to style elements?</span> <span data-start="672.69" data-end="676.32">So far, we've got these plain old JavaScript objects,</span> <span data-start="676.32" data-end="680.019">but we need to turn this in a way that  —  into something that the browser</span> <span data-start="680.019" data-end="683.04">understands.</span> </p>
<p><span data-start="683.04" data-end="689.44">Well, all we really need is a function that can transform</span> <span data-start="689.44" data-end="694.54">one of these objects into a CSS source string.</span> <span data-start="694.54" data-end="697.36">Now we can take the CSS source string and let the browser</span> <span data-start="697.36" data-end="699.71">use it.</span> <span data-start="699.71" data-end="707.24">So, yes, we can express CSS using JavaScript, and we can use</span> <span data-start="707.24" data-end="710.29">that to actually style elements in the browser.</span> <span data-start="710.29" data-end="711.29">Awesome!</span> <span data-start="711.29" data-end="713.75">JavaScript for everything!</span> <span data-start="713.75" data-end="716.96">But why would we want to do this?</span> <span data-start="716.96" data-end="725.089">Are there any actual advantages?</span> <span data-start="725.089" data-end="729.12">To start with, remember the issues and limitations of CSS that I raised in the</span> <span data-start="729.12" data-end="731.529">beginning of this talk?</span> <span data-start="731.529" data-end="736.259">The reasons we've invented all these new languages, the CSS pre-processors?</span> <span data-start="736.259" data-end="740.91">Well, JavaScript solves  —  or at least addresses  — </span> <span data-start="740.91" data-end="743.66">all of these issues for us automatically.</span> </p>
<p><span data-start="743.66" data-end="749.3">Let me show you what I mean.</span> <span data-start="749.3" data-end="753.87">CSS has no way to define variables.</span> <span data-start="753.87" data-end="764.57">Less and Sass both give us this ability, but they both have their own weird semantics.</span> <span data-start="764.57" data-end="769.6">JavaScript has variables built in, and with semantics we know and understand.</span> <span data-start="769.6" data-end="776.399">We can use variables to define our constants in one place.</span> <span data-start="776.399" data-end="778.26">JavaScript also has arithmetic built in.</span> <span data-start="778.26" data-end="785.639">10 minus 2 pixels is 8 pixels.</span> <span data-start="785.639" data-end="789.459">And best of all, unlike some CSS pre-processors, it doesn't</span> <span data-start="789.459" data-end="794.24">matter how many spaces or parentheses you use.</span> <span data-start="794.24" data-end="800.25">You still get 8 pixels.</span> <span data-start="800.25" data-end="803.95">In CSS, we have no way to extend the language with our own logic.</span> <span data-start="803.95" data-end="807.36">Say we wanted to mix two colors together.</span> </p>
<p><span data-start="807.36" data-end="812.4">In CSS, you would have to pre-compute this value, and hard code it into our</span> <span data-start="812.4" data-end="815.529">source code.</span> <span data-start="815.529" data-end="819.61">Less and other pre-processors give us a set of built-in functions</span> <span data-start="819.61" data-end="822.61">that we can use to do some basic things.</span> <span data-start="822.61" data-end="825.89">But we still can't define our own logic.</span> <span data-start="825.89" data-end="833.38">With JavaScript, we can define arbitrary functions.</span> <span data-start="833.38" data-end="836.65">Here we create a function that mixes the two colors for us.</span> <span data-start="836.65" data-end="841.949">We can even share this function with the rest of our front-end code.</span> <span data-start="841.949" data-end="848.3">Of course, we don't actually have to write our own functions.</span> </p>
<p><span data-start="848.3" data-end="854.019">We can take advantage of the JavaScript ecosystem and use modules to do the work for us.</span> <span data-start="854.019" data-end="868">Here we're using the color module from NPM to do the mixing of the two colors.</span> <span data-start="868" data-end="871.759">And we're not limited to just functions that operate on colors or single</span> <span data-start="871.759" data-end="873.649">values.</span> <span data-start="873.649" data-end="879.639">In JavaScript, functions are the most basic unit of code reuse.</span> </p>
<p><span data-start="879.639" data-end="886.699">We can use functions to generate entire sets of style declarations.</span> <span data-start="886.699" data-end="889.959">Here we have a function that takes in a base color</span> <span data-start="889.959" data-end="893.71">and generates styles for a button based on that color.</span> <span data-start="893.71" data-end="897.339">We're getting the same sort of code reuse we get</span> <span data-start="897.339" data-end="901.12">as what some pre-processors call mix-ins.</span> <span data-start="901.12" data-end="905.89">But with semantics that we understand.</span> <span data-start="905.89" data-end="912.06">With CSS, we have no way of sharing values between CSS and the</span> <span data-start="912.06" data-end="914.589">rest of our front-end code.</span> <span data-start="914.589" data-end="921.459">For example, here we have some CSS that defines a color.</span> <span data-start="921.459" data-end="925.29">Then say we have some JavaScript code that draws on a canvas, and</span> <span data-start="925.29" data-end="931.44">we want this canvas drawing to have the same color as we defined in CSS.</span> <span data-start="931.44" data-end="934.85">I'm sure you guys have probably run into something</span> <span data-start="934.85" data-end="936.139">like this before.</span> <span data-start="936.139" data-end="938.06">You end up having to leave comments to tell other</span> <span data-start="938.06" data-end="941.85">developers that when they change one of these variables or one of these</span> <span data-start="941.85" data-end="944.44">values, they have to make sure they go into the other place and change</span> <span data-start="944.44" data-end="947.6">that value to match too.</span> </p>
<p><span data-start="947.6" data-end="949.41">This is brittle.</span> <span data-start="949.41" data-end="955.569">But if our styles are in JavaScript, and our canvas</span> <span data-start="955.569" data-end="965.87">code is in JavaScript, it becomes trivial to share values between the two.</span> <span data-start="965.87" data-end="971.6">Of course..</span> <span data-start="971.6" data-end="975.23">We don't need everything to be a single file.</span> <span data-start="975.23" data-end="981.129">We can use modules to organize our styles and import dependencies.</span> </p>
<p><span data-start="981.129" data-end="985.66">And it's just JavaScript, so we can import whatever we want.</span> <span data-start="985.66" data-end="994.95">Constants, functions, or entire sets of style declarations.</span> <span data-start="994.95" data-end="1000.399">Speaking of modules, we can take advantage of NPM.</span> <span data-start="1000.399" data-end="1005.32">Not only do we have access to the 150,000 modules  —  we</span> <span data-start="1005.32" data-end="1010.52">can use NPM to publish and reuse style modules.</span> <span data-start="1010.52" data-end="1015.31">Imagine having an ecosystem of reusable styles for</span> <span data-start="1015.31" data-end="1021.12">things like buttons and tables and other common interface elements.</span> <span data-start="1021.12" data-end="1024.66">Or utility modules that help you build styles.</span> <span data-start="1024.66" data-end="1028.27">For example, a module that takes in a background color and automatically</span> <span data-start="1028.27" data-end="1034.99">generates a foreground color for you that has good contrast.</span> <span data-start="1034.99" data-end="1041.64">Spoiler  —  that module already exists in NPM.</span> <span data-start="1041.64" data-end="1048.7">So I've shown that there are advantages of using JavaScript to write CSS.</span> <span data-start="1048.7" data-end="1051.409">By using a Turing-complete programming language</span> <span data-start="1051.409" data-end="1057.22">to build our styles, we're not limits to what our CSS pre-processor has implemented.</span> </p>
<p><span data-start="1057.22" data-end="1060.809">We can instead use the full power of JavaScript to implement</span> <span data-start="1060.809" data-end="1065.08">whatever logic we need.</span> <span data-start="1065.08" data-end="1068.11">We don't need to reinvent variables, functions,</span> <span data-start="1068.11" data-end="1071.11">scoping, or anything else.</span> <span data-start="1071.11" data-end="1075.809">JavaScript has all of these things, just waiting to be used.</span> <span data-start="1075.809" data-end="1083.919">Of course, with great power comes great responsibility.</span> <span data-start="1083.919" data-end="1088.19">Maybe it's not a good idea to do a network request to build your styles.</span> <span data-start="1088.19" data-end="1096.47">But that should be up to you to decide.</span> </p>
<p><span data-start="1096.47" data-end="1098.32">So..</span> <span data-start="1098.32" data-end="1105.98">We've successfully used JavaScript to write CSS.</span> <span data-start="1105.98" data-end="1109.83">How else can we mix JavaScript and CSS?</span> <span data-start="1109.83" data-end="1117.309">Let me pause for a second and tell you that you should consider the</span> <span data-start="1117.309" data-end="1121.08">following experimental thinking.</span> <span data-start="1121.08" data-end="1122.21">The details are vague.</span> <span data-start="1122.21" data-end="1124.12">I don't know if it's a good idea.</span> <span data-start="1124.12" data-end="1127.88">And I definitely don't know if it'll even work.</span> <span data-start="1127.88" data-end="1132.27">So think about it and give me your feedback.</span> <span data-start="1132.27" data-end="1141.19">But let's see how else we can mix JS and CSS.</span> <span data-start="1141.19" data-end="1147.929">We can use JavaScript to apply styles in the browser.</span> <span data-start="1147.929" data-end="1151.57">What I mean by this is taking over the browser's role of</span> <span data-start="1151.57" data-end="1155.659">parsing CSS and applying styles to elements.</span> <span data-start="1155.659" data-end="1160.919">I know this sounds crazy, but bear with me for a second and let's</span> <span data-start="1160.919" data-end="1166.299">see what we can do if we do this.</span> </p>
<p><span data-start="1166.299" data-end="1175.929">First, writing CSS and JavaScript, like I've been talking about, is not a prerequisite</span> <span data-start="1175.929" data-end="1177.82">to this.</span> <span data-start="1177.82" data-end="1182.48">You could just use regular old CSS, actually.</span> <span data-start="1182.48" data-end="1189.1">What is a prerequisite is having some sort of CSS abstract syntax tree or CSS</span> <span data-start="1189.1" data-end="1193.26">AST available to us in the browser.</span> <span data-start="1193.26" data-end="1200.25">What I mean by this is: we need to be able to take a CSS source string and be able to</span> <span data-start="1200.25" data-end="1205.679">understand and inspect it and see exactly what's being defined in that</span> <span data-start="1205.679" data-end="1207.809">source.</span> </p>
<p><span data-start="1207.809" data-end="1214.84">Of course, there's an NPM module for that.</span> <span data-start="1214.84" data-end="1219.95">Here we're parsing a simple CSS rule.</span> <span data-start="1219.95" data-end="1225.03">We have access to the selector, the declarations,</span> <span data-start="1225.03" data-end="1229.45">what property is being defined, and what the value is.</span> <span data-start="1229.45" data-end="1236.69">And of course, we can do the inverse.</span> <span data-start="1236.69" data-end="1242.38">We can take a CSS abstract syntax tree, and generate a CSS</span> <span data-start="1242.38" data-end="1245.06">source string.</span> <span data-start="1245.06" data-end="1247.6">Cool.</span> <span data-start="1247.6" data-end="1251.35">But what does this enable us to do?</span> <span data-start="1251.35" data-end="1260.54">Well, CSS has a new feature called CSS feature queries.</span> <span data-start="1260.54" data-end="1263.98">It's kind of like media queries, but instead of testing the</span> <span data-start="1263.98" data-end="1269.46">device's width or orientation or something like that, we're able to test</span> <span data-start="1269.46" data-end="1278.51">whether a device supports a certain CSS feature.</span> </p>
<p><span data-start="1278.51" data-end="1284.44">This example lets us use Flexbox, if the browser supports Flexbox.</span> <span data-start="1284.44" data-end="1287.73">Otherwise we use float.</span> <span data-start="1287.73" data-end="1292.61">Unfortunately, not many browsers support feature queries</span> <span data-start="1292.61" data-end="1299.03">yet.</span> <span data-start="1299.03" data-end="1303.73">But if we're executing JavaScript in the browser, then we have</span> <span data-start="1303.73" data-end="1307.11">access to information about that browser environment.</span> <span data-start="1307.11" data-end="1310.22">Like, for example, whether or not the browser supports</span> <span data-start="1310.22" data-end="1313.35">a certain CSS feature or not.</span> <span data-start="1313.35" data-end="1322.78">And if we can access our CSS abstract syntax tree, like I showed earlier, then</span> <span data-start="1322.78" data-end="1329.27">we can use that information about the browser and transform our CSS into new</span> </p>
<p><span data-start="1329.27" data-end="1333.14">CSS.</span> <span data-start="1333.14" data-end="1338.02">Then we can take that new CSS and inject it back into the browser by</span> <span data-start="1338.02" data-end="1342.39">injecting a new style tag into the documents.</span> <span data-start="1342.39" data-end="1351.83">This means we can take CSS and create new CSS based on what browser we're</span> <span data-start="1351.83" data-end="1354.559">in.</span> <span data-start="1354.559" data-end="1364.929">We can use this technique to polyfill CSS feature queries.</span> <span data-start="1364.929" data-end="1371.62">We would walk the CSS abstract syntax tree, and then when we come across an @supports</span> <span data-start="1371.62" data-end="1378.47">rule, we would do the feature detection in JavaScript.</span> <span data-start="1378.47" data-end="1384.86">And then based on the result of that feature detection, we could generate a new CSS AST.</span> <span data-start="1384.86" data-end="1388.94">Either including the rule or excluding the rule that's nested under the</span> <span data-start="1388.94" data-end="1395.13">app supports rule.</span> <span data-start="1395.13" data-end="1402.07">Now we have feature queries in every browser.</span> </p>
<p><span data-start="1402.07" data-end="1410.36">So what else can we do?</span> <span data-start="1410.36" data-end="1414.309">One of the browser's jobs in CSS is to take selectors and figure</span> <span data-start="1414.309" data-end="1417.91">out which elements match.</span> <span data-start="1417.91" data-end="1421.9">Then the matched elements get styles applied to them.</span> <span data-start="1421.9" data-end="1426.99">In this example, the browser knows to apply the color red to our</span> <span data-start="1426.99" data-end="1434.02">span because the span is a child of a div element.</span> <span data-start="1434.02" data-end="1438.24">That's what our CSS rules selector specifies.</span> <span data-start="1438.24" data-end="1442.44">The other way we can take over the browser is</span> <span data-start="1442.44" data-end="1451.14">by doing this matching and applying of styles ourselves.</span> </p>
<p><span data-start="1451.14" data-end="1456.73">This means for each CSS rule we have defined, we would</span> <span data-start="1456.73" data-end="1460.39">find all of the elements that match, using something like query</span> <span data-start="1460.39" data-end="1469.11">selector all, and then for each matched element, we would apply the rule's</span> <span data-start="1469.11" data-end="1474.289">styles to the element.</span> <span data-start="1474.289" data-end="1475.289">Why would we do this?</span> <span data-start="1475.289" data-end="1477.36">The browser already does this for us.</span> <span data-start="1477.36" data-end="1484.7">Well, again, it's about having new information.</span> <span data-start="1484.7" data-end="1487.57">This time we would have information about the hierarchy</span> <span data-start="1487.57" data-end="1493.52">of elements in the document when we're applying styles to an element.</span> </p>
<p><span data-start="1493.52" data-end="1497.529">Meaning that for each element we're applying styles to, we could see what its</span> <span data-start="1497.529" data-end="1504.559">parent is, what its children are, how many siblings it has, we would know exactly</span> <span data-start="1504.559" data-end="1512.11">where in the document's hierarchy that element is.</span> <span data-start="1512.11" data-end="1520.86">This information lets us polyfill even more CSS features.</span> <span data-start="1520.86" data-end="1526.35">Take first child and last child, for example.</span> <span data-start="1526.35" data-end="1529.22">If you know about the siblings of an element, you</span> <span data-start="1529.22" data-end="1535.33">know the position of an element within its parents, then we know if</span> <span data-start="1535.33" data-end="1540.75">it's the first child or not, and if it's the last child or not.</span> <span data-start="1540.75" data-end="1543.029">This means we would be able to implement first child and</span> <span data-start="1543.029" data-end="1547.21">last child ourselves.</span> <span data-start="1547.21" data-end="1549.919">So when we're iterating through elements, we can use</span> <span data-start="1549.919" data-end="1555.38">this information about the element's position to determine if the element</span> <span data-start="1555.38" data-end="1562.61">should get our first child's or last child's styles.</span> <span data-start="1562.61" data-end="1567.88">Though that's not really too useful, since basically every browser supports first child</span> <span data-start="1567.88" data-end="1572.33">and last child natively.</span> </p>
<p><span data-start="1572.33" data-end="1576.31">But with the same kind of information, and the</span> <span data-start="1576.31" data-end="1581.11">same technique, looking at the document's hierarchy, maybe we can polyfill</span> <span data-start="1581.11" data-end="1586.75">something more useful.</span> <span data-start="1586.75" data-end="1591.61">Flexbox is a new CSS layout feature that makes it easy to express all the</span> <span data-start="1591.61" data-end="1592.61">crazy things.</span> <span data-start="1592.61" data-end="1602.96">We use floats and tables and various other layout hacks.</span> </p>
<p><span data-start="1602.96" data-end="1609.27">If you know the Flexbox styles we want to apply to an element, and we know</span> <span data-start="1609.27" data-end="1614.57">that element's parents and its children and all the styles of those</span> <span data-start="1614.57" data-end="1621.59">elements, then we can calculate the position and dimensions of every</span> <span data-start="1621.59" data-end="1627.44">element.</span> <span data-start="1627.44" data-end="1632.69">This example has a flex container with two children.</span> <span data-start="1632.69" data-end="1637.57">Each with an equal grow factor of 1.</span> <span data-start="1637.57" data-end="1641.83">This means we would have a container that has two side</span> <span data-start="1641.83" data-end="1646.57">by side columns inside of it, each with equal width.</span> <span data-start="1646.57" data-end="1652.87">I was able to determine that by just looking at the CSS</span> <span data-start="1652.87" data-end="1658.33">and our document's hierarchy.</span> <span data-start="1658.33" data-end="1662.25">Of course, computers can do this for us too.</span> <span data-start="1662.25" data-end="1671.77">And you guessed it  —  there's an NPM module for that.</span> <span data-start="1671.77" data-end="1675.539">So if we can describe our document, creating a</span> <span data-start="1675.539" data-end="1679.64">representation of our document hierarchy and the styles we want each element</span> <span data-start="1679.64" data-end="1688.899">to have, then we can use the CSS layout module to calculate the layout of our</span> <span data-start="1688.899" data-end="1692.419">elements.</span> </p>
<p><span data-start="1692.419" data-end="1697.52">So here we're describing the document I showed in the previous example.</span> <span data-start="1697.52" data-end="1703.69">A container with two flex children.</span> <span data-start="1703.69" data-end="1711.13">So if we pass the right information to CSS layout, it can calculate the exact dimensions</span> <span data-start="1711.13" data-end="1715.72">and positions of each element for us.</span> <span data-start="1715.72" data-end="1721.39">Here we can see we end up with our parent and two children,</span> <span data-start="1721.39" data-end="1723.58">side by side, each with equal width.</span> <span data-start="1723.58" data-end="1734.46">We get the width, height, top, and left of each element.</span> <span data-start="1734.46" data-end="1735.46">That's awesome!</span> <span data-start="1735.46" data-end="1741.97">I think we can use that to implement a runtime Flexbox polyfill.</span> <span data-start="1741.97" data-end="1746.02">I think we're in a really exciting place right now.</span> <span data-start="1746.02" data-end="1749.95">The JavaScript module ecosystem is implementing some great</span> <span data-start="1749.95" data-end="1750.95">things.</span> <span data-start="1750.95" data-end="1753.88">I think it's going to be really interesting to see what we</span> <span data-start="1753.88" data-end="1759.34">can do with them.</span> <span data-start="1759.34" data-end="1761.799">So I hope I've shown you some interesting ways you can</span> <span data-start="1761.799" data-end="1763.94">mix JavaScript and CSS.</span> </p>
<p><span data-start="1763.94" data-end="1769.539">And essentially reimplement the browser in the browser.</span> <span data-start="1769.539" data-end="1771.3">Come find me and talk to me about any of this.</span> <span data-start="1771.3" data-end="1773.75">I would love to discuss it.</span> <span data-start="1773.75" data-end="1775.159">You can also tweet me @ParshaP.</span> </p>
</section>