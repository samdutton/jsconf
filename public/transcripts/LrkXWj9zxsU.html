<section>
<p><span data-start="4.41" data-end="11.63">Thank You Jacob good afternoon everyone</span> <span data-start="11.63" data-end="14.73">I'd like to talk this session about ven</span> <span data-start="14.73" data-end="18.74">sourcing Redux and react applications</span> <span data-start="18.74" data-end="21.539">now decision is more about architecture</span> </p>
<p><span data-start="21.539" data-end="25.17">I use redux and reacts as examples but</span> <span data-start="25.17" data-end="28.5">this would basically apply to any Java</span> <span data-start="28.5" data-end="30.84">scripts application or for that matter</span> <span data-start="30.84" data-end="33.629">even any smart client server site</span> <span data-start="33.629" data-end="37.02">application desktop application the</span> <span data-start="37.02" data-end="40.01">architecture is universally applicable</span> <span data-start="40.01" data-end="43.11">so who my name is waste buyer i'm from</span> <span data-start="43.11" data-end="46.079">the netherlands I'm freelance instructor</span> <span data-start="46.079" data-end="48.57">developer and I consoled to lots of</span> <span data-start="48.57" data-end="52.14">companies doing stuff so if you want to</span> <span data-start="52.14" data-end="53.94">learn more about react I've recently</span> <span data-start="53.94" data-end="56.87">started the Kickstarter campaign and</span> <span data-start="56.87" data-end="59.579">with any luck if it gets fun that I'm</span> <span data-start="59.579" data-end="61.14">going to create a whole course about</span> <span data-start="61.14" data-end="63.979">reacts where you can do learn much more</span> <span data-start="63.979" data-end="66.78">so if you want to go there that's the</span> <span data-start="66.78" data-end="72.03">link so why am i interested in event</span> <span data-start="72.03" data-end="74.52">sourcing and these kind of our sticker</span> <span data-start="74.52" data-end="76.47">things well I want to make better</span> <span data-start="76.47" data-end="78.539">applications and that's a goal I've had</span> <span data-start="78.539" data-end="80.399">for a long time and there is a lot</span> <span data-start="80.399" data-end="82.44">involved with making better applications</span> <span data-start="82.44" data-end="85.02">the front end has to be better and react</span> <span data-start="85.02" data-end="87.63">helps me a lot there day that</span> <span data-start="87.63" data-end="89.429">manipulation in the front end has to be</span> <span data-start="89.429" data-end="91.92">better that's where Redux comes in helps</span> <span data-start="91.92" data-end="94.289">me a lot put on the server side we have</span> <span data-start="94.289" data-end="98.25">to do things a lot better as well and</span> <span data-start="98.25" data-end="100.02">one of the reasons things need to be</span> <span data-start="100.02" data-end="103.41">better is because of fire like this one</span> <span data-start="103.41" data-end="107.13">of my main customers creates safety</span> <span data-start="107.13" data-end="108.739">software for the oil and gas industry</span> <span data-start="108.739" data-end="112.679">and we kind of try to prevent these</span> <span data-start="112.679" data-end="115.14">accidents from happening now we don't</span> <span data-start="115.14" data-end="116.61">control people we can't actually</span> <span data-start="116.61" data-end="118.8">forcibly stop someone from doing</span> <span data-start="118.8" data-end="121.229">something wrong but we do create so far</span> <span data-start="121.229" data-end="123.209">where all the work is planned and we</span> <span data-start="123.209" data-end="125.58">kind of evaluate well if someone is</span> <span data-start="125.58" data-end="128.069">going to open up a gas main lying and</span> <span data-start="128.069" data-end="129.77">someone else is going to do some welding</span> <span data-start="129.77" data-end="135.12">then torches sparks free gas that's</span> <span data-start="135.12" data-end="136.95">probably not a good combination you</span> <span data-start="136.95" data-end="137.79">probably will</span> <span data-start="137.79" data-end="139.89">to separate those in time so they don't</span> <span data-start="139.89" data-end="142.26">happen at the same time or you will get</span> <span data-start="142.26" data-end="146.4">accidents like this happen so</span> <span data-start="146.4" data-end="149.28">traditionally people be storing data in</span> <span data-start="149.28" data-end="152.04">all sorts of ways you might have been</span> <span data-start="152.04" data-end="155.28">using relational data or an object</span> <span data-start="155.28" data-end="160.29">database like MongoDB and typically in</span> <span data-start="160.29" data-end="162.989">the traditional application architecture</span> <span data-start="162.989" data-end="164.879">used to be quite simple with there's</span> <span data-start="164.879" data-end="166.62">something like this at the very high</span> <span data-start="166.62" data-end="169.139">level so the left we've got our database</span> <span data-start="169.139" data-end="171.359">and in the middle we've got our server</span> <span data-start="171.359" data-end="173.129">for application and that server</span> <span data-start="173.129" data-end="175.29">application grabs data from the database</span> <span data-start="175.29" data-end="178.859">whenever a client connects client is on</span> <span data-start="178.859" data-end="181.019">the left hand side sorry the right hand</span> <span data-start="181.019" data-end="183">side it's the browser running a react</span> <span data-start="183" data-end="185.189">application in this case and it kind of</span> <span data-start="185.189" data-end="188.43">passes that data to the clients and then</span> <span data-start="188.43" data-end="189.959">whenever the client has made some kind</span> <span data-start="189.959" data-end="192.45">of changes it passes the data back to do</span> <span data-start="192.45" data-end="194.28">server the server probably does some</span> <span data-start="194.28" data-end="196.799">sort of validation and stores it in the</span> <span data-start="196.799" data-end="199.709">database this is the kind of system you</span> <span data-start="199.709" data-end="203.01">might end up if you just use restful</span> <span data-start="203.01" data-end="207.06">styles of working with data and that's</span> <span data-start="207.06" data-end="208.919">fine if you've got a relatively simple</span> <span data-start="208.919" data-end="211.199">application if you've got to do</span> <span data-start="211.199" data-end="213.75">application you're not going to have lot</span> <span data-start="213.75" data-end="216.06">of multi-user contention most people</span> <span data-start="216.06" data-end="219.03">manage their own to-do list no one else</span> <span data-start="219.03" data-end="220.829">is going to touch that maybe in the case</span> <span data-start="220.829" data-end="222.75">of a manager he'll have a secretory</span> <span data-start="222.75" data-end="225.239">managing his to-do list but in that case</span> <span data-start="225.239" data-end="227.19">it's probably the secretary doing all</span> <span data-start="227.19" data-end="230.19">the work and even if you create to the</span> <span data-start="230.19" data-end="232.769">to do list to rule them all is the whole</span> <span data-start="232.769" data-end="234.239">world is going to use it you'll have</span> <span data-start="234.239" data-end="237.03">lots of small lists but there won't be</span> <span data-start="237.03" data-end="239.31">much interaction and a relatively simple</span> <span data-start="239.31" data-end="242.9">architecture is going to be just fine</span> <span data-start="242.9" data-end="247.169">but if you want to create reacts</span> <span data-start="247.169" data-end="249.389">component to render something like that</span> <span data-start="249.389" data-end="250.979">in this case it's not for to do</span> <span data-start="250.979" data-end="252.75">applications it's actually for work</span> <span data-start="252.75" data-end="255.09">permits you might end up with a react</span> <span data-start="255.09" data-end="257.759">component like this really simple it</span> <span data-start="257.759" data-end="259.65">just takes in a list it's good no clue</span> <span data-start="259.65" data-end="262.38">where it actually came from it knows</span> <span data-start="262.38" data-end="265.139">there is something that it can do it can</span> <span data-start="265.139" data-end="266.88">draft the permit which basically means</span> <span data-start="266.88" data-end="269.55">we're building up a whole permit</span> <span data-start="269.55" data-end="271.56">requests specifying what we want</span> <span data-start="271.56" data-end="273.9">to do where we want to do it when what</span> <span data-start="273.9" data-end="276.57">kind of tools we want to use etc but</span> <span data-start="276.57" data-end="278.37">react component doesn't really know</span> <span data-start="278.37" data-end="280.5">where it came from how its treated</span> <span data-start="280.5" data-end="282.57">they're really simple and that's how</span> <span data-start="282.57" data-end="284.52">your reactor components should typically</span> <span data-start="284.52" data-end="288.96">be so if you've got a little more</span> <span data-start="288.96" data-end="291.57">complex application which our</span> <span data-start="291.57" data-end="293.82">application is you want to be a bit more</span> <span data-start="293.82" data-end="296.43">explicit about updating things and</span> <span data-start="296.43" data-end="299.25">that's where the CQ rest pattern or</span> <span data-start="299.25" data-end="301.32">command the query responsibility</span> <span data-start="301.32" data-end="305.729">segregation comes in and insecure s</span> <span data-start="305.729" data-end="309.24">commands are very important commands are</span> <span data-start="309.24" data-end="312.03">used from the client to update things so</span> <span data-start="312.03" data-end="313.979">we're not taking a resource like in a</span> <span data-start="313.979" data-end="315.9">restful system downloaded changing its</span> <span data-start="315.9" data-end="318">ending that home resource back though</span> <span data-start="318" data-end="320.28">we're very explicit about I've got a</span> <span data-start="320.28" data-end="322.08">resource I want to make some changes to</span> <span data-start="322.08" data-end="325.71">it this is why I want to do it if you</span> <span data-start="325.71" data-end="327.96">take all your command names and you give</span> <span data-start="327.96" data-end="329.79">those to some kind of say business</span> <span data-start="329.79" data-end="333.3">analyst or end user he should be able to</span> <span data-start="333.3" data-end="335.789">understand that so what commands like</span> <span data-start="335.789" data-end="339.419">update fields is a lousy command it</span> <span data-start="339.419" data-end="342.3">doesn't convey business value draft</span> <span data-start="342.3" data-end="348.479">permits pay check check credits records</span> <span data-start="348.479" data-end="351.09">those are valid commands and something</span> <span data-start="351.09" data-end="354.479">which makes sense and if you use see</span> <span data-start="354.479" data-end="357.24">caress the architecture will become</span> <span data-start="357.24" data-end="360.36">somewhat more complex like this on the</span> <span data-start="360.36" data-end="362.1">right and still site we still got our</span> <span data-start="362.1" data-end="366.51">browser application using react if it</span> <span data-start="366.51" data-end="368.28">wants to get some data from the surface</span> <span data-start="368.28" data-end="370.74">it goes to the query surface at the top</span> <span data-start="370.74" data-end="373.38">and the query surface is probably a</span> <span data-start="373.38" data-end="375.99">restful service but all it does is get</span> <span data-start="375.99" data-end="378.72">data it never responds to with boots or</span> <span data-start="378.72" data-end="382.32">a post or a delete it only retrieves</span> <span data-start="382.32" data-end="385.979">data purely redone so what if you want</span> <span data-start="385.979" data-end="387.66">to change something well the client</span> <span data-start="387.66" data-end="390.36">sends very explicit commands to the</span> <span data-start="390.36" data-end="392.789">server so the commands go down to the</span> <span data-start="392.789" data-end="395.16">bottom to the command surface it does</span> <span data-start="395.16" data-end="397.47">all the validation it could potentially</span> <span data-start="397.47" data-end="400.08">reject the command like you want to</span> <span data-start="400.08" data-end="401.849">deposit or you want to withdraw some</span> <span data-start="401.849" data-end="403.89">money from your bank account but you</span> <span data-start="403.89" data-end="404.79">don't actually have</span> <span data-start="404.79" data-end="406.59">enough money well in that case your</span> <span data-start="406.59" data-end="409.35">request is rejected your command is not</span> <span data-start="409.35" data-end="413.28">valid and the plan could get a 400 style</span> <span data-start="413.28" data-end="417.39">error back but assuming the command is</span> <span data-start="417.39" data-end="420.66">valid the database gets updated and the</span> <span data-start="420.66" data-end="422.46">client or in the other connected clients</span> <span data-start="422.46" data-end="424.44">could actually retrieve thread through</span> <span data-start="424.44" data-end="428.82">the query surface so what does a command</span> <span data-start="428.82" data-end="431.13">like that look like in JavaScript well</span> <span data-start="431.13" data-end="432.9">it's really simple commands are really</span> <span data-start="432.9" data-end="435.33">simple objects we try to keep them as</span> <span data-start="435.33" data-end="438.15">flat as possible it's just back of data</span> <span data-start="438.15" data-end="440.91">a couple of interesting things though</span> <span data-start="440.91" data-end="444.6">first of all every command has an ID in</span> <span data-start="444.6" data-end="447.6">some cases in more complex applications</span> <span data-start="447.6" data-end="450.3">especially if you've not got the perfect</span> <span data-start="450.3" data-end="452.7">connection like we do when we have to</span> <span data-start="452.7" data-end="455.61">work with offshore platforms you might</span> <span data-start="455.61" data-end="458.37">get commands which get sent twice after</span> <span data-start="458.37" data-end="460.05">all if you've got a timeout from from</span> </p>
<p><span data-start="460.05" data-end="462.6">HTTP requests you don't really know what</span> <span data-start="462.6" data-end="464.94">happens did my command reach the server</span> <span data-start="464.94" data-end="469.35">and what's the response timed out or did</span> <span data-start="469.35" data-end="472.55">it never actually receive the server so</span> <span data-start="472.55" data-end="475.35">every command has a unique ID if its</span> <span data-start="475.35" data-end="478.2">recent for some reason then the server</span> <span data-start="478.2" data-end="481.02">can check based on that command tidy am</span> <span data-start="481.02" data-end="483.12">I duplicating the same month and if so</span> <span data-start="483.12" data-end="485.1">get rejected because it's already done</span> <span data-start="485.1" data-end="488.37">it the other important thing is the</span> <span data-start="488.37" data-end="490.25">command name what are we actually</span> <span data-start="490.25" data-end="492.69">intending to do there and based on the</span> <span data-start="492.69" data-end="494.4">command name there will be a whole bunch</span> <span data-start="494.4" data-end="497.7">of other data or maybe very little in</span> <span data-start="497.7" data-end="500.19">case of delete apartment then all you</span> <span data-start="500.19" data-end="502.02">would need to know the permit ID to</span> <span data-start="502.02" data-end="504.09">delete and that's all but in this case</span> <span data-start="504.09" data-end="505.86">with draft permits to raise a whole</span> <span data-start="505.86" data-end="510.28">bunch of data about the permits there</span> <span data-start="510.29" data-end="512.76">after a command like this has been</span> <span data-start="512.76" data-end="515.13">successful we kind of need to update the</span> <span data-start="515.13" data-end="518.25">reader store on the clients so we Redux</span> <span data-start="518.25" data-end="520.68">you typically have actions to signify</span> <span data-start="520.68" data-end="524.34">that something happens and an action is</span> <span data-start="524.34" data-end="527.25">very strongly related to a command a</span> <span data-start="527.25" data-end="529.2">command is ok I want to do something</span> <span data-start="529.2" data-end="531.9">well the action is ok that's been done</span> <span data-start="531.9" data-end="536.19">it was successful now go and update the</span> <span data-start="536.19" data-end="537.91">data on the client</span> <span data-start="537.91" data-end="540.94">so you see this action notice different</span> <span data-start="540.94" data-end="544.09">the command was draft permit so</span> <span data-start="544.09" data-end="546.61">commanding tense the action is permit</span> <span data-start="546.61" data-end="549.16">drafted we know the draft command has</span> <span data-start="549.16" data-end="552.24">been successful so it's past tense and</span> <span data-start="552.24" data-end="554.62">the data in there is going to be pretty</span> <span data-start="554.62" data-end="559.54">much the same thing so that's nice that</span> <span data-start="559.54" data-end="562.03">gives us a much better our stature but</span> <span data-start="562.03" data-end="563.92">it still leaves us with one big problem</span> <span data-start="563.92" data-end="566.86">if we looked at the database it only has</span> <span data-start="566.86" data-end="570.43">the current state in there and it's like</span> <span data-start="570.43" data-end="573.79">how did we get there if you look at this</span> <span data-start="573.79" data-end="575.44">rock formation which is in the west of</span> </p>
<p><span data-start="575.44" data-end="577.9">France it's kind of like a beautiful</span> <span data-start="577.9" data-end="580.63">rock formation but how did it get to be</span> <span data-start="580.63" data-end="584.2">the way it is did we have a solid rock</span> <span data-start="584.2" data-end="587.07">there once upon a time and it waves</span> <span data-start="587.07" data-end="591.07">break a big hole into it or maybe was it</span> <span data-start="591.07" data-end="594.19">deposited on top and did deposit grow up</span> <span data-start="594.19" data-end="597.22">to form that arch you really can tell</span> <span data-start="597.22" data-end="600.16">all we've got is the current state and</span> <span data-start="600.16" data-end="603.37">if you think about databases you quite</span> <span data-start="603.37" data-end="606.57">often experience problems like well</span> <span data-start="606.57" data-end="608.92">something in the database is wrong like</span> <span data-start="608.92" data-end="610.57">there is something which should not be</span> <span data-start="610.57" data-end="614.29">the way it is it's invalid we know that</span> <span data-start="614.29" data-end="616.63">but how did it get to be in that a valid</span> <span data-start="616.63" data-end="619.81">state we don't know all we can say is</span> <span data-start="619.81" data-end="622.09">well okay it's invalid now somehow that</span> <span data-start="622.09" data-end="625.03">happens maybe we've got some logic error</span> <span data-start="625.03" data-end="627.52">but we really don't know how it got to</span> <span data-start="627.52" data-end="629.83">be that way but will write some kind of</span> <span data-start="629.83" data-end="633.01">sequel script to patch it and we're good</span> <span data-start="633.01" data-end="635.41">to go again and maybe a month later the</span> <span data-start="635.41" data-end="638.23">same problem occurs again still no clue</span> <span data-start="638.23" data-end="640.87">why it happens so we really want to know</span> <span data-start="640.87" data-end="645.25">a bit more about how stuff got to be the</span> <span data-start="645.25" data-end="649.27">way it is so that's where event sourcing</span> <span data-start="649.27" data-end="653.08">comes in a fence or thing is really</span> <span data-start="653.08" data-end="655.51">something which is theoretically quite</span> <span data-start="655.51" data-end="657.82">old it's based on accounting and</span> <span data-start="657.82" data-end="660.04">bookkeeping which is be used for ages</span> <span data-start="660.04" data-end="663.58">and a guy called Greg young basically</span> <span data-start="663.58" data-end="667.66">implemented that in data storage so he</span> <span data-start="667.66" data-end="669.22">said well instead of destroying the</span> <span data-start="669.22" data-end="671.13">current state we're going to store</span> <span data-start="671.13" data-end="673.29">are everything that leads up to the</span> <span data-start="673.29" data-end="677.31">current state all of those events and if</span> <span data-start="677.31" data-end="678.78">you think about that draft permits</span> <span data-start="678.78" data-end="681.69">command I showed a few minutes ago well</span> <span data-start="681.69" data-end="684.66">if that was successful we would change</span> <span data-start="684.66" data-end="686.73">some states well in an event source</span> <span data-start="686.73" data-end="690.15">system we would store an event permit</span> <span data-start="690.15" data-end="693.66">drafted and like the commands could be</span> <span data-start="693.66" data-end="696.15">validated and rejected if it was invalid</span> <span data-start="696.15" data-end="698.58">the event is store if it is successful</span> <span data-start="698.58" data-end="702">so we know it's happened its history</span> <span data-start="702" data-end="704.04">which also means it's never going to</span> <span data-start="704.04" data-end="707.01">change we're only going to add more to</span> <span data-start="707.01" data-end="710.94">or to the table of events so if someone</span> <span data-start="710.94" data-end="713.4">makes it change through that permit does</span> <span data-start="713.4" data-end="716.22">another draft the command it's not going</span> <span data-start="716.22" data-end="718.77">to override the first permit drafted</span> <span data-start="718.77" data-end="720.42">events no it's going to create a second</span> <span data-start="720.42" data-end="723.18">one and they don't stack on top of each</span> <span data-start="723.18" data-end="726.18">other and the current States is a result</span> <span data-start="726.18" data-end="729.48">of applying all those commands or all</span> <span data-start="729.48" data-end="731.91">those events i should say in functional</span> <span data-start="731.91" data-end="734.13">terms the current state is a left fault</span> <span data-start="734.13" data-end="738.59">of all stored events now turns out that</span> <span data-start="738.59" data-end="741.78">something which is relatively new in</span> <span data-start="741.78" data-end="744.39">computer terms but in real life is be</span> <span data-start="744.39" data-end="747.63">used for ages and ages even back in the</span> <span data-start="747.63" data-end="751.56">days of the Pharaohs bookkeeping always</span> <span data-start="751.56" data-end="753.6">had to rule like we don't distort a</span> <span data-start="753.6" data-end="756.48">current state we store transactions and</span> <span data-start="756.48" data-end="758.7">even back then the far-out might have</span> <span data-start="758.7" data-end="761.82">had ten cows and one will be born then</span> <span data-start="761.82" data-end="764.52">they won't cross out to ten given that</span> <span data-start="764.52" data-end="766.89">they use clay tablets and papyrus back</span> <span data-start="766.89" data-end="768.39">then crossing that would probably be</span> <span data-start="768.39" data-end="770.82">quite hard but they would add another</span> <span data-start="770.82" data-end="773.67">line cow born on whatever date and</span> <span data-start="773.67" data-end="776.28">number one and when they got to the</span> <span data-start="776.28" data-end="778.08">bottom of the tie tablet they would kind</span> <span data-start="778.08" data-end="780.39">of sum them up and start a new tablet</span> <span data-start="780.39" data-end="782.91">they say at the top current status is</span> <span data-start="782.91" data-end="787.11">the Pharaoh has 11 calves and then they</span> <span data-start="787.11" data-end="789.66">would report sales their purchases etc</span> <span data-start="789.66" data-end="794.76">and kind of keep tally that way now</span> <span data-start="794.76" data-end="796.44">bookkeeping has been doing that for</span> <span data-start="796.44" data-end="798.9">thousands and thousands of years even</span> <span data-start="798.9" data-end="802.31">the model double entry bookkeeping is</span> <span data-start="802.31" data-end="804.48">hundreds of years old it was</span> <span data-start="804.48" data-end="807.06">invented around fifteen hundreds by an</span> </p>
<p><span data-start="807.06" data-end="809.76">Italian monk and he created to double</span> <span data-start="809.76" data-end="812.13">book entry bookkeeping system which</span> <span data-start="812.13" data-end="814.889">basically prevents lots of mistakes and</span> <span data-start="814.889" data-end="817.44">makes it really easy to detect errors if</span> <span data-start="817.44" data-end="819.81">they've been made so in that respect</span> <span data-start="819.81" data-end="823.35">it's really nothing new and one of the</span> <span data-start="823.35" data-end="825.8">great things it's a perfect or that look</span> <span data-start="825.8" data-end="829.41">we know exactly what happens when it</span> <span data-start="829.41" data-end="833.82">happens how it happens usually by who it</span> <span data-start="833.82" data-end="836.459">happens depending on what you store in</span> <span data-start="836.459" data-end="838.32">the event but usually you store all</span> <span data-start="838.32" data-end="840.3">those things so if you run into the</span> <span data-start="840.3" data-end="842.49">database you detect some kind of anomaly</span> <span data-start="842.49" data-end="844.769">dare you say well that state isn't what</span> <span data-start="844.769" data-end="846.93">it should be it really should be</span> <span data-start="846.93" data-end="848.43">something different instead of saying</span> <span data-start="848.43" data-end="850.889">well don't know how it good to be there</span> <span data-start="850.889" data-end="853.11">but it is there now we can actually go</span> <span data-start="853.11" data-end="855">through all the events being store up</span> <span data-start="855" data-end="857.519">for that item and track well okay these</span> <span data-start="857.519" data-end="859.079">changes were made these changes were</span> <span data-start="859.079" data-end="861.779">made and you can determine what changed</span> <span data-start="861.779" data-end="864.06">actually caused the error maybe there is</span> <span data-start="864.06" data-end="866.1">something wrong with c'mon validation</span> <span data-start="866.1" data-end="867.959">maybe there is something wrong with</span> <span data-start="867.959" data-end="870.42">updating the current state at least</span> <span data-start="870.42" data-end="872.279">you've got a complete track of what</span> <span data-start="872.279" data-end="877.11">happens so you can lock that so if we</span> <span data-start="877.11" data-end="879.06">look at the high level architecture or</span> <span data-start="879.06" data-end="881.25">for an event-driven system will see</span> <span data-start="881.25" data-end="883.019">something like this so on the right hand</span> <span data-start="883.019" data-end="884.279">side who still got our browser</span> <span data-start="884.279" data-end="887.339">application using reactor redux and it</span> <span data-start="887.339" data-end="888.99">still connects up to that same two</span> <span data-start="888.99" data-end="891.06">services the commanding service and the</span> <span data-start="891.06" data-end="894.12">query surface so as far as the client</span> <span data-start="894.12" data-end="896.16">concerns there is really no difference</span> <span data-start="896.16" data-end="897.87">all the difference here is at the back</span> <span data-start="897.87" data-end="900.389">ends the command surface basically takes</span> <span data-start="900.389" data-end="903.06">each command turns into an event it gets</span> <span data-start="903.06" data-end="907.529">stored in its own database whatever you</span> <span data-start="907.529" data-end="908.88">want to use there are different</span> <span data-start="908.88" data-end="911.389">libraries implementations you can use</span> <span data-start="911.389" data-end="913.8">there is a projector surface which</span> <span data-start="913.8" data-end="915.449">basically picks up the whole stream of</span> <span data-start="915.449" data-end="917.85">events coming in and it says well if</span> <span data-start="917.85" data-end="919.829">this event happened and I want to show</span> <span data-start="919.829" data-end="922.23">it in some way and it updates a</span> <span data-start="922.23" data-end="925.05">projection database for it now I've said</span> <span data-start="925.05" data-end="926.85">projection database but it could be</span> <span data-start="926.85" data-end="928.649">plural you could actually project into</span> <span data-start="928.649" data-end="930.72">different databases you might say well</span> </p>
<p><span data-start="930.72" data-end="933.089">I've got a relational database for</span> <span data-start="933.089" data-end="935.67">normal projections but I use elastic</span> <span data-start="935.67" data-end="937.81">search for file searching</span> <span data-start="937.81" data-end="942.4">and I might use MongoDB for documents</span> <span data-start="942.4" data-end="947.35">database for yet other services and the</span> <span data-start="947.35" data-end="949.33">query site actually queries that</span> <span data-start="949.33" data-end="952.42">projection database so why do we need</span> <span data-start="952.42" data-end="954.58">two different databases or projections</span> <span data-start="954.58" data-end="956.83">and the event store well the event store</span> <span data-start="956.83" data-end="958.93">is just a list of everything leading up</span> <span data-start="958.93" data-end="961.12">to the current state which makes it very</span> <span data-start="961.12" data-end="964.45">hard to query for lots of queries now</span> <span data-start="964.45" data-end="965.83">they're actually some queries which are</span> <span data-start="965.83" data-end="968.11">really efficient to do that like you</span> <span data-start="968.11" data-end="970.99">could ask from well whoever drafted the</span> <span data-start="970.99" data-end="973.33">permit and then deleted it within five</span> <span data-start="973.33" data-end="975.94">minutes after that something you found</span> <span data-start="975.94" data-end="978.97">really easily query in normal database</span> <span data-start="978.97" data-end="982">but if you want to know about all</span> <span data-start="982" data-end="984.76">permits for a given drilling platform or</span> <span data-start="984.76" data-end="988.39">all customers that are overdraft that's</span> <span data-start="988.39" data-end="990.4">a lot harder to do in an event database</span> <span data-start="990.4" data-end="993.1">and that's very easy in a projection</span> <span data-start="993.1" data-end="994.3">database because you can basically</span> <span data-start="994.3" data-end="996.82">choose whatever you want and whatever is</span> <span data-start="996.82" data-end="1002.04">most suitable for your need but we can</span> <span data-start="1002.04" data-end="1003.54">actually expand a bit on this</span> <span data-start="1003.54" data-end="1006.18">architecture because if we've got a</span> <span data-start="1006.18" data-end="1009.54">projector surface which receives every</span> <span data-start="1009.54" data-end="1012.06">event we can also create another surface</span> <span data-start="1012.06" data-end="1014.46">which says well I'll also receive all</span> <span data-start="1014.46" data-end="1016.44">events and i'm going to use push</span> <span data-start="1016.44" data-end="1019.05">notifications to all connected clients</span> <span data-start="1019.05" data-end="1021.72">use something like web sockets or socket</span> <span data-start="1021.72" data-end="1024.66">build io or whatever technology you want</span> <span data-start="1024.66" data-end="1027.3">long polling could work but basically</span> <span data-start="1027.3" data-end="1029.55">every client that's connected scan</span> <span data-start="1029.55" data-end="1031.949">indicates whatever data it's interested</span> <span data-start="1031.949" data-end="1034.38">in and it's gets notifications of</span> <span data-start="1034.38" data-end="1036.72">whatever changed it will receive all</span> <span data-start="1036.72" data-end="1040.17">those events now you can have as many</span> <span data-start="1040.17" data-end="1042.569">clients connected as you want someone</span> <span data-start="1042.569" data-end="1045.449">makes a change and everyone else sees</span> <span data-start="1045.449" data-end="1048.3">that change and even if they're editing</span> <span data-start="1048.3" data-end="1050.25">something as long as the two edits are</span> <span data-start="1050.25" data-end="1054.74">not an actual conflict like the current</span> <span data-start="1054.74" data-end="1057.45">bank account balance for a client might</span> <span data-start="1057.45" data-end="1059.67">be updated through an event and another</span> <span data-start="1059.67" data-end="1062.1">user is changing their address well</span> <span data-start="1062.1" data-end="1064.679">we're both related to a customer but</span> <span data-start="1064.679" data-end="1066.81">it's not really a conflict because it's</span> <span data-start="1066.81" data-end="1069.78">different item would be affected by</span> <span data-start="1069.78" data-end="1071.46">different events different commands</span> <span data-start="1071.46" data-end="1073.98">so that would still be perfectly fine to</span> <span data-start="1073.98" data-end="1078.33">update so what does that look on the</span> <span data-start="1078.33" data-end="1080.94">client side well we've got our views</span> <span data-start="1080.94" data-end="1082.95">which is basically what the user sees</span> <span data-start="1082.95" data-end="1085.95">they're typically done with react at</span> <span data-start="1085.95" data-end="1087.659">least in our application that's done</span> <span data-start="1087.659" data-end="1090.27">with react but that could be angular it</span> <span data-start="1090.27" data-end="1094.38">could be some simple view library J</span> <span data-start="1094.38" data-end="1098.37">mustache or something like that we've</span> <span data-start="1098.37" data-end="1100.59">got Redux which is by far the most</span> <span data-start="1100.59" data-end="1104.49">popular flux implementation and it has</span> <span data-start="1104.49" data-end="1107.07">its store which is basically the current</span> <span data-start="1107.07" data-end="1109.169">states of whatever data you are working</span> <span data-start="1109.169" data-end="1112.08">with that gets updated by actions and</span> <span data-start="1112.08" data-end="1114.87">those actions are updated in part by</span> <span data-start="1114.87" data-end="1118.2">user actions in view and imparts by</span> <span data-start="1118.2" data-end="1121.62">server actions from as a result of other</span> <span data-start="1121.62" data-end="1125.1">users being pushed back to web socket</span> </p>
<p><span data-start="1125.1" data-end="1127.32">API so because a really nice</span> <span data-start="1127.32" data-end="1129.11">architecture would really clean</span> <span data-start="1129.11" data-end="1132.36">redefines data flows which makes</span> <span data-start="1132.36" data-end="1134.669">everything very predictable very</span> <span data-start="1134.669" data-end="1139.789">performance and very easy to understand</span> <span data-start="1139.789" data-end="1143.85">now I mentioned projections and a lot of</span> <span data-start="1143.85" data-end="1146.49">time when people start working with</span> <span data-start="1146.49" data-end="1149.039">events or systems projection caused some</span> <span data-start="1149.039" data-end="1151.799">issues what is a projection how shoot it</span> <span data-start="1151.799" data-end="1154.26">look how should you shape your</span> <span data-start="1154.26" data-end="1157.59">projection where should you project well</span> <span data-start="1157.59" data-end="1160.169">it really depends on your needs like</span> </p>
<p><span data-start="1160.169" data-end="1162.299">I've got a map here it's a map of the</span> <span data-start="1162.299" data-end="1167.419">world it's a Mercator projection and I</span> <span data-start="1167.419" data-end="1170.13">at least I assume it's an accurate map I</span> <span data-start="1170.13" data-end="1172.529">haven't actually checked that they've</span> <span data-start="1172.529" data-end="1174.809">got another map of the world here</span> <span data-start="1174.809" data-end="1178.169">basically exactly the same data this is</span> <span data-start="1178.169" data-end="1181.02">a more white projection so they're very</span> <span data-start="1181.02" data-end="1183.45">different projections based on the same</span> <span data-start="1183.45" data-end="1185.13">day that because there are different</span> <span data-start="1185.13" data-end="1187.919">needs if you flip back to the Mercator</span> <span data-start="1187.919" data-end="1190.049">projection if you take a look at</span> </p>
<p><span data-start="1190.049" data-end="1192.57">Greenland the big white blob at the top</span> <span data-start="1192.57" data-end="1196.22">it looks about the same size as Africa</span> <span data-start="1196.22" data-end="1200.34">turns out that's not the case the more</span> <span data-start="1200.34" data-end="1203.46">white projection is specifically made so</span> <span data-start="1203.46" data-end="1205.14">you can compare areas</span> <span data-start="1205.14" data-end="1207.54">so you can see that Greenland is not</span> <span data-start="1207.54" data-end="1209.79">smaller than Africa and reality it's</span> <span data-start="1209.79" data-end="1213.08">about the size of the Arabian Peninsula</span> <span data-start="1213.08" data-end="1215.76">so what's the point of this map then</span> <span data-start="1215.76" data-end="1218.25">well it turns out for navigation if</span> <span data-start="1218.25" data-end="1220.41">you're moving the ship across the ocean</span> <span data-start="1220.41" data-end="1222.45">ricotta projection is really nice</span> <span data-start="1222.45" data-end="1224.7">because if you draw a straight line on a</span> </p>
<p><span data-start="1224.7" data-end="1227.61">Mercator projection map you get a</span> <span data-start="1227.61" data-end="1229.11">straight compass heading and if you</span> <span data-start="1229.11" data-end="1231.24">follow that compass heading assuming</span> <span data-start="1231.24" data-end="1232.65">there is no drift down wind than</span> <span data-start="1232.65" data-end="1234.09">anything which you'll end up exactly</span> <span data-start="1234.09" data-end="1237.48">where you want it to go and with the</span> <span data-start="1237.48" data-end="1239.01">mall wide projection that's not the case</span> <span data-start="1239.01" data-end="1241.62">so different projections based on the</span> <span data-start="1241.62" data-end="1244.86">same data for different needs so it's</span> <span data-start="1244.86" data-end="1247.05">actually fine if you want to start</span> <span data-start="1247.05" data-end="1249.21">projecting out data and you're going to</span> <span data-start="1249.21" data-end="1251.9">project it out in many many different</span> <span data-start="1251.9" data-end="1255.69">shapes depending on your needs and the</span> <span data-start="1255.69" data-end="1258.09">good thing with events or system the</span> <span data-start="1258.09" data-end="1260.55">source of truth is not the projections</span> <span data-start="1260.55" data-end="1264.09">the projections are just read only view</span> <span data-start="1264.09" data-end="1266.91">of whatever the current state the source</span> <span data-start="1266.91" data-end="1270.21">of truth is the stored events so if you</span> <span data-start="1270.21" data-end="1272.1">come up with a new projection you need</span> <span data-start="1272.1" data-end="1274.32">some time later well you can just create</span> <span data-start="1274.32" data-end="1277.11">it based on all the store at events you</span> <span data-start="1277.11" data-end="1279.54">just reread them again and create a new</span> <span data-start="1279.54" data-end="1281.46">projection so you can throw away your</span> <span data-start="1281.46" data-end="1283.92">projections and basically rebuild all of</span> <span data-start="1283.92" data-end="1289.67">that whenever you want to so what does</span> <span data-start="1289.67" data-end="1292.95">the Redux coat look like on the clients</span> </p>
<p><span data-start="1292.95" data-end="1295.43">I've got there a simple example and you</span> <span data-start="1295.43" data-end="1299.97">basically see redux producer which takes</span> <span data-start="1299.97" data-end="1302.49">all the incoming actions like the one I</span> <span data-start="1302.49" data-end="1305.73">see previously and it checks the type</span> <span data-start="1305.73" data-end="1308.58">and it decides how it should handle the</span> <span data-start="1308.58" data-end="1313.23">type by default it kind of says well the</span> <span data-start="1313.23" data-end="1315.21">default action at the bottom I don't</span> <span data-start="1315.21" data-end="1317.07">know anything to do about this action so</span> <span data-start="1317.07" data-end="1318.96">I'm just going to return the state s is</span> <span data-start="1318.96" data-end="1321.63">but in this case for the permit edit or</span> <span data-start="1321.63" data-end="1323.34">permit drafted commands it actually</span> <span data-start="1323.34" data-end="1326.19">knows how to handle those and does</span> <span data-start="1326.19" data-end="1328.95">something and now this only handles the</span> <span data-start="1328.95" data-end="1332.19">case of permits the collection of</span> <span data-start="1332.19" data-end="1334.32">permits it doesn't worry about how to</span> <span data-start="1334.32" data-end="1337.54">handle individual permits</span> <span data-start="1337.54" data-end="1339.44">individual permits are done by a</span> <span data-start="1339.44" data-end="1342.08">different producer so it knows if a</span> <span data-start="1342.08" data-end="1344.81">single permits is drafted how the state</span> <span data-start="1344.81" data-end="1348.16">inside of that permit actually changes</span> <span data-start="1348.16" data-end="1351.38">now redux basically combines all those</span> <span data-start="1351.38" data-end="1355.34">different producers into one complex</span> <span data-start="1355.34" data-end="1358.13">tree and every time an action is fired</span> <span data-start="1358.13" data-end="1360.59">that tree gets a chance to handle that</span> <span data-start="1360.59" data-end="1365.09">and it decides how the current state</span> <span data-start="1365.09" data-end="1368.21">should be so even though the terminology</span> <span data-start="1368.21" data-end="1370.52">is very different than used in the vents</span> <span data-start="1370.52" data-end="1373.88">or existence in reality it's really the</span> <span data-start="1373.88" data-end="1376.82">same thing an action in redux is an</span> <span data-start="1376.82" data-end="1378.89">event in the events or system it's</span> <span data-start="1378.89" data-end="1381.2">something that happens we projected in</span> <span data-start="1381.2" data-end="1383.87">the events or system well we reduce it</span> <span data-start="1383.87" data-end="1387.95">in Redux end result is we've got some</span> <span data-start="1387.95" data-end="1392.51">state to work with so how do we wire</span> <span data-start="1392.51" data-end="1396.83">things up well inside of our react</span> <span data-start="1396.83" data-end="1401.27">application we have a start-up so at the</span> <span data-start="1401.27" data-end="1402.86">bottom you can see that react don't</span> <span data-start="1402.86" data-end="1405.41">render which actually should be react do</span> <span data-start="1405.41" data-end="1407.57">not render this code is slightly old</span> <span data-start="1407.57" data-end="1410.33">sorry about that and you see that our</span> <span data-start="1410.33" data-end="1412.79">application the app elements is wrapped</span> <span data-start="1412.79" data-end="1415.4">inside the provider that provider is</span> <span data-start="1415.4" data-end="1419.45">provided by reacts redux which basically</span> <span data-start="1419.45" data-end="1422.96">connects Redux to react like I mentioned</span> <span data-start="1422.96" data-end="1425.18">before Redux could be used anywhere</span> <span data-start="1425.18" data-end="1427.94">without react but that connects it to up</span> <span data-start="1427.94" data-end="1429.83">and that makes all the day they're</span> <span data-start="1429.83" data-end="1433.16">stored inside our redux store available</span> <span data-start="1433.16" data-end="1439.31">for all react components next thing is</span> <span data-start="1439.31" data-end="1443.24">ok now we need that components to have</span> <span data-start="1443.24" data-end="1445.67">data so one of the first components I</span> <span data-start="1445.67" data-end="1449.48">showed that list of permits needs to</span> <span data-start="1449.48" data-end="1452.5">have the list of permits to display and</span> <span data-start="1452.5" data-end="1456.17">you do let using another thing react</span> </p>
<p><span data-start="1456.17" data-end="1459.02">Redux provides the Kinect function which</span> <span data-start="1459.02" data-end="1461.39">Bailey says will connect up some data</span> <span data-start="1461.39" data-end="1464.24">from the store what well there's a map</span> <span data-start="1464.24" data-end="1467.78">states to props so it map state from the</span> <span data-start="1467.78" data-end="1470.3">store to properties in we have</span> <span data-start="1470.3" data-end="1472.85">and in this case it just says well met</span> <span data-start="1472.85" data-end="1476.42">all the permits from that store into the</span> <span data-start="1476.42" data-end="1478.88">properties of the components so it has</span> <span data-start="1478.88" data-end="1483.14">its list of permits the other thing the</span> <span data-start="1483.14" data-end="1485.27">original component had was that draft</span> <span data-start="1485.27" data-end="1489.05">permit commands so it needs to know how</span> <span data-start="1489.05" data-end="1491.9">to handle that and the second function</span> <span data-start="1491.9" data-end="1493.7">here on the slide is actually intended</span> <span data-start="1493.7" data-end="1496.09">for that so map dates patch to props</span> <span data-start="1496.09" data-end="1499.4">dispatching means dispatch in action so</span> <span data-start="1499.4" data-end="1501.98">some thing in the back end producers</span> <span data-start="1501.98" data-end="1506.51">api's etc get to handle that so with</span> <span data-start="1506.51" data-end="1508.73">this we've basically completed the</span> <span data-start="1508.73" data-end="1511.76">circle we've got reacts components which</span> <span data-start="1511.76" data-end="1514.46">are completely unaware of how the day</span> <span data-start="1514.46" data-end="1516.8">that works they are purely focused on</span> <span data-start="1516.8" data-end="1520.04">rendering we've got Redux which is all</span> <span data-start="1520.04" data-end="1522.86">about the client-side state which is fed</span> <span data-start="1522.86" data-end="1526.1">on the one hand by user actions on the</span> <span data-start="1526.1" data-end="1529.01">other hand by push notifications from</span> <span data-start="1529.01" data-end="1532.07">the server you've got the server which</span> <span data-start="1532.07" data-end="1534.77">stores all the events resulting in the</span> <span data-start="1534.77" data-end="1537.62">commands being sent in a database and</span> <span data-start="1537.62" data-end="1539.96">projects those out into a rig model or</span> <span data-start="1539.96" data-end="1543.41">whatever shape we need and we've got a</span> <span data-start="1543.41" data-end="1548.14">very scalable and very nice architektur</span> <span data-start="1548.14" data-end="1551.48">so with that I'm slightly out of time</span> <span data-start="1551.48" data-end="1555.35">but at the end of my presentation all my</span> <span data-start="1555.35" data-end="1557.3">slides will be a SlideShare later this</span> <span data-start="1557.3" data-end="1559.97">afternoon so on the right hand bottom</span> <span data-start="1559.97" data-end="1562.4">you can see my Twitter accounts if you</span> <span data-start="1562.4" data-end="1564.83">just check my Twitter accounts somewhere</span> <span data-start="1564.83" data-end="1566.96">at the end of the afternoon you'll find</span> <span data-start="1566.96" data-end="1569.42">a tweak there pointing to the slides and</span> <span data-start="1569.42" data-end="1572.66">slide share and with that I would like</span> <span data-start="1572.66" data-end="1575.54">to thank you for inviting me and</span> </p>
</section>