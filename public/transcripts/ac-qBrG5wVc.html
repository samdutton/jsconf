<section>
<p><span data-start="9.349" data-end="13.469">hello hello everybody my name is Matthew</span> <span data-start="13.469" data-end="15.36">foul I'm here to give you a talk on web</span> <span data-start="15.36" data-end="17.94">push away this talk features htb to</span> <span data-start="17.94" data-end="20.279">using push and there's a fantastic</span> <span data-start="20.279" data-end="22.35">protocol that is kind of the reciprocal</span> <span data-start="22.35" data-end="24.66">dual to there's a new push API for</span> <span data-start="24.66" data-end="27.09">getting content to the browser in an</span> <span data-start="27.09" data-end="28.859">asynchronous manner and this is kind of</span> <span data-start="28.859" data-end="30.869">the dual back-end technology that backs</span> <span data-start="30.869" data-end="33.69">that up so welcome to web push away this</span> <span data-start="33.69" data-end="36">is web push generic event delivery using</span> <span data-start="36" data-end="40.95">HTTP push it's pretty rad this talk is</span> <span data-start="40.95" data-end="46.289">pretty rad I think that I excuse me it</span> <span data-start="46.289" data-end="49.2">is rad because uh web pushes itself a</span> <span data-start="49.2" data-end="50.789">web q something that we haven't really</span> <span data-start="50.789" data-end="54">had before in this capability Hugh's</span> <span data-start="54" data-end="55.92">themselves are a pretty great technology</span> <span data-start="55.92" data-end="57.719">we seek Hughes getting use throughout</span> <span data-start="57.719" data-end="59.309">the industry in the back end and it's</span> <span data-start="59.309" data-end="60.3">something that we haven't really been</span> <span data-start="60.3" data-end="62.489">able to use as a resourceful construct</span> <span data-start="62.489" data-end="65.159">on the web we have technologies like</span> </p>
<p><span data-start="65.159" data-end="67.71">Kafka and RabbitMQ which significantly</span> <span data-start="67.71" data-end="70.1">power a lot of our infrastructure and</span> <span data-start="70.1" data-end="72.51">web push really begins to open that</span> <span data-start="72.51" data-end="73.83">capability to something that we can</span> <span data-start="73.83" data-end="75.72">begin to use on the web and that we can</span> <span data-start="75.72" data-end="78.09">exchange as a resource and trade amongst</span> <span data-start="78.09" data-end="80.97">our resources a trade amongst our</span> <span data-start="80.97" data-end="83.369">systems the web is great and one of the</span> <span data-start="83.369" data-end="84.6">main things that I really think makes</span> <span data-start="84.6" data-end="86.07">the web great is the fact that it has</span> <span data-start="86.07" data-end="89.189">that there are resources that the things</span> <span data-start="89.189" data-end="91.049">on the web exists tangibly because they</span> <span data-start="91.049" data-end="95.07">have URLs associated with them there's</span> <span data-start="95.07" data-end="98.13">Tim berners-lee's paper axiomatic sub</span> <span data-start="98.13" data-end="100.29">the web or actually I don't have the</span> <span data-start="100.29" data-end="102.18">name off the top of my head but his</span> <span data-start="102.18" data-end="104.189">axiomatic sub the URL where he discusses</span> <span data-start="104.189" data-end="109.2">the how valuable URL is so a web q a web</span> <span data-start="109.2" data-end="110.34">q is something that should be pretty</span> <span data-start="110.34" data-end="114.24">great web push as a web q has some</span> <span data-start="114.24" data-end="117.93">capabilities it has magic it has HTTP to</span> <span data-start="117.93" data-end="120.63">magic it has push magic it has really</span> <span data-start="120.63" data-end="124.56">great magic it's not actually magic it</span> <span data-start="124.56" data-end="127.95">is actually push and it's probably still</span> <span data-start="127.95" data-end="130.11">great I do think it's definitely</span> <span data-start="130.11" data-end="131.87">something that is worth talking about</span> <span data-start="131.87" data-end="133.5">probably great</span> <span data-start="133.5" data-end="136.05">probably great it's a solid model for a</span> <span data-start="136.05" data-end="137.94">cue it's the first time that I've seen</span> <span data-start="137.94" data-end="139.62">somebody has really stamped out and said</span> <span data-start="139.62" data-end="141.57">what kind of URLs you should be hitting</span> <span data-start="141.57" data-end="144.9">to use a queue and that's really that is</span> <span data-start="144.9" data-end="146.73">the fundamental of like what resourceful</span> <span data-start="146.73" data-end="149.19">means to me it has interesting</span> <span data-start="149.19" data-end="151.74">innovative techniques the push not magic</span> <span data-start="151.74" data-end="154.5">it has an interesting application for</span> <span data-start="154.5" data-end="156.959">getting data into the client whether or</span> <span data-start="156.959" data-end="158.73">not that client is connected to the</span> </p>
<p><span data-start="158.73" data-end="161.82">Internet at that time or not that a</span> <span data-start="161.82" data-end="164.459">queue part of a queue is that you push</span> <span data-start="164.459" data-end="166.14">stuff into a queue and you get stuff out</span> <span data-start="166.14" data-end="168.36">and we'll look at how that can happen in</span> <span data-start="168.36" data-end="170.63">different fashions then online real-time</span> <span data-start="170.63" data-end="173.43">and it is making itself nicely through</span> <span data-start="173.43" data-end="176.1">standardization it was an effort formed</span> <span data-start="176.1" data-end="178.41">by Mozilla and it's now being</span> <span data-start="178.41" data-end="180.66">implemented and the spec is co-authored</span> <span data-start="180.66" data-end="182.37">by Microsoft who's doing some they're</span> <span data-start="182.37" data-end="183.18">doing some very interesting</span> <span data-start="183.18" data-end="185.82">optimizations to really allow a huge</span> <span data-start="185.82" data-end="188.43">number of concurrent push subscriptions</span> <span data-start="188.43" data-end="191.19">to exist all at the same time pardon my</span> <span data-start="191.19" data-end="193.05">formatting here on this one Oh looks</span> <span data-start="193.05" data-end="195.75">great over there I do please pardon the</span> <span data-start="195.75" data-end="197.94">extra bar at the top that's that's where</span> <span data-start="197.94" data-end="199.53">we're at right now I thank you for your</span> <span data-start="199.53" data-end="201.69">forbearance 'as looks a little different</span> <span data-start="201.69" data-end="204.69">on the screen right now related transfer</span> <span data-start="204.69" data-end="206.61">technologies the web's used web hooks</span> <span data-start="206.61" data-end="208.35">for a long time if you want to push to</span> <span data-start="208.35" data-end="210.42">something you just send whoever needs to</span> <span data-start="210.42" data-end="212.13">do the pushing a URL and then you just</span> <span data-start="212.13" data-end="214.17">post the content and that's kind of an</span> <span data-start="214.17" data-end="216.14">implicit construct there's no real</span> <span data-start="216.14" data-end="218.519">reception out of that system there's no</span> <span data-start="218.519" data-end="220.799">no way to withdraw from that it's like a</span> <span data-start="220.799" data-end="223.35">single ingestion acceptance way of</span> <span data-start="223.35" data-end="225.6">getting data in and it there's not</span> <span data-start="225.6" data-end="227.519">really like a well-defined content type</span> <span data-start="227.519" data-end="229.53">for that web hooks been very valuable</span> <span data-start="229.53" data-end="232.35">but it has some severe limitations also</span> <span data-start="232.35" data-end="235.34">notably you cannot web you cannot push</span> <span data-start="235.34" data-end="238.2">using web hooks to a browser there's no</span> </p>
<p><span data-start="238.2" data-end="240.93">URL for you to hit to send data to a</span> <span data-start="240.93" data-end="242.579">browser there have been some very</span> <span data-start="242.579" data-end="244.98">interesting experiments opera had a</span> <span data-start="244.98" data-end="247.95">program opera unite which really was</span> <span data-start="247.95" data-end="250.23">about trying to give a web identity to</span> <span data-start="250.23" data-end="252.15">the browser and that kind of flipped the</span> <span data-start="252.15" data-end="253.38">table and would have made something like</span> <span data-start="253.38" data-end="255.57">web puffs web hooks more viable for the</span> <span data-start="255.57" data-end="258.87">client this talk outline this is the</span> <span data-start="258.87" data-end="260.25">opening thank you very much for being on</span> <span data-start="260.25" data-end="261.209">the opening thank you very much for</span> <span data-start="261.209" data-end="263.16">being at web push away we're going to</span> <span data-start="263.16" data-end="264.36">talk a little bit about the model of</span> <span data-start="264.36" data-end="267.28">what web push protocol protocol is</span> <span data-start="267.28" data-end="268.62">we're going to talk about the technique</span> </p>
<p><span data-start="268.62" data-end="271.72">HTTP to push that powers this all we're</span> <span data-start="271.72" data-end="273.25">going to look at an application which is</span> <span data-start="273.25" data-end="275.65">the push API the front end application</span> <span data-start="275.65" data-end="278.2">that consumes this and binds to it we're</span> <span data-start="278.2" data-end="279.37">going to look at my little</span> <span data-start="279.37" data-end="281.59">implementation just a couple glossy</span> <span data-start="281.59" data-end="283.27">highlights of things that happen when I</span> <span data-start="283.27" data-end="285.31">was making a node server and then we're</span> <span data-start="285.31" data-end="286.84">just going to end up with a little bit</span> <span data-start="286.84" data-end="288.639">of talk on a synchronous bidirectional</span> <span data-start="288.639" data-end="290.77">web and how great web push is going to</span> <span data-start="290.77" data-end="294.61">be so please enjoy it learn a lot please</span> <span data-start="294.61" data-end="296.41">take away and enjoy the resourceful</span> <span data-start="296.41" data-end="299.05">model come and enjoy the asynchronous</span> </p>
<p><span data-start="299.05" data-end="301.21">HTTP two world that we're entering into</span> <span data-start="301.21" data-end="305.98">yes application please this is going to</span> <span data-start="305.98" data-end="307.419">be like a little bit of the reason for</span> <span data-start="307.419" data-end="309.28">like why this all came about and should</span> <span data-start="309.28" data-end="311.919">help really solidify the idea of what</span> <span data-start="311.919" data-end="314.29">this Q can kind of do and then the</span> <span data-start="314.29" data-end="316.27">implementation is my own and this should</span> <span data-start="316.27" data-end="321.07">be pretty epic the model web push is a</span> <span data-start="321.07" data-end="325.99">queue so what is a queue stuff goes in</span> <span data-start="325.99" data-end="329.2">stuff comes out we kind of have an</span> <span data-start="329.2" data-end="331.33">existing model for you if i can get my</span> <span data-start="331.33" data-end="334.14">mouse scroll working or inverse scroll</span> <span data-start="334.14" data-end="336.22">so this is kind of what i think of as a</span> <span data-start="336.22" data-end="339.07">cue stuff goes in stuff comes out of q</span> <span data-start="339.07" data-end="341.89">and in this particular case it happens</span> <span data-start="341.89" data-end="344.919">eventually in the portal and that's kind</span> <span data-start="344.919" data-end="346.72">of an instantaneous effect but a queue</span> <span data-start="346.72" data-end="348.94">often has to hold data for some amount</span> <span data-start="348.94" data-end="351.729">of time as well great so what about a</span> <span data-start="351.729" data-end="354.16">web push q it's just resources it's</span> <span data-start="354.16" data-end="355.539">things with URLs that are running</span> <span data-start="355.539" data-end="357.61">somewhere this q exists on some server</span> <span data-start="357.61" data-end="360.69">or set of servers and it has endpoints a</span> <span data-start="360.69" data-end="363.1">subscription resource is the first kind</span> <span data-start="363.1" data-end="366.52">of is the overarching concept that</span> <span data-start="366.52" data-end="368.71">encapsulates the sub resources that make</span> <span data-start="368.71" data-end="370.66">up a queue you're going to ask for a</span> <span data-start="370.66" data-end="373.03">subscription resource you're going to</span> <span data-start="373.03" data-end="374.47">get back a bunch of different sub</span> <span data-start="374.47" data-end="376.84">resources for that subscription that are</span> <span data-start="376.84" data-end="378.729">the capabilities that you can work do</span> <span data-start="378.729" data-end="382.63">with that subscription and then the push</span> <span data-start="382.63" data-end="384.37">resource is what you use is that sub</span> <span data-start="384.37" data-end="385.84">resource that you use to actually send</span> <span data-start="385.84" data-end="390.52">in to send into the queue it seems</span> <span data-start="390.52" data-end="392.979">pretty simple a pretty basic concept</span> <span data-start="392.979" data-end="394.539">with only a little bit of not magic</span> <span data-start="394.539" data-end="398.229">involved in the middle not magic again</span> <span data-start="398.229" data-end="400.35">push</span> <span data-start="400.35" data-end="406.43">uh oh sorry um please forgive me I</span> <span data-start="406.43" data-end="408.39">didn't catch myself going through that</span> <span data-start="408.39" data-end="410.16">the subscription resource is actually</span> <span data-start="410.16" data-end="411.63">the service that you use to withdraw out</span> <span data-start="411.63" data-end="413.28">of it and the push resource is actually</span> <span data-start="413.28" data-end="415.35">the resource that you use to send into</span> <span data-start="415.35" data-end="418.86">it so that's the pushing and getting the</span> <span data-start="418.86" data-end="420.6">overarching resource that I was speaking</span> <span data-start="420.6" data-end="422.97">of is the push service or no not even</span> <span data-start="422.97" data-end="425.01">note we're not there yet the push</span> <span data-start="425.01" data-end="427.26">message subscription is the actual q</span> <span data-start="427.26" data-end="429.87">constant construct and you get your push</span> <span data-start="429.87" data-end="432.36">message subscription from a push service</span> <span data-start="432.36" data-end="434.58">which is a service that gives you push</span> <span data-start="434.58" data-end="439.38">message subscriptions AKA cues but now</span> <span data-start="439.38" data-end="446.99">on to the we were there forgive me i</span> <span data-start="446.99" data-end="450">guess we're going to note we're still</span> <span data-start="450" data-end="453.03">going into models again step one we need</span> <span data-start="453.03" data-end="454.17">to create the cue we're just going to</span> <span data-start="454.17" data-end="456.6">push to the queue pushing this is per</span> <span data-start="456.6" data-end="458.37">the api contract all you do is push to</span> <span data-start="458.37" data-end="461.52">the via push service and the push</span> <span data-start="461.52" data-end="465.18">service returns you the three different</span> <span data-start="465.18" data-end="467.16">three different resources that you get</span> <span data-start="467.16" data-end="469.56">three different resources to use it you</span> <span data-start="469.56" data-end="472.77">get a push resource you get a receipt</span> <span data-start="472.77" data-end="475.86">resource and you get the actual push</span> <span data-start="475.86" data-end="479.79">message subscription resource and those</span> <span data-start="479.79" data-end="481.8">three different resources are ways of</span> <span data-start="481.8" data-end="484.02">putting stuff in hearing that the data</span> <span data-start="484.02" data-end="485.81">got sent and then getting the data out</span> <span data-start="485.81" data-end="490.14">this contract should be it but the</span> <span data-start="490.14" data-end="491.67">different links are different tools that</span> <span data-start="491.67" data-end="493.8">are used for pushing for the person</span> <span data-start="493.8" data-end="495.75">pushing data in and then the final</span> <span data-start="495.75" data-end="498.33">resource that you get out is what you</span> <span data-start="498.33" data-end="500.4">need to listen to to get messages out of</span> <span data-start="500.4" data-end="503.16">the queue with these are these all</span> <span data-start="503.16" data-end="505.86">created we have a queue and it's kind of</span> <span data-start="505.86" data-end="507.48">up to us to decide what we want to do</span> <span data-start="507.48" data-end="509.1">with that queue there's not really any</span> <span data-start="509.1" data-end="510.48">specified order at this point in the</span> <span data-start="510.48" data-end="511.89">protocol ordering even though you're</span> <span data-start="511.89" data-end="513.479">going to see sequence diagrams that show</span> <span data-start="513.479" data-end="515.849">ordering you can kind of start doing</span> <span data-start="515.849" data-end="517.56">whatever you want with the queue we're</span> <span data-start="517.56" data-end="521.039">just going to pick push and then these</span> <span data-start="521.039" data-end="524.25">are these quotes come from the web push</span> <span data-start="524.25" data-end="526.44">protocol spec so this is requesting</span> <span data-start="526.44" data-end="529.29">message delivery and this is just kind</span> <span data-start="529.29" data-end="530.49">of the words that they give the words</span> <span data-start="530.49" data-end="533.85">are fairly technical and they correspond</span> <span data-start="533.85" data-end="537.75">closely to the glossary but in short</span> <span data-start="537.75" data-end="540.829">it's pretty simple we just push to the</span> <span data-start="540.829" data-end="544.709">resource that we just got back from when</span> <span data-start="544.709" data-end="547.67">we made the subscription message service</span> <span data-start="547.67" data-end="550.67">and we push the content that we want in</span> <span data-start="550.67" data-end="554.79">in reply we get back a success created</span> <span data-start="554.79" data-end="556.949">response and it has a location for that</span> <span data-start="556.949" data-end="560.19">response and so later on we're going to</span> <span data-start="560.19" data-end="562.98">be asking has this message gone through</span> <span data-start="562.98" data-end="565.019">have what messages have gone through and</span> <span data-start="565.019" data-end="566.639">we want to know the messages the stream</span> <span data-start="566.639" data-end="568.47">of messages that are gone through this</span> <span data-start="568.47" data-end="570.029">location is really going to be that key</span> <span data-start="570.029" data-end="572.22">it's going to tell us okay this is that</span> <span data-start="572.22" data-end="574.35">we're going to see this URL come back at</span> <span data-start="574.35" data-end="579.93">us us the pusher a in the receipt stream</span> <span data-start="579.93" data-end="582.449">saying this has gotten to the client the</span> <span data-start="582.449" data-end="584.19">the intermediating server where we've</span> <span data-start="584.19" data-end="586.709">just posted to is going to we're going</span> <span data-start="586.709" data-end="588.24">to be listening to it and it's going to</span> <span data-start="588.24" data-end="591.12">tell us this URL is found and</span> <span data-start="591.12" data-end="592.92">reciprocally also the clients is also</span> <span data-start="592.92" data-end="594.3">going to be seeing this whoever is</span> <span data-start="594.3" data-end="595.649">consuming is also going to be seeing</span> <span data-start="595.649" data-end="598.589">this URL and is going to be using that</span> <span data-start="598.589" data-end="601.529">that same URL to talk about that message</span> <span data-start="601.529" data-end="605.189">that message is server generated so like</span> <span data-start="605.189" data-end="606.6">that's something that we've gotten back</span> <span data-start="606.6" data-end="609.509">as a location from doing this post all</span> <span data-start="609.509" data-end="611.91">we've had to post ourselves into this</span> <span data-start="611.91" data-end="615.329">single post resource with the content</span> <span data-start="615.329" data-end="617.97">and then we've gotten back the location</span> <span data-start="617.97" data-end="622.139">of that content after we posted it this</span> <span data-start="622.139" data-end="624.48">is just more about this is more out of</span> <span data-start="624.48" data-end="628.98">the spec these are two optional fields</span> <span data-start="628.98" data-end="630.569">that can be used when we're pushing data</span> <span data-start="630.569" data-end="632.519">in we've been talking a little bit about</span> <span data-start="632.519" data-end="633.99">the resource about asking for</span> <span data-start="633.99" data-end="636.449">acknowledgement and so the bush receipt</span> <span data-start="636.449" data-end="638.88">header field says when I do get the</span> <span data-start="638.88" data-end="641.819">receipt back when I do get noticed that</span> <span data-start="641.819" data-end="643.56">this resource is successfully made it to</span> <span data-start="643.56" data-end="646.019">a destination the first header the push</span> <span data-start="646.019" data-end="648.509">receipt just says this is who I want you</span> <span data-start="648.509" data-end="650.699">to notify this is like a different Q</span> <span data-start="650.699" data-end="653.009">it's it really is practically a cue that</span> <span data-start="653.009" data-end="657.509">you're sending the push receipt q this /</span> <span data-start="657.509" data-end="660.029">or the bottom header that's who that's</span> <span data-start="660.029" data-end="663.029">going to be the Q that is going to</span> <span data-start="663.029" data-end="664.439">provide that receipt that</span> <span data-start="664.439" data-end="666.66">acknowledgement and then secondarily we</span> <span data-start="666.66" data-end="667.61">have a time to live</span> <span data-start="667.61" data-end="669.41">better if you're pushing stock quotes</span> <span data-start="669.41" data-end="670.64">you don't want to be pushing stock</span> <span data-start="670.64" data-end="672.26">quotes minute after minute after minute</span> <span data-start="672.26" data-end="674.42">after minute at while your client is</span> <span data-start="674.42" data-end="676.39">disconnected for four days in Florida</span> <span data-start="676.39" data-end="679.01">that you're going to have a huge buildup</span> <span data-start="679.01" data-end="681.29">of data and so TTL is an optional field</span> <span data-start="681.29" data-end="682.49">which gives you the parameter to say</span> <span data-start="682.49" data-end="693.47">this Q should only last for this long to</span> <span data-start="693.47" data-end="695.769">be able to really subscribe to the</span> <span data-start="695.769" data-end="698.029">there's a little bit of indirection we</span> <span data-start="698.029" data-end="700.79">just saw in the previous that the push</span> <span data-start="700.79" data-end="703.01">receipt has this / our endpoint and</span> <span data-start="703.01" data-end="708.2">that's a very specific or that's a broad</span> <span data-start="708.2" data-end="711.17">scale Q here we see it we're going to</span> <span data-start="711.17" data-end="713.99">post to / receipts and that's something</span> <span data-start="713.99" data-end="715.579">that we got back when we made the push</span> <span data-start="715.579" data-end="717.56">message subscription that's a like</span> <span data-start="717.56" data-end="719.54">top-level construct that's specific to</span> <span data-start="719.54" data-end="721.49">this subscription there's a little bit</span> <span data-start="721.49" data-end="723.35">of indirection here where we're getting</span> <span data-start="723.35" data-end="726.019">back a we have to push to that and then</span> <span data-start="726.019" data-end="728.66">we get back this /r and that allows a</span> <span data-start="728.66" data-end="730.19">bunch of different push message</span> <span data-start="730.19" data-end="733.519">subscriptions to share this same /r and</span> <span data-start="733.519" data-end="735.05">that way when we want to listen to the</span> <span data-start="735.05" data-end="736.55">receipts we can have a whole bunch of</span> <span data-start="736.55" data-end="738.14">different listens that are all listening</span> <span data-start="738.14" data-end="740.63">to the same receipt and it kind of it</span> <span data-start="740.63" data-end="742.67">it's another level of the resourceful</span> <span data-start="742.67" data-end="746.54">system it's kind of complex it really is</span> <span data-start="746.54" data-end="750.529">for that late binding concept it it</span> <span data-start="750.529" data-end="752.329">really just is a scalability factor</span> <span data-start="752.329" data-end="755.42">that's been added so this is kind of the</span> <span data-start="755.42" data-end="757.579">recap this is what we did to be able to</span> <span data-start="757.579" data-end="759.5">create the queue in the first place and</span> <span data-start="759.5" data-end="761.57">we can see the put the how we put stuff</span> <span data-start="761.57" data-end="763.13">in how we get stuff out and we can see</span> <span data-start="763.13" data-end="764.269">the resource that we're going to use to</span> <span data-start="764.269" data-end="768.17">get receipts another recap this is how</span> <span data-start="768.17" data-end="773.089">we actually create this is how we get</span> <span data-start="773.089" data-end="775.579">back how we like figure out what channel</span> <span data-start="775.579" data-end="776.99">we're going to use to be listening for</span> <span data-start="776.99" data-end="779.899">resources what our particular bind is</span> <span data-start="779.899" data-end="782.36">going to be and then this is how we</span> <span data-start="782.36" data-end="784.399">actually push which is again just a post</span> <span data-start="784.399" data-end="793.13">and that wasn't really that was how we</span> <span data-start="793.13" data-end="794.93">got data in getting data in didn't</span> <span data-start="794.93" data-end="796.339">really we didn't have to talk about HTTP</span> <span data-start="796.339" data-end="798.8">to at all receiving on the other hand is</span> <span data-start="798.8" data-end="800.48">the pole sequence that we have to do</span> <span data-start="800.48" data-end="801.98">to be able to really talk about this we</span> <span data-start="801.98" data-end="803.6">have to talk a little bit about HTTP too</span> <span data-start="803.6" data-end="805.339">we have to talk a little bit about push</span> <span data-start="805.339" data-end="807.35">and it's totally cool if you're not</span> <span data-start="807.35" data-end="809.18">familiar with any of this stuff it's</span> <span data-start="809.18" data-end="810.579">going to be a pretty high level but</span> <span data-start="810.579" data-end="812.75">understanding the concepts and starting</span> <span data-start="812.75" data-end="815.36">to get conversent and familiar with HTTP</span> <span data-start="815.36" data-end="816.889">two is something that I think we should</span> <span data-start="816.889" data-end="820.339">get a good job of here to pull to a</span> <span data-start="820.339" data-end="823.85">queue data we get from it and on the</span> <span data-start="823.85" data-end="828.5">location we have that subscriber excuse</span> <span data-start="828.5" data-end="830.149">me it's from that location that we got</span> <span data-start="830.149" data-end="832.339">from the subscribe response and when we</span> <span data-start="832.339" data-end="837.649">fire this when we fire this off the</span> <span data-start="837.649" data-end="839.93">server never replies to that response we</span> <span data-start="839.93" data-end="842.48">make this get and nothing happens the</span> <span data-start="842.48" data-end="846.56">server leaves that reply unanswered and</span> <span data-start="846.56" data-end="851.209">instead in a normal HTTP scenario that</span> <span data-start="851.209" data-end="852.949">would consume a TCP connection that</span> <span data-start="852.949" data-end="854.93">would consume there would be like this</span> <span data-start="854.93" data-end="858.17">connection open that is keeping that</span> <span data-start="858.17" data-end="860.959">that is preventing any other use of that</span> <span data-start="860.959" data-end="863.6">connection but because this is HTTP too</span> <span data-start="863.6" data-end="865.639">it's a non-blocking environment and</span> <span data-start="865.639" data-end="866.66">we're going to talk a little bit about</span> <span data-start="866.66" data-end="878.42">that so we're going into HTTP to HTTPS</span> <span data-start="878.42" data-end="880.459">about frames it is a messaging protocol</span> <span data-start="880.459" data-end="884.269">for http and HTTP is a respect request</span> <span data-start="884.269" data-end="887.959">response message protocol so what is the</span> <span data-start="887.959" data-end="891.829">message protocol what our frames it HTTP</span> <span data-start="891.829" data-end="894.199">two is kind of encapsulating the</span> <span data-start="894.199" data-end="896.72">individual things that the protocol of</span> </p>
<p><span data-start="896.72" data-end="898.94">HTTP would say but it's giving them</span> <span data-start="898.94" data-end="900.5">containment boundaries it's giving them</span> <span data-start="900.5" data-end="902.959">isolated little chunks that somebody</span> <span data-start="902.959" data-end="904.399">else on the other side of that wire is</span> <span data-start="904.399" data-end="905.779">going to know how to process and know</span> <span data-start="905.779" data-end="908.48">what the means are and this is kind of</span> <span data-start="908.48" data-end="909.92">another more reference this is really</span> <span data-start="909.92" data-end="911.569">good like reading and material into the</span> <span data-start="911.569" data-end="914.81">HTTP to spec this will really like help</span> <span data-start="914.81" data-end="918.079">immerse but like these these components</span> <span data-start="918.079" data-end="920.54">are the frames that we're sending are</span> <span data-start="920.54" data-end="922.519">things that make up normal HTTP traffic</span> <span data-start="922.519" data-end="925.459">so the headers frame is something that</span> <span data-start="925.459" data-end="926.72">you probably already kind of</span> <span data-start="926.72" data-end="928.55">conceptually have an idea of headers</span> <span data-start="928.55" data-end="930.56">frame is just the headers part of the</span> </p>
<p><span data-start="930.56" data-end="933.62">HTTP transmission and as a client</span> <span data-start="933.62" data-end="934.37">talking to</span> <span data-start="934.37" data-end="936.17">server I can just start sending header</span> <span data-start="936.17" data-end="939.14">frames for numerous numerous requests to</span> <span data-start="939.14" data-end="940.64">the server the server is going to be</span> <span data-start="940.64" data-end="942.17">able to understand that these different</span> <span data-start="942.17" data-end="943.97">header frames that it's getting our part</span> <span data-start="943.97" data-end="945.71">of different conversations each of these</span> <span data-start="945.71" data-end="948.14">header frames is the prequel to a stream</span> <span data-start="948.14" data-end="950.21">and then that stream of data the things</span> <span data-start="950.21" data-end="951.83">that happen after the header after the</span> <span data-start="951.83" data-end="956.81">you know get / subscribe like after and</span> <span data-start="956.81" data-end="958.97">then the headers that follow that that</span> <span data-start="958.97" data-end="961.97">is something that conceptually like the</span> <span data-start="961.97" data-end="964.04">server understands as a request and it's</span> <span data-start="964.04" data-end="965.39">going to use the same frames to be able</span> <span data-start="965.39" data-end="968.06">to reply back to the client when it has</span> <span data-start="968.06" data-end="973.61">data to send back it's a pretty big</span> <span data-start="973.61" data-end="977.06">hefty specification HTTP two has a lot</span> <span data-start="977.06" data-end="978.89">of things about how to deal with and</span> <span data-start="978.89" data-end="981.29">manage streams you have to figure out</span> <span data-start="981.29" data-end="983.029">how to be able to set streams and tell</span> <span data-start="983.029" data-end="987.89">streams to cancel how to be able to do</span> <span data-start="987.89" data-end="990.29">priority to decide what to send there's</span> <span data-start="990.29" data-end="992.99">a lot of things going on but it really</span> <span data-start="992.99" data-end="995.029">is messaging in eight it's about being</span> <span data-start="995.029" data-end="996.41">able to launch multiple streams of</span> <span data-start="996.41" data-end="998.15">conversation and that's what this pushes</span> <span data-start="998.15" data-end="1000.04">really has the amazing power to take</span> <span data-start="1000.04" data-end="1004.23">advantage of its a great problem to have</span> <span data-start="1004.23" data-end="1006.13">when you can have these different</span> <span data-start="1006.13" data-end="1007.75">conversations on going at the same time</span> <span data-start="1007.75" data-end="1009.61">when they're you sharing the same</span> <span data-start="1009.61" data-end="1013.089">channel and push promise is one of those</span> <span data-start="1013.089" data-end="1015.58">new frame types that says I'm going to</span> <span data-start="1015.58" data-end="1018.61">send you a stream it's a frame it's kind</span> <span data-start="1018.61" data-end="1020.14">of a parallel to the header frame the</span> <span data-start="1020.14" data-end="1022.089">header frame is what the client says to</span> <span data-start="1022.089" data-end="1025.27">get data I guess the parallel is a</span> <span data-start="1025.27" data-end="1027.79">little bit weak the push promise is I'm</span> <span data-start="1027.79" data-end="1031">going to send or a resource to you and</span> <span data-start="1031" data-end="1032.89">inside of this is going to be normal</span> <span data-start="1032.89" data-end="1035.53">content like this is it really is just</span> <span data-start="1035.53" data-end="1037.63">like the server is sending a reply</span> <span data-start="1037.63" data-end="1039.579">although the client has never made a</span> <span data-start="1039.579" data-end="1048.01">request oh sorry oh I'm so sorry I may</span> <span data-start="1048.01" data-end="1061.91">have been off on my frame count here</span> <span data-start="1061.92" data-end="1066.7">back to our example we've just issued</span> <span data-start="1066.7" data-end="1069.22">this get request to the server it's not</span> <span data-start="1069.22" data-end="1070.93">going to send anything back we've talked</span> <span data-start="1070.93" data-end="1071.98">about how it's just going to leave this</span> <span data-start="1071.98" data-end="1073.3">request open and that's going to make</span> <span data-start="1073.3" data-end="1075.07">sure that the TCP connection stays open</span> <span data-start="1075.07" data-end="1077.23">nothing the the server and the client</span> <span data-start="1077.23" data-end="1079.36">are still engaged with each other by</span> <span data-start="1079.36" data-end="1081.46">leaving this request open however the</span> <span data-start="1081.46" data-end="1082.81">server is going to now have the</span> <span data-start="1082.81" data-end="1084.34">information it needs to know that it can</span> <span data-start="1084.34" data-end="1086.32">start issuing these push promises back</span> <span data-start="1086.32" data-end="1088.33">to the client but it's free to start</span> <span data-start="1088.33" data-end="1092.83">sending data and from there this is just</span> <span data-start="1092.83" data-end="1098.2">kind of more of the specification this</span> <span data-start="1098.2" data-end="1101.14">is we've changed form this is kind of</span> <span data-start="1101.14" data-end="1103.92">the same HTTP diagrams this is the</span> <span data-start="1103.92" data-end="1106.6">factor the layout factor of record the</span> <span data-start="1106.6" data-end="1109.27">common way that people show HTTP two</span> <span data-start="1109.27" data-end="1113.56">frames whereas like we've been using the</span> </p>
<p><span data-start="1113.56" data-end="1116.23">HTTP 1.1 nomenclature to kind of show</span> <span data-start="1116.23" data-end="1118.15">the data and familiarize how request and</span> <span data-start="1118.15" data-end="1119.98">response work this is the same like</span> <span data-start="1119.98" data-end="1121.39">request and response thing and we can</span> <span data-start="1121.39" data-end="1124.03">kind of see the structure here the push</span> <span data-start="1124.03" data-end="1126.76">promise has the method path and</span> <span data-start="1126.76" data-end="1129.22">authority Authority is really it's like</span> <span data-start="1129.22" data-end="1133.24">host more or less and so that's really</span> <span data-start="1133.24" data-end="1135.4">just saying that it is initiating a push</span> <span data-start="1135.4" data-end="1137.62">for this particular resource and we can</span> <span data-start="1137.62" data-end="1139.42">see it's a / D which is going to be one</span> <span data-start="1139.42" data-end="1141.52">of those message resources so the server</span> <span data-start="1141.52" data-end="1143.74">is sending a message and then it has</span> <span data-start="1143.74" data-end="1145.09">some headers that it's going to send</span> <span data-start="1145.09" data-end="1147.01">along with that message and then it has</span> <span data-start="1147.01" data-end="1149.35">the data of actual message so the client</span> <span data-start="1149.35" data-end="1152.29">the the server has pushed data and then</span> <span data-start="1152.29" data-end="1154.18">the client has come back around and is</span> <span data-start="1154.18" data-end="1155.92">now going to receive this push promise</span> <span data-start="1155.92" data-end="1158.01">frame from the server and see this data</span> <span data-start="1158.01" data-end="1160.96">content in and content out and that's</span> <span data-start="1160.96" data-end="1165.72">really the win due to its totally worth</span> <span data-start="1165.72" data-end="1169.36">this is this is exactly how web push</span> <span data-start="1169.36" data-end="1177.94">works this is cues there is also</span> <span data-start="1177.94" data-end="1179.65">receipts we want to be able to know that</span> <span data-start="1179.65" data-end="1181.54">messages got there received add this</span> <span data-start="1181.54" data-end="1185.35">additional slightly of complexity but we</span> <span data-start="1185.35" data-end="1188.08">kind of do the same thing we've just</span> <span data-start="1188.08" data-end="1189.7">pushed the push promise</span> <span data-start="1189.7" data-end="1193.63">the next step is a there's kind of a</span> <span data-start="1193.63" data-end="1195.909">two-step process once the client gets a</span> <span data-start="1195.909" data-end="1197.74">push promise once it starts seeing this</span> <span data-start="1197.74" data-end="1200.11">content it has this address it needs to</span> <span data-start="1200.11" data-end="1203.409">be able to issue a delete on that</span> <span data-start="1203.409" data-end="1205.779">resource once it gets it and that delete</span> <span data-start="1205.779" data-end="1207.34">is just telling the server okay I've</span> <span data-start="1207.34" data-end="1209.2">gotten this thing you can like delete</span> <span data-start="1209.2" data-end="1210.94">this message resource and that's the</span> <span data-start="1210.94" data-end="1212.5">information that the server needs to</span> <span data-start="1212.5" data-end="1214.99">know to be able to say okay like</span> <span data-start="1214.99" data-end="1216.309">somebody's seen this I can acknowledge</span> <span data-start="1216.309" data-end="1218.62">this it's going to assume that nobody</span> <span data-start="1218.62" data-end="1220.33">has seen this message until the client</span> <span data-start="1220.33" data-end="1222.13">turns around and issues this delete on</span> <span data-start="1222.13" data-end="1224.26">the message resource and then once it's</span> <span data-start="1224.26" data-end="1229">done that once it's done that then the</span> <span data-start="1229" data-end="1232.269">server the pusher is also listening on</span> <span data-start="1232.269" data-end="1235.09">the receipt on the / our endpoint and</span> <span data-start="1235.09" data-end="1237.639">the now the pusher the person who's push</span> <span data-start="1237.639" data-end="1239.409">this data out is also going to be</span> <span data-start="1239.409" data-end="1241.72">awaiting more push promises it's going</span> <span data-start="1241.72" data-end="1243.97">to be awaiting its own stream where it</span> <span data-start="1243.97" data-end="1248.95">starts seeing push promises itself again</span> <span data-start="1248.95" data-end="1251.649">for this delete resource and that its</span> <span data-start="1251.649" data-end="1253.84">cue that okay this message is made it</span> <span data-start="1253.84" data-end="1255.159">across the wire this message is</span> <span data-start="1255.159" data-end="1257.23">successfully sent and this is kind of</span> <span data-start="1257.23" data-end="1259.539">cool there's a symmetry here because we</span> <span data-start="1259.539" data-end="1260.95">have two different people using push</span> <span data-start="1260.95" data-end="1262.21">promises we have the people who are</span> <span data-start="1262.21" data-end="1264.58">sending using push promises to hear the</span> <span data-start="1264.58" data-end="1265.779">acknowledgments of the things they've</span> <span data-start="1265.779" data-end="1268.419">sent we also have the people listening</span> <span data-start="1268.419" data-end="1269.98">for the messages in the first place</span> <span data-start="1269.98" data-end="1272.5">using asynchronous HTTP to push</span> <span data-start="1272.5" data-end="1275.98">technology to get these messages and so</span> <span data-start="1275.98" data-end="1277.899">that's really like that those are the</span> <span data-start="1277.899" data-end="1279.57">components of the web push protocol</span> <span data-start="1279.57" data-end="1281.38">we're going to look a little bit about</span> <span data-start="1281.38" data-end="1284.94">very briefly at the push API which is</span> <span data-start="1284.94" data-end="1289.12">it's the client API it's what you as a</span> <span data-start="1289.12" data-end="1291.25">web developer are going to be using to</span> <span data-start="1291.25" data-end="1294.519">be able to create a new cue to be able</span> <span data-start="1294.519" data-end="1297.13">to have a server if you have an</span> <span data-start="1297.13" data-end="1298.57">application server it's what you're</span> <span data-start="1298.57" data-end="1300.07">going to be using on your application</span> <span data-start="1300.07" data-end="1302.47">server to push data to the client it's</span> <span data-start="1302.47" data-end="1303.789">what you're going to be using in the</span> <span data-start="1303.789" data-end="1306.34">client to get the data out of this it</span> <span data-start="1306.34" data-end="1308.019">doesn't specify anything about</span> <span data-start="1308.019" data-end="1309.97">implementation technology there's no</span> <span data-start="1309.97" data-end="1312.37">it's a it's only a front-end to</span> <span data-start="1312.37" data-end="1314.47">interface a well specified front-end to</span> <span data-start="1314.47" data-end="1316.659">interface for how to access this push</span> <span data-start="1316.659" data-end="1318.85">technology and so web push is really</span> <span data-start="1318.85" data-end="1321.7">this backing component that gets used to</span> <span data-start="1321.7" data-end="1322.809">make this happen</span> <span data-start="1322.809" data-end="1325.509">this is a pretty this is a great</span> <span data-start="1325.509" data-end="1330.279">sequence diagram and it it models we're</span> <span data-start="1330.279" data-end="1331.929">going to see a lot of these components</span> <span data-start="1331.929" data-end="1335.86">if we look at the double view this is</span> <span data-start="1335.86" data-end="1337.749">the web push protocol on the left and</span> <span data-start="1337.749" data-end="1340.21">this is the push API on the right and</span> <span data-start="1340.21" data-end="1341.98">there's a lot of symmetry here in both</span> <span data-start="1341.98" data-end="1343.99">cases well we'll take it from the web</span> <span data-start="1343.99" data-end="1347.139">push protocol side we're creating that</span> <span data-start="1347.139" data-end="1349.21">we're issuing a subscribe to create this</span> <span data-start="1349.21" data-end="1350.95">queue resource and then there's this</span> <span data-start="1350.95" data-end="1355.84">monitoring monitoring open cute that's</span> <span data-start="1355.84" data-end="1357.19">happening that's allowing the push</span> <span data-start="1357.19" data-end="1360.19">service and the UA the user agent to be</span> <span data-start="1360.19" data-end="1361.869">able to exchange for the user agent to</span> <span data-start="1361.869" data-end="1367.059">be able to get this data out the user</span> <span data-start="1367.059" data-end="1369.509">agent has to take responsibility for</span> <span data-start="1369.509" data-end="1373.119">sending that push resource the user</span> <span data-start="1373.119" data-end="1374.769">agent has just gotten this queue all</span> <span data-start="1374.769" data-end="1376.35">this information all these endpoints</span> <span data-start="1376.35" data-end="1379.299">about this queue it has to send some of</span> <span data-start="1379.299" data-end="1381.159">those data across the wire to your</span> <span data-start="1381.159" data-end="1382.48">application server so that your</span> <span data-start="1382.48" data-end="1385.539">application server can then know who to</span> <span data-start="1385.539" data-end="1389.35">do the push message to so it has once</span> <span data-start="1389.35" data-end="1391.36">you send the URL across then the</span> <span data-start="1391.36" data-end="1393.369">application server is free to open the</span> <span data-start="1393.369" data-end="1395.32">push endpoint and begin to push data and</span> <span data-start="1395.32" data-end="1399.549">it's up to the push service and the user</span> <span data-start="1399.549" data-end="1402.58">agent who's listening to be able to hear</span> <span data-start="1402.58" data-end="1404.529">and listen and get that data from the</span> <span data-start="1404.529" data-end="1406.36">push service so the push service is</span> <span data-start="1406.36" data-end="1408.58">acting as an intermediary for all of the</span> <span data-start="1408.58" data-end="1410.08">data going through it and that's the</span> <span data-start="1410.08" data-end="1412.269">decoupling that allows the client to be</span> <span data-start="1412.269" data-end="1413.919">disconnected for long extensive time</span> <span data-start="1413.919" data-end="1415.96">while the application server has already</span> <span data-start="1415.96" data-end="1418.269">pushed the data to the push service so</span> <span data-start="1418.269" data-end="1419.769">the push service can hold on to the data</span> <span data-start="1419.769" data-end="1422.32">and then much later down the road way</span> <span data-start="1422.32" data-end="1424.419">more asynchronous this push message can</span> <span data-start="1424.419" data-end="1428.169">go through so we see the exact same</span> <span data-start="1428.169" data-end="1430.72">pattern here this is the push API we</span> <span data-start="1430.72" data-end="1433.179">create the queue we have to subscribe to</span> <span data-start="1433.179" data-end="1434.889">the queue in this case to create the</span> <span data-start="1434.889" data-end="1436.6">subscription we have to distribute the</span> <span data-start="1436.6" data-end="1438.369">resource back to the application server</span> <span data-start="1438.369" data-end="1440.559">and then the push message goes from</span> <span data-start="1440.559" data-end="1442.269">application server to the push resource</span> <span data-start="1442.269" data-end="1444.279">and now we add a little bit more depth</span> <span data-start="1444.279" data-end="1446.2">as we start really modeling how this Q</span> <span data-start="1446.2" data-end="1448.809">gets consumed the user agent takes this</span> <span data-start="1448.809" data-end="1451.419">message the user agent has to send it to</span> <span data-start="1451.419" data-end="1453.46">a service worker and then the service</span> <span data-start="1453.46" data-end="1455.27">worker is has runs</span> <span data-start="1455.27" data-end="1456.8">i encode which is what you have to do</span> <span data-start="1456.8" data-end="1458.63">like it which is where you finally get</span> <span data-start="1458.63" data-end="1460.61">the data so it's a very similar</span> <span data-start="1460.61" data-end="1461.75">structure there's a little bit more</span> <span data-start="1461.75" data-end="1463.25">depth to it just because there's more</span> <span data-start="1463.25" data-end="1467.57">more agents in play but they are like</span> <span data-start="1467.57" data-end="1469.97">identical flows these two were made hand</span> <span data-start="1469.97" data-end="1473.53">in glove to fit one another and that's</span> <span data-start="1473.53" data-end="1477.98">that's what it is as for using the push</span> </p>
<p><span data-start="1477.98" data-end="1480.65">API this is how the push API works in</span> <span data-start="1480.65" data-end="1482.3">the browser this is pretty simple right</span> <span data-start="1482.3" data-end="1484.55">like you're you're inside a</span> <span data-start="1484.55" data-end="1487.13">serviceworker somewhere oh yeah there's</span> <span data-start="1487.13" data-end="1489.17">a little bit of connection establishment</span> <span data-start="1489.17" data-end="1491.72">once your service workers created but</span> <span data-start="1491.72" data-end="1493.43">after you say that you need a</span> <span data-start="1493.43" data-end="1496.52">subscription from that point on all your</span> <span data-start="1496.52" data-end="1499.01">service workers global scope context has</span> <span data-start="1499.01" data-end="1500.69">an on push event that you can bind to</span> <span data-start="1500.69" data-end="1503.33">and you get data out and that event is</span> <span data-start="1503.33" data-end="1505.01">just you're just going to find the data</span> <span data-start="1505.01" data-end="1508.52">inside of event data and this is copied</span> <span data-start="1508.52" data-end="1510.26">verbatim I'm sorry I the hyperlink is</span> <span data-start="1510.26" data-end="1511.61">missing on this one but this is copied</span> <span data-start="1511.61" data-end="1514.91">directly out of the push api</span> <span data-start="1514.91" data-end="1517.67">specification we're going to talk just</span> <span data-start="1517.67" data-end="1520.64">briefly about my implementation web push</span> <span data-start="1520.64" data-end="1523.76">pump this is a node app that I wrote I</span> <span data-start="1523.76" data-end="1525.83">wanted to be able to in the first case</span> <span data-start="1525.83" data-end="1529.13">bridge from IRC to HTTP to push I just</span> <span data-start="1529.13" data-end="1532.55">wanted a way to keep sending IRC into my</span> <span data-start="1532.55" data-end="1534.74">browser on a real-time basis so this is</span> <span data-start="1534.74" data-end="1537.77">a standalone server that I wrote and it</span> <span data-start="1537.77" data-end="1541.04">has separate bridge client applications</span> <span data-start="1541.04" data-end="1543.23">that actually push the IRC data into it</span> <span data-start="1543.23" data-end="1545.6">but there were some really really really</span> <span data-start="1545.6" data-end="1548.21">fun things I really liked how web push</span> <span data-start="1548.21" data-end="1550.61">is so resource oriented that it really</span> <span data-start="1550.61" data-end="1553.22">explicitly calls out the resources for</span> <span data-start="1553.22" data-end="1555.02">pushing and for getting out and I really</span> <span data-start="1555.02" data-end="1558.26">felt very influenced by the URLs that</span> <span data-start="1558.26" data-end="1561.07">were specified in the web push protocol</span> <span data-start="1561.07" data-end="1564.89">and to that effect I kind of created a</span> <span data-start="1564.89" data-end="1566.63">top-level construct for the application</span> <span data-start="1566.63" data-end="1569.18">that just builds collections of these</span> <span data-start="1569.18" data-end="1571.43">base resources and this is something</span> <span data-start="1571.43" data-end="1573.53">that just really simplified my</span> <span data-start="1573.53" data-end="1575.72">application development to conceptually</span> <span data-start="1575.72" data-end="1578.6">have a domain model that's so explicitly</span> <span data-start="1578.6" data-end="1580.73">and tightly matched exactly what my</span> <span data-start="1580.73" data-end="1583.76">protocols model was and so when a user</span> <span data-start="1583.76" data-end="1585.44">doesn't subscribe at the very first</span> <span data-start="1585.44" data-end="1587.33">thing I'm going to add a new subscribe</span> <span data-start="1587.33" data-end="1588.01">object</span> <span data-start="1588.01" data-end="1590.5">into into the very first object and</span> <span data-start="1590.5" data-end="1592.21">subscribe is going to have a push</span> <span data-start="1592.21" data-end="1594.13">elements associated with it and I want</span> <span data-start="1594.13" data-end="1598.39">to push that that /p element into the /</span> </p>
<p><span data-start="1598.39" data-end="1601.54">PQ the the push receipt elements are</span> <span data-start="1601.54" data-end="1604.21">going to go in the push recede element</span> <span data-start="1604.21" data-end="1609.61">etc etc and then from there it made</span> <span data-start="1609.61" data-end="1612.16">things like for this subscriber quest it</span> <span data-start="1612.16" data-end="1614.2">made this very easy for me to to kind of</span> <span data-start="1614.2" data-end="1617.35">build the structure I created there's a</span> <span data-start="1617.35" data-end="1619.96">request i'm using khoa for this i made a</span> <span data-start="1619.96" data-end="1624.67">request context just off of in khoa this</span> <span data-start="1624.67" data-end="1631.18">object this is a node this is a method</span> <span data-start="1631.18" data-end="1632.53">handler like this is what you're going</span> <span data-start="1632.53" data-end="1635.02">to tell khoa like run this code when</span> <span data-start="1635.02" data-end="1637.09">somebody sees to subscribe and this is</span> <span data-start="1637.09" data-end="1638.8">going to be like heavily used by a lot</span> <span data-start="1638.8" data-end="1641.89">of different constructs anyway I the the</span> <span data-start="1641.89" data-end="1643.39">request context is going to be the</span> <span data-start="1643.39" data-end="1645.4">specific like where I start aggregating</span> <span data-start="1645.4" data-end="1647.65">and building the information pertaining</span> <span data-start="1647.65" data-end="1649.81">to this request and on that I've already</span> <span data-start="1649.81" data-end="1654.16">pulled in this context as the context</span> <span data-start="1654.16" data-end="1659.9">here and then I can just kind of well I</span> <span data-start="1659.91" data-end="1662.62">for creating the subscribe I just create</span> <span data-start="1662.62" data-end="1664.18">a new subscribe object I passed in the</span> <span data-start="1664.18" data-end="1666.88">request ctx it's mostly empty it has a</span> <span data-start="1666.88" data-end="1672.86">little bit of metadata the time of the</span> <span data-start="1672.87" data-end="1675.37">this will have like a time stamp on it</span> <span data-start="1675.37" data-end="1676.93">at this point but other than that like</span> <span data-start="1676.93" data-end="1679.18">this is like basically empty it creates</span> <span data-start="1679.18" data-end="1681.49">the subscribe object and I add it to the</span> <span data-start="1681.49" data-end="1683.89">request context and then there's other</span> <span data-start="1683.89" data-end="1685.27">things that I have to create like when</span> <span data-start="1685.27" data-end="1686.92">you're issuing this post to subscribe</span> <span data-start="1686.92" data-end="1689.08">you also have to create the push</span> <span data-start="1689.08" data-end="1690.28">resource and you have to create the</span> <span data-start="1690.28" data-end="1692.59">receipt or source and so I create those</span> <span data-start="1692.59" data-end="1694.27">and those get passed in this request</span> <span data-start="1694.27" data-end="1696.46">context which now has the subscribe</span> <span data-start="1696.46" data-end="1699.22">context and so it's it I can just</span> <span data-start="1699.22" data-end="1701.2">continually pass the same piece of</span> <span data-start="1701.2" data-end="1703.63">context into these constructors and end</span> <span data-start="1703.63" data-end="1705.04">up with these new resources that I'm</span> <span data-start="1705.04" data-end="1707.47">getting out and this was just a pattern</span> <span data-start="1707.47" data-end="1709.33">that took me a lot of like iteration to</span> <span data-start="1709.33" data-end="1711.16">kind of winnow down and get rid of as</span> <span data-start="1711.16" data-end="1712.6">much code as I could until I kind of</span> <span data-start="1712.6" data-end="1714.7">ended with this base core and it really</span> <span data-start="1714.7" data-end="1716.2">made things like really simple and it</span> <span data-start="1716.2" data-end="1719.95">was a really cool pattern for me the</span> <span data-start="1719.95" data-end="1722.02">next kind of capability that I added</span> <span data-start="1722.02" data-end="1724.06">was a created of projection view system</span> <span data-start="1724.06" data-end="1726.58">using mutation observers which r.i.p</span> <span data-start="1726.58" data-end="1729.49">rest in peace are no more but they're</span> <span data-start="1729.49" data-end="1731.2">pretty easy to you re implement with</span> <span data-start="1731.2" data-end="1734.86">proxies and this is really this was a</span> <span data-start="1734.86" data-end="1737.11">really cool concept so I you're going to</span> <span data-start="1737.11" data-end="1739.84">have all these /s resources that i have</span> <span data-start="1739.84" data-end="1741.82">to like deal with and manage and look up</span> <span data-start="1741.82" data-end="1743.56">and rather than kind of like maintain</span> <span data-start="1743.56" data-end="1745.63">the indexes for this myself manually i</span> <span data-start="1745.63" data-end="1748.06">created this projection tool which</span> <span data-start="1748.06" data-end="1751.36">allows me to just uh if this is that the</span> <span data-start="1751.36" data-end="1760.72">it's vista ass the contexts s but so for</span> <span data-start="1760.72" data-end="1763.27">this list of /s azure for this object of</span> <span data-start="1763.27" data-end="1766.39">/s is this will create a mapping from</span> <span data-start="1766.39" data-end="1770.35">the S will have the dot s will</span> <span data-start="1770.35" data-end="1772.33">understand and have a link to the parent</span> <span data-start="1772.33" data-end="1775.66">subscribe the the main queue and so it's</span> <span data-start="1775.66" data-end="1777.4">going to pull out the mapping is going</span> <span data-start="1777.4" data-end="1780.82">to be so I'm creating a mapping from to</span> <span data-start="1780.82" data-end="1782.47">something so it's creating the mapping</span> <span data-start="1782.47" data-end="1784.57">from the s dot subscribe from the</span> <span data-start="1784.57" data-end="1786.37">mapping from that like subscribe</span> <span data-start="1786.37" data-end="1790.66">property of this s collection out to the</span> <span data-start="1790.66" data-end="1795.58">primary key for this s object s symbol</span> <span data-start="1795.58" data-end="1800.83">is like a primary key that so that this</span> <span data-start="1800.83" data-end="1803.38">becomes a functional mapping where I can</span> <span data-start="1803.38" data-end="1805.51">if I need to figure out what s is do I</span> <span data-start="1805.51" data-end="1807.97">have the tie to a subscribe I can just</span> <span data-start="1807.97" data-end="1810.85">ask for that subscribe ID and it will</span> <span data-start="1810.85" data-end="1812.8">get back all of these esas and this this</span> <span data-start="1812.8" data-end="1814.57">is like an index that because of</span> <span data-start="1814.57" data-end="1816.25">mutation observers keeps itself up to</span> <span data-start="1816.25" data-end="1818.05">date I found that this really like cut</span> <span data-start="1818.05" data-end="1819.88">down on the amount of code that I had to</span> <span data-start="1819.88" data-end="1823.27">maintain and keep going all the link</span> <span data-start="1823.27" data-end="1824.62">relationships that I needed to keep</span> <span data-start="1824.62" data-end="1827.01">having I also just kind of as a</span> <span data-start="1827.01" data-end="1829.48">premature optimization opted to use</span> <span data-start="1829.48" data-end="1832.06">symbols as all of my primary keys in</span> </p>
<p><span data-start="1832.06" data-end="1835.06">JavaScript symbols are a new es dot star</span> <span data-start="1835.06" data-end="1838.66">feature that rather than kind of look up</span> <span data-start="1838.66" data-end="1841.36">objects with string based identifiers</span> <span data-start="1841.36" data-end="1844.23">there's a new symbol identifier which</span> <span data-start="1844.23" data-end="1847.63">supposedly perhaps maybe frees you from</span> <span data-start="1847.63" data-end="1851.56">some of the kind of task of like having</span> <span data-start="1851.56" data-end="1853.63">to look up and hash or string to figure</span> <span data-start="1853.63" data-end="1855.52">out where in the object you have to go</span> <span data-start="1855.52" data-end="1855.81">look</span> <span data-start="1855.81" data-end="1857.97">it up it's kind of like a somewhat of a</span> <span data-start="1857.97" data-end="1859.71">performant it's a potential performance</span> <span data-start="1859.71" data-end="1861.6">optimization that just allows things to</span> <span data-start="1861.6" data-end="1863.61">go simpler it also just kind of kept me</span> <span data-start="1863.61" data-end="1865.37">honest it made sure that I wasn't using</span> <span data-start="1865.37" data-end="1867.63">passing around string data and that I</span> <span data-start="1867.63" data-end="1871.41">did that since i can't really like look</span> <span data-start="1871.41" data-end="1874.53">at symbols it just made sure that the</span> <span data-start="1874.53" data-end="1878.07">links all had to it it's hard for me to</span> </p>
<p><span data-start="1878.07" data-end="1879.33">I guess to equivocate that one but it</span> <span data-start="1879.33" data-end="1882.45">gave me some additional checks that I</span> <span data-start="1882.45" data-end="1883.86">had to look at when I was developing it</span> <span data-start="1883.86" data-end="1886.65">um that's most of the like really cool</span> <span data-start="1886.65" data-end="1888.75">things with a web push pump protocol the</span> <span data-start="1888.75" data-end="1890.31">rest of it is a pretty regular khoa</span> <span data-start="1890.31" data-end="1891.75">application but I thought those were</span> <span data-start="1891.75" data-end="1893.1">some pretty awesome gems that kind of</span> <span data-start="1893.1" data-end="1896.61">shook out from developing this overall I</span> <span data-start="1896.61" data-end="1898.29">see web Porsche is really an advancement</span> <span data-start="1898.29" data-end="1899.67">towards an asynchronous and</span> <span data-start="1899.67" data-end="1902.85">bi-directional web it has some small</span> <span data-start="1902.85" data-end="1905.16">bits to it we noted that the pushes were</span> <span data-start="1905.16" data-end="1906.99">hope ache when we pushed in the server</span> <span data-start="1906.99" data-end="1910.05">kind of replied to us with the URL for</span> <span data-start="1910.05" data-end="1911.73">what we had just pushed in and told us</span> <span data-start="1911.73" data-end="1915.51">what that receive that resource the</span> <span data-start="1915.51" data-end="1917.61">identity after it was pushed in and so</span> <span data-start="1917.61" data-end="1920.28">that that kind of explicitly means that</span> <span data-start="1920.28" data-end="1922.59">we can't be pushing resources we have to</span> <span data-start="1922.59" data-end="1924.48">like if we wanted to push a resource</span> <span data-start="1924.48" data-end="1926.13">we'd have to come up with like some JSON</span> <span data-start="1926.13" data-end="1928.77">or a message pack encoding for what an</span> </p>
<p><span data-start="1928.77" data-end="1931.59">HTTP resource might look like and push</span> <span data-start="1931.59" data-end="1935.01">that like encoded resource out if we</span> <span data-start="1935.01" data-end="1936.96">wanted to like be web full if we wanted</span> <span data-start="1936.96" data-end="1938.73">to be resourceful with the things that</span> <span data-start="1938.73" data-end="1940.89">we are sending we can't explicitly say</span> <span data-start="1940.89" data-end="1942.78">what it is that we're sending and so</span> <span data-start="1942.78" data-end="1944.67">that's that's a constraint that's</span> <span data-start="1944.67" data-end="1946.02">something that was kind of designed into</span> <span data-start="1946.02" data-end="1947.7">the web push protocol that's how it's</span> <span data-start="1947.7" data-end="1949.53">supposed to work but it's it still kind</span> <span data-start="1949.53" data-end="1950.55">of keeps us a little bit away from</span> <span data-start="1950.55" data-end="1953.1">really a web where we have like a fully</span> <span data-start="1953.1" data-end="1955.38">asynchronous web or where we can really</span> <span data-start="1955.38" data-end="1956.97">begin to talk about sending data in</span> <span data-start="1956.97" data-end="1961.11">really different ways and second this is</span> <span data-start="1961.11" data-end="1962.97">really the only way this is not a</span> <span data-start="1962.97" data-end="1966.42">critique on web push per se but it was a</span> <span data-start="1966.42" data-end="1972.62">really extensive chart of activity that</span> <span data-start="1972.62" data-end="1975.75">like this diagram is what it took for us</span> <span data-start="1975.75" data-end="1977.22">to be able to start pushing data to the</span> <span data-start="1977.22" data-end="1978.9">browser there's like a lot of different</span> <span data-start="1978.9" data-end="1980.16">agencies at play there's a lot of</span> <span data-start="1980.16" data-end="1981.9">different work at play and this is all</span> <span data-start="1981.9" data-end="1984.72">just so that wet HTTP to push could get</span> <span data-start="1984.72" data-end="1986.25">used so that we could start pushing</span> <span data-start="1986.25" data-end="1988.17">resources and that the client could get</span> <span data-start="1988.17" data-end="1989.52">notified when these resource</span> <span data-start="1989.52" data-end="1991.2">were pushed to it we've talked a little</span> <span data-start="1991.2" data-end="1992.64">bit about how it's asynchronous and</span> <span data-start="1992.64" data-end="1995.16">decoupled and how like the client might</span> <span data-start="1995.16" data-end="1996.84">not be connected but when the client is</span> <span data-start="1996.84" data-end="1998.76">connected and sitting there it's still</span> <span data-start="1998.76" data-end="2000.41">like a very important use case that the</span> <span data-start="2000.41" data-end="2001.58">client wants to be able to get real-time</span> <span data-start="2001.58" data-end="2003.2">data to it and that's something that we</span> <span data-start="2003.2" data-end="2004.82">spent a lot of effort and work doing</span> <span data-start="2004.82" data-end="2007.25">we've built server server sent events we</span> <span data-start="2007.25" data-end="2010.97">built web sockets and this is web HTTP</span> <span data-start="2010.97" data-end="2013.25">to push kind of proposes something a</span> <span data-start="2013.25" data-end="2014.87">little bit different for what HTTP do</span> <span data-start="2014.87" data-end="2016.82">you can do and this is a really very</span> <span data-start="2016.82" data-end="2020.12">complex set of technologies web push is</span> <span data-start="2020.12" data-end="2022.85">a complex set of technologies that have</span> <span data-start="2022.85" data-end="2024.44">to kind of work very carefully together</span> <span data-start="2024.44" data-end="2027.89">to make that possible but it doesn't</span> <span data-start="2027.89" data-end="2032.78">tell us it's still there is kind of a</span> <span data-start="2032.78" data-end="2034.52">little bit of a workaround like if you</span> <span data-start="2034.52" data-end="2036.2">do really want to be able to just push</span> <span data-start="2036.2" data-end="2039.71">the client you can push to the client</span> <span data-start="2039.71" data-end="2041.36">and then have the client via some out of</span> <span data-start="2041.36" data-end="2043.37">bands method just ask the server</span> <span data-start="2043.37" data-end="2046.49">directly very straightforwardly have you</span> <span data-start="2046.49" data-end="2049.04">pushed any resources to me we can use</span> <span data-start="2049.04" data-end="2051.32">server sent events for example so you</span> <span data-start="2051.32" data-end="2053.03">can use HTTP to push and then</span> <span data-start="2053.03" data-end="2056.33">out-of-band say by the way I've pushed</span> <span data-start="2056.33" data-end="2058.399">you all of this data so that's kind of a</span> <span data-start="2058.399" data-end="2060.71">workaround that an alternative path that</span> <span data-start="2060.71" data-end="2062.45">you might Forge if you wanted to do push</span> <span data-start="2062.45" data-end="2064.61">in a way outside of web push without</span> <span data-start="2064.61" data-end="2066.679">these very specific browser imposed</span> <span data-start="2066.679" data-end="2068.51">constraints in this very specific</span> <span data-start="2068.51" data-end="2070.55">formulation if you just want to have an</span> <span data-start="2070.55" data-end="2072.35">open push connection and see data out of</span> <span data-start="2072.35" data-end="2075.679">it you there's no ways that the there's</span> <span data-start="2075.679" data-end="2077.39">no way as the client to explicitly be</span> <span data-start="2077.39" data-end="2078.77">told that you're getting these pushes</span> <span data-start="2078.77" data-end="2081.02">happening to you if you're not using web</span> <span data-start="2081.02" data-end="2083.99">push but you can open a connection and</span> <span data-start="2083.99" data-end="2086.09">start creating your own protocols to say</span> <span data-start="2086.09" data-end="2087.74">by the way I've pushed you some data you</span> <span data-start="2087.74" data-end="2092.96">should look I'm really excited for web</span> <span data-start="2092.96" data-end="2094.49">push I really think this is like a new</span> <span data-start="2094.49" data-end="2098.36">era in web development that htb to</span> <span data-start="2098.36" data-end="2100.34">really begins to open up a new set of</span> <span data-start="2100.34" data-end="2101.89">capabilities I think push is</span> <span data-start="2101.89" data-end="2105.92">fantastically interesting and like web</span> <span data-start="2105.92" data-end="2107.63">push is a great demonstration I think</span> <span data-start="2107.63" data-end="2109.64">we're also going to see HTTP to push</span> <span data-start="2109.64" data-end="2112.16">used within the data center to start</span> <span data-start="2112.16" data-end="2114.38">replacing some of the existing means</span> <span data-start="2114.38" data-end="2116.6">that we have like Kafka and RabbitMQ</span> <span data-start="2116.6" data-end="2120.32">those are more like larger technologies</span> </p>
<p><span data-start="2120.32" data-end="2123.14">HTTP two is really just a protocol but I</span> <span data-start="2123.14" data-end="2124.73">I think it serves a great basis to kind</span> <span data-start="2124.73" data-end="2126.109">of do a lot of things that we've been</span> <span data-start="2126.109" data-end="2128.42">doing while doing it in a more web way</span> <span data-start="2128.42" data-end="2130.309">without having to have outside paths</span> <span data-start="2130.309" data-end="2133.46">doing that I'm super excited to talk to</span> <span data-start="2133.46" data-end="2135.349">you about web push away I think the</span> <span data-start="2135.349" data-end="2137.059">future is very exciting and I look</span> <span data-start="2137.059" data-end="2138.799">forward to seeing all the great things</span> <span data-start="2138.799" data-end="2139.88">that everyone goes out there and does</span> </p>
</section>