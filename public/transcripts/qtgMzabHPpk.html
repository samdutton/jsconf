<section>
<p><span data-start="9.05" data-end="11.4">today I'm going to talk about react GS</span> <span data-start="11.4" data-end="13.65">and unfortunately you can't see the</span> <span data-start="13.65" data-end="16.08">picture but this is a picture of a bunch</span> <span data-start="16.08" data-end="17.85">of turtles sitting on top of each other</span> <span data-start="17.85" data-end="20.189">and I've tried to use the the subtitle</span> <span data-start="20.189" data-end="21.689">JavaScript Turtles all the way down and</span> <span data-start="21.689" data-end="25.199">I hope you'll see what I mean as we go</span> <span data-start="25.199" data-end="31.949">forward so we're experiencing this</span> <span data-start="31.949" data-end="35.43">progression of JavaScript adoption in</span> <span data-start="35.43" data-end="38.1">lots of places you wouldn't expect it so</span> <span data-start="38.1" data-end="40.379">this is a typical web stack you know</span> <span data-start="40.379" data-end="41.91">you've got the browser layer you've got</span> <span data-start="41.91" data-end="43.26">the server layer you've got a dad base</span> <span data-start="43.26" data-end="46.53">layer and the typical stack kind of</span> <span data-start="46.53" data-end="47.879">looks like this or at least the</span> <span data-start="47.879" data-end="49.11">traditional one does you've got</span> <span data-start="49.11" data-end="51.3">javascript in your browser the powers of</span> <span data-start="51.3" data-end="53.25">you I you know shows your countdown</span> <span data-start="53.25" data-end="55.89">whatever and you've got some kind of</span> <span data-start="55.89" data-end="57.84">server-side language like Java Ruby PHP</span> </p>
<p><span data-start="57.84" data-end="61.32">Python the list goes on and then inside</span> <span data-start="61.32" data-end="64.29">your database you have SQL well so now</span> <span data-start="64.29" data-end="66.6">we have no GS right so we can build</span> <span data-start="66.6" data-end="69.24">great server applications in JavaScript</span> <span data-start="69.24" data-end="71.7">which is totally awesome but you notice</span> <span data-start="71.7" data-end="74.909">that that a little section there the DB</span> <span data-start="74.909" data-end="77.28">hasn't changed yet so what can we do to</span> <span data-start="77.28" data-end="81.42">bring JavaScript to the database so like</span> <span data-start="81.42" data-end="82.89">all these turtles that are marching</span> <span data-start="82.89" data-end="84.54">toward the sea and I hope you can see</span> <span data-start="84.54" data-end="87.42">that we're on a path and that path is</span> <span data-start="87.42" data-end="91.17">adoption of JavaScript in all places all</span> <span data-start="91.17" data-end="93.45">right so you're probably saying what</span> <span data-start="93.45" data-end="96.119">about CouchDB couch TV has javascript</span> <span data-start="96.119" data-end="99.75">and couch TV is great I like couchdb a</span> <span data-start="99.75" data-end="102.329">lot and I'm going to apologize advance</span> <span data-start="102.329" data-end="104.909">for this straw man argument so no</span> <span data-start="104.909" data-end="106.74">offense to any of the couch GBI guys</span> <span data-start="106.74" data-end="110.25">there in the that are in the room it has</span> <span data-start="110.25" data-end="113.34">been my experience even long before i</span> <span data-start="113.34" data-end="115.32">started at ba show that the types of</span> <span data-start="115.32" data-end="116.969">applications people want to build with</span> </p>
<p><span data-start="116.969" data-end="120.03">CouchDB are not the types of</span> <span data-start="120.03" data-end="121.619">applications that people would want to</span> <span data-start="121.619" data-end="123.86">have</span> <span data-start="123.86" data-end="126.03">I'm sorry not the same types of</span> <span data-start="126.03" data-end="127.65">applications that you would write for</span> <span data-start="127.65" data-end="132.209">nodejs and so in a sense you don't want</span> <span data-start="132.209" data-end="135.09">to end up like this turtle and if you</span> <span data-start="135.09" data-end="136.98">can't see it there's a car on the road</span> <span data-start="136.98" data-end="140.13">way behind him you know you want to</span> <span data-start="140.13" data-end="142.95">rather be like these turtles right you</span> <span data-start="142.95" data-end="147.03">want to be no GS ninjas so I'm going to</span> <span data-start="147.03" data-end="148.86">tell you a bit about rioc and why you</span> <span data-start="148.86" data-end="151.23">should use Frank's awesome rioc GS</span> <span data-start="151.23" data-end="156.48">driver so say hi to Frank later so what</span> <span data-start="156.48" data-end="160.32">is react react is a distributed fault</span> <span data-start="160.32" data-end="163.35">tolerant replicated data store so if you</span> <span data-start="163.35" data-end="166.47">think of like a lot of people are</span> <span data-start="166.47" data-end="167.94">familiar with CouchDB a lot of people</span> <span data-start="167.94" data-end="169.35">familiar with Redis in the room I'm</span> <span data-start="169.35" data-end="172.86">assuming it's a key value store but the</span> <span data-start="172.86" data-end="174.72">big difference is that all of your data</span> <span data-start="174.72" data-end="176.73">is replicated a bunch of among a bunch</span> <span data-start="176.73" data-end="179.22">of machines so we like to say your data</span> <span data-start="179.22" data-end="182.22">is safe with us you can lose a machine</span> <span data-start="182.22" data-end="185.85">your data is still available the next</span> <span data-start="185.85" data-end="188.78">thing is that it scales out linearly so</span> <span data-start="188.78" data-end="191.67">you know a lot of people say lots of</span> <span data-start="191.67" data-end="195.269">things about scalability and what we say</span> <span data-start="195.269" data-end="197.459">is just add more machines so this is not</span> <span data-start="197.459" data-end="200.1">that every machine has all your data but</span> <span data-start="200.1" data-end="203.13">every machine can serve any requests for</span> <span data-start="203.13" data-end="207.81">any client and react also has a flexible</span> <span data-start="207.81" data-end="210.69">data model which means it's essentially</span> <span data-start="210.69" data-end="212.88">key value but you have a couple extras</span> <span data-start="212.88" data-end="214.38">which I'll talk about in the course of</span> <span data-start="214.38" data-end="217.44">this talk and you have MapReduce and we</span> <span data-start="217.44" data-end="219.18">also have a pretty recently released</span> <span data-start="219.18" data-end="221.609">react search now of course with a</span> <span data-start="221.609" data-end="223.829">flexible data model great power comes</span> <span data-start="223.829" data-end="226.739">great responsibility so in your app</span> <span data-start="226.739" data-end="227.94">you're going to have to take a little</span> <span data-start="227.94" data-end="229.709">bit more ownership of how you structure</span> <span data-start="229.709" data-end="232.32">and manipulate your data now I've</span> <span data-start="232.32" data-end="234.48">glossed over a lot of the the high level</span> <span data-start="234.48" data-end="238.01">features of react but Matthias who's</span> <span data-start="238.01" data-end="241.019">taking some awesome pictures today made</span> <span data-start="241.019" data-end="244.5">this awesome animated gif and I think it</span> <span data-start="244.5" data-end="246.48">explains better than what I could do in</span> <span data-start="246.48" data-end="250.35">words how rioc works so in this little</span> <span data-start="250.35" data-end="252.39">animated gif you've got eight nodes in</span> <span data-start="252.39" data-end="254.28">your cluster you sent a request to one</span> <span data-start="254.28" data-end="256.01">it goes out to three</span> <span data-start="256.01" data-end="259.52">and then if you lose one the data goes</span> <span data-start="259.52" data-end="261.62">to some other node that might have a</span> <span data-start="261.62" data-end="264.1">copy or store copy when that other node</span> <span data-start="264.1" data-end="266.93">node that was lost comes back the data</span> <span data-start="266.93" data-end="270.17">goes back where it belongs oh yeah and</span> <span data-start="270.17" data-end="273.5">it has javascript so let's talk about</span> <span data-start="273.5" data-end="277.1">rioc GS I pointed out Frank earlier it's</span> <span data-start="277.1" data-end="278.72">also react is also has this beautiful</span> <span data-start="278.72" data-end="280.79">website which has some pretty awesome</span> <span data-start="280.79" data-end="282.82">documentation on it how to get started</span> <span data-start="282.82" data-end="285.23">but let's talk a little bit more detail</span> <span data-start="285.23" data-end="287.57">about that so to get started with react</span> </p>
<p><span data-start="287.57" data-end="289.31">GS you want to download react or react</span> <span data-start="289.31" data-end="292.43">search download stop basho calm has all</span> <span data-start="292.43" data-end="295.25">the binary packages and also if you want</span> <span data-start="295.25" data-end="297.47">to bother building it yourself there's</span> <span data-start="297.47" data-end="300.71">source package available then you'll mpm</span> <span data-start="300.71" data-end="302.57">stall rioc GS and i like the latest</span> <span data-start="302.57" data-end="306.83">because you know the the production</span> <span data-start="306.83" data-end="309.35">releases are kind of erratic but the</span> <span data-start="309.35" data-end="311.48">latest stuff is always awesome works</span> <span data-start="311.48" data-end="314.59">with node node 0 40 or you can clone it</span> <span data-start="314.59" data-end="319.97">beyond the bleeding edge so let's see</span> <span data-start="319.97" data-end="321.68">what I also i got in here ok so let's</span> <span data-start="321.68" data-end="323.44">look at the basic client operations</span> <span data-start="323.44" data-end="330.16">isn't that a cute little turtle ok so</span> <span data-start="330.16" data-end="332.87">the operations for the client are really</span> <span data-start="332.87" data-end="335.09">simple you're required react GSU call</span> <span data-start="335.09" data-end="336.83">get client on the the module that's</span> <span data-start="336.83" data-end="339.08">exported and that gives you your basic</span> <span data-start="339.08" data-end="341.3">client like you would expect with any</span> <span data-start="341.3" data-end="344.66">other node library and then so if you</span> <span data-start="344.66" data-end="347.03">want to fetch an object out of rioc you</span> <span data-start="347.03" data-end="350.15">give it a bucketing key all of your keys</span> <span data-start="350.15" data-end="352.25">in react or namespace within a bucket</span> <span data-start="352.25" data-end="353.57">you don't have to create them ahead of</span> <span data-start="353.57" data-end="355.58">time but they provide a nice way to</span> <span data-start="355.58" data-end="359.18">organize your data and just like most</span> <span data-start="359.18" data-end="362.66">node drivers you send it a call back so</span> <span data-start="362.66" data-end="364.64">your data actually doesn't return from</span> <span data-start="364.64" data-end="368.99">that function call it's passed to the</span> <span data-start="368.99" data-end="371.03">callback and the callback like you're</span> <span data-start="371.03" data-end="373.7">used to as the very first argument is</span> <span data-start="373.7" data-end="375.41">going to be an error object if there was</span> <span data-start="375.41" data-end="377.24">on and the next one is going to be the</span> <span data-start="377.24" data-end="380.51">actual data you got back from react so</span> <span data-start="380.51" data-end="382.28">in this case we're logging to the</span> <span data-start="382.28" data-end="384.86">console that we found that object if you</span> <span data-start="384.86" data-end="387.71">want to store an object you do a very</span> <span data-start="387.71" data-end="389.84">similar thing and you can pass it Jason</span> <span data-start="389.84" data-end="392.06">to store the object automatically</span> <span data-start="392.06" data-end="393.82">marchal that and ship it off to react</span> <span data-start="393.82" data-end="396.65">and when you request it back it will</span> <span data-start="396.65" data-end="401.479">also come back in in JSON so just fair</span> <span data-start="401.479" data-end="404.03">warning from now on i alighted the cop</span> <span data-start="404.03" data-end="405.38">the callback because it just kind of</span> <span data-start="405.38" data-end="407.84">adds some extra noise but you'll want to</span> <span data-start="407.84" data-end="409.91">be using that callback to get get</span> <span data-start="409.91" data-end="413.11">information about your your your request</span> <span data-start="413.11" data-end="417.62">okay so obviously you can you can fetch</span> <span data-start="417.62" data-end="419.36">objects you can store them you can also</span> <span data-start="419.36" data-end="422.78">remove them you can check they exists</span> <span data-start="422.78" data-end="425.06">and looks like my my flipping is messed</span> <span data-start="425.06" data-end="427.04">up this is a cool new feature that Frank</span> <span data-start="427.04" data-end="430.669">just pushed out yesterday right yeah so</span> <span data-start="430.669" data-end="432.889">rioc has the ability to stream lists of</span> <span data-start="432.889" data-end="435.59">keys that you have stored so you can</span> <span data-start="435.59" data-end="438.86">pass it this keys stream if you want to</span> <span data-start="438.86" data-end="440.21">find out what keys are in the framework</span> <span data-start="440.21" data-end="443.87">bucket and and then it returns an event</span> <span data-start="443.87" data-end="446">emitter so you can listen for the keys</span> <span data-start="446" data-end="450.91">event on that and then start the request</span> <span data-start="450.91" data-end="455.62">yeah event mentors are awesome use them</span> <span data-start="455.62" data-end="459.2">so you can get all the the objects from</span> <span data-start="459.2" data-end="461.24">that bucket if you want and I'm sorry I</span> <span data-start="461.24" data-end="462.8">use objects loosely it's kind of a</span> <span data-start="462.8" data-end="465.289">terminology we have inside bash oh but</span> <span data-start="465.289" data-end="467.06">it basically means the key that you</span> <span data-start="467.06" data-end="470.419">store plus all the metadata around it so</span> <span data-start="470.419" data-end="472.16">if that gets confusing i'm not talking</span> <span data-start="472.16" data-end="474.65">about javascript objects you can also</span> <span data-start="474.65" data-end="476.599">count the keys if you want to find out</span> <span data-start="476.599" data-end="479.32">how many keys are in the in the bucket</span> <span data-start="479.32" data-end="481.639">so that's the basic you know really</span> <span data-start="481.639" data-end="484.539">simple key value a couple extra things</span> <span data-start="484.539" data-end="486.65">but there's an interesting thing about</span> <span data-start="486.65" data-end="489.229">the rioc GS driver which is a metal</span> <span data-start="489.229" data-end="492.139">object and we've got a stack of turtles</span> <span data-start="492.139" data-end="493.34">there on the right side sorry if you</span> <span data-start="493.34" data-end="496.76">can't see it so if you want to modify</span> <span data-start="496.76" data-end="500">things about the request to react if you</span> <span data-start="500" data-end="501.919">want to find out some more information</span> <span data-start="501.919" data-end="504.919">about what the response was you have</span> <span data-start="504.919" data-end="506.84">this meta object and it always comes as</span> <span data-start="506.84" data-end="508.789">the penultimate or the ultimate in the</span> <span data-start="508.789" data-end="511.91">case the callback argument to your</span> <span data-start="511.91" data-end="514.19">function so let's look at what you can</span> <span data-start="514.19" data-end="516.95">do on requests so with the meta object</span> <span data-start="516.95" data-end="519.169">on requests you're sending request time</span> <span data-start="519.169" data-end="520.94">metadata and these are important things</span> <span data-start="520.94" data-end="523.13">like your content type now unlike</span> </p>
<p><span data-start="523.13" data-end="523.91">CouchDB</span> <span data-start="523.91" data-end="526.67">or Redis rioc doesn't care what you</span> <span data-start="526.67" data-end="529.1">store in it it doesn't have any idea of</span> <span data-start="529.1" data-end="533.48">what it is so it's the responsibility</span> <span data-start="533.48" data-end="537.05">the application to tell what kind of</span> <span data-start="537.05" data-end="538.28">content you're storing and that</span> <span data-start="538.28" data-end="541.73">basically corresponds to the HTTP header</span> <span data-start="541.73" data-end="547.55">content type now rioc GS also does some</span> <span data-start="547.55" data-end="549.95">things nicely for you short circuits</span> <span data-start="549.95" data-end="551.36">that if you're just passing a JSON</span> <span data-start="551.36" data-end="553.4">object you can also pass the client ID</span> <span data-start="553.4" data-end="555.53">this is important if you have an</span> <span data-start="555.53" data-end="558.08">application like many node applications</span> <span data-start="558.08" data-end="561.43">will be that have heavy right load and</span> <span data-start="561.43" data-end="564.82">the client ID helps us disambiguate</span> <span data-start="564.82" data-end="569.06">concurrent rights in the in rioc there's</span> <span data-start="569.06" data-end="571.04">also links in user meadow which are some</span> <span data-start="571.04" data-end="574.64">sort of useful metadata that will look</span> <span data-start="574.64" data-end="580.22">at later and of course rioc has is a</span> <span data-start="580.22" data-end="582.47">dynamo like system I'm sorry this is not</span> <span data-start="582.47" data-end="584.33">like really database crowd so I'm kind</span> <span data-start="584.33" data-end="587.15">of a loss here on this but you can tell</span> <span data-start="587.15" data-end="589.82">it how many nodes you want to return a</span> <span data-start="589.82" data-end="592.52">successful response when you submit a</span> <span data-start="592.52" data-end="594.83">write or read and once those are</span> <span data-start="594.83" data-end="597.47">satisfied then it will return response</span> <span data-start="597.47" data-end="600.53">to the client so you can tell it how</span> <span data-start="600.53" data-end="602.69">much consistency you want which is</span> <span data-start="602.69" data-end="604.73">pretty awesome and then return body just</span> <span data-start="604.73" data-end="607.52">basically lets you on a right get back</span> <span data-start="607.52" data-end="611.33">the resulting value that was sent to the</span> <span data-start="611.33" data-end="614.93">server okay so let's look at what the</span> <span data-start="614.93" data-end="620.72">meta does in callbacks so again response</span> <span data-start="620.72" data-end="622.97">time metadata and this will include</span> <span data-start="622.97" data-end="624.74">information like the bucket in the key</span> <span data-start="624.74" data-end="627.41">that we're stored so you can choose to</span> <span data-start="627.41" data-end="629.57">store something without a key and react</span> <span data-start="629.57" data-end="631.67">will pick a key for you in that case you</span> <span data-start="631.67" data-end="632.78">want to read that key in your callback</span> <span data-start="632.78" data-end="635.03">and also the vector clock which is just</span> <span data-start="635.03" data-end="638.6">a crazy distributed systems thing that</span> <span data-start="638.6" data-end="642.14">like the key helps us keep track of who</span> <span data-start="642.14" data-end="644.96">wrote what when and that's all you</span> <span data-start="644.96" data-end="646.49">really need to know about it just make</span> <span data-start="646.49" data-end="650.9">sure that you pass it along again the</span> <span data-start="650.9" data-end="652.28">links in the user matter will come back</span> <span data-start="652.28" data-end="654.29">so if you request you fetched this</span> <span data-start="654.29" data-end="656.84">object from react you'll get information</span> <span data-start="656.84" data-end="657.74">about what other</span> <span data-start="657.74" data-end="660.46">it's linked to and any specific</span> <span data-start="660.46" data-end="663.65">application metadata and then typical</span> <span data-start="663.65" data-end="665.81">you know HTTP like things like the last</span> <span data-start="665.81" data-end="667.82">modified date that you tagged the status</span> <span data-start="667.82" data-end="669.77">code from the request so under the</span> <span data-start="669.77" data-end="673.01">covers rioc GS uses the node HTTP</span> <span data-start="673.01" data-end="676.15">library to do most of its communication</span> <span data-start="676.15" data-end="678.71">okay so if we want to take advantage of</span> <span data-start="678.71" data-end="681.47">this meta we might do something like in</span> <span data-start="681.47" data-end="683.99">this case when we're fetching the object</span> <span data-start="683.99" data-end="686.27">will get it back in the data and the</span> <span data-start="686.27" data-end="688.82">call back here and then we'll add a link</span> <span data-start="688.82" data-end="691.7">to that object and store it back so in</span> <span data-start="691.7" data-end="693.35">this case we've taken that meta that</span> <span data-start="693.35" data-end="695.66">came from the response we call a special</span> <span data-start="695.66" data-end="699.56">function on it add link that makes the</span> <span data-start="699.56" data-end="702.17">note GS object point to the vm v eight</span> <span data-start="702.17" data-end="705.11">and then we're storing that back in</span> <span data-start="705.11" data-end="708.44">react or you might do something like set</span> <span data-start="708.44" data-end="709.88">the content type when you're saving for</span> <span data-start="709.88" data-end="712.82">the first time excuse me I you know I</span> <span data-start="712.82" data-end="715.7">said before that rioc GS will do a lot</span> <span data-start="715.7" data-end="717.56">of things for you to make it really</span> <span data-start="717.56" data-end="719.96">short that the kind of you know</span> <span data-start="719.96" data-end="721.52">developer-friendly API that you're</span> <span data-start="721.52" data-end="724.13">looking for in this case what it says is</span> <span data-start="724.13" data-end="725.84">you only have to tell HTML it knows</span> <span data-start="725.84" data-end="731.03">you're talking about text HTML so that's</span> <span data-start="731.03" data-end="733.82">great now we have key value access you</span> <span data-start="733.82" data-end="737.48">can get you can store but you definitely</span> <span data-start="737.48" data-end="740.9">want to go beyond querying adjust key</span> <span data-start="740.9" data-end="743.39">value and I'm sorry this this turtle</span> <span data-start="743.39" data-end="744.77">doesn't have any relevance to the slide</span> <span data-start="744.77" data-end="746.21">but I thought it's pretty cool eating a</span> <span data-start="746.21" data-end="751.31">strawberry so I mentioned links before</span> <span data-start="751.31" data-end="753.14">links are away a lightweight way to</span> <span data-start="753.14" data-end="755.57">relate objects to one another inside</span> <span data-start="755.57" data-end="757.67">react and you can follow those links</span> <span data-start="757.67" data-end="759.83">automatically and so here's a turtle</span> <span data-start="759.83" data-end="761.83">with two heads that are linked together</span> <span data-start="761.83" data-end="764.93">so if I wanted to find all of my friends</span> <span data-start="764.93" data-end="767.48">and this is the typical social network</span> <span data-start="767.48" data-end="770.63">example I would start at the object that</span> <span data-start="770.63" data-end="773.24">is in the bucket people the keyshawn and</span> <span data-start="773.24" data-end="776.09">then i sent it this specification which</span> <span data-start="776.09" data-end="778.19">is how to match links that are on that</span> <span data-start="778.19" data-end="780.74">object in this case i don't care the</span> <span data-start="780.74" data-end="782.33">very first argument is the bucket I</span> <span data-start="782.33" data-end="784.64">don't care what bucket it's in but I</span> <span data-start="784.64" data-end="786.59">want to follow the tag that's friends</span> <span data-start="786.59" data-end="789.2">and that I'll return a bunch of objects</span> <span data-start="789.2" data-end="791.92">to your your node.js application</span> <span data-start="791.92" data-end="794.93">that are all of those things that are</span> <span data-start="794.93" data-end="797.839">linked from from people Sean and then</span> <span data-start="797.839" data-end="799.519">there's people Matthias in this case</span> <span data-start="799.519" data-end="801.92">we're going to follow his friends but</span> <span data-start="801.92" data-end="803.75">we're also going to follow anybody who</span> <span data-start="803.75" data-end="805.43">are linked from his friends so you can</span> <span data-start="805.43" data-end="807.589">do this sort of fan-out type of query</span> <span data-start="807.589" data-end="809.81">where if things are linked up right you</span> <span data-start="809.81" data-end="811.31">can get lots of interesting information</span> <span data-start="811.31" data-end="814.25">about how things are related and this</span> <span data-start="814.25" data-end="815.87">has been a core future rioc for a long</span> <span data-start="815.87" data-end="820.699">time but wait a minute you said that</span> <span data-start="820.699" data-end="823.04">rioc had javascript in it right I did</span> <span data-start="823.04" data-end="825.8">right okay so I'm going to explain how</span> </p>
<p><span data-start="825.8" data-end="828.44">JavaScript is down inside rioc as well</span> <span data-start="828.44" data-end="831.829">and that's with MapReduce we do a lot of</span> <span data-start="831.829" data-end="834.829">stuff with MapReduce when we're</span> <span data-start="834.829" data-end="837.949">developing apps for react and this is</span> <span data-start="837.949" data-end="839.66">basically how it works it's a little bit</span> <span data-start="839.66" data-end="840.86">different than what you might have seen</span> <span data-start="840.86" data-end="842.72">in couch if you any of you use Hadoop</span> <span data-start="842.72" data-end="845.509">anybody used to do yeah just a few</span> <span data-start="845.509" data-end="848.63">people it's very different from how you</span> <span data-start="848.63" data-end="852.68">use Hadoop too so basically the the idea</span> <span data-start="852.68" data-end="854.959">of MapReduce is a functional idea you</span> <span data-start="854.959" data-end="857.18">start with a list of keys rioc will</span> <span data-start="857.18" data-end="859.31">fetch those keys and run a map function</span> <span data-start="859.31" data-end="861.38">across all of them and that's</span> <span data-start="861.38" data-end="864.35">distributed around the cluster so the</span> <span data-start="864.35" data-end="866.24">map function runs where the data is</span> <span data-start="866.24" data-end="868.22">stored in your rioc cluster which makes</span> <span data-start="868.22" data-end="870.019">it really efficient to load that from</span> <span data-start="870.019" data-end="873.529">disk etc and then once all those map</span> <span data-start="873.529" data-end="875.329">functions have run and they can return</span> <span data-start="875.329" data-end="877.55">any number of results from 0 to however</span> <span data-start="877.55" data-end="880.579">many there they can be sent to a reduced</span> <span data-start="880.579" data-end="883.55">function which will coalesce a single</span> <span data-start="883.55" data-end="886.88">value or a list of values and return</span> <span data-start="886.88" data-end="889.37">that to the client okay that's great</span> <span data-start="889.37" data-end="890.889">where's the JavaScript you're saying</span> <span data-start="890.889" data-end="894.829">well the job the list of keys and all of</span> <span data-start="894.829" data-end="897.889">the functions that you want to compute</span> <span data-start="897.889" data-end="900.35">are submitted as Jason which is pretty</span> <span data-start="900.35" data-end="902.81">cool all of those map functions can be</span> </p>
<p><span data-start="902.81" data-end="905">JavaScript that reduce function can be</span> <span data-start="905" data-end="907.22">JavaScript and then when it's returned</span> <span data-start="907.22" data-end="910.85">to you it's in Jason okay we got</span> <span data-start="910.85" data-end="912.439">JavaScript so let's look at how you run</span> <span data-start="912.439" data-end="916.25">it so in this case I am executing a</span> <span data-start="916.25" data-end="918.29">MapReduce query and all you have to do</span> <span data-start="918.29" data-end="920.059">is on that that client object that you</span> <span data-start="920.059" data-end="922.22">initialized at the beginning is add the</span> <span data-start="922.22" data-end="924.41">frameworks bucket so this basically says</span> <span data-start="924.41" data-end="925.34">give</span> <span data-start="925.34" data-end="927.62">all the keys in the bucket and perform</span> <span data-start="927.62" data-end="931.25">this job across them and we're going to</span> <span data-start="931.25" data-end="933.35">use a built-in function to map across</span> <span data-start="933.35" data-end="935.81">all those which is called map values</span> </p>
<p><span data-start="935.81" data-end="939.08">Jason and then when you call run that</span> <span data-start="939.08" data-end="941.87">actually sends a query as a JSON object</span> <span data-start="941.87" data-end="944">over to rioc and it will execute it and</span> <span data-start="944" data-end="946.1">return some results so this case of</span> <span data-start="946.1" data-end="948.68">course we're just logging to the console</span> <span data-start="948.68" data-end="952.16">the data we get back a little bit more</span> <span data-start="952.16" data-end="954.44">complicated example and I think this is</span> <span data-start="954.44" data-end="957.35">actually the standout feature of what</span> <span data-start="957.35" data-end="961.34">makes rioc GS really tightly integrated</span> <span data-start="961.34" data-end="964.19">with rioc and that's that you can define</span> <span data-start="964.19" data-end="965.93">a function inside your node.js</span> <span data-start="965.93" data-end="968.96">application and it'll be turned into a</span> <span data-start="968.96" data-end="971">string and sent over to rioc and execute</span> <span data-start="971" data-end="974.09">it over there so if you don't want to</span> <span data-start="974.09" data-end="975.44">break out of JavaScript and start</span> <span data-start="975.44" data-end="976.82">writing strings for all your functions</span> <span data-start="976.82" data-end="978.62">or calling built-ins you can just write</span> <span data-start="978.62" data-end="980.03">them in line with your code it's pretty</span> <span data-start="980.03" data-end="983.36">awesome so in this case I just described</span> <span data-start="983.36" data-end="986.15">what this MapReduce queries doing we're</span> <span data-start="986.15" data-end="988.49">going to start with a specific key just</span> <span data-start="988.49" data-end="990.17">the nodejs key inside the frameworks</span> <span data-start="990.17" data-end="992.42">bucket and then we're going to follow</span> <span data-start="992.42" data-end="994.1">links on that to vm saying remember</span> <span data-start="994.1" data-end="995.93">earlier in my examples I linked to the</span> <span data-start="995.93" data-end="997.91">v8 vm so we should get that object</span> <span data-start="997.91" data-end="1000.55">coming out and on all those things that</span> <span data-start="1000.55" data-end="1003.49">it's linked to that have there in that</span> <span data-start="1003.49" data-end="1007.06">vm bucket we're going to just parse the</span> <span data-start="1007.06" data-end="1010.33">contents of that object as jason and</span> <span data-start="1010.33" data-end="1013.39">return the name property from the the</span> <span data-start="1013.39" data-end="1016.99">object that was that was parsed and then</span> <span data-start="1016.99" data-end="1019.84">in the reduce function we're just going</span> <span data-start="1019.84" data-end="1022.51">to sort the list of results and return</span> <span data-start="1022.51" data-end="1025.72">those to the client and I know this is</span> <span data-start="1025.72" data-end="1028.48">like you know Matthias rude a couple</span> <span data-start="1028.48" data-end="1030.07">blog posts a while back about why</span> </p>
<p><span data-start="1030.07" data-end="1031.84">MapReduce is hard and why MapReduce is</span> <span data-start="1031.84" data-end="1034.69">easy and I'm sorry I have to gloss over</span> <span data-start="1034.69" data-end="1036.04">this right now but those are pretty</span> <span data-start="1036.04" data-end="1038.29">awesome ways to learn how to understand</span> <span data-start="1038.29" data-end="1042.82">this programming model okay just one</span> <span data-start="1042.82" data-end="1045.76">more example in this case we're using a</span> <span data-start="1045.76" data-end="1048.64">new feature of rioc 0-14 which is called</span> <span data-start="1048.64" data-end="1052">key filters and what we try to encourage</span> <span data-start="1052" data-end="1055.66">people to do with rioc is to use keys</span> <span data-start="1055.66" data-end="1057.34">that are meaningful to your application</span> <span data-start="1057.34" data-end="1059.14">they may have some embedded in</span> <span data-start="1059.14" data-end="1060.52">mation about the object that's being</span> <span data-start="1060.52" data-end="1063.04">stored in them and in that case that</span> <span data-start="1063.04" data-end="1065.29">makes it actually a lot easier to query</span> <span data-start="1065.29" data-end="1067.69">them because you can even say I know</span> <span data-start="1067.69" data-end="1069.1">exactly what the key is going to be</span> <span data-start="1069.1" data-end="1071.11">that's the ideal case where you can say</span> </p>
<p><span data-start="1071.11" data-end="1072.64">I know the key is going to contain this</span> <span data-start="1072.64" data-end="1076.06">and so key filters let you take a whole</span> <span data-start="1076.06" data-end="1077.83">bucket listing all the keys you've</span> <span data-start="1077.83" data-end="1080.38">stored in that bucket and filter them</span> <span data-start="1080.38" data-end="1082.6">with various predicates in this case I'm</span> <span data-start="1082.6" data-end="1086.83">taking all the emails in in the email</span> <span data-start="1086.83" data-end="1088.6">bucket and saying these are the ones</span> <span data-start="1088.6" data-end="1090.97">that ends with basho calm returned only</span> <span data-start="1090.97" data-end="1093.34">those now the difference between that</span> <span data-start="1093.34" data-end="1094.99">and just running a map function that</span> <span data-start="1094.99" data-end="1099.07">might have you know and if else in it is</span> <span data-start="1099.07" data-end="1101.38">that you're not actually loading that</span> <span data-start="1101.38" data-end="1103.63">data off of disk so it's much much</span> <span data-start="1103.63" data-end="1106.09">faster in this case we're you also using</span> <span data-start="1106.09" data-end="1107.86">another built-in called Matt by fields</span> <span data-start="1107.86" data-end="1110.95">this is a kind of a cool feature in that</span> <span data-start="1110.95" data-end="1113.14">you can create generic map and reduce</span> <span data-start="1113.14" data-end="1115.81">functions in JavaScript that take a</span> <span data-start="1115.81" data-end="1119.14">trailing argument and so you can</span> <span data-start="1119.14" data-end="1121.63">parameterize those generic functions to</span> <span data-start="1121.63" data-end="1123.61">perform specific tasks in this case I'm</span> <span data-start="1123.61" data-end="1127.23">saying okay they need to be joined on</span> <span data-start="1127.23" data-end="1132.1">2010 January first ok and we run that so</span> <span data-start="1132.1" data-end="1134.05">there's also search I mentioned that at</span> <span data-start="1134.05" data-end="1136.51">the beginning react search is a full</span> <span data-start="1136.51" data-end="1138.82">text search engine very similar at least</span> <span data-start="1138.82" data-end="1142.57">from the outside to solar but on the</span> <span data-start="1142.57" data-end="1144.1">inside it's totally different and it</span> <span data-start="1144.1" data-end="1146.05">uses all the distributed stuff that riac</span> <span data-start="1146.05" data-end="1150.07">does but rioc GS has special support for</span> <span data-start="1150.07" data-end="1152.29">it so if you want to have all your Jason</span> <span data-start="1152.29" data-end="1153.51">documents that you're storing</span> <span data-start="1153.51" data-end="1156.46">automatically index in react search you</span> <span data-start="1156.46" data-end="1159.67">can se debe tener un able index and then</span> <span data-start="1159.67" data-end="1161.95">the bucket name and that'll put on a</span> <span data-start="1161.95" data-end="1165.19">pre-commit hook to the storage</span> <span data-start="1165.19" data-end="1168.66">operations to index that in react search</span> <span data-start="1168.66" data-end="1171.22">you can also just perform a flat search</span> <span data-start="1171.22" data-end="1173.89">like you would expect with solar you</span> <span data-start="1173.89" data-end="1175.99">send it you know leucine style query</span> <span data-start="1175.99" data-end="1178.6">string say give me all the documents</span> <span data-start="1178.6" data-end="1180.98">that have the title scalable in them</span> <span data-start="1180.98" data-end="1186.08">and you can use search to feed a</span> </p>
<p><span data-start="1186.08" data-end="1188.299">MapReduce query so if you know a full</span> <span data-start="1188.299" data-end="1190.97">text query that will satisfy the set of</span> <span data-start="1190.97" data-end="1193.88">keys you want to fetch then you can use</span> <span data-start="1193.88" data-end="1196.16">that to to feed a MapReduce query and</span> <span data-start="1196.16" data-end="1198.02">just add your map and reduce functions</span> <span data-start="1198.02" data-end="1199.4">on there and whatever combinations you</span> <span data-start="1199.4" data-end="1202.82">need okay so there's some other things</span> <span data-start="1202.82" data-end="1204.47">that's the main features of react GS</span> <span data-start="1204.47" data-end="1205.73">there's some other things that are</span> <span data-start="1205.73" data-end="1208.03">included there's a connect session store</span> <span data-start="1208.03" data-end="1210.11">in fact I've just got a pull request</span> <span data-start="1210.11" data-end="1212.02">applied to it today it's pretty cool</span> <span data-start="1212.02" data-end="1215.809">there's a miniature rioc so we were on</span> <span data-start="1215.809" data-end="1217.64">the right test for applications right</span> <span data-start="1217.64" data-end="1219.53">but sometimes those tests need to hit</span> <span data-start="1219.53" data-end="1221.45">the data store in this case it's</span> <span data-start="1221.45" data-end="1223.19">actually pretty awesome what it does is</span> <span data-start="1223.19" data-end="1225.71">it fires up a rioc that's a subprocess</span> <span data-start="1225.71" data-end="1229.37">of your node test process and tells it</span> <span data-start="1229.37" data-end="1231.53">to delete all the data in it at the end</span> <span data-start="1231.53" data-end="1233.87">of each run so you'll definitely want to</span> <span data-start="1233.87" data-end="1236.15">look into that also there's multiple</span> <span data-start="1236.15" data-end="1237.919">ways to talk to react the default is</span> </p>
<p><span data-start="1237.919" data-end="1240.71">HTTP but there's also a binary protocol</span> <span data-start="1240.71" data-end="1242.6">which is based on Google protocol</span> <span data-start="1242.6" data-end="1244.85">buffers and react GS has some</span> <span data-start="1244.85" data-end="1246.82">experimental support for that and</span> <span data-start="1246.82" data-end="1252.29">there's also a a luoc which is I'm sorry</span> <span data-start="1252.29" data-end="1256.1">kind of a weird name but if you wanted</span> <span data-start="1256.1" data-end="1259.07">to store large files in your react</span> <span data-start="1259.07" data-end="1260.87">cluster luoc will split them up into</span> <span data-start="1260.87" data-end="1263.84">chunks for you and no GSA I'm sorry no</span> </p>
<p><span data-start="1263.84" data-end="1267.679">GS via react Jas has support for that so</span> <span data-start="1267.679" data-end="1269.99">no presentation would be good without a</span> <span data-start="1269.99" data-end="1273.53">demo so this application is available on</span> <span data-start="1273.53" data-end="1275.27">github I'm going to talk through a</span> <span data-start="1275.27" data-end="1279.74">little bit of it and it's also hosted on</span> <span data-start="1279.74" data-end="1283.07">joints node server a node service and so</span> <span data-start="1283.07" data-end="1287.99">you'll be able to see that ok so what</span> <span data-start="1287.99" data-end="1291.47">reactant is is a very simple syslog</span> <span data-start="1291.47" data-end="1294.59">server so it receives UDP syslog</span> <span data-start="1294.59" data-end="1296.66">messages it stores them a react search</span> <span data-start="1296.66" data-end="1298.28">and then it serves them up in a nice</span> <span data-start="1298.28" data-end="1299.75">little web interface which is also</span> <span data-start="1299.75" data-end="1303.41">powered by node and and then you can</span> <span data-start="1303.41" data-end="1305.24">search through all of your logs so</span> <span data-start="1305.24" data-end="1310.02">miniature log lead type of thing</span> <span data-start="1310.03" data-end="1312.62">interesting thing of that we discovered</span> <span data-start="1312.62" data-end="1315.59">when we were writing this and this</span> <span data-start="1315.59" data-end="1317.42">should come as no surprise to any of you</span> <span data-start="1317.42" data-end="1322.07">but don't block the reactor okay we</span> <span data-start="1322.07" data-end="1323.69">actually found that we were dropping a</span> <span data-start="1323.69" data-end="1326.45">bunch of UDP messages because we weren't</span> <span data-start="1326.45" data-end="1329.9">deferring our rights to rioc that was</span> <span data-start="1329.9" data-end="1332.57">that was kind of interesting so instead</span> <span data-start="1332.57" data-end="1334.88">what we did is we set up a queue we push</span> <span data-start="1334.88" data-end="1336.14">messages into the queue and then</span> <span data-start="1336.14" data-end="1338.15">periodically check to see if it's over a</span> <span data-start="1338.15" data-end="1339.68">certain threshold and then drain them</span> <span data-start="1339.68" data-end="1341.96">which actually worked really well and we</span> <span data-start="1341.96" data-end="1345.11">didn't really lose any messages so we</span> <span data-start="1345.11" data-end="1347.54">parse the message we create a hash of it</span> <span data-start="1347.54" data-end="1351.11">to use for the key and then we push it</span> <span data-start="1351.11" data-end="1357.11">into the queue ok it's C go down here so</span> <span data-start="1357.11" data-end="1359.69">this callback this process next key</span> <span data-start="1359.69" data-end="1361.37">message is what actually pushes it in to</span> <span data-start="1361.37" data-end="1364.37">rioc and we do use the typical tail call</span> <span data-start="1364.37" data-end="1367.52">type of call back to pop something off</span> <span data-start="1367.52" data-end="1374.1">the queue and then stick it in to rioc</span> <span data-start="1374.11" data-end="1376.46">ok and that's breasts for that spoiler</span> <span data-start="1376.46" data-end="1379.25">plate and then there's the web server</span> <span data-start="1379.25" data-end="1381.65">which we actually use the react j/s</span> <span data-start="1381.65" data-end="1386.75">session store to with express to have a</span> <span data-start="1386.75" data-end="1390.14">simple login and that's set up right</span> <span data-start="1390.14" data-end="1394.39">here this Express create server stuff so</span> <span data-start="1394.39" data-end="1397.94">we've required rioc GS up here we've</span> <span data-start="1397.94" data-end="1400.7">required the session store which</span> <span data-start="1400.7" data-end="1403.1">actually those fixes that we did in this</span> <span data-start="1403.1" data-end="1404.48">project have been moved into the prod</span> <span data-start="1404.48" data-end="1406.28">into react yes now so you shouldn't</span> <span data-start="1406.28" data-end="1409.7">shouldnt have to see that anymore and so</span> <span data-start="1409.7" data-end="1411.74">we created a session store stores its</span> <span data-start="1411.74" data-end="1414.2">its stuff in syslog web sessions bucket</span> <span data-start="1414.2" data-end="1417.16">and uses the same client that we use for</span> <span data-start="1417.16" data-end="1423.56">for the the web app ok and then there's</span> <span data-start="1423.56" data-end="1425.24">some stuff related to MapReduce in</span> <span data-start="1425.24" data-end="1427.16">filtering those queries and I don't want</span> <span data-start="1427.16" data-end="1428.57">to spend too much time doing a code</span> <span data-start="1428.57" data-end="1429.86">review because I know how boring that is</span> <span data-start="1429.86" data-end="1432.17">so we're going to look at the</span> <span data-start="1432.17" data-end="1436.3">application this is pretty simple</span> <span data-start="1436.3" data-end="1441.28">demonstrating using the session store</span> <span data-start="1441.28" data-end="1444.49">and if you go here it's okay if you go</span> <span data-start="1444.49" data-end="1447.01">here i'm sure it'll hold up its fasho</span> <span data-start="1447.01" data-end="1450.79">dot noge and the username is react and</span> <span data-start="1450.79" data-end="1459.64">the password is awesomesauce okay so now</span> <span data-start="1459.64" data-end="1462.67">we've got pretty blank screen but if we</span> <span data-start="1462.67" data-end="1467.17">type so we actually fabricated some</span> <span data-start="1467.17" data-end="1468.85">syslog messages to feed into react</span> <span data-start="1468.85" data-end="1472.35">search and so some of them have this</span> <span data-start="1472.35" data-end="1475.15">connection closed message so if we click</span> <span data-start="1475.15" data-end="1478.24">that in search and we get back a bunch</span> <span data-start="1478.24" data-end="1480.19">of text messages on the side that are</span> <span data-start="1480.19" data-end="1482.14">you know syslog format you may be</span> <span data-start="1482.14" data-end="1484.9">familiar with and all of these you know</span> <span data-start="1484.9" data-end="1486.76">things have their connection closed</span> <span data-start="1486.76" data-end="1490.57">unexpectedly so you can make it filter</span> <span data-start="1490.57" data-end="1493.84">that so let's say we wanted and those</span> <span data-start="1493.84" data-end="1495.04">are all happening at the same time the</span> <span data-start="1495.04" data-end="1497.59">times not going to be useful so I'm</span> </p>
<p><span data-start="1497.59" data-end="1500.91">Justin just searching you know typical</span> <span data-start="1500.91" data-end="1503.8">leucine type of search you can actually</span> <span data-start="1503.8" data-end="1505.12">feed that to MapReduce like I mentioned</span> <span data-start="1505.12" data-end="1508.57">before and then we made a selector down</span> <span data-start="1508.57" data-end="1510.16">here you can select which map function</span> <span data-start="1510.16" data-end="1512.05">you want so if we just want the host</span> <span data-start="1512.05" data-end="1515.74">names out of all those results click</span> <span data-start="1515.74" data-end="1518.65">search again and my apologies for the</span> <span data-start="1518.65" data-end="1520.06">the interface here it's kind of rural</span> <span data-start="1520.06" data-end="1523.87">but here's all these results so every</span> <span data-start="1523.87" data-end="1525.85">one of these things that was a search</span> <span data-start="1525.85" data-end="1527.95">result got passages map function that</span> <span data-start="1527.95" data-end="1529.45">just returns the host name and account</span> <span data-start="1529.45" data-end="1531.61">for that now that doesn't seem very</span> <span data-start="1531.61" data-end="1533.44">useful until you look at the reduce</span> <span data-start="1533.44" data-end="1535.18">function you say well let's group x</span> <span data-start="1535.18" data-end="1538.36">values and when you do that you can see</span> <span data-start="1538.36" data-end="1541.54">well web to bachelor com that's probably</span> <span data-start="1541.54" data-end="1545.29">a bit tiny web to bachelor com had 87 of</span> <span data-start="1545.29" data-end="1549.45">these messages and apple on and so on so</span> <span data-start="1549.45" data-end="1554.14">in contrast to the way that Hadoop does</span> </p>
<p><span data-start="1554.14" data-end="1557.47">MapReduce and the way that couch gb does</span> <span data-start="1557.47" data-end="1559.12">MapReduce you can build these things on</span> <span data-start="1559.12" data-end="1561.25">the fly you're not building views you're</span> <span data-start="1561.25" data-end="1564.4">not stuck into a fixed job you can</span> <span data-start="1564.4" data-end="1566.37">submit them whenever you want and then</span> <span data-start="1566.37" data-end="1569.05">you might also want to do something like</span> <span data-start="1569.05" data-end="1573.47">let's see let's fetch the date an hour</span> <span data-start="1573.47" data-end="1578.35">and these all happen in nineteen o clock</span> <span data-start="1578.35" data-end="1583.659">383 messages so that's a little demo and</span> <span data-start="1583.659" data-end="1586.52">let's flip back here I'd be happy to</span> <span data-start="1586.52" data-end="1590.299">take questions that's how to contact me</span> <span data-start="1590.299" data-end="1592.34">check out the jas comp basher com site</span> <span data-start="1592.34" data-end="1598.82">yes how hard is it to replicate the</span> <span data-start="1598.82" data-end="1601.64">server the react server it's built in so</span> <span data-start="1601.64" data-end="1603.35">you start with one node and you have</span> <span data-start="1603.35" data-end="1604.789">three copies of everything when you go</span> <span data-start="1604.789" data-end="1606.5">to three nodes there's a copy on every</span> <span data-start="1606.5" data-end="1608.179">machine you grow two more and it's</span> <span data-start="1608.179" data-end="1610.45">spread out even more thinly so</span> <span data-start="1610.45" data-end="1614.299">replication is automatic did that answer</span> <span data-start="1614.299" data-end="1618.82">your question yeah okay way in the back</span> <span data-start="1618.82" data-end="1621.799">yeah the question was why would you want</span> <span data-start="1621.799" data-end="1624.169">to use a key streaming and an</span> <span data-start="1624.169" data-end="1625.49">interesting thing about the way</span> <span data-start="1625.49" data-end="1628.22">streaming keys or I'm sorry key listing</span> <span data-start="1628.22" data-end="1630.74">works in rioc is that when you submit a</span> <span data-start="1630.74" data-end="1633.59">request for a list of keys it goes out</span> <span data-start="1633.59" data-end="1637.19">to one-third of all of the nodes in the</span> <span data-start="1637.19" data-end="1639.169">in the system and says give me your key</span> <span data-start="1639.169" data-end="1642.62">list for this bucket and so as you can</span> <span data-start="1642.62" data-end="1644.9">imagine with a big bucket that's going</span> <span data-start="1644.9" data-end="1647.15">to take a long time to smash into a JSON</span> <span data-start="1647.15" data-end="1650.12">array and send back to the client that's</span> <span data-start="1650.12" data-end="1651.2">going to take up a lot of memory if</span> <span data-start="1651.2" data-end="1652.7">you've got a lot of keys Sookie</span> <span data-start="1652.7" data-end="1654.98">streaming sidesteps that and actually</span> <span data-start="1654.98" data-end="1657.71">start sending back results as soon as</span> <span data-start="1657.71" data-end="1660.2">they get there so this is actually nice</span> <span data-start="1660.2" data-end="1662.51">fit with the way that node does things</span> <span data-start="1662.51" data-end="1664.659">and that you can receive events</span> <span data-start="1664.659" data-end="1668.96">asynchronously showing thanks very much</span> </p>
</section>