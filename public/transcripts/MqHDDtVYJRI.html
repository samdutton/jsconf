<section>
<p><span data-start="21.41" data-end="25.62">you</span> <span data-start="25.63" data-end="28.94">good morning Jace comes so you already</span> <span data-start="28.94" data-end="29.96">know my name</span> <span data-start="29.96" data-end="33.02">I've never seen it this big can someone</span> <span data-start="33.02" data-end="34.52">take a picture of it for me I'll be</span> <span data-start="34.52" data-end="37.489">grateful okay</span> <span data-start="37.489" data-end="39.23">today I'd like to share with you some of</span> <span data-start="39.23" data-end="40.91">the questions I was asking myself about</span> <span data-start="40.91" data-end="44.27">numbers in JavaScript because even</span> </p>
<p><span data-start="44.27" data-end="46.309">Brendan Eich yesterday at least keynote</span> <span data-start="46.309" data-end="49.34">told us that the numbers are not really</span> <span data-start="49.34" data-end="51.59">perfect currently that's why all these</span> <span data-start="51.59" data-end="53.33">new types of numbers are being</span> <span data-start="53.33" data-end="57.02">introduced for future versions but today</span> <span data-start="57.02" data-end="59.03">I like to focus on what currently we</span> <span data-start="59.03" data-end="62.149">have in JavaScript in terms of numbers</span> <span data-start="62.149" data-end="64.16">because if you ever tried to do some</span> <span data-start="64.16" data-end="66.29">computations on decimal fractions or</span> <span data-start="66.29" data-end="69.05">large integers in JavaScript you</span> <span data-start="69.05" data-end="71.03">probably noticed that they are not</span> <span data-start="71.03" data-end="73.28">really precise and may lead to some</span> <span data-start="73.28" data-end="76.55">quite unexpected results let me give you</span> <span data-start="76.55" data-end="82.789">some examples of that if we try to add</span> <span data-start="82.789" data-end="85.91">zero point one to zero points to you</span> <span data-start="85.91" data-end="87.619">would expect it will be equal to zero</span> <span data-start="87.619" data-end="90.92">point three but it's not what it's</span> <span data-start="90.92" data-end="93.77">actually equal to it's a number very</span> <span data-start="93.77" data-end="97.34">close to zero point three on the other</span> <span data-start="97.34" data-end="99.83">hand if you take quite a large integer</span> <span data-start="99.83" data-end="106.4">like for example this one and you try to</span> <span data-start="106.4" data-end="110.75">add one to it you will get exactly the</span> <span data-start="110.75" data-end="114.92">same number but if you add 2 to it you</span> <span data-start="114.92" data-end="118.34">get the result as expected but it's not</span> <span data-start="118.34" data-end="121.43">only about inaccurate results of some</span> <span data-start="121.43" data-end="124.49">computations there are many different</span> <span data-start="124.49" data-end="126.439">weird things about the numbers in</span> </p>
<p><span data-start="126.439" data-end="129.86">JavaScript like this in famous not a</span> <span data-start="129.86" data-end="135.14">number value so not a number is a value</span> <span data-start="135.14" data-end="137.39">you will get if you try to turn into</span> <span data-start="137.39" data-end="140">Java in to a number something that is</span> <span data-start="140" data-end="141.42">not</span> <span data-start="141.42" data-end="145.02">so let's try something like this but if</span> <span data-start="145.02" data-end="146.88">you try to check the type of not a</span> <span data-start="146.88" data-end="152.43">number it will tell you it's a number</span> <span data-start="152.43" data-end="155.97">and every time I stumbled upon something</span> <span data-start="155.97" data-end="158.46">like this happening Gong I was asking</span> <span data-start="158.46" data-end="160.77">myself why does it happen because there</span> <span data-start="160.77" data-end="162.57">has to be a reason right things like</span> <span data-start="162.57" data-end="165.09">that don't happen without the reason at</span> <span data-start="165.09" data-end="168.3">least in most cases and if you're asking</span> <span data-start="168.3" data-end="169.5">yourself a question about JavaScript</span> <span data-start="169.5" data-end="172.29">there is one sure place to look for the</span> <span data-start="172.29" data-end="172.83">answer</span> <span data-start="172.83" data-end="176.88">the ACMA script standard but all the</span> <span data-start="176.88" data-end="179.37">standard says about the numbers is that</span> <span data-start="179.37" data-end="180.99">they are represented by the double</span> <span data-start="180.99" data-end="185.63">precision 64-bit format I Triple E 754</span> <span data-start="185.63" data-end="188.25">binary floating-point arithmetic</span> <span data-start="188.25" data-end="190.44">actually yeah it's just a little bit</span> <span data-start="190.44" data-end="193.68">more than that but nothing about how the</span> <span data-start="193.68" data-end="195.36">numbers are represented in the memory</span> <span data-start="195.36" data-end="200.1">how the calculations are done so I had</span> <span data-start="200.1" data-end="204">to look the further but it turns out</span> <span data-start="204" data-end="205.62">that javascript is not the first</span> <span data-start="205.62" data-end="208.47">language that uses this standard there</span> <span data-start="208.47" data-end="214.18">are many others if you try for example</span> </p>
<p><span data-start="214.19" data-end="221.16">Python we have exactly the same problems</span> <span data-start="221.16" data-end="226.13">in here</span> <span data-start="226.14" data-end="234.83">something more modern like Ruby nope</span> <span data-start="234.83" data-end="242.4">and of course Java actually I had to</span> <span data-start="242.4" data-end="244.38">read write a class to add these two</span> <span data-start="244.38" data-end="253.95">numbers in Java anyway it turns out that</span> <span data-start="253.95" data-end="256.019">we have these kind of numbers in</span> </p>
<p><span data-start="256.019" data-end="258.06">JavaScript because they were in Java at</span> <span data-start="258.06" data-end="262.5">the first place right so I was still</span> <span data-start="262.5" data-end="264.69">asking myself why does it happen what is</span> <span data-start="264.69" data-end="268.02">wrong with this representation of the</span> <span data-start="268.02" data-end="270.57">numbers that we have such imprecise</span> <span data-start="270.57" data-end="272.79">results and the first step I wanted to</span> <span data-start="272.79" data-end="276">make was to see how a given number looks</span> <span data-start="276" data-end="277.919">like in this binary representation I</span> <span data-start="277.919" data-end="280.65">wanted to see every single bit of this</span> <span data-start="280.65" data-end="283.46">64 bit representation</span> <span data-start="283.46" data-end="285.84">unfortunately in JavaScript we don't</span> <span data-start="285.84" data-end="288.78">really have easy direct access to bits</span> <span data-start="288.78" data-end="292.38">in memory but with a little help from my</span> <span data-start="292.38" data-end="295.68">friends typed our eyes I was able to</span> <span data-start="295.68" data-end="308.04">create myself a little utility function</span> <span data-start="308.05" data-end="311.56">so now we can turn any number let's say</span> <span data-start="311.56" data-end="315.639">our 0.3 and see how it looks in its</span> <span data-start="315.639" data-end="318.37">binary representation so these are all</span> <span data-start="318.37" data-end="321.039">64 bits of binary representation of</span> <span data-start="321.039" data-end="324.159">number 0.3 in this double precision</span> <span data-start="324.159" data-end="326.849">floating point so let's compare it to</span> <span data-start="326.849" data-end="329.83">result of the computation of 0.1 plus</span> <span data-start="329.83" data-end="334.599">0.2 it's almost the same but if you look</span> <span data-start="334.599" data-end="337.09">at the last three bits on the right side</span> <span data-start="337.09" data-end="339.61">you will see that there is a little</span> <span data-start="339.61" data-end="343.36">difference there and yeah we can take</span> <span data-start="343.36" data-end="346.199">any number we want like I don't know</span> <span data-start="346.199" data-end="349.72">2013 0 9 and see how it looks like but</span> <span data-start="349.72" data-end="353.02">looking at these zeros and ones doesn't</span> <span data-start="353.02" data-end="355.09">really give us any kind of understanding</span> <span data-start="355.09" data-end="356.86">what is going on there how these numbers</span> <span data-start="356.86" data-end="361.659">are computed fortunately because this</span> <span data-start="361.659" data-end="365.199">standard is used in many languages there</span> <span data-start="365.199" data-end="367.84">are quite a few resources online that</span> <span data-start="367.84" data-end="370.08">tell us how does the standard work I</span> <span data-start="370.08" data-end="374.069">gathered a couple of these here but</span> <span data-start="374.069" data-end="376.93">unfortunately they are full of crazy</span> <span data-start="376.93" data-end="379.69">equations and operations on binary</span> <span data-start="379.69" data-end="382.84">numbers and it took me quite a few long</span> <span data-start="382.84" data-end="386.289">evenings a lot of paper to get my head</span> <span data-start="386.289" data-end="390.039">around how it really works so here I am</span> <span data-start="390.039" data-end="392.71">to save you the trouble and hopefully</span> <span data-start="392.71" data-end="394.24">after this talk you will actually be</span> <span data-start="394.24" data-end="396.87">able to understand this Wikipedia page</span> <span data-start="396.87" data-end="400.569">so let's see how this representation</span> <span data-start="400.569" data-end="404.56">works so as I already mentioned a couple</span> <span data-start="404.56" data-end="407.259">of times we have 64 bits to represent</span> <span data-start="407.259" data-end="409.96">our number and they can be divided into</span> <span data-start="409.96" data-end="413.8">three parts there is one bit for a sign</span> <span data-start="413.8" data-end="418.509">is this guy in here it tells us if the</span> <span data-start="418.509" data-end="420.4">number is positive or negative negative</span> <span data-start="420.4" data-end="424.509">there is this big chunk on the right 52</span> <span data-start="424.509" data-end="426.819">bits actually it's 53 because one of</span> <span data-start="426.819" data-end="428.68">them is hidden I will talk about this</span> <span data-start="428.68" data-end="431.759">guy later this part is called</span> <span data-start="431.759" data-end="435.31">significant if you are American English</span> <span data-start="435.31" data-end="437.43">user you probably call it mantissa</span> <span data-start="437.43" data-end="439.58">sometimes it's referred as</span> <span data-start="439.58" data-end="442.93">fraction but basically this 52 bits are</span> <span data-start="442.93" data-end="445.55">representing the binary digits of our</span> <span data-start="445.55" data-end="447.83">number and some of them are used to</span> <span data-start="447.83" data-end="450.139">represent the integer part of our number</span> <span data-start="450.139" data-end="453.349">and the others are for the fraction and</span> </p>
<p><span data-start="453.349" data-end="456.259">I use this this point in here to show</span> <span data-start="456.259" data-end="458.569">where this split happens so this bits on</span> <span data-start="458.569" data-end="460.759">the left of this point are used to</span> <span data-start="460.759" data-end="463.52">represent the integer part and the rest</span> <span data-start="463.52" data-end="467.99">is for the fraction and the remaining 11</span> <span data-start="467.99" data-end="471.919">bits is the exponent and the exponent is</span> <span data-start="471.919" data-end="474.68">kind of a multiplier that is used to</span> <span data-start="474.68" data-end="477.349">scale the value given by the significant</span> <span data-start="477.349" data-end="479.99">to give us the final value of our number</span> <span data-start="479.99" data-end="482.69">and I'm pretty sure it's quite confusing</span> <span data-start="482.69" data-end="486.139">at this point so let me give you a</span> <span data-start="486.139" data-end="491.599">little bit of analogy I hope that you've</span> <span data-start="491.599" data-end="494.539">at least at some point of your life seen</span> <span data-start="494.539" data-end="497.569">a number written like this it's so</span> <span data-start="497.569" data-end="499.61">called exponential or scientific</span> <span data-start="499.61" data-end="503.24">notation so in this notation we also</span> <span data-start="503.24" data-end="505.43">have a number divided into two parts</span> <span data-start="505.43" data-end="509.09">this is there is this part it represents</span> <span data-start="509.09" data-end="511.52">the significant digits of our numbers so</span> <span data-start="511.52" data-end="513.38">all the digits we want to have in our</span> <span data-start="513.38" data-end="516.169">number and it's also called significant</span> <span data-start="516.169" data-end="519.74">and we compute number by multiplying it</span> <span data-start="519.74" data-end="522.68">times 10 to the power of the exponent so</span> <span data-start="522.68" data-end="525.339">the exponent is kind of a scaling factor</span> <span data-start="525.339" data-end="528.769">so the bigger the exponent gets the</span> <span data-start="528.769" data-end="530.839">bigger our number will be and the</span> <span data-start="530.839" data-end="533.089">smaller the exponent gets the smaller</span> <span data-start="533.089" data-end="536.81">value of our number will have and we can</span> <span data-start="536.81" data-end="538.67">look at this exponent as kind of</span> <span data-start="538.67" data-end="540.92">defining the position of the point in</span> <span data-start="540.92" data-end="544.88">our representation because when the</span> <span data-start="544.88" data-end="547.279">exponent gets higher the point kind of</span> <span data-start="547.279" data-end="550.16">moves to the right and makes this number</span> <span data-start="550.16" data-end="553.19">bigger and when the exponent gets</span> <span data-start="553.19" data-end="554.99">smaller it kind of moves the point to</span> <span data-start="554.99" data-end="557.329">the left making the numbers smaller and</span> <span data-start="557.329" data-end="560.149">smaller and actually the roles of</span> <span data-start="560.149" data-end="563.089">significant and exponent in this binary</span> <span data-start="563.089" data-end="564.98">notation for the floating point numbers</span> <span data-start="564.98" data-end="568.22">are exactly the same so let's get back</span> <span data-start="568.22" data-end="570.39">to it and see how it works and more</span> <span data-start="570.39" data-end="575.31">details so design bit there is not much</span> <span data-start="575.31" data-end="578.67">to say about this guy if its value is</span> <span data-start="578.67" data-end="581.4">zero the number is positive because it's</span> <span data-start="581.4" data-end="584.13">counted as the power of minus one and if</span> <span data-start="584.13" data-end="586.77">we turn it to one our number becomes</span> <span data-start="586.77" data-end="589.07">negative simple as that</span> <span data-start="589.07" data-end="591.42">exponent is a little bit more</span> <span data-start="591.42" data-end="594.63">interesting so we have eleven bits to</span> <span data-start="594.63" data-end="596.58">represent the exponent and the exponent</span> <span data-start="596.58" data-end="599.13">that is an integer value so we can</span> <span data-start="599.13" data-end="601.98">represent the number from zero to 2047</span> <span data-start="601.98" data-end="605.07">but we would actually want exponent to</span> <span data-start="605.07" data-end="608.55">have negative and positive values so</span> <span data-start="608.55" data-end="610.95">what is actually used in so called</span> <span data-start="610.95" data-end="614.37">offset binary notation so we take the</span> <span data-start="614.37" data-end="616.56">number computed from the powers of two</span> <span data-start="616.56" data-end="618.96">of the from the bits of exponent this</span> <span data-start="618.96" data-end="622.62">one and we subtract 1023 from it it's</span> <span data-start="622.62" data-end="626.25">exactly the health of the range so when</span> <span data-start="626.25" data-end="628.2">our value computed from the exponent</span> <span data-start="628.2" data-end="633.81">bits gets exactly to this point of 1022</span> <span data-start="633.81" data-end="637.23">three our exponent will be zero and when</span> <span data-start="637.23" data-end="639.51">it gets lower the exponent will be</span> <span data-start="639.51" data-end="642">negative when it's higher the exponent</span> <span data-start="642" data-end="645.09">will be positive and this number the</span> <span data-start="645.09" data-end="647.67">value for the exponent is actually</span> <span data-start="647.67" data-end="650.13">defining the position of this point in</span> <span data-start="650.13" data-end="654.33">the significant so it defines how many</span> <span data-start="654.33" data-end="656.73">bits we have for the integer part of the</span> <span data-start="656.73" data-end="658.56">number and how many are left for the</span> <span data-start="658.56" data-end="661.95">fraction part so the bigger our exponent</span> <span data-start="661.95" data-end="664.29">gets the more bits we have for the</span> <span data-start="664.29" data-end="666.24">integer part and the bigger our integer</span> <span data-start="666.24" data-end="670.89">value gets the smaller exponent is the</span> <span data-start="670.89" data-end="673.2">point will move to the left making</span> <span data-start="673.2" data-end="675.63">giving us less bits for the integer part</span> <span data-start="675.63" data-end="678.51">and actually that's why it's called the</span> <span data-start="678.51" data-end="680.79">floating point because the position of</span> <span data-start="680.79" data-end="683.97">the point is depends on the value of the</span> <span data-start="683.97" data-end="688.05">exponent so now let's have a look at the</span> <span data-start="688.05" data-end="692.91">most important part the significant as I</span> <span data-start="692.91" data-end="696.24">told you already we have 52 bits these</span> <span data-start="696.24" data-end="699.21">are these red ones and here this first</span> <span data-start="699.21" data-end="701.37">guy is this hidden</span> <span data-start="701.37" data-end="706.69">we can save him here yeah and we can</span> <span data-start="706.69" data-end="708.16">stick him because we don't actually</span> <span data-start="708.16" data-end="711.13">control its value its value is always</span> <span data-start="711.13" data-end="713.65">assumed to be one so that's why we don't</span> <span data-start="713.65" data-end="716.62">have to put them into 64 bits because we</span> <span data-start="716.62" data-end="722.02">can't change it to zero so to explain</span> <span data-start="722.02" data-end="724.18">you how this significant works let's</span> <span data-start="724.18" data-end="726.07">start with something simple like number</span> <span data-start="726.07" data-end="729.82">one so for number one our exponent is</span> <span data-start="729.82" data-end="730.42">zero</span> <span data-start="730.42" data-end="734.56">so it puts our point in here so we have</span> <span data-start="734.56" data-end="737.86">one bit on the left hand side this one</span> <span data-start="737.86" data-end="740.32">bit representing our integer part and it</span> <span data-start="740.32" data-end="742.84">represents two to the power of zero so</span> <span data-start="742.84" data-end="745.93">it's one but we have only one bit for</span> <span data-start="745.93" data-end="747.61">the integer we can't represent any</span> <span data-start="747.61" data-end="750.01">bigger number so if we try to represent</span> <span data-start="750.01" data-end="752.68">the number two we have to move the point</span> <span data-start="752.68" data-end="755.83">to the right by changing the exponent so</span> <span data-start="755.83" data-end="757.75">now we have two bits for the integer</span> <span data-start="757.75" data-end="761.11">part this first bit is representing 2 to</span> <span data-start="761.11" data-end="763.45">the power of 1 at this point so it gives</span> <span data-start="763.45" data-end="766.81">us 2 and the other one is representing 2</span> <span data-start="766.81" data-end="768.91">to the power of 0 so we can represent</span> <span data-start="768.91" data-end="772.69">also number 3 but again we just used our</span> <span data-start="772.69" data-end="775.72">2 bits in the integer part so to</span> <span data-start="775.72" data-end="779.47">represent number 4 we have to again move</span> <span data-start="779.47" data-end="781.03">the point to the right by changing the</span> <span data-start="781.03" data-end="796.04">exponent so now we have oops sorry</span> <span data-start="796.05" data-end="801.98">yeah I was at for ideas so now we have</span> <span data-start="801.98" data-end="805.709">three bits for the integer part the</span> <span data-start="805.709" data-end="807.329">first one represents two to the power of</span> <span data-start="807.329" data-end="809.55">two the last one represents two to the</span> <span data-start="809.55" data-end="813.389">power of zero so the bigger number we</span> <span data-start="813.389" data-end="814.829">want to represent in terms of the</span> <span data-start="814.829" data-end="817.259">integer value the more bits we will need</span> <span data-start="817.259" data-end="821.1">for the integer part now let's see how</span> <span data-start="821.1" data-end="823.889">the fraction part works the first bit</span> <span data-start="823.889" data-end="827.22">after the point represents two to the</span> <span data-start="827.22" data-end="831.36">power of minus one so it gives us 1/2 to</span> <span data-start="831.36" data-end="833.249">the power of one so it gives us a half</span> <span data-start="833.249" data-end="836.069">so by changing this first bit after the</span> <span data-start="836.069" data-end="840.6">point we can represent 0.5 fraction the</span> <span data-start="840.6" data-end="843.119">next one is representing 2 to the power</span> <span data-start="843.119" data-end="846.48">of minus 2 so it gives us a quarter next</span> <span data-start="846.48" data-end="848.85">one is 2 to the power of minus 3</span> <span data-start="848.85" data-end="851.699">it's 1/8 and so on and so on every</span> <span data-start="851.699" data-end="853.799">single bit and the fraction part</span> <span data-start="853.799" data-end="856.199">represents smaller and smaller fraction</span> <span data-start="856.199" data-end="860.279">based on the inverse power of 2 so what</span> <span data-start="860.279" data-end="863.16">it tells us is that we can only build</span> <span data-start="863.16" data-end="866.429">the fraction of our number by adding up</span> <span data-start="866.429" data-end="869.299">these inverted powers of 2 and</span> <span data-start="869.299" data-end="871.92">unfortunately not all of decimal</span> <span data-start="871.92" data-end="874.74">fractions can be represented this way so</span> <span data-start="874.74" data-end="879.66">if we take our zero point one example we</span> <span data-start="879.66" data-end="881.73">can see that to form zero point one we</span> <span data-start="881.73" data-end="884.189">are adding smaller and smaller powers of</span> <span data-start="884.189" data-end="884.639">two</span> <span data-start="884.639" data-end="888.179">but actually they will never add up to</span> <span data-start="888.179" data-end="891.299">exactly zero point one value so this</span> <span data-start="891.299" data-end="893.67">value is already stored in this</span> <span data-start="893.67" data-end="895.439">representation with a little bit of</span> <span data-start="895.439" data-end="898.47">error and these errors add up when we do</span> <span data-start="898.47" data-end="900.209">some computations on these numbers and</span> <span data-start="900.209" data-end="905.1">at some point they they show up so the</span> <span data-start="905.1" data-end="907.649">limit of this representation in terms of</span> <span data-start="907.649" data-end="910.079">accuracy of the fractions is based on</span> <span data-start="910.079" data-end="912.809">two factors first factor is that we are</span> <span data-start="912.809" data-end="914.759">building our fraction from the inverse</span> <span data-start="914.759" data-end="917.129">power of Paris of two and the other</span> <span data-start="917.129" data-end="919.589">factor is that we actually have quite</span> <span data-start="919.589" data-end="922.499">limited 52 bits of significant we can't</span> <span data-start="922.499" data-end="926.49">represent the smaller values what is</span> <span data-start="926.49" data-end="928.33">even more important is that</span> <span data-start="928.33" data-end="932.42">the bigger number we get in terms of the</span> <span data-start="932.42" data-end="934.67">integer value so when we need more and</span> <span data-start="934.67" data-end="937.07">more bits for the integer part the less</span> <span data-start="937.07" data-end="939.23">bits we have left for the fraction part</span> <span data-start="939.23" data-end="942.47">so when we move the point right to the</span> <span data-start="942.47" data-end="946.37">end of this representation let's see to</span> <span data-start="946.37" data-end="949.01">this point for such a large integer</span> <span data-start="949.01" data-end="951.62">value we have only one bit left for the</span> <span data-start="951.62" data-end="953.93">fraction part so we can only represent</span> <span data-start="953.93" data-end="955.34">the house</span> <span data-start="955.34" data-end="957.47">we can't represent any other fraction</span> <span data-start="957.47" data-end="962.66">for such a large numbers so what happens</span> <span data-start="962.66" data-end="964.34">if we move the point even more to the</span> <span data-start="964.34" data-end="968.21">right if the exponent is equal to 52 we</span> <span data-start="968.21" data-end="970.19">have all the bits of the significant</span> <span data-start="970.19" data-end="972.44">used for the integer value there is no</span> <span data-start="972.44" data-end="975.44">bit left for the fraction part so from</span> <span data-start="975.44" data-end="976.91">this point we can only represent</span> <span data-start="976.91" data-end="983.93">integers value so the biggest integer</span> <span data-start="983.93" data-end="986.27">value that actually fits into this</span> <span data-start="986.27" data-end="991.04">significant is this one we've used all</span> <span data-start="991.04" data-end="993.05">the bits in the significant part to</span> <span data-start="993.05" data-end="995.6">represent this number now what would</span> <span data-start="995.6" data-end="997.85">happen if we try to represent the bigger</span> <span data-start="997.85" data-end="1002.35">number let's see let's change that what</span> <span data-start="1002.35" data-end="1004.6">happens is kind of what we expected we</span> <span data-start="1004.6" data-end="1006.52">moved the point to the right to make a</span> <span data-start="1006.52" data-end="1009.1">more space for the integer part so we</span> <span data-start="1009.1" data-end="1013.33">have right now 53 bits for the integer</span> <span data-start="1013.33" data-end="1016.21">part but actually there is no bit left</span> <span data-start="1016.21" data-end="1020.35">there so how the number is computed so</span> <span data-start="1020.35" data-end="1023.47">what happens is that it's assumed that</span> <span data-start="1023.47" data-end="1026.14">all these bits that are missing are</span> <span data-start="1026.14" data-end="1029.52">zeros so this number is actually</span> <span data-start="1029.52" data-end="1033.34">accurately represented because this last</span> <span data-start="1033.34" data-end="1036.49">bit is assumed to be zero but what would</span> <span data-start="1036.49" data-end="1039.1">happen if we try to add one to it again</span> <span data-start="1039.1" data-end="1042.16">we can't because we can't change the</span> <span data-start="1042.16" data-end="1044.32">value of this last bit because we don't</span> <span data-start="1044.32" data-end="1047.41">control it it's it's always zero so the</span> <span data-start="1047.41" data-end="1049.54">last bit we actually control is this one</span> <span data-start="1049.54" data-end="1051.97">and it represents two to the power of</span> <span data-start="1051.97" data-end="1054.4">one so we can only add two to this</span> <span data-start="1054.4" data-end="1057.64">number so so from this point when the</span> <span data-start="1057.64" data-end="1060.79">exponent is equal to 53 we can</span> <span data-start="1060.79" data-end="1063.39">only represent every second integer</span> <span data-start="1063.39" data-end="1069.55">until we get to this point and again to</span> <span data-start="1069.55" data-end="1073.09">represent the bigger number we again</span> <span data-start="1073.09" data-end="1075.93">have to add 2 to it we will move point</span> <span data-start="1075.93" data-end="1079.75">to the right so right now we have 2 bits</span> <span data-start="1079.75" data-end="1083.5">that are assumed to be 0 so the last</span> <span data-start="1083.5" data-end="1086.26">value the last bit of we control is</span> <span data-start="1086.26" data-end="1088.51">representing 2 to the power of 2 so it's</span> <span data-start="1088.51" data-end="1091.84">4 so we can represent only every 4th</span> <span data-start="1091.84" data-end="1096.64">integer for exponent equal to 54 so the</span> <span data-start="1096.64" data-end="1100.57">bigger the exponent gets the bigger gaps</span> <span data-start="1100.57" data-end="1103.06">we will have between the integers values</span> <span data-start="1103.06" data-end="1105.79">we can represent so actually starting</span> <span data-start="1105.79" data-end="1111.34">from this exponent 52 we already have</span> <span data-start="1111.34" data-end="1113.29">gaps between the numbers so actually any</span> <span data-start="1113.29" data-end="1115.66">operations on on such a large integers</span> <span data-start="1115.66" data-end="1119.89">will have some error and similar thing</span> <span data-start="1119.89" data-end="1121.9">happens on the other side of the</span> <span data-start="1121.9" data-end="1131.11">significant if we make it smaller when</span> <span data-start="1131.11" data-end="1133.87">we have the exponent value of minus 1 so</span> <span data-start="1133.87" data-end="1137.29">our point is right before the hidden bit</span> <span data-start="1137.29" data-end="1141.16">this hidden bit represents 1/2 and every</span> <span data-start="1141.16" data-end="1143.11">other bit in the significant represents</span> <span data-start="1143.11" data-end="1146.14">smaller and smaller powers of 2 and when</span> <span data-start="1146.14" data-end="1149.86">we move the point the left we are</span> <span data-start="1149.86" data-end="1152.17">getting some missing bits assumes to be</span> <span data-start="1152.17" data-end="1156.04">zeros our first bit insignificant</span> <span data-start="1156.04" data-end="1158.08">represents smaller and smaller power of</span> <span data-start="1158.08" data-end="1161.89">2 so we are getting closer and closer to</span> <span data-start="1161.89" data-end="1169.18">0 but when we have this bit the hidden</span> <span data-start="1169.18" data-end="1173.05">bit assumed to be 1 it always represents</span> <span data-start="1173.05" data-end="1176.56">some power of 2 it can be very small but</span> <span data-start="1176.56" data-end="1178.6">there will be always some value in here</span> <span data-start="1178.6" data-end="1182.08">all right so we will never be able to</span> <span data-start="1182.08" data-end="1185.02">represent number 0 because we'll always</span> <span data-start="1185.02" data-end="1188.28">have some value given by this bit</span> <span data-start="1188.28" data-end="1191.559">fortunately this representation has a</span> <span data-start="1191.559" data-end="1195.159">section for death so when our exponent</span> <span data-start="1195.159" data-end="1197.769">gets his lowest possible value so when</span> <span data-start="1197.769" data-end="1200.879">the all bits of the exponent are zero so</span> <span data-start="1200.879" data-end="1205.149">our exponent is minus 1023 the hidden</span> <span data-start="1205.149" data-end="1210.519">bits also turns to zero so this way we</span> <span data-start="1210.519" data-end="1213.37">can represent zero as all the bits being</span> <span data-start="1213.37" data-end="1218.11">zero and we can of course change some</span> <span data-start="1218.11" data-end="1220.779">bits and significant to represent</span> <span data-start="1220.779" data-end="1224.379">numbers very close to zero they are</span> <span data-start="1224.379" data-end="1227.529">called sub normal values because of this</span> <span data-start="1227.529" data-end="1234.97">hidden bit being 0 but you may remember</span> <span data-start="1234.97" data-end="1237.549">this sign guy in here and I told you</span> <span data-start="1237.549" data-end="1241.509">that we can use it to change the sign of</span> <span data-start="1241.509" data-end="1243.159">any number represented in this</span> <span data-start="1243.159" data-end="1245.44">representation so what would happen if</span> <span data-start="1245.44" data-end="1249.519">we change the sign of 0 yeah we will get</span> <span data-start="1249.519" data-end="1252.009">minus 0 actually the floating point</span> <span data-start="1252.009" data-end="1254.499">representation defines two zeros</span> <span data-start="1254.499" data-end="1258.909">positive and negative one in JavaScript</span> <span data-start="1258.909" data-end="1261.039">it's not very easy to notice this</span> <span data-start="1261.039" data-end="1263.32">negative zero because there are only</span> <span data-start="1263.32" data-end="1266.019">certain operations that return it like</span> <span data-start="1266.019" data-end="1271.029">dividing by minus infinity but it's</span> <span data-start="1271.029" data-end="1274.08">there and the difference between</span> <span data-start="1274.08" data-end="1276.909">negative 0 and positive 0 can be</span> <span data-start="1276.909" data-end="1281.169">actually detected so we've seen what</span> <span data-start="1281.169" data-end="1285.7">happens when the exponent is again when</span> <span data-start="1285.7" data-end="1288.85">the exponent is at its lowest value so</span> <span data-start="1288.85" data-end="1291.61">now let's see the other side of the</span> <span data-start="1291.61" data-end="1297.369">extreme when we have all the bits of the</span> <span data-start="1297.369" data-end="1300.46">exponent set to 1 for the highest</span> <span data-start="1300.46" data-end="1303.159">exponent value this is the value</span> <span data-start="1303.159" data-end="1307.96">reserved for the Infinity positive or</span> <span data-start="1307.96" data-end="1311.619">negative infinity so that's how the</span> </p>
<p><span data-start="1311.619" data-end="1313.899">Infinity looks like all the exponent</span> <span data-start="1313.899" data-end="1316.749">bits set to 1 and all the significant</span> <span data-start="1316.749" data-end="1320.409">bits set to 0 and what will happen if we</span> <span data-start="1320.409" data-end="1323.95">try to change this significant bits to</span> <span data-start="1323.95" data-end="1327.71">Banke we get to now and it's not because</span> <span data-start="1327.71" data-end="1331.28">there is some error actually floating</span> <span data-start="1331.28" data-end="1333.95">point representation defines not a</span> <span data-start="1333.95" data-end="1337.64">number value so if all the exponent bits</span> <span data-start="1337.64" data-end="1340.52">are set to 1 and any bit in the</span> <span data-start="1340.52" data-end="1343.309">significant is set to 1 it's not a</span> <span data-start="1343.309" data-end="1347.66">number value so it kind of explains why</span> <span data-start="1347.66" data-end="1351.559">not a number type is a number because</span> <span data-start="1351.559" data-end="1354.02">not a number is a value defined by the</span> <span data-start="1354.02" data-end="1356.48">floating point representation it's</span> <span data-start="1356.48" data-end="1360.58">defined by 64 bits like any other number</span> <span data-start="1360.58" data-end="1364.73">actually this we have 52 bits in</span> <span data-start="1364.73" data-end="1366.71">significance so there are quite many not</span> <span data-start="1366.71" data-end="1368.48">a number values defined in this</span> <span data-start="1368.48" data-end="1371">representation fortunately to us Java</span> </p>
<p><span data-start="1371" data-end="1373.549">Script simplifies it to only one not a</span> <span data-start="1373.549" data-end="1381.61">number yeah but let's get maybe back to</span> <span data-start="1381.61" data-end="1385.58">numbers and summarize it what we already</span> <span data-start="1385.58" data-end="1391.88">heard here so for any given number we</span> <span data-start="1391.88" data-end="1396.08">can compute its value by computing the</span> <span data-start="1396.08" data-end="1399.86">values of the significant bits with the</span> <span data-start="1399.86" data-end="1402.83">position of the point based on the value</span> <span data-start="1402.83" data-end="1405.919">from the exponent and design defining a</span> <span data-start="1405.919" data-end="1409.64">design of our number but as I told you</span> <span data-start="1409.64" data-end="1411.38">at the very beginning we can treat the</span> <span data-start="1411.38" data-end="1414.83">exponent as kind of a multiplier so if</span> <span data-start="1414.83" data-end="1418.1">we take it out of this parenthesis and</span> <span data-start="1418.1" data-end="1421.46">treat it as a multiplier we start to</span> <span data-start="1421.46" data-end="1423.559">compute the significant value always</span> <span data-start="1423.559" data-end="1425.72">starting with two to the power of zero</span> <span data-start="1425.72" data-end="1428.62">it's the value given by this hidden bit</span> <span data-start="1428.62" data-end="1437">so we can always set it to 1 because you</span> <span data-start="1437" data-end="1439.429">know 2 to the power of 0 is 1</span> <span data-start="1439.429" data-end="1441.59">so that's the one given by the hidden</span> <span data-start="1441.59" data-end="1445.7">bit and here we have the value computed</span> <span data-start="1445.7" data-end="1449.929">for the exponent and this way we kind of</span> <span data-start="1449.929" data-end="1454.59">reverse engineered the equation for</span> <span data-start="1454.59" data-end="1456.51">how the numbers are computed in double</span> <span data-start="1456.51" data-end="1459.72">floating-point representation and that's</span> <span data-start="1459.72" data-end="1464.22">the equation you can find in similar</span> <span data-start="1464.22" data-end="1469.35">fashion on this Wikipedia page so I know</span> <span data-start="1469.35" data-end="1471.99">it was quite a hardcore topic for a</span> </p>
<p><span data-start="1471.99" data-end="1474.75">Sunday morning after the great party but</span> <span data-start="1474.75" data-end="1478.95">I hope that I have given you at least a</span> <span data-start="1478.95" data-end="1481.95">little bit of understanding how numbers</span> <span data-start="1481.95" data-end="1485.25">in JavaScript work and why we have all</span> <span data-start="1485.25" data-end="1487.799">these problems we've done and hopefully</span> <span data-start="1487.799" data-end="1489.539">after this talk we can all think about</span> <span data-start="1489.539" data-end="1493.73">ourselves as those who understand binary</span> <span data-start="1493.73" data-end="1497.549">and maybe next time you stumble upon</span> <span data-start="1497.549" data-end="1500.309">some weird behavior with numbers or with</span> </p>
<p><span data-start="1500.309" data-end="1502.799">JavaScript and you will ask yourself why</span> <span data-start="1502.799" data-end="1507.059">because answers and reasons are out</span> <span data-start="1507.059" data-end="1510.299">there waiting for us to find them so be</span> <span data-start="1510.299" data-end="1512.669">curious because there is hell a lot of</span> <span data-start="1512.669" data-end="1514.52">interesting things you can learn and</span> <span data-start="1514.52" data-end="1517.32">sometimes quite unexpected answers you</span> <span data-start="1517.32" data-end="1522.08">can get so that was all I had for you</span> <span data-start="1522.08" data-end="1534.39">you can follow me on Twitter</span> <span data-start="1534.4" data-end="1536.84">do any questions is there anything left</span> <span data-start="1536.84" data-end="1537.95">that you didn't want to know about</span> <span data-start="1537.95" data-end="1539.57">numbers that you somehow wanna know now</span> <span data-start="1539.57" data-end="1548.21">yes sorry can you keep your hand up I</span> <span data-start="1548.21" data-end="1550.76">there we go sorry my Tracking's not so</span> <span data-start="1550.76" data-end="1557.81">good right I mean from some cloud thanks</span> <span data-start="1557.81" data-end="1560.63">for the talk was great I just want to</span> <span data-start="1560.63" data-end="1563.48">add something if you would want to work</span> <span data-start="1563.48" data-end="1565.37">with big numbers you can actually use</span> <span data-start="1565.37" data-end="1567.74">libraries for that which are called big</span> <span data-start="1567.74" data-end="1570.17">naam libraries these exist in most</span> <span data-start="1570.17" data-end="1572.63">languages and yeah I found myself in a</span> <span data-start="1572.63" data-end="1576.2">situation won't yeah thanks</span> <span data-start="1576.2" data-end="1578.57">yeah that's true I was just focusing on</span> <span data-start="1578.57" data-end="1580.49">the numbers representation how they're</span> <span data-start="1580.49" data-end="1588.35">in this floating point right okay thank</span> <span data-start="1588.35" data-end="1600.36">you so much Bartok</span> </p>
</section>