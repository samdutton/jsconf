<section>
<p><span data-start="7.24" data-end="9.41">so fuzzy thank you for having me</span> <span data-start="9.41" data-end="11.419">pictures you inviting me Nicole Leah</span> <span data-start="11.419" data-end="13.19">Chris this has been an amazing</span> <span data-start="13.19" data-end="15.23">conference I've been amazed by the</span> <span data-start="15.23" data-end="17">location and all of the guests and all</span> <span data-start="17" data-end="19.36">the talks have been having so thank you</span> <span data-start="19.36" data-end="22.04">so I'm Patrick Hammond as Jen mentioned</span> <span data-start="22.04" data-end="24.05">you can get me on twitter there and i'm</span> <span data-start="24.05" data-end="26.33">here to talk to you today about CSS and</span> <span data-start="26.33" data-end="27.95">the critical path now what does that</span> <span data-start="27.95" data-end="30.17">mean i don't really know I hope you'll</span> <span data-start="30.17" data-end="31.4">know what that means by the end of this</span> <span data-start="31.4" data-end="34.07">talk so as done mentioned it's a talker</span> <span data-start="34.07" data-end="36.8">it's really a bit of a ruse I'm here CSS</span> <span data-start="36.8" data-end="39.05">confer I'm actually here not really to</span> <span data-start="39.05" data-end="40.969">talk to you about CSS but more about</span> <span data-start="40.969" data-end="42.499">performance and importance but</span> <span data-start="42.499" data-end="45.739">importantly how CSS is intertwined and</span> <span data-start="45.739" data-end="48.05">tightly coupled with our critical path</span> <span data-start="48.05" data-end="49.999">the path from which a browser takes to</span> <span data-start="49.999" data-end="52.069">render to our screen so have you haven't</span> <span data-start="52.069" data-end="54.039">guessed already a work for the Guardian</span> <span data-start="54.039" data-end="58.489">it's a national UK newspaper which is</span> <span data-start="58.489" data-end="60.889">now a international media organization</span> <span data-start="60.889" data-end="63.229">we have offices in New York Australia</span> <span data-start="63.229" data-end="65.93">and London and and I work on the cool</span> <span data-start="65.93" data-end="67.219">web team there which were helping to</span> <span data-start="67.219" data-end="68.689">make the next generation of the Guardian</span> <span data-start="68.689" data-end="70.34">website we've spent the last 18 months</span> <span data-start="70.34" data-end="73.67">completely re-engineering from scratch</span> <span data-start="73.67" data-end="75.77">the Guardian website used to be before</span> <span data-start="75.77" data-end="77.99">horrible large Java and monolithic</span> <span data-start="77.99" data-end="80.27">application and we're now moving to a</span> <span data-start="80.27" data-end="83.119">mobile-first responsive website as Brad</span> <span data-start="83.119" data-end="84.969">force one scrape coined the phrase</span> <span data-start="84.969" data-end="87.38">planting the responsive seed it's very</span> <span data-start="87.38" data-end="90.859">hard for large organizations to shift to</span> <span data-start="90.859" data-end="93.32">responsive so actually we kind of took</span> <span data-start="93.32" data-end="95.93">tiptoed along the way we first replace</span> <span data-start="95.93" data-end="98.329">our end sub domain with a responsive</span> <span data-start="98.329" data-end="99.799">site which it's going to become the</span> <span data-start="99.799" data-end="101.81">platform on the basis to take eventually</span> <span data-start="101.81" data-end="103.34">hopefully this summer we're going to</span> <span data-start="103.34" data-end="105.439">completely remove the old site and have</span> <span data-start="105.439" data-end="109.609">one single platform and so today I'm</span> <span data-start="109.609" data-end="110.929">going to talk to you about some of the</span> <span data-start="110.929" data-end="114.829">lessons I've learnt building this last</span> <span data-start="114.829" data-end="116.509">month we broke a record at the Guardian</span> <span data-start="116.509" data-end="118.7">we had 100 million unique users within</span> <span data-start="118.7" data-end="120.829">the first month that makes us now one of</span> <span data-start="120.829" data-end="122.24">the largest new yours I license in the</span> <span data-start="122.24" data-end="125.96">world but on the flip side of that those</span> <span data-start="125.96" data-end="128.24">100 million are being made up of</span> <span data-start="128.24" data-end="130.909">accessing our site from over 6,000</span> <span data-start="130.909" data-end="133.459">different devices and our current</span> <span data-start="133.459" data-end="134.06">platform</span> <span data-start="134.06" data-end="135.77">the old site is there for 10 years</span> <span data-start="135.77" data-end="138.56">wasn't designed they can't cater for</span> <span data-start="138.56" data-end="141.349">this array of devices and it's just not</span> <span data-start="141.349" data-end="143">acceptable what we are serving to these</span> <span data-start="143" data-end="145.01">devices and we had to do something about</span> <span data-start="145.01" data-end="147.739">that but more importantly the site is</span> <span data-start="147.739" data-end="151.7">extremely slow so here you'll see on the</span> <span data-start="151.7" data-end="153.349">left-hand side our old site and the</span> <span data-start="153.349" data-end="155.51">right-hand side our new site and the</span> <span data-start="155.51" data-end="156.95">difference in the rendering speed</span> <span data-start="156.95" data-end="159.29">between the two of them just hit see how</span> <span data-start="159.29" data-end="161.75">how what you think yourself so within</span> <span data-start="161.75" data-end="163.91">three seconds we've finished painting</span> <span data-start="163.91" data-end="165.5">and rendering and freely complete</span> <span data-start="165.5" data-end="167.78">loading of the whole site whilst we're</span> <span data-start="167.78" data-end="170.989">still chugging along on the outside and</span> <span data-start="170.989" data-end="173.48">that that's a median average it takes 12</span> <span data-start="173.48" data-end="176.03">seconds to paint and finish loading of</span> <span data-start="176.03" data-end="178.4">our website to the user now I just don't</span> <span data-start="178.4" data-end="180.56">think that's acceptable and I hope you</span> <span data-start="180.56" data-end="182.42">guys don't too but you know it's not</span> <span data-start="182.42" data-end="184.549">just us at the Guardian see this problem</span> <span data-start="184.549" data-end="187.01">use the low time expectations us as uses</span> <span data-start="187.01" data-end="189.62">our expectation of how fast a web site</span> <span data-start="189.62" data-end="191.81">takes a render is reducing you know from</span> <span data-start="191.81" data-end="193.819">2,000 it was nine seconds all the way</span> <span data-start="193.819" data-end="196.79">until 2012 it's just two seconds that</span> <span data-start="196.79" data-end="199.25">your users expect your website to load</span> <span data-start="199.25" data-end="201.95">in and again the problems not just ours</span> <span data-start="201.95" data-end="204.65">this is for taken from mates be archived</span> <span data-start="204.65" data-end="206.63">or great Google initiative that they</span> <span data-start="206.63" data-end="208.94">index data from the top two hundred</span> <span data-start="208.94" data-end="211.16">thousand websites and I ran this query</span> <span data-start="211.16" data-end="214.459">on big queries last month to ask ask it</span> <span data-start="214.459" data-end="216.739">hey what is the speed index I eat the</span> <span data-start="216.739" data-end="219.92">speed index is a metric that is in</span> <span data-start="219.92" data-end="222.319">milliseconds how fast your site takes</span> <span data-start="222.319" data-end="224.51">the fully render and the top ten</span> <span data-start="224.51" data-end="226.31">thousand websites the median average is</span> <span data-start="226.31" data-end="228.2">nine thousand milliseconds right nine</span> <span data-start="228.2" data-end="231.769">seconds whereas we know that our users</span> <span data-start="231.769" data-end="234.92">want it to load in under two can you see</span> <span data-start="234.92" data-end="237.079">where I'm going here with this so but</span> <span data-start="237.079" data-end="238.73">the Guardian you know how we have to</span> <span data-start="238.73" data-end="240.319">relate this back to our business so when</span> <span data-start="240.319" data-end="241.94">we are starting out on the new projects</span> <span data-start="241.94" data-end="245.12">we surveyed 3,000 of our users and ask</span> <span data-start="245.12" data-end="248.66">them about 17 core KPIs product</span> <span data-start="248.66" data-end="250.43">indicators of which one of them was</span> <span data-start="250.43" data-end="253.76">speed and unsurprisingly to me those</span> <span data-start="253.76" data-end="255.98">users rated speed as a feature the</span> <span data-start="255.98" data-end="258.35">second most important thing only after</span> <span data-start="258.35" data-end="261.62">easy to find content you'd hope on a</span> <span data-start="261.62" data-end="263.599">news website that the content is easy to</span> <span data-start="263.599" data-end="265.909">find although that did surprise the</span> <span data-start="265.909" data-end="267.47">business though but it was great for me</span> <span data-start="267.47" data-end="267.92">because</span> <span data-start="267.92" data-end="270.2">allowed as a leverage to really drill</span> <span data-start="270.2" data-end="271.94">into them that we need to make this new</span> <span data-start="271.94" data-end="275.96">platform fast and it's not just that as</span> <span data-start="275.96" data-end="277.37">well there's have been a lot of HCI</span> <span data-start="277.37" data-end="279.29">research recently that has gone into the</span> <span data-start="279.29" data-end="280.91">fact that the cognitive levels of us as</span> <span data-start="280.91" data-end="283.91">users how how we perceive speed on</span> <span data-start="283.91" data-end="286.45">machines this is taken from Illig agaric</span> <span data-start="286.45" data-end="288.38">high-performance browser networking he</span> <span data-start="288.38" data-end="290.6">works on the Google make web faster team</span> <span data-start="290.6" data-end="293">it's a strongly advise you read that</span> <span data-start="293" data-end="295.82">book but here it says that for a mission</span> <span data-start="295.82" data-end="297.8">for us as uses for field that a machine</span> <span data-start="297.8" data-end="300.47">is actually functioning and working any</span> <span data-start="300.47" data-end="303.29">action you perform must respond within a</span> <span data-start="303.29" data-end="305.84">thousand milliseconds 1000 milliseconds</span> <span data-start="305.84" data-end="307.46">and that's not just you can't just</span> <span data-start="307.46" data-end="308.6">relate that to websites you can relate</span> <span data-start="308.6" data-end="310.4">that at home I'm sitting on the couch on</span> <span data-start="310.4" data-end="312.8">watching TV I change the TV channel I</span> <span data-start="312.8" data-end="315.29">want that TV that TV needs to respond</span> <span data-start="315.29" data-end="317.24">within a thousand milliseconds for me to</span> <span data-start="317.24" data-end="319.37">deem the machine working and after 10</span> <span data-start="319.37" data-end="321.98">seconds but my mental subconscious just</span> <span data-start="321.98" data-end="323.51">moves on and that task is completely</span> <span data-start="323.51" data-end="327.5">abandoned and so Tim cowlicks been</span> <span data-start="327.5" data-end="328.64">talking about this a lot recent so you</span> <span data-start="328.64" data-end="330.56">talked so now we know that a thousand</span> <span data-start="330.56" data-end="331.79">milliseconds is what we're trying to</span> <span data-start="331.79" data-end="334.67">reach our website should render within a</span> <span data-start="334.67" data-end="336.95">thousand milliseconds what if we were to</span> <span data-start="336.95" data-end="339.23">set a budget to enforce that in our</span> <span data-start="339.23" data-end="341.54">development workflow every new feature</span> <span data-start="341.54" data-end="345.41">every new page we make has to hit that</span> <span data-start="345.41" data-end="348.29">budget so that's exactly what we did at</span> <span data-start="348.29" data-end="349.67">the Guardian we've set ourselves a</span> <span data-start="349.67" data-end="351.89">budget of ensuring that all pages render</span> <span data-start="351.89" data-end="354.59">within a thousand milliseconds no longer</span> <span data-start="354.59" data-end="357.5">we can think in seconds as web</span> <span data-start="357.5" data-end="359.24">developers we really need to start</span> <span data-start="359.24" data-end="363.11">thinking in milliseconds so let's dive a</span> <span data-start="363.11" data-end="364.64">little bit deeper into this for us to be</span> <span data-start="364.64" data-end="366.53">able to understand how we can paint</span> <span data-start="366.53" data-end="367.76">within a thousand milliseconds we need</span> <span data-start="367.76" data-end="369.74">to understand what's going on in behind</span> <span data-start="369.74" data-end="372.26">the scenes how the browser goes from</span> <span data-start="372.26" data-end="373.73">that and you clicking on that link to</span> <span data-start="373.73" data-end="375.47">being able to paint on the screen but</span> <span data-start="375.47" data-end="378.2">also knowing how the browser works makes</span> <span data-start="378.2" data-end="379.91">us as web developers make better</span> <span data-start="379.91" data-end="382.91">decisions when we build our web</span> <span data-start="382.91" data-end="385.31">applications so hopefully you will see</span> <span data-start="385.31" data-end="388.16">one of these before this is a waterfall</span> <span data-start="388.16" data-end="389.72">chart taken from web page test as a</span> <span data-start="389.72" data-end="392.06">segment explaining the network each bit</span> <span data-start="392.06" data-end="394.22">of the network's made up the DNS lookup</span> <span data-start="394.22" data-end="396.23">so converting the nice the Guardian com</span> <span data-start="396.23" data-end="399.32">string into an IP address we then can go</span> <span data-start="399.32" data-end="400.61">the computer can use that IP address</span> <span data-start="400.61" data-end="401.54">again make a tee</span> </p>
<p><span data-start="401.54" data-end="403.67">TP socket connection a freeway handshake</span> <span data-start="403.67" data-end="406.07">and then finally I can make the actual</span> <span data-start="406.07" data-end="407.87">Haiti request i can say hey give me</span> <span data-start="407.87" data-end="410.63">index dot HTML and when the server deals</span> <span data-start="410.63" data-end="412.43">of that it responds and finally we can</span> <span data-start="412.43" data-end="414.56">download the content and so all of that</span> <span data-start="414.56" data-end="417.38">has to happen before we can even start</span> <span data-start="417.38" data-end="421.64">creating a Dom but our physical tavera</span> <span data-start="421.64" data-end="424.01">files a millisecond barrier 600</span> <span data-start="424.01" data-end="426.17">milliseconds of that on average is</span> <span data-start="426.17" data-end="427.79">already taken up this is on a free</span> <span data-start="427.79" data-end="430.82">average 3g mobile connection 600 of that</span> <span data-start="430.82" data-end="434.09">is already taken up by latency we've</span> <span data-start="434.09" data-end="435.98">heard this before latency is the biggest</span> <span data-start="435.98" data-end="438.53">killer to performance and especially on</span> <span data-start="438.53" data-end="440.63">mobile so every network you request you</span> <span data-start="440.63" data-end="442.46">make you're incurring the 600</span> <span data-start="442.46" data-end="444.32">milliseconds and so that leaves us with</span> <span data-start="444.32" data-end="446.93">only 400 milliseconds to really paint to</span> <span data-start="446.93" data-end="448.94">the screen and now you start to think of</span> <span data-start="448.94" data-end="453.5">how important it is to rendering so this</span> <span data-start="453.5" data-end="455.48">is being very simplified but this is</span> <span data-start="455.48" data-end="457.88">what the critical rendering path is this</span> <span data-start="457.88" data-end="459.44">is what your browser has to go through</span> <span data-start="459.44" data-end="461.54">to be able to paint for to the screen so</span> <span data-start="461.54" data-end="462.92">let's look a bit deeper than that so I</span> <span data-start="462.92" data-end="465.47">asked for my index page I perform the</span> <span data-start="465.47" data-end="467.08">network on it incur the 600 milliseconds</span> <span data-start="467.08" data-end="470.03">once I've got the HTML fortunately i can</span> <span data-start="470.03" data-end="472.1">start parsing the HTML and creating a</span> </p>
<p><span data-start="472.1" data-end="473.87">Dom structure now one of the greatest</span> <span data-start="473.87" data-end="475.64">things about the HTML spec is that a</span> <span data-start="475.64" data-end="477.74">dumb construction and hates them are</span> <span data-start="477.74" data-end="479.57">pausing can happen incrementally so we</span> <span data-start="479.57" data-end="481.31">don't have to wait for the whole file to</span> <span data-start="481.31" data-end="482.6">be downloaded we can actually start</span> <span data-start="482.6" data-end="484.85">creating the Dom as the packets come in</span> <span data-start="484.85" data-end="487.13">and this is amazing feature so I'm</span> <span data-start="487.13" data-end="488.99">sitting there I packets come in I'm</span> <span data-start="488.99" data-end="491.03">constructing a DOM and boom my browser</span> <span data-start="491.03" data-end="493.31">hits a script or a link element it has</span> <span data-start="493.31" data-end="495.11">to stop it can't construct the Dom</span> <span data-start="495.11" data-end="497.27">anymore had to stop blocking it has to</span> <span data-start="497.27" data-end="499.7">go back and perform the networking to go</span> <span data-start="499.7" data-end="502.13">and get that CSS file so I download the</span> </p>
<p><span data-start="502.13" data-end="503.96">CSS file to create the CSS object model</span> <span data-start="503.96" data-end="506.15">now the CSS object model and the Dom</span> <span data-start="506.15" data-end="507.86">together create a render tree said</span> <span data-start="507.86" data-end="509.39">another tree like structure that has all</span> <span data-start="509.39" data-end="510.71">of the information about the nodes on</span> <span data-start="510.71" data-end="512.479">your page from the top left to bottom</span> <span data-start="512.479" data-end="516.74">right and but the due to the cascading</span> <span data-start="516.74" data-end="519.62">nature of CSS we can't parse the CSS</span> <span data-start="519.62" data-end="521.45">incrementally like we did with the HTML</span> <span data-start="521.45" data-end="523.49">file because of the Cascade so styles at</span> <span data-start="523.49" data-end="524.9">the top of the page might be overwritten</span> <span data-start="524.9" data-end="526.85">further down in a media query or</span> <span data-start="526.85" data-end="528.2">something like that so and that would</span> <span data-start="528.2" data-end="530.09">actually constantly stop painting and</span> <span data-start="530.09" data-end="531.17">flashing to the screen and causing</span> <span data-start="531.17" data-end="533.21">reflows so you know actually be a</span> <span data-start="533.21" data-end="535.29">negative user experience so we have</span> <span data-start="535.29" data-end="537.089">to wait for the whole CSS file to be</span> <span data-start="537.089" data-end="539.73">downloaded before we can construct the</span> </p>
<p><span data-start="539.73" data-end="542.88">CSS object model and then our lovely</span> <span data-start="542.88" data-end="546.779">friend and foe JavaScript now if we find</span> <span data-start="546.779" data-end="549.66">a script element JavaScript blocks Dom</span> <span data-start="549.66" data-end="551.459">construction because of that that great</span> <span data-start="551.459" data-end="554.37">feature document dot write JavaScript</span> <span data-start="554.37" data-end="556.44">can alter the dong and so because of</span> <span data-start="556.44" data-end="559.199">that the Dom can't continue to pass but</span> <span data-start="559.199" data-end="561.18">javascript is tightly coupled with CSS</span> <span data-start="561.18" data-end="563.16">because this year it has to block and</span> <span data-start="563.16" data-end="564.66">wait for the CSS object model to be</span> <span data-start="564.66" data-end="567.63">created because what is javascript was</span> <span data-start="567.63" data-end="570.269">the query is style on a node and this is</span> <span data-start="570.269" data-end="572.49">why the age-old best practice of putting</span> <span data-start="572.49" data-end="574.23">JavaScript to the bottom or even more</span> <span data-start="574.23" data-end="576.899">importantly declaring it as a sink your</span> <span data-start="576.899" data-end="578.459">you're making a promise with the browser</span> <span data-start="578.459" data-end="580.17">saying I know this javascript is not</span> <span data-start="580.17" data-end="582.569">going to do need anything dodgy you you</span> <span data-start="582.569" data-end="584.009">can just take it off the critical path</span> <span data-start="584.009" data-end="587.399">and but it's really interesting this</span> <span data-start="587.399" data-end="589.589">relationship it's into tying tightly</span> <span data-start="589.589" data-end="592.11">coupled and I ask this in an interview</span> <span data-start="592.11" data-end="593.85">quite a lot to people I'm interviewing</span> <span data-start="593.85" data-end="596.13">so yeah so yeah yeah I put job descrip</span> <span data-start="596.13" data-end="597.48">to the bottom of page why deeper</span> </p>
<p><span data-start="597.48" data-end="599.67">JavaScript oh because it looks why does</span> <span data-start="599.67" data-end="602.1">it block and they never know it's</span> <span data-start="602.1" data-end="603.42">surprising how many people don't</span> <span data-start="603.42" data-end="605.43">actually know what is the actual reason</span> <span data-start="605.43" data-end="606.99">why javascript blocked our browser</span> <span data-start="606.99" data-end="609.779">rendering so we've done the good thing</span> <span data-start="609.779" data-end="611.19">we've taken javascript off the only</span> <span data-start="611.19" data-end="612.66">thing we're left with is the CSS object</span> <span data-start="612.66" data-end="616.74">model we need that and so finally we can</span> <span data-start="616.74" data-end="618.87">then perform layout and paint and you</span> <span data-start="618.87" data-end="621.029">can see here how this is all traditional</span> <span data-start="621.029" data-end="622.23">websites look like this we've got our</span> </p>
<p><span data-start="622.23" data-end="624.06">HTML within download our CSS and a</span> <span data-start="624.06" data-end="625.829">transcript if we make the JavaScript</span> <span data-start="625.829" data-end="627.6">asynchronous take it off the critical</span> <span data-start="627.6" data-end="630.66">path now we've already shaved off a lot</span> <span data-start="630.66" data-end="632.04">of milliseconds there to be able to</span> <span data-start="632.04" data-end="637.649">paint so we know we have to get CSS down</span> <span data-start="637.649" data-end="641.069">as soon as possible it should be the</span> <span data-start="641.069" data-end="643.56">only thing on your critical path and in</span> <span data-start="643.56" data-end="648.93">my opinion it is the critical path but</span> <span data-start="648.93" data-end="652.67">how can we optimize our CSS for this</span> <span data-start="652.67" data-end="655.56">start to answer ask that question what</span> <span data-start="655.56" data-end="657.839">actually is your critical CSS and</span> <span data-start="657.839" data-end="660.569">especially on a responsive website you</span> <span data-start="660.569" data-end="662.31">know that concept of above the fold no</span> <span data-start="662.31" data-end="664.889">longer exists something that is above</span> <span data-start="664.889" data-end="666.18">the fold and the mobile might not be</span> <span data-start="666.18" data-end="669.059">above the fold on your desktop so here's</span> <span data-start="669.059" data-end="670.739">which guard in article page is my</span> <span data-start="670.739" data-end="672.569">critical CSS the sharing widget or the</span> <span data-start="672.569" data-end="675.509">popular content or the comments none of</span> <span data-start="675.509" data-end="679.229">this is only the article the user came</span> <span data-start="679.229" data-end="680.909">there to read the news that is the only</span> <span data-start="680.909" data-end="683.219">critical CSS that you require to paint</span> <span data-start="683.219" data-end="685.619">to that screen and it should be the only</span> <span data-start="685.619" data-end="688.559">thing so we take that one step further</span> <span data-start="688.559" data-end="689.699">at the Guardian that you know we</span> <span data-start="689.699" data-end="691.649">actually ajax in and progressively</span> <span data-start="691.649" data-end="692.759">hearts with the rest of the initial</span> <span data-start="692.759" data-end="695.639">payload actually only has the HDH ml for</span> <span data-start="695.639" data-end="697.829">the article in it this is our non</span> <span data-start="697.829" data-end="702.359">critical CSS verses are non critical and</span> <span data-start="702.359" data-end="704.699">so Angelina just up before me and</span> <span data-start="704.699" data-end="707.249">started to allude to this fact of so we</span> <span data-start="707.249" data-end="710.969">now know what our critical CSS is but</span> <span data-start="710.969" data-end="714.239">what if we were to inline that CSS into</span> <span data-start="714.239" data-end="717.299">the head of the document knowing what we</span> <span data-start="717.299" data-end="718.619">just we just learnt from browser</span> <span data-start="718.619" data-end="720.629">rendering then the browser has</span> <span data-start="720.629" data-end="722.729">everything it needs to be able to create</span> <span data-start="722.729" data-end="726.289">the render tree within one HTTP request</span> <span data-start="726.289" data-end="728.969">everything we don't need to wait that</span> <span data-start="728.969" data-end="731.069">incur that 600 milliseconds again to go</span> <span data-start="731.069" data-end="732.959">and download the rest of the CSS file</span> <span data-start="732.959" data-end="735.509">all of our styles the critical ones were</span> <span data-start="735.509" data-end="737.279">above the full content are delivered in</span> <span data-start="737.279" data-end="740.369">the first payload now we know it's very</span> <span data-start="740.369" data-end="742.859">controversial but that's exactly what we</span> <span data-start="742.859" data-end="746.219">started to do at the Guardian so we've</span> <span data-start="746.219" data-end="747.629">got the styling them at the top this</span> <span data-start="747.629" data-end="749.039">goes against everything we've been</span> <span data-start="749.039" data-end="751.609">taught as good web developers you know</span> <span data-start="751.609" data-end="754.829">separation of concerns styles and CSS</span> <span data-start="754.829" data-end="756.509">behavior in JavaScript files and</span> <span data-start="756.509" data-end="759.449">completely separate but if you want your</span> <span data-start="759.449" data-end="761.819">page to paint within a thousand</span> <span data-start="761.819" data-end="763.949">milliseconds this is what you have to do</span> <span data-start="763.949" data-end="767.039">so if you go to the Guardian be decide</span> <span data-start="767.039" data-end="769.019">right now you'll find this disgustingly</span> <span data-start="769.019" data-end="772.889">an ugly blob of JavaScript to the top</span> <span data-start="772.889" data-end="775.439">compressed into 14 K so if you've got a</span> <span data-start="775.439" data-end="779.129">full TCP connection window open you'll</span> <span data-start="779.129" data-end="781.619">have enough information within the first</span> <span data-start="781.619" data-end="784.139">packet for the browser to render to the</span> <span data-start="784.139" data-end="786.719">screen so that's enough about what is</span> <span data-start="786.719" data-end="790.649">that actually like to the user so the</span> <span data-start="790.649" data-end="792.449">top doesn't have any in line the bottom</span> <span data-start="792.449" data-end="795.449">does we've rendered in 600 milliseconds</span> <span data-start="795.449" data-end="798.569">there and we basically nearly finished</span> <span data-start="798.569" data-end="800.97">painting and the one without hasn't even</span> <span data-start="800.97" data-end="802.76">started</span> <span data-start="802.76" data-end="806.91">but for their though that observant ones</span> <span data-start="806.91" data-end="808.17">of you in the in the audience would</span> <span data-start="808.17" data-end="810.09">notice that I still have to load the</span> <span data-start="810.09" data-end="811.68">rest of them right I've got my critical</span> <span data-start="811.68" data-end="813.21">styles but I need to be able to load the</span> <span data-start="813.21" data-end="814.98">rest of them in and so we now at the</span> <span data-start="814.98" data-end="817.65">bottom of the page we have to a sink in</span> <span data-start="817.65" data-end="820.32">the JavaScript and then create a style</span> <span data-start="820.32" data-end="823.07">element and inject it into the head</span> <span data-start="823.07" data-end="825.48">therefore completely taking the rest of</span> <span data-start="825.48" data-end="830.13">those styles off the critical part even</span> <span data-start="830.13" data-end="831.69">more observant in the audience with we</span> <span data-start="831.69" data-end="833.1">start to thinking about that ever hang</span> <span data-start="833.1" data-end="835.08">on a second if you do a sink in the rest</span> <span data-start="835.08" data-end="836.58">of your global styles isn't that going</span> <span data-start="836.58" data-end="839.07">to cause a massive ugly reflow or</span> <span data-start="839.07" data-end="840.99">repaint once those new styles come in</span> <span data-start="840.99" data-end="843.03">and you're in fact correct that's</span> <span data-start="843.03" data-end="845.55">exactly what happens and once we first</span> <span data-start="845.55" data-end="847.29">implemented this a couple a week later</span> </p>
<p><span data-start="847.29" data-end="849.15">I'm a great director of The Guardian</span> <span data-start="849.15" data-end="851.16">came walking in and said what the hell</span> <span data-start="851.16" data-end="853.86">is this ugly flash on my website and he</span> <span data-start="853.86" data-end="855.33">was right you know this it wasn't</span> <span data-start="855.33" data-end="857.16">acceptable that the users was yes we</span> <span data-start="857.16" data-end="859.26">managed to if we optimize it well enough</span> <span data-start="859.26" data-end="860.61">you know they wouldn't see it but if</span> <span data-start="860.61" data-end="861.81">they started scrolling soon enough</span> <span data-start="861.81" data-end="864.29">they'd see that horrible paint instantly</span> <span data-start="864.29" data-end="866.91">so the only way to get around this is</span> <span data-start="866.91" data-end="868.41">that we obviously have to manage that</span> <span data-start="868.41" data-end="870.6">somehow we have to cash it and so we</span> <span data-start="870.6" data-end="872.49">looked to local storage to act as a</span> <span data-start="872.49" data-end="874.71">cache that what if we could once we've a</span> <span data-start="874.71" data-end="877.26">synced all of that CSS in we could then</span> <span data-start="877.26" data-end="879.48">cash it in the users local storage and</span> <span data-start="879.48" data-end="881.49">the next time round we have all of the</span> <span data-start="881.49" data-end="883.59">information within the first request to</span> <span data-start="883.59" data-end="885.24">be able to paint to the screen avoiding</span> <span data-start="885.24" data-end="887.87">any paint any flash of unstyled content</span> <span data-start="887.87" data-end="890.7">so first we we asked if the browser</span> <span data-start="890.7" data-end="892.74">modern enough the BBC's cut the mustard</span> <span data-start="892.74" data-end="895.11">test you know does it have XHTML OHV</span> <span data-start="895.11" data-end="896.67">object does it have event listener if</span> <span data-start="896.67" data-end="899.31">not no just user normal non word link</span> <span data-start="899.31" data-end="902.91">and but is there already stars in local</span> <span data-start="902.91" data-end="906.75">storage yes great there's paint if not</span> <span data-start="906.75" data-end="908.91">do they have local space storage now</span> <span data-start="908.91" data-end="910.32">this is an interesting one we found that</span> <span data-start="910.32" data-end="912.63">a large percent is an especially iphone</span> <span data-start="912.63" data-end="915.75">users have a quota exceeded already on</span> <span data-start="915.75" data-end="918.3">there on the local storage if so</span> <span data-start="918.3" data-end="920.76">requested with Ajax cash it in the local</span> <span data-start="920.76" data-end="923.1">storage and then paint again and then on</span> <span data-start="923.1" data-end="924.87">the next time round we can instantly</span> <span data-start="924.87" data-end="926.4">just go straight to instant painting</span> <span data-start="926.4" data-end="928.47">with all of our Styles not making a</span> <span data-start="928.47" data-end="932.34">single request to to a stylesheet so</span> <span data-start="932.34" data-end="934.68">here we've just a on to our top back in</span> <span data-start="934.68" data-end="935.67">the head</span> <span data-start="935.67" data-end="937.29">now check to see if this the storage</span> <span data-start="937.29" data-end="940.08">items are there if it is inject it into</span> <span data-start="940.08" data-end="943.65">a style node there instantly all of your</span> <span data-start="943.65" data-end="945.45">styles within the first hey tbo press</span> <span data-start="945.45" data-end="947.37">and enough to deliver the news to the</span> <span data-start="947.37" data-end="950.72">user within a thousand milliseconds</span> <span data-start="950.72" data-end="953.22">again now down the bottom so we've now</span> <span data-start="953.22" data-end="955.41">we've done our normal age acting but we</span> <span data-start="955.41" data-end="958.74">now have to store it so here we're</span> <span data-start="958.74" data-end="960.27">actually doing a bit of cache</span> <span data-start="960.27" data-end="961.95">invalidation for free at the same time</span> <span data-start="961.95" data-end="963.9">here if they've managed to get into this</span> <span data-start="963.9" data-end="965.4">block it means that they're either this</span> <span data-start="965.4" data-end="967.68">the style is outdated or they don't have</span> <span data-start="967.68" data-end="969.9">any so we first loop through all of the</span> <span data-start="969.9" data-end="971.67">local storage items to check if they</span> <span data-start="971.67" data-end="973.77">match against our pattern if they do we</span> <span data-start="973.77" data-end="975.81">clear it and then load in the new one</span> <span data-start="975.81" data-end="978.6">and store it again so we're using an md5</span> <span data-start="978.6" data-end="981.18">hash here of the file so every time we</span> <span data-start="981.18" data-end="982.5">practice continued continuous delivery</span> <span data-start="982.5" data-end="984">with deploying about four or five times</span> <span data-start="984" data-end="986.16">a day now and so instantly we can</span> <span data-start="986.16" data-end="988.5">invalidate that CSS the old global to</span> <span data-start="988.5" data-end="991.46">assessing get the new ones straight away</span> <span data-start="991.46" data-end="995.67">but what does this mean since actually</span> <span data-start="995.67" data-end="997.53">again to our users so here we're using</span> <span data-start="997.53" data-end="1000.26">web page test here this is a UK cable</span> <span data-start="1000.26" data-end="1004.94">connection and so before we've got we're</span> <span data-start="1004.94" data-end="1007.13">still blocking rendering waiting for all</span> <span data-start="1007.13" data-end="1010.37">of our CSS and I Josh get to download we</span> <span data-start="1010.37" data-end="1012.86">async the JavaScript and then we in line</span> <span data-start="1012.86" data-end="1015.16">the CSS and cash it in local storage</span> <span data-start="1015.16" data-end="1017.09">instantly look at the difference to the</span> <span data-start="1017.09" data-end="1019.13">waterfall here we've gotta start render</span> <span data-start="1019.13" data-end="1020.42">event right there even though we're a</span> <span data-start="1020.42" data-end="1022.28">sinking in the rest the bounders doesn't</span> <span data-start="1022.28" data-end="1023.69">need it because it's got its inline</span> </p>
<p><span data-start="1023.69" data-end="1026.2">Styles here we've managed to shave over</span> <span data-start="1026.2" data-end="1028.88">500 milliseconds off I start render</span> <span data-start="1028.88" data-end="1032.12">event just by inlining the CSS from</span> <span data-start="1032.12" data-end="1036.35">cashing in local storage breaking our</span> <span data-start="1036.35" data-end="1039.17">1000 millisecond so again if you go and</span> <span data-start="1039.17" data-end="1040.94">look at the site now you'll notice that</span> <span data-start="1040.94" data-end="1042.86">in the style sheet tab in any inspector</span> <span data-start="1042.86" data-end="1044.93">you won't see any physical files</span> <span data-start="1044.93" data-end="1046.97">downloaded but if you go and check the</span> <span data-start="1046.97" data-end="1049.55">local storage you've got your CSS right</span> <span data-start="1049.55" data-end="1051.41">there interestingly we also do the same</span> <span data-start="1051.41" data-end="1053.99">with our fonts to avoid any flash of</span> <span data-start="1053.99" data-end="1057.13">unstyled text with the front loading now</span> <span data-start="1057.13" data-end="1061.31">as well as having fast papers this also</span> <span data-start="1061.31" data-end="1064.01">creates a much more resilient system a</span> <span data-start="1064.01" data-end="1066.62">system in which I'm traveling on the</span> <span data-start="1066.62" data-end="1069.38">train a friend of mine shares</span> <span data-start="1069.38" data-end="1070.97">82 a cool article on twitter i click on</span> <span data-start="1070.97" data-end="1073.82">it but boom or go into a tunnel now</span> <span data-start="1073.82" data-end="1076.55">fortunately my my mobile had enough</span> <span data-start="1076.55" data-end="1078.02">networking to perform the network</span> <span data-start="1078.02" data-end="1080.21">requests that first HTML press but but</span> <span data-start="1080.21" data-end="1082.67">normally I'd go into the tunnel and then</span> <span data-start="1082.67" data-end="1084.05">it would find the CSS file and try and</span> <span data-start="1084.05" data-end="1085.31">make the downloading for that but you</span> <span data-start="1085.31" data-end="1087.23">can't because you're in the tunnel and</span> <span data-start="1087.23" data-end="1089.6">that's that big white blank screen that</span> <span data-start="1089.6" data-end="1091.72">we're all so familiar about with this</span> <span data-start="1091.72" data-end="1095.27">technique we've created a Sicilian to</span> <span data-start="1095.27" data-end="1097.07">failure that I only need to make that</span> <span data-start="1097.07" data-end="1098.33">one request and I have all of the</span> <span data-start="1098.33" data-end="1102.86">information Google did to do this google</span> <span data-start="1102.86" data-end="1104.81">and bing have also do this you know it's</span> <span data-start="1104.81" data-end="1106.67">why i repeat one of Google's search</span> <span data-start="1106.67" data-end="1108.05">results pages the fastest paid in the</span> <span data-start="1108.05" data-end="1109.88">world what they do is actually more</span> <span data-start="1109.88" data-end="1111.23">interestingly send down all of the</span> <span data-start="1111.23" data-end="1113.75">styles in the first request and then</span> <span data-start="1113.75" data-end="1114.95">they put it in local storage but they</span> <span data-start="1114.95" data-end="1117.5">set a cookie so that request it again</span> <span data-start="1117.5" data-end="1119.72">any other knows all the subsequent</span> <span data-start="1119.72" data-end="1121.76">requests after that have already got all</span> <span data-start="1121.76" data-end="1123.89">of the slides we can't actually do that</span> <span data-start="1123.89" data-end="1125.54">at garden because we keep a completely</span> <span data-start="1125.54" data-end="1126.98">stateless domain so we don't use any</span> <span data-start="1126.98" data-end="1131.02">cookie so that we can patch our HTML on</span> <span data-start="1131.02" data-end="1133.73">so with all the performance techniques</span> <span data-start="1133.73" data-end="1137.42">you have must monitor these and optimize</span> <span data-start="1137.42" data-end="1140.96">and repeat so to do this I built a grunt</span> <span data-start="1140.96" data-end="1143.6">task that in the CI now I'm monitoring</span> <span data-start="1143.6" data-end="1145.4">the size of those of those hedge files</span> <span data-start="1145.4" data-end="1148.04">and so whenever a developer updates the</span> <span data-start="1148.04" data-end="1149.9">size of those files I can get alerted to</span> <span data-start="1149.9" data-end="1151.1">see if it goes too big because obviously</span> <span data-start="1151.1" data-end="1153.05">we don't want to go in the negative</span> <span data-start="1153.05" data-end="1155">opposite way that the file gets too big</span> <span data-start="1155" data-end="1156.14">and then we're actually bloating our</span> <span data-start="1156.14" data-end="1158.18">pages and slowing them down so in the CI</span> <span data-start="1158.18" data-end="1161">we monitor these and I now know the raw</span> <span data-start="1161" data-end="1162.86">and the gzip file size and it gives me</span> <span data-start="1162.86" data-end="1165.26">and I can trend this over time and set</span> <span data-start="1165.26" data-end="1168.14">and a threshold alert knowing when our</span> <span data-start="1168.14" data-end="1172.28">assets get too big again on in pool</span> <span data-start="1172.28" data-end="1174.23">repair is this is a big code smell to me</span> <span data-start="1174.23" data-end="1175.43">when someone's adding something to the</span> <span data-start="1175.43" data-end="1177.83">head file you have to ask them is that</span> <span data-start="1177.83" data-end="1180.8">your critical CSS does that feature</span> <span data-start="1180.8" data-end="1187.48">really deemed to be in the head and so</span> <span data-start="1187.48" data-end="1189.44">monitoring assets like that is all well</span> <span data-start="1189.44" data-end="1191.24">and good but actually what a real users</span> <span data-start="1191.24" data-end="1193.49">seeing and especially across the world</span> <span data-start="1193.49" data-end="1195.89">so today is we use a tool put speed</span> <span data-start="1195.89" data-end="1199.49">curve and this this uses clusters or web</span> <span data-start="1199.49" data-end="1201.41">page test instances around the world and</span> <span data-start="1201.41" data-end="1202.75">we can</span> <span data-start="1202.75" data-end="1205.73">it tracks and trends analysis for us but</span> </p>
<p><span data-start="1205.73" data-end="1207.32">I'm like I can filter this by our start</span> <span data-start="1207.32" data-end="1209.63">render event or our speed index and I</span> <span data-start="1209.63" data-end="1212.03">instantly know how our page is</span> <span data-start="1212.03" data-end="1213.86">performing over the last two weeks but</span> <span data-start="1213.86" data-end="1215.69">more importantly again I can set</span> <span data-start="1215.69" data-end="1218.15">thresholds on this and compare my sense</span> <span data-start="1218.15" data-end="1220.4">against our own competitor which is our</span> <span data-start="1220.4" data-end="1222.71">old site or even our competitors and</span> <span data-start="1222.71" data-end="1228.38">business competitors in the world if you</span> <span data-start="1228.38" data-end="1229.85">have tools like this is really really</span> <span data-start="1229.85" data-end="1232.82">important that you then facility spread</span> <span data-start="1232.82" data-end="1234.68">this around the department so now every</span> <span data-start="1234.68" data-end="1237.11">week all of our everyone in the</span> <span data-start="1237.11" data-end="1238.67">department from our project managers to</span> <span data-start="1238.67" data-end="1241.22">our design is get this report telling us</span> <span data-start="1241.22" data-end="1243.23">how fast the website is and if we've</span> <span data-start="1243.23" data-end="1245.15">broken anything and this is really</span> <span data-start="1245.15" data-end="1247.28">really important making everyone in the</span> <span data-start="1247.28" data-end="1248.81">team accountable for performance is the</span> <span data-start="1248.81" data-end="1251.33">only way that you can ensure that you</span> <span data-start="1251.33" data-end="1253.13">maintain that and it's been really</span> <span data-start="1253.13" data-end="1254.78">interesting having product managers come</span> <span data-start="1254.78" data-end="1256.16">up to us and say hey what happened last</span> <span data-start="1256.16" data-end="1258.5">week why have we slowed down by 100</span> <span data-start="1258.5" data-end="1260.72">milliseconds and it's great to see them</span> <span data-start="1260.72" data-end="1262.73">actually caring about that getting</span> <span data-start="1262.73" data-end="1267.77">everyone involved now I've talked a lot</span> <span data-start="1267.77" data-end="1270.32">about our technique but what are some of</span> <span data-start="1270.32" data-end="1273.71">the alternatives out there Google</span> </p>
<p><span data-start="1273.71" data-end="1276.53">PageSpeed module for Apache or genetics</span> <span data-start="1276.53" data-end="1278.9">has a feature to be able to in line on</span> <span data-start="1278.9" data-end="1281.78">the fly so they actually render the page</span> <span data-start="1281.78" data-end="1284.15">work out what the inline styles are and</span> <span data-start="1284.15" data-end="1285.62">inject them into your page so this is at</span> <span data-start="1285.62" data-end="1288.71">a proxy level so you can sit sit this</span> <span data-start="1288.71" data-end="1291.2">engine X proxy in front of your systems</span> <span data-start="1291.2" data-end="1294.26">now there's reasons why i love PageSpeed</span> <span data-start="1294.26" data-end="1295.91">it does a lot of good optimizations but</span> <span data-start="1295.91" data-end="1297.83">the specific inlining CSS feature</span> <span data-start="1297.83" data-end="1299.18">there's some reasons why I don't like it</span> <span data-start="1299.18" data-end="1300.79">i like have to have a lot more fine</span> <span data-start="1300.79" data-end="1303.11">granular control level being in the head</span> <span data-start="1303.11" data-end="1307.31">or not uncie SS and grunt uncie SS task</span> <span data-start="1307.31" data-end="1310.43">by addy Osmani this you can pass it a</span> <span data-start="1310.43" data-end="1312.77">multiple files on your website and it</span> <span data-start="1312.77" data-end="1315.32">will actually work out what is the CSS</span> <span data-start="1315.32" data-end="1317.45">required for this nicolette nicole</span> <span data-start="1317.45" data-end="1319.25">earlier on mentioned that she did all</span> <span data-start="1319.25" data-end="1320.96">the great work to optimize the CSS file</span> <span data-start="1320.96" data-end="1322.58">but it was actually bootstrap in the end</span> <span data-start="1322.58" data-end="1325.28">that was weighing up fifty percent with</span> <span data-start="1325.28" data-end="1328.16">this as a as a post optimization her</span> <span data-start="1328.16" data-end="1330.59">worries where she doesn't want to delete</span> <span data-start="1330.59" data-end="1331.76">some of bootstrap because it would make</span> <span data-start="1331.76" data-end="1333.23">upgrading in the future if you have this</span> <span data-start="1333.23" data-end="1335.57">as a post optimization you can get it to</span> <span data-start="1335.57" data-end="1336.41">strip out your see</span> <span data-start="1336.41" data-end="1337.58">test far and you just have a new</span> <span data-start="1337.58" data-end="1340.01">minified one that only has the bits of</span> <span data-start="1340.01" data-end="1341.54">bootstrap in it that you are using</span> <span data-start="1341.54" data-end="1345.62">across your core templates basket Jas</span> <span data-start="1345.62" data-end="1347.48">again by our owes money this uses</span> <span data-start="1347.48" data-end="1349.55">exactly the same pattern of using local</span> <span data-start="1349.55" data-end="1352.34">storage as a cash management in a</span> <span data-start="1352.34" data-end="1356.81">validation layer but all of this seems</span> <span data-start="1356.81" data-end="1359.57">like a hack we shouldn't be having to do</span> <span data-start="1359.57" data-end="1361.58">this as their developers take these</span> <span data-start="1361.58" data-end="1364.94">extreme things breaking everything that</span> <span data-start="1364.94" data-end="1366.86">we've learnt to be able to to get that</span> <span data-start="1366.86" data-end="1368.36">last couple of milliseconds out of our</span> <span data-start="1368.36" data-end="1372.47">performance fortunately there's been a</span> <span data-start="1372.47" data-end="1373.49">lot of thinking around this area</span> <span data-start="1373.49" data-end="1376.94">recently so HTTP two which is the HP the</span> <span data-start="1376.94" data-end="1379.37">underlying transfer protocol layer of</span> <span data-start="1379.37" data-end="1381.56">the web we're actually carrying 1.1 that</span> <span data-start="1381.56" data-end="1384.89">respect in 1997 it's now 2014 and we</span> <span data-start="1384.89" data-end="1387.98">finally got a new point a major version</span> <span data-start="1387.98" data-end="1390.29">this is actually near to finishing of</span> <span data-start="1390.29" data-end="1391.58">the standard it will be finished by the</span> <span data-start="1391.58" data-end="1393.8">end of this year but how does this</span> <span data-start="1393.8" data-end="1395.72">relate back to what I've mentioned is</span> <span data-start="1395.72" data-end="1397.16">there's a great feature in it called</span> <span data-start="1397.16" data-end="1399.89">server push now hcp to the biggest</span> <span data-start="1399.89" data-end="1402.05">benefit to us and as we know latency is</span> <span data-start="1402.05" data-end="1403.52">the biggest killer how do we reduce</span> <span data-start="1403.52" data-end="1405.68">those round trips and the latency is</span> <span data-start="1405.68" data-end="1407.8">that you can have multiple</span> <span data-start="1407.8" data-end="1410.84">bi-directional messages on the same TTP</span> <span data-start="1410.84" data-end="1413.39">connection so for my HTML file my CSS</span> <span data-start="1413.39" data-end="1415.22">file on my javascript file I don't have</span> <span data-start="1415.22" data-end="1417.56">to open up three different TCP</span> <span data-start="1417.56" data-end="1420.14">connections I can send them all down and</span> <span data-start="1420.14" data-end="1423.98">currently down the same socket but we've</span> <span data-start="1423.98" data-end="1425.72">got this traditional flow right we ask</span> <span data-start="1425.72" data-end="1428.48">for the HTML file the server gives it</span> <span data-start="1428.48" data-end="1430.73">back your browser then parses the HTML</span> <span data-start="1430.73" data-end="1432.14">finds the CSS file and then goes and</span> <span data-start="1432.14" data-end="1434.27">request it again but as web developers</span> <span data-start="1434.27" data-end="1437.45">we know that the browser is about to</span> <span data-start="1437.45" data-end="1439.7">then request the CSS file or your core</span> <span data-start="1439.7" data-end="1441.41">javascript file so knowing those</span> <span data-start="1441.41" data-end="1444.14">decisions what if we could push them</span> <span data-start="1444.14" data-end="1447.53">down with the initial HTTP request so</span> <span data-start="1447.53" data-end="1448.82">this is a new feature put server push</span> <span data-start="1448.82" data-end="1452.57">that completely forgets the need of any</span> <span data-start="1452.57" data-end="1453.83">of our techniques here because I can say</span> <span data-start="1453.83" data-end="1455.99">hey browser when it when you ask for the</span> <span data-start="1455.99" data-end="1457.34">initial HTML file you can say hey and</span> <span data-start="1457.34" data-end="1459.32">here's all of my other core assets I</span> <span data-start="1459.32" data-end="1460.79">know you're going to need them and let</span> <span data-start="1460.79" data-end="1462.65">the browser do the cache invalidation or</span> <span data-start="1462.65" data-end="1465.62">work out of it Nathan or not service</span> <span data-start="1465.62" data-end="1468.53">workers now this to me hb2 and service</span> <span data-start="1468.53" data-end="1470.34">worker among one of</span> <span data-start="1470.34" data-end="1473.22">the most important features coming to</span> <span data-start="1473.22" data-end="1475.169">the standards that we're going to have</span> <span data-start="1475.169" data-end="1476.809">within these next five to ten years</span> <span data-start="1476.809" data-end="1478.95">service work it's being worked on by</span> <span data-start="1478.95" data-end="1480.929">alice russell and from the chrome team</span> <span data-start="1480.929" data-end="1482.19">and Jake Archibald and they actually</span> <span data-start="1482.19" data-end="1484.35">interestingly really the ping the whole</span> <span data-start="1484.35" data-end="1486.12">spec out in the open and github I</span> <span data-start="1486.12" data-end="1487.47">strongly advise you to go and check it</span> <span data-start="1487.47" data-end="1490.89">out but so service worker is a request</span> <span data-start="1490.89" data-end="1493.23">handling with a persistent cash so you</span> <span data-start="1493.23" data-end="1496.049">can create a worker level that handles</span> <span data-start="1496.049" data-end="1497.76">all of the requests was in your browser</span> <span data-start="1497.76" data-end="1500.22">and deem whether or not you want to go</span> <span data-start="1500.22" data-end="1501.929">back to the network or return something</span> <span data-start="1501.929" data-end="1503.7">from the cash so basically it's app</span> <span data-start="1503.7" data-end="1506.37">cache on steroids or the better app</span> <span data-start="1506.37" data-end="1509.399">cache and so here's the traditional</span> <span data-start="1509.399" data-end="1511.86">model again I request my CSS file and</span> <span data-start="1511.86" data-end="1513.63">then we go off to the server to go and</span> <span data-start="1513.63" data-end="1516.99">get it but what did the serviceworker</span> <span data-start="1516.99" data-end="1519.87">already had one in its cache or you know</span> <span data-start="1519.87" data-end="1522.24">we were using local storage abusing</span> <span data-start="1522.24" data-end="1524.039">local storage for this pattern hit now</span> <span data-start="1524.039" data-end="1526.77">we actually have a new cache object in</span> </p>
<p><span data-start="1526.77" data-end="1529.2">CSS and service workers that have the</span> <span data-start="1529.2" data-end="1531.299">native new promises spec built in it</span> <span data-start="1531.299" data-end="1533.22">said right if I've got that in my cache</span> <span data-start="1533.22" data-end="1537.6">object return it and so now we don't</span> <span data-start="1537.6" data-end="1539.88">have to ever even talked to the server</span> <span data-start="1539.88" data-end="1542.34">again having all of the information the</span> <span data-start="1542.34" data-end="1544.23">CSS to be able to paint within our</span> <span data-start="1544.23" data-end="1549.75">thousand milliseconds so just to</span> <span data-start="1549.75" data-end="1552.179">summarize that you can really really</span> <span data-start="1552.179" data-end="1556.2">fast and here are some of the things</span> <span data-start="1556.2" data-end="1557.429">that I've learned along the way and that</span> </p>
<p><span data-start="1557.429" data-end="1561.99">I hope you do take away from this please</span> <span data-start="1561.99" data-end="1564.179">have a think about in lining your</span> <span data-start="1564.179" data-end="1566.94">critical CSS and deferring all</span> <span data-start="1566.94" data-end="1570.24">non-critical assets the your critical</span> <span data-start="1570.24" data-end="1572.61">rendering path is the most important</span> <span data-start="1572.61" data-end="1574.98">thing to getting your content in front</span> <span data-start="1574.98" data-end="1577.409">of your users and anything you put in</span> <span data-start="1577.409" data-end="1579.48">front of it it's going to block them and</span> <span data-start="1579.48" data-end="1581.97">as we know that 600 round millisecond</span> <span data-start="1581.97" data-end="1584.19">round trip for every request it's just</span> <span data-start="1584.19" data-end="1586.22">bolting on to your millisecond budget</span> <span data-start="1586.22" data-end="1588.39">where possible always in cash</span> <span data-start="1588.39" data-end="1590.309">aggressively and maybe in local storage</span> <span data-start="1590.309" data-end="1591.99">or hopefully in the future and service</span> <span data-start="1591.99" data-end="1596.64">worker and set a performance budget on</span> <span data-start="1596.64" data-end="1599.73">your sites but once you've got that you</span> <span data-start="1599.73" data-end="1602.73">need to always measure optimize and</span> <span data-start="1602.73" data-end="1603.81">repeat</span> <span data-start="1603.81" data-end="1606.36">you know our websites gets low on a</span> <span data-start="1606.36" data-end="1608.58">day-by-day basis as we add features to</span> <span data-start="1608.58" data-end="1611.16">them you need to constantly be measuring</span> <span data-start="1611.16" data-end="1613.05">that or thinking about when I add a new</span> <span data-start="1613.05" data-end="1614.91">feature do we actually need this feature</span> <span data-start="1614.91" data-end="1616.5">or how can I better optimize this</span> <span data-start="1616.5" data-end="1617.85">feature make it fast before we include</span> <span data-start="1617.85" data-end="1621.24">it or is this feature going to detriment</span> </p>
<p><span data-start="1621.24" data-end="1623.1">I'll are loading or the performance of</span> <span data-start="1623.1" data-end="1627.21">other features but most importantly</span> <span data-start="1627.21" data-end="1629.67">feature performance is a requirement</span> <span data-start="1629.67" data-end="1635.16">it's not a feature you can't retrofit it</span> <span data-start="1635.16" data-end="1636.81">you can't part oh don't worry the ops</span> <span data-start="1636.81" data-end="1639.48">team are going to handle it we all as</span> <span data-start="1639.48" data-end="1640.92">web developers must be worrying about</span> <span data-start="1640.92" data-end="1643.56">this and as I said before if the more</span> <span data-start="1643.56" data-end="1645.63">you make this information available to</span> <span data-start="1645.63" data-end="1647.31">the rest of your business the more the</span> <span data-start="1647.31" data-end="1650.06">rest of your business will start caring</span> </p>
</section>