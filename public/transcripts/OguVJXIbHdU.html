<section>
<p><span data-start="0.599" data-end="3.189">Hi, everyone.</span> <span data-start="3.189" data-end="7.529">I am really excited to be up here talk to you about browser extensions.</span> <span data-start="7.529" data-end="12.91">We are going to talk about what they can do, challenges my team faced when we built ours,</span> <span data-start="12.91" data-end="19.53">and most importantly what all this has to do with sandwiches.</span> <span data-start="19.53" data-end="24.619">My name is Shannon Capper and I am a front-end developer here in Seattle as a starting company</span> <span data-start="24.619" data-end="25.619">called Textio.</span> <span data-start="25.619" data-end="32.349">I should tell you a little bit about what I do.</span> <span data-start="32.349" data-end="33.349">This is Textio.</span> <span data-start="33.349" data-end="37.03">We are an augmented writing platform that lets you know how your language is going to</span> <span data-start="37.03" data-end="39.069">perform as you write it.</span> <span data-start="39.069" data-end="44.87">We document a score, we use highlights to draw your attention to key phrases and suggest</span> <span data-start="44.87" data-end="46.92">replacements for troublesome language.</span> <span data-start="46.92" data-end="53.559">We are writing a recruiting aid here and as you can imagine this isn't the ideal user</span> <span data-start="53.559" data-end="55.289">experience to write e-mail.</span> </p>
<p><span data-start="55.289" data-end="61.999">It is disruptive to come over to our website to write the e-mail and copy and paste it</span> <span data-start="61.999" data-end="63.409">to send it.</span> <span data-start="63.409" data-end="69.63">Ideally we would want to bring the platform to you.</span> <span data-start="69.63" data-end="75.6">We wanted to build something that looks like this.</span> <span data-start="75.6" data-end="80.81">This is someone else's page and someone else's e-mail editor but with all the text in U OOSHGS</span> <span data-start="80.81" data-end="89.409">that our users know and love  â€”  UI.</span> <span data-start="89.409" data-end="91.53">What actually is a browser extension?</span> <span data-start="91.53" data-end="97.18">Out of curiosity, how many of you use browser extensions on a regular basis?</span> <span data-start="97.18" data-end="99.57">Basically everyone.</span> <span data-start="99.57" data-end="102.14">Now how many of you know how to actually build one?</span> <span data-start="102.14" data-end="106.189">That is actually a pretty good number.</span> </p>
<p><span data-start="106.189" data-end="110.409">You may be smarter than me but I use browser extensions all the time and had no idea how</span> <span data-start="110.409" data-end="112.999">they worked until I started building one.</span> <span data-start="112.999" data-end="115.479">It turns out they are pretty straightforward.</span> <span data-start="115.479" data-end="118.999">A browser extension or a plugin is just a small piece of software that runs inside the</span> <span data-start="118.999" data-end="119.999">browser.</span> <span data-start="119.999" data-end="128.16">My extensions are built with JavaScript, HTML and CSS.</span> <span data-start="128.16" data-end="135.84">There is a standardized web extension backed by the W3C.</span> <span data-start="135.84" data-end="154.2">Safari and Internet Explorer use different extensions so it</span> <span data-start="154.2" data-end="155.58">is difficult with them.</span> <span data-start="155.58" data-end="159.83">The question you should be asking here is what can't a browser extension do because</span> <span data-start="159.83" data-end="162.05">these things are crazy powerful.</span> </p>
<p><span data-start="162.05" data-end="166.04">Frankly, it is kind of terrifying knowing all things we are capable of.</span> <span data-start="166.04" data-end="169.75">For example, you can get lots of controls over your tabs.</span> <span data-start="169.75" data-end="176.01">It can open new ones, read the ones open currently, and close them.</span> <span data-start="176.01" data-end="178.04">Pop-up blocks for a good example of this.</span> <span data-start="178.04" data-end="182.91">They monitor open tabs and monitor those that detect problems.</span> <span data-start="182.91" data-end="188.45">And we can make network requests.</span> <span data-start="188.45" data-end="192.68">Mail checker will ping the server regularly to see if you have new mail and if it detects</span> <span data-start="192.68" data-end="195.78">new ones it shows you how many.</span> <span data-start="195.78" data-end="201.63">We can read, modify and add to the DOM of any web page and this could be used in a creative</span> <span data-start="201.63" data-end="202.65">way.</span> <span data-start="202.65" data-end="209.11">This is a video of Google's translate which reads the selected text from the DOM and adds</span> <span data-start="209.11" data-end="213.53">a tool set to the page to show you the translation.</span> <span data-start="213.53" data-end="222.53">Another example is my personal favorite called millennials to snake people and it is awesome.</span> <span data-start="222.53" data-end="226.88">What it does is finds any instance of the word millennials on the page and replaces</span> <span data-start="226.88" data-end="233.96">it with the word snake people to write results like this.</span> </p>
<p><span data-start="233.96" data-end="239.23">Here the plugin is actively modifying text nodes put into the DOM by the house page and</span> <span data-start="239.23" data-end="242.67">that could be dangerous but we will get to that later.</span> <span data-start="242.67" data-end="248.52">To go back to the earlier question, if browser extensions can do all those amazing and powerful</span> <span data-start="248.52" data-end="251.36">things then what can't they do?</span> <span data-start="251.36" data-end="252.67">The list is pretty small.</span> <span data-start="252.67" data-end="258">First, they are tied to the browser so if the browser isn't open, the extension can't</span> <span data-start="258" data-end="259">run.</span> </p>
<p><span data-start="259" data-end="260.799">Pretty obvious but worth calling out.</span> <span data-start="260.799" data-end="264.69">Next, you can't go changing your permissions willy-nilly.</span> <span data-start="264.69" data-end="268.32">You have to declare which pages you want to run on and which parts of the web extension</span> <span data-start="268.32" data-end="275.15">API you want  to access.</span> <span data-start="275.15" data-end="280.15">If you want to go change those permissions later on, the extension is temporarily disabled</span> <span data-start="280.15" data-end="287.28">until the user agrees to the user's new one.</span> <span data-start="287.28" data-end="306.55">Probably the most important thing it can't do is directly interact with the</span> <span data-start="306.55" data-end="308.54">host page's JavaScript.</span> <span data-start="308.54" data-end="311.24">They don't even share the same Window object.</span> <span data-start="311.24" data-end="316.1">While this is sometimes a problem, for the most part, it is a good thing.</span> </p>
<p><span data-start="316.1" data-end="326.43">At CascadiaJS two years ago, it was called out the dealing with the polluted objects.</span> <span data-start="326.43" data-end="336.77">The host page might do bad monkey patching and the good news is we don't have to deal</span> <span data-start="336.77" data-end="339.37">with any of that because we are in an isolated environment.</span> <span data-start="339.37" data-end="344.35">Under the hood, a browser extension is made up of four parts.</span> <span data-start="344.35" data-end="351.49">A manifest file containing metadata and specifies permission, there is a pop-up which can be</span> <span data-start="351.49" data-end="359.18">invoked by clicking on the extensions icon in the browser's toolbar, there is a background</span> <span data-start="359.18" data-end="364.93">script running behind the scenes whenever the browser is open and isn't tied to any</span> <span data-start="364.93" data-end="373.99">one tab and has access to the full web extension API, then there is the context scripts and</span> <span data-start="373.99" data-end="376.95">they can talk back and forth with the background script.</span> <span data-start="376.95" data-end="382.82">If you are used to seeing server-client architecture diagrams you will notice this is looking similar.</span> <span data-start="382.82" data-end="386.83">These are the ones that can interact with the DOM and what we will focus on for the</span> <span data-start="386.83" data-end="389.31">rest of the talk.</span> <span data-start="389.31" data-end="390.78">Let's get back to our story.</span> <span data-start="390.78" data-end="396.74">My team decided we wanted to build a com extension.</span> <span data-start="396.74" data-end="401.02">We decided to start with Chrome since that is what most users use and we knew we could</span> <span data-start="401.02" data-end="402.389">extend to other browsers.</span> </p>
<p><span data-start="402.389" data-end="409.46">We wanted to bring Textio to e-mail and supported clients.</span> <span data-start="409.46" data-end="412.66">Namely LinkedIn recruiters and Gmail.</span> <span data-start="412.66" data-end="424.24">Now that we know the powerful things an extension can do, it should be straightforward to make</span> <span data-start="424.24" data-end="428.65">this picture a reality, right?</span> <span data-start="428.65" data-end="431.74">No, it wasn't straightforward at all.</span> <span data-start="431.74" data-end="437.37">Turns out writing JavaScript that runs on someone else's page is way harder than writing</span> <span data-start="437.37" data-end="439.78">JavaScript that runs on your page.</span> <span data-start="439.78" data-end="443.27">As a browser extension, you have no control over the page.</span> <span data-start="443.27" data-end="450.37">You can't control how its laid out, you can't control the code or the user action and every</span> <span data-start="450.37" data-end="452.84">single page is different.</span> <span data-start="452.84" data-end="457.26">Not only that, but it is also super easy to abuse your power and change things in a way</span> <span data-start="457.26" data-end="465.93">that brick  â€”  breaking news  â€”  breaks the host site.</span> </p>
<p><span data-start="465.93" data-end="472.8">We laid down a set of principles and principle one is don't write site specific conditionals</span> <span data-start="472.8" data-end="476.669">and number two is don't break the host page.</span> <span data-start="476.669" data-end="478.5">Let's start with the first one.</span> <span data-start="478.5" data-end="484.96">One problem writing an ex tension that works across multiple hosts is each one is different.</span> <span data-start="484.96" data-end="489.3">What if you need to tweak the layout based on the site?</span> <span data-start="489.3" data-end="493.77">What if you need the selectors to be different on different pages?</span> <span data-start="493.77" data-end="498.979">In the early days of the extension, especially if you start out with a small subset of sites,</span> <span data-start="498.979" data-end="505.04">it can be tempting to let site-specific conditionals creep in the database.</span> </p>
<p><span data-start="505.04" data-end="508.77">If I am on Gmail do A and if I am on LinkedIn do B.</span> <span data-start="508.77" data-end="512.969">This is the path to madness.</span> <span data-start="512.969" data-end="519.779">It will be an absolute nightmare to contain.</span> <span data-start="519.779" data-end="524.38">Every time you want to support a new site, you have to track down every place scattered</span> <span data-start="524.38" data-end="531.88">in the codebase where you have site-specific logic and that will be no fun.</span> <span data-start="531.88" data-end="536.259">You might try building solutions in a generic way so they work on every page.</span> <span data-start="536.259" data-end="538.379">The key thing here is code reviews.</span> <span data-start="538.379" data-end="543.259">The more code that is reusable against all sites, the better.</span> <span data-start="543.259" data-end="548.99">Where that isn't possible you can try limiting site specific code to a single configuration</span> <span data-start="548.99" data-end="549.99">site.</span> <span data-start="549.99" data-end="557.029">One config per site and all the rest of the code can generically consume the site config</span> <span data-start="557.029" data-end="560.48">without worry about the host site.</span> <span data-start="560.48" data-end="564.699">If you want to add support for a new site all you have to do is build a single new site</span> <span data-start="564.699" data-end="568.3">config and you will be good to go.</span> <span data-start="568.3" data-end="570.809">Let's see this in action, shall we?</span> <span data-start="570.809" data-end="578.149">I am going to exit out of here and let's mirror our screen.</span> </p>
<p><span data-start="578.149" data-end="580.11">OK.</span> <span data-start="580.11" data-end="581.48">Here we are in Gmail.</span> <span data-start="581.48" data-end="588.839">I don't know about you guys but there is something I really miss about writing on my computer.</span> <span data-start="588.839" data-end="590.94">Something that feels missing.</span> <span data-start="590.94" data-end="594.44">You know what I miss?</span> <span data-start="594.44" data-end="596.54">I miss clippy.</span> <span data-start="596.54" data-end="601.79">I want to build an extension that brings Clippy back.</span> <span data-start="601.79" data-end="613.04">We have a content script running in Gmail and let's see if we can get him into Yahoo.</span> <span data-start="613.04" data-end="615.679">Let's look at some code.</span> <span data-start="615.679" data-end="619.679">Here we are on in our code editor.</span> <span data-start="619.679" data-end="621.579">This is the content script running on Gmail.</span> <span data-start="621.579" data-end="625.029">It is really simple and just has three parts.</span> <span data-start="625.029" data-end="630.55">First we will get the site config, next pull from mail Windows and if we find a new mail</span> <span data-start="630.55" data-end="633.119">Window, we will append to clippy.</span> </p>
<p><span data-start="633.119" data-end="635.889">Let's break each one down.</span> <span data-start="635.889" data-end="638.99">We only support Gmail right now.</span> <span data-start="638.99" data-end="645.74">This has a single item in it which is our mail limit selector.</span> <span data-start="645.74" data-end="650.189">This selector is going to be different on every site and this gives us the chance to</span> <span data-start="650.189" data-end="652.97">do the right selector.</span> <span data-start="652.97" data-end="656.39">Here on guest site config it is simple.</span> <span data-start="656.39" data-end="662.8">We will get the domain name off the URL, if it is a supported domain we will return the</span> <span data-start="662.8" data-end="666.86">equivalent config.</span> <span data-start="666.86" data-end="669.179">We have a set interval here that is simple.</span> <span data-start="669.179" data-end="674.519">We will consume that site config and pull the selector off to hold the DOM to see if</span> <span data-start="674.519" data-end="676.54">we have new mail Windows.</span> <span data-start="676.54" data-end="681.009">New one is marked as found and append clippy.</span> </p>
<p><span data-start="681.009" data-end="690.629">Here in append clip', y we will create image-only, show the dif, give styling and size and append</span> <span data-start="690.629" data-end="693.05">him to the mail Window.</span> <span data-start="693.05" data-end="698.339">I think we will get him working in Yahoo without too many changes and let's see if we can get</span> <span data-start="698.339" data-end="699.35">that happening.</span> <span data-start="699.35" data-end="706.829">Here, let's add Yahoo has a supported domain.</span> <span data-start="706.829" data-end="712.35">We are going to return a Yahoo config.</span> </p>
<p><span data-start="712.35" data-end="714.11">Let's define that.</span> <span data-start="714.11" data-end="721.379">Here we are going to mirror our config from Gmail.</span> <span data-start="721.379" data-end="728.399">Then I cheated and looked up what the selector is so it is going to be editor-container.</span> <span data-start="728.399" data-end="729.679">That was it.</span> <span data-start="729.679" data-end="731.49">Let's see if this worked.</span> <span data-start="731.49" data-end="737.18">I am going to refresh our extension, refresh the page and I don't have any internet.</span> <span data-start="737.18" data-end="738.98">That is unfortunate.</span> <span data-start="738.98" data-end="743.209">Let's connect and try again.</span> <span data-start="743.209" data-end="744.56">There we go!</span> <span data-start="744.56" data-end="747.129">We have got Clippy!</span> <span data-start="747.129" data-end="751.17">[Applause] >> We kind of have a problem.</span> <span data-start="751.17" data-end="754.68">He is a little small?</span> </p>
<p><span data-start="754.68" data-end="759.989">Like in Gmail the mail Window is smaller so he seems like a good size but here he kind</span> <span data-start="759.989" data-end="761.94">of gets drowned out.</span> <span data-start="761.94" data-end="765.279">Let's see if we can use our site config to fix that.</span> <span data-start="765.279" data-end="767.449">Let's add site-specific styling.</span> <span data-start="767.449" data-end="774.36">Down here in append clippy instead of using the hardcoded value let's assume our site</span> <span data-start="774.36" data-end="779.589">config and design a clippysizevalue there.</span> </p>
<p><span data-start="779.589" data-end="789.689">Up here in Gmail let's do clippy size is 85 pixels and over in Yahoo let's make him 120.</span> <span data-start="789.689" data-end="795.819">Now if everything worked according to plan it should be a little bit bigger.</span> <span data-start="795.819" data-end="797.329">Beautiful.</span> <span data-start="797.329" data-end="799.66">I think we can do one better.</span> <span data-start="799.66" data-end="804.35">Remember principle number one if we can avoid site-specific code, we should, because that</span> <span data-start="804.35" data-end="809.029">way we can keep site configs as small as possible and make it super easy to add new sites in</span> <span data-start="809.029" data-end="810.029">the feature.</span> <span data-start="810.029" data-end="815.91">I think all we want is for clippy to be a certain percentage of the mail Window size.</span> </p>
<p><span data-start="815.91" data-end="816.91">Let's do that.</span> <span data-start="816.91" data-end="823.389">Go back to the Code Editor and remove the value off site config and down here in append</span> <span data-start="823.389" data-end="831.129">clippy let's use the mail height dynamic to determine how big clippy should be.</span> <span data-start="831.129" data-end="842.779">I will put the height property off there and that is going to be a string so let's parse</span> <span data-start="842.779" data-end="846.509">it into a float.</span> <span data-start="846.509" data-end="852.42">Then let's make clippy three tenths the height of the mail Window.</span> <span data-start="852.42" data-end="859.189">If everything went according to plan, he should be the same size exactly as he was before</span> <span data-start="859.189" data-end="865.139">but now we are doing it in a dynamic way that will work on any host site.</span> <span data-start="865.139" data-end="867.839">Awesome.</span> <span data-start="867.839" data-end="874.369">[Applause] >> Let's go back to the slides.</span> </p>
<p><span data-start="874.369" data-end="877.369">Now we have talked about how to fulfill principle number one.</span> <span data-start="877.369" data-end="879.559">Let's talk about principle number two.</span> <span data-start="879.559" data-end="881.35">Don't break the host page.</span> <span data-start="881.35" data-end="885.23">This one seems obvious but it is a little tricky to follow if you are doing anything</span> <span data-start="885.23" data-end="886.879">adding UI to the page.</span> <span data-start="886.879" data-end="892.939">Perhaps avoiding the host pages markup might be a better way to identify it.</span> <span data-start="892.939" data-end="898.8">Remember we talked about the extension living in an isolate world, remember the one thing</span> <span data-start="898.8" data-end="903.579">we share is the DOM.</span> </p>
<p><span data-start="903.579" data-end="909.679">If we go making changes to the DOM, especially mutating or deleting stuff that is there,</span> <span data-start="909.679" data-end="914.079">the host page won't be expecting it because they don't even know we exist.</span> <span data-start="914.079" data-end="915.389">Let's use a simple example.</span> <span data-start="915.389" data-end="918.32">Here is a paragraph rendered by a page.</span> <span data-start="918.32" data-end="919.89">A paragraph with a little text.</span> <span data-start="919.89" data-end="924.779">Let's say we as the extension want the highlight the word hello.</span> <span data-start="924.779" data-end="931.369">The main think you could try is delete the text notes in the paragraph and insert a highlight</span> <span data-start="931.369" data-end="937.92">span containing the word hello and a new text Node containing the word world but we have</span> <span data-start="937.92" data-end="938.92">a problem.</span> </p>
<p><span data-start="938.92" data-end="943.859">It turns out this page was rendered using React and frameworks like React really don't</span> <span data-start="943.859" data-end="947.04">like it when you go working with the DOM behind their back.</span> <span data-start="947.04" data-end="951.689">It is keeping a virtual representation of the DOM in memory and still thinks that text</span> <span data-start="951.689" data-end="953.949">Node is there.</span> <span data-start="953.949" data-end="958.72">Let's say it goes through another vendor pass and wants to change the paragraph to say hello,</span> <span data-start="958.72" data-end="959.839">Seattle.</span> <span data-start="959.839" data-end="966.41">Best case scenario is that React blows away the whole paragraph element and replaces it</span> <span data-start="966.41" data-end="967.41">with a new one.</span> <span data-start="967.41" data-end="973.609">That is kind of a bummer for us because now our highlight is gone but worst case scenario</span> <span data-start="973.609" data-end="979.689">is React just tries to replace that one text Node, which is no longer there, and it blows</span> <span data-start="979.689" data-end="981.98">up with a non-failure.</span> </p>
<p><span data-start="981.98" data-end="987.47">Now we have broken the page and thrown principle number two out the Window.</span> <span data-start="987.47" data-end="989.509">This seems bad.</span> <span data-start="989.509" data-end="994.519">Highlighting text is kind of a core experience of our product at Textio.</span> <span data-start="994.519" data-end="999.5">If your Chrome extension can't add inline spans around the host markup then what are</span> <span data-start="999.5" data-end="1003.239">we supposed to do?</span> <span data-start="1003.239" data-end="1010.41">We did like many engineers before us and we drew notes and eventually we came up with</span> <span data-start="1010.41" data-end="1016.329">a different highlight solutions entirely and that is how the sandwich was born.</span> <span data-start="1016.329" data-end="1022.359">Despite it having the stupidest code name every it is the highlight of the Chrome extension.</span> <span data-start="1022.359" data-end="1029.689">It is called the sandwich because it is made up of layers that are positioned one on top</span> <span data-start="1029.689" data-end="1035.929">of each other and gave us fine grain control of how we edit the page and don't touch the</span> <span data-start="1035.929" data-end="1037.24">native editor.</span> </p>
<p><span data-start="1037.24" data-end="1043.049">Let's say the text from the native editor look like this but because this is a rich</span> <span data-start="1043.049" data-end="1051.21">text editor users could change the text color or add background color or maybe change font</span> <span data-start="1051.21" data-end="1052.88">sizes.</span> <span data-start="1052.88" data-end="1056.789">Let's say we as the extension want to add highlights to the page.</span> <span data-start="1056.789" data-end="1063.85">A green highlight around our team and orange highlight around connect with you.</span> <span data-start="1063.85" data-end="1068.64">For added fun, when you hover over a highlight, we want to turn the text white.</span> <span data-start="1068.64" data-end="1073.33">In the sandwich, the top layer our native editor.</span> <span data-start="1073.33" data-end="1078.62">We want it on top so it picks up all the mouse and keyboard events like normal and we will</span> <span data-start="1078.62" data-end="1079.83">not touch the markup.</span> <span data-start="1079.83" data-end="1088.559">We will only make it transparent except for the cursor.</span> <span data-start="1088.559" data-end="1091.309">Directly behind the vendor is our text copy.</span> <span data-start="1091.309" data-end="1096.22">This is the exact duplicate of the native editor with all the background colors hitter.</span> <span data-start="1096.22" data-end="1101.44">When you type in editor with the sandwich mode on it this is the text you will see.</span> <span data-start="1101.44" data-end="1106.679">Because we only the copy it is save to modify and turn hovered text white.</span> <span data-start="1106.679" data-end="1117.22">Below that we have colored divs positioned to sit behind the text they highlight.</span> </p>
<p><span data-start="1117.22" data-end="1123.19">The phrases we want to highlight can be calculated where we want to position these in the DOM.</span> <span data-start="1123.19" data-end="1126.139">Last but not least we have the background color copy.</span> <span data-start="1126.139" data-end="1131.89">This is the same as the text copy with the text colors hidden and background colors visible.</span> <span data-start="1131.89" data-end="1136.96">This allows us to draw highlights so they don't get obscured.</span> <span data-start="1136.96" data-end="1145.549">Put it together and you get beautifully highlighted text in someone else's rich text editor.</span> <span data-start="1145.549" data-end="1151.159">We don't have the touch the native markup and are much less likely to break the page.</span> <span data-start="1151.159" data-end="1157.33">Like with most things, our sandwich highlighter came at a price.</span> <span data-start="1157.33" data-end="1160.7">It solved a lot of problems but made new ones.</span> <span data-start="1160.7" data-end="1169.34">When I say we made duplicates it turned out harder to be than I thought.</span> </p>
<p><span data-start="1169.34" data-end="1175.68">Making the contents is easy but making the copy look the same is not.</span> <span data-start="1175.68" data-end="1185.79">We used a combination of still overrides to get them to look right but oh, man, we would</span> <span data-start="1185.79" data-end="1194.019">get one pixel differences throwing off the layout and causing heuristics all in one spot.</span> <span data-start="1194.019" data-end="1202.64">Next, we had a problem picking up mouse events properly.</span> <span data-start="1202.64" data-end="1209.389">They don't propagate down to the other layers.</span> <span data-start="1209.389" data-end="1216.32">We want you to hover over a phrase and change the styling.</span> <span data-start="1216.32" data-end="1224.75">We implemented our own mouse dropping and put a listening on the top most element and</span> <span data-start="1224.75" data-end="1228.51">from there we can calculate if the mouse is within the bounds of highlights.</span> <span data-start="1228.51" data-end="1234.19">If the mouse moves into a highlight, we can take it down to the lower layers as if it</span> <span data-start="1234.19" data-end="1235.87">happened natively.</span> <span data-start="1235.87" data-end="1240.26">This felt like a total hack but we could not find a better way of getting the mouse events</span> <span data-start="1240.26" data-end="1242.22">to hit both layers at once.</span> <span data-start="1242.22" data-end="1248.44">We hit snags also getting the layers to be positioned on top of another.</span> </p>
<p><span data-start="1248.44" data-end="1257">In order for this to work, we need a parrot Node positioned as well and remember principle</span> <span data-start="1257" data-end="1262.33">two we don't want to break the host page and if we slap a position relative on a parent</span> <span data-start="1262.33" data-end="1263.96">Node we risk doing that.</span> <span data-start="1263.96" data-end="1272.01">To solve the technology, we pulled in an intelligent called the shadow dom.</span> <span data-start="1272.01" data-end="1279">I will be brief about why this helped us.</span> <span data-start="1279" data-end="1282.64">Let's say this is a piece of the DOM we got from our host page and this is called the</span> <span data-start="1282.64" data-end="1287.41">light DOM as opposed to shadow DOM.</span> <span data-start="1287.41" data-end="1293.769">We made a parent Node with a child note.</span> <span data-start="1293.769" data-end="1302.88">The shadow DOM lets us attach a subtree that is hidden from the main application.</span> <span data-start="1302.88" data-end="1308.08">Within that subtree we can render a div with position relative and from there we can drop</span> <span data-start="1308.08" data-end="1310.07">in our original child Node.</span> <span data-start="1310.07" data-end="1317.36">This is using the slot API which lets you insert like-DOM shadow hosts into the shadow</span> <span data-start="1317.36" data-end="1318.86">tree.</span> <span data-start="1318.86" data-end="1324.259">Now we can add the sandwich layers as siblings.</span> <span data-start="1324.259" data-end="1325.32">This is great.</span> <span data-start="1325.32" data-end="1331.809">To the application, the DOM tree thinks the native editor is a direct child of the shadow</span> <span data-start="1331.809" data-end="1336.85">host but what is rendered to the passenger is  â€”  page is that and we can render till</span> <span data-start="1336.85" data-end="1339.059">our hearts desire.</span> </p>
<p><span data-start="1339.059" data-end="1345.019">How did it work out?</span> <span data-start="1345.019" data-end="1347.07">Was our Chrome extension a success?</span> <span data-start="1347.07" data-end="1354.35">I probably wouldn't be here talking to you if it wasn't so let me show you.</span> <span data-start="1354.35" data-end="1359.57">I am going to mirror my screen again and let's come over here.</span> </p>
<p><span data-start="1359.57" data-end="1361.53">So, here we are in Gmail again.</span> <span data-start="1361.53" data-end="1364.059">Now we are writing a recruiting mail.</span> <span data-start="1364.059" data-end="1368.039">Let's turn on Textio for Chrome.</span> <span data-start="1368.039" data-end="1370.57">Boom!</span> <span data-start="1370.57" data-end="1373.139">Beautifully highlighted text in someone's editor.</span> <span data-start="1373.139" data-end="1381.139">We have highlights in the subject line and body and we have a score.</span> <span data-start="1381.139" data-end="1385.7">An orange phrase means this is causing less people to respond to my recruiting mail.</span> <span data-start="1385.7" data-end="1393.1">Let's replace that and now it is green meaning it will attract people and the score updated.</span> <span data-start="1393.1" data-end="1395.649">We can type in real-time and update.</span> <span data-start="1395.649" data-end="1400.08">If I say wow, this is great.</span> <span data-start="1400.08" data-end="1405.26">Not only do highlights show up in the text I just typed but the ones there move over.</span> <span data-start="1405.26" data-end="1411.539">Then, because this is a rich text editor, let's do terrible things like making the font</span> <span data-start="1411.539" data-end="1415.539">big and adding some text color.</span> <span data-start="1415.539" data-end="1418.38">All of it just kind of works.</span> </p>
<p><span data-start="1418.38" data-end="1425.919">Because we wrote this not as a Gmail editor but a highlight editor it also works in LinkedIn.</span> <span data-start="1425.919" data-end="1432.15">Here we are recruiting our fantastic host and you will notice it is the same experience</span> <span data-start="1432.15" data-end="1433.46">here as it was in Gmail.</span> <span data-start="1433.46" data-end="1440.059">We are happy because we are not texting the native editor's markup' and less likely to</span> <span data-start="1440.059" data-end="1447.059">break a page and this is extensible and we can drop it into any editor and it will work.</span> <span data-start="1447.059" data-end="1455.42">We are using the site configs and it is easy to expand out as Textio grows into other domains.</span> <span data-start="1455.42" data-end="1457.95">Let's wrap this up.</span> <span data-start="1457.95" data-end="1459.22">OK.</span> <span data-start="1459.22" data-end="1467.99">If there is anything I want you guys to get out of this talk it is these three things.</span> <span data-start="1467.99" data-end="1472.83">Besides sick memes, obviously.</span> <span data-start="1472.83" data-end="1477.08">A browser extension is an incredibly powerful tool and really the only limit to what you</span> <span data-start="1477.08" data-end="1479.029">can accomplish with them is your imagination.</span> <span data-start="1479.029" data-end="1484.01">Two, writing code that runs on someone else's site is an adjustment.</span> <span data-start="1484.01" data-end="1491.519">It is a mental shift in show you approach problems and there is going to be a mess of</span> <span data-start="1491.519" data-end="1492.629">challenges.</span> </p>
<p><span data-start="1492.629" data-end="1497.45">Keep the principles in mind and avoid site specific code and don't break someone else's</span> <span data-start="1497.45" data-end="1499.24">page.</span> <span data-start="1499.24" data-end="1502.48">Trust me you will thank yourself later.</span> <span data-start="1502.48" data-end="1503.509">That is it for me.</span> <span data-start="1503.509" data-end="1508.74">I hope you are all inspired to build extensions after today.</span> <span data-start="1508.74" data-end="1512.289">There is good information and the slides from today.</span> </p>
<p><span data-start="1512.289" data-end="1514.463">If you have questions, find me here, or online.</span> <span data-start="1514.463" data-end="1519.36">I would tell you you could find me on Twitter but that would be a lie because I don't have</span> <span data-start="1519.36" data-end="1522.669">one so e-mail or GitHub works great.</span> </p>
</section>