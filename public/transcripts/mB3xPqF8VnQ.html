<section>
<p><span data-start="7.7" data-end="10.83">I'll talk about using non JavaScript</span> <span data-start="10.83" data-end="13.98">code or libraries in JavaScript it just</span> <span data-start="13.98" data-end="16.199">before that two things I apologize for</span> <span data-start="16.199" data-end="18.539">the resolution of the slides my laptop</span> <span data-start="18.539" data-end="20.22">has been giving me some technical</span> <span data-start="20.22" data-end="22.98">difficulties thank you to the organizers</span> <span data-start="22.98" data-end="25.08">of the conference by the way you helped</span> <span data-start="25.08" data-end="27.48">me with a few problems and second point</span> <span data-start="27.48" data-end="29.369">please feel free to stop me with any</span> <span data-start="29.369" data-end="32.009">questions at any point did I prefer to</span> <span data-start="32.009" data-end="33.42">be asked questions and for you to wait</span> <span data-start="33.42" data-end="38.1">for the end okay so non JavaScript code</span> <span data-start="38.1" data-end="40.469">in JavaScript why is this even</span> <span data-start="40.469" data-end="42.78">interesting what would be the point well</span> <span data-start="42.78" data-end="43.829">the point is that there's a lot of</span> <span data-start="43.829" data-end="46.23">existing code out there maybe it's open</span> <span data-start="46.23" data-end="48.48">source or maybe you have a lot of code</span> <span data-start="48.48" data-end="50.7">you've written in your company typically</span> <span data-start="50.7" data-end="55.11">at C and C++ and it could simply be very</span> <span data-start="55.11" data-end="59.67">time intensive to manually port it to</span> </p>
<p><span data-start="59.67" data-end="61.079">JavaScript you don't want to start</span> <span data-start="61.079" data-end="63.21">writing huge applications from scratch</span> <span data-start="63.21" data-end="65.67">if you don't really need to now the</span> <span data-start="65.67" data-end="67.17">things when you develop a native that</span> <span data-start="67.17" data-end="71.07">you can reuse that code so i think we</span> <span data-start="71.07" data-end="72.45">should be able to do that on the web too</span> <span data-start="72.45" data-end="74.369">it's just a technical problem that's</span> <span data-start="74.369" data-end="77.549">stopping us really so I'd like to start</span> <span data-start="77.549" data-end="80.79">with sort of the cool stuff up front so</span> <span data-start="80.79" data-end="84">with some demos so demo number one</span> <span data-start="84" data-end="86.689">bullet so bullet is a physics engine</span> <span data-start="86.689" data-end="89.34">it's used actually in several triple-a</span> <span data-start="89.34" data-end="91.189">games it's open source it's very cool</span> <span data-start="91.189" data-end="94.049">it's a hundred fifty thousand lines and</span> <span data-start="94.049" data-end="95.939">it's pretty complicated because well</span> <span data-start="95.939" data-end="97.259">it's a physics engine you don't want to</span> <span data-start="97.259" data-end="99.45">start writing these from scratch if you</span> <span data-start="99.45" data-end="101.909">don't need to because it's so useful it</span> <span data-start="101.909" data-end="103.799">was actually manually ported to Java</span> <span data-start="103.799" data-end="106.71">called a bullet J bullet was manually</span> <span data-start="106.71" data-end="109.56">ported to JavaScript as bullet KS and</span> <span data-start="109.56" data-end="111.689">there are some demos with this but there</span> <span data-start="111.689" data-end="113.49">are really two problems with that</span> <span data-start="113.49" data-end="117.299">approach these ports since their manual</span> <span data-start="117.299" data-end="118.92">they tend to be partial the people that</span> <span data-start="118.92" data-end="120.299">are doing this it's a lot of effort for</span> <span data-start="120.299" data-end="123.659">them they don't port the entire bullet</span> <span data-start="123.659" data-end="126.299">library as is they pour the parts that</span> <span data-start="126.299" data-end="129.95">they focus on second of all they port a</span> <span data-start="129.95" data-end="131.54">that shot of bullet at some particular</span> <span data-start="131.54" data-end="134.75">point in time so there's always lag so</span> <span data-start="134.75" data-end="136.76">the trunk version is I think right now</span> <span data-start="136.76" data-end="139.129">about seven point releases later than</span> <span data-start="139.129" data-end="141.5">bullet j/s well there are actually two</span> <span data-start="141.5" data-end="144.28">manual ports here so there's double leg</span> <span data-start="144.28" data-end="147.47">so mlas is a port of bullet to</span> <span data-start="147.47" data-end="150.05">javascript with em scripting so it's</span> <span data-start="150.05" data-end="152.09">completely automatic and for that reason</span> <span data-start="152.09" data-end="154.64">it you get the entire library as is and</span> <span data-start="154.64" data-end="155.989">you get the code in its current state</span> <span data-start="155.989" data-end="158.69">have a few links but since networking</span> <span data-start="158.69" data-end="160.01">isn't working for me i'll just show you</span> <span data-start="160.01" data-end="165.23">a local demo and which hopefully will</span> <span data-start="165.23" data-end="170.18">work ok so this is a simulation of a few</span> <span data-start="170.18" data-end="174.68">cubes it's rendering using cubic V rjs</span> <span data-start="174.68" data-end="177.079">they typically fall in a bit more</span> <span data-start="177.079" data-end="182.54">interesting pattern so so this again</span> <span data-start="182.54" data-end="184.16">this is bullet running on the web in</span> </p>
<p><span data-start="184.16" data-end="186.709">JavaScript what's you might have seen</span> <span data-start="186.709" data-end="189.049">this demo before what's cool about this</span> <span data-start="189.049" data-end="192.019">right now is that it's actually possible</span> <span data-start="192.019" data-end="196.519">to tweak the the demo in interesting</span> <span data-start="196.519" data-end="200.45">ways so this is being used from</span> <span data-start="200.45" data-end="204.53">JavaScript so for example here gnome is</span> <span data-start="204.53" data-end="206.18">simply the number of cubes I can change</span> <span data-start="206.18" data-end="209.569">that to say 20 and just reload the page</span> <span data-start="209.569" data-end="212.329">and since it shut its JavaScript you</span> <span data-start="212.329" data-end="215.53">immediately get a slightly more</span> <span data-start="215.53" data-end="218.9">interesting result if this is actually a</span> <span data-start="218.9" data-end="220.34">case where it's much more fun to do this</span> <span data-start="220.34" data-end="222.109">in JavaScript than in C++ with that you</span> <span data-start="222.109" data-end="223.85">need to rebuild your entire project just</span> <span data-start="223.85" data-end="227.12">to change some parameters so you can do</span> <span data-start="227.12" data-end="231.37">that and you can also change things like</span> <span data-start="231.37" data-end="234.829">let me see reset positions is the</span> </p>
<p><span data-start="234.829" data-end="237.23">JavaScript which defines where the</span> <span data-start="237.23" data-end="239.45">bodies begin so let's change the x</span> <span data-start="239.45" data-end="245.63">position to say I so eyes the index the</span> <span data-start="245.63" data-end="247.819">number of the body you just said it to I</span> <span data-start="247.819" data-end="251.78">it should just drop them in a line i</span> <span data-start="251.78" data-end="255.2">think if i remember correctly yeah so</span> <span data-start="255.2" data-end="259.69">just sort of falling like that and just</span> <span data-start="259.69" data-end="261.919">another example we can make them fall</span> <span data-start="261.919" data-end="263.22">from a higher distance</span> <span data-start="263.22" data-end="272.07">as well see something else slightly so</span> <span data-start="272.07" data-end="273.21">it's pretty much the same that they're</span> <span data-start="273.21" data-end="276.9">falling from a higher distance okay so</span> <span data-start="276.9" data-end="281.22">that's a first demo out of three that I</span> <span data-start="281.22" data-end="284.76">wanted to show you second demo is sequel</span> <span data-start="284.76" data-end="287.61">light so sequel I'd is a very popular</span> <span data-start="287.61" data-end="291">open source database it actually could</span> <span data-start="291" data-end="292.95">have become part of the web through a</span> <span data-start="292.95" data-end="296.07">web sequel but there's the long quote</span> <span data-start="296.07" data-end="298.05">here that explains why there's a problem</span> <span data-start="298.05" data-end="299.88">with a standardization process basically</span> <span data-start="299.88" data-end="306.48">i leave the code as is i don't comment</span> <span data-start="306.48" data-end="311.1">on it it but i think the point that i'd</span> <span data-start="311.1" data-end="313.14">like to make is that the issue with</span> <span data-start="313.14" data-end="315">standardization is that you need to get</span> <span data-start="315" data-end="318.62">people to work together on a specific</span> </p>
<p><span data-start="318.62" data-end="321.63">API on a spec but if you just compile</span> <span data-start="321.63" data-end="323.49">the code as is the JavaScript you don't</span> <span data-start="323.49" data-end="324.99">need to convince anyone of anything you</span> <span data-start="324.99" data-end="326.34">can just compile whatever you want it</span> <span data-start="326.34" data-end="328.7">it'll run in all web browsers out there</span> <span data-start="328.7" data-end="333.96">so here's a working progress demo of</span> <span data-start="333.96" data-end="336.3">sequel light the resolution is making it</span> <span data-start="336.3" data-end="338.33">a bit hard to read what's happening here</span> <span data-start="338.33" data-end="344.46">but it basically well this is some quite</span> <span data-start="344.46" data-end="346.44">boring sequel light code it'll just</span> <span data-start="346.44" data-end="348.6">create a table create some stuff in that</span> <span data-start="348.6" data-end="351.27">table and do a select from it if I hit</span> <span data-start="351.27" data-end="353.79">execute you'll get key equals to text</span> <span data-start="353.79" data-end="355.2">equals second item which is what's</span> <span data-start="355.2" data-end="356.85">expected since we asked for the case</span> <span data-start="356.85" data-end="359.04">where value is equal to 987 which is</span> <span data-start="359.04" data-end="363.81">what's over here so we have that and of</span> <span data-start="363.81" data-end="368.58">course I can do additional commands for</span> <span data-start="368.58" data-end="371.7">thinking called it's tough so if i do</span> <span data-start="371.7" data-end="376.229">that i get all the elements and the</span> <span data-start="376.229" data-end="379.91">resolution is a bit annoying and where</span> <span data-start="379.91" data-end="386.21">thank you</span> <span data-start="386.22" data-end="389.47">and of course I can do it basically</span> <span data-start="389.47" data-end="391.509">anything else in the sequel light syntax</span> <span data-start="391.509" data-end="394.09">fight ask for less than hundred I get</span> <span data-start="394.09" data-end="395.86">just the first item since the others had</span> <span data-start="395.86" data-end="399.13">larger values and and I want to type</span> <span data-start="399.13" data-end="400.72">this from scratch but here's an example</span> <span data-start="400.72" data-end="403.36">of enjoying between two tables so</span> <span data-start="403.36" data-end="405.19">actually it's easier to read it here so</span> <span data-start="405.19" data-end="406.72">again it's just it's creating another</span> <span data-start="406.72" data-end="409.15">table more stuff inserting some values</span> <span data-start="409.15" data-end="411.16">and then it does a select which does</span> <span data-start="411.16" data-end="414.639">adjoin over the value element so I'm</span> <span data-start="414.639" data-end="419.849">just going to copy that and run it and</span> <span data-start="419.849" data-end="423.22">this is the expected data there were two</span> <span data-start="423.22" data-end="426.13">items for value equals 25 so the text</span> <span data-start="426.13" data-end="427.539">first item is from the first table it's</span> <span data-start="427.539" data-end="429.25">a change and then there's two text from</span> <span data-start="429.25" data-end="430.84">the second table more stuff and get</span> <span data-start="430.84" data-end="432.789">additional stuff but again this is just</span> <span data-start="432.789" data-end="434.65">to show that you get the entire sequel</span> </p>
<p><span data-start="434.65" data-end="436.63">I'd language by compiling the entire</span> <span data-start="436.63" data-end="441.4">sequel aight implementation so that</span> <span data-start="441.4" data-end="447.28">concludes demo to demo three Python Ruby</span> <span data-start="447.28" data-end="449.11">and lua these are popular dynamic</span> <span data-start="449.11" data-end="451.69">languages actually because they're so</span> <span data-start="451.69" data-end="454.74">popular there are several projects to</span> <span data-start="454.74" data-end="457.3">manually implement them in JavaScript</span> <span data-start="457.3" data-end="459.52">but these suffer generally from the</span> <span data-start="459.52" data-end="460.599">problems that i mentioned before about</span> <span data-start="460.599" data-end="462.88">bullets the these ports are generally</span> <span data-start="462.88" data-end="464.409">partial they don't implement the entire</span> <span data-start="464.409" data-end="465.849">language there are a lot of corners in</span> <span data-start="465.849" data-end="467.53">these languages they don't bother with</span> <span data-start="467.53" data-end="470.74">they lag behind the trunk version of the</span> <span data-start="470.74" data-end="474.46">language and worse in this case they</span> <span data-start="474.46" data-end="478.03">typically targeted slightly modified</span> <span data-start="478.03" data-end="479.849">version of the language for example</span> <span data-start="479.849" data-end="483.43">pajamas for Python translates Python</span> <span data-start="483.43" data-end="485.53">more or less as is into JavaScript so i</span> <span data-start="485.53" data-end="487.419">end up with the semantics of javascript</span> <span data-start="487.419" data-end="489.699">for example if you do some operations on</span> <span data-start="489.699" data-end="491.52">numbers you'll get the behavior</span> <span data-start="491.52" data-end="493.69">javascript has not the behavior of</span> </p>
<p><span data-start="493.69" data-end="495.61">Python so you're writing something that</span> <span data-start="495.61" data-end="497.02">looks like Python but it's not really</span> <span data-start="497.02" data-end="499.389">Python on the other hand if you compile</span> <span data-start="499.389" data-end="501.43">the entire language as is into</span> <span data-start="501.43" data-end="502.93">JavaScript and again the benefit is you</span> <span data-start="502.93" data-end="505.96">get exactly what you started out with so</span> <span data-start="505.96" data-end="508.18">if I could connect in the network ID</span> <span data-start="508.18" data-end="510.159">show you this website which was just on</span> <span data-start="510.159" data-end="512.079">Hacker News repple de it which is really</span> <span data-start="512.079" data-end="514.419">the nicer way to show this it uses</span> <span data-start="514.419" data-end="515.529">Python Ruby</span> <span data-start="515.529" data-end="518.019">with the code that I'm talking about</span> <span data-start="518.019" data-end="521.249">here but instead i'll show you a local</span> <span data-start="521.249" data-end="529.209">version of the python one so it just</span> <span data-start="529.209" data-end="531.689">brings some numbers just some random</span> <span data-start="531.689" data-end="535.36">syntax and it actually does import sis</span> <span data-start="535.36" data-end="538.629">and writes version and that platform and</span> <span data-start="538.629" data-end="540.009">the version of the platform are simply</span> <span data-start="540.009" data-end="541.42">what was there when i compiled it</span> <span data-start="541.42" data-end="544.029">locally on my linux machine it says</span> <span data-start="544.029" data-end="546.22">apple and i assume because it was built</span> <span data-start="546.22" data-end="552.069">using llvm but anyhow that's to sort of</span> <span data-start="552.069" data-end="553.329">elaborate and what is it before about</span> <span data-start="553.329" data-end="556.899">differences with the language it let's</span> <span data-start="556.899" data-end="562.87">say let's say that I i have think i</span> <span data-start="562.87" data-end="565.779">actually have a code just so i don't</span> <span data-start="565.779" data-end="569.079">forget yet let's just briefly look at</span> <span data-start="569.079" data-end="572.649">this code here so it does x equals to</span> <span data-start="572.649" data-end="574.689">the maximum possible integer then it</span> <span data-start="574.689" data-end="577.509">will print the type of X and X it'll add</span> <span data-start="577.509" data-end="579.43">one to that so it's max inked plus one</span> <span data-start="579.43" data-end="583.72">print the type and then print X to the</span> <span data-start="583.72" data-end="586.18">power of 10 why this is interesting is</span> <span data-start="586.18" data-end="589.72">because pythons handling of numbers is</span> <span data-start="589.72" data-end="592.449">very different from JavaScript so if I</span> <span data-start="592.449" data-end="595.66">execute this so the first value here</span> <span data-start="595.66" data-end="599.709">this thing is type int its max int but</span> <span data-start="599.709" data-end="602.04">when you add one to that in Python</span> </p>
<p><span data-start="602.04" data-end="604.779">Python changes that to type long and</span> <span data-start="604.779" data-end="606.579">type long is not just the long integer</span> <span data-start="606.579" data-end="608.589">it can be basically any value so when I</span> <span data-start="608.589" data-end="609.879">do that to the power of 10 you get this</span> <span data-start="609.879" data-end="612.939">huge number over here so this is exactly</span> <span data-start="612.939" data-end="615.1">the same result that I would get if I</span> <span data-start="615.1" data-end="619.079">were just running for example Python</span> <span data-start="619.079" data-end="623.649">natively here you see I get the exact</span> <span data-start="623.649" data-end="625.99">same numbers in this case so this is the</span> <span data-start="625.99" data-end="629.069">benefit of compiling it whereas in</span> </p>
<p><span data-start="629.069" data-end="631.42">JavaScript natively for just open the</span> <span data-start="631.42" data-end="636.85">console here and again I'd so this is</span> <span data-start="636.85" data-end="638.949">code that does something similar it</span> <span data-start="638.949" data-end="641.11">again it takes that max end and then</span> <span data-start="641.11" data-end="644.92">shows it to the power of 10 and of</span> <span data-start="644.92" data-end="645.96">course</span> <span data-start="645.96" data-end="648">the results are very different in</span> </p>
<p><span data-start="648" data-end="649.92">JavaScript the first number is fine but</span> <span data-start="649.92" data-end="652.26">the second number is a double so you</span> <span data-start="652.26" data-end="653.64">don't get the same thing we saw in</span> <span data-start="653.64" data-end="657.48">Python with this so this just shows that</span> <span data-start="657.48" data-end="659.97">you can implement the real version of</span> <span data-start="659.97" data-end="662.13">Python on the web getting you the exact</span> <span data-start="662.13" data-end="663.33">same behavior you would get in the</span> <span data-start="663.33" data-end="666.72">console native code version unlike in</span> <span data-start="666.72" data-end="669.8">sort of a manual court that does not</span> <span data-start="669.8" data-end="674.16">copy the entire language as is I hope I</span> <span data-start="674.16" data-end="677.7">was clear oh and I did want to do a</span> <span data-start="677.7" data-end="680.43">fourth demo that I didn't plan on but</span> <span data-start="680.43" data-end="682.05">given that the previous talk was about</span> <span data-start="682.05" data-end="688.22">audio I thought it might be relevant so</span> <span data-start="688.22" data-end="693.39">the previous talk mentioned the Web</span> <span data-start="693.39" data-end="696.2">Audio spec and the Mozilla audio data</span> </p>
<p><span data-start="696.2" data-end="700.07">API and I think the very valid reasoning</span> <span data-start="700.07" data-end="703.02">given for preferring the Web Audio API</span> <span data-start="703.02" data-end="705.72">was that it's easy to get to results</span> <span data-start="705.72" data-end="707.13">very quickly you don't need to start</span> <span data-start="707.13" data-end="708.96">writing the middleware or the libraries</span> <span data-start="708.96" data-end="711.81">to actually see results but the reason</span> <span data-start="711.81" data-end="714.03">is pretty similar to what i was talking</span> <span data-start="714.03" data-end="716.28">about Earth earlier with the Mozilla</span> <span data-start="716.28" data-end="719.28">audio data API you have access to the</span> <span data-start="719.28" data-end="721.8">hardware to the audio partner all you</span> <span data-start="721.8" data-end="725.28">need is to actually be able to have a</span> <span data-start="725.28" data-end="726.87">library that creates audio in a</span> <span data-start="726.87" data-end="728.85">convenient way we have that code it's</span> <span data-start="728.85" data-end="732">written in C++ we just can't run it on</span> <span data-start="732" data-end="734.58">the web but we can compile it to the web</span> <span data-start="734.58" data-end="738.03">and this is a demo of using espeak which</span> <span data-start="738.03" data-end="742.05">is a speech synthesis engine again</span> <span data-start="742.05" data-end="743.46">something pretty complicated that you</span> <span data-start="743.46" data-end="744.69">don't want to start writing from scratch</span> <span data-start="744.69" data-end="747.75">and if the connection is working you</span> <span data-start="747.75" data-end="752.46">should hear something but I guess it's</span> <span data-start="752.46" data-end="758.07">not working so that was underwhelming</span> </p>
<p><span data-start="758.07" data-end="763.16">I actually can't even hear it locally oh</span> <span data-start="763.16" data-end="765.24">the people who are sitting in the front</span> <span data-start="765.24" data-end="768.6">row might be able to hear it I doubt it</span> <span data-start="768.6" data-end="778.05">I give up oh did you hear anything</span> <span data-start="778.05" data-end="780.09">that's I think that's as close as I can</span> <span data-start="780.09" data-end="788.62">get</span> <span data-start="788.63" data-end="793.87">oh well again this was not a planned</span> <span data-start="793.87" data-end="800.78">demo okay back to the scheduled</span> <span data-start="800.78" data-end="803.42">programming so after showing you some</span> <span data-start="803.42" data-end="805.04">demos I'd like to talk about the more</span> <span data-start="805.04" data-end="807.68">boring aspects about how this works and</span> <span data-start="807.68" data-end="811.34">how you can actually use it and so forth</span> <span data-start="811.34" data-end="815.69">so how does this work the idea is you</span> <span data-start="815.69" data-end="819.92">take your C or C++ code you want to get</span> <span data-start="819.92" data-end="821.33">that into JavaScript but you need to go</span> <span data-start="821.33" data-end="824.69">through an intermediary step of lvm bit</span> <span data-start="824.69" data-end="827.72">code so llvm the low-level virtual</span> <span data-start="827.72" data-end="830.5">machine is a compiler project much like</span> </p>
<p><span data-start="830.5" data-end="835.01">GCC which can compile C code into native</span> <span data-start="835.01" data-end="837.5">code but it can also compile into lvm</span> <span data-start="837.5" data-end="839.54">bit code which is an intermediary is</span> <span data-start="839.54" data-end="842.69">stage which the nice thing about is that</span> <span data-start="842.69" data-end="845.15">is that it is extremely well documented</span> <span data-start="845.15" data-end="848.54">and for that reason it's used here so we</span> <span data-start="848.54" data-end="850.73">translate the high-level world medium</span> <span data-start="850.73" data-end="855.26">level c code into this low-level a bit</span> <span data-start="855.26" data-end="858.14">code and in script and then compiles</span> <span data-start="858.14" data-end="861.11">that into javascript so this is the big</span> <span data-start="861.11" data-end="865.76">picture of what happens but what</span> <span data-start="865.76" data-end="869.51">actually goes on here so and if script</span> <span data-start="869.51" data-end="871.97">when we try to translate bit code one to</span> <span data-start="871.97" data-end="875.78">one so on the left here we have llvm bit</span> <span data-start="875.78" data-end="876.95">code and on the right we have the</span> <span data-start="876.95" data-end="880.76">corresponding javascript so for example</span> <span data-start="880.76" data-end="882.8">the first thing here could you see the</span> <span data-start="882.8" data-end="885.29">mouse cursor yet the first thing here is</span> <span data-start="885.29" data-end="889.28">basically allocate which means allocate</span> <span data-start="889.28" data-end="891.85">on the stack a 32-bit integer in</span> </p>
<p><span data-start="891.85" data-end="893.69">JavaScript you can do something very</span> <span data-start="893.69" data-end="895.52">similar by just doing VAR local</span> <span data-start="895.52" data-end="898.28">variables stored on the stack similarly</span> <span data-start="898.28" data-end="901.07">calling a function within a 32-bit</span> <span data-start="901.07" data-end="904.01">integer parameter here is translated</span> <span data-start="904.01" data-end="905.78">simply into a function call so this is a</span> <span data-start="905.78" data-end="907.64">native JavaScript function called not</span> <span data-start="907.64" data-end="912.17">some complicated a emulation of one and</span> <span data-start="912.17" data-end="915.17">the last command is a mathematical</span> <span data-start="915.17" data-end="918.829">ed adding 22 to the variable one and</span> <span data-start="918.829" data-end="921.95">that turns into an ED so for the most</span> <span data-start="921.95" data-end="923.63">part in scripting just tries to</span> <span data-start="923.63" data-end="925.82">translate the bit code as is and that</span> <span data-start="925.82" data-end="930.85">works for quite a lot but not everything</span> <span data-start="930.85" data-end="934.339">one issue is that Seco typically</span> <span data-start="934.339" data-end="936.47">allocates memory using malloc etc and it</span> <span data-start="936.47" data-end="938.06">reads and writes from that memory you</span> <span data-start="938.06" data-end="939.709">don't just put things on the stack you</span> <span data-start="939.709" data-end="943.07">have the heat so we implement sort of a</span> <span data-start="943.07" data-end="945.92">heap variable in javascript is a sin</span> <span data-start="945.92" data-end="948.829">which is a single large array a normal</span> </p>
<p><span data-start="948.829" data-end="951.519">JavaScript array of course and it</span> <span data-start="951.519" data-end="954.709">represents the memory space so heap of X</span> <span data-start="954.709" data-end="956.87">is a read heap of X equals something is</span> <span data-start="956.87" data-end="961.57">a right and pointers X here are simply</span> <span data-start="961.57" data-end="965.149">integers so i hope this sort of makes</span> <span data-start="965.149" data-end="969.44">sense another complicated issue with the</span> <span data-start="969.44" data-end="973.76">behavior of C++ is that so we saw in</span> <span data-start="973.76" data-end="976.399">this lie that adding 22 is simply a</span> <span data-start="976.399" data-end="979.579">dollar 1 + 22 but in general of course</span> <span data-start="979.579" data-end="982.64">that's not correct for example in c x</span> <span data-start="982.64" data-end="985.579">equals 5 and x divided by 2 gives you</span> <span data-start="985.579" data-end="987.32">two it ramms down because it's an</span> <span data-start="987.32" data-end="989.899">integer in javascript x equals 5 x</span> <span data-start="989.899" data-end="993.1">divided by 2 gives you two and a half so</span> <span data-start="993.1" data-end="995.42">this of course is fixable by doing math</span> <span data-start="995.42" data-end="997.79">dot floor although even this actually is</span> <span data-start="997.79" data-end="999.11">not correct because this gives the</span> <span data-start="999.11" data-end="1001.18">correct rounding behavior for positive</span> <span data-start="1001.18" data-end="1003.089">integers with that negative ones but</span> <span data-start="1003.089" data-end="1007">this works in most cases and there are</span> <span data-start="1007" data-end="1008.92">similar issues with overflows signs so</span> <span data-start="1008.92" data-end="1012.13">these are so c and java script or two</span> <span data-start="1012.13" data-end="1015.55">very different languages they their</span> <span data-start="1015.55" data-end="1017.829">semantics do not match one to one</span> <span data-start="1017.829" data-end="1020.35">obviously so much of the challenge in</span> <span data-start="1020.35" data-end="1023.019">writing a compiler from from the bit</span> <span data-start="1023.019" data-end="1025.12">code but really from c to javascript is</span> <span data-start="1025.12" data-end="1026.799">to get all these little behavior</span> <span data-start="1026.799" data-end="1028.87">differences to make them completely</span> <span data-start="1028.87" data-end="1030.819">vanish so there are a lot of details</span> <span data-start="1030.819" data-end="1034.689">here that i will not bore you with but</span> <span data-start="1034.689" data-end="1035.799">it will still worried with some other</span> <span data-start="1035.799" data-end="1039.88">and more high level details so to get</span> <span data-start="1039.88" data-end="1044.38">good performing code you really need to</span> <span data-start="1044.38" data-end="1046.63">generate code that looks like this over</span> <span data-start="1046.63" data-end="1047.79">here while and</span> <span data-start="1047.79" data-end="1049.56">fourth you want to use native JavaScript</span> <span data-start="1049.56" data-end="1052.71">loops and ifs the problem though is that</span> <span data-start="1052.71" data-end="1054.51">when you're compiling this bit code you</span> <span data-start="1054.51" data-end="1056.79">get what we see on the left basically</span> <span data-start="1056.79" data-end="1059.91">these blocks of code so block one some</span> <span data-start="1059.91" data-end="1062.43">commands then a branch to block to block</span> <span data-start="1062.43" data-end="1065.94">two is another series of commands ending</span> <span data-start="1065.94" data-end="1067.95">with a branch this is very low level</span> <span data-start="1067.95" data-end="1070.11">it's like some commands plus go tues</span> <span data-start="1070.11" data-end="1072.33">it's even lower level than the seco that</span> <span data-start="1072.33" data-end="1074.28">we started out with this is the alluvium</span> <span data-start="1074.28" data-end="1078.12">bit code so one of the challenges is to</span> <span data-start="1078.12" data-end="1080.37">get from this code to something that</span> <span data-start="1080.37" data-end="1082.59">looks like normal JavaScript loops and</span> <span data-start="1082.59" data-end="1085.61">there's a big section in the in the</span> <span data-start="1085.61" data-end="1088.14">optimizer an impression that tries to</span> <span data-start="1088.14" data-end="1090.72">reason about these loops and to recruit</span> <span data-start="1090.72" data-end="1094.28">to recreate them to something because</span> <span data-start="1094.28" data-end="1097.43">this it simply runs much much faster</span> <span data-start="1097.43" data-end="1100.5">with a with the loops without loops you</span> <span data-start="1100.5" data-end="1102.27">can emulate go tues with various</span> <span data-start="1102.27" data-end="1104.6">cumbersome ways it's extremely slowly</span> <span data-start="1104.6" data-end="1107.76">with that approach so it's necessary to</span> <span data-start="1107.76" data-end="1110.04">do this optimizing step and it's the</span> <span data-start="1110.04" data-end="1111.45">second thing I've already sort of</span> <span data-start="1111.45" data-end="1114.96">mentioned VAR x is a reasonable way to</span> <span data-start="1114.96" data-end="1117.6">implement a variable on the stack it's</span> <span data-start="1117.6" data-end="1119.07">of course fast because javascript</span> <span data-start="1119.07" data-end="1120.69">engines have been heavily optimized for</span> <span data-start="1120.69" data-end="1123.18">that however you can't do that for every</span> <span data-start="1123.18" data-end="1125.22">variable for example if you take the</span> <span data-start="1125.22" data-end="1128.67">address of a variable on the stack in c</span> <span data-start="1128.67" data-end="1130.41">you can pass that to some other function</span> <span data-start="1130.41" data-end="1133.53">and of course you cannot access bar x in</span> <span data-start="1133.53" data-end="1135.87">javascript in another function so the</span> <span data-start="1135.87" data-end="1137.7">optimizer needs to reason about when it</span> <span data-start="1137.7" data-end="1140.28">can optimize by doing VAR x and when it</span> <span data-start="1140.28" data-end="1146.88">can't ok so you've written your code it</span> <span data-start="1146.88" data-end="1148.92">runs it's optimized but how do you</span> <span data-start="1148.92" data-end="1150.87">actually access anything or do something</span> <span data-start="1150.87" data-end="1152.31">with that code you're running it inside</span> <span data-start="1152.31" data-end="1153.69">a web browsers are not on a normal</span> <span data-start="1153.69" data-end="1156.15">machine with the files with a filesystem</span> <span data-start="1156.15" data-end="1159.06">and so forth so basically an obscure</span> <span data-start="1159.06" data-end="1162.18">iftin we've written standard see system</span> </p>
<p><span data-start="1162.18" data-end="1163.71">API is in JavaScript we've basically</span> <span data-start="1163.71" data-end="1167.31">implemented the C standard it lives see</span> <span data-start="1167.31" data-end="1169.74">basically and also plastics and sdl not</span> <span data-start="1169.74" data-end="1171.18">all of these but the parts that we've</span> <span data-start="1171.18" data-end="1173.28">needed we've written a JavaScript</span> <span data-start="1173.28" data-end="1174.84">implementation of them that sort of</span> <span data-start="1174.84" data-end="1177.15">makes sense for the web so it uses an</span> <span data-start="1177.15" data-end="1178.58">xhr to load file</span> <span data-start="1178.58" data-end="1181.01">and so forth so just as an example of</span> <span data-start="1181.01" data-end="1184.429">what this look looks like you can set up</span> <span data-start="1184.429" data-end="1188">a virtual file system using some command</span> <span data-start="1188" data-end="1190.13">that we added called FS that create lazy</span> <span data-start="1190.13" data-end="1195.019">file so you give it a the directory the</span> <span data-start="1195.019" data-end="1197.899">name of the file the URL from where it</span> <span data-start="1197.899" data-end="1200.39">will actually do the load and the point</span> <span data-start="1200.39" data-end="1202.96">is that the compiled code the C++ code</span> <span data-start="1202.96" data-end="1205.13">uses the file system in a completely</span> <span data-start="1205.13" data-end="1207.019">normal way you do not need to rewrite</span> <span data-start="1207.019" data-end="1209.299">your C code the C code will include</span> <span data-start="1209.299" data-end="1213.35">standard i/o do F open do F read but</span> <span data-start="1213.35" data-end="1215.149">when it actually reads from this file</span> <span data-start="1215.149" data-end="1218.69">that debt that we created here the</span> </p>
<p><span data-start="1218.69" data-end="1220.429">JavaScript implementation will actually</span> <span data-start="1220.429" data-end="1223.429">do an xhr and load that data so we've</span> <span data-start="1223.429" data-end="1227.36">made it so you can use your existing C</span> <span data-start="1227.36" data-end="1229.76">code but you sort of hook it up to the</span> <span data-start="1229.76" data-end="1240.47">relevant things on the web</span> <span data-start="1240.48" data-end="1244.78">okay and so how does it actually look</span> <span data-start="1244.78" data-end="1248.29">when you eat when you try to eat try to</span> <span data-start="1248.29" data-end="1253.27">use this to compile a project so just</span> <span data-start="1253.27" data-end="1254.68">one more technical detail there are</span> <span data-start="1254.68" data-end="1257.14">really two parts in this project there</span> <span data-start="1257.14" data-end="1259.39">is the compiler which compiles llvm to</span> <span data-start="1259.39" data-end="1261.07">javascript this is basically what I was</span> <span data-start="1261.07" data-end="1263.59">talking about before it's really just</span> <span data-start="1263.59" data-end="1265.06">concerned with getting the code into</span> </p>
<p><span data-start="1265.06" data-end="1267.55">JavaScript in a way that works so it</span> <span data-start="1267.55" data-end="1269.26">just gets it there but the problem is</span> <span data-start="1269.26" data-end="1271.12">we're compiling this llvm bit code which</span> <span data-start="1271.12" data-end="1273.49">is low level and we get something that's</span> <span data-start="1273.49" data-end="1275.62">not easy to use for example if the code</span> <span data-start="1275.62" data-end="1278.01">started a C++ you'll have name mangling</span> <span data-start="1278.01" data-end="1280.81">you'll have these crazy long function</span> <span data-start="1280.81" data-end="1283.63">names that really mean very simple</span> <span data-start="1283.63" data-end="1284.89">things but you get them in a mangled</span> <span data-start="1284.89" data-end="1287.17">form there's also lifecycle issues</span> <span data-start="1287.17" data-end="1288.97">creating objects and destroying them</span> <span data-start="1288.97" data-end="1290.62">it's not easy at all in the low-level</span> <span data-start="1290.62" data-end="1294.07">bit code so you get code that works and</span> <span data-start="1294.07" data-end="1295.45">if all you care about is taking a</span> <span data-start="1295.45" data-end="1297.43">project and running it on the web as is</span> <span data-start="1297.43" data-end="1299.02">that's fine and that's what most of</span> <span data-start="1299.02" data-end="1301.03">these demos were except for the first</span> <span data-start="1301.03" data-end="1303.13">one with bullet but if you want to use</span> <span data-start="1303.13" data-end="1305.5">the libraries on the web in a convenient</span> <span data-start="1305.5" data-end="1307.63">way you really need something else and</span> <span data-start="1307.63" data-end="1310">that's what the bindings generator is</span> <span data-start="1310" data-end="1313.06">it's the work of the past few months it</span> <span data-start="1313.06" data-end="1314.98">parses not the bit code but the actual</span> <span data-start="1314.98" data-end="1316.84">header files the dut h files in your</span> <span data-start="1316.84" data-end="1319.48">project and generate some glue code to</span> <span data-start="1319.48" data-end="1321.67">connect things so i'll give an example</span> <span data-start="1321.67" data-end="1324.19">in two slides that will sort of i hope</span> <span data-start="1324.19" data-end="1325.87">make sense of this but the idea is again</span> <span data-start="1325.87" data-end="1327.85">that there's a compiler for the bit code</span> <span data-start="1327.85" data-end="1329.71">and something else that creates the glue</span> <span data-start="1329.71" data-end="1331.39">code that doesn't look at the vid khob</span> <span data-start="1331.39" data-end="1336.4">it looks at the high level hitters okay</span> <span data-start="1336.4" data-end="1337.87">so how does it actually look when you</span> <span data-start="1337.87" data-end="1339.88">compile something to javascript this is</span> <span data-start="1339.88" data-end="1342.91">slightly simplified but it gives you the</span> <span data-start="1342.91" data-end="1345.24">main picture so you build your library</span> <span data-start="1345.24" data-end="1348.7">almost normally you do make and</span> <span data-start="1348.7" data-end="1352.81">configure sorry so you build the project</span> <span data-start="1352.81" data-end="1355.35">pretty much normally except you use a</span> <span data-start="1355.35" data-end="1358.81">different compiler which basically just</span> <span data-start="1358.81" data-end="1360.73">changes some parameters gets it to</span> <span data-start="1360.73" data-end="1362.83">generate it'll be a bit code instead of</span> <span data-start="1362.83" data-end="1366.01">native code then you run the inscription</span> <span data-start="1366.01" data-end="1368.23">compiler on that bit code this gives you</span> <span data-start="1368.23" data-end="1370.36">some JavaScript you're on the unscripted</span> <span data-start="1370.36" data-end="1371.71">bindings generator</span> <span data-start="1371.71" data-end="1373.45">the headers this again gives you some</span> </p>
<p><span data-start="1373.45" data-end="1375.7">JavaScript and you simply combine those</span> <span data-start="1375.7" data-end="1379.059">into say library jas so if everything</span> <span data-start="1379.059" data-end="1381.25">goes right this is pretty much what the</span> <span data-start="1381.25" data-end="1386.47">process should be let's take look at</span> <span data-start="1386.47" data-end="1389.47">sort of a tiny example of how the code</span> <span data-start="1389.47" data-end="1394.08">would would look so if we have a C++ a a</span> <span data-start="1394.08" data-end="1396.07">library that looks like this so these</span> <span data-start="1396.07" data-end="1400">are two really silly classes a data</span> <span data-start="1400" data-end="1402.88">class that gets an X and Y a processor</span> <span data-start="1402.88" data-end="1406.87">class that gets data class instances you</span> <span data-start="1406.87" data-end="1408.309">would use that on the web basically as</span> <span data-start="1408.309" data-end="1410.71">follows you obviously import that the</span> <span data-start="1410.71" data-end="1413.35">script into your web page and then you</span> <span data-start="1413.35" data-end="1415.299">can use those objects in a normal way</span> <span data-start="1415.299" data-end="1417.61">data one equals into data classic and</span> <span data-start="1417.61" data-end="1420.19">that data class and C++ takes two</span> <span data-start="1420.19" data-end="1423.46">integers in JavaScript you just pass it</span> <span data-start="1423.46" data-end="1425.5">to integers and things are hooked up</span> <span data-start="1425.5" data-end="1428.32">properly can create a new processor by</span> <span data-start="1428.32" data-end="1430.51">doing a processor class and you can call</span> <span data-start="1430.51" data-end="1433.75">methods on them as expected for</span> <span data-start="1433.75" data-end="1438.25">comparison here's the C++ code pretty</span> <span data-start="1438.25" data-end="1440.47">much the same so the idea with the</span> <span data-start="1440.47" data-end="1444.19">bindings the thing is that it lets you</span> <span data-start="1444.19" data-end="1448.02">use those those cephas clough classes in</span> <span data-start="1448.02" data-end="1450.549">javascript in a way that really keeps</span> <span data-start="1450.549" data-end="1452.529">the high level interface there so you</span> <span data-start="1452.529" data-end="1454.059">can really use these as a library</span> <span data-start="1454.059" data-end="1455.73">without needing to mess with any</span> <span data-start="1455.73" data-end="1460.38">ugliness of the low-level compiled code</span> <span data-start="1460.38" data-end="1465.909">few words about the this binding API so</span> <span data-start="1465.909" data-end="1469.059">when you do new class and so forth of</span> <span data-start="1469.059" data-end="1470.679">course you don't get a C++ object</span> <span data-start="1470.679" data-end="1472.899">because you can't access that in</span> </p>
<p><span data-start="1472.899" data-end="1474.7">JavaScript you don't want to it returns</span> <span data-start="1474.7" data-end="1477.61">and said a rapper object which encloses</span> <span data-start="1477.61" data-end="1480.1">the pointer to the data on the heap and</span> <span data-start="1480.1" data-end="1482.86">so forth it has wrapper functions on it</span> <span data-start="1482.86" data-end="1485.679">that convert arguments and make sure</span> <span data-start="1485.679" data-end="1488.2">everything works so 5 a number typically</span> <span data-start="1488.2" data-end="1490.51">doesn't need any conversion but if other</span> <span data-start="1490.51" data-end="1491.679">inch there's an instance of a class</span> <span data-start="1491.679" data-end="1494.08">it'll translate that into a pointer and</span> <span data-start="1494.08" data-end="1496.929">again it does that for you automatically</span> <span data-start="1496.929" data-end="1499.75">so you don't need to mess with it there</span> <span data-start="1499.75" data-end="1503.309">are however some limitations so</span> <span data-start="1503.309" data-end="1505.83">basically the issue is that JavaScript</span> <span data-start="1505.83" data-end="1507.629">and C++ are not the same language their</span> <span data-start="1507.629" data-end="1508.98">semantics are different again we saw</span> <span data-start="1508.98" data-end="1511.259">this a bit before so they don't match</span> <span data-start="1511.259" data-end="1514.409">perfectly for example when you create an</span> <span data-start="1514.409" data-end="1518.999">instance you must destroy it manually</span> <span data-start="1518.999" data-end="1522.48">the reason is that while doing new class</span> <span data-start="1522.48" data-end="1525.09">creates an instance and of course it'll</span> <span data-start="1525.09" data-end="1529.08">be GC at some point the compiled code is</span> <span data-start="1529.08" data-end="1531.029">no way to tell when that object was G</span> <span data-start="1531.029" data-end="1532.86">see if we could know that we would</span> <span data-start="1532.86" data-end="1536.19">destroy the C++ objects at that point in</span> <span data-start="1536.19" data-end="1539.34">time but we can't so you need to do the</span> <span data-start="1539.34" data-end="1541.379">destroy manually so this is a bit</span> <span data-start="1541.379" data-end="1542.49">cumbersome and there are a few other</span> <span data-start="1542.49" data-end="1544.98">technical issues that I don't want to</span> <span data-start="1544.98" data-end="1546.45">waste time I'm talking about but again</span> <span data-start="1546.45" data-end="1547.86">the issue is that the languages do not</span> <span data-start="1547.86" data-end="1550.44">match up perfectly so while you can</span> <span data-start="1550.44" data-end="1553.129">write code that for the most part is</span> <span data-start="1553.129" data-end="1557.549">pretty natural and close to the C++ it's</span> <span data-start="1557.549" data-end="1558.99">definitely not perfect there are some</span> <span data-start="1558.99" data-end="1562.289">limits some can be fixed but it'll never</span> <span data-start="1562.289" data-end="1567.389">be a hundred percent identical so just</span> <span data-start="1567.389" data-end="1572.19">to summarize the section about using the</span> <span data-start="1572.19" data-end="1575.85">project so the product works well on a</span> <span data-start="1575.85" data-end="1579.269">lot of real world code this is we've not</span> <span data-start="1579.269" data-end="1581.159">been interested in working just on</span> <span data-start="1581.159" data-end="1583.71">benchmarks but on actual code so we've</span> <span data-start="1583.71" data-end="1585.99">ported things like doom which sadly they</span> <span data-start="1585.99" data-end="1588.08">sent to dmca so we had to take it down</span> <span data-start="1588.08" data-end="1591.809">hey so do them the popular game zelia</span> <span data-start="1591.809" data-end="1597.36">compression a popular a PDF renderer</span> <span data-start="1597.36" data-end="1601.58">open jpeg codec for jpeg 2000 images</span> <span data-start="1601.58" data-end="1605.279">which actually i can show you locally i</span> <span data-start="1605.279" data-end="1616.99">believe yeah open jpg</span> <span data-start="1617" data-end="1623.07">so and that's a JPEG 2000 rendered to a</span> <span data-start="1623.07" data-end="1625.41">canvas element so this is a file format</span> <span data-start="1625.41" data-end="1627.06">not recognized by the browser in the</span> <span data-start="1627.06" data-end="1629.49">native way but entirely in JavaScript it</span> <span data-start="1629.49" data-end="1632.12">was translated into a canvas image</span> <span data-start="1632.12" data-end="1636.78">basically and getting back to that free</span> <span data-start="1636.78" data-end="1638.94">type which renders fonts and as already</span> <span data-start="1638.94" data-end="1641.04">mentioned bullets equal I Python Ruby</span> </p>
<p><span data-start="1641.04" data-end="1644.85">Lua so this works on real world code but</span> <span data-start="1644.85" data-end="1646.77">again just to just a caveat about that</span> <span data-start="1646.77" data-end="1649.17">this is for the compiler which generates</span> <span data-start="1649.17" data-end="1651.9">working code the binding stuff which</span> <span data-start="1651.9" data-end="1654.48">makes the code very easy to use is very</span> <span data-start="1654.48" data-end="1656.97">new and obviously less mature so don't</span> <span data-start="1656.97" data-end="1660.35">expect that to work out of the box as is</span> <span data-start="1660.35" data-end="1664.08">two last points that I think I should</span> <span data-start="1664.08" data-end="1666.45">make to port a library to JavaScript you</span> <span data-start="1666.45" data-end="1668.07">do need to know the original language</span> <span data-start="1668.07" data-end="1670.8">that you're translating it's not a one</span> <span data-start="1670.8" data-end="1672.48">hundred percent automatic process that</span> <span data-start="1672.48" data-end="1674.31">you just push a button and you get some</span> <span data-start="1674.31" data-end="1677.82">code there are a few cases they're rare</span> <span data-start="1677.82" data-end="1678.75">but there are a few cases where you</span> <span data-start="1678.75" data-end="1680.91">might need to modify the original source</span> <span data-start="1680.91" data-end="1683.55">code so you really do need to know the</span> <span data-start="1683.55" data-end="1685.89">language if only just to know that the</span> <span data-start="1685.89" data-end="1688.32">false positives that it that warnings</span> <span data-start="1688.32" data-end="1689.43">that it mentions to you are false</span> <span data-start="1689.43" data-end="1691.89">positives so you can't just compile</span> <span data-start="1691.89" data-end="1694.38">something you don't understand we can</span> <span data-start="1694.38" data-end="1696.15">make this better but right now it's</span> <span data-start="1696.15" data-end="1699.96">definitely not there and while</span> <span data-start="1699.96" data-end="1701.16">generating working code is</span> <span data-start="1701.16" data-end="1704.25">straightforward in optimizing the code</span> <span data-start="1704.25" data-end="1706.17">to get to maximum speed takes additional</span> <span data-start="1706.17" data-end="1708.84">manual effort so again this is something</span> <span data-start="1708.84" data-end="1710.7">that we can definitely fix but at this</span> <span data-start="1710.7" data-end="1713.07">point you can get code to work typically</span> <span data-start="1713.07" data-end="1716.1">fast optimizing it to maximum speed will</span> <span data-start="1716.1" data-end="1721.44">take more work okay I have just a few</span> <span data-start="1721.44" data-end="1723.57">more slides but I should address some</span> <span data-start="1723.57" data-end="1726.57">something about speed so you might be</span> <span data-start="1726.57" data-end="1728.46">thinking isn't this terribly slow this</span> <span data-start="1728.46" data-end="1731.01">is JavaScript don't we need native apps</span> </p>
<p><span data-start="1731.01" data-end="1733.95">Native Client dart Java flash if you</span> <span data-start="1733.95" data-end="1736.88">can't read the rest doesn't matter</span> <span data-start="1736.88" data-end="1739.08">don't we need these other things that</span> <span data-start="1739.08" data-end="1741.57">are fast then isn't there are some</span> <span data-start="1741.57" data-end="1743.46">problem that even if you get this code</span> <span data-start="1743.46" data-end="1745.34">onto the web it'll just run too slowly</span> <span data-start="1745.34" data-end="1747.84">so I think there are sort of two parts</span> <span data-start="1747.84" data-end="1749.16">to this question the first part is</span> <span data-start="1749.16" data-end="1752.01">whether JavaScript itself is fast enough</span> <span data-start="1752.01" data-end="1753.179">for not a night we had to talk</span> <span data-start="1753.179" data-end="1755.46">previously I think we know that by now</span> <span data-start="1755.46" data-end="1758.91">javascript is fast enough but on the</span> <span data-start="1758.91" data-end="1761.16">other hand perhaps this compiler method</span> <span data-start="1761.16" data-end="1763.14">generates code that is not a match to</span> <span data-start="1763.14" data-end="1765.03">what Jess engines are optimizing for</span> <span data-start="1765.03" data-end="1767.97">were compiled a low-level bit code maybe</span> <span data-start="1767.97" data-end="1769.919">it ends up just being very very slow</span> <span data-start="1769.919" data-end="1772.41">even though it does work so the answer</span> <span data-start="1772.41" data-end="1776.1">is no this actually isn't slow there are</span> <span data-start="1776.1" data-end="1779.52">some numbers here they are all in time</span> <span data-start="1779.52" data-end="1782.16">slower than GCC dash 0 3 which means</span> <span data-start="1782.16" data-end="1786.96">that one is actual GCC native code and</span> <span data-start="1786.96" data-end="1788.429">these numbers are all for spider monkey</span> <span data-start="1788.429" data-end="1793.5">and ta means typed arrays so most of the</span> <span data-start="1793.5" data-end="1796.2">numbers especially over here in the</span> <span data-start="1796.2" data-end="1798.63">typed array area are not bad at all</span> <span data-start="1798.63" data-end="1800.549">between two times slower than native</span> <span data-start="1800.549" data-end="1802.26">code and five times slower than native</span> <span data-start="1802.26" data-end="1805.799">code with this one sort of more</span> <span data-start="1805.799" data-end="1808.89">depressing test but overall these are</span> <span data-start="1808.89" data-end="1811.59">not too bad I would say in addition a</span> <span data-start="1811.59" data-end="1813.63">one of the faster ones dl malik is</span> <span data-start="1813.63" data-end="1815.7">actually not just a benchmark these</span> <span data-start="1815.7" data-end="1818.07">other ones are benchmarks some some of</span> <span data-start="1818.07" data-end="1821.52">them are well-known some not but dl</span> <span data-start="1821.52" data-end="1823.5">malik is actually real world code it's a</span> <span data-start="1823.5" data-end="1825.57">malik implementation used in a lot of</span> <span data-start="1825.57" data-end="1828.27">places so the results are not bad i</span> <span data-start="1828.27" data-end="1831.96">would argue to look at data from a</span> <span data-start="1831.96" data-end="1834.51">different perspective so the computer</span> <span data-start="1834.51" data-end="1837.84">language that shootout benchmark site at</span> <span data-start="1837.84" data-end="1841.23">thalia that debian compares a lot of</span> <span data-start="1841.23" data-end="1843.09">languages so all these all the numbers</span> <span data-start="1843.09" data-end="1846.03">here are again times slower than native</span> <span data-start="1846.03" data-end="1848.549">code and you can see obviously by</span> <span data-start="1848.549" data-end="1851.07">definition C and C++ on top are all</span> <span data-start="1851.07" data-end="1854.76">lungs Java pretty close but there are</span> <span data-start="1854.76" data-end="1856.919">some places where it doesn't quite get</span> <span data-start="1856.919" data-end="1859.32">to native speed skala Haskell and</span> <span data-start="1859.32" data-end="1861.09">c-sharp are also fairly close and on the</span> <span data-start="1861.09" data-end="1864.22">bottom you have Python and Ruby dynamic</span> <span data-start="1864.22" data-end="1867.57">things which are not so fast and</span> </p>
<p><span data-start="1867.57" data-end="1869.38">JavaScript in the middle here this is</span> <span data-start="1869.38" data-end="1873.13">our data not from the shootout I think</span> <span data-start="1873.13" data-end="1874.39">it's fair that the numbers you are much</span> <span data-start="1874.39" data-end="1876.25">closer to the languages on top then the</span> <span data-start="1876.25" data-end="1879.61">languages on bottom so I think</span> <span data-start="1879.61" data-end="1881.28">definitely the speed is in a good place</span> <span data-start="1881.28" data-end="1884.409">and also this is without JavaScript</span> <span data-start="1884.409" data-end="1887.11">engines optimizing for it at all there</span> <span data-start="1887.11" data-end="1888.82">are a few minor things that if they did</span> <span data-start="1888.82" data-end="1890.5">they could run this specific type of</span> <span data-start="1890.5" data-end="1892.48">code much faster so things are</span> <span data-start="1892.48" data-end="1893.95">definitely good reason to believe we can</span> <span data-start="1893.95" data-end="1897.46">get very very very very close to native</span> <span data-start="1897.46" data-end="1902.919">code but some notes about that so this</span> <span data-start="1902.919" data-end="1904.87">be can vary greatly between benchmarks</span> <span data-start="1904.87" data-end="1908.409">we saw that on the data here from two to</span> <span data-start="1908.409" data-end="1911.77">eight and a half it's not consistent</span> <span data-start="1911.77" data-end="1913.419">like you see and see where you pretty</span> <span data-start="1913.419" data-end="1914.77">much know the performance of the code</span> <span data-start="1914.77" data-end="1916.539">that you write least it's simple enough</span> <span data-start="1916.539" data-end="1919.69">and Java which had a range of 123 but at</span> <span data-start="1919.69" data-end="1921.64">least it's pretty contained so here we</span> <span data-start="1921.64" data-end="1924.64">have non predictability which is</span> <span data-start="1924.64" data-end="1926.409">problematic for performance especially</span> <span data-start="1926.409" data-end="1928.299">since we have multiple browsers with</span> <span data-start="1928.299" data-end="1931.02">different j/s engines so you have</span> <span data-start="1931.02" data-end="1935.2">unexpected speeds in many cases issue 2</span> <span data-start="1935.2" data-end="1936.909">we have bugs in JavaScript engines that</span> <span data-start="1936.909" data-end="1939.299">often just lead to slowness for example</span> <span data-start="1939.299" data-end="1942.37">the memory space the heap variable that</span> </p>
<p><span data-start="1942.37" data-end="1945.19">I mentioned which represents memory so</span> <span data-start="1945.19" data-end="1947.14">basically every read and write ends up</span> <span data-start="1947.14" data-end="1949.51">being an access of this large JavaScript</span> <span data-start="1949.51" data-end="1952.21">array if that's not fully optimized so</span> <span data-start="1952.21" data-end="1954.46">that every read from it is a literal</span> <span data-start="1954.46" data-end="1956.38">rate from memory and a right to it as</span> <span data-start="1956.38" data-end="1958.78">literal right to memory if you need to</span> <span data-start="1958.78" data-end="1960.28">do any additional work for example if</span> <span data-start="1960.28" data-end="1964">the heap is implemented as a hashed as a</span> <span data-start="1964" data-end="1967.48">hashmap it'll be very very slow so there</span> <span data-start="1967.48" data-end="1968.83">are cases where chance engines get</span> <span data-start="1968.83" data-end="1970">confused and they decide to implement</span> <span data-start="1970" data-end="1974.86">the heap in a slow way also jess engines</span> <span data-start="1974.86" data-end="1976.87">have typically been optimized for fairly</span> <span data-start="1976.87" data-end="1979.09">small benchmarks and also caught on the</span> <span data-start="1979.09" data-end="1980.59">web was typically quite small they've</span> <span data-start="1980.59" data-end="1982.059">not been optimized for very large</span> <span data-start="1982.059" data-end="1985.36">scripts but here we're compiling 10 20</span> <span data-start="1985.36" data-end="1988.03">megabytes of C++ code and dumping it on</span> <span data-start="1988.03" data-end="1991.57">the web so that raises some issues that</span> <span data-start="1991.57" data-end="1993.399">need to be fixed but again these are</span> <span data-start="1993.399" data-end="1996.39">bugs and hopefully will be resolved</span> <span data-start="1996.39" data-end="1998.31">and on the other hand we have a lot of</span> <span data-start="1998.31" data-end="2001.52">things in new features and chess engines</span> <span data-start="2001.52" data-end="2004.37">that are making code run faster so so</span> <span data-start="2004.37" data-end="2008.05">type inference as I say optimizations</span> <span data-start="2008.05" data-end="2010.49">also as I said earlier it's possible</span> <span data-start="2010.49" data-end="2011.6">that jazz engines could optimize</span> <span data-start="2011.6" data-end="2014.15">specifically for this type of code so if</span> <span data-start="2014.15" data-end="2016.1">all that put together I I would argue</span> <span data-start="2016.1" data-end="2018.22">that we're not quite at the speed of</span> <span data-start="2018.22" data-end="2021.32">native code yet but we are getting quite</span> <span data-start="2021.32" data-end="2025.76">close finally I'll leave you with</span> <span data-start="2025.76" data-end="2030.35">thought about the future so imagine that</span> <span data-start="2030.35" data-end="2031.82">you could just write this this is</span> <span data-start="2031.82" data-end="2036.11">harmony module syntax module it see from</span> <span data-start="2036.11" data-end="2038.6">someplace import printf printf hello</span> <span data-start="2038.6" data-end="2040.37">world but imagine that you could do this</span> <span data-start="2040.37" data-end="2043.64">for any library in any language so</span> </p>
<p><span data-start="2043.64" data-end="2045.95">JavaScript basically basically becomes a</span> <span data-start="2045.95" data-end="2051.47">universal a language or environment I</span> <span data-start="2051.47" data-end="2053.149">guess where everything can be compiled</span> <span data-start="2053.149" data-end="2056.57">into it and because of that JavaScript</span> <span data-start="2056.57" data-end="2059.149">can use any code that exists anywhere</span> <span data-start="2059.149" data-end="2061.61">just compiled to JavaScript and use it</span> <span data-start="2061.61" data-end="2064.399">in a convenient way so I think this</span> <span data-start="2064.399" data-end="2066.83">could really be very very beneficial for</span> <span data-start="2066.83" data-end="2069.58">us on the web and again as an example</span> <span data-start="2069.58" data-end="2072.32">just sort of as a follow up for the what</span> <span data-start="2072.32" data-end="2075.23">I mentioned before about audio we can</span> <span data-start="2075.23" data-end="2079.31">compile an entire audio library to C++</span> <span data-start="2079.31" data-end="2082.22">to JavaScript and use that instead of</span> <span data-start="2082.22" data-end="2085.55">waiting for some web a peep from for a</span> </p>
<p><span data-start="2085.55" data-end="2088.94">Web Audio API to be standardized the</span> <span data-start="2088.94" data-end="2090.74">ability to use any code that we won on</span> <span data-start="2090.74" data-end="2093.169">the web could really help us do whatever</span> <span data-start="2093.169" data-end="2094.909">we want on the web which i think is a</span> <span data-start="2094.909" data-end="2115.29">good thing yeah that's it</span> <span data-start="2115.3" data-end="2122.15">questions and flow this is like crazy</span> <span data-start="2122.15" data-end="2124.94">powerful it's cool so my first question</span> <span data-start="2124.94" data-end="2127.25">was more about the kind of F open</span> <span data-start="2127.25" data-end="2128.63">support you know the kind of like</span> <span data-start="2128.63" data-end="2130.099">standard file operations where you said</span> <span data-start="2130.099" data-end="2133.4">you mapped it to xml httprequest I mean</span> <span data-start="2133.4" data-end="2134.71">are they synchronous or asynchronous</span> <span data-start="2134.71" data-end="2137.119">well you could you could do it both ways</span> <span data-start="2137.119" data-end="2140.75">you could do it but so it's asynchronous</span> <span data-start="2140.75" data-end="2142.58">then you would need some way for the</span> <span data-start="2142.58" data-end="2145.07">compiled code to know when they when</span> <span data-start="2145.07" data-end="2146.45">they arrived which would mean you would</span> <span data-start="2146.45" data-end="2148.64">be creating a little API in C++ that is</span> <span data-start="2148.64" data-end="2151.58">not part of standard IOH right but the</span> <span data-start="2151.58" data-end="2153.14">standard one is just synchronous the</span> <span data-start="2153.14" data-end="2154.25">standard one is synchronous so the</span> <span data-start="2154.25" data-end="2155.48">information we have now is synchronous</span> <span data-start="2155.48" data-end="2157.07">yes but there's nothing stopping you</span> <span data-start="2157.07" data-end="2159.14">again from implementing a tiny addition</span> <span data-start="2159.14" data-end="2160.58">to standard ayah which would be</span> <span data-start="2160.58" data-end="2163.97">asynchronous and we are I there is a</span> <span data-start="2163.97" data-end="2166.869">little header which adds a few functions</span> <span data-start="2166.869" data-end="2169.369">right now like for example it can that</span> <span data-start="2169.369" data-end="2172.55">you basically run any script from C++</span> <span data-start="2172.55" data-end="2176.24">code just by doing eval well so you can</span> <span data-start="2176.24" data-end="2178.7">you can bridge both ways and you can</span> <span data-start="2178.7" data-end="2180.2">definitely get a synchronous behavior if</span> <span data-start="2180.2" data-end="2181.19">you want but again it would be an</span> <span data-start="2181.19" data-end="2184.01">extension of the standard c-suite yeah</span> <span data-start="2184.01" data-end="2185.06">there's an eye meter that was the thing</span> </p>
<p><span data-start="2185.06" data-end="2187.339">I worried about ya so I kind of one more</span> <span data-start="2187.339" data-end="2190.22">question sorry about is um right is</span> <span data-start="2190.22" data-end="2192.29">anyone right in the kind of the the</span> <span data-start="2192.29" data-end="2195.07">wrapper for a web-like OpenGL to WebGL</span> <span data-start="2195.07" data-end="2197.66">yes I mean we can get so many games on</span> <span data-start="2197.66" data-end="2199.4">the web then yes I would be extremely</span> <span data-start="2199.4" data-end="2201.26">happy to have that so a few words about</span> <span data-start="2201.26" data-end="2205.01">that there is an a so first of all a</span> <span data-start="2205.01" data-end="2207.71">this project is fully open source of</span> <span data-start="2207.71" data-end="2209.48">course it's on github etc there is a</span> <span data-start="2209.48" data-end="2212.089">closed source project called Mandrell</span> <span data-start="2212.089" data-end="2214.88">which it's it uses some amount of code</span> <span data-start="2214.88" data-end="2216.56">from this project which I only know</span> <span data-start="2216.56" data-end="2217.849">because if you look at the compiled code</span> <span data-start="2217.849" data-end="2219.53">that they generate you can actually see</span> <span data-start="2219.53" data-end="2223.07">bits of this in there however they they</span> <span data-start="2223.07" data-end="2224.66">say that they wrote a compiler entirely</span> <span data-start="2224.66" data-end="2227.42">from scratch so I'm not entirely sure</span> <span data-start="2227.42" data-end="2229.43">where the truth is but anyhow my point</span> <span data-start="2229.43" data-end="2231.619">is they have what you just asked about</span> <span data-start="2231.619" data-end="2233.839">yeah they have a compiler for OpenGL to</span> </p>
<p><span data-start="2233.839" data-end="2236.03">WebGL I have no idea how it works it's</span> <span data-start="2236.03" data-end="2238.22">closed source but they have some demos</span> <span data-start="2238.22" data-end="2241.099">of games just compiled to WebGL yeah I'm</span> <span data-start="2241.099" data-end="2243.23">myself not in OpenGL hacker so I don't</span> <span data-start="2243.23" data-end="2243.859">know but I would</span> <span data-start="2243.859" data-end="2247.64">love to get help in doing this and the</span> <span data-start="2247.64" data-end="2248.869">fact that there's a close thing that</span> <span data-start="2248.869" data-end="2250.549">does it I think shows it it's possible</span> <span data-start="2250.549" data-end="2253.22">yeah it'll be awesome I mean we coo coo</span> <span data-start="2253.22" data-end="2264.44">thank you</span> <span data-start="2264.45" data-end="2267.01">so the performance numbers you showed</span> <span data-start="2267.01" data-end="2270.43">are basically I assume based on like a</span> <span data-start="2270.43" data-end="2272.74">couple of runs right oh sure yeah yeah I</span> <span data-start="2272.74" data-end="2275.17">mean they have reached right so I was</span> <span data-start="2275.17" data-end="2276.52">wondering about to start up dying</span> <span data-start="2276.52" data-end="2278.02">because I assume these funds are kind of</span> <span data-start="2278.02" data-end="2280.87">large and I mean the thing that killed</span> <span data-start="2280.87" data-end="2282.97">and one of the thing that killed Java</span> <span data-start="2282.97" data-end="2285.52">applets was startup night so in an issue</span> <span data-start="2285.52" data-end="2288.58">well yes I mean if you look 10 megabytes</span> <span data-start="2288.58" data-end="2290.35">of JavaScript code just the parsing</span> <span data-start="2290.35" data-end="2293.77">takes some amount of time and depending</span> <span data-start="2293.77" data-end="2296.95">on the engine there were there bugs and</span> <span data-start="2296.95" data-end="2298.81">all the engines about trying to compile</span> <span data-start="2298.81" data-end="2300.13">code to eagerly but they're getting</span> <span data-start="2300.13" data-end="2301.74">better about them so they don't optimize</span> <span data-start="2301.74" data-end="2305.23">too early so yes there is some startup</span> <span data-start="2305.23" data-end="2309.19">issue probably not represented in these</span> <span data-start="2309.19" data-end="2311.08">tests because they were all designed to</span> <span data-start="2311.08" data-end="2313.48">run for a reasonable amount of time so</span> <span data-start="2313.48" data-end="2316.6">if it tests takes just the one one</span> <span data-start="2316.6" data-end="2318.58">millisecond in C in C it's not</span> <span data-start="2318.58" data-end="2320.14">reasonable to compare it to anything so</span> </p>
<p><span data-start="2320.14" data-end="2321.64">I think most of these run at about one</span> <span data-start="2321.64" data-end="2325.41">second and see so startup is pretty much</span> <span data-start="2325.41" data-end="2328.03">eliminated but there is some amount of</span> <span data-start="2328.03" data-end="2329.92">startup issue yes and it'll be hard to</span> <span data-start="2329.92" data-end="2336.54">eliminate entirely</span> <span data-start="2336.55" data-end="2340.3">how viable would it be to say use a</span> <span data-start="2340.3" data-end="2344.93">javascript library of GCC compiled with</span> <span data-start="2344.93" data-end="2349.58">em script at javascript library yeah it</span> <span data-start="2349.58" data-end="2351.8">like create a JavaScript library with</span> <span data-start="2351.8" data-end="2358.67">and script ug sorry GCC gpg I jpg I</span> <span data-start="2358.67" data-end="2360.23">would like to say I would like to have</span> <span data-start="2360.23" data-end="2362.96">gpg in java and i would like to compile</span> <span data-start="2362.96" data-end="2365.45">it with em script how viable would it be</span> <span data-start="2365.45" data-end="2367.37">to means that in production is it fast</span> <span data-start="2367.37" data-end="2370.73">enough I mean this I mean I I would</span> <span data-start="2370.73" data-end="2372.86">assume yes unless there's some technical</span> <span data-start="2372.86" data-end="2376.31">detail to the implementation mg of gpg</span> <span data-start="2376.31" data-end="2378.02">that I'm not aware of but it's pretty</span> <span data-start="2378.02" data-end="2381.29">typical it right there dig if they don't</span> <span data-start="2381.29" data-end="2383.12">use any magical so you would go to</span> <span data-start="2383.12" data-end="2385.49">reduction with something like that what</span> </p>
<p><span data-start="2385.49" data-end="2386.9">I think it could work yes I haven't</span> <span data-start="2386.9" data-end="2388.88">actually tried it but I don't see any</span> <span data-start="2388.88" data-end="2408.72">reason why not</span> <span data-start="2408.73" data-end="2410.86">hi I was wondering what the memory use</span> <span data-start="2410.86" data-end="2414.1">is like let's say I have a 100k lightly</span> <span data-start="2414.1" data-end="2416.32">as a library that would generate hundred</span> <span data-start="2416.32" data-end="2418.48">K of native code how big does the</span> <span data-start="2418.48" data-end="2420.79">javascript file end up being to download</span> <span data-start="2420.79" data-end="2422.59">and and how much memory is it going to</span> <span data-start="2422.59" data-end="2425.08">take in the browser when it runs and it</span> <span data-start="2425.08" data-end="2429.19">ends up after run it through through a</span> <span data-start="2429.19" data-end="2433.45">min afire it ends up similar size to the</span> <span data-start="2433.45" data-end="2436.54">native code x actually may be a factor</span> <span data-start="2436.54" data-end="2438.72">of one and a half or so but it's not</span> <span data-start="2438.72" data-end="2442.66">ridiculously low it large but after you</span> <span data-start="2442.66" data-end="2445.03">run gzip on it assuming your website she</span> <span data-start="2445.03" data-end="2446.59">sips everything it basically ends up the</span> <span data-start="2446.59" data-end="2450.19">same size so in terms of that in terms</span> <span data-start="2450.19" data-end="2451.96">of code size I think it's very</span> <span data-start="2451.96" data-end="2454.48">comparable to native code as far as the</span> <span data-start="2454.48" data-end="2457.33">amount of memory it takes a the amount</span> <span data-start="2457.33" data-end="2460.3">of memory that compiled code takes it</span> <span data-start="2460.3" data-end="2462.64">depends on the jas engine I don't know</span> <span data-start="2462.64" data-end="2465.16">actual numbers the amount of memory</span> <span data-start="2465.16" data-end="2468.16">taken at runtime so actually as a slide</span> <span data-start="2468.16" data-end="2471.19">here shows there there are a few options</span> <span data-start="2471.19" data-end="2474.01">there like then getting to almost any of</span> <span data-start="2474.01" data-end="2475.18">the technical details but there are a</span> <span data-start="2475.18" data-end="2477.64">few ways to generate code one of the</span> <span data-start="2477.64" data-end="2479.71">ways uses typed arrays with a shared</span> <span data-start="2479.71" data-end="2482.2">memory buffer in which case the amount</span> <span data-start="2482.2" data-end="2483.97">of memory you would use at runtime again</span> <span data-start="2483.97" data-end="2485.86">aside for code the amount of memory for</span> <span data-start="2485.86" data-end="2487.6">data would be a hundred percent</span> <span data-start="2487.6" data-end="2489.97">identical to C++ because you be using a</span> <span data-start="2489.97" data-end="2492.31">typed array that's literally the same</span> <span data-start="2492.31" data-end="2496.06">thing so you can use a very similar</span> <span data-start="2496.06" data-end="2497.92">amount of memory in this as to the</span> <span data-start="2497.92" data-end="2503.38">native code version hi so um you you</span> <span data-start="2503.38" data-end="2507.52">compile the sea I mean lvm compiled the</span> </p>
<p><span data-start="2507.52" data-end="2511.41">C or C++ to bytecode to lv my code and</span> <span data-start="2511.41" data-end="2514.36">you can buy this bytecode to to</span> <span data-start="2514.36" data-end="2516.64">JavaScript yes by doing that apparently</span> <span data-start="2516.64" data-end="2518.62">you lose viable names and you have some</span> <span data-start="2518.62" data-end="2521.62">sort of ritual reverse-engineering to do</span> <span data-start="2521.62" data-end="2526.05">too yes recreate while oops why not</span> <span data-start="2526.05" data-end="2529.75">compiling directly from C or C++ using</span> <span data-start="2529.75" data-end="2534.64">ceiling or and yes I mean that was one</span> <span data-start="2534.64" data-end="2537.37">one approach for this compiling see</span> <span data-start="2537.37" data-end="2539.2">directly would probably be pretty</span> <span data-start="2539.2" data-end="2540.43">reasonable</span> <span data-start="2540.43" data-end="2544.44">but C++ is horribly complicated to parse</span> <span data-start="2544.44" data-end="2546.57">ridiculously complicated I</span> <span data-start="2546.57" data-end="2549.16">underestimated its you don't want to</span> <span data-start="2549.16" data-end="2552.16">write it write that from stretch it took</span> <span data-start="2552.16" data-end="2554.56">ceilings several years of intensive</span> <span data-start="2554.56" data-end="2556.18">effort to get to the point where now it</span> <span data-start="2556.18" data-end="2559.36">can compile most C++ code so that's</span> <span data-start="2559.36" data-end="2562.27">simply too much work to do but second</span> <span data-start="2562.27" data-end="2565.36">point by compiling the bit code you can</span> <span data-start="2565.36" data-end="2567.07">potentially compile many more languages</span> <span data-start="2567.07" data-end="2569.47">if you get Haskell to compile to hell</span> <span data-start="2569.47" data-end="2571.12">via a bit code which I believe it can</span> <span data-start="2571.12" data-end="2572.5">there's no reason why you couldn't</span> <span data-start="2572.5" data-end="2574.96">compile that into JavaScript too so</span> <span data-start="2574.96" data-end="2576.73">there's also a benefit from that and</span> <span data-start="2576.73" data-end="2580.21">third part to the answer yes there is a</span> <span data-start="2580.21" data-end="2582.31">lot of additional work to get back at</span> <span data-start="2582.31" data-end="2584.8">the high level data that you lost but I</span> <span data-start="2584.8" data-end="2587.2">think we're pretty close to getting</span> <span data-start="2587.2" data-end="2589.09">there so it is much more feasible to do</span> <span data-start="2589.09" data-end="2595.84">that then to compile the C++ hi um I was</span> <span data-start="2595.84" data-end="2597.76">wondering are you modifying the native</span> <span data-start="2597.76" data-end="2599.44">code to not depend on integer overflow</span> <span data-start="2599.44" data-end="2601.93">are you actually clipping every integer</span> <span data-start="2601.93" data-end="2605.29">after every operation and first of all</span> <span data-start="2605.29" data-end="2607.27">it would be better if you would modify</span> <span data-start="2607.27" data-end="2609.91">than the original source code to not</span> <span data-start="2609.91" data-end="2612.01">rely and overflows etc but that's not</span> <span data-start="2612.01" data-end="2618.63">realistic so yeah very briefly to get</span> <span data-start="2618.63" data-end="2621.28">precise behavior you do need to do</span> <span data-start="2621.28" data-end="2624.01">clipping and so forth and I think I have</span> <span data-start="2624.01" data-end="2625.48">a slight which mentions a few of the</span> <span data-start="2625.48" data-end="2628.33">issues there overflows also signs and</span> <span data-start="2628.33" data-end="2632.95">rounding part of the reason why getting</span> <span data-start="2632.95" data-end="2634.99">optimized code takes time is that the</span> <span data-start="2634.99" data-end="2637.66">default setting will perform that</span> <span data-start="2637.66" data-end="2639.43">clipping and sign correction etc on</span> <span data-start="2639.43" data-end="2641.5">every line of code which makes it very</span> <span data-start="2641.5" data-end="2644.8">slow but the optimizer can do sort of</span> <span data-start="2644.8" data-end="2647.17">like like pgo it can basically run the</span> <span data-start="2647.17" data-end="2649.54">code see where it actually needs to do</span> <span data-start="2649.54" data-end="2652.15">those Corrections generate a profile and</span> <span data-start="2652.15" data-end="2654.04">then compile it with that and only</span> <span data-start="2654.04" data-end="2655.98">perform the corrections where necessary</span> <span data-start="2655.98" data-end="2658.81">so the right way to get fast before my</span> <span data-start="2658.81" data-end="2660.19">code is either to modify the original</span> <span data-start="2660.19" data-end="2662.44">source so it doesn't need it or to do</span> <span data-start="2662.44" data-end="2664.69">this pgo like thing which is a tool that</span> <span data-start="2664.69" data-end="2666.58">comes with a compile that basically gets</span> <span data-start="2666.58" data-end="2670.57">you to the same place I hope that makes</span> </p>
</section>