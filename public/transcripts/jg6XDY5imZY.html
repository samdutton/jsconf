<section>
<p><span data-start="18.17" data-end="21.75">good afternoon are we talking about</span> <span data-start="21.75" data-end="24.98">emulating gaming consoles of JavaScript</span> <span data-start="24.98" data-end="28.23">so Who am I on this guy named Alexander</span> <span data-start="28.23" data-end="30.66">Dixon I've got a Twitter like some</span> <span data-start="30.66" data-end="33.92">people do I'm not an emulation expert so</span> <span data-start="33.92" data-end="35.88">there's that one here written an</span> <span data-start="35.88" data-end="40.559">emulator for yep should probably come up</span> <span data-start="40.559" data-end="44.04">here and finish this for me so I'm a</span> <span data-start="44.04" data-end="46.079">developer atlassian which you may know</span> <span data-start="46.079" data-end="50.09">that make bitbucket 0 you might use them</span> <span data-start="50.09" data-end="53.85">so so let's do our JavaScript today it's</span> <span data-start="53.85" data-end="55.739">pretty fast which is always good when</span> <span data-start="55.739" data-end="56.7">you want to write something like an</span> <span data-start="56.7" data-end="58.829">emulator it's got really awesome browser</span> <span data-start="58.829" data-end="62.52">api's the inputs and outputs you can get</span> <span data-start="62.52" data-end="65.28">are pretty awesome so let's talk about</span> <span data-start="65.28" data-end="67.53">them we have the canvas element Web</span> </p>
<p><span data-start="67.53" data-end="70.71">Audio API gamepad API type to raise</span> <span data-start="70.71" data-end="73.89">quite performant things for animation</span> <span data-start="73.89" data-end="76.409">like requestanimationframe but things we</span> <span data-start="76.409" data-end="78.27">don't have our sane implementations to</span> <span data-start="78.27" data-end="81.81">some of these for example that yeah what</span> <span data-start="81.81" data-end="84.12">I'm what Miguel mentioned earlier is the</span> </p>
<p><span data-start="84.12" data-end="87.12">Firefox gamepad API users events but the</span> <span data-start="87.12" data-end="89.31">WebKit one you have to pull which</span> <span data-start="89.31" data-end="92.549">doesn't isn't always so great so what</span> <span data-start="92.549" data-end="95.61">can we build with all this gear we could</span> <span data-start="95.61" data-end="97.71">build some awesome practical stuff like</span> <span data-start="97.71" data-end="99.03">we've seen earlier you could do</span> <span data-start="99.03" data-end="100.77">something almost complete useless and</span> <span data-start="100.77" data-end="104.22">write an emulator so why would you what</span> <span data-start="104.22" data-end="105.51">would you want to do this when there's</span> <span data-start="105.51" data-end="107.88">problems you could be solving practical</span> <span data-start="107.88" data-end="111.5">problems well because we can of course</span> <span data-start="111.5" data-end="113.729">so you might be wondering what an</span> <span data-start="113.729" data-end="119.34">emulator is so wikipedia tells us so</span> <span data-start="119.34" data-end="120.869">when you won't refer to emulate like</span> <span data-start="120.869" data-end="124.02">this we talk about taking a existing</span> <span data-start="124.02" data-end="126.57">system and implementing in software so</span> <span data-start="126.57" data-end="128.849">the original program so that hardware</span> <span data-start="128.849" data-end="132.81">just work normally and what kind of</span> <span data-start="132.81" data-end="134.909">system can be emulated but the church</span> <span data-start="134.909" data-end="137.25">cheering thesis says that on anything</span> <span data-start="137.25" data-end="140.73">that can be okay anything can be</span> <span data-start="140.73" data-end="144.84">programmed such as a hardware Kimmy can</span> <span data-start="144.84" data-end="146.67">be redone with another language or</span> <span data-start="146.67" data-end="149.22">system basically it says any</span> <span data-start="149.22" data-end="151.05">can be emulated given enough time and</span> <span data-start="151.05" data-end="155.57">memory so there's three major types of</span> <span data-start="155.57" data-end="158.49">highway emulators there's interpreter</span> <span data-start="158.49" data-end="161.43">which runs the system as as the system</span> <span data-start="161.43" data-end="164.25">runs via software there's dynamic</span> <span data-start="164.25" data-end="166.44">recompilation which will take a list of</span> <span data-start="166.44" data-end="168.69">instruction and translate them directly</span> <span data-start="168.69" data-end="170.94">to the top the target machine code and</span> <span data-start="170.94" data-end="173.52">there's static recompilation which is</span> <span data-start="173.52" data-end="175.86">pretty much impossible due to things</span> <span data-start="175.86" data-end="179.46">like self-modifying code and fertile bit</span> <span data-start="179.46" data-end="182.13">emulators they're kind of a bit dodgy</span> <span data-start="182.13" data-end="183.72">from a legal perspective because</span> </p>
<p><span data-start="183.72" data-end="185.55">Nintendo don't really want you to go and</span> <span data-start="185.55" data-end="189.87">make emulators so you can always do at</span> <span data-start="189.87" data-end="192.72">your own risk and use free programs be</span> <span data-start="192.72" data-end="196.89">careful like a mega man so how would you</span> <span data-start="196.89" data-end="199.02">start this journey well you'd have to</span> <span data-start="199.02" data-end="202.59">pick a system of course so you might</span> <span data-start="202.59" data-end="205.65">pick the a Game Boy you have to discover</span> <span data-start="205.65" data-end="207.39">what components that uses such as what</span> <span data-start="207.39" data-end="210.74">chips it uses how its display was driven</span> <span data-start="210.74" data-end="214.23">what inputs it had so then you go find</span> <span data-start="214.23" data-end="215.37">technical information and all those</span> <span data-start="215.37" data-end="217.739">sorts of things and this this is</span> <span data-start="217.739" data-end="221.7">required for formulating it so there's a</span> <span data-start="221.7" data-end="223.5">really basic system called chip 8 and</span> <span data-start="223.5" data-end="227.25">this was a actually a vm and those two</span> <span data-start="227.25" data-end="228.989">back programs most which are games and</span> <span data-start="228.989" data-end="230.73">the great thing that you paid is it's</span> <span data-start="230.73" data-end="232.29">super easy to emulate so it's a great</span> <span data-start="232.29" data-end="237.42">starting point so the cpu limits of</span> <span data-start="237.42" data-end="239.31">instructions the graphics are either on</span> <span data-start="239.31" data-end="242.73">or off there's only one audio sample and</span> <span data-start="242.73" data-end="246.33">it's  so you can you can make</span> <span data-start="246.33" data-end="250.93">it up and we'll give you a look at that</span> <span data-start="250.94" data-end="255.03">so this is a chip a system let's load in</span> <span data-start="255.03" data-end="260.699">a program tank looks good</span> </p>
<p><span data-start="260.709" data-end="263.56">I'll attempt to play uses 16 different</span> <span data-start="263.56" data-end="266.59">inputs so it's kind of hard to figure</span> <span data-start="266.59" data-end="270.22">out something bloomies meant to be an</span> <span data-start="270.22" data-end="276.97">enemy but it's not doing much mmm let's</span> <span data-start="276.97" data-end="289.65">try that again yeah we remember Tetris</span> <span data-start="289.66" data-end="291.52">so this is this is all powered by</span> <span data-start="291.52" data-end="294.94">JavaScript and it's just implementing</span> <span data-start="294.94" data-end="297.85">the original operation codes that these</span> <span data-start="297.85" data-end="307.93">are programs contained</span> <span data-start="307.94" data-end="310.889">so a more complicated and more exciting</span> <span data-start="310.889" data-end="312.21">system is a nintendo entertainment</span> <span data-start="312.21" data-end="314.57">system which you pull your recognized or</span> <span data-start="314.57" data-end="316.889">you may have seen it looking like this</span> <span data-start="316.889" data-end="321.3">which is the famicom so whose play this</span> <span data-start="321.3" data-end="326.46">before oh good to see so here's an</span> <span data-start="326.46" data-end="332.85">investment for it you haven't played it</span> <span data-start="332.85" data-end="334.44">yet we can plan on my Nintendo</span> </p>
<p><span data-start="334.44" data-end="336.81">Entertainment System it's the legend of</span> <span data-start="336.81" data-end="338.91">zelda and its really rad those creatures</span> <span data-start="338.91" data-end="341.85">from gas are pretty bad akhter Oxitec</span> <span data-start="341.85" data-end="344.7">tags leavers too with your help I hear</span> <span data-start="344.7" data-end="347.729">upholstery yeah Michael like yeah it's</span> <span data-start="347.729" data-end="351.479">okay wiki wait awesome thanks a Nintendo</span> </p>
<p><span data-start="351.479" data-end="353.55">Entertainment System your parents help</span> <span data-start="353.55" data-end="355.5">you hook it up The Legend of Zelda sold</span> <span data-start="355.5" data-end="358.44">separate so so as you can see it's</span> <span data-start="358.44" data-end="359.7">pretty awesome you'll just bust out</span> <span data-start="359.7" data-end="363.479">rapping as you're playing so let's talk</span> <span data-start="363.479" data-end="367.11">about the system it's got a custom CPU</span> <span data-start="367.11" data-end="370.38">based off the 6502 it's got two</span> <span data-start="370.38" data-end="372.39">kilobytes on board room to kilobytes</span> <span data-start="372.39" data-end="375.51">video ram 256 bytes of object attribute</span> <span data-start="375.51" data-end="377.039">memory ram and twenty eight bytes of</span> <span data-start="377.039" data-end="378.69">pallet ram and that will make sense as</span> <span data-start="378.69" data-end="381.84">you listen on it's got a custom-made ppu</span> <span data-start="381.84" data-end="383.58">which is responsible for rendering the</span> <span data-start="383.58" data-end="386.25">graphics from memory and as we have five</span> <span data-start="386.25" data-end="387.75">sound channels and the best part</span> <span data-start="387.75" data-end="389.52">possibly the awesome rectangular</span> <span data-start="389.52" data-end="392.25">controllers before ergonomics come in</span> <span data-start="392.25" data-end="395.4">and play obviously so the how this all</span> <span data-start="395.4" data-end="396.63">fits together is the von Neumann</span> <span data-start="396.63" data-end="399.24">architecture where we have a common bus</span> <span data-start="399.24" data-end="401.7">that lets us communicate between the CPU</span> <span data-start="401.7" data-end="405.24">memory and peripherals so what we want</span> <span data-start="405.24" data-end="406.919">to do is emulate each of these little</span> <span data-start="406.919" data-end="409.5">yellow things and just have some way for</span> <span data-start="409.5" data-end="410.85">the code to communicate with them which</span> <span data-start="410.85" data-end="413.729">will act as a bus so let's go more in</span> <span data-start="413.729" data-end="417.72">depth with the CPU so CPU when you're</span> </p>
<p><span data-start="417.72" data-end="419.639">Emily it's basically a loop it just sits</span> <span data-start="419.639" data-end="422">it just runs grabbing instructions</span> <span data-start="422" data-end="426.24">decoding them and X unum so are these</span> <span data-start="426.24" data-end="428.789">instruct the instructions we call op</span> <span data-start="428.789" data-end="433.5">codes so the inexact codes perform tasks</span> <span data-start="433.5" data-end="436.11">to update the system state and there's</span> <span data-start="436.11" data-end="438.599">many that that do many different things</span> <span data-start="438.599" data-end="441.18">so this is the</span> <span data-start="441.18" data-end="443.72">the nessus if you it's the recoil</span> <span data-start="443.72" data-end="446.19">there's two different flavors depending</span> <span data-start="446.19" data-end="452.19">on the location and it's like it's a</span> <span data-start="452.19" data-end="454.53">custom 6502 because it has audio support</span> <span data-start="454.53" data-end="458.009">but no binary coded decimal support I'm</span> <span data-start="458.009" data-end="459.84">it's a bit processor with a 16-bit</span> <span data-start="459.84" data-end="462.87">address bus and runs at 12 megahertz</span> <span data-start="462.87" data-end="464.759">clock speed so something like the</span> <span data-start="464.759" data-end="467.729">fastest by today's standards there's</span> <span data-start="467.729" data-end="469.41">plenty formation about it because a lot</span> <span data-start="469.41" data-end="472.56">of hackers have emulated this so it is a</span> <span data-start="472.56" data-end="474.27">great thing about doing this one is it's</span> <span data-start="474.27" data-end="477.78">plain information so finally the system</span> </p>
<p><span data-start="477.78" data-end="481.11">JavaScript here's how you may implement</span> <span data-start="481.11" data-end="484.38">the CPU and JavaScript so we have a</span> <span data-start="484.38" data-end="486.87">constructor function here and we've just</span> <span data-start="486.87" data-end="488.669">listed out all the registers initialize</span> <span data-start="488.669" data-end="491.58">them as null and then we call a method</span> <span data-start="491.58" data-end="493.02">called reset which which will basically</span> <span data-start="493.02" data-end="494.669">just go and set these to the initial</span> <span data-start="494.669" data-end="498.03">values so that that's kind of how simple</span> <span data-start="498.03" data-end="500.43">it is to start off an emulator start</span> <span data-start="500.43" data-end="508.199">start emulating a system so CPU needs</span> <span data-start="508.199" data-end="511.53">memory so let's talk about that so it's</span> <span data-start="511.53" data-end="513.24">basically can't in contiguous block of</span> <span data-start="513.24" data-end="515.25">data that can be addressed and written</span> <span data-start="515.25" data-end="519.15">to depending on the type the nest memory</span> <span data-start="519.15" data-end="523.38">had two kilobytes on board and these are</span> <span data-start="523.38" data-end="524.94">divided into things such as zero page</span> <span data-start="524.94" data-end="527.279">the stack and just more general purpose</span> <span data-start="527.279" data-end="529.17">memory and there's also memory that can</span> <span data-start="529.17" data-end="532.62">be accessed on the carts so to address</span> <span data-start="532.62" data-end="536.37">about the 10,000 and the program Rome</span> <span data-start="536.37" data-end="539.91">that you plug in one of these guys holds</span> <span data-start="539.91" data-end="542.79">the program instructions sound and</span> <span data-start="542.79" data-end="547.02">graphics title so when you're dealing</span> <span data-start="547.02" data-end="549.36">with big blocks of memory with</span> </p>
<p><span data-start="549.36" data-end="552.089">JavaScript they can be if you you're</span> <span data-start="552.089" data-end="554.22">represented this as an array it can be</span> <span data-start="554.22" data-end="555.51">quite slow and where the emulator</span> <span data-start="555.51" data-end="558.42">performances is pretty critical so you</span> <span data-start="558.42" data-end="560.01">can use typed arrays which are</span> <span data-start="560.01" data-end="564.329">relatively new thing so you represent</span> <span data-start="564.329" data-end="566.399">the memory as one big typed array you'll</span> <span data-start="566.399" data-end="569.57">get perform performance increases</span> <span data-start="569.57" data-end="571.589">because it makes it makes it easier to</span> <span data-start="571.589" data-end="573.28">reach any offset</span> <span data-start="573.28" data-end="576.55">there's information on them at this URL</span> <span data-start="576.55" data-end="580.16">so i recommend having a look so here's</span> <span data-start="580.16" data-end="581.81">an example of a typed array working it</span> <span data-start="581.81" data-end="583.94">as our memory so if allocated enough</span> <span data-start="583.94" data-end="588.08">memory for the cpu here and then we take</span> <span data-start="588.08" data-end="590.23">a view onto that memory which is a um</span> <span data-start="590.23" data-end="594.41">unsigned integer which is what the the</span> <span data-start="594.41" data-end="598.13">nurse works in so with an NES there's</span> <span data-start="598.13" data-end="599.54">the memories mapped every where for</span> <span data-start="599.54" data-end="602">example to communicate with the PPU you</span> <span data-start="602" data-end="604.31">write you read from a rail I wrote to a</span> <span data-start="604.31" data-end="606.23">specific memory dress and a highway</span> <span data-start="606.23" data-end="608.12">would take that over to the picture</span> <span data-start="608.12" data-end="610.21">processing unit so instead of writing</span> <span data-start="610.21" data-end="613.1">just modifying the array directly you</span> <span data-start="613.1" data-end="614.54">need to write some helper functions</span> <span data-start="614.54" data-end="615.56">which would go through and do all the</span> <span data-start="615.56" data-end="617.54">magic for you and it's especially</span> <span data-start="617.54" data-end="619.76">important when you have a complicated</span> <span data-start="619.76" data-end="621.95">game cards which which extend the memory</span> <span data-start="621.95" data-end="625.94">via bank switching so now go memory</span> <span data-start="625.94" data-end="628.01">other way let's talk about decoding the</span> <span data-start="628.01" data-end="630.86">instructions in the CPU so the first</span> <span data-start="630.86" data-end="631.97">thing we need to do is check for</span> <span data-start="631.97" data-end="634.85">interrupts and these are little things</span> <span data-start="634.85" data-end="637.07">that get set which which makes the</span> <span data-start="637.07" data-end="639.2">processor go and handle them immediately</span> <span data-start="639.2" data-end="643.91">so for example with NES before a screen</span> <span data-start="643.91" data-end="645.98">is drawn there's an interrupt that you</span> <span data-start="645.98" data-end="648.2">can you can that's defy it and you can</span> <span data-start="648.2" data-end="651.32">listen to that and go ahead and paint</span> <span data-start="651.32" data-end="654.5">your screen so when this happens you are</span> <span data-start="654.5" data-end="656.84">you read the memory of the program</span> <span data-start="656.84" data-end="661.19">counter you go stall that somewhere yeah</span> <span data-start="661.19" data-end="664.49">so so is more general fetch decode loop</span> <span data-start="664.49" data-end="666.08">so you read the memory at the program</span> <span data-start="666.08" data-end="667.64">counter which is a little pointer to</span> <span data-start="667.64" data-end="668.6">where you are currently in the</span> <span data-start="668.6" data-end="670.97">instructions you decode the addressing</span> <span data-start="670.97" data-end="675.14">mode which is how how the the argument</span> <span data-start="675.14" data-end="678.17">is is encoded and then you process that</span> <span data-start="678.17" data-end="681.59">opcode so to go further into interrupts</span> <span data-start="681.59" data-end="683.42">as I said earlier there a little special</span> <span data-start="683.42" data-end="685.1">signal that that interrupts the normal</span> <span data-start="685.1" data-end="688.81">execution flow so when this happens you</span> <span data-start="688.81" data-end="692.6">you put the original PC in the processor</span> <span data-start="692.6" data-end="694.85">status on the stack and you go and</span> <span data-start="694.85" data-end="697.7">attend to this interrupt so the way you</span> <span data-start="697.7" data-end="699.59">can handle this again it's it's pretty</span> <span data-start="699.59" data-end="703.37">simple you just list them out before you</span> <span data-start="703.37" data-end="705.29">emulate a cycle you just simply go ahead</span> <span data-start="705.29" data-end="706.04">and check</span> <span data-start="706.04" data-end="708.41">if any interrupts been set if it has you</span> <span data-start="708.41" data-end="709.699">can just call out to a new method that</span> <span data-start="709.699" data-end="712.279">handles them and you might think this</span> <span data-start="712.279" data-end="715.22">code is not that JavaScript II you can</span> <span data-start="715.22" data-end="716.99">make it right it better so I thought</span> <span data-start="716.99" data-end="718.67">maybe I'll try to write this with some</span> <span data-start="718.67" data-end="721.25">more new jersey of stuff but</span> <span data-start="721.25" data-end="726.68">unfortunately it's far too slow and</span> <span data-start="726.68" data-end="728.18">that's how you basically have to write</span> <span data-start="728.18" data-end="729.68">your JavaScript like your writing C or</span> <span data-start="729.68" data-end="731.99">something because then is new stuff it's</span> <span data-start="731.99" data-end="735.079">just unfortunately too slow so when you</span> <span data-start="735.079" data-end="738.38">got these op codes so you you read the</span> <span data-start="738.38" data-end="740.329">location of the program counter from</span> <span data-start="740.329" data-end="743.12">memory you then look up the up code in a</span> <span data-start="743.12" data-end="744.74">big table that you've implemented to</span> <span data-start="744.74" data-end="747.56">find out what the instruction does now</span> <span data-start="747.56" data-end="748.94">you find the addressing mode which</span> <span data-start="748.94" data-end="751.759">describes how its arguments encoded and</span> <span data-start="751.759" data-end="753.92">then you process that of code and then</span> <span data-start="753.92" data-end="755.93">you mostly then increment the program</span> <span data-start="755.93" data-end="759.079">counter to the next one so again all</span> <span data-start="759.079" data-end="761.3">these parts are pretty simple there's</span> <span data-start="761.3" data-end="765.05">just a lot to write down so we have this</span> <span data-start="765.05" data-end="767.63">method courgette opcode where we put the</span> <span data-start="767.63" data-end="769.639">piece of memory at a program counter</span> <span data-start="769.639" data-end="772.579">pass it to that then we find the</span> <span data-start="772.579" data-end="774.44">addressing mode and we just basically</span> <span data-start="774.44" data-end="777.19">list them out and describe how that work</span> <span data-start="777.19" data-end="780.17">so then emulate writing emulate is</span> <span data-start="780.17" data-end="781.519">basically just reading the technical</span> <span data-start="781.519" data-end="783.05">specification of the system and</span> <span data-start="783.05" data-end="787.069">implementing it in code so these</span> <span data-start="787.069" data-end="790.22">avocados I've been mentioning see you've</span> <span data-start="790.22" data-end="791.569">got to become pretty familiar with them</span> <span data-start="791.569" data-end="793.55">so i recommend reading the paper a bunch</span> <span data-start="793.55" data-end="796.16">of times taking it with you really in</span> <span data-start="796.16" data-end="799.579">the shell and when things aren't working</span> <span data-start="799.579" data-end="802.699">debugging is can be quite hard so you</span> <span data-start="802.699" data-end="805.43">really want to get quite familiar with</span> <span data-start="805.43" data-end="807.279">it so you know making simple mistakes</span> <span data-start="807.279" data-end="809.569">and of course when you're not going to</span> <span data-start="809.569" data-end="811.699">write just keep trying persistence is</span> <span data-start="811.699" data-end="815.779">key so implementers opcodes is again</span> <span data-start="815.779" data-end="818.209">it's pretty simple where you just look</span> <span data-start="818.209" data-end="819.769">at what the type is in this case it's a</span> <span data-start="819.769" data-end="824.329">jump and all the jump is it set see the</span> <span data-start="824.329" data-end="826.519">program counter to a new address that's</span> <span data-start="826.519" data-end="828.38">a really simple one the problem is</span> <span data-start="828.38" data-end="831.98">there's about 150 instructions or with</span> <span data-start="831.98" data-end="834.5">potentially about six or seven dressing</span> <span data-start="834.5" data-end="836.57">modes so you need to</span> <span data-start="836.57" data-end="840.14">implement quite a bit of stuff there so</span> <span data-start="840.14" data-end="842.3">now you've got your cpu running smoothly</span> <span data-start="842.3" data-end="843.86">you want to move on to the next part</span> <span data-start="843.86" data-end="846.14">which is the PPU which is a picture</span> <span data-start="846.14" data-end="848.84">processing unit and so this generates</span> <span data-start="848.84" data-end="851.6">video signals from memory on the handle</span> <span data-start="851.6" data-end="853.27">sprite scrolling and the colors</span> <span data-start="853.27" data-end="855.23">basically anything you want to rent to</span> <span data-start="855.23" data-end="858.2">screen it uses it has two different</span> <span data-start="858.2" data-end="859.67">chips depending on the area for</span> <span data-start="859.67" data-end="861.89">different refresh rates this is it down</span> <span data-start="861.89" data-end="863.66">the bottom it's quite a nice looking</span> <span data-start="863.66" data-end="868.33">chip so it's got two kilobytes of RAM to</span> <span data-start="868.33" data-end="870.92">it can support eight by eight or 8 by 16</span> <span data-start="870.92" data-end="873.47">tiles though in practice stay by 16</span> <span data-start="873.47" data-end="875.69">almost never used and you can render</span> <span data-start="875.69" data-end="878.42">resolution of 256 x 240 which can be</span> <span data-start="878.42" data-end="880.4">clipped depending on the the screen res</span> <span data-start="880.4" data-end="884.42">on the target screen resolution so I'm</span> <span data-start="884.42" data-end="887.12">communicating with this ppu is performed</span> <span data-start="887.12" data-end="889.67">by memory maps from the CPUs addressable</span> <span data-start="889.67" data-end="891.65">memory so when you write or read to</span> <span data-start="891.65" data-end="893.39">these that the hard way actually goes</span> <span data-start="893.39" data-end="896.45">out and and affects the pp user</span> <span data-start="896.45" data-end="901.25">registers and that the pixel tiles which</span> <span data-start="901.25" data-end="904.49">you use to compose a picture of their</span> <span data-start="904.49" data-end="908.3">store on the character Ramallah cart so</span> <span data-start="908.3" data-end="910.96">with a palette of colors yeah 52 colors</span> <span data-start="910.96" data-end="913.52">which is two pallets of background and</span> <span data-start="913.52" data-end="917.6">and sprite 16 bytes each but do some</span> <span data-start="917.6" data-end="918.92">limitations you can only use about 25</span> <span data-start="918.92" data-end="922.7">colors on screen at once so when you're</span> <span data-start="922.7" data-end="924.62">rendering a picture it's composed of</span> <span data-start="924.62" data-end="928.58">tiles each one opposes 16 bytes do the</span> <span data-start="928.58" data-end="931.46">way it's encoded in memory a bit turned</span> <span data-start="931.46" data-end="937.61">on in the tile represents a a color in</span> <span data-start="937.61" data-end="940.97">the palette index so in the way</span> <span data-start="940.97" data-end="942.77">determine this is you get the first 8</span> <span data-start="942.77" data-end="945.53">bits and then 8 bytes later there's a</span> <span data-start="945.53" data-end="947.96">second 8 bits that you merge and then a</span> <span data-start="947.96" data-end="949.67">lot further down there's there's the</span> <span data-start="949.67" data-end="954.08">higher parlor number so if you look at</span> <span data-start="954.08" data-end="955.73">this number here and you imagine the</span> <span data-start="955.73" data-end="958.13">letter what the number one sorry is a</span> <span data-start="958.13" data-end="961.43">strange yellow color and it's a bit</span> <span data-start="961.43" data-end="964.64">simplified you could render this which</span> <span data-start="964.64" data-end="968.55">is a na bhaye at all</span> <span data-start="968.55" data-end="971.08">so these tiles are great we need to</span> <span data-start="971.08" data-end="974.71">compose them into a pig you know a</span> <span data-start="974.71" data-end="976.27">picture in order to get getting on</span> <span data-start="976.27" data-end="979.78">screen so you have bites which index</span> <span data-start="979.78" data-end="983.5">this these tiles I'm you have a 32</span> <span data-start="983.5" data-end="985.39">horizontal and 30 vertical which matches</span> <span data-start="985.39" data-end="988.78">the resolution discussed earlier and the</span> <span data-start="988.78" data-end="992.26">difference between after is nice if your</span> <span data-start="992.26" data-end="993.61">tiles is some extra color information</span> <span data-start="993.61" data-end="995.89">which thing is combined with the</span> <span data-start="995.89" data-end="998.08">previous tile information to generate</span> <span data-start="998.08" data-end="1000.93">new color so nothing is really is really</span> <span data-start="1000.93" data-end="1005.7">wasted here so this would become clear</span> <span data-start="1005.7" data-end="1009.99">when I show you an example so if you</span> <span data-start="1009.99" data-end="1012.06">look here at the zero offset we have a</span> <span data-start="1012.06" data-end="1015.81">bite eight bytes later we have another</span> <span data-start="1015.81" data-end="1019.65">bite and the first part of the object</span> <span data-start="1019.65" data-end="1022.14">rebuke memory holds a a second number</span> <span data-start="1022.14" data-end="1025.53">and these are you grab this one put it</span> <span data-start="1025.53" data-end="1028.5">here grab this one put it here and you</span> <span data-start="1028.5" data-end="1029.94">can probably guess you throw them over</span> <span data-start="1029.94" data-end="1032.34">there and that gives you a final color</span> <span data-start="1032.34" data-end="1035.25">index into the palette and of course</span> <span data-start="1035.25" data-end="1037.65">doing bit stuff in JavaScript relative</span> <span data-start="1037.65" data-end="1041.36">straightforward you just end it with</span> <span data-start="1041.36" data-end="1044.16">with this number in order to get the</span> <span data-start="1044.16" data-end="1045.66">part you want shift it where you want</span> <span data-start="1045.66" data-end="1048">and then just or it with the other bits</span> <span data-start="1048" data-end="1050.01">and that gives you the final number of</span> <span data-start="1050.01" data-end="1052.26">course the pp use pretty complicated so</span> <span data-start="1052.26" data-end="1055.53">this is a pretty high level overview so</span> <span data-start="1055.53" data-end="1057.18">if you want to know more of course the</span> </p>
<p><span data-start="1057.18" data-end="1058.35">Internet's there it's got plenty</span> <span data-start="1058.35" data-end="1060.27">formation and when this all comes</span> <span data-start="1060.27" data-end="1061.35">together you end up with an</span> <span data-start="1061.35" data-end="1067.65">action-packed picture like this so let's</span> <span data-start="1067.65" data-end="1072.11">say you how you put it together a arm</span> <span data-start="1072.11" data-end="1074.28">put together an emulator but I want to</span> <span data-start="1074.28" data-end="1075.69">talk a bit more about the browser API as</span> <span data-start="1075.69" data-end="1078.3">a show up you this so playing playing an</span> <span data-start="1078.3" data-end="1079.5">emulator in a little window is not</span> <span data-start="1079.5" data-end="1081.15">always so great so you often want it if</span> <span data-start="1081.15" data-end="1087.08">you can use a full screen API you can</span> <span data-start="1087.09" data-end="1090.48">you can get a much better experience so</span> <span data-start="1090.48" data-end="1092.64">the the full screen API of course has</span> <span data-start="1092.64" data-end="1096.54">the prefixes everywhere so you want to</span> <span data-start="1096.54" data-end="1098.85">make a polyfill which goes and tries all</span> <span data-start="1098.85" data-end="1101.13">the different prefix versions here's a</span> <span data-start="1101.13" data-end="1103.95">simple example and I'll show example of</span> <span data-start="1103.95" data-end="1114.12">chip 8 so let's load up invaders go full</span> <span data-start="1114.12" data-end="1120.409">screen</span> <span data-start="1120.419" data-end="1121.859">there's a button here that does</span> <span data-start="1121.859" data-end="1141.289">something</span> <span data-start="1141.299" data-end="1143.879">yeah the 16 different input so it can be</span> <span data-start="1143.879" data-end="1145.59">quite hard to figure out which ones do</span> <span data-start="1145.59" data-end="1162.77">what so I pongs can't board on your own</span> <span data-start="1162.78" data-end="1165.27">so once you've got your your graphics</span> <span data-start="1165.27" data-end="1167.43">done you put one look at sound and san</span> <span data-start="1167.43" data-end="1168.75">information is a lot harder to come</span> <span data-start="1168.75" data-end="1171.48">across online I love emulator authors or</span> <span data-start="1171.48" data-end="1175.32">ones that are that aren't too interested</span> <span data-start="1175.32" data-end="1177.39">in producing a Polish won't just leave</span> <span data-start="1177.39" data-end="1180.93">stand out altogether so Sanders does the</span> <span data-start="1180.93" data-end="1183.03">vibration of their riches</span> <span data-start="1183.03" data-end="1184.8">representatives waves with a frequency</span> <span data-start="1184.8" data-end="1187.05">and amplitude and the frequency is</span> <span data-start="1187.05" data-end="1188.61">simply a number of phase changes per</span> <span data-start="1188.61" data-end="1191.13">second and the amplitude is the volume</span> <span data-start="1191.13" data-end="1193.53">of the wave measure in decibel so the</span> <span data-start="1193.53" data-end="1197.07">nes has sound onboard the the cpu it's</span> <span data-start="1197.07" data-end="1201.27">got five sound channels to pulse wave 16</span> <span data-start="1201.27" data-end="1203.73">volume levels and I supports pitch</span> <span data-start="1203.73" data-end="1206.67">bending so can anyone recognize this</span> <span data-start="1206.67" data-end="1220.71">song</span> <span data-start="1220.72" data-end="1222.309">well you couldn't hear it by yours</span> <span data-start="1222.309" data-end="1225.37">battletoads which is an awesome game</span> <span data-start="1225.37" data-end="1227.32">once you finish the emulators first</span> </p>
<p><span data-start="1227.32" data-end="1230.74">Roman should play of course look don't</span> <span data-start="1230.74" data-end="1234.97">let trade West know and so the audio</span> <span data-start="1234.97" data-end="1237.789">processing unit again like the PPS got</span> <span data-start="1237.789" data-end="1240.75">registers maps in the addressable space</span> <span data-start="1240.75" data-end="1243.01">it's got a couple of different channels</span> <span data-start="1243.01" data-end="1246.25">for for bass sounds treble sounds random</span> <span data-start="1246.25" data-end="1248.47">noise and a digital channel so you can</span> <span data-start="1248.47" data-end="1250.99">actually encode samples with the Nets</span> <span data-start="1250.99" data-end="1253.45">but I was really done Judah the rumor</span> <span data-start="1253.45" data-end="1258.28">took in the the low encoding had used so</span> <span data-start="1258.28" data-end="1261.34">here's how a pulse wave worked here's</span> <span data-start="1261.34" data-end="1264.659">your volume here's a low order bits</span> <span data-start="1264.659" data-end="1268.69">here's a high or bisque and and here's</span> <span data-start="1268.69" data-end="1272.53">some math you do to get something so</span> <span data-start="1272.53" data-end="1278.63">let's have a listen</span> <span data-start="1278.64" data-end="1281.17">so I didn't have time to compose an</span> <span data-start="1281.17" data-end="1282.61">actual song so I'll just run through a</span> <span data-start="1282.61" data-end="1285.4">sine wave but here are those parts put</span> <span data-start="1285.4" data-end="1292.69">together you can hear the noise channel</span> <span data-start="1292.69" data-end="1296.14">being used for symbols there and the</span> <span data-start="1296.14" data-end="1297.97">kind in here there's a square wave there</span> <span data-start="1297.97" data-end="1305.11">for the drums for the kick drum slow and</span> <span data-start="1305.11" data-end="1307.06">this is all possible based on the Web</span> </p>
<p><span data-start="1307.06" data-end="1310">Audio API which is based on audio routes</span> <span data-start="1310" data-end="1312.28">in connecting these different nodes</span> <span data-start="1312.28" data-end="1313.96">together it's pretty awesome for</span> <span data-start="1313.96" data-end="1317.83">emulator sound so the way you use the</span> <span data-start="1317.83" data-end="1321.21">Web Audio API is you have a context</span> <span data-start="1321.21" data-end="1324.27">here's a gain node an oscillator</span> <span data-start="1324.27" data-end="1326.71">connected together specify type</span> <span data-start="1326.71" data-end="1329.38">frequency and we turn note on and then</span> <span data-start="1329.38" data-end="1331.09">after a duration we can turn it note off</span> <span data-start="1331.09" data-end="1333.46">and that gets us a little noise as</span> <span data-start="1333.46" data-end="1341.8">boring as this let's basically you build</span> <span data-start="1341.8" data-end="1343.63">up from there in order to put more</span> <span data-start="1343.63" data-end="1345.01">things together I actually showed you</span> <span data-start="1345.01" data-end="1347.32">those demos back to front so no demo</span> <span data-start="1347.32" data-end="1352.33">there it sounds like a start again we're</span> <span data-start="1352.33" data-end="1354.39">only scratching the surface to your time</span> <span data-start="1354.39" data-end="1356.23">it's a lot harder to find this</span> <span data-start="1356.23" data-end="1358.15">affirmation online wait it's there</span> <span data-start="1358.15" data-end="1361.69">here's a link so does they don't</span> <span data-start="1361.69" data-end="1367.95">remember these controllers yea though</span> <span data-start="1367.95" data-end="1373.12">they're pretty awesome so that these are</span> <span data-start="1373.12" data-end="1374.71">how these controllers work there's two</span> <span data-start="1374.71" data-end="1377.52">locations in memory that you can that</span> <span data-start="1377.52" data-end="1380.65">the nazcans strobe and it will go</span> <span data-start="1380.65" data-end="1384.76">through and store the store its status</span> <span data-start="1384.76" data-end="1388.03">as a low water bite in sequentially over</span> <span data-start="1388.03" data-end="1391.24">eight bytes so you can read the status</span> <span data-start="1391.24" data-end="1393.46">of the d-pad select start and the BNA</span> <span data-start="1393.46" data-end="1396.79">buns and this is what this is awesome</span> <span data-start="1396.79" data-end="1398.11">because we can hook up to the gamepad</span> </p>
<p><span data-start="1398.11" data-end="1401.02">API so the set of Firefox has it has a</span> <span data-start="1401.02" data-end="1402.94">pretty good system WebKit requires</span> <span data-start="1402.94" data-end="1406.17">polling so you're not writing some</span> <span data-start="1406.17" data-end="1409.03">potentially awful code like this where</span> <span data-start="1409.03" data-end="1410.64">we use request animation</span> <span data-start="1410.64" data-end="1413.91">to continually pull and get the gamepad</span> <span data-start="1413.91" data-end="1421.26">status so let's have a look at that so</span> <span data-start="1421.26" data-end="1423.69">this is a emulator written by bent</span> <span data-start="1423.69" data-end="1427.98">fisherman and I've just added gamepad</span> <span data-start="1427.98" data-end="1432.93">support to it but i'll just put the game</span> <span data-start="1432.93" data-end="1444.73">in</span> <span data-start="1444.74" data-end="1454.98">let's get work here</span> <span data-start="1454.99" data-end="1459.94">so I'm also not very good at games but</span> <span data-start="1459.94" data-end="1462.97">as you can see using gamepads a bit more</span> <span data-start="1462.97" data-end="1469.98">authentic experience</span> <span data-start="1469.99" data-end="1472.96">yeah my remembers this level in fact I</span> <span data-start="1472.96" data-end="1475.8">haven't died yet it's a bit of a oh</span> <span data-start="1475.8" data-end="1485.43">there you go</span> <span data-start="1485.44" data-end="1488.84">um so with all these pieces of hardware</span> <span data-start="1488.84" data-end="1492.68">in the console obviously then they're</span> <span data-start="1492.68" data-end="1494.69">not synchronous oh alright they're</span> <span data-start="1494.69" data-end="1497.12">running independently but your</span> <span data-start="1497.12" data-end="1499.28">javascript isn't so what you need to do</span> <span data-start="1499.28" data-end="1502.1">is need to count the cycles Vietnam that</span> <span data-start="1502.1" data-end="1504.8">passed once every piece is you then you</span> <span data-start="1504.8" data-end="1506.18">need to use this count in order sync</span> <span data-start="1506.18" data-end="1510.5">them together so i wrote try using web</span> <span data-start="1510.5" data-end="1512.48">workers here but i tried and that didn't</span> <span data-start="1512.48" data-end="1514.01">work out well for me so don't try using</span> <span data-start="1514.01" data-end="1517.97">web workers so now you know a bit you</span> <span data-start="1517.97" data-end="1519.11">probably want to write your very first</span> <span data-start="1519.11" data-end="1521.78">emulator so i can't stress how much you</span> <span data-start="1521.78" data-end="1522.83">need to spend a lot of time researching</span> <span data-start="1522.83" data-end="1530.39">before you jump in you're a good idea is</span> <span data-start="1530.39" data-end="1532.01">to start programming your own programs</span> <span data-start="1532.01" data-end="1534.17">that way you can become quite familiar</span> <span data-start="1534.17" data-end="1535.76">with the instruction set as well as</span> <span data-start="1535.76" data-end="1538.55">other media can sing granese about the</span> <span data-start="1538.55" data-end="1541.76">year about the hardware here's a good</span> <span data-start="1541.76" data-end="1543.05">link in order it's kind of like an</span> <span data-start="1543.05" data-end="1546.16">interactive tutorial for learning 6502</span> <span data-start="1546.16" data-end="1550.16">there's books available so let's get</span> <span data-start="1550.16" data-end="1553.97">started so chip a is your friend that's</span> <span data-start="1553.97" data-end="1555.17">the first one you should use because</span> <span data-start="1555.17" data-end="1557.78">it's pretty simple and I'm if I can do</span> <span data-start="1557.78" data-end="1559.51">it then I'm pretty confident on Ken</span> <span data-start="1559.51" data-end="1563.27">here's some tips so you're probably</span> <span data-start="1563.27" data-end="1564.44">you're probably looking at this problem</span> <span data-start="1564.44" data-end="1565.67">thinking ohhh that's kind of like a</span> </p>
<p><span data-start="1565.67" data-end="1567.98">MapReduce into a some underscore</span> <span data-start="1567.98" data-end="1570.8">function and pop that there but it's</span> <span data-start="1570.8" data-end="1572.72">just far too slow you have to kind of</span> <span data-start="1572.72" data-end="1575.51">you kind of write like the sea subset of</span> <span data-start="1575.51" data-end="1578.3">JavaScript so you switch cases are your</span> <span data-start="1578.3" data-end="1581.84">friends for loops just just basically</span> <span data-start="1581.84" data-end="1583.79">all the simple stuff because it if you</span> <span data-start="1583.79" data-end="1585.2">can get to work with other stuff that's</span> <span data-start="1585.2" data-end="1587.15">great but um when it comes to nest</span> <span data-start="1587.15" data-end="1588.89">simular a lot of stuffs just far too</span> <span data-start="1588.89" data-end="1592.55">slow some other things I've seen is</span> <span data-start="1592.55" data-end="1595.19">optimizing around passing of data so I'm</span> <span data-start="1595.19" data-end="1597.2">still passing around object which holds</span> <span data-start="1597.2" data-end="1599.18">different values you pack them all into</span> <span data-start="1599.18" data-end="1600.74">one bite and then extract them on</span> <span data-start="1600.74" data-end="1603.41">destination it's also good to know about</span> <span data-start="1603.41" data-end="1608.3">v8 optimizations know how it what are</span> <span data-start="1608.3" data-end="1609.95">optimized for what things can break</span> <span data-start="1609.95" data-end="1613.1">optimization so it's quite great if</span> <span data-start="1613.1" data-end="1614.45">you're wondering why emulators run</span> <span data-start="1614.45" data-end="1617.18">pretty slow and again write your own pro</span> <span data-start="1617.18" data-end="1618.05">games for the cyst</span> <span data-start="1618.05" data-end="1619.97">in it because you become quite familiar</span> <span data-start="1619.97" data-end="1623.21">with it so a lot more possibilities and</span> <span data-start="1623.21" data-end="1626.54">what I've discussed here I was going to</span> <span data-start="1626.54" data-end="1627.56">implement but ran out of time a</span> </p>
<p><span data-start="1627.56" data-end="1629.24">WebSocket phone controller I thought</span> <span data-start="1629.24" data-end="1633.29">that'd be pretty cool there's you could</span> <span data-start="1633.29" data-end="1634.94">also implement multiplayer for to play</span> <span data-start="1634.94" data-end="1636.62">game have a second player come in via</span> <span data-start="1636.62" data-end="1639.02">web sockets you could use a vibration</span> </p>
<p><span data-start="1639.02" data-end="1642.02">API for force feedback life in 10 or 64</span> <span data-start="1642.02" data-end="1645.29">had you could use a file API application</span> <span data-start="1645.29" data-end="1647.27">cache and then you have a portable</span> <span data-start="1647.27" data-end="1649.79">emulator which users can download and</span> <span data-start="1649.79" data-end="1652.31">carry around with them a lot of games</span> <span data-start="1652.31" data-end="1654.44">had batt battery back safe state so you</span> <span data-start="1654.44" data-end="1655.97">could use local storage to serialize</span> <span data-start="1655.97" data-end="1659.66">that and for example the the fam econ</span> <span data-start="1659.66" data-end="1662.03">javits controller here it had a</span> <span data-start="1662.03" data-end="1663.8">microphone input in the controller and</span> <span data-start="1663.8" data-end="1666.74">whilst not many programs use this I</span> <span data-start="1666.74" data-end="1668.81">thought about using getusermedia with a</span> <span data-start="1668.81" data-end="1670.73">microphone in order to emulate that so</span> <span data-start="1670.73" data-end="1671.78">i'm pretty sure that hasn't been done in</span> <span data-start="1671.78" data-end="1676.01">javascript yet here thank you you've</span> <span data-start="1676.01" data-end="1683.28">reached princess was there any questions</span> <span data-start="1683.29" data-end="1685.61">if anyone has any questions as usual</span> <span data-start="1685.61" data-end="1687.08">just please raise your hands and we'll</span> <span data-start="1687.08" data-end="1695.19">be right over at your seat anyone</span> <span data-start="1695.2" data-end="1699.94">anybody</span> <span data-start="1699.95" data-end="1706.3">alright so oh hey</span> <span data-start="1706.31" data-end="1708.45">to do the full screen stuff have you</span> <span data-start="1708.45" data-end="1710.52">looked at like scaling it up I mean</span> <span data-start="1710.52" data-end="1712.71">using one of those pixels pixel art</span> <span data-start="1712.71" data-end="1716.34">scaling algorithms I mean yeah with the</span> <span data-start="1716.34" data-end="1718.65">chip aid emulator when it when it the</span> <span data-start="1718.65" data-end="1720.72">graphics are rounded there's a set size</span> <span data-start="1720.72" data-end="1722.91">for the pixel and when I use the full</span> <span data-start="1722.91" data-end="1726.15">screen API I actually up that so i</span> <span data-start="1726.15" data-end="1728.04">render it big as opposed to letting the</span> <span data-start="1728.04" data-end="1729.69">browser just scale it I'm not sure</span> <span data-start="1729.69" data-end="1732.02">that's the best option but that's just</span> <span data-start="1732.02" data-end="1736.11">one thing I tried okay any more</span> <span data-start="1736.11" data-end="1740.82">questions</span> <span data-start="1740.83" data-end="1742.179">well alright if there are no more</span> <span data-start="1742.179" data-end="1744.64">questions can find Alex around the venue</span> <span data-start="1744.64" data-end="1748.24">and possibly later at the after party be</span> <span data-start="1748.24" data-end="1751.51">sure to go there after the event and of</span> <span data-start="1751.51" data-end="1753.1">course you could ask him there and that</span> </p>
</section>