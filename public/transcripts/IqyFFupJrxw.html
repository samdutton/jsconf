<section>
<p><span data-start="11.05" data-end="14.71">good morning recently I was reading a</span> <span data-start="14.71" data-end="16.9">white paper which was describing for</span> <span data-start="16.9" data-end="19.66">comparing to application platforms one</span> <span data-start="19.66" data-end="21.82">developed in C++ and one developed in</span> <span data-start="21.82" data-end="24.43">Java and they went piece by piece</span> <span data-start="24.43" data-end="26.98">comparing the two and when they got to</span> <span data-start="26.98" data-end="29.32">garbage collection they described</span> <span data-start="29.32" data-end="31.3">garbage collection as a programmer</span> <span data-start="31.3" data-end="32.739">convenience and they counted the number</span> <span data-start="32.739" data-end="35.23">of lines of code and the C++ system that</span> <span data-start="35.23" data-end="39.149">was explicitly disposing of memory and</span> <span data-start="39.149" data-end="41.14">concluded that that was a very small</span> <span data-start="41.14" data-end="44.289">percentage of the entire code base and</span> <span data-start="44.289" data-end="46.51">therefore garbage collection was not a</span> <span data-start="46.51" data-end="48.699">significant convenience and should not</span> <span data-start="48.699" data-end="50.35">be considered in comparing these two</span> <span data-start="50.35" data-end="53.109">systems which was completely wrong</span> <span data-start="53.109" data-end="54.67">because that's not what garbage</span> <span data-start="54.67" data-end="55.809">collection is it's not a programmer</span> <span data-start="55.809" data-end="60.039">convenience it's a reliability mechanism</span> <span data-start="60.039" data-end="62.829">it's a way of guaranteeing that a large</span> <span data-start="62.829" data-end="64.96">important class of dangling pointer</span> <span data-start="64.96" data-end="67.48">errors cannot occur and it's only when</span> <span data-start="67.48" data-end="69.01">you have garbage collection that you can</span> <span data-start="69.01" data-end="72.85">consider a very rich family of</span> <span data-start="72.85" data-end="75.13">algorithms which are just too dangerous</span> <span data-start="75.13" data-end="78.4">to consider without it so basically the</span> <span data-start="78.4" data-end="80.65">conclusion of the paper was that it was</span> <span data-start="80.65" data-end="83.17">okay for C++ programmers to be</span> <span data-start="83.17" data-end="86.73">completely ignorant about Java and</span> <span data-start="86.73" data-end="88.96">that's just wrong we'll come back to</span> <span data-start="88.96" data-end="90.58">that later it's never good to be</span> <span data-start="90.58" data-end="94.15">ignorant about anything but today we're</span> <span data-start="94.15" data-end="96.37">going to be talking about loops this is</span> <span data-start="96.37" data-end="99.67">a loop statement we don't have a</span> <span data-start="99.67" data-end="101.53">statement quite like this in JavaScript</span> <span data-start="101.53" data-end="103.48">where you've got loop and you've got a</span> <span data-start="103.48" data-end="105.28">block and you do the things in the block</span> <span data-start="105.28" data-end="107.98">over and over again I kind of wish we</span> <span data-start="107.98" data-end="111.37">did for a couple of reasons one is most</span> <span data-start="111.37" data-end="113.11">of my loops seem to exit out of the</span> <span data-start="113.11" data-end="115.42">middle that you know the book says</span> <span data-start="115.42" data-end="116.68">you're supposed to always exit out of</span> <span data-start="116.68" data-end="118.36">the top or the bottom and JavaScript has</span> <span data-start="118.36" data-end="120.31">conveniences for that but I tend to</span> <span data-start="120.31" data-end="123.67">break out of the middle and you can</span> <span data-start="123.67" data-end="126.07">write that in JavaScript using while</span> <span data-start="126.07" data-end="129.55">true or for semicolon semicolon but they</span> <span data-start="129.55" data-end="132.31">both look stupid I'd rather have a</span> <span data-start="132.31" data-end="133.84">fundamental thing because that's</span> <span data-start="133.84" data-end="135.58">ultimately what I'm trying to do is I'm</span> <span data-start="135.58" data-end="139.09">just trying to go round and round but</span> <span data-start="139.09" data-end="141.25">the the more important reason is</span> <span data-start="141.25" data-end="143.65">it allows us to have sort of a smaller</span> <span data-start="143.65" data-end="146.17">core language and then Express</span> <span data-start="146.17" data-end="147.91">higher-level things in terms of that</span> </p>
<p><span data-start="147.91" data-end="149.62">Brendan gave us an example of that last</span> <span data-start="149.62" data-end="152.68">night with the meta object stuff that</span> <span data-start="152.68" data-end="154.3">sort of takes some of the magic out of</span> <span data-start="154.3" data-end="155.71">the language and allows more of the</span> <span data-start="155.71" data-end="157.69">language to be developed itself and</span> <span data-start="157.69" data-end="160.45">another approach to doing the same thing</span> <span data-start="160.45" data-end="164.32">is to have simple primitives which then</span> <span data-start="164.32" data-end="166.209">could be syntactically expanded or D</span> <span data-start="166.209" data-end="169.03">sugared into more expressive patterns</span> <span data-start="169.03" data-end="172.99">for example a while statement could be</span> <span data-start="172.99" data-end="174.55">transformed into the equivalent loop</span> <span data-start="174.55" data-end="177.6">statement and in looking at that</span> <span data-start="177.6" data-end="180.01">suddenly realize while doesn't actually</span> <span data-start="180.01" data-end="183.489">accomplish very much you I wouldn't miss</span> <span data-start="183.489" data-end="187.12">having it similarly we've got do while</span> <span data-start="187.12" data-end="189.64">which looks completely different but we</span> <span data-start="189.64" data-end="192.01">can see its expansion to loop it's just</span> <span data-start="192.01" data-end="194.05">the same thing except the if is on the</span> <span data-start="194.05" data-end="198.7">bottom now hello we've got the for</span> <span data-start="198.7" data-end="201.55">statement which confuses beginners</span> <span data-start="201.55" data-end="203.41">learning the language because you've got</span> <span data-start="203.41" data-end="206.14">these three clauses and it seems really</span> <span data-start="206.14" data-end="209.2">arbitrary which is which the equivalent</span> <span data-start="209.2" data-end="211.15">loop statement is pretty easy to</span> <span data-start="211.15" data-end="212.799">understand now another way that you</span> <span data-start="212.799" data-end="215.38">could think about loops is to turn them</span> <span data-start="215.38" data-end="218.47">into recursive functions so here I'm</span> <span data-start="218.47" data-end="220.63">turning a while into a function that</span> <span data-start="220.63" data-end="222.58">calls itself and continues to call</span> <span data-start="222.58" data-end="225.7">itself until the condition is met this</span> <span data-start="225.7" data-end="227.86">doesn't quite work in JavaScript right</span> <span data-start="227.86" data-end="232.2">now for two reasons one is the body</span> <span data-start="232.2" data-end="234.85">cannot be or the the body of the loop</span> <span data-start="234.85" data-end="237.28">which is a block can't be turned into a</span> <span data-start="237.28" data-end="240.34">function body if it contains this or</span> <span data-start="240.34" data-end="244.86">arguments or return or break or continue</span> <span data-start="244.86" data-end="248.17">so you sort of a special case but the</span> <span data-start="248.17" data-end="250.47">more important restriction is that</span> </p>
<p><span data-start="250.47" data-end="252.76">JavaScript does not currently implement</span> <span data-start="252.76" data-end="256.12">tail recursion optimization so you'll</span> <span data-start="256.12" data-end="259">run out of stack space in most cases</span> <span data-start="259" data-end="262.51">before this loop concludes and I'd like</span> <span data-start="262.51" data-end="263.979">to get that fixed some day two we'll</span> <span data-start="263.979" data-end="267.88">come back to that so the main loop i'm</span> <span data-start="267.88" data-end="269.81">here to talk about today is the</span> <span data-start="269.81" data-end="272.49">event loop the event loop is the most</span> <span data-start="272.49" data-end="276.719">important of all loops so the browser</span> <span data-start="276.719" data-end="278.279">has an event queue which contains</span> <span data-start="278.279" data-end="281.669">callback functions and those functions</span> <span data-start="281.669" data-end="284.249">get triggered by the timer on set</span> <span data-start="284.249" data-end="286.71">timeout or set interval x UI events</span> <span data-start="286.71" data-end="289.199">clicking and mousing and keyboarding and</span> <span data-start="289.199" data-end="291.93">by the network or onload and other</span> <span data-start="291.93" data-end="295.86">things in an event loop driven system</span> <span data-start="295.86" data-end="298.11">which the browser is everything happens</span> <span data-start="298.11" data-end="300.779">in turns so if the beginning of a turn</span> <span data-start="300.779" data-end="303.93">an event handler gets started it will</span> <span data-start="303.93" data-end="306.569">run to completion and then the next turn</span> <span data-start="306.569" data-end="308.699">happens and within your turn you can be</span> <span data-start="308.699" data-end="311.31">confident that you'll never get</span> <span data-start="311.31" data-end="312.84">interrupted so you don't have to worry</span> <span data-start="312.84" data-end="314.669">about anything else kind of spoiling the</span> <span data-start="314.669" data-end="317.18">environment while your turn is going on</span> <span data-start="317.18" data-end="321.509">now that puts a huge restriction on the</span> <span data-start="321.509" data-end="323.759">use of the system which is you've got a</span> <span data-start="323.759" data-end="326.219">prime directive in a turn you must never</span> <span data-start="326.219" data-end="328.919">block you must never wait and you must</span> <span data-start="328.919" data-end="331.409">finish fast because everything else in</span> <span data-start="331.409" data-end="332.669">the system is waiting for you to</span> <span data-start="332.669" data-end="334.889">complete nothing else can go until you</span> <span data-start="334.889" data-end="338.039">are done the event loop is one of the</span> <span data-start="338.039" data-end="339.87">best parts of the browser there are lots</span> <span data-start="339.87" data-end="341.339">of things that the browser got wrong</span> <span data-start="341.339" data-end="342.93">this is one of the parts that the</span> <span data-start="342.93" data-end="345.629">browser got brilliantly right with a</span> <span data-start="345.629" data-end="349.589">couple of exceptions there alert and</span> <span data-start="349.589" data-end="354.06">it's sisters block and so they're okay</span> <span data-start="354.06" data-end="355.5">to use for debugging but they should</span> <span data-start="355.5" data-end="357.06">never be used in applications because</span> <span data-start="357.06" data-end="359.58">they stop the main browser threads and</span> <span data-start="359.58" data-end="361.409">no other work can happen until the user</span> <span data-start="361.409" data-end="365.43">dismisses it also xhr was created with</span> <span data-start="365.43" data-end="368.189">asynchronous mode which blocks you while</span> <span data-start="368.189" data-end="370.62">you're waiting for the network to return</span> <span data-start="370.62" data-end="372.629">a result which is terrible so you should</span> <span data-start="372.629" data-end="375.18">never ever be using that either but with</span> <span data-start="375.18" data-end="376.889">those restrictions the browser got all</span> <span data-start="376.889" data-end="379.649">of the asynchronous operations for the</span> <span data-start="379.649" data-end="382.56">event loop correctly at being a</span> <span data-start="382.56" data-end="383.729">mathematician she thought should be</span> <span data-start="383.729" data-end="386.189">assigned a code breaking instead she was</span> <span data-start="386.189" data-end="390.529">sent to Harvard to work on the bark one</span> <span data-start="390.529" data-end="392.02">it</span> <span data-start="392.02" data-end="396.539">was a computer operated by the Navy</span> <span data-start="396.539" data-end="404.8">skins so when looks good me when she got</span> <span data-start="404.8" data-end="406.389">there her first assignment was to take</span> <span data-start="406.389" data-end="407.83">the machine apart figure out how it</span> <span data-start="407.83" data-end="409.87">worked figure out how to program it and</span> <span data-start="409.87" data-end="411.159">then write the manual so that other</span> <span data-start="411.159" data-end="413.169">people could program it so she was one</span> <span data-start="413.169" data-end="416.229">of the very first programmers and she</span> <span data-start="416.229" data-end="418.349">completed that task very successfully</span> <span data-start="418.349" data-end="420.61">after the war she went to work for the</span> <span data-start="420.61" data-end="424.27">first commercial computer manufacturer</span> <span data-start="424.27" data-end="428.38">which built the UNIVAC at that time and</span> <span data-start="428.38" data-end="431.47">for a long time computers were extremely</span> <span data-start="431.47" data-end="433.44">expensive there were millions of dollars</span> <span data-start="433.44" data-end="436.96">and the development of software was</span> <span data-start="436.96" data-end="439.21">extremely slow and difficult basically</span> <span data-start="439.21" data-end="441.159">programs were written as a sequence of</span> <span data-start="441.159" data-end="444.58">numerical codes it's just very very</span> <span data-start="444.58" data-end="447.669">tedious work and the thinking at the</span> <span data-start="447.669" data-end="450.37">time was that the hardware costs were</span> <span data-start="450.37" data-end="452.08">going to dwarf the software costs</span> <span data-start="452.08" data-end="454.21">because human life is cheap by</span> <span data-start="454.21" data-end="457.27">comparison to vacuum tubes so we'll just</span> <span data-start="457.27" data-end="460.599">throw as many people at it as we need in</span> <span data-start="460.599" data-end="461.68">order to make all the software that's</span> <span data-start="461.68" data-end="463.93">required she had the insight that that</span> <span data-start="463.93" data-end="466.9">wasn't going to work that programming</span> <span data-start="466.9" data-end="468.37">looks just too difficult and finding</span> <span data-start="468.37" data-end="470.38">enough amazing people like you to do</span> <span data-start="470.38" data-end="473.919">that level of work for the UNIVAC they</span> <span data-start="473.919" data-end="475.09">were not going to be able to sell enough</span> <span data-start="475.09" data-end="477.49">machines to make the business go so she</span> <span data-start="477.49" data-end="479.259">had this amazing idea we can use</span> <span data-start="479.259" data-end="481.479">software to make it easier to write</span> <span data-start="481.479" data-end="484.419">software so she developed a program</span> <span data-start="484.419" data-end="488.02">called a zero which was the first in the</span> <span data-start="488.02" data-end="489.969">a series serve an indication of how</span> <span data-start="489.969" data-end="491.919">smart a programmer she was she called it</span> <span data-start="491.919" data-end="495.31">a zero she didn't call it a one it was</span> <span data-start="495.31" data-end="497.229">the first compiler she called it a</span> <span data-start="497.229" data-end="499.33">compiler we call things compilers today</span> <span data-start="499.33" data-end="504.789">because of a 0 0 her idea was to have a</span> <span data-start="504.789" data-end="507.31">library of subroutines and that you</span> <span data-start="507.31" data-end="509.409">could call for those subroutines and</span> <span data-start="509.409" data-end="512.2">assemble them into a program and then</span> <span data-start="512.2" data-end="513.729">the program that you assembled could</span> <span data-start="513.729" data-end="515.5">also go into the subroutine library and</span> <span data-start="515.5" data-end="518.649">other people could build on that the</span> <span data-start="518.649" data-end="520.959">reason we call a collection of useful</span> <span data-start="520.959" data-end="522.59">software a library is</span> <span data-start="522.59" data-end="526.52">because of this the reason we call a</span> <span data-start="526.52" data-end="529.43">function you know why do you call a</span> <span data-start="529.43" data-end="530.81">function a function isn't anything like</span> <span data-start="530.81" data-end="533.3">a telephone call it's because of the</span> <span data-start="533.3" data-end="534.77">library metaphor that you call for a</span> <span data-start="534.77" data-end="536.57">book every book has a call number you</span> <span data-start="536.57" data-end="539.11">can call for the document and get it</span> <span data-start="539.11" data-end="542.84">that's the sense she had so there were</span> <span data-start="542.84" data-end="544.66">two kinds of subroutines in her system</span> <span data-start="544.66" data-end="547.07">open subroutines which today we would</span> <span data-start="547.07" data-end="548.6">call and include you just take the whole</span> <span data-start="548.6" data-end="550.34">text of the subroutine and stick it</span> <span data-start="550.34" data-end="553.52">right in the middle and then a new idea</span> <span data-start="553.52" data-end="555.65">the closed subroutine which you could</span> <span data-start="555.65" data-end="557.69">jump to and then jump back so you could</span> <span data-start="557.69" data-end="559.58">use it from multiple places in your</span> <span data-start="559.58" data-end="561.89">program but it only occurs once in</span> <span data-start="561.89" data-end="565.34">memory so in modern terms a zero was</span> <span data-start="565.34" data-end="567.83">more like a linker or a loader than it</span> <span data-start="567.83" data-end="571.22">was a compiler but this was the first</span> <span data-start="571.22" data-end="573.29">compiler and it went through iterations</span> <span data-start="573.29" data-end="574.79">which eventually led to modern</span> <span data-start="574.79" data-end="578.71">programming languages a later evolution</span> <span data-start="578.71" data-end="582.14">was a 282 was the first open source</span> <span data-start="582.14" data-end="584.75">project a two was given to univ ax</span> <span data-start="584.75" data-end="588.11">customers and they used it and some of</span> <span data-start="588.11" data-end="590.09">them modified it and gave back the</span> <span data-start="590.09" data-end="592.82">changes and suggestions for for further</span> <span data-start="592.82" data-end="597.65">improvement open source is almost as old</span> <span data-start="597.65" data-end="600.38">as computers but not quite the thing it</span> <span data-start="600.38" data-end="602.86">had to wait for was mass production</span> <span data-start="602.86" data-end="605.99">prior to univac every computer was one</span> <span data-start="605.99" data-end="609.02">off they build it mostly as a research</span> <span data-start="609.02" data-end="612.56">project and as a result of having built</span> <span data-start="612.56" data-end="614.09">it they figured out how to build the</span> <span data-start="614.09" data-end="616.19">next one better so it wasn't until</span> <span data-start="616.19" data-end="618.95">univac that you had lots of people using</span> <span data-start="618.95" data-end="620.75">similar machines and then open source</span> <span data-start="620.75" data-end="624.56">becomes a reasonable thing a to led to a</span> <span data-start="624.56" data-end="627.8">3 which led to a t3 which was later</span> <span data-start="627.8" data-end="630.53">renamed as mathematic it was one of the</span> <span data-start="630.53" data-end="633.23">first programming languages that we</span> <span data-start="633.23" data-end="635.12">would recognize today as a programming</span> <span data-start="635.12" data-end="637.55">language about the same time IBM</span> <span data-start="637.55" data-end="639.68">developed Fortran which turned out to be</span> <span data-start="639.68" data-end="643.67">the winner in this particular race now</span> <span data-start="643.67" data-end="648.2">turns out Fortran made programmers much</span> <span data-start="648.2" data-end="652.4">much more productive but some of the</span> <span data-start="652.4" data-end="654.44">best programmers of the day completely</span> <span data-start="654.44" data-end="655.72">rejected that idea</span> <span data-start="655.72" data-end="658.01">they said that programming took too much</span> <span data-start="658.01" data-end="660.56">creativity and dexterity for the human</span> <span data-start="660.56" data-end="662.63">being to be replaced by a very machine</span> <span data-start="662.63" data-end="666.62">they were manipulating they just didn't</span> <span data-start="666.62" data-end="668.959">understand what it was that Fortran was</span> <span data-start="668.959" data-end="670.279">supposed to be doing for them that it's</span> <span data-start="670.279" data-end="672.05">going to make them more productive make</span> <span data-start="672.05" data-end="674.42">their lives better and this is going to</span> <span data-start="674.42" data-end="675.86">be a recurring theme that very often</span> <span data-start="675.86" data-end="678.05">programmers are the last to understand</span> <span data-start="678.05" data-end="680.6">the the benefit of an improvement in</span> <span data-start="680.6" data-end="683.87">software technology so one of the</span> <span data-start="683.87" data-end="686.36">characteristics in both math magic or</span> <span data-start="686.36" data-end="689.81">mathematic and Fortran was blocking read</span> <span data-start="689.81" data-end="692.149">and blocking right so you got to a read</span> <span data-start="692.149" data-end="695.48">statement the program would stop it</span> <span data-start="695.48" data-end="697.13">would then go off to the card reader the</span> <span data-start="697.13" data-end="698.63">tape drive her wherever was getting the</span> <span data-start="698.63" data-end="700.91">data because the program had nothing to</span> <span data-start="700.91" data-end="702.77">do until it got the data anyway so it</span> <span data-start="702.77" data-end="705.23">would just block until the i/o operation</span> <span data-start="705.23" data-end="709.25">was completed the model for i/o and in</span> <span data-start="709.25" data-end="711.05">the early programming languages was sort</span> <span data-start="711.05" data-end="713.36">of based on the black box hardware model</span> <span data-start="713.36" data-end="715.43">we've got an input and an output and you</span> <span data-start="715.43" data-end="721.49">do some processing in between when we</span> <span data-start="721.49" data-end="725.63">went to time sharing the of that model</span> <span data-start="725.63" data-end="727.61">just came right along so you had read</span> <span data-start="727.61" data-end="730.04">and write statements that now talked to</span> <span data-start="730.04" data-end="732.86">teletypes and interactive devices so</span> <span data-start="732.86" data-end="735.14">programs became highly modal because</span> <span data-start="735.14" data-end="737.6">that each read statement the program</span> <span data-start="737.6" data-end="739.279">would be expecting one particular input</span> <span data-start="739.279" data-end="741.32">and the user couldn't type anything else</span> <span data-start="741.32" data-end="744.079">at that point or it'd be an error so the</span> <span data-start="744.079" data-end="745.73">flow of the dialogue was dictated by the</span> <span data-start="745.73" data-end="747.98">program not by the user and so the</span> <span data-start="747.98" data-end="749.48">programs were significantly harder to</span> <span data-start="749.48" data-end="752.98">use than today's programs time-sharing</span> <span data-start="752.98" data-end="755.18">economically dependent on the block and</span> <span data-start="755.18" data-end="759.44">read because while one task was stopped</span> <span data-start="759.44" data-end="761.72">on a read that time could be given to</span> <span data-start="761.72" data-end="764.51">other users and so that's how they they</span> <span data-start="764.51" data-end="766.07">had a machine that was much slower than</span> <span data-start="766.07" data-end="768.26">the device you've got in your pocket and</span> <span data-start="768.26" data-end="771.079">it'd be shared over a hundred people and</span> <span data-start="771.079" data-end="773.32">that was how they gave the illusion that</span> <span data-start="773.32" data-end="775.37">people were getting more time than they</span> <span data-start="775.37" data-end="780.11">actually got so since then virtually all</span> <span data-start="780.11" data-end="782.089">programming languages have had blocking</span> <span data-start="782.089" data-end="785">io every language has read and write</span> <span data-start="785" data-end="787.049">with only a couple of exception</span> <span data-start="787.049" data-end="790.299">see had no I Oh at all which was</span> <span data-start="790.299" data-end="792.789">actually an amazing advance because it</span> <span data-start="792.789" data-end="794.769">made the language much more flexible you</span> <span data-start="794.769" data-end="796.149">could use it in lots of different</span> <span data-start="796.149" data-end="798.579">environments including embedded systems</span> <span data-start="798.579" data-end="800.139">where you had completely different</span> <span data-start="800.139" data-end="802.079">notions of how I oh was supposed to work</span> <span data-start="802.079" data-end="804.22">unfortunately it also came with standard</span> </p>
<p><span data-start="804.22" data-end="807.429">IO and that's pretty much the only thing</span> <span data-start="807.429" data-end="809.859">people use so effectively it has</span> <span data-start="809.859" data-end="813.999">blocking io meanwhile some people were</span> <span data-start="813.999" data-end="815.589">starting to recognize that there are</span> <span data-start="815.589" data-end="817.629">other ways of managing io which which</span> <span data-start="817.629" data-end="819.789">were much more effective this was</span> <span data-start="819.789" data-end="821.739">happening particularly in research labs</span> <span data-start="821.739" data-end="824.199">like at Stanford Research Institute and</span> <span data-start="824.199" data-end="827.35">at Xerox PARC also people developing</span> <span data-start="827.35" data-end="829.059">text editors started coming up with a</span> <span data-start="829.059" data-end="831.1">notion that if you had just one read</span> <span data-start="831.1" data-end="833.41">statement for the entire editor that</span> <span data-start="833.41" data-end="835.449">gave the user a lot more flexibility in</span> <span data-start="835.449" data-end="838.839">how they can enter their commands also</span> <span data-start="838.839" data-end="840.91">people who are developing the earliest</span> <span data-start="840.91" data-end="842.559">computer games also made the same</span> <span data-start="842.559" data-end="844.689">discovery that they'd never wanted to</span> <span data-start="844.689" data-end="848.229">block on Io that they just want to have</span> <span data-start="848.229" data-end="849.85">one particular place where they could</span> <span data-start="849.85" data-end="852.039">get stuff and change the state of the</span> <span data-start="852.039" data-end="856.569">program based on what was entered that</span> <span data-start="856.569" data-end="858.789">didn't reach that idea didn't reach</span> <span data-start="858.789" data-end="860.949">mainstream programmers until nineteen</span> <span data-start="860.949" data-end="865.569">eighty-four in 1984 Macintosh which was</span> <span data-start="865.569" data-end="868.089">the first reasonably priced computer</span> <span data-start="868.089" data-end="871.029">based on an event model became available</span> <span data-start="871.029" data-end="874.479">and a lot of programmers looked at it</span> <span data-start="874.479" data-end="877.089">and couldn't figure out how to program</span> <span data-start="877.089" data-end="880.089">it they complain that you have to write</span> <span data-start="880.089" data-end="882.459">the programs inside out Wow it's just</span> <span data-start="882.459" data-end="884.259">too hard it's impossible to think about</span> <span data-start="884.259" data-end="886.479">it so we should go back to the command</span> <span data-start="886.479" data-end="888.369">line that's the way God intended us to</span> <span data-start="888.369" data-end="891.129">write programs that this kind of inside</span> <span data-start="891.129" data-end="895.149">out stuff is just wrong Apple released a</span> <span data-start="895.149" data-end="897.399">program called mac app which was a</span> <span data-start="897.399" data-end="899.529">skeleton of a Macintosh application</span> <span data-start="899.529" data-end="901.239">which had the event loop built into it</span> <span data-start="901.239" data-end="903.429">and affordances for creating menu bars</span> <span data-start="903.429" data-end="904.659">and all the other things you have to do</span> <span data-start="904.659" data-end="907.559">you just had to plug your code into that</span> <span data-start="907.559" data-end="909.999">they weren't buying it was still way too</span> <span data-start="909.999" data-end="913.029">hard to think about so event loop</span> <span data-start="913.029" data-end="914.739">programming might have died out at that</span> <span data-start="914.739" data-end="918.009">point except for hypercard Bill Atkinson</span> <span data-start="918.009" data-end="919.63">who developed quick</span> <span data-start="919.63" data-end="923.38">quickdraw and Mac Paint wrote a</span> <span data-start="923.38" data-end="925.54">multi-level macpaint in which he could</span> <span data-start="925.54" data-end="928.45">have many planes and imagery available</span> <span data-start="928.45" data-end="930.16">and you could switch from one to another</span> <span data-start="930.16" data-end="931.93">in each of those claims in addition to</span> <span data-start="931.93" data-end="934.66">having pixels on it could also have</span> <span data-start="934.66" data-end="937.12">buttons and fields and those buttons and</span> <span data-start="937.12" data-end="939.07">fields could have script attached to it</span> <span data-start="939.07" data-end="941.29">and the whole thing was avenged Riven</span> <span data-start="941.29" data-end="945.22">and it really took off because</span> <span data-start="945.22" data-end="947.26">non-programmers found that they could be</span> <span data-start="947.26" data-end="949.87">incredibly productive in HyperCard they</span> <span data-start="949.87" data-end="952.27">just draw a picture of something and add</span> <span data-start="952.27" data-end="954.01">a little bit of script to make it work</span> <span data-start="954.01" data-end="956.41">and boom they had an application and</span> <span data-start="956.41" data-end="958.09">people were developing all sorts of</span> <span data-start="958.09" data-end="961.39">things then the professional programmers</span> <span data-start="961.39" data-end="963.76">kind of looked at what the amateurs were</span> <span data-start="963.76" data-end="965.59">doing a guy in the ok yeah I guess we</span> <span data-start="965.59" data-end="967.33">could do that too and then suddenly</span> <span data-start="967.33" data-end="970.51">there was an explosion in programs for</span> <span data-start="970.51" data-end="972.19">the Macintosh am for windows which has a</span> <span data-start="972.19" data-end="976.12">similar model so HyperCard was all about</span> <span data-start="976.12" data-end="979.36">events it was so event oriented that you</span> <span data-start="979.36" data-end="980.56">didn't have to write the event loop</span> <span data-start="980.56" data-end="982.45">yourself it was built in so all you had</span> <span data-start="982.45" data-end="985.27">to write was he gun handlers so programs</span> <span data-start="985.27" data-end="987.4">which it called stacks were written as a</span> <span data-start="987.4" data-end="989.29">collection of event handlers attached to</span> <span data-start="989.29" data-end="991.63">visible objects cards fields and buttons</span> <span data-start="991.63" data-end="996.43">and events bubbled up as they do in the</span> <span data-start="996.43" data-end="998.68">browser and some of the event names may</span> <span data-start="998.68" data-end="1000.9">look very familiar to you like on Mouse</span> <span data-start="1000.9" data-end="1004.26">up on key down on card enter in the</span> <span data-start="1004.26" data-end="1007.29">browser became onload you all remember</span> <span data-start="1007.29" data-end="1010.5">that on Idol was an event that it sent</span> <span data-start="1010.5" data-end="1012">out whenever there was nothing going on</span> <span data-start="1012" data-end="1013.56">when the event queue became empty it</span> <span data-start="1013.56" data-end="1015.36">would send on idle people figured out</span> <span data-start="1015.36" data-end="1018.23">that they could do animation with that</span> <span data-start="1018.23" data-end="1020.31">which worked fine for the first</span> <span data-start="1020.31" data-end="1021.99">generation of Macintoshes but when the</span> <span data-start="1021.99" data-end="1023.43">next generation came out which was</span> <span data-start="1023.43" data-end="1029.06">faster all the animation went crazy so</span> <span data-start="1029.06" data-end="1032.16">hyper car didn't anticipate that people</span> <span data-start="1032.16" data-end="1034.41">would be animating with it because the</span> </p>
<p><span data-start="1034.41" data-end="1035.939">CPU is at that time were so slow that</span> <span data-start="1035.939" data-end="1037.709">wasn't really an option but people did</span> <span data-start="1037.709" data-end="1039.99">it anyway so the lesson was if you don't</span> <span data-start="1039.99" data-end="1042.24">provide a right way the street will find</span> <span data-start="1042.24" data-end="1043.77">its own way we've certainly seen that</span> <span data-start="1043.77" data-end="1046.569">played over and over in the browser</span> <span data-start="1046.569" data-end="1050.69">so HyperCard had a big impact on the on</span> <span data-start="1050.69" data-end="1052.519">the evolution of the browser basically</span> <span data-start="1052.519" data-end="1056.57">netscape navigator to was combining</span> <span data-start="1056.57" data-end="1059.029">ideas from hypercard and combining ideas</span> <span data-start="1059.029" data-end="1061.759">from the original web browser and it</span> <span data-start="1061.759" data-end="1063.44">turns out that javascript is really well</span> <span data-start="1063.44" data-end="1065.179">suited to this model and that's not by</span> <span data-start="1065.179" data-end="1068.059">coincidence because javascript was</span> <span data-start="1068.059" data-end="1070.669">designed specifically to do this and</span> <span data-start="1070.669" data-end="1073.22">it's actually very very good at it so</span> <span data-start="1073.22" data-end="1076.88">the dom is awful i hope i'm not</span> <span data-start="1076.88" data-end="1078.679">surprising anybody anybody not aware</span> <span data-start="1078.679" data-end="1081.889">that the dom is awful but as awful as it</span> <span data-start="1081.889" data-end="1085.309">is with javascript the dom is really</span> <span data-start="1085.309" data-end="1087.71">effective and if you put an ajax library</span> <span data-start="1087.71" data-end="1091.039">on it like Yui 3 it becomes really</span> <span data-start="1091.039" data-end="1095.809">effective almost Pleasant so one of the</span> <span data-start="1095.809" data-end="1097.759">reasons why javascript is really good at</span> <span data-start="1097.759" data-end="1099.2">this and one of the reasons why you are</span> <span data-start="1099.2" data-end="1100.399">really good at this is because</span> <span data-start="1100.399" data-end="1102.769">javascript does not have read it's one</span> <span data-start="1102.769" data-end="1104.48">of the only modern programming languages</span> <span data-start="1104.48" data-end="1107.029">one of the only programming languages in</span> <span data-start="1107.029" data-end="1108.71">the history programming languages that</span> <span data-start="1108.71" data-end="1111.73">doesn't have blocking read built into it</span> <span data-start="1111.73" data-end="1114.2">this has always been seen as a big</span> <span data-start="1114.2" data-end="1116">disadvantage all JavaScript awful</span> <span data-start="1116" data-end="1118.159">because you can't read files with it but</span> <span data-start="1118.159" data-end="1120.379">that turns out to have been a good thing</span> <span data-start="1120.379" data-end="1122.33">because it means it's easier for you to</span> <span data-start="1122.33" data-end="1125.36">work with the event driven model than it</span> <span data-start="1125.36" data-end="1127.039">is for people who have practice with</span> <span data-start="1127.039" data-end="1128.87">other languages because you've never</span> <span data-start="1128.87" data-end="1132.139">blocked and so that the urge to want to</span> <span data-start="1132.139" data-end="1134.389">have to block and to find alternatives</span> <span data-start="1134.389" data-end="1136.309">to it it's not a problem for you you've</span> <span data-start="1136.309" data-end="1141.649">always done it right and you know read</span> <span data-start="1141.649" data-end="1143.96">is a problem in this model because we</span> <span data-start="1143.96" data-end="1146.029">eat blocks in blocking is bad for event</span> <span data-start="1146.029" data-end="1148.46">loops so JavaScript programmers are</span> <span data-start="1148.46" data-end="1150.74">smarter about using event loops than</span> <span data-start="1150.74" data-end="1152.69">programmers of other languages so</span> <span data-start="1152.69" data-end="1157.19">congratulations you're all smarter so</span> <span data-start="1157.19" data-end="1159.409">the event loop is just one approach to</span> <span data-start="1159.409" data-end="1162.769">concurrency we have a need to do lots of</span> <span data-start="1162.769" data-end="1164.96">things at the same time event loops are</span> <span data-start="1164.96" data-end="1167.269">one way to do that another is to use</span> <span data-start="1167.269" data-end="1170.33">threading and threading is the most</span> <span data-start="1170.33" data-end="1171.62">popular approach</span> <span data-start="1171.62" data-end="1175">of most programmers today so</span> <span data-start="1175" data-end="1177.38">everything's a trade-off there nothing</span> <span data-start="1177.38" data-end="1179.96">is perfect in technology so let's look</span> <span data-start="1179.96" data-end="1182.72">at the trade-offs with threading on the</span> <span data-start="1182.72" data-end="1185.69">pro side no rethinking is necessary so</span> <span data-start="1185.69" data-end="1187.07">you don't have to write your programs</span> <span data-start="1187.07" data-end="1189.2">inside out you can take any sequential</span> <span data-start="1189.2" data-end="1191.39">program put it in a thread it still</span> <span data-start="1191.39" data-end="1195.23">works so that's a huge advantage those</span> <span data-start="1195.23" data-end="1196.97">programs can block in fact they're</span> <span data-start="1196.97" data-end="1198.53">supposed to block the reason we have</span> <span data-start="1198.53" data-end="1200.33">threads isn't so we can do multiple</span> <span data-start="1200.33" data-end="1202.22">things at once it's so that we can stop</span> <span data-start="1202.22" data-end="1204.05">doing things and do other things while</span> <span data-start="1204.05" data-end="1207.38">that's still going on so can execution</span> <span data-start="1207.38" data-end="1209.15">will continue as long as any thread is</span> <span data-start="1209.15" data-end="1212.57">not blocked from the con side you have</span> <span data-start="1212.57" data-end="1214.6">to allocate stack memory for each thread</span> <span data-start="1214.6" data-end="1216.83">that was a problem once it's not a</span> <span data-start="1216.83" data-end="1218.6">problem now because memory is so</span> <span data-start="1218.6" data-end="1222.559">abundant a bigger problem is that if two</span> <span data-start="1222.559" data-end="1224.84">threads use the same memory a race may</span> <span data-start="1224.84" data-end="1230.42">occur and that is a big problem so here</span> <span data-start="1230.42" data-end="1233.33">we've got to JavaScript programs each is</span> <span data-start="1233.33" data-end="1235.25">only one line long each is going to run</span> <span data-start="1235.25" data-end="1237.47">in its own thread and they're both going</span> <span data-start="1237.47" data-end="1240.35">to run concurrently at the same time so</span> <span data-start="1240.35" data-end="1242.89">what would be the result of this program</span> <span data-start="1242.89" data-end="1245.69">one possible result would be the array a</span> <span data-start="1245.69" data-end="1249.35">and B and the other would be the array B</span> <span data-start="1249.35" data-end="1251.39">or a does everybody see how that could</span> <span data-start="1251.39" data-end="1253.49">happen because either those threads</span> <span data-start="1253.49" data-end="1255.86">could happen first and so you can't</span> <span data-start="1255.86" data-end="1257.57">predict ahead of time which is going to</span> <span data-start="1257.57" data-end="1261.559">win but that's not the big problem the</span> <span data-start="1261.559" data-end="1265.37">big problem is that there are two other</span> <span data-start="1265.37" data-end="1268.76">cases that could occur where after you</span> <span data-start="1268.76" data-end="1271.13">run that program you've got just a or</span> <span data-start="1271.13" data-end="1273.11">you've got just be that data has been</span> <span data-start="1273.11" data-end="1276.83">lost a hazard in thread programming is</span> <span data-start="1276.83" data-end="1278.17">any time you have a read-modify-write</span> <span data-start="1278.17" data-end="1282.47">which is basically all we do there's a</span> <span data-start="1282.47" data-end="1284.929">chance for collision so you can think of</span> <span data-start="1284.929" data-end="1289.309">threads as being cars or but they're</span> <span data-start="1289.309" data-end="1291.08">invisible cars so they can't see each</span> <span data-start="1291.08" data-end="1292.37">other but if they're ever in the same</span> <span data-start="1292.37" data-end="1296.87">place at the same time they crash so let</span> <span data-start="1296.87" data-end="1299.49">me show you what went on here</span> <span data-start="1299.49" data-end="1302.64">so when we append something to the end</span> <span data-start="1302.64" data-end="1304.74">of an array we can do that at one</span> <span data-start="1304.74" data-end="1306.3">statement in JavaScript but what</span> <span data-start="1306.3" data-end="1308.4">actually happens could be viewed as</span> <span data-start="1308.4" data-end="1311.82">several statements and so each of those</span> <span data-start="1311.82" data-end="1313.5">threads has those statements and they</span> <span data-start="1313.5" data-end="1315.809">could be interleaved in any possible way</span> <span data-start="1315.809" data-end="1317.58">there's no way to predict how they're</span> <span data-start="1317.58" data-end="1320.52">going to the interleaved and in this</span> <span data-start="1320.52" data-end="1322.52">case with this particular interleaving</span> <span data-start="1322.52" data-end="1326.36">the result is B because a gets clobbered</span> <span data-start="1326.36" data-end="1331.25">the last guy to write to the length wins</span> <span data-start="1331.25" data-end="1336.57">and this is terrible you know you</span> <span data-start="1336.57" data-end="1338.55">couldn't look at that program and see</span> <span data-start="1338.55" data-end="1341.58">you know what happened why'd our data</span> <span data-start="1341.58" data-end="1343.62">disappear well how did we command</span> <span data-start="1343.62" data-end="1345.36">consistent how do we become insecure</span> <span data-start="1345.36" data-end="1349.86">unreliable it's about all you can do is</span> <span data-start="1349.86" data-end="1351.48">say oh you're using threads there's your</span> <span data-start="1351.48" data-end="1354.87">problem so it's impossible to have</span> <span data-start="1354.87" data-end="1357.059">application integrity when subject to</span> <span data-start="1357.059" data-end="1361.77">race conditions now there's a solution</span> <span data-start="1361.77" data-end="1363.45">to raise conditions it's called mutual</span> <span data-start="1363.45" data-end="1366.71">exclusion so you can take some critical</span> <span data-start="1366.71" data-end="1369.03">section of code some set of statements</span> <span data-start="1369.03" data-end="1372.87">or some data structures and say only one</span> <span data-start="1372.87" data-end="1375.87">thread is able to have access to this at</span> <span data-start="1375.87" data-end="1380.64">a time and this has several names it's</span> <span data-start="1380.64" data-end="1382.47">sometimes called semaphores or monitors</span> <span data-start="1382.47" data-end="1384.42">or rendezvous in Java it's called</span> <span data-start="1384.42" data-end="1386.37">synchronization all these things are</span> <span data-start="1386.37" data-end="1388.95">pretty much equivalent this used to be</span> <span data-start="1388.95" data-end="1392.64">operating system stuff only people</span> <span data-start="1392.64" data-end="1394.29">writing operating systems ever cared</span> <span data-start="1394.29" data-end="1395.97">about this application programmers were</span> <span data-start="1395.97" data-end="1399.24">always exempt from it but it is leaked</span> <span data-start="1399.24" data-end="1401.37">into application space because of</span> <span data-start="1401.37" data-end="1405.72">networking because the delays now of</span> <span data-start="1405.72" data-end="1407.25">going over the network can be really</span> <span data-start="1407.25" data-end="1411.12">long and so having blocking I over the</span> <span data-start="1411.12" data-end="1413.73">network is intolerable and also because</span> <span data-start="1413.73" data-end="1416.1">of the multi-core problem that we have</span> <span data-start="1416.1" data-end="1419.13">lost the ability to make CPUs go faster</span> <span data-start="1419.13" data-end="1421.08">so to make systems go faster we have</span> <span data-start="1421.08" data-end="1424.77">more cpus and so now it's up to the</span> <span data-start="1424.77" data-end="1427.62">application developers to take advantage</span> <span data-start="1427.62" data-end="1428.38">of</span> <span data-start="1428.38" data-end="1430.24">that in order to make the machines go</span> <span data-start="1430.24" data-end="1432.13">faster because the hardware guy is have</span> <span data-start="1432.13" data-end="1434.83">given up and it turns out to be really</span> <span data-start="1434.83" data-end="1439.36">hard keeping multiple CPUs busy all at</span> <span data-start="1439.36" data-end="1441.49">the same time with one application is</span> <span data-start="1441.49" data-end="1443.86">something that is still an unsolved</span> <span data-start="1443.86" data-end="1448.98">problem but you're expected to do that</span> <span data-start="1448.98" data-end="1452.86">so under mutual exclusion only one</span> <span data-start="1452.86" data-end="1454.48">thread can be executing in a critical</span> <span data-start="1454.48" data-end="1457.39">section at a time and other threads that</span> <span data-start="1457.39" data-end="1458.83">are winged to execute in the critical</span> <span data-start="1458.83" data-end="1463.06">section are blocked if the threads don't</span> <span data-start="1463.06" data-end="1464.5">attract them the programs run at full</span> <span data-start="1464.5" data-end="1467.14">speed but if they do interact then races</span> <span data-start="1467.14" data-end="1469.3">will occur and less mutual exclusion is</span> <span data-start="1469.3" data-end="1471.1">employed but then there's another</span> <span data-start="1471.1" data-end="1473.11">problem there's the deadlock problem</span> <span data-start="1473.11" data-end="1475.81">where you've got two or more threads</span> <span data-start="1475.81" data-end="1479.41">which are waiting for another thread to</span> <span data-start="1479.41" data-end="1481.18">complete before they can proceed and</span> <span data-start="1481.18" data-end="1483.61">somehow they get into this deadly</span> <span data-start="1483.61" data-end="1484.87">embrace where they're waiting on each</span> <span data-start="1484.87" data-end="1487.99">other a real world example of this would</span> <span data-start="1487.99" data-end="1491.26">be gridlock we've got a bunch of cars</span> <span data-start="1491.26" data-end="1493.12">that all went into the intersection at</span> <span data-start="1493.12" data-end="1495.07">the same time this is Sal Paulo Brazil</span> <span data-start="1495.07" data-end="1500.36">about two blocks from the Yahoo office</span> <span data-start="1500.37" data-end="1502.66">they're all stuck everybody's waiting</span> <span data-start="1502.66" data-end="1504.37">for everybody else this is deadlock so</span> <span data-start="1504.37" data-end="1506.11">you don't want your programs doing this</span> <span data-start="1506.11" data-end="1507.85">and it turns out when you're doing</span> <span data-start="1507.85" data-end="1511.12">threads and synchronization deadlock is</span> <span data-start="1511.12" data-end="1512.95">really easy to cause and it's very</span> <span data-start="1512.95" data-end="1515.83">difficult to reason about so deadlock</span> <span data-start="1515.83" data-end="1517.45">occurs when threads are waiting on each</span> <span data-start="1517.45" data-end="1520.63">other races and deadlox are really hard</span> <span data-start="1520.63" data-end="1523.57">to think about they are the most</span> <span data-start="1523.57" data-end="1525.88">difficult problems to identify a debug</span> <span data-start="1525.88" data-end="1527.5">and correct one of the things that makes</span> <span data-start="1527.5" data-end="1529.18">them so hard is you can't predict when</span> <span data-start="1529.18" data-end="1531.16">they're going to occur and once they've</span> <span data-start="1531.16" data-end="1532.72">occurred that it may be impossible to</span> <span data-start="1532.72" data-end="1534.91">recreate so that they're the worst</span> <span data-start="1534.91" data-end="1537.1">possible kinds of bugs so managing</span> <span data-start="1537.1" data-end="1539.17">sequential logic which is what we do is</span> <span data-start="1539.17" data-end="1542.32">hard managing temporal logic is really</span> <span data-start="1542.32" data-end="1543.85">really hard and there are not many</span> <span data-start="1543.85" data-end="1548.98">people who can do that well so going</span> <span data-start="1548.98" data-end="1551.47">back to the cons if if two threads use</span> <span data-start="1551.47" data-end="1554.44">the same memory a race may occur and</span> <span data-start="1554.44" data-end="1557.35">that's actually worse than saying a race</span> <span data-start="1557.35" data-end="1560.5">will occur because if it if it does</span> <span data-start="1560.5" data-end="1562.34">occur predictably then you can</span> <span data-start="1562.34" data-end="1568.52">fix it but it may be that the temporal</span> <span data-start="1568.52" data-end="1570.32">signature of your program is really</span> <span data-start="1570.32" data-end="1571.94">different under test than it is in</span> <span data-start="1571.94" data-end="1575.21">production so it may work really well in</span> <span data-start="1575.21" data-end="1576.679">development but it fails when you show</span> <span data-start="1576.679" data-end="1580.039">it to your investors or it works really</span> <span data-start="1580.039" data-end="1582.049">well in in the early stage but fails</span> <span data-start="1582.049" data-end="1584.84">when you start to scale or it fails when</span> <span data-start="1584.84" data-end="1586.34">you're showing it to the MNA guys from</span> <span data-start="1586.34" data-end="1590.15">mega Corp they tend to go wrong at the</span> <span data-start="1590.15" data-end="1592.159">worst possible time there's some</span> <span data-start="1592.159" data-end="1594.559">overhead in thread management that it</span> <span data-start="1594.559" data-end="1596.419">doesn't come for free there's the threat</span> <span data-start="1596.419" data-end="1600.32">of deadlock which will just kill threads</span> <span data-start="1600.32" data-end="1602.419">and could possibly cascade to kill other</span> <span data-start="1602.419" data-end="1604.01">threads eventually strangling the whole</span> <span data-start="1604.01" data-end="1607.64">system thinking about reliability is</span> <span data-start="1607.64" data-end="1611.63">extremely difficult and ultimately what</span> <span data-start="1611.63" data-end="1613.88">we have is system application confusion</span> <span data-start="1613.88" data-end="1617.48">in my view the biggest design error in</span> </p>
<p><span data-start="1617.48" data-end="1619.19">Java was that it couldn't make up its</span> <span data-start="1619.19" data-end="1620.6">mind if it wanted to be a systems</span> <span data-start="1620.6" data-end="1623.27">language or an application language in a</span> <span data-start="1623.27" data-end="1624.77">systems language you have to have</span> <span data-start="1624.77" data-end="1627.08">threads in an application language you</span> <span data-start="1627.08" data-end="1629.75">should never have threads but because</span> <span data-start="1629.75" data-end="1632.539">they tried to bridge both they require</span> <span data-start="1632.539" data-end="1634.61">use of threads at the application level</span> <span data-start="1634.61" data-end="1637.13">and I think that's deadly fortunately</span> <span data-start="1637.13" data-end="1641.09">there is a good alternative to to</span> <span data-start="1641.09" data-end="1645.88">threading and that is that and that</span> <span data-start="1645.88" data-end="1647.929">alternative completely avoids all the</span> <span data-start="1647.929" data-end="1650.12">reliability hazards of threads and that</span> <span data-start="1650.12" data-end="1651.89">is the event loop or friendly event loop</span> <span data-start="1651.89" data-end="1654.44">it actually does all the stuff better so</span> <span data-start="1654.44" data-end="1658.549">again there are trade-offs the pro is</span> <span data-start="1658.549" data-end="1660.679">that it's completely free of races and</span> <span data-start="1660.679" data-end="1663.35">deadlox which is a huge huge advantage</span> <span data-start="1663.35" data-end="1665.45">you can be much more reliable turns out</span> <span data-start="1665.45" data-end="1666.97">you can also be much more efficient</span> <span data-start="1666.97" data-end="1669.77">there's only one stack which gets reused</span> <span data-start="1669.77" data-end="1672.83">on every turn that saves memory but</span> <span data-start="1672.83" data-end="1675.86">again that's not important anymore very</span> <span data-start="1675.86" data-end="1678.44">low overhead you don't have task</span> <span data-start="1678.44" data-end="1682.279">switching you're not doing memory faults</span> <span data-start="1682.279" data-end="1685.1">you're not doing any thread locking all</span> <span data-start="1685.1" data-end="1687.22">that expensive stuff you're just doing</span> <span data-start="1687.22" data-end="1690.049">computation as fast as machine can go</span> <span data-start="1690.049" data-end="1692.36">all of the idle time has been squeezed</span> <span data-start="1692.36" data-end="1693.1">out</span> <span data-start="1693.1" data-end="1695.38">just have pure computation the thing</span> <span data-start="1695.38" data-end="1697.12">that computers do best and it's</span> <span data-start="1697.12" data-end="1699.97">resilient if any turn fails the program</span> <span data-start="1699.97" data-end="1702.669">can still go on whereas in a thread</span> <span data-start="1702.669" data-end="1706.84">based system if any stack fails there's</span> <span data-start="1706.84" data-end="1708.58">a chance that that may cause cascading</span> <span data-start="1708.58" data-end="1711.46">failure of other threads as well now</span> <span data-start="1711.46" data-end="1714.789">comes with some cons cons are that the</span> <span data-start="1714.789" data-end="1716.65">program is never block you have to obey</span> <span data-start="1716.65" data-end="1719.2">the prime directive you have to program</span> <span data-start="1719.2" data-end="1722.08">inside out Wow but again your good of</span> <span data-start="1722.08" data-end="1725.169">this and turns must finish quickly this</span> <span data-start="1725.169" data-end="1726.28">is probably the most important</span> <span data-start="1726.28" data-end="1727.99">restriction says that not all</span> <span data-start="1727.99" data-end="1730.51">applications are well suited to running</span> <span data-start="1730.51" data-end="1733.15">as event loops but it turns out at very</span> <span data-start="1733.15" data-end="1736.419">large class of applications are so for</span> <span data-start="1736.419" data-end="1738.19">long running tasks like if you have to</span> <span data-start="1738.19" data-end="1741.4">factor pie in your web application which</span> <span data-start="1741.4" data-end="1743.01">is not something most of us have to do</span> <span data-start="1743.01" data-end="1746.44">there are two solutions for managing</span> <span data-start="1746.44" data-end="1748.409">that one is to use a technique called</span> <span data-start="1748.409" data-end="1751.51">iteration in which we break the task</span> <span data-start="1751.51" data-end="1754.15">into multiple turns and keep</span> <span data-start="1754.15" data-end="1756.25">resubmitting those turns to the event</span> <span data-start="1756.25" data-end="1758.34">queue for example you could have a</span> <span data-start="1758.34" data-end="1762.22">process in which you do one step of the</span> <span data-start="1762.22" data-end="1764.86">computation then do a set time out of</span> <span data-start="1764.86" data-end="1767.65">zero passing in the function which will</span> <span data-start="1767.65" data-end="1769.78">cause the next step in that computation</span> <span data-start="1769.78" data-end="1771.549">to happen you just keep doing that until</span> <span data-start="1771.549" data-end="1773.62">it finishes now that could end up taking</span> <span data-start="1773.62" data-end="1776.74">a very long time but each turn will be</span> <span data-start="1776.74" data-end="1778.87">very short and so the liveliness of the</span> <span data-start="1778.87" data-end="1781.84">system is maintained and all is good the</span> <span data-start="1781.84" data-end="1784.27">other thing you can do is move the task</span> <span data-start="1784.27" data-end="1786.34">into a separate process or worker and</span> <span data-start="1786.34" data-end="1788.71">that's a brilliant thing too one of the</span> <span data-start="1788.71" data-end="1790.57">advantages of workers is there's no</span> <span data-start="1790.57" data-end="1792.07">requirement that they actually be in the</span> <span data-start="1792.07" data-end="1794.35">same machine so we could send them</span> <span data-start="1794.35" data-end="1796.99">across the network and wherever we gots</span> <span data-start="1796.99" data-end="1800.02">their capability we can we can put them</span> <span data-start="1800.02" data-end="1802.15">and so that becomes a really powerful</span> <span data-start="1802.15" data-end="1804.94">model and in the event driven system</span> <span data-start="1804.94" data-end="1807.67">being fully distributed comes as a</span> <span data-start="1807.67" data-end="1812.74">fallout another approach people take to</span> <span data-start="1812.74" data-end="1814.93">doing io in programming languages over</span> <span data-start="1814.93" data-end="1816.55">the network is the remote procedure call</span> <span data-start="1816.55" data-end="1819.34">which combines two great ideas functions</span> <span data-start="1819.34" data-end="1821.44">and networking produces a really bad</span> <span data-start="1821.44" data-end="1824.8">idea like read it attempts to isolate</span> <span data-start="1824.8" data-end="1828.46">programs from time but the effect of</span> <span data-start="1828.46" data-end="1830.26">that is that the program blocks blacks</span> <span data-start="1830.26" data-end="1834.07">out it has last lost time so when you're</span> <span data-start="1834.07" data-end="1836.11">reading the program it's very difficult</span> <span data-start="1836.11" data-end="1839.65">by design by intention to see where it</span> <span data-start="1839.65" data-end="1843.21">is that time is being lost because the</span> <span data-start="1843.21" data-end="1845.62">blocking network calls are made to look</span> <span data-start="1845.62" data-end="1847.69">like local function calls you just can't</span> <span data-start="1847.69" data-end="1850.54">see where the time is going and that can</span> <span data-start="1850.54" data-end="1852.25">result in a very terrible experience for</span> <span data-start="1852.25" data-end="1855.94">the user because they see you know the</span> <span data-start="1855.94" data-end="1858.52">program blacks out and so the user is</span> <span data-start="1858.52" data-end="1862.27">going are you dead hello and that's it's</span> <span data-start="1862.27" data-end="1864.61">rude and disrespectful we should never</span> <span data-start="1864.61" data-end="1867.22">do that to human beings but it's hard to</span> <span data-start="1867.22" data-end="1869.26">avoid doing that when when you've got a</span> <span data-start="1869.26" data-end="1871.99">remote procedure call so we should be</span> <span data-start="1871.99" data-end="1873.25">doing the opposite we should be doing</span> <span data-start="1873.25" data-end="1875.47">latency compensation we want to give the</span> <span data-start="1875.47" data-end="1878.5">user feedback as early as possible the</span> <span data-start="1878.5" data-end="1880.96">leptin note were we were listening to</span> <span data-start="1880.96" data-end="1883">you we're working for you we tried to do</span> <span data-start="1883" data-end="1887.23">things we don't ever want to lock up the</span> <span data-start="1887.23" data-end="1888.94">browser of the client while we're</span> <span data-start="1888.94" data-end="1890.44">waiting for the network to do anything</span> <span data-start="1890.44" data-end="1893.5">in some applications the client can</span> <span data-start="1893.5" data-end="1895.6">predict what the server's response is</span> <span data-start="1895.6" data-end="1898.81">going to be and go ahead and do it so</span> <span data-start="1898.81" data-end="1900.61">the user gets immediate feedback and if</span> <span data-start="1900.61" data-end="1902.44">it turns out that the prediction was</span> <span data-start="1902.44" data-end="1905.62">incorrect then correct it later for</span> <span data-start="1905.62" data-end="1907.45">example if you have a game or chat</span> <span data-start="1907.45" data-end="1909.63">application being played over the net</span> <span data-start="1909.63" data-end="1912.82">the user makes a move and locally you</span> <span data-start="1912.82" data-end="1914.86">can determine that's a valid move or if</span> <span data-start="1914.86" data-end="1918.37">it's just a chat message go ahead and</span> <span data-start="1918.37" data-end="1921.01">display it as though it was accepted in</span> <span data-start="1921.01" data-end="1922.33">a few seconds you'll get the feedback</span> <span data-start="1922.33" data-end="1923.92">from the server telling you whether that</span> <span data-start="1923.92" data-end="1927.64">happened or not and if it did then you</span> <span data-start="1927.64" data-end="1929.41">can ignore that and if it didn't</span> <span data-start="1929.41" data-end="1934.48">than you correct it so security is</span> <span data-start="1934.48" data-end="1936.52">always important and and you really</span> <span data-start="1936.52" data-end="1937.9">can't have security if you don't have</span> <span data-start="1937.9" data-end="1939.22">reliability and we don't have your</span> <span data-start="1939.22" data-end="1941.5">liability when we have threads so we</span> <span data-start="1941.5" data-end="1945.37">have a much more secure model with the</span> <span data-start="1945.37" data-end="1947.68">event loop now just having event loops</span> <span data-start="1947.68" data-end="1949.39">does not guarantee that you're going to</span> <span data-start="1949.39" data-end="1952.6">be secure for example the browser is an</span> <span data-start="1952.6" data-end="1954.34">event loop driven system and were</span> <span data-start="1954.34" data-end="1956.02">subject to cross-site scripting attacks</span> <span data-start="1956.02" data-end="1958.99">which is terrible this is the worst</span> <span data-start="1958.99" data-end="1961.11">problem that we have in the browser</span> <span data-start="1961.11" data-end="1964.78">cross-site scripting has two causes the</span> <span data-start="1964.78" data-end="1966.82">sharing of the global object so every</span> <span data-start="1966.82" data-end="1968.41">piece of script no matter where comes</span> <span data-start="1968.41" data-end="1970.3">from gets in the same global object</span> <span data-start="1970.3" data-end="1972.73">which gives it all the same privileges</span> <span data-start="1972.73" data-end="1974.59">that your own site does including the</span> <span data-start="1974.59" data-end="1977.77">ability to interact with the entire</span> <span data-start="1977.77" data-end="1981.31">document to talk to the user if the user</span> <span data-start="1981.31" data-end="1982.66">is looking at the anti addition chrome</span> <span data-start="1982.66" data-end="1986.44">the chrome will say yeah legit gives you</span> <span data-start="1986.44" data-end="1988.83">the ability to talk to the server if</span> <span data-start="1988.83" data-end="1991.27">there's an SSL connection you get access</span> <span data-start="1991.27" data-end="1993.85">to the SSL ssl connection you get access</span> <span data-start="1993.85" data-end="1995.65">to all the cookies everything really</span> <span data-start="1995.65" data-end="2000.11">terrible there's also misinterpret</span> <span data-start="2000.11" data-end="2003.33">misinterpretation of HTML HTML is such a</span> <span data-start="2003.33" data-end="2005.55">complicated language with other</span> <span data-start="2005.55" data-end="2007.62">languages inside of it that it's very</span> <span data-start="2007.62" data-end="2009.9">difficult to determine if a piece of</span> <span data-start="2009.9" data-end="2012.54">code is going to be safe tragically</span> <span data-start="2012.54" data-end="2016.26">html5 ignores and worsens the xss</span> <span data-start="2016.26" data-end="2020.28">problem in recently the html5 editor</span> <span data-start="2020.28" data-end="2023.58">said that html5 doesn't ever have markup</span> <span data-start="2023.58" data-end="2027.45">injection vulnerabilities which is wrong</span> <span data-start="2027.45" data-end="2032.25">completely wrong so we can't expect help</span> <span data-start="2032.25" data-end="2035.1">from w3c but they're apparently not even</span> <span data-start="2035.1" data-end="2037.83">aware that there's a problem not</span> <span data-start="2037.83" data-end="2039">understanding the problem they're</span> <span data-start="2039" data-end="2041.82">unlikely to ever give us a solution so</span> <span data-start="2041.82" data-end="2044.04">the browser is a loaded gun aimed at</span> <span data-start="2044.04" data-end="2046.68">your head and that's what pulls the</span> <span data-start="2046.68" data-end="2052.33">trigger so page templates</span> <span data-start="2052.33" data-end="2056.72">are you know like PHP ASP JSP all those</span> </p>
<p><span data-start="2056.72" data-end="2059.389">Peas used to be a good way to develop</span> <span data-start="2059.389" data-end="2063.56">web applications but it there are some</span> <span data-start="2063.56" data-end="2065.33">problems with them now that one is that</span> <span data-start="2065.33" data-end="2067.58">the a template is to Richard a framework</span> <span data-start="2067.58" data-end="2069.59">that we're now building extremely</span> <span data-start="2069.59" data-end="2071.99">dynamic pages out of lots of components</span> <span data-start="2071.99" data-end="2073.72">coming from lots of different places and</span> <span data-start="2073.72" data-end="2076.429">putting them all into a simple template</span> <span data-start="2076.429" data-end="2079.429">really doesn't work very well but worse</span> <span data-start="2079.429" data-end="2081.83">than that it's way too easy to insert</span> <span data-start="2081.83" data-end="2083.929">text into a context where it might be</span> <span data-start="2083.929" data-end="2087.23">misinterpreted and executed completing</span> <span data-start="2087.23" data-end="2091.609">an XSS attack so can we do better by</span> <span data-start="2091.609" data-end="2094.22">using javascript on the server and there</span> <span data-start="2094.22" data-end="2095.98">are some obvious advantages to being</span> <span data-start="2095.98" data-end="2098.24">server side JavaScript one is that we</span> <span data-start="2098.24" data-end="2099.619">can take advantage of our new</span> <span data-start="2099.619" data-end="2101.39">understanding of JavaScript that turns</span> <span data-start="2101.39" data-end="2103.73">out javascript is a powerful expressive</span> <span data-start="2103.73" data-end="2105.38">programming language we can apply that</span> <span data-start="2105.38" data-end="2108.859">to server-side programming as well it</span> <span data-start="2108.859" data-end="2110.05">turns out this is not a new idea</span> <span data-start="2110.05" data-end="2111.98">netscape offered a server-side</span> </p>
<p><span data-start="2111.98" data-end="2115.76">JavaScript product in 1996 and it was</span> <span data-start="2115.76" data-end="2119.9">awful it used it was modeled after PHP</span> <span data-start="2119.9" data-end="2122.54">so it had a server tag in which which</span> <span data-start="2122.54" data-end="2124.07">looked like a script tag except it was</span> <span data-start="2124.07" data-end="2125.72">gripped that was going to run on the</span> <span data-start="2125.72" data-end="2127.94">server side and it had a write function</span> <span data-start="2127.94" data-end="2130.07">for inserting stuff into the outgoing</span> <span data-start="2130.07" data-end="2132.53">HTML stream it's just like document</span> <span data-start="2132.53" data-end="2136.66">right except on the server just as bad</span> <span data-start="2136.66" data-end="2139.13">so it had all the disadvantages of the</span> <span data-start="2139.13" data-end="2141.2">other page template assist amande at the</span> <span data-start="2141.2" data-end="2145.94">time really slow JavaScript engines so</span> <span data-start="2145.94" data-end="2148.01">what if we did it right what if we model</span> <span data-start="2148.01" data-end="2149.99">the server side using the same things</span> <span data-start="2149.99" data-end="2152.06">that we learned work so well on the</span> <span data-start="2152.06" data-end="2154.97">client side what if we had an event loop</span> <span data-start="2154.97" data-end="2158.09">in the server and it turns out that's</span> <span data-start="2158.09" data-end="2160.16">what no Jas is and there there are other</span> <span data-start="2160.16" data-end="2162.41">people doing similar stuff nodejs is the</span> <span data-start="2162.41" data-end="2163.92">the front-runner right now</span> <span data-start="2163.92" data-end="2166.98">and and there's really well worth</span> <span data-start="2166.98" data-end="2169.71">looking at so no Jas implements a web</span> <span data-start="2169.71" data-end="2174">server in a javascript event loop it is</span> <span data-start="2174" data-end="2176.67">a high-performance event pump it it</span> <span data-start="2176.67" data-end="2178.5">takes the event queue and pulls things</span> <span data-start="2178.5" data-end="2181.319">out and and doesn't really fast it</span> <span data-start="2181.319" data-end="2183.78">optimizes the event loop dispatch you</span> <span data-start="2183.78" data-end="2185.67">can get a lot of work done very quickly</span> <span data-start="2185.67" data-end="2188.549">all of the overhead is squeezed out so</span> <span data-start="2188.549" data-end="2191.39">the event queue is just pure computation</span> <span data-start="2191.39" data-end="2194.849">it got read right so filesystem read</span> <span data-start="2194.849" data-end="2197.28">takes a call back so it doesn't block</span> <span data-start="2197.28" data-end="2199.5">which is perfect that's exactly how we'd</span> <span data-start="2199.5" data-end="2203.67">should work everything in the no jsapi</span> <span data-start="2203.67" data-end="2206.25">is non blocking except there are some</span> <span data-start="2206.25" data-end="2207.93">synchronous functions which do block</span> <span data-start="2207.93" data-end="2210.27">there are non blocking versions but</span> <span data-start="2210.27" data-end="2212.16">there shouldn't be anything that blocks</span> <span data-start="2212.16" data-end="2214.079">and also require is blocking I think</span> <span data-start="2214.079" data-end="2216.42">that was a mistake as well it the model</span> <span data-start="2216.42" data-end="2218.13">really requires that everything be non</span> <span data-start="2218.13" data-end="2220.68">blocking but other than that no jf seems</span> <span data-start="2220.68" data-end="2223.47">to have gotten everything right so one</span> <span data-start="2223.47" data-end="2225.359">of the advantages of this is that you</span> <span data-start="2225.359" data-end="2227.64">can run your code on both sides of the</span> <span data-start="2227.64" data-end="2231.619">network so we have Yui 3 now running on</span> <span data-start="2231.619" data-end="2235.68">though j/s with a pseudo Dom so we can</span> <span data-start="2235.68" data-end="2237.75">now run exactly the same code in both</span> <span data-start="2237.75" data-end="2240.569">places and we can take advantage of of</span> <span data-start="2240.569" data-end="2243.18">why you eyes communication manager on</span> <span data-start="2243.18" data-end="2246.45">the server to go out and talk to say 10</span> <span data-start="2246.45" data-end="2248.16">different services which are going to</span> <span data-start="2248.16" data-end="2250.829">send back data which will get assembled</span> <span data-start="2250.829" data-end="2253.23">into your page and we can make all of</span> <span data-start="2253.23" data-end="2256.559">those requests simultaneously and so the</span> <span data-start="2256.559" data-end="2259.319">net cost is the max of all of those</span> <span data-start="2259.319" data-end="2262.65">requests whereas in PHP the net cost is</span> <span data-start="2262.65" data-end="2263.849">going to be the sum of all those</span> <span data-start="2263.849" data-end="2265.47">requests which is going to be a much</span> <span data-start="2265.47" data-end="2267.96">larger number now it turns out in PHP</span> <span data-start="2267.96" data-end="2271.74">you can do it the hard way but nobody</span> <span data-start="2271.74" data-end="2275.069">wants to do hard in PHP right that's it</span> <span data-start="2275.069" data-end="2277.859">that's not what it's for whereas in</span> </p>
<p><span data-start="2277.859" data-end="2282">JavaScript under Yui it is easy you just</span> <span data-start="2282" data-end="2284.579">wait for all the event handlers or all</span> <span data-start="2284.579" data-end="2286.65">the callbacks to fire and once they've</span> <span data-start="2286.65" data-end="2289.29">all fired on with the show so it's</span> <span data-start="2289.29" data-end="2291.859">really brilliant also we're finding that</span> <span data-start="2291.859" data-end="2294.63">we've got a really nice fallback story</span> <span data-start="2294.63" data-end="2295.57">now</span> <span data-start="2295.57" data-end="2299.75">we can if we sense where the browser is</span> <span data-start="2299.75" data-end="2302.78">a piece of crap like I don't say for</span> <span data-start="2302.78" data-end="2307.73">random ie6 and we're tired of supporting</span> <span data-start="2307.73" data-end="2311.57">ie6 we can run it all on the server and</span> <span data-start="2311.57" data-end="2315.59">just send them page views or if we</span> <span data-start="2315.59" data-end="2317.21">decide that our startup is taking too</span> <span data-start="2317.21" data-end="2318.71">long because we've got a huge amount of</span> <span data-start="2318.71" data-end="2320.69">code we might want to do the first view</span> <span data-start="2320.69" data-end="2323.66">on the server so that people can be</span> <span data-start="2323.66" data-end="2325.07">looking at that while the rest of the</span> <span data-start="2325.07" data-end="2328.67">script is loading on the browser we can</span> <span data-start="2328.67" data-end="2330.14">do that as well you don't have to write</span> <span data-start="2330.14" data-end="2331.55">everything two or three times to</span> <span data-start="2331.55" data-end="2333.08">accomplish all those things you only</span> <span data-start="2333.08" data-end="2335.48">have to write at once and with a good</span> <span data-start="2335.48" data-end="2338.09">library under you it just works so we've</span> <span data-start="2338.09" data-end="2339.53">got a lot of mobility a lot of</span> <span data-start="2339.53" data-end="2345.13">flexibility so good stuff they're</span> <span data-start="2345.13" data-end="2347.12">looking a little deeper looking at the</span> <span data-start="2347.12" data-end="2349.73">network itself we've got this stack of</span> <span data-start="2349.73" data-end="2352.43">protocols at the bottom we've got IP</span> <span data-start="2352.43" data-end="2355.7">which can deliver a packet from any</span> <span data-start="2355.7" data-end="2357.74">computer in the world to any other</span> <span data-start="2357.74" data-end="2360.05">computer in the world almost all the</span> <span data-start="2360.05" data-end="2362.66">time which is an amazing thing then on</span> <span data-start="2362.66" data-end="2365.39">top of that we've got TCP which provides</span> <span data-start="2365.39" data-end="2369.59">sessions reliability packet reordering</span> <span data-start="2369.59" data-end="2372.44">which is good stuff then we've got HTTP</span> <span data-start="2372.44" data-end="2374.23">which is really a document delivery</span> <span data-start="2374.23" data-end="2376.88">protocol which is stateless then on top</span> <span data-start="2376.88" data-end="2378.92">of that we're trying to do messaging in</span> </p>
<p><span data-start="2378.92" data-end="2382.66">Ajax but we have to do it on top of me</span> <span data-start="2382.66" data-end="2385.76">HTTP which has a lot of beneficence e in</span> <span data-start="2385.76" data-end="2388.37">it and it wants to be stateless but we</span> <span data-start="2388.37" data-end="2391.52">really want to be stateful because we're</span> <span data-start="2391.52" data-end="2393.8">doing session applications and so it'd</span> <span data-start="2393.8" data-end="2395.93">be really nice if we could just get rid</span> <span data-start="2395.93" data-end="2400.52">of HTTP and runny Jack's on top of TCP I</span> <span data-start="2400.52" data-end="2402.05">don't think we're ever going to be able</span> <span data-start="2402.05" data-end="2403.13">to do that because there's so much</span> <span data-start="2403.13" data-end="2405.06">arthritis or built into a network</span> <span data-start="2405.06" data-end="2407.43">now you know all the various proxy</span> <span data-start="2407.43" data-end="2409.02">servers and firewalls and stuff like</span> <span data-start="2409.02" data-end="2410.94">that that'll probably never work which</span> <span data-start="2410.94" data-end="2414.12">is really a shame so let's sort of go</span> <span data-start="2414.12" data-end="2417.15">back to the beginning of time so first</span> <span data-start="2417.15" data-end="2418.83">there was a browser and there was a</span> <span data-start="2418.83" data-end="2422.22">server and the browser makes requests to</span> <span data-start="2422.22" data-end="2426.9">the server and documents go back then we</span> <span data-start="2426.9" data-end="2430.14">got to the point where the demand on the</span> <span data-start="2430.14" data-end="2432.45">server was so large that a single server</span> <span data-start="2432.45" data-end="2435">couldn't do it anymore so there are</span> <span data-start="2435" data-end="2437.31">various implementations of having some</span> <span data-start="2437.31" data-end="2439.02">kind distributor which goes in front of</span> <span data-start="2439.02" data-end="2441.09">the site which can then direct traffic</span> <span data-start="2441.09" data-end="2443.28">maybe on a round-robin or at least used</span> <span data-start="2443.28" data-end="2446.1">or whatever basis to other servers</span> <span data-start="2446.1" data-end="2449.22">that'll actually do the work and then</span> <span data-start="2449.22" data-end="2451.4">they all go to a common database</span> <span data-start="2451.4" data-end="2453.54">initially that tends to be some kind of</span> </p>
<p><span data-start="2453.54" data-end="2457.05">SQL machine and if you're at all</span> <span data-start="2457.05" data-end="2459.29">successful that's going to fail because</span> <span data-start="2459.29" data-end="2462.84">it won't scale big enough to meet what</span> <span data-start="2462.84" data-end="2466.14">you have to do so you do tricks to make</span> <span data-start="2466.14" data-end="2469.74">SQL scale you'll you know splinter it or</span> <span data-start="2469.74" data-end="2472.17">do other things which violate the</span> <span data-start="2472.17" data-end="2474.69">relational model but you don't have to</span> <span data-start="2474.69" data-end="2476.4">rethink anything and that turns out to</span> <span data-start="2476.4" data-end="2480.03">be the most important thing but the</span> <span data-start="2480.03" data-end="2482.4">other approach is to consider a no SQL</span> <span data-start="2482.4" data-end="2484.32">database and I love these things so</span> <span data-start="2484.32" data-end="2486.66">we've got like couch and Mongo and a</span> <span data-start="2486.66" data-end="2489.42">whole bunch of others which are just</span> <span data-start="2489.42" data-end="2491.73">acting brilliantly there it turns out</span> <span data-start="2491.73" data-end="2496.41">yahoo has had a massive homegrown no SQL</span> <span data-start="2496.41" data-end="2501.81">database in productions of 1996 so these</span> <span data-start="2501.81" data-end="2505.05">are really good things so then we put</span> </p>
<p><span data-start="2505.05" data-end="2507.06">Ajax on top of this and now in addition</span> <span data-start="2507.06" data-end="2509.46">to the persistent state that you want to</span> <span data-start="2509.46" data-end="2511.05">keep in the database you've got a</span> <span data-start="2511.05" data-end="2514.65">femoral session state you know choose</span> <span data-start="2514.65" data-end="2516.09">sort of stuff that you're talking about</span> <span data-start="2516.09" data-end="2518.52">that isn't ready to commit yet where do</span> <span data-start="2518.52" data-end="2522.21">you put that stuff in this model where</span> <span data-start="2522.21" data-end="2524.49">you have the distributor you can't keep</span> <span data-start="2524.49" data-end="2526.65">it in the servers because each request</span> <span data-start="2526.65" data-end="2528.38">might end up going to a different server</span> <span data-start="2528.38" data-end="2530.7">so you end up having to put this</span> <span data-start="2530.7" data-end="2532.05">ephemeral information in the database</span> <span data-start="2532.05" data-end="2534.24">which is maybe the worst place in the</span> <span data-start="2534.24" data-end="2534.779">universe</span> <span data-start="2534.779" data-end="2538.709">you want to put it another approach to</span> <span data-start="2538.709" data-end="2540.959">that is something that you see in the</span> </p>
<p><span data-start="2540.959" data-end="2543.959">Elco server developed by chip morning</span> <span data-start="2543.959" data-end="2546.39">star in which the browser connects</span> <span data-start="2546.39" data-end="2548.219">initially to a session director and the</span> <span data-start="2548.219" data-end="2550.529">session director will then appoint some</span> <span data-start="2550.529" data-end="2552.749">server to be the place where the session</span> <span data-start="2552.749" data-end="2555.15">will live and from that point on the</span> <span data-start="2555.15" data-end="2556.65">browser connects only to that particular</span> <span data-start="2556.65" data-end="2559.979">server that server can then keep it's</span> <span data-start="2559.979" data-end="2561.9">ephemeral state in the most efficient</span> <span data-start="2561.9" data-end="2563.189">place in the world which is in</span> </p>
<p><span data-start="2563.189" data-end="2565.13">JavaScript variables which are</span> <span data-start="2565.13" data-end="2567.9">enclosures bound to the event handlers</span> <span data-start="2567.9" data-end="2570.659">in the event queue in the server so that</span> <span data-start="2570.659" data-end="2575.4">the overhead for getting at at session</span> <span data-start="2575.4" data-end="2577.89">state is zero it's absolutely free</span> <span data-start="2577.89" data-end="2579.779">there's no api for getting that stuff</span> <span data-start="2579.779" data-end="2582.779">because it's just in variables so it's</span> <span data-start="2582.779" data-end="2591.059">extremely efficient so i was talking to</span> <span data-start="2591.059" data-end="2592.739">a good friend of mine recently well</span> <span data-start="2592.739" data-end="2595.589">really smart guy about javascript and</span> <span data-start="2595.589" data-end="2597.419">what we might do with it and i was</span> <span data-start="2597.419" data-end="2599.999">talking about how i would like to see us</span> <span data-start="2599.999" data-end="2602.969">implement the tail recursion</span> <span data-start="2602.969" data-end="2606.059">optimization i talked about earlier in</span> <span data-start="2606.059" data-end="2610.809">the language that would allow us to do</span> <span data-start="2610.819" data-end="2614.64">recursion for looping which would have</span> <span data-start="2614.64" data-end="2616.799">some efficiency benefits also what</span> <span data-start="2616.799" data-end="2619.229">allows to have new styles of programming</span> <span data-start="2619.229" data-end="2620.939">available such as continuation passing</span> <span data-start="2620.939" data-end="2624.299">style and his answer to that was that</span> <span data-start="2624.299" data-end="2625.949">he'd never used continuation passing</span> <span data-start="2625.949" data-end="2628.249">style so he didn't see the value of it</span> <span data-start="2628.249" data-end="2631.529">and I immediately recognized that as a</span> <span data-start="2631.529" data-end="2634.019">stupid answer and I knew it was a stupid</span> <span data-start="2634.019" data-end="2635.609">answer because I have made that same</span> <span data-start="2635.609" data-end="2637.319">stupid arguments many times in my career</span> <span data-start="2637.319" data-end="2639.15">and I've been hearing that same stupid</span> <span data-start="2639.15" data-end="2641.939">stuff as long as I've been a programmer</span> </p>
<p><span data-start="2641.939" data-end="2645.539">I've heard that argument used to explain</span> <span data-start="2645.539" data-end="2646.949">why we shouldn't do event programming</span> <span data-start="2646.949" data-end="2648.299">why we shouldn't use high level</span> <span data-start="2648.299" data-end="2652.799">languages why we don't need recursion</span> <span data-start="2652.799" data-end="2654.39">why we don't need closure and functions</span> <span data-start="2654.39" data-end="2656.479">I don't understand it never needed it</span> <span data-start="2656.479" data-end="2659.519">what good is it I can do my job</span> <span data-start="2659.519" data-end="2662.489">perfectly well without knowing any more</span> <span data-start="2662.489" data-end="2663.34">than what I know</span> <span data-start="2663.34" data-end="2665.85">and that's a really dangerous thing so</span> <span data-start="2665.85" data-end="2670.33">when Grace Hopper are we've come a long</span> <span data-start="2670.33" data-end="2672.49">way in software engineering since Grace</span> <span data-start="2672.49" data-end="2674.68">Hopper started us on the road of using</span> <span data-start="2674.68" data-end="2677.17">software to develop software and we have</span> <span data-start="2677.17" data-end="2682.21">a long way yet to go and in my view we</span> <span data-start="2682.21" data-end="2684.19">should be a lot farther along by now</span> <span data-start="2684.19" data-end="2688.33">than when we are and I think it's mainly</span> <span data-start="2688.33" data-end="2689.8">because we get our own way that</span> <span data-start="2689.8" data-end="2692.08">basically to take the next step forward</span> <span data-start="2692.08" data-end="2693.58">we have to wait for a generation of</span> <span data-start="2693.58" data-end="2696.25">programmers to die off before we can get</span> <span data-start="2696.25" data-end="2698.8">critical mass of brains on the powerful</span> <span data-start="2698.8" data-end="2701.26">no idea to go forward and we're now in</span> <span data-start="2701.26" data-end="2703.03">this really interesting position where</span> <span data-start="2703.03" data-end="2704.23">we're about to take the next step</span> <span data-start="2704.23" data-end="2706.27">forward in application development and</span> <span data-start="2706.27" data-end="2708.87">the language which is leading the way is</span> </p>
<p><span data-start="2708.87" data-end="2711.76">JavaScript which is amazing javascript</span> <span data-start="2711.76" data-end="2714.94">has transformed from this horrible</span> <span data-start="2714.94" data-end="2716.92">little language that we can barely</span> <span data-start="2716.92" data-end="2719.35">tolerate to language which we're</span> <span data-start="2719.35" data-end="2722.05">embracing and is now leading everyone</span> <span data-start="2722.05" data-end="2728.14">else so um show of hands anybody having</span> <span data-start="2728.14" data-end="2737.74">strong</span> <span data-start="2737.75" data-end="2739.98">let's try one more what do you think of</span> <span data-start="2739.98" data-end="2751.05">this all opposed let's see two or three</span> <span data-start="2751.05" data-end="2760.11">hands okay how about that Wow now how</span> <span data-start="2760.11" data-end="2763.68">about this one I think it is too soon to</span> <span data-start="2763.68" data-end="2766.38">call I see Microsoft doing some really</span> <span data-start="2766.38" data-end="2769.11">good work on ie9 I've seen some</span> <span data-start="2769.11" data-end="2771.06">applications which are running better on</span> <span data-start="2771.06" data-end="2775.05">ie9 than any other browser so kudos to</span> </p>
<p><span data-start="2775.05" data-end="2779.34">Microsoft for that but then we got that</span> <span data-start="2779.34" data-end="2782.37">bombshell last night when Pete from</span> <span data-start="2782.37" data-end="2784.83">Microsoft told us that they don't intend</span> <span data-start="2784.83" data-end="2788.04">to implement all of equus script five in</span> <span data-start="2788.04" data-end="2790.05">that standards compliance is apparently</span> <span data-start="2790.05" data-end="2793.14">not important to them I'm really</span> <span data-start="2793.14" data-end="2796.32">distressed by that so in my view the</span> <span data-start="2796.32" data-end="2799.35">only web standard that matters is the</span> <span data-start="2799.35" data-end="2802.83">aircon script standard because the DOM</span> <span data-start="2802.83" data-end="2805.05">is crap right does everyone everybody</span> <span data-start="2805.05" data-end="2807.48">knows that the standards for the Dom are</span> <span data-start="2807.48" data-end="2809.85">crap it's always been crap we have</span> <span data-start="2809.85" data-end="2812.25">terrible portability terrible</span> <span data-start="2812.25" data-end="2814.47">reliability it's at the wrong level of</span> <span data-start="2814.47" data-end="2818.3">abstraction everything about it is wrong</span> <span data-start="2818.3" data-end="2821.31">but with JavaScript somehow we've made</span> <span data-start="2821.31" data-end="2823.32">it work javascript is sort of the</span> <span data-start="2823.32" data-end="2825.96">ultimate workaround tool whatever crap</span> <span data-start="2825.96" data-end="2828.42">the browser can throw at us we can</span> <span data-start="2828.42" data-end="2831.51">manage it with javascript and there a</span> <span data-start="2831.51" data-end="2832.98">couple of reasons for that one is that</span> <span data-start="2832.98" data-end="2835.47">javascript actually got a lot of stuff</span> <span data-start="2835.47" data-end="2837.51">right it's actually a brilliant language</span> <span data-start="2837.51" data-end="2840.3">despite its its defense you know deep</span> <span data-start="2840.3" data-end="2843.45">down there is brilliance in the core of</span> <span data-start="2843.45" data-end="2846.14">the language the other thing is that</span> <span data-start="2846.14" data-end="2850.8">it's extremely portable that if you</span> <span data-start="2850.8" data-end="2852.51">stick to the core part of the language</span> <span data-start="2852.51" data-end="2854.94">you know that's sort of the giant subset</span> <span data-start="2854.94" data-end="2857.76">of the language it runs everywhere it it</span> <span data-start="2857.76" data-end="2859.89">keeps the write once run everywhere</span> <span data-start="2859.89" data-end="2864.18">promised that java failed to keep and so</span> <span data-start="2864.18" data-end="2865.47">that's why it's so distressing that</span> </p>
<p><span data-start="2865.47" data-end="2867.96">Microsoft is now saying that standards</span> <span data-start="2867.96" data-end="2868.59">compliant</span> <span data-start="2868.59" data-end="2870.75">with the only web standard that matters</span> <span data-start="2870.75" data-end="2874.65">is no longer important now they haven't</span> <span data-start="2874.65" data-end="2877.98">shipped ie9 final yet so there's still</span> <span data-start="2877.98" data-end="2882.15">time for Microsoft to do it right I hope</span> <span data-start="2882.15" data-end="2884.49">that they will so on that optimistic</span> <span data-start="2884.49" data-end="2907.28">note thank you and good night</span> <span data-start="2907.29" data-end="2913.74">oh yeah so Tom well time are you</span> <span data-start="2913.74" data-end="2916.44">demonstrating or time are you here I'm</span> <span data-start="2916.44" data-end="2920.16">crowd cheering you in the room oh okay</span> <span data-start="2920.16" data-end="2924.75">oh they are so are you talking about</span> <span data-start="2924.75" data-end="2938.11">this this afternoon</span> <span data-start="2938.12" data-end="2940.86">okay so you're going to be talking about</span> <span data-start="2940.86" data-end="2944.43">the ability using Yui 3 on nodejs you're</span> <span data-start="2944.43" data-end="2948.24">not talking about that oh okay so don't</span> <span data-start="2948.24" data-end="2953.67">go to his anyway we have a</span> <span data-start="2953.67" data-end="2956.25">demonstration of for example we've got a</span> <span data-start="2956.25" data-end="2962.52">calendar widget and Yui and you run Yui</span> <span data-start="2962.52" data-end="2964.02">3 in the browser and you can click on a</span> <span data-start="2964.02" data-end="2967.65">date and the date opens up and so on you</span> <span data-start="2967.65" data-end="2969.42">can do exactly the same thing on the</span> <span data-start="2969.42" data-end="2972.53">server side using exactly the same code</span> <span data-start="2972.53" data-end="2975.9">you just configure it so that instead of</span> <span data-start="2975.9" data-end="2979.59">that you take the thing that it created</span> <span data-start="2979.59" data-end="2981.96">on the server side serialized it taking</span> <span data-start="2981.96" data-end="2984.33">its inner HTML and setting that to the</span> <span data-start="2984.33" data-end="2988.32">browser instead so with a you know just</span> <span data-start="2988.32" data-end="2993.03">a little bit of new library code you can</span> <span data-start="2993.03" data-end="2995.58">have your application run on either side</span> <span data-start="2995.58" data-end="2998.94">of the network or on both or you could</span> <span data-start="2998.94" data-end="3001.4">also set up your application as a web</span> <span data-start="3001.4" data-end="3003.17">service so if it's called in a</span> <span data-start="3003.17" data-end="3004.58">particular way instead of building a</span> <span data-start="3004.58" data-end="3006.74">pageview would only builds a div which</span> <span data-start="3006.74" data-end="3008.87">you could then transport so it becomes</span> <span data-start="3008.87" data-end="3012.83">much more flexible we used to have to if</span> <span data-start="3012.83" data-end="3014.51">we want to get something like this have</span> <span data-start="3014.51" data-end="3016.13">to write the application several times</span> <span data-start="3016.13" data-end="3019.45">and now we only have to write up once</span> <span data-start="3019.45" data-end="3029.3">anyone else yes</span> <span data-start="3029.31" data-end="3035.37">a continuation passing is something that</span> <span data-start="3035.37" data-end="3039.87">was developed with skiing and it's a way</span> <span data-start="3039.87" data-end="3042.87">of you express a contact as a function</span> <span data-start="3042.87" data-end="3045.65">and you can pass that along and so</span> <span data-start="3045.65" data-end="3048.27">you've got a thread of execution in</span> <span data-start="3048.27" data-end="3050.55">which functions never return that</span> <span data-start="3050.55" data-end="3053.36">they're always going forward and and</span> <span data-start="3053.36" data-end="3056.07">passing along the function that should</span> <span data-start="3056.07" data-end="3059.34">return that should be given the result</span> <span data-start="3059.34" data-end="3061.2">of the computation so far and so it's</span> <span data-start="3061.2" data-end="3062.94">always going forward and because it</span> <span data-start="3062.94" data-end="3065.01">never returns eventually you'll you'll</span> <span data-start="3065.01" data-end="3069.42">have you'll exceed the stack so in order</span> <span data-start="3069.42" data-end="3071.88">to make that work you need to be free of</span> <span data-start="3071.88" data-end="3074.01">the stack and the tail recursion</span> <span data-start="3074.01" data-end="3075.78">optimization or proper tail calls</span> <span data-start="3075.78" data-end="3081.06">accomplish that so I I'm not certain</span> <span data-start="3081.06" data-end="3082.68">that it's appropriate for all</span> <span data-start="3082.68" data-end="3084.18">applications but for some of the stuff</span> <span data-start="3084.18" data-end="3085.26">particularly some of the server side</span> <span data-start="3085.26" data-end="3087.24">stuff that we're looking at where you</span> <span data-start="3087.24" data-end="3089.61">get these really convoluted nesting of</span> <span data-start="3089.61" data-end="3091.44">you know this callback in that one and</span> <span data-start="3091.44" data-end="3093.3">that one having continuation passing</span> <span data-start="3093.3" data-end="3095.97">would be another set of tools they would</span> <span data-start="3095.97" data-end="3103.68">have for managing that complexity it's</span> <span data-start="3103.68" data-end="3105.06">something that we've talked about in in</span> <span data-start="3105.06" data-end="3108.12">tc39 which is the echo script committee</span> <span data-start="3108.12" data-end="3111.63">the trade-off here we should talk about</span> <span data-start="3111.63" data-end="3117.48">this because in certain cases we don't</span> <span data-start="3117.48" data-end="3122.25">have to remember a a stack trace going</span> <span data-start="3122.25" data-end="3124.41">backwards debugging becomes more</span> <span data-start="3124.41" data-end="3126.48">difficult because you'll get to</span> <span data-start="3126.48" data-end="3128.55">someplace in the debugger and you can't</span> <span data-start="3128.55" data-end="3130.65">see how you got there because we're not</span> <span data-start="3130.65" data-end="3133.83">tracking that information anymore so</span> <span data-start="3133.83" data-end="3135.12">that's a trade-off some people have</span> <span data-start="3135.12" data-end="3136.74">suggested we just turned that off while</span> <span data-start="3136.74" data-end="3138.39">you're debugging but that means any</span> <span data-start="3138.39" data-end="3140.25">algorithm that would fail without tail</span> <span data-start="3140.25" data-end="3142.23">recursion would fail when you're</span> <span data-start="3142.23" data-end="3143.7">debugging and so that doesn't actually</span> <span data-start="3143.7" data-end="3146.92">solve anything so it's a hard trade-off</span> <span data-start="3146.92" data-end="3149.68">and up until this point we've decided</span> <span data-start="3149.68" data-end="3153.43">not to do it now it might be that being</span> <span data-start="3153.43" data-end="3155.47">aware that this is going on a smart</span> <span data-start="3155.47" data-end="3158.559">debugger could instead of relying on the</span> <span data-start="3158.559" data-end="3160.75">stack to keep its state could be doing</span> <span data-start="3160.75" data-end="3162.79">something else instead so it's not</span> <span data-start="3162.79" data-end="3167.049">necessarily a hard trade-off but at this</span> <span data-start="3167.049" data-end="3169.21">point the people who are most opposed to</span> <span data-start="3169.21" data-end="3173.049">it our browser makers got probably</span> <span data-start="3173.049" data-end="3177.01">because they can't determine what the</span> <span data-start="3177.01" data-end="3222.95">cost of that's going to be to them yeah</span> <span data-start="3222.96" data-end="3226.599">javascript is moving beyond its role as</span> <span data-start="3226.599" data-end="3229.9">the language of the browser to be the</span> <span data-start="3229.9" data-end="3231.869">language of the browser and the server</span> <span data-start="3231.869" data-end="3234.43">and the synergies that will be available</span> <span data-start="3234.43" data-end="3236.77">to the development community I think</span> <span data-start="3236.77" data-end="3256.55">will be significant yes</span> <span data-start="3256.56" data-end="3258.61">the thing I would like to change about</span> <span data-start="3258.61" data-end="3263.02">html5 is I think they should have</span> <span data-start="3263.02" data-end="3264.13">corrected the cross-site scripting</span> <span data-start="3264.13" data-end="3266.83">hazard before adding powerful new</span> <span data-start="3266.83" data-end="3270.7">capabilities so in my view html5 makes</span> <span data-start="3270.7" data-end="3274.56">the problem worse in three ways that it</span> <span data-start="3274.56" data-end="3277.99">increases the attack surface because</span> <span data-start="3277.99" data-end="3280.27">it's huge and complicated anytime you</span> <span data-start="3280.27" data-end="3281.68">have something that's huge and</span> <span data-start="3281.68" data-end="3283.78">complicated and knew that means that</span> <span data-start="3283.78" data-end="3285.55">they're more places that the attackers</span> <span data-start="3285.55" data-end="3287.32">can figure out that the get happened</span> <span data-start="3287.32" data-end="3290.8">cause harm the second is that even using</span> <span data-start="3290.8" data-end="3293.59">the existing attacks which we saw</span> </p>
<p><span data-start="3293.59" data-end="3295.869">Twitter taken down last week right so</span> <span data-start="3295.869" data-end="3299.86">this is still an ongoing problem the</span> <span data-start="3299.86" data-end="3301.119">attacker now gets powerful new</span> <span data-start="3301.119" data-end="3302.74">capabilities that get access to your</span> <span data-start="3302.74" data-end="3305.74">local database now and there's no</span> <span data-start="3305.74" data-end="3307.6">restriction on what they can do to that</span> <span data-start="3307.6" data-end="3310.84">database that's huge they now have new</span> <span data-start="3310.84" data-end="3312.46">tools for getting out to the network in</span> <span data-start="3312.46" data-end="3314.71">causing greater damage behind the</span> <span data-start="3314.71" data-end="3316.24">firewall or wherever else and that's</span> <span data-start="3316.24" data-end="3319.63">huge then the third is because html5 is</span> <span data-start="3319.63" data-end="3323.109">so big and complicated and fuzzy it may</span> <span data-start="3323.109" data-end="3326.17">take years before it's finished and I</span> <span data-start="3326.17" data-end="3328.3">think we have to wait for that until we</span> <span data-start="3328.3" data-end="3332.41">can get to a correct solution so it's</span> <span data-start="3332.41" data-end="3334.06">postponing doing the right thing in</span> <span data-start="3334.06" data-end="3338.56">addition to doing the wrong thing that</span> <span data-start="3338.56" data-end="3339.94">said there are a lot of good ideas in</span> <span data-start="3339.94" data-end="3342.22">html5 and it's nice that we're moving</span> <span data-start="3342.22" data-end="3345.04">the web forward but I think they got</span> <span data-start="3345.04" data-end="3347.5">their priorities wrong and they're doing</span> <span data-start="3347.5" data-end="3350.16">things out of water it's really</span> <span data-start="3350.16" data-end="3352.66">attractive to add shiny new features to</span> <span data-start="3352.66" data-end="3355.15">a system it's much harder to correct the</span> <span data-start="3355.15" data-end="3356.8">fundamental problems in the system and</span> <span data-start="3356.8" data-end="3358.54">they chose not to do that and I think</span> <span data-start="3358.54" data-end="3440.17">that was a tragic mistake yes</span> <span data-start="3440.18" data-end="3449.609">thank you p I appreciate that and and I</span> <span data-start="3449.609" data-end="3451.29">do very much hope that idea or that</span> </p>
<p><span data-start="3451.29" data-end="3453.24">Microsoft excuse me does do the right</span> <span data-start="3453.24" data-end="3457.44">thing on this that in particular equi</span> <span data-start="3457.44" data-end="3459.21">script five isn't a standard that was</span> <span data-start="3459.21" data-end="3463.17">forced on Microsoft out much like pretty</span> <span data-start="3463.17" data-end="3466.2">much all of html5 ones that Microsoft</span> <span data-start="3466.2" data-end="3470.69">actually participated in tc39 right was</span> <span data-start="3470.69" data-end="3474.2">helped desiring echo script five</span> <span data-start="3474.2" data-end="3476.4">Microsoft was the editor of the equity</span> <span data-start="3476.4" data-end="3479.97">script five standard Microsoft voted yes</span> <span data-start="3479.97" data-end="3482.91">at the General Assembly I would like for</span> <span data-start="3482.91" data-end="3485.19">Microsoft to follow through on their</span> <span data-start="3485.19" data-end="3487.32">development and good work on the script</span> <span data-start="3487.32" data-end="3492.75">by thank you ok I think we're we're good</span> <span data-start="3492.75" data-end="3494.76">with it with the questions now got to</span> <span data-start="3494.76" data-end="3496.77">move on what duck will be around so you</span> <span data-start="3496.77" data-end="3498.65">can ask them more questions later on</span> </p>
</section>