<section>
<p><span data-start="0.32" data-end="2.07">[Music]</span> <span data-start="2.07" data-end="3.84">[Applause]</span> <span data-start="3.84" data-end="5.66">[Music]</span> <span data-start="5.66" data-end="7.41">[Applause]</span> <span data-start="7.41" data-end="9.28">[Music]</span> <span data-start="9.28" data-end="11.02">[Applause]</span> <span data-start="11.02" data-end="12.78">[Music]</span> <span data-start="12.78" data-end="16.86">[Applause]</span> <span data-start="16.87" data-end="24.679">[Music]</span> <span data-start="24.689" data-end="29.529">how's everybody doing today alright okay</span> <span data-start="29.529" data-end="30.849">so today I'm talking a little bit about</span> <span data-start="30.849" data-end="33.04">compilers and why I think they're at the</span> <span data-start="33.04" data-end="35.44">core of the next evolution of web</span> <span data-start="35.44" data-end="38.95">performance as I mentioned my name is</span> </p>
<p><span data-start="38.95" data-end="40.93">Chad I tell I'm a senior staff software</span> <span data-start="40.93" data-end="42.789">engineer at LinkedIn where I get to work</span> <span data-start="42.789" data-end="43.92">on a bunch of open-source JavaScript</span> <span data-start="43.92" data-end="46.24">infrastructure that help power</span> <span data-start="46.24" data-end="48.73">LinkedIn's applications I'm also part of</span> <span data-start="48.73" data-end="50.65">the Emer j/s core team where I help</span> <span data-start="50.65" data-end="53.829">maintain and work on different libraries</span> <span data-start="53.829" data-end="55.39">and frameworks within the Ember</span> <span data-start="55.39" data-end="57.399">ecosystem you have any questions about</span> <span data-start="57.399" data-end="60.67">LinkedIn or ember come find me after my</span> <span data-start="60.67" data-end="63.34">talk but Before we jump into my talk we</span> <span data-start="63.34" data-end="64.93">first have to have a baseline</span> <span data-start="64.93" data-end="67.06">understanding of what actually is a</span> <span data-start="67.06" data-end="69.79">compiler and I think this topic can be</span> <span data-start="69.79" data-end="71.38">rather intimidating for a lot of people</span> <span data-start="71.38" data-end="72.729">because as associated with things like</span> <span data-start="72.729" data-end="74.89">computer science and theory and not</span> <span data-start="74.89" data-end="76.36">everybody has a background in those</span> <span data-start="76.36" data-end="78.79">things so when I think about a compiler</span> <span data-start="78.79" data-end="81.37">and what it is at a high level what it</span> <span data-start="81.37" data-end="83.65">really is is that it's really just a</span> <span data-start="83.65" data-end="85">code translator</span> <span data-start="85" data-end="87.52">it's gonna take some source code in the</span> <span data-start="87.52" data-end="89.409">compilers in a transformer in various</span> <span data-start="89.409" data-end="91">different ways and what you're gonna get</span> <span data-start="91" data-end="94.02">as output is another executable program</span> <span data-start="94.02" data-end="97.27">so for instance and the browser you can</span> <span data-start="97.27" data-end="98.979">write something like this a super simple</span> <span data-start="98.979" data-end="101.11">add one function and what the browser</span> <span data-start="101.11" data-end="103.36">has to do before it can actually execute</span> <span data-start="103.36" data-end="106.96">this function is parse and compile it</span> <span data-start="106.96" data-end="108.25">into something that's much more</span> <span data-start="108.25" data-end="110.14">low-level something that can actually</span> <span data-start="110.14" data-end="112.6">run on top of a CPU and it's the</span> <span data-start="112.6" data-end="114.25">browser's ability to do this just</span> <span data-start="114.25" data-end="116.77">just-in-time compilation that has made</span> <span data-start="116.77" data-end="118.39">the web a viable platform for building</span> <span data-start="118.39" data-end="122.92">very sophisticated applications but I'm</span> <span data-start="122.92" data-end="124.36">not actually here today to talk about</span> <span data-start="124.36" data-end="126.64">these compilers I'm here to talk about</span> <span data-start="126.64" data-end="128.92">the compilers that we use every single</span> <span data-start="128.92" data-end="131.799">day inside of our tool chains and we've</span> <span data-start="131.799" data-end="134.26">actually been using compilers for quite</span> <span data-start="134.26" data-end="136.599">a long period of time about 15 years or</span> <span data-start="136.599" data-end="136.78">so</span> <span data-start="136.78" data-end="139.03">maybe a little bit more and so we're</span> <span data-start="139.03" data-end="140.56">going to quickly look through kind of</span> <span data-start="140.56" data-end="142.33">the history of compilers in the front</span> <span data-start="142.33" data-end="143.86">and tooling space and what they've</span> <span data-start="143.86" data-end="144.819">afforded us and</span> <span data-start="144.819" data-end="147.37">terms of like performance or developer</span> <span data-start="147.37" data-end="149.769">ergonomics so we first have to go back</span> <span data-start="149.769" data-end="152.439">to 2003 when Douglas Crockford writes</span> </p>
<p><span data-start="152.439" data-end="156.819">Jasmine and Jasmine is a one file cc</span> <span data-start="156.819" data-end="158.65">library that just removed all the</span> <span data-start="158.65" data-end="160.9">meaningless white space from your</span> <span data-start="160.9" data-end="162.76">JavaScript code and things like comments</span> <span data-start="162.76" data-end="164.859">and stuff like that and this drastically</span> <span data-start="164.859" data-end="168.01">shrunk the size of the applications that</span> <span data-start="168.01" data-end="171.879">we were shipping to the browser right</span> <span data-start="171.879" data-end="173.56">along the same period of time Yui</span> <span data-start="173.56" data-end="175.269">compressor comes out and right Yui</span> <span data-start="175.269" data-end="177.76">compressor has this very similar type of</span> <span data-start="177.76" data-end="179.95">goals it wants to reduce the size of the</span> </p>
<p><span data-start="179.95" data-end="181.599">JavaScript that's being sent over the</span> <span data-start="181.599" data-end="183.4">wire and it does things like removing</span> <span data-start="183.4" data-end="185.29">this meaningless whitespace and removing</span> <span data-start="185.29" data-end="188.73">comments but it introduces the notion of</span> <span data-start="188.73" data-end="192.129">mangling or symbol mangling and it goes</span> <span data-start="192.129" data-end="194.139">something like this so this is a unique</span> <span data-start="194.139" data-end="197.629">and functional</span> <span data-start="197.639" data-end="201.28">2003 this is like ballad es 3 code and</span> <span data-start="201.28" data-end="203.469">so what the compiler is gonna do is that</span> <span data-start="203.469" data-end="205.51">it's gonna pull out all of the user</span> <span data-start="205.51" data-end="208.389">identify or user specified identifiers</span> <span data-start="208.389" data-end="211.72">so this is unique our red-eye item and</span> <span data-start="211.72" data-end="214.269">what the compiler does is it Maps them</span> <span data-start="214.269" data-end="216.609">onto a set of new identifiers in this</span> <span data-start="216.609" data-end="218.979">case a b c d and e and it can do this</span> <span data-start="218.979" data-end="221.229">because the compiler has all the lexical</span> <span data-start="221.229" data-end="223.479">and semantic information inside of it so</span> <span data-start="223.479" data-end="225.909">it knows that it safely can remap this</span> <span data-start="225.909" data-end="228.04">thing that you wrote into something that</span> <span data-start="228.04" data-end="231.909">is much smaller and so while in 2018</span> <span data-start="231.909" data-end="234.93">this is not like a new novel idea</span> <span data-start="234.93" data-end="237.069">anybody that's building JavaScript</span> <span data-start="237.069" data-end="239.139">applications is going through a</span> <span data-start="239.139" data-end="241.06">minification step but at the time this</span> <span data-start="241.06" data-end="244.87">was rather novel and it sped up</span> <span data-start="244.87" data-end="248.62">applications quite a bit next comes this</span> <span data-start="248.62" data-end="253.299">period from 2003 to 2008 and not a whole</span> <span data-start="253.299" data-end="255.849">lot happens during this time in terms of</span> <span data-start="255.849" data-end="257.469">like developer tool chains and</span> <span data-start="257.469" data-end="259.84">everything like that and that's because</span> <span data-start="259.84" data-end="262.93">this is the life and death of es 4 and</span> <span data-start="262.93" data-end="264.82">so for those who are familiar with what</span> <span data-start="264.82" data-end="267.729">es 4 is or was it was an actual</span> <span data-start="267.729" data-end="269.59">specification of JavaScript that never</span> <span data-start="269.59" data-end="272.77">actually shipped but looking back at es</span> <span data-start="272.77" data-end="275.38">4 today we would actually say that es 4</span> <span data-start="275.38" data-end="277.479">has shipped because it specified things</span> <span data-start="277.479" data-end="278.74">like cloud</span> <span data-start="278.74" data-end="281.17">module system generators iterators</span> <span data-start="281.17" data-end="283.24">destructuring assignment all the things</span> <span data-start="283.24" data-end="286.27">that we're using today inside of our</span> <span data-start="286.27" data-end="289.5">applications but mind you this is</span> <span data-start="289.5" data-end="291.88">developers wanted these types of</span> <span data-start="291.88" data-end="293.88">features from the language back then and</span> <span data-start="293.88" data-end="296.97">this is also when Google comes out with</span> </p>
<p><span data-start="296.97" data-end="299.86">Google Maps and kind of shows the types</span> <span data-start="299.86" data-end="301.3">of things that we can build it build for</span> <span data-start="301.3" data-end="302.47">the web and we can be a little bit more</span> <span data-start="302.47" data-end="305.26">ambitious in terms of the applications</span> <span data-start="305.26" data-end="307.9">that we want to build there so next</span> <span data-start="307.9" data-end="311.17">comes this period from 2008 to 2010 and</span> <span data-start="311.17" data-end="313.09">what do we see during this period of</span> <span data-start="313.09" data-end="315.34">time well we actually see like an</span> <span data-start="315.34" data-end="318.73">explosion of compilers enter the tooling</span> <span data-start="318.73" data-end="321.25">space and actually like to call this</span> <span data-start="321.25" data-end="323.29">period of time the Enlightenment it's</span> <span data-start="323.29" data-end="325.63">kind of like the origin story of where</span> <span data-start="325.63" data-end="328.44">we are today from a tooling perspective</span> <span data-start="328.44" data-end="331.81">so we have projects like cappuccino GWT</span> <span data-start="331.81" data-end="333.79">and CoffeeScript that are all kind of</span> <span data-start="333.79" data-end="335.2">birthed out of the sentiment that they</span> <span data-start="335.2" data-end="336.88">no longer run be beholden to the</span> <span data-start="336.88" data-end="339.19">standardization process so in case of</span> <span data-start="339.19" data-end="341.44">cappuccino they create objective J which</span> <span data-start="341.44" data-end="345.03">is a dialect of Objective C GWT bothers</span> <span data-start="345.03" data-end="347.92">borrows Java and CoffeeScript and takes</span> <span data-start="347.92" data-end="350.05">the best parts of Python and Ruby to</span> <span data-start="350.05" data-end="352.09">create a new language and what all these</span> <span data-start="352.09" data-end="353.53">projects kind of have in common is that</span> <span data-start="353.53" data-end="356.05">they are their own language and they</span> <span data-start="356.05" data-end="358.96">build sophisticated compilers in between</span> <span data-start="358.96" data-end="361.66">there to turn that language into</span> </p>
<p><span data-start="361.66" data-end="364.03">JavaScript code that could run in the</span> <span data-start="364.03" data-end="367.09">browser of the time and so this allowed</span> <span data-start="367.09" data-end="368.98">them to do things like shed away runtime</span> <span data-start="368.98" data-end="370.57">libraries for doing things like class</span> <span data-start="370.57" data-end="373.15">systems but the big idea here is that</span> <span data-start="373.15" data-end="375.4">javascript is effectively a bytecode</span> <span data-start="375.4" data-end="377.29">format you don't actually have to write</span> <span data-start="377.29" data-end="378.76">in the programming language of the web</span> <span data-start="378.76" data-end="380.14">as long as you can build the</span> <span data-start="380.14" data-end="381.97">sophisticated enough compiler that map's</span> <span data-start="381.97" data-end="383.44">the what the language that you wrote in</span> <span data-start="383.44" data-end="386.23">on to the semantics of the JavaScript</span> <span data-start="386.23" data-end="389.35">language the other thing that comes out</span> <span data-start="389.35" data-end="390.61">during this period of time is more</span> <span data-start="390.61" data-end="393.25">advanced minifiers so this is closure</span> <span data-start="393.25" data-end="395.71">compiler and closure compiler is pretty</span> <span data-start="395.71" data-end="398.29">unique so let's say you have some</span> </p>
<p><span data-start="398.29" data-end="400.6">JavaScript code in your application like</span> <span data-start="400.6" data-end="402.4">this this is very silly code but in a</span> <span data-start="402.4" data-end="405.01">large-enough application you will end up</span> <span data-start="405.01" data-end="407.26">having code like this even if you try</span> <span data-start="407.26" data-end="409.48">really hard so we can see that like</span> <span data-start="409.48" data-end="411.58">predicate is never actually getting</span> <span data-start="411.58" data-end="412.24">reassigned</span> <span data-start="412.24" data-end="413.919">so the first conditional is always going</span> <span data-start="413.919" data-end="415.93">to execute the second conditional is</span> <span data-start="415.93" data-end="417.31">never going to execute and then we have</span> <span data-start="417.31" data-end="420.58">this do stuff function declaration here</span> <span data-start="420.58" data-end="421.81">where we're just something left and</span> <span data-start="421.81" data-end="423.789">right and we've left off callback and</span> <span data-start="423.789" data-end="425.65">then last time we're doing some type of</span> <span data-start="425.65" data-end="428.47">string interpolation it's drink</span> <span data-start="428.47" data-end="431.41">interpolation or concatenation type of</span> <span data-start="431.41" data-end="433.389">thing so if you give this code to a</span> <span data-start="433.389" data-end="435.58">closure compiler what you get out of it</span> <span data-start="435.58" data-end="437.83">is something like this so not only has</span> <span data-start="437.83" data-end="440.41">it minified the code it has done a whole</span> <span data-start="440.41" data-end="443.229">lot more so the closure compiler can</span> <span data-start="443.229" data-end="445.15">figure out that this first branch is</span> <span data-start="445.15" data-end="446.86">always going to execute so just in line</span> <span data-start="446.86" data-end="449.319">the body of the conditional the second</span> <span data-start="449.319" data-end="450.669">conditional was never going to execute</span> <span data-start="450.669" data-end="453.009">so just throw it away and then the</span> <span data-start="453.009" data-end="454.96">interesting part here is that do stuff</span> <span data-start="454.96" data-end="457.27">just doesn't exist so closure compiler</span> <span data-start="457.27" data-end="459.34">has this technique in it known as</span> <span data-start="459.34" data-end="461.349">concept folding where it can see if</span> <span data-start="461.349" data-end="463.479">calls to the function are going to be</span> <span data-start="463.479" data-end="465.97">side-effect free it can just do that</span> <span data-start="465.97" data-end="468.37">work in ahead of time and just inline</span> <span data-start="468.37" data-end="470.289">the result it's also done the same thing</span> <span data-start="470.289" data-end="472.5">with a and B here where it is just</span> <span data-start="472.5" data-end="474.37">concatenated them into the string</span> <span data-start="474.37" data-end="475.389">because there is no observable</span> <span data-start="475.389" data-end="478.84">side-effects and so because closure</span> <span data-start="478.84" data-end="480.13">compiler takes in your entire</span> <span data-start="480.13" data-end="481.9">application and produces this more</span> <span data-start="481.9" data-end="483.669">optimal subset of the code what we</span> <span data-start="483.669" data-end="486.13">actually call closure compiler is an</span> <span data-start="486.13" data-end="488.68">optimizing compiler it's a really cool</span> <span data-start="488.68" data-end="490.509">piece of technology and it's still used</span> <span data-start="490.509" data-end="494.86">today on a lot of web properties and so</span> <span data-start="494.86" data-end="497.5">that brings us to today and I think</span> <span data-start="497.5" data-end="499.539">today we have like really great tools we</span> <span data-start="499.539" data-end="501.159">have web pack we have roll-up</span> <span data-start="501.159" data-end="502.599">we had tracer for some period of time</span> <span data-start="502.599" data-end="505.21">but like babel is kind of superseded in</span> <span data-start="505.21" data-end="508.84">turn in translation space and so what</span> <span data-start="508.84" data-end="511.479">are those tools doing well they're</span> <span data-start="511.479" data-end="513.099">actually building off the backs that</span> <span data-start="513.099" data-end="515.349">things of the things that came before it</span> <span data-start="515.349" data-end="518.26">so in the case they allow you to use it</span> <span data-start="518.26" data-end="519.88">like new language features which kind of</span> <span data-start="519.88" data-end="522.25">harkens back to the sentiment of like</span> <span data-start="522.25" data-end="525.13">the objective J's and the coffee scripts</span> <span data-start="525.13" data-end="527.35">of the world they can do more optimized</span> <span data-start="527.35" data-end="529.39">code bundles they can do different forms</span> <span data-start="529.39" data-end="531.43">of dead code elimination so this is like</span> <span data-start="531.43" data-end="533.89">scope poising and tree shaking and so</span> <span data-start="533.89" data-end="537.79">you'd think in 2018 we're kind of like</span> <span data-start="537.79" data-end="541.029">pinnacle of performance here we've had</span> <span data-start="541.029" data-end="543.43">15 years of really sophisticated tool</span> <span data-start="543.43" data-end="545.74">chains being developed so everything is</span> <span data-start="545.74" data-end="546.17">great</span> <span data-start="546.17" data-end="550.25">right well I actually say that there are</span> <span data-start="550.25" data-end="553.22">quite a few problems in what we do today</span> </p>
<p><span data-start="553.22" data-end="556.16">I think that's because we've kind of</span> <span data-start="556.16" data-end="558.23">fundamentally changed on how we approach</span> <span data-start="558.23" data-end="561.44">to building applications for the web and</span> <span data-start="561.44" data-end="564.62">so this is a tweet by Alex Russell who</span> <span data-start="564.62" data-end="566.18">is a developer on the chrome team he</span> <span data-start="566.18" data-end="567.62">also might be some of you guys</span> <span data-start="567.62" data-end="570.589">colleagues and what he says is the web</span> <span data-start="570.589" data-end="572.24">is getting slower because no matter how</span> <span data-start="572.24" data-end="574.699">much faster we make Chrome developers</span> <span data-start="574.699" data-end="576.529">abuse users with ever larger piles of</span> </p>
<p><span data-start="576.529" data-end="578.089">JavaScript and JavaScript is the most</span> <span data-start="578.089" data-end="581">expensive thing so let me unpack this a</span> <span data-start="581" data-end="583.579">little bit so I think about five years</span> <span data-start="583.579" data-end="587.12">ago we kind of shifted quite drastically</span> <span data-start="587.12" data-end="588.649">and how we approach to building web</span> <span data-start="588.649" data-end="591.44">applications we used to start with HTML</span> <span data-start="591.44" data-end="594.139">and then you style it with CSS and then</span> <span data-start="594.139" data-end="595.79">you would layer on the JavaScript to get</span> <span data-start="595.79" data-end="597.68">a little bit of interactivity and we've</span> <span data-start="597.68" data-end="600.38">basically inverted this world we start</span> <span data-start="600.38" data-end="602.089">with JavaScript a lot of the times and</span> <span data-start="602.089" data-end="606.17">we add CSS to it and hTML is this out of</span> <span data-start="606.17" data-end="608.269">the picture for a lot of applications</span> <span data-start="608.269" data-end="611.959">nowadays and so because we are pushing</span> <span data-start="611.959" data-end="614">more and more responsibility onto</span> </p>
<p><span data-start="614" data-end="615.949">JavaScript there tends to be a lot more</span> <span data-start="615.949" data-end="619.19">of it and we have to ship that down to</span> <span data-start="619.19" data-end="621.17">our users and what he's talking about</span> <span data-start="621.17" data-end="623.149">in this last part about JavaScript being</span> <span data-start="623.149" data-end="626.57">the most expensive thing is this it is</span> <span data-start="626.57" data-end="629.209">the parse and compile step of JavaScript</span> <span data-start="629.209" data-end="632.18">that is very very expensive so if you</span> <span data-start="632.18" data-end="633.8">think about it you're writing JavaScript</span> <span data-start="633.8" data-end="635.05">code it's the textual representation</span> <span data-start="635.05" data-end="637.61">that code needs to go to the browser and</span> <span data-start="637.61" data-end="640.459">needs to turn into an executable like</span> <span data-start="640.459" data-end="642.74">thing like it just doesn't run the text</span> <span data-start="642.74" data-end="645.89">that you wrote and so in 2017 addy</span> <span data-start="645.89" data-end="648.23">osmani wrote a really great blog article</span> <span data-start="648.23" data-end="649.97">called JavaScript startup time and he</span> <span data-start="649.97" data-end="651.98">had this really great graphic in it and</span> <span data-start="651.98" data-end="654.8">what it's saying is that the bytes of</span> </p>
<p><span data-start="654.8" data-end="656.99">JavaScript are not the same bytes as a</span> <span data-start="656.99" data-end="659.75">jpg and so this is on a constrained</span> <span data-start="659.75" data-end="661.67">network and a constraint is a device so</span> <span data-start="661.67" data-end="664.37">if you have 170 KB of anything it takes</span> <span data-start="664.37" data-end="666.47">roughly the same amount of time to pull</span> <span data-start="666.47" data-end="667.699">it over the wire so in this case it</span> <span data-start="667.699" data-end="669.139">takes three and a half seconds to</span> <span data-start="669.139" data-end="672.23">transmit both of these asset types but</span> <span data-start="672.23" data-end="673.699">once they get on to the device it's a</span> <span data-start="673.699" data-end="676.79">whole nother ballgame so in the case of</span> <span data-start="676.79" data-end="680">a JPEG it is binary data so it just</span> <span data-start="680" data-end="681.59">goes through a decoder like pretty</span> <span data-start="681.59" data-end="683.96">quickly and it takes about 70</span> <span data-start="683.96" data-end="685.85">milliseconds to do that whereas the</span> </p>
<p><span data-start="685.85" data-end="688.1">JavaScript takes an additional two</span> <span data-start="688.1" data-end="690.86">seconds for it just the process on the</span> <span data-start="690.86" data-end="692.96">device and I think this is some of the</span> <span data-start="692.96" data-end="695.12">stuff that both Chris and Malte we're</span> <span data-start="695.12" data-end="698.99">talking about two days ago and then from</span> <span data-start="698.99" data-end="700.55">there the JavaScript then executes for</span> <span data-start="700.55" data-end="704.6">another 1/2 seconds whereas the JPEG</span> <span data-start="704.6" data-end="706.31">just needs to paint of the screen takes</span> <span data-start="706.31" data-end="710.39">point 0 to 8 mills are 2.8 milliseconds</span> <span data-start="710.39" data-end="713.15">AG are seconds to do that so very</span> <span data-start="713.15" data-end="716.3">different types of resources that we're</span> <span data-start="716.3" data-end="721.04">talking about here and so as I mentioned</span> </p>
<p><span data-start="721.04" data-end="722.9">I'm on the ember.js core team and over</span> <span data-start="722.9" data-end="724.37">the past couple years I've been working</span> <span data-start="724.37" data-end="726.68">on this project known as the glimmer VM</span> <span data-start="726.68" data-end="729.8">and we think about the glimmer being at</span> <span data-start="729.8" data-end="732.17">VM as an example of the types of tools</span> <span data-start="732.17" data-end="734.12">that I think that we have to start</span> <span data-start="734.12" data-end="736.28">thinking about building or building to</span> <span data-start="736.28" data-end="737.96">help mitigate some of these inherent</span> <span data-start="737.96" data-end="742.4">problems with JavaScript and so for</span> <span data-start="742.4" data-end="744.14">those who are familiar with what the</span> <span data-start="744.14" data-end="746.27">glimmer VM is it is the rendering engine</span> <span data-start="746.27" data-end="749.27">inside of ember and this is the San</span> </p>
<p><span data-start="749.27" data-end="751.76">Diego ember meetups mascot it's pretty</span> <span data-start="751.76" data-end="755.21">cool so for those who are familiar with</span> <span data-start="755.21" data-end="757.28">what it means to build an ember</span> <span data-start="757.28" data-end="758.27">application I'm going to go through a</span> <span data-start="758.27" data-end="760.49">really quick example so this is your</span> <span data-start="760.49" data-end="763.55">quintessential to do MVC type of app so</span> <span data-start="763.55" data-end="765.2">you would have a — duze component you</span> <span data-start="765.2" data-end="766.94">would each over each one of the two dues</span> <span data-start="766.94" data-end="769.16">every iteration of the loop</span> <span data-start="769.16" data-end="770.9">you're gonna invoke an item component</span> <span data-start="770.9" data-end="772.94">and you're past the to do at that index</span> <span data-start="772.94" data-end="776.36">into the item component item component</span> <span data-start="776.36" data-end="778.07">is what we call a template only</span> <span data-start="778.07" data-end="779.54">component if you're familiar with</span> <span data-start="779.54" data-end="781.67">reactor solutions like it we would call</span> <span data-start="781.67" data-end="784.04">it a pure component it just draws from</span> <span data-start="784.04" data-end="786.44">its inputs and then the backing class</span> <span data-start="786.44" data-end="788.39">for the — dues component would look</span> <span data-start="788.39" data-end="789.65">something like this we have a couple</span> <span data-start="789.65" data-end="793.28">different decorators here tract is just</span> <span data-start="793.28" data-end="794.78">our mechanism for doing change detection</span> <span data-start="794.78" data-end="797.53">in the system and action is this binding</span> <span data-start="797.53" data-end="801.56">the instance — basically doing the bind</span> <span data-start="801.56" data-end="803.6">so that when we put it into the template</span> <span data-start="803.6" data-end="805.22">layer you can just freely pass it around</span> <span data-start="805.22" data-end="808.459">so this isn't all that important but the</span> <span data-start="808.459" data-end="811.76">important part is that ember uses</span> <span data-start="811.76" data-end="813.5">templates and it's one of the large</span> <span data-start="813.5" data-end="816.26">just reasons why it broke away from this</span> <span data-start="816.26" data-end="817.64">other framework which was known as</span> <span data-start="817.64" data-end="819.59">sprout core which is used to build like</span> <span data-start="819.59" data-end="822.38">things like mobile me at Apple it was to</span> <span data-start="822.38" data-end="824.12">bring this declarative templating</span> <span data-start="824.12" data-end="828.68">language to a framework and we're not</span> <span data-start="828.68" data-end="831.56">actually alone in this philosophy of</span> <span data-start="831.56" data-end="833.81">having a domain-specific language to</span> <span data-start="833.81" data-end="836.39">declaratively declaratively describe our</span> <span data-start="836.39" data-end="838.16">views and something that actually isn't</span> <span data-start="838.16" data-end="840.17">in JavaScript both of you and angular</span> <span data-start="840.17" data-end="842.78">have I think a very similar philosophy</span> <span data-start="842.78" data-end="844.4">and angular actually wrote pretty</span> <span data-start="844.4" data-end="846.86">extensively about why angular uses</span> <span data-start="846.86" data-end="849.29">templates in 2016 it's a really great</span> <span data-start="849.29" data-end="852.2">blog article but at the end of the day</span> <span data-start="852.2" data-end="854.24">even though that view and angular are</span> <span data-start="854.24" data-end="858.11">owning complete languages with our own</span> <span data-start="858.11" data-end="860.24">semantics and their own compiler stacks</span> <span data-start="860.24" data-end="862.37">at the end of the day both view and</span> <span data-start="862.37" data-end="864.71">angular still compile the templates to</span> </p>
<p><span data-start="864.71" data-end="867.02">JavaScript and so it's not really</span> <span data-start="867.02" data-end="869.45">working towards solving this parse and</span> <span data-start="869.45" data-end="871.13">compile problem or problem or just</span> <span data-start="871.13" data-end="874.85">property of JavaScript so how does</span> <span data-start="874.85" data-end="878.21">glimmr VM approach this problem well</span> <span data-start="878.21" data-end="880.31">instead of compiling the templates to</span> <span data-start="880.31" data-end="883.28">JavaScript we actually compile them to a</span> <span data-start="883.28" data-end="885.98">binary executable anytime that you're</span> <span data-start="885.98" data-end="887.75">talking about binary like we have to</span> <span data-start="887.75" data-end="891.589">have the matrix background so what does</span> <span data-start="891.589" data-end="893.99">that actually mean that means if you</span> <span data-start="893.99" data-end="896.24">write a template like this at Build time</span> <span data-start="896.24" data-end="897.95">so this is ahead of time compilation</span> <span data-start="897.95" data-end="901.07">step we compile that template into a</span> <span data-start="901.07" data-end="904.4">binary blob that encodes all of the</span> <span data-start="904.4" data-end="906.5">instructions to recreate that template</span> <span data-start="906.5" data-end="909.86">at runtime and so you may be saying to</span> <span data-start="909.86" data-end="912.38">yourself ah this is like quite novel but</span> <span data-start="912.38" data-end="914.87">how does it actually help mitigate this</span> <span data-start="914.87" data-end="916.43">parse and compile problem</span> <span data-start="916.43" data-end="920.6">well binary data in the browser is can</span> <span data-start="920.6" data-end="922.85">be represented by an API known as a</span> <span data-start="922.85" data-end="925.46">typed array if you go find the</span> <span data-start="925.46" data-end="926.93">documentation for a typed array you'll</span> <span data-start="926.93" data-end="928.339">come across this great definition that</span> <span data-start="928.339" data-end="930.29">says a typed array is a slab of memory</span> <span data-start="930.29" data-end="932.12">with a type view into it much like how</span> <span data-start="932.12" data-end="934.22">arrays work and see because of typed</span> <span data-start="934.22" data-end="935.72">array is backed by raw memory the</span> </p>
<p><span data-start="935.72" data-end="937.37">JavaScript engine can pass that memory</span> <span data-start="937.37" data-end="938.81">directly to native libraries without</span> <span data-start="938.81" data-end="940.82">having to painstakingly convert the data</span> <span data-start="940.82" data-end="943.07">into a native representation so what</span> <span data-start="943.07" data-end="944.78">it's talking about and that last part is</span> <span data-start="944.78" data-end="946.68">parsing a pile</span> <span data-start="946.68" data-end="948.96">with typed arrays and the data inside of</span> <span data-start="948.96" data-end="950.58">them they never actually see the parse</span> <span data-start="950.58" data-end="953.79">and compile pipeline of JavaScript so</span> <span data-start="953.79" data-end="957.779">that's a pretty cool property of them so</span> <span data-start="957.779" data-end="960.69">if we look at open source java open</span> <span data-start="960.69" data-end="962.22">source ember applications and even</span> <span data-start="962.22" data-end="964.02">internal applications what we tend to</span> <span data-start="964.02" data-end="965.91">find is anywhere from 25 to 40 percent</span> <span data-start="965.91" data-end="968.73">of these applications are built up of</span> <span data-start="968.73" data-end="971.16">this templating layer and so if we can</span> <span data-start="971.16" data-end="972.93">take those templates and compile them</span> <span data-start="972.93" data-end="975">into something that isn't JavaScript</span> <span data-start="975" data-end="976.62">that doesn't have these inherent parse</span> <span data-start="976.62" data-end="980.61">and compile not issues but it's just the</span> <span data-start="980.61" data-end="982.709">reality of the world then what we can do</span> <span data-start="982.709" data-end="986.54">is we can actually speed up applications</span> <span data-start="986.54" data-end="989.76">so how do we actually do this we're</span> <span data-start="989.76" data-end="991.38">gonna kind of walk through kind of a</span> <span data-start="991.38" data-end="993.33">quick example of how both the</span> <span data-start="993.33" data-end="996.48">compilation part works and then how we</span> <span data-start="996.48" data-end="1000.16">actually execute that code at runtime so</span> <span data-start="1000.16" data-end="1003.68">valid HTML in handlebars templates is</span> <span data-start="1003.68" data-end="1006.02">valid a valid template so we're going to</span> <span data-start="1006.02" data-end="1008.57">use this super simple hello world</span> <span data-start="1008.57" data-end="1010.73">esque example to kind of walk through</span> <span data-start="1010.73" data-end="1013.49">the process so the first thing that</span> <span data-start="1013.49" data-end="1014.81">we're actually going to do is we're</span> <span data-start="1014.81" data-end="1017.06">gonna take that template and we're going</span> <span data-start="1017.06" data-end="1019.25">to tokenize it into an abstract syntax</span> <span data-start="1019.25" data-end="1021.38">tree and then it's gonna get passed</span> <span data-start="1021.38" data-end="1023.51">through a couple different compilers</span> <span data-start="1023.51" data-end="1026.3">stages and at the end of the day what</span> <span data-start="1026.3" data-end="1028.01">you're gonna get out of this phase is</span> <span data-start="1028.01" data-end="1030.53">something that looks like this so we</span> <span data-start="1030.53" data-end="1032.15">started with this declarative templating</span> <span data-start="1032.15" data-end="1035.48">layer and now what we get is like this</span> </p>
<p><span data-start="1035.48" data-end="1039.14">JSON that is very declarative it title</span> <span data-start="1039.14" data-end="1042.02">looks like the message format that the</span> <span data-start="1042.02" data-end="1047.6">worker Dom uses and so this is JSON this</span> <span data-start="1047.6" data-end="1049.55">isn't actually binary so we actually</span> <span data-start="1049.55" data-end="1052.16">have to further compile this format down</span> <span data-start="1052.16" data-end="1055.07">and that's where the OP code compiler</span> <span data-start="1055.07" data-end="1058.4">comes in before we actually jump into</span> <span data-start="1058.4" data-end="1060.29">what the role of the OpCo compiler is</span> <span data-start="1060.29" data-end="1063.5">let me unpack some terminology so an</span> <span data-start="1063.5" data-end="1067.91">opcode is just a number a number that is</span> <span data-start="1067.91" data-end="1070.1">significant to a virtual machine that is</span> <span data-start="1070.1" data-end="1073.22">tied to some level or a small bit of</span> <span data-start="1073.22" data-end="1075.559">functionality so you can think of it as</span> <span data-start="1075.559" data-end="1078.05">just a function that is going to do a</span> <span data-start="1078.05" data-end="1079.29">little bit of work</span> <span data-start="1079.29" data-end="1083.04">and an opcode takes operands and you can</span> <span data-start="1083.04" data-end="1085.14">think of operands is just arguments to</span> <span data-start="1085.14" data-end="1087.06">that function and together you would</span> <span data-start="1087.06" data-end="1089.49">call this an instruction a bytecode set</span> <span data-start="1089.49" data-end="1092.49">is just many instructions that is</span> <span data-start="1092.49" data-end="1094.29">encoding where these instructions begin</span> <span data-start="1094.29" data-end="1097.86">and end so it's just a bunch of numbers</span> <span data-start="1097.86" data-end="1099.81">but those numbers are encoded in a very</span> <span data-start="1099.81" data-end="1102.99">specific way so going back to our JSON</span> <span data-start="1102.99" data-end="1104.79">example we're going to start compiling</span> <span data-start="1104.79" data-end="1109.62">this into that binary format so the</span> <span data-start="1109.62" data-end="1110.91">first thing that we do is that we're</span> <span data-start="1110.91" data-end="1114.68">going to pop each item off of this list</span> <span data-start="1114.68" data-end="1116.94">so in this case we're going to compile</span> <span data-start="1116.94" data-end="1118.86">open out the open element statement</span> <span data-start="1118.86" data-end="1121.38">we're gonna map that the first element</span> <span data-start="1121.38" data-end="1123.78">of that array into a method of the same</span> <span data-start="1123.78" data-end="1125.88">name so open element maps into an open</span> </p>
<p><span data-start="1125.88" data-end="1127.98">Ellyn element method and then it's going</span> <span data-start="1127.98" data-end="1130.32">to take some arguments here for open</span> <span data-start="1130.32" data-end="1132">element it's gonna take the tag name and</span> <span data-start="1132" data-end="1134.37">the first thing that we actually do here</span> <span data-start="1134.37" data-end="1136.5">is that we push the tag name into a</span> <span data-start="1136.5" data-end="1139.44">strings constants pool the constants</span> <span data-start="1139.44" data-end="1140.91">pool is this gonna hold on to our</span> <span data-start="1140.91" data-end="1144.53">user-defined literals in the system and</span> <span data-start="1144.53" data-end="1147.18">from that we're gonna get a number in</span> <span data-start="1147.18" data-end="1148.44">this case that's the first thing that</span> <span data-start="1148.44" data-end="1151.11">we're pushing in so we'll get 0 out of</span> <span data-start="1151.11" data-end="1154.02">the the constants pool and so tag is 0</span> <span data-start="1154.02" data-end="1156.09">at this point and then we pass that into</span> <span data-start="1156.09" data-end="1159.12">the stop builder open element so because</span> <span data-start="1159.12" data-end="1162.9">the VM is working on these op codes and</span> <span data-start="1162.9" data-end="1164.4">they're just numbers we create an</span> <span data-start="1164.4" data-end="1166.26">abstraction around those numbers so</span> <span data-start="1166.26" data-end="1168.78">almost like a DSL type of type of thing</span> <span data-start="1168.78" data-end="1170.82">that's holding on to you know the</span> <span data-start="1170.82" data-end="1172.38">significant numbers in the VM this way</span> <span data-start="1172.38" data-end="1174.24">so you're not like hard coding you know</span> <span data-start="1174.24" data-end="1177.15">45 36 all over the place we have like an</span> <span data-start="1177.15" data-end="1179.37">abstraction on that and the purpose of</span> <span data-start="1179.37" data-end="1181.95">that abstraction is just to create this</span> <span data-start="1181.95" data-end="1186.18">linear list of numbers and so at the end</span> <span data-start="1186.18" data-end="1188.01">of this compilation what what do we get</span> <span data-start="1188.01" data-end="1190.77">we get a linear list of numbers and then</span> <span data-start="1190.77" data-end="1194.37">we get this JSON map thing that is just</span> <span data-start="1194.37" data-end="1196.2">the user-defined literals in the system</span> <span data-start="1196.2" data-end="1199.8">and that's it that's the basically the</span> <span data-start="1199.8" data-end="1203.79">entire process of compiling this from</span> <span data-start="1203.79" data-end="1205.71">this a declarative template language all</span> <span data-start="1205.71" data-end="1210.09">the way to a binary format so next comes</span> <span data-start="1210.09" data-end="1213.86">actually executing this thing</span> <span data-start="1213.86" data-end="1216.75">before we get into executing I probably</span> <span data-start="1216.75" data-end="1219.27">should unpack what a virtual machine is</span> <span data-start="1219.27" data-end="1224.07">a virtual machine is a CPU written in in</span> <span data-start="1224.07" data-end="1226.74">software but at the end of the day what</span> <span data-start="1226.74" data-end="1228.419">you can really think of it as is just a</span> <span data-start="1228.419" data-end="1229.77">while loop with a switch statement</span> <span data-start="1229.77" data-end="1232.74">inside of it and every time you iterate</span> <span data-start="1232.74" data-end="1234.809">that loop you're pointing at an</span> <span data-start="1234.809" data-end="1237.09">instruction that you need to execute and</span> <span data-start="1237.09" data-end="1240.6">then that that opcode is goes into the</span> <span data-start="1240.6" data-end="1242.01">switch and then the switch disc</span> <span data-start="1242.01" data-end="1246.24">dispatches the instruction so that's</span> <span data-start="1246.24" data-end="1248.28">probably the easiest way of explaining a</span> <span data-start="1248.28" data-end="1252.33">virtual machine so because we're dealing</span> <span data-start="1252.33" data-end="1255.39">with binary data we actually use the</span> <span data-start="1255.39" data-end="1258.63">fetch API in the browser and so we asked</span> <span data-start="1258.63" data-end="1260.28">for the templates to come back as an</span> <span data-start="1260.28" data-end="1262.02">array buffer and then we just take that</span> <span data-start="1262.02" data-end="1264.99">array buffer and we pass it into a UN 16</span> <span data-start="1264.99" data-end="1267.57">array which is a typed array and that's</span> <span data-start="1267.57" data-end="1269.28">it that's that's how we get the</span> <span data-start="1269.28" data-end="1273.6">executable into the virtual machine so</span> <span data-start="1273.6" data-end="1276">this is kind of my visualization of what</span> <span data-start="1276" data-end="1278.49">is actually going on inside the inside</span> <span data-start="1278.49" data-end="1281.669">of the VM the VM works on like an</span> <span data-start="1281.669" data-end="1283.409">iterator type of pattern so you drive</span> <span data-start="1283.409" data-end="1285.72">the state forward you're iterating the</span> <span data-start="1285.72" data-end="1287.85">internal loop by just calling next from</span> <span data-start="1287.85" data-end="1290.73">the outside and then on the right we</span> <span data-start="1290.73" data-end="1292.32">kind of have a bunch of different state</span> <span data-start="1292.32" data-end="1294.39">here so the top is the executable that</span> <span data-start="1294.39" data-end="1296.28">we compiled and below that is our</span> <span data-start="1296.28" data-end="1298.169">constants pool and then we have some</span> <span data-start="1298.169" data-end="1300.39">registers here and you can think of</span> <span data-start="1300.39" data-end="1304.08">registers as just basically you could</span> <span data-start="1304.08" data-end="1305.28">think of them as like an object that's</span> <span data-start="1305.28" data-end="1307.049">holding on to state that we're going to</span> <span data-start="1307.049" data-end="1309.96">consult as the VM is running so we have</span> <span data-start="1309.96" data-end="1311.85">a constructing register and that</span> <span data-start="1311.85" data-end="1315.36">register is going to hold on to HTML</span> <span data-start="1315.36" data-end="1319.309">elements as we are building them PC is</span> <span data-start="1319.309" data-end="1321.84">program counter or in other virtual</span> <span data-start="1321.84" data-end="1323.61">machines you call an instruction pointer</span> <span data-start="1323.61" data-end="1326.429">and it's always this pointing at the</span> <span data-start="1326.429" data-end="1327.72">instruction that's currently being</span> <span data-start="1327.72" data-end="1331.23">executed and then we have our a which is</span> <span data-start="1331.23" data-end="1333.63">a return address for this presentation</span> <span data-start="1333.63" data-end="1336.21">it's gonna stain negative 1 but because</span> <span data-start="1336.21" data-end="1338.72">of the VM has components in it</span> <span data-start="1338.72" data-end="1341.73">components are modeled like function</span> <span data-start="1341.73" data-end="1344.549">calls so after you call into a function</span> <span data-start="1344.549" data-end="1346.2">you need to come you need to know where</span> <span data-start="1346.2" data-end="1346.77">you're going</span> <span data-start="1346.77" data-end="1348.06">once you've done executing it that's</span> <span data-start="1348.06" data-end="1349.92">what that registers for typically used</span> <span data-start="1349.92" data-end="1351.84">for and then we have a couple different</span> <span data-start="1351.84" data-end="1354.42">stacks there's an execution stack which</span> <span data-start="1354.42" data-end="1355.68">isn't shown here because you don't need</span> <span data-start="1355.68" data-end="1356.94">it for this example</span> <span data-start="1356.94" data-end="1358.86">and then there's an element stack which</span> <span data-start="1358.86" data-end="1360.89">is just going to hold on to our HTML</span> <span data-start="1360.89" data-end="1364.38">elements once they've been constructed</span> <span data-start="1364.38" data-end="1367.35">so we're gonna walk through this example</span> <span data-start="1367.35" data-end="1371.16">step by step to show how we actually</span> <span data-start="1371.16" data-end="1374.88">execute this binary format the other</span> <span data-start="1374.88" data-end="1377.43">thing I'll also note is that we have the</span> <span data-start="1377.43" data-end="1378.93">code the actual code that is being</span> <span data-start="1378.93" data-end="1380.79">executed when we were doing this and</span> <span data-start="1380.79" data-end="1382.56">what you'll find is the code is not all</span> <span data-start="1382.56" data-end="1384.69">that much so the first thing that we are</span> <span data-start="1384.69" data-end="1387.18">going to execute is open element open</span> <span data-start="1387.18" data-end="1390.12">element is 31 and it takes one operand</span> <span data-start="1390.12" data-end="1393.99">and that operand is 0 in this case 0 is</span> <span data-start="1393.99" data-end="1396.81">used to be the index into the constants</span> <span data-start="1396.81" data-end="1399.66">pool and so what it does is it pulls out</span> <span data-start="1399.66" data-end="1403.29">the string h1 it creates a HTML heading</span> <span data-start="1403.29" data-end="1405.45">element and places it on to the</span> <span data-start="1405.45" data-end="1409.02">constructing register the next step is</span> <span data-start="1409.02" data-end="1411.33">flush element now if there is actual</span> <span data-start="1411.33" data-end="1414.18">attributes on this HTML element there</span> <span data-start="1414.18" data-end="1415.62">would have been more instructions</span> <span data-start="1415.62" data-end="1417.75">between open element and flushing the</span> <span data-start="1417.75" data-end="1419.85">element but since there were none</span> <span data-start="1419.85" data-end="1422.01">we immediately flushed the element from</span> <span data-start="1422.01" data-end="1424.08">the constructing register and we just</span> <span data-start="1424.08" data-end="1428.7">put it on to the element stack next is</span> <span data-start="1428.7" data-end="1432.33">text text is pretty simple it's going to</span> <span data-start="1432.33" data-end="1434.64">pop the element at the head of the</span> <span data-start="1434.64" data-end="1436.77">element stack off create a text node</span> <span data-start="1436.77" data-end="1439.35">append it and then push it back on to</span> <span data-start="1439.35" data-end="1443.37">the stack and I guess yeah it's 26 + 1</span> <span data-start="1443.37" data-end="1445.77">is this pointing at the first item</span> <span data-start="1445.77" data-end="1447.3">inside of the constants pool so it knows</span> <span data-start="1447.3" data-end="1452.04">how to pick up hello Chad next is close</span> <span data-start="1452.04" data-end="1454.26">element what close element does is it</span> <span data-start="1454.26" data-end="1456">just takes the element that's at the</span> <span data-start="1456" data-end="1457.86">head of the stack and appends it to the</span> <span data-start="1457.86" data-end="1463.11">dom and then finally we return and what</span> <span data-start="1463.11" data-end="1465.63">return does is it just sets the the</span> <span data-start="1465.63" data-end="1467.43">return address to the program counter</span> <span data-start="1467.43" data-end="1470.1">which sets it to negative 1 negative 1</span> <span data-start="1470.1" data-end="1472.64">is our way in the system to say</span> <span data-start="1472.64" data-end="1475.05">basically halt there is no more</span> <span data-start="1475.05" data-end="1477.36">instructions to actually execute and</span> <span data-start="1477.36" data-end="1480.4">that's that's pretty much it that's how</span> <span data-start="1480.4" data-end="1482.89">we take this binary format and actually</span> <span data-start="1482.89" data-end="1488.14">turn it into a working UI so we really</span> <span data-start="1488.14" data-end="1489.97">think about the glimmer VM as a</span> <span data-start="1489.97" data-end="1492.07">declarative programming language for</span> <span data-start="1492.07" data-end="1494.32">creating you eyes and the glimmer VM is</span> <span data-start="1494.32" data-end="1496.15">a virtual machine in byte code format</span> <span data-start="1496.15" data-end="1500.08">for constructing those you eyes so you</span> <span data-start="1500.08" data-end="1502.45">may have also heard of this thing called</span> <span data-start="1502.45" data-end="1504.76">web assembly and it is quote/unquote a</span> <span data-start="1504.76" data-end="1507.46">bytecode for the web so what how does</span> <span data-start="1507.46" data-end="1509.62">this like relate to the thing that</span> <span data-start="1509.62" data-end="1510.19">you're building</span> <span data-start="1510.19" data-end="1513.52">well web assembly is more of like a</span> <span data-start="1513.52" data-end="1516.28">portable binary format than it is</span> <span data-start="1516.28" data-end="1518.44">anything really to do with the web right</span> <span data-start="1518.44" data-end="1520.24">now so for example you cannot call</span> <span data-start="1520.24" data-end="1522.61">web-based api's inside of web assembly</span> <span data-start="1522.61" data-end="1524.679">it's really good for number crunching</span> <span data-start="1524.679" data-end="1526.78">and doing these types of really awesome</span> <span data-start="1526.78" data-end="1528.97">demos like porting the unity gaming</span> <span data-start="1528.97" data-end="1534.13">engine to to the web but it's still</span> <span data-start="1534.13" data-end="1536.11">pretty interesting it has a lot of cool</span> <span data-start="1536.11" data-end="1538.72">properties associated with it so some of</span> <span data-start="1538.72" data-end="1541.87">those properties are how it did how its</span> <span data-start="1541.87" data-end="1544.09">actually process on the client so on the</span> <span data-start="1544.09" data-end="1545.86">top here we have JavaScript and</span> </p>
<p><span data-start="1545.86" data-end="1547.09">JavaScript goes through parse and</span> <span data-start="1547.09" data-end="1548.47">compile stuff and then goes through an</span> <span data-start="1548.47" data-end="1551.59">optimization step if the code because</span> <span data-start="1551.59" data-end="1554.679">JavaScript is a dynamic language you can</span> <span data-start="1554.679" data-end="1556.45">deopt as you're running it so then you</span> <span data-start="1556.45" data-end="1558.46">have to reoptimize it and throwing away</span> <span data-start="1558.46" data-end="1560.89">any optimized code that you you have it</span> <span data-start="1560.89" data-end="1562.78">has to execute and then you have you</span> <span data-start="1562.78" data-end="1565.17">have to GC at certain points of time</span> <span data-start="1565.17" data-end="1568.51">whereas web assembly it parses and</span> <span data-start="1568.51" data-end="1570.82">compiles directly to optimized code it</span> <span data-start="1570.82" data-end="1574.36">has no optimizing the when you actually</span> <span data-start="1574.36" data-end="1576.19">compile it it compiles into the most</span> <span data-start="1576.19" data-end="1578.62">optimized code and it cannot deopt</span> <span data-start="1578.62" data-end="1581.92">and that's because you it is a compile</span> <span data-start="1581.92" data-end="1584.32">target and you're taking languages that</span> <span data-start="1584.32" data-end="1585.94">have static type information you're</span> <span data-start="1585.94" data-end="1588.28">compiling it into something that is</span> <span data-start="1588.28" data-end="1591.07">strong guarantees around it the other</span> <span data-start="1591.07" data-end="1593.74">thing that that's really great about web</span> <span data-start="1593.74" data-end="1596.86">assembly here is that you get it has the</span> <span data-start="1596.86" data-end="1600.19">ability to compile faster than it is to</span> <span data-start="1600.19" data-end="1602.92">download so it has a streaming compiler</span> <span data-start="1602.92" data-end="1605.17">a streaming parser and compiler and</span> <span data-start="1605.17" data-end="1609.01">javascript has this also but like like</span> <span data-start="1609.01" data-end="1610.84">almost like the JPEG format it's already</span> <span data-start="1610.84" data-end="1613.18">closer to the binary format so</span> <span data-start="1613.18" data-end="1616.18">it can happen much quicker the other</span> <span data-start="1616.18" data-end="1618.16">thing is about webassembly is that it</span> <span data-start="1618.16" data-end="1620.38">has predictable performance and this</span> <span data-start="1620.38" data-end="1623.02">kind of goes back to the Diop tree</span> <span data-start="1623.02" data-end="1626.14">optimization step I'm not sure how many</span> <span data-start="1626.14" data-end="1628.81">people saw this blog article where</span> </p>
<p><span data-start="1628.81" data-end="1632.2">Mozilla took the source map library and</span> <span data-start="1632.2" data-end="1634.81">converted parts of it to rust and then</span> <span data-start="1634.81" data-end="1636.49">compiled the web assembly and got some</span> <span data-start="1636.49" data-end="1638.92">like ridiculous performance benefits out</span> <span data-start="1638.92" data-end="1640.9">of it because of the code being like</span> <span data-start="1640.9" data-end="1645.4">highly could be highly polymorphic now</span> <span data-start="1645.4" data-end="1647.86">you can write highly tuned JavaScript</span> <span data-start="1647.86" data-end="1650.02">code to get to that same level of</span> <span data-start="1650.02" data-end="1652.54">performance but not everybody is a</span> <span data-start="1652.54" data-end="1654.82">browser engineer and knows all the fast</span> <span data-start="1654.82" data-end="1657.52">paths inside of the actual JavaScript</span> <span data-start="1657.52" data-end="1660.67">engine so webassembly kind of alleviates</span> <span data-start="1660.67" data-end="1664.02">having to know all of those details but</span> <span data-start="1664.02" data-end="1667.24">one of the issues with web assembly is</span> <span data-start="1667.24" data-end="1669.7">that you typically have to write in a</span> <span data-start="1669.7" data-end="1672.88">systems like language so C C++ rust and</span> <span data-start="1672.88" data-end="1677.47">then compile them to web assembly and I</span> <span data-start="1677.47" data-end="1680.08">don't know about you guys but this is</span> <span data-start="1680.08" data-end="1682.24">not what I do in my day to day job I'm</span> <span data-start="1682.24" data-end="1684.82">not writing C C simple C++ or rust</span> <span data-start="1684.82" data-end="1688.96">applications so we we kind of it's kind</span> <span data-start="1688.96" data-end="1693.1">of a high bar to a new entrance I think</span> <span data-start="1693.1" data-end="1695.05">right now but I don't think it actually</span> <span data-start="1695.05" data-end="1699.58">has to be or we we can use the fact that</span> <span data-start="1699.58" data-end="1703.39">we have things inside the JavaScript</span> <span data-start="1703.39" data-end="1705.7">ecosystem where we can get the benefit</span> <span data-start="1705.7" data-end="1707.65">without actually having to directly</span> <span data-start="1707.65" data-end="1711.88">write rust or C++ or any of those other</span> <span data-start="1711.88" data-end="1714.94">languages and that's because in within</span> <span data-start="1714.94" data-end="1716.86">the web community we actually have quite</span> <span data-start="1716.86" data-end="1719.59">a few domain-specific languages already</span> <span data-start="1719.59" data-end="1722.47">and those domain-specific languages and</span> <span data-start="1722.47" data-end="1724.51">the runtimes for them are already</span> <span data-start="1724.51" data-end="1727.45">written in JavaScript and so if we can</span> <span data-start="1727.45" data-end="1730.9">pour the the runtimes of these languages</span> <span data-start="1730.9" data-end="1734.26">to web assembly then we as people that</span> <span data-start="1734.26" data-end="1735.64">work with JavaScript there and building</span> <span data-start="1735.64" data-end="1737.56">things for the web can immediately get</span> <span data-start="1737.56" data-end="1739.12">the benefit of them without actually</span> <span data-start="1739.12" data-end="1742.24">having to learn how that stuff actually</span> <span data-start="1742.24" data-end="1746.26">works so earlier this year we worked</span> <span data-start="1746.26" data-end="1746.84">with</span> <span data-start="1746.84" data-end="1750.23">folks at Mozilla and a couple people</span> <span data-start="1750.23" data-end="1752.24">from there Russ core team to figure out</span> <span data-start="1752.24" data-end="1755.99">how we can utilize web assembly inside</span> <span data-start="1755.99" data-end="1758.39">of the glimmer VM so these are kind of</span> <span data-start="1758.39" data-end="1761.39">all the high-level components of the</span> <span data-start="1761.39" data-end="1763.88">goomar VM and what we notice is that all</span> <span data-start="1763.88" data-end="1765.17">this stuff on the bottom</span> <span data-start="1765.17" data-end="1767.09">the registers the opcodes the stack the</span> <span data-start="1767.09" data-end="1769.91">heap the constants the execution are all</span> <span data-start="1769.91" data-end="1772.82">things that if we were writing the VM</span> <span data-start="1772.82" data-end="1775.4">and for any other platform you would</span> <span data-start="1775.4" data-end="1778.64">probably pick a C C++ rust type of</span> <span data-start="1778.64" data-end="1782">language and so what we did was that we</span> <span data-start="1782" data-end="1784.52">took those implementations that were</span> <span data-start="1784.52" data-end="1786.68">written in JavaScript and we wrote them</span> <span data-start="1786.68" data-end="1789.41">and rust and compiled them to web</span> <span data-start="1789.41" data-end="1794.54">assembly and everything just worked so</span> <span data-start="1794.54" data-end="1796.49">we were able to drop that into an</span> <span data-start="1796.49" data-end="1798.53">existing ember we were able to like take</span> <span data-start="1798.53" data-end="1801.2">this branch build it and then drop this</span> <span data-start="1801.2" data-end="1803">version in the glimmer VM directly into</span> <span data-start="1803" data-end="1805.22">an existing ember application and that</span> <span data-start="1805.22" data-end="1808.55">ember application can run the web</span> <span data-start="1808.55" data-end="1810.53">assembly under the hood the end consumer</span> <span data-start="1810.53" data-end="1813.68">as you are like the developer the person</span> <span data-start="1813.68" data-end="1815.42">that wrote the application has no idea</span> <span data-start="1815.42" data-end="1818.09">that this actually occurred and you can</span> <span data-start="1818.09" data-end="1820.19">get the benefits that are I think now</span> <span data-start="1820.19" data-end="1822.56">starting to really land inside of web</span> <span data-start="1822.56" data-end="1827.15">assembly so these are all the ways I</span> <span data-start="1827.15" data-end="1830.36">think we're actually thinking about the</span> <span data-start="1830.36" data-end="1834.29">startup performance of applications it's</span> <span data-start="1834.29" data-end="1836.51">a pretty tricky problem because you</span> <span data-start="1836.51" data-end="1838.91">don't actually notice like parse and</span> <span data-start="1838.91" data-end="1840.23">compile problems when you're first</span> <span data-start="1840.23" data-end="1842.15">building your application and your first</span> <span data-start="1842.15" data-end="1844.37">couple features or even when you first</span> <span data-start="1844.37" data-end="1846.53">launch your application it's a problem</span> <span data-start="1846.53" data-end="1850.18">that sneaks up on you over time and like</span> <span data-start="1850.18" data-end="1852.89">we we don't do a very good job at</span> <span data-start="1852.89" data-end="1855.77">testing the whole Rea of devices for</span> <span data-start="1855.77" data-end="1857.36">making sure that our JavaScript startup</span> <span data-start="1857.36" data-end="1861.5">performance is always top notch so</span> <span data-start="1861.5" data-end="1862.82">hopefully today I showed that we</span> <span data-start="1862.82" data-end="1865.04">actually have the technology to help</span> <span data-start="1865.04" data-end="1867.08">mitigate a lot of these problems we just</span> <span data-start="1867.08" data-end="1868.73">have to think I think a little bit</span> <span data-start="1868.73" data-end="1870.67">different about how we're approaching</span> <span data-start="1870.67" data-end="1874.4">our problems and just in development in</span> <span data-start="1874.4" data-end="1878.15">general so that's it Thanks</span> </p>
</section>