<section>
<p><span data-start="8.75" data-end="12.05">hi everyone I'm Lin Clark and I make</span> <span data-start="12.05" data-end="15.86">Coke cartoons and I also work at Mozilla</span> <span data-start="15.86" data-end="18.5">on things like webassembly which I gave</span> <span data-start="18.5" data-end="20.119">a talk about last year here at Jay has</span> <span data-start="20.119" data-end="21.47">come for you in fact that was what was</span> <span data-start="21.47" data-end="23.81">featured on there and this talk is about</span> <span data-start="23.81" data-end="26.69">webassembly too but this is a different</span> <span data-start="26.69" data-end="29.71">kind of talk from last year's talk I</span> <span data-start="29.71" data-end="31.789">think you've all probably seen this</span> <span data-start="31.789" data-end="34.129">structure by now it's kind of hard to</span> <span data-start="34.129" data-end="36.26">miss right in the middle there but you</span> <span data-start="36.26" data-end="39.71">may have wondered what it was doing it's</span> <span data-start="39.71" data-end="42.25">playing animations created by all of you</span> <span data-start="42.25" data-end="47.68">but why why did we want to do this well</span> <span data-start="47.68" data-end="50.329">one of the hardest problems when you're</span> <span data-start="50.329" data-end="52.219">learning a new programming language is</span> <span data-start="52.219" data-end="54.17">figuring out a project that you can work</span> <span data-start="54.17" data-end="56.3">on one that will teach you the basics of</span> <span data-start="56.3" data-end="58.789">the programming language but still keep</span> <span data-start="58.789" data-end="60.41">you interested enough to keep learning</span> <span data-start="60.41" data-end="63.68">more because there are only so many</span> <span data-start="63.68" data-end="66.11">times they can implement HelloWorld in a</span> <span data-start="66.11" data-end="67.94">new language and have it be interesting</span> <span data-start="67.94" data-end="71.24">at all because your hello world has no</span> <span data-start="71.24" data-end="75.53">real-world impact but what if your hello</span> <span data-start="75.53" data-end="77.96">world could have an impact on the real</span> <span data-start="77.96" data-end="80.93">world what if your hello world could</span> <span data-start="80.93" data-end="83.049">control a structure like this one and</span> <span data-start="83.049" data-end="85.729">that's exactly what you can do your</span> <span data-start="85.729" data-end="87.5">hello world can play a light animation</span> <span data-start="87.5" data-end="90.53">on the space out there now some of these</span> <span data-start="90.53" data-end="92.81">animations are made with JavaScript and</span> <span data-start="92.81" data-end="95.45">if you're here you might not be too</span> <span data-start="95.45" data-end="97.34">interested in a JavaScript hello world</span> <span data-start="97.34" data-end="101.03">but some of the animations are made in a</span> <span data-start="101.03" data-end="103.189">language that you may be interested in</span> <span data-start="103.189" data-end="106.88">learning and that's rust compiled to web</span> <span data-start="106.88" data-end="110.09">assembly so you'll be coming away from</span> <span data-start="110.09" data-end="111.89">jeaious convey you with lots of new</span> <span data-start="111.89" data-end="114.29">friends and lots of new experiences and</span> </p>
<p><span data-start="114.29" data-end="116.6">I hope that one of those new experiences</span> <span data-start="116.6" data-end="119.99">is your first rust module compiled to</span> <span data-start="119.99" data-end="123.47">web assembly so let's get started on</span> <span data-start="123.47" data-end="125.689">baby's first rust â€” web assembly module</span> <span data-start="125.689" data-end="129.38">and this is kind of the perfect project</span> <span data-start="129.38" data-end="131.6">for that not because this is the kind of</span> <span data-start="131.6" data-end="133.34">project that you would usually use web</span> <span data-start="133.34" data-end="136.16">assembly for people use web assembly</span> <span data-start="136.16" data-end="137.599">because they want to supercharge their</span> <span data-start="137.599" data-end="139.51">application and make it run faster or</span> <span data-start="139.51" data-end="141.7">because they want to use the same</span> <span data-start="141.7" data-end="145.959">on the web and other platforms this</span> <span data-start="145.959" data-end="148.51">project doesn't do either of those we</span> <span data-start="148.51" data-end="150.1">create these animations ahead of time so</span> <span data-start="150.1" data-end="152.2">we don't care about having consistent</span> <span data-start="152.2" data-end="154.48">high performance and we don't need to</span> <span data-start="154.48" data-end="156.37">run on any other devices so we don't</span> <span data-start="156.37" data-end="159.88">need it to be portable the reason that</span> <span data-start="159.88" data-end="161.47">this is a good project for getting</span> <span data-start="161.47" data-end="163.42">started with web assembly is not because</span> <span data-start="163.42" data-end="165.04">this is what you usually use web</span> <span data-start="165.04" data-end="168.459">assembly for instead it's because it's</span> <span data-start="168.459" data-end="170.17">really useful in giving you a mental</span> <span data-start="170.17" data-end="172.42">model of how javascript and web assembly</span> <span data-start="172.42" data-end="176.29">work together so let's take a look at</span> <span data-start="176.29" data-end="178.42">what we need to do to take control of</span> <span data-start="178.42" data-end="180.76">this space with web assembly and then</span> </p>
<p><span data-start="180.76" data-end="182.68">I'll explain what makes a good mental</span> <span data-start="182.68" data-end="184.12">model for how web assembly and</span> <span data-start="184.12" data-end="189.28">JavaScript work together what we have</span> <span data-start="189.28" data-end="192.15">here is a three dimensional space and</span> <span data-start="192.15" data-end="193.93">really if you think about it it's</span> <span data-start="193.93" data-end="195.39">actually a four dimensional space</span> <span data-start="195.39" data-end="198.84">because we're going through time as well</span> <span data-start="198.84" data-end="201.489">the computer can't think in these four</span> <span data-start="201.489" data-end="204.7">dimensions so so how do we make these</span> <span data-start="204.7" data-end="206.95">four dimensions make sense to the</span> <span data-start="206.95" data-end="210.22">computer let's start with the fourth</span> <span data-start="210.22" data-end="212.91">dimension and collapse down from there</span> <span data-start="212.91" data-end="215.799">you're probably familiar with the way</span> <span data-start="215.799" data-end="217.299">that we make time the fourth dimension</span> <span data-start="217.299" data-end="220.84">makes sense to computers that's by using</span> <span data-start="220.84" data-end="225.07">these things called frames on the web we</span> <span data-start="225.07" data-end="227.5">talk about having 60 frames per second</span> <span data-start="227.5" data-end="229.239">that's what you need to have smooth</span> <span data-start="229.239" data-end="232.66">animations across the screen what that</span> <span data-start="232.66" data-end="234.549">really means is that you have 60</span> <span data-start="234.549" data-end="236.5">different snapshots of the screen of</span> <span data-start="236.5" data-end="238.03">what the animation should look like at</span> <span data-start="238.03" data-end="242.739">60 different moments in that second it's</span> <span data-start="242.739" data-end="245.11">kind of like a flipbook and each frame</span> <span data-start="245.11" data-end="248.38">is like a page in that flip book in our</span> <span data-start="248.38" data-end="250.69">case the snapshot is a snapshot of what</span> <span data-start="250.69" data-end="252.22">the lights on the space should look like</span> <span data-start="252.22" data-end="255.519">and our frame rate for that is 35 frames</span> <span data-start="255.519" data-end="259.299">per second so that brings us down to a</span> <span data-start="259.299" data-end="261.43">sequence of snapshots of the space a</span> <span data-start="261.43" data-end="263.53">sequence of 3d representations of the</span> <span data-start="263.53" data-end="266.62">space now we want to go from 3d to 2d</span> <span data-start="266.62" data-end="269.74">and in this case it's pretty easy all we</span> <span data-start="269.74" data-end="272.14">need to do is take the space and flatten</span> <span data-start="272.14" data-end="273.52">it out into basically a big sheet of</span> <span data-start="273.52" data-end="274.87">graph paper</span> <span data-start="274.87" data-end="277.91">so now we're down to 2d we just need to</span> <span data-start="277.91" data-end="281.33">collapse this one more time the way we</span> <span data-start="281.33" data-end="283.34">can do that is by taking each row and</span> <span data-start="283.34" data-end="285.47">putting that row next to the previous</span> <span data-start="285.47" data-end="288.2">row so now we're down to this line of</span> <span data-start="288.2" data-end="290.9">pixels and we can put this in memory</span> <span data-start="290.9" data-end="292.88">because memory is basically just the</span> <span data-start="292.88" data-end="296.12">line of boxes so this means that we've</span> <span data-start="296.12" data-end="297.89">gotten it down to a one dimensional</span> <span data-start="297.89" data-end="299.87">representation we still have all of the</span> <span data-start="299.87" data-end="301.88">data that we had in the two or the three</span> <span data-start="301.88" data-end="303.77">year the four dimensional representation</span> <span data-start="303.77" data-end="305.87">of this space is just being represented</span> <span data-start="305.87" data-end="307.4">in a different way it's being</span> <span data-start="307.4" data-end="311.96">represented as a line the reason that</span> <span data-start="311.96" data-end="314.39">this is a good mental model for how web</span> <span data-start="314.39" data-end="316.52">assembly and JavaScript work together is</span> <span data-start="316.52" data-end="318.62">because one of the main ways to</span> <span data-start="318.62" data-end="320.57">communicate between web assembly and</span> </p>
<p><span data-start="320.57" data-end="322.88">JavaScript at the moment is through</span> <span data-start="322.88" data-end="325.31">something called linear memory it's</span> <span data-start="325.31" data-end="327.23">basically a line of memory that you use</span> <span data-start="327.23" data-end="330.41">to represent things the web assembly</span> <span data-start="330.41" data-end="332.24">module and the JavaScript that's running</span> <span data-start="332.24" data-end="334.55">that module both have access to this</span> <span data-start="334.55" data-end="336.68">object through a JavaScript object</span> <span data-start="336.68" data-end="339.59">called an array buffer and this is just</span> <span data-start="339.59" data-end="341.09">an array of bytes and bytes are just</span> <span data-start="341.09" data-end="344.33">numbers so to make this animation happen</span> <span data-start="344.33" data-end="346.72">JavaScript tells the web assembly module</span> <span data-start="346.72" data-end="350.15">okay fill in the animation now and it</span> <span data-start="350.15" data-end="352.25">does this by calling a method or a</span> <span data-start="352.25" data-end="356.15">function on the web assembly module web</span> <span data-start="356.15" data-end="357.65">assembly will go and fill in all of the</span> <span data-start="357.65" data-end="359.63">numbers for each pixel in the linear</span> <span data-start="359.63" data-end="362.57">memory and then JavaScript code can pull</span> <span data-start="362.57" data-end="364.61">those numbers out and serialize them</span> <span data-start="364.61" data-end="366.44">into something that can be sent to the</span> <span data-start="366.44" data-end="370.49">space let's look more closely at the</span> </p>
<p><span data-start="370.49" data-end="373.19">JavaScript side of things let's see how</span> <span data-start="373.19" data-end="375.29">it pulls data out of the memory and uses</span> <span data-start="375.29" data-end="378.38">it if you're getting into the</span> <span data-start="378.38" data-end="379.49">nitty-gritty of this if you're doing</span> <span data-start="379.49" data-end="381.44">things the hard way and not using any</span> <span data-start="381.44" data-end="383.3">libraries then you're going to be</span> <span data-start="383.3" data-end="385.19">working directly with this linear memory</span> <span data-start="385.19" data-end="388.13">and this linear memory is just one big</span> <span data-start="388.13" data-end="392.03">line of ones and zeroes when you want to</span> <span data-start="392.03" data-end="393.86">create meaning from this line of ones</span> <span data-start="393.86" data-end="395.51">and zeroes you have to figure out how to</span> <span data-start="395.51" data-end="398.81">split them up to do this you create a</span> <span data-start="398.81" data-end="401.6">typed array view on the array buffer and</span> <span data-start="401.6" data-end="404.06">basically this just tells JavaScript how</span> <span data-start="404.06" data-end="405.83">to break up the bits in this array</span> <span data-start="405.83" data-end="408.36">buffer it's basically like drawing boxes</span> <span data-start="408.36" data-end="410.34">around the biz to say which bits belong</span> <span data-start="410.34" data-end="413.34">to which number for example if you are</span> <span data-start="413.34" data-end="416.159">using hexadecimal values then your</span> <span data-start="416.159" data-end="418.469">numbers would be 42 bits wide so you</span> <span data-start="418.469" data-end="420.539">need a box that could fit at least 40</span> <span data-start="420.539" data-end="423.449">sorry if you're using hexadecimal values</span> <span data-start="423.449" data-end="424.83">than your numbers where you 24 bits wide</span> <span data-start="424.83" data-end="426.719">so you need a box that can fit at least</span> <span data-start="426.719" data-end="429.81">24 bits and each box would contain a</span> <span data-start="429.81" data-end="433.919">pixel the smallest box that fits those</span> <span data-start="433.919" data-end="437.37">24 bits is 32 bits wide so we would</span> <span data-start="437.37" data-end="440.099">create au inch 32 view on the buffer and</span> <span data-start="440.099" data-end="443.509">that would wrap the bits up in boxes in</span> <span data-start="443.509" data-end="445.62">this case we'd have to add a little</span> <span data-start="445.62" data-end="447.389">padding to fill it out I'm not showing</span> <span data-start="447.389" data-end="448.979">that but there would be some extra zeros</span> <span data-start="448.979" data-end="454.4">in here in contrast if we use RGB values</span> <span data-start="454.4" data-end="457.5">the boxes would only be 8 bits wide and</span> <span data-start="457.5" data-end="459.99">we would take every three boxes and use</span> <span data-start="459.99" data-end="464.46">those as our our G and B values then you</span> <span data-start="464.46" data-end="465.93">would iterate over the boxes and pull</span> <span data-start="465.93" data-end="467.9">out the numbers and move the data around</span> <span data-start="467.9" data-end="471.5">insist more sensible data structures for</span> <span data-start="471.5" data-end="474.27">a project like this that's not too bad</span> <span data-start="474.27" data-end="477.599">because because colors map very well to</span> <span data-start="477.599" data-end="479.94">numbers and we don't have very complex</span> <span data-start="479.94" data-end="481.589">data structures here we just have the</span> <span data-start="481.589" data-end="484.139">our G and the B but when you start</span> <span data-start="484.139" data-end="485.969">getting more complex data structures</span> <span data-start="485.969" data-end="488.789">having to deal with memory this directly</span> <span data-start="488.789" data-end="493.08">can be a big pain the reason that you</span> <span data-start="493.08" data-end="495.06">have to deal with memory so directly</span> <span data-start="495.06" data-end="496.83">with webassembly right now the reason</span> <span data-start="496.83" data-end="498.419">that you can't just pass an object from</span> </p>
<p><span data-start="498.419" data-end="500.37">JavaScript into web assembly and have</span> <span data-start="500.37" data-end="502.139">web assembly changed properties and</span> <span data-start="502.139" data-end="504.36">values on it and then give that object</span> <span data-start="504.36" data-end="506.219">back is because webassembly doesn't yet</span> <span data-start="506.219" data-end="509.129">have direct access to JavaScript objects</span> <span data-start="509.129" data-end="512.19">or the Dom that is in the works the web</span> <span data-start="512.19" data-end="513.839">assembly community group is working on</span> <span data-start="513.839" data-end="517.14">specifying that but just because that</span> <span data-start="517.14" data-end="518.43">isn't here yet that doesn't mean that</span> <span data-start="518.43" data-end="519.899">you have to wait before you can start</span> <span data-start="519.899" data-end="521.55">working with objects you don't have to</span> <span data-start="521.55" data-end="524.43">wait you can pass objects into your web</span> <span data-start="524.43" data-end="526.68">assembly and get objects back from your</span> <span data-start="526.68" data-end="530.01">JavaScript to do this you can use a</span> <span data-start="530.01" data-end="532.579">library that gives you this nicer API</span> <span data-start="532.579" data-end="535.93">this library is called wasm bind gen</span> <span data-start="535.93" data-end="538.18">it wraps the web assembly module in a</span> </p>
<p><span data-start="538.18" data-end="540.73">JavaScript wrapper and this wrapper</span> <span data-start="540.73" data-end="542.89">knows how to take complex JavaScript</span> <span data-start="542.89" data-end="544.72">objects and write them into linear</span> <span data-start="544.72" data-end="546.79">memory and when the web assembly</span> <span data-start="546.79" data-end="548.89">function returns a value the j/s wrapper</span> <span data-start="548.89" data-end="550.66">can take data from linear memory and</span> <span data-start="550.66" data-end="553.839">turn it back into a json jacked to do</span> <span data-start="553.839" data-end="555.76">this it looks at function signatures in</span> <span data-start="555.76" data-end="557.41">your rust code and figures out exactly</span> <span data-start="557.41" data-end="559.42">what kind of javascript wrapper is</span> <span data-start="559.42" data-end="560.49">needed</span> <span data-start="560.49" data-end="562.66">this works for built-in types like</span> <span data-start="562.66" data-end="565.149">strings and it also works for types that</span> <span data-start="565.149" data-end="567.55">you define in your code wise and bind</span> <span data-start="567.55" data-end="569.74">gen will take the RUS trucks and turn</span> <span data-start="569.74" data-end="573.42">them into JavaScript object classes</span> <span data-start="573.42" data-end="576.459">right now this tool is specific to rust</span> <span data-start="576.459" data-end="578.649">but with the way that it's architected</span> <span data-start="578.649" data-end="580.66">we can add support for this kind of</span> <span data-start="580.66" data-end="582.49">higher-level interaction for other</span> <span data-start="582.49" data-end="586.47">languages languages like C and C++</span> <span data-start="586.47" data-end="588.52">there's a session that will cover the</span> <span data-start="588.52" data-end="590.32">basics of rust and some of these other</span> <span data-start="590.32" data-end="592.42">topics likewise some bind gen and woz</span> <span data-start="592.42" data-end="594.61">impac which you can use to package up</span> <span data-start="594.61" data-end="597.43">your wasm modules to go up on NPM and</span> <span data-start="597.43" data-end="599.709">this session will be tomorrow at the</span> </p>
<p><span data-start="599.709" data-end="602.74">Mozilla booth starting at 13:30 at 1:30</span> <span data-start="602.74" data-end="607.48">p.m. so hopefully now you can see how to</span> <span data-start="607.48" data-end="610.029">take control of this space and how you</span> <span data-start="610.029" data-end="612.1">can say hello to the world and hello to</span> <span data-start="612.1" data-end="615.82">the world of web assembly before I wrap</span> <span data-start="615.82" data-end="617.23">this up I do want to give credit to the</span> <span data-start="617.23" data-end="618.99">people that made this project possible</span> <span data-start="618.99" data-end="622.24">the seeds for the idea of this product</span> <span data-start="622.24" data-end="623.65">it came from a dance party that I</span> <span data-start="623.65" data-end="625.72">attended in Pittsburgh that had a space</span> <span data-start="625.72" data-end="627.85">like this but the project was only</span> <span data-start="627.85" data-end="630.16">possible because of the amazing group of</span> <span data-start="630.16" data-end="632.35">people that gathered to make it a</span> <span data-start="632.35" data-end="632.86">reality</span> <span data-start="632.86" data-end="635.08">so I want to say thank you to Sandra /</span> <span data-start="635.08" data-end="637.9">sing I came to her with a vision and she</span> <span data-start="637.9" data-end="640.45">made that vision real I want to also</span> <span data-start="640.45" data-end="641.86">want to say thank you to Dan Brown and</span> </p>
<p><span data-start="641.86" data-end="644.17">Matt's a Pluto who took that vision and</span> <span data-start="644.17" data-end="645.579">turned it into something even more</span> <span data-start="645.579" data-end="647.91">exciting and engaging than I imagined</span> <span data-start="647.91" data-end="650.11">until Schneider Wright who helped me</span> <span data-start="650.11" data-end="651.279">figure out how to bring all of these</span> <span data-start="651.279" data-end="652.709">different pieces together</span> <span data-start="652.709" data-end="655.39">Josh Mira naxi who created the site and</span> <span data-start="655.39" data-end="656.5">made taking control of the space</span> <span data-start="656.5" data-end="659.38">possible dan Callahan who you also saw</span> <span data-start="659.38" data-end="661.51">in that video he jumped in with his</span> <span data-start="661.51" data-end="663.19">debugging and development wizardry to</span> <span data-start="663.19" data-end="664.95">ensure all of the pieces work together</span> <span data-start="664.95" data-end="667.39">Trevor F Smith who created the virtual</span> <span data-start="667.39" data-end="669.1">space so that everybody can experience</span> <span data-start="669.1" data-end="670.87">this even if they aren't here at the</span> <span data-start="670.87" data-end="674.5">event also Michel Bonita and URI delenn</span> </p>
<p><span data-start="674.5" data-end="675.97">Dec whose work on webassembly studio</span> <span data-start="675.97" data-end="677.38">makes it possible to share webassembly</span> <span data-start="677.38" data-end="679.84">with the whole new audience row stations</span> <span data-start="679.84" data-end="681.91">Alex Kryten Ashley Williams Sarah Myers</span> <span data-start="681.91" data-end="684.19">Jana Jana our creditor fluorine gilt</span> <span data-start="684.19" data-end="686.62">receive clap Nick Fabian and flock e who</span> <span data-start="686.62" data-end="688.87">worked on webassembly studios rust</span> <span data-start="688.87" data-end="690.22">integration helped aspiring Russ</span> <span data-start="690.22" data-end="692.92">developers level up their skills the J's</span> <span data-start="692.92" data-end="694.3">confit you team for all of their hard</span> <span data-start="694.3" data-end="695.5">work in making sure that this</span> <span data-start="695.5" data-end="697.78">installation get off the ground and of</span> <span data-start="697.78" data-end="699.22">course umbral the artist whose work</span> <span data-start="699.22" data-end="701.35">inspired this project and she's</span> <span data-start="701.35" data-end="702.52">hard-working sure that we could share it</span> <span data-start="702.52" data-end="705.88">with you thank you and Alice party</span> </p>
</section>