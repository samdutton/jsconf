<section>
<p><span data-start="2.33" data-end="8">[Music]</span> <span data-start="8.01" data-end="10.39">thank you and you can hear me fine</span> <span data-start="10.39" data-end="13.27">everybody yes okay welcome back from</span> <span data-start="13.27" data-end="16.15">lunch I hope you're not too sleepy I'll</span> <span data-start="16.15" data-end="17.95">try to make it dramatic I certainly had</span> <span data-start="17.95" data-end="19.81">some drama in the in the break here</span> <span data-start="19.81" data-end="21.91">turns out my laptop did not connect to</span> <span data-start="21.91" data-end="24.4">the display so that was my break and I</span> <span data-start="24.4" data-end="26.02">was working what I'm still have a mild</span> <span data-start="26.02" data-end="28.99">state of panic yeah my name is Peter I'm</span> <span data-start="28.99" data-end="31.72">from Copenhagen I've been a front-end</span> <span data-start="31.72" data-end="34.05">developer for 15 years now</span> <span data-start="34.05" data-end="38.499">time flies I'm very much into tooling I</span> <span data-start="38.499" data-end="41.649">want to I want to enable people to do</span> <span data-start="41.649" data-end="45.67">complex stuff in a simple way and this</span> <span data-start="45.67" data-end="49.569">talk is about techniques how to load web</span> <span data-start="49.569" data-end="52.269">fonts fast and also tooling that I built</span> <span data-start="52.269" data-end="55.809">to help you do that so first of all</span> <span data-start="55.809" data-end="58.239">according to the HTTP archive which</span> <span data-start="58.239" data-end="61.42">scrapes like millions of pages based on</span> </p>
<p><span data-start="61.42" data-end="63.639">Alexa rank so like the most popular</span> <span data-start="63.639" data-end="65.409">pages on the Internet</span> <span data-start="65.409" data-end="67.689">70% of those pages are using web fonts</span> <span data-start="67.689" data-end="70.84">and that is a performance problem</span> <span data-start="70.84" data-end="73.659">because if you don't do something extra</span> <span data-start="73.659" data-end="75.729">to make a web fonts perform then they</span> <span data-start="75.729" data-end="77.109">will actually detract from your</span> <span data-start="77.109" data-end="80.14">performance and that has to do with the</span> <span data-start="80.14" data-end="82.14">wave fonts are loaded but I'm gonna</span> <span data-start="82.14" data-end="84.579">preempt myself and actually start out</span> <span data-start="84.579" data-end="86.259">with a demo and then we can look at the</span> <span data-start="86.259" data-end="89.02">difference between what default web</span> <span data-start="89.02" data-end="91.45">fonts performance profile could be and</span> <span data-start="91.45" data-end="93.67">what an optimized one could be so I'm</span> <span data-start="93.67" data-end="95.289">gonna start out with showing you the</span> <span data-start="95.289" data-end="97.479">tool and then I'll walk you through the</span> <span data-start="97.479" data-end="99.189">techniques applied which you could also</span> <span data-start="99.189" data-end="101.619">apply manually and then I'll explain</span> <span data-start="101.619" data-end="107.049">things as we go so first of all I have a</span> <span data-start="107.049" data-end="109.719">blog very rarely updated like two years</span> <span data-start="109.719" data-end="114.31">ago so this is a standard jackhole site</span> <span data-start="114.31" data-end="117.67">it's hosted on net Liffe I so I get</span> <span data-start="117.67" data-end="119.979">static file hosting which is fast I have</span> <span data-start="119.979" data-end="122.649">a CDN which which delivers things fast I</span> <span data-start="122.649" data-end="124.63">run a static build system on this so</span> <span data-start="124.63" data-end="126.579">everything is optimized there's bundling</span> <span data-start="126.579" data-end="128.14">this minification there's compression</span> <span data-start="128.14" data-end="133.22">all those things and the performer</span> <span data-start="133.22" data-end="135.92">profiles actually not that good so I can</span> <span data-start="135.92" data-end="138.08">show you first of all I'm gonna run the</span> <span data-start="138.08" data-end="141.98">demo here if Network permitting I'm</span> <span data-start="141.98" data-end="145.49">gonna run my tool here I'm gonna install</span> <span data-start="145.49" data-end="147.32">the tool called sub font which is an</span> <span data-start="147.32" data-end="149.15">open source tool I built if the network</span> <span data-start="149.15" data-end="150.83">doesn't work we'll just skip ahead</span> <span data-start="150.83" data-end="153.71">because I have a fallback it looks like</span> <span data-start="153.71" data-end="154.22">it's working</span> <span data-start="154.22" data-end="156.26">thank you for not running Dropbox right</span> <span data-start="156.26" data-end="158.6">now nice of you okay</span> </p>
<p><span data-start="158.6" data-end="161">I installed sub font so I'm gonna I'm</span> <span data-start="161" data-end="163.37">gonna open my package JSON and I'm gonna</span> <span data-start="163.37" data-end="168.05">autumn and my build system my build</span> <span data-start="168.05" data-end="170.63">system is currently bundled x''k Jake</span> <span data-start="170.63" data-end="172.54">you'll build so it's a Jekyll page and</span> <span data-start="172.54" data-end="175.52">after I've done that I'm gonna say soft</span> <span data-start="175.52" data-end="180.02">font bill slash index dot HTML which is</span> <span data-start="180.02" data-end="181.85">where the build artifacts from Jekyll</span> <span data-start="181.85" data-end="185.45">will be I'm gonna say — I which means</span> <span data-start="185.45" data-end="187.37">that it'll clobber the files which I'm</span> <span data-start="187.37" data-end="189.17">fine with because it's a build artifact</span> <span data-start="189.17" data-end="194.65">and then I'm gonna say inline CSS save</span> <span data-start="194.65" data-end="199.489">and I'm gonna do npm run build so what</span> <span data-start="199.489" data-end="201.709">will happen now is the Jekyll build will</span> <span data-start="201.709" data-end="203.81">will run I will have a build artifact</span> <span data-start="203.81" data-end="206.51">and index.html sup font the tool will go</span> <span data-start="206.51" data-end="208.52">in a statically analyze the page figure</span> <span data-start="208.52" data-end="210.29">out that I have google fonts and then</span> <span data-start="210.29" data-end="212.51">it'll do magic which I will show you in</span> <span data-start="212.51" data-end="215.54">in a moment Network permitting because</span> <span data-start="215.54" data-end="217.22">now it's actually going on the network</span> <span data-start="217.22" data-end="220">to fetch funds from from Google Fonts</span> <span data-start="220" data-end="223.61">and then my post optimization tool is</span> <span data-start="223.61" data-end="227.84">ran just like normally and I cheated I</span> <span data-start="227.84" data-end="231.41">already prepared a web page test or run</span> <span data-start="231.41" data-end="234.65">on my master before the optimization and</span> <span data-start="234.65" data-end="240.2">one after and it looks like this so I</span> <span data-start="240.2" data-end="242.209">don't know if you can see this the upper</span> <span data-start="242.209" data-end="245.42">timeline is my blog as I just showed it</span> <span data-start="245.42" data-end="248.59">to you on the different tab it takes</span> <span data-start="248.59" data-end="251.03">four and a half to five seconds before I</span> <span data-start="251.03" data-end="254.17">get the first paint and then it takes</span> <span data-start="254.17" data-end="256.85">slightly somewhere in between six and a</span> <span data-start="256.85" data-end="258.739">half seconds and seven seconds to get</span> <span data-start="258.739" data-end="261.5">the fonts that's a long time this is</span> <span data-start="261.5" data-end="263.96">done on a moto 4G and a slow 3G</span> <span data-start="263.96" data-end="265.729">connection that is deemed to be the</span> <span data-start="265.729" data-end="266.17">current</span> <span data-start="266.17" data-end="268.81">global average so if you have pages that</span> <span data-start="268.81" data-end="270.49">you're interested in also serving in</span> </p>
<p><span data-start="270.49" data-end="274.27">South America Africa Asia then you want</span> <span data-start="274.27" data-end="277.33">to perform on this profile the bottom</span> <span data-start="277.33" data-end="280.09">timeline timeline is the after after I</span> <span data-start="280.09" data-end="282.61">ran this tool and you can see that I</span> <span data-start="282.61" data-end="285.19">have a first paint at four seconds</span> <span data-start="285.19" data-end="287.62">instead of seven seconds because I</span> <span data-start="287.62" data-end="289.99">already have the fonts that's a massive</span> <span data-start="289.99" data-end="293.23">difference and obviously the difference</span> <span data-start="293.23" data-end="294.82">will be less pronounced if you have a</span> <span data-start="294.82" data-end="297.64">fast Network and a fast CPU but the</span> <span data-start="297.64" data-end="299.52">difference will still be perceivable</span> <span data-start="299.52" data-end="303.25">so let's look into why why is there this</span> <span data-start="303.25" data-end="306.07">massive difference and the upper the</span> <span data-start="306.07" data-end="310.54">upper line is running Google Fonts as as</span> <span data-start="310.54" data-end="312.85">suggested by Google Fonts it's included</span> <span data-start="312.85" data-end="315.31">with a link tag it's including the style</span> <span data-start="315.31" data-end="316.9">sheet from Google Fonts which will then</span> <span data-start="316.9" data-end="319.27">eventually point at the font files which</span> <span data-start="319.27" data-end="324.42">are needed so let's look at the timeline</span> <span data-start="324.42" data-end="326.71">is this big enough that you can see it</span> <span data-start="326.71" data-end="328.93">you think I can up it one more there we</span> <span data-start="328.93" data-end="329.23">go</span> <span data-start="329.23" data-end="332.92">alright so this is a this is my page you</span> <span data-start="332.92" data-end="335.05">can see the initial request has a slow</span> </p>
<p><span data-start="335.05" data-end="337.18">T&S it has a slow connection time it has</span> <span data-start="337.18" data-end="340.78">an SSL handshake then it has a roundtrip</span> <span data-start="340.78" data-end="342.43">for waiting for the data and then the</span> <span data-start="342.43" data-end="345.31">index.html drops in that's at around 2.2</span> <span data-start="345.31" data-end="348.4">seconds then a bunch of new connections</span> <span data-start="348.4" data-end="351.7">are triggered my CSS some images and the</span> </p>
<p><span data-start="351.7" data-end="353.41">Google Fonts CSS and then you see oh I</span> <span data-start="353.41" data-end="355.54">need to know the DNS I need another</span> <span data-start="355.54" data-end="357.61">connection I need another SSL roundtrip</span> <span data-start="357.61" data-end="359.65">and then I need another entre for the</span> <span data-start="359.65" data-end="363.16">data and then the green line indicates</span> <span data-start="363.16" data-end="364.69">that now the browser is ready to render</span> <span data-start="364.69" data-end="367.75">now it has loaded this external blocking</span> <span data-start="367.75" data-end="371.05">Google style sheet and and it says oh</span> <span data-start="371.05" data-end="373.57">there are some fonts and I need to fetch</span> <span data-start="373.57" data-end="376.99">them and then it does another DNS lookup</span> <span data-start="376.99" data-end="379.18">and another connection and another SSL</span> <span data-start="379.18" data-end="380.86">handshakes and then it and then it</span> <span data-start="380.86" data-end="384.45">downloads the fonts this is very slow</span> <span data-start="384.45" data-end="387.43">and this is like what what Google serves</span> <span data-start="387.43" data-end="390.31">you as the default it doesn't even serve</span> <span data-start="390.31" data-end="391.93">the fonts from the same domain as the</span> </p>
<p><span data-start="391.93" data-end="394.39">CSS so you don't already have a warmed</span> <span data-start="394.39" data-end="396.16">up connection which you can request the</span> <span data-start="396.16" data-end="398.86">fonts on if you use google fonts</span> <span data-start="398.86" data-end="399.59">out-of-the-box</span> <span data-start="399.59" data-end="402.05">this is what you'll get and we can do</span> <span data-start="402.05" data-end="405.77">better so this is the after timeline I'm</span> <span data-start="405.77" data-end="407.03">going to switch back and forth so you</span> <span data-start="407.03" data-end="410.06">can just see later so what happens here</span> <span data-start="410.06" data-end="411.79">is that my index file comes in</span> <span data-start="411.79" data-end="413.96">approximately the same time that there's</span> <span data-start="413.96" data-end="416.15">no difference and then immediately I</span> <span data-start="416.15" data-end="419.66">download the four fonts in parallel with</span> <span data-start="419.66" data-end="423.65">requesting my my stylesheet and and all</span> <span data-start="423.65" data-end="425.87">those things and then you can see later</span> <span data-start="425.87" data-end="427.91">after after the paint after the three</span> <span data-start="427.91" data-end="430.34">point two ish seconds the green line</span> <span data-start="430.34" data-end="432.44">where the browser has already rendered</span> <span data-start="432.44" data-end="435.92">with fonts it does some more things it</span> <span data-start="435.92" data-end="438.29">downloads the google fonts CSS and then</span> <span data-start="438.29" data-end="440.12">it downs upload and loads another file</span> <span data-start="440.12" data-end="441.86">that's a part I can't explain right now</span> </p>
<p><span data-start="441.86" data-end="446.63">I'll fix that eventually so you can kind</span> <span data-start="446.63" data-end="448.55">of perceive the difference that here you</span> <span data-start="448.55" data-end="452.3">have a very very horizontal waterfall</span> <span data-start="452.3" data-end="455.06">chart and here it becomes more vertical</span> <span data-start="455.06" data-end="456.88">so it does more things at the same time</span> <span data-start="456.88" data-end="460.37">leverage is http/2 and and downloads</span> <span data-start="460.37" data-end="463.49">things in parallel so I'll show you</span> <span data-start="463.49" data-end="466.49">which techniques I I used to achieve</span> <span data-start="466.49" data-end="469.94">this but let's first do a small video</span> <span data-start="469.94" data-end="474.76">comparison so just to have a feeling for</span> <span data-start="474.76" data-end="479.36">what the perceived difference is that's</span> <span data-start="479.36" data-end="483.56">what the user experience is right okay</span> <span data-start="483.56" data-end="486.11">let's let's dive into what what actually</span> <span data-start="486.11" data-end="488.6">happened here this should probably be</span> <span data-start="488.6" data-end="495.28">smaller and this should be prettier okay</span> <span data-start="495.28" data-end="499.39">so this is where things get interesting</span> <span data-start="499.39" data-end="503.75">my tool looked at the original link</span> <span data-start="503.75" data-end="506.06">include from from from google fonts for</span> <span data-start="506.06" data-end="508.13">the star seed and that it analyzed the</span> <span data-start="508.13" data-end="511.48">page pulled down the pages to local</span> <span data-start="511.48" data-end="514.13">which means that now I can download the</span> <span data-start="514.13" data-end="517.04">font or it pulled on the fonts to to my</span> <span data-start="517.04" data-end="518.9">local server which means that now I can</span> <span data-start="518.9" data-end="521.36">reuse my already warm HTTP to connection</span> <span data-start="521.36" data-end="524.66">from my host and I preload the fonts</span> <span data-start="524.66" data-end="527.27">which have a known file name the trick</span> <span data-start="527.27" data-end="529.34">is with google fonts and with any web</span> <span data-start="529.34" data-end="531.5">phone provider out there like Typekit or</span> <span data-start="531.5" data-end="532.4">similar</span> <span data-start="532.4" data-end="534.74">none of them provide stable URLs for the</span> <span data-start="534.74" data-end="537.59">font files so you cannot even put a</span> <span data-start="537.59" data-end="539.84">preload header and and say I want to</span> <span data-start="539.84" data-end="541.25">preload this well file because</span> <span data-start="541.25" data-end="543.95">eventually it might change the URL so we</span> <span data-start="543.95" data-end="545.24">cannot guarantee that it actually works</span> <span data-start="545.24" data-end="547.04">the worst case is you'll spend the</span> <span data-start="547.04" data-end="548.6">download time and downloading the font</span> <span data-start="548.6" data-end="550.34">file and then you download a different</span> <span data-start="550.34" data-end="551.87">font file which is essentially the same</span> <span data-start="551.87" data-end="554.84">thing so by pulling it down on your own</span> <span data-start="554.84" data-end="557.63">server you can leverage the preload by a</span> <span data-start="557.63" data-end="560.36">by having a guaranteed file name and you</span> <span data-start="560.36" data-end="562.07">can use your already warmed up already</span> <span data-start="562.07" data-end="565.16">connected HTTP to connection if you</span> <span data-start="565.16" data-end="566.84">remember one thing then then it's this</span> <span data-start="566.84" data-end="569.93">one this is like 80 to 90 percent of the</span> <span data-start="569.93" data-end="572.12">speed-up you just saw all the rest is</span> <span data-start="572.12" data-end="575.99">just geekery like preload and get your</span> <span data-start="575.99" data-end="578.93">fonts local so this one more thing I'm</span> <span data-start="578.93" data-end="580.43">doing which is cheap which you can do</span> <span data-start="580.43" data-end="581.93">yourself when you have the funds local</span> <span data-start="581.93" data-end="586.43">you can add a font display font display</span> <span data-start="586.43" data-end="589.06">has a few options on how to deal with</span> <span data-start="589.06" data-end="591.83">the limbo in between the page being</span> <span data-start="591.83" data-end="594.38">render and font being downloaded and I</span> <span data-start="594.38" data-end="596.72">recommend having fun to play swap which</span> <span data-start="596.72" data-end="598.64">will immediately draw the fallback font</span> <span data-start="598.64" data-end="600.08">as soon as it as soon as your page</span> <span data-start="600.08" data-end="602.12">renders and then whenever the web font</span> <span data-start="602.12" data-end="604.73">comes in and switches them because this</span> <span data-start="604.73" data-end="606.5">means that the time the time to</span> <span data-start="606.5" data-end="608.48">meaningful paint the time where the user</span> <span data-start="608.48" data-end="610.67">can actually read the page and see if</span> <span data-start="610.67" data-end="613.4">it's useful is the same as the time to</span> <span data-start="613.4" data-end="615.62">first paint so the larger uses to</span> <span data-start="615.62" data-end="618.26">immediately see do I want to do even</span> <span data-start="618.26" data-end="619.94">want to be here do I want to scroll or</span> <span data-start="619.94" data-end="621.56">engage with this page and then</span> <span data-start="621.56" data-end="623.27">eventually the nice experience will come</span> <span data-start="623.27" data-end="628.52">in when the web font drops in so in</span> <span data-start="628.52" data-end="629.84">order to serve it from local I'm using</span> <span data-start="629.84" data-end="632.51">the same technique as Google toss prefer</span> <span data-start="632.51" data-end="636.32">local otherwise use this URL for both -</span> <span data-start="636.32" data-end="638.69">and this URL for what you don't need to</span> <span data-start="638.69" data-end="640.46">make anymore gymnastics these days the</span> <span data-start="640.46" data-end="643.61">process are good enough that basically</span> <span data-start="643.61" data-end="645.05">all the process you want to support or</span> <span data-start="645.05" data-end="649.16">any support wofe and I'm pre loading</span> <span data-start="649.16" data-end="650.72">only there were two files because</span> <span data-start="650.72" data-end="653.93">preload support is a subset of waft of</span> <span data-start="653.93" data-end="656.96">to support so it's safe to say preload</span> <span data-start="656.96" data-end="658.94">above two files because if the browser</span> <span data-start="658.94" data-end="660.71">doesn't understand it it's a guarantee</span> <span data-start="660.71" data-end="663.02">that it probably doesn't understand what</span> <span data-start="663.02" data-end="665.929">you either</span> <span data-start="665.939" data-end="668.819">and then I'm doing something tricky so</span> <span data-start="668.819" data-end="671.149">there's a little script down here</span> <span data-start="671.149" data-end="674.309">preload is supported by around 60% of</span> <span data-start="674.309" data-end="678.359">all browsers but there exists a CSS</span> <span data-start="678.359" data-end="680.129">front loading API which you can access</span> <span data-start="680.129" data-end="682.859">through JavaScript and through this you</span> <span data-start="682.859" data-end="685.109">can actually trigger a load of the font</span> <span data-start="685.109" data-end="687.299">even for browsers that don't have P load</span> <span data-start="687.299" data-end="689.489">support yet this is what fun face</span> <span data-start="689.489" data-end="691.049">observer does if you've ever heard of</span> <span data-start="691.049" data-end="694.319">that which lets you like do a promise</span> <span data-start="694.319" data-end="695.97">based thing where I say I want to load</span> <span data-start="695.97" data-end="697.679">this font and when you're done I can</span> <span data-start="697.679" data-end="700.079">switch classes so I can like do a</span> <span data-start="700.079" data-end="701.97">loading spinner or or control the</span> <span data-start="701.97" data-end="704.129">experience in the in between in the</span> <span data-start="704.129" data-end="705.569">limbo between not having the fund and</span> <span data-start="705.569" data-end="708.239">having written at the page this is the</span> <span data-start="708.239" data-end="710.399">very short version what it's doing it</span> <span data-start="710.399" data-end="712.589">says it's iterating through the fonts on</span> <span data-start="712.589" data-end="715.979">on the on page and then I'm saying if it</span> <span data-start="715.979" data-end="717.749">has this specific name underscore</span> <span data-start="717.749" data-end="719.459">underscore subset which I'll come back</span> <span data-start="719.459" data-end="723.299">to all of these above have the have</span> <span data-start="723.299" data-end="726.139">underscore underscore subset in the name</span> <span data-start="726.139" data-end="728.339">so if it has underscore underscore</span> <span data-start="728.339" data-end="730.769">subset in the name please try and load</span> <span data-start="730.769" data-end="733.049">it and there's a try-catch around it</span> <span data-start="733.049" data-end="734.999">because this API isn't supported by all</span> <span data-start="734.999" data-end="738.359">browsers so I'll just do an empty error</span> <span data-start="738.359" data-end="739.919">handling I don't care about the result I</span> <span data-start="739.919" data-end="741.059">just want to trigger that download</span> <span data-start="741.059" data-end="744.629">immediately if it's available again if</span> <span data-start="744.629" data-end="746.399">you remember anything these are these</span> <span data-start="746.399" data-end="747.809">are the preload things you can do to get</span> <span data-start="747.809" data-end="751.409">like 90% of the speed-up I just got so</span> <span data-start="751.409" data-end="755.399">now let's talk about the hairy stuff I'm</span> <span data-start="755.399" data-end="759.059">not ok with 90% I want to enable people</span> <span data-start="759.059" data-end="762.449">to get perfect results with very little</span> <span data-start="762.449" data-end="766.22">work so I thought this sub setting thing</span> <span data-start="766.22" data-end="769.829">selecting a subset of glyphs that are</span> <span data-start="769.829" data-end="771.629">used on my page and excluding the ones</span> <span data-start="771.629" data-end="774.239">that are not using on my page that seems</span> <span data-start="774.239" data-end="776.249">like a doable thing right there are</span> <span data-start="776.249" data-end="777.869">tools to do it if you know what glyphs</span> <span data-start="777.869" data-end="780.089">you have you can apply a tool on your</span> <span data-start="780.089" data-end="782.429">font and then you can get a reduced font</span> <span data-start="782.429" data-end="784.979">that only has the glyphs you need easy</span> <span data-start="784.979" data-end="788.879">right after so after we did this we</span> <span data-start="788.879" data-end="791.819">coined a concept called hybrids driven</span> <span data-start="791.819" data-end="794.369">development and that's what this is you</span> <span data-start="794.369" data-end="795.959">think it's easy and then just keeps</span> <span data-start="795.959" data-end="798.629">going so let's dive into what's actually</span> <span data-start="798.629" data-end="799.209">happening</span> <span data-start="799.209" data-end="803.379">so you see that after I've figured out</span> <span data-start="803.379" data-end="807.009">how to how to know what cliffs I have on</span> <span data-start="807.009" data-end="811.3">my page that's hard I do this thing</span> <span data-start="811.3" data-end="814.269">where I have a new name for the font the</span> <span data-start="814.269" data-end="816.939">original name was notice Arif now the</span> <span data-start="816.939" data-end="818.499">name is notice Arif on the score on the</span> <span data-start="818.499" data-end="822.369">score subset so I'm actually including</span> <span data-start="822.369" data-end="825.129">the subset here and I've modified my CSS</span> <span data-start="825.129" data-end="828.339">so it points at the subset this is not</span> <span data-start="828.339" data-end="831.399">recommended practice in fact web font</span> <span data-start="831.399" data-end="833.679">experts will specifically tell you to</span> <span data-start="833.679" data-end="835.66">not too aggressive subsetting it is an</span> <span data-start="835.66" data-end="836.259">anti-pattern</span> <span data-start="836.259" data-end="840.879">and it just so happens that so this is</span> <span data-start="840.879" data-end="842.559">an example of a subset where only the</span> </p>
<p><span data-start="842.559" data-end="845.649">English character sets are downloaded</span> <span data-start="845.649" data-end="847.839">but it has this effect if you do it</span> <span data-start="847.839" data-end="851.709">wrong you might recognize this as as</span> <span data-start="851.709" data-end="855.04">Germans I have a um loud in my in my</span> <span data-start="855.04" data-end="855.61">last name</span> <span data-start="855.61" data-end="857.319">I've had many different renderings of</span> <span data-start="857.319" data-end="860.74">you or not both both this one and also</span> <span data-start="860.74" data-end="863.97">different characters especially Airlines</span> <span data-start="863.97" data-end="866.379">but what happened here was there was a</span> <span data-start="866.379" data-end="868.66">subset that and somebody forgot to</span> <span data-start="868.66" data-end="872.139">include um lab in the font so that one</span> <span data-start="872.139" data-end="874.089">glyph is rendered with a fallback font</span> <span data-start="874.089" data-end="875.679">and in this case the fallback font</span> <span data-start="875.679" data-end="877.36">doesn't really look anything like the</span> <span data-start="877.36" data-end="883.869">web font if you only serve a subset then</span> <span data-start="883.869" data-end="885.999">you might run into this especially if</span> <span data-start="885.999" data-end="888.16">dynamic stuff is happening on your page</span> <span data-start="888.16" data-end="890.499">our comment by somebody is loaded</span> <span data-start="890.499" data-end="893.23">they're Chinese and they write in</span> </p>
<p><span data-start="893.23" data-end="894.85">Chinese then it will definitely not be</span> <span data-start="894.85" data-end="898.569">in the web form that you anticipated so</span> <span data-start="898.569" data-end="903.069">I came up with a new technique to load a</span> <span data-start="903.069" data-end="906.279">subset and use a subset but still have a</span> <span data-start="906.279" data-end="908.829">proper fallback so at the time where a</span> <span data-start="908.829" data-end="912.459">new cliff loads or is needed it will</span> <span data-start="912.459" data-end="916.749">actually load the original font so that</span> <span data-start="916.749" data-end="918.519">is on demand and I have not seen this</span> <span data-start="918.519" data-end="920.139">technique before so I'm gonna try and</span> <span data-start="920.139" data-end="922.959">show you if if I can find where this is</span> <span data-start="922.959" data-end="927.579">used so I'm pre connecting to two more -</span> <span data-start="927.579" data-end="930.999">two more URLs one is fun stuff Google</span> </p>
<p><span data-start="930.999" data-end="932.35">API is calm once</span> <span data-start="932.35" data-end="936.19">funky static calm those are the the</span> <span data-start="936.19" data-end="937.84">places where the CSS and the fonts are</span> <span data-start="937.84" data-end="939.67">hosted on Google Fonts so I'm already</span> <span data-start="939.67" data-end="941.62">warming up the connection just in case I</span> <span data-start="941.62" data-end="944.47">need to look the fallbacks then all the</span> <span data-start="944.47" data-end="950.46">way at the bottom I have this ugly block</span> <span data-start="950.46" data-end="952.9">which is a script and an L script and</span> <span data-start="952.9" data-end="956.2">that's essentially loading the CSS the</span> <span data-start="956.2" data-end="958.15">original CSS from from google fonts that</span> <span data-start="958.15" data-end="962.62">I had but in an asynchronous way when</span> <span data-start="962.62" data-end="965.17">you when a script append a link tag like</span> <span data-start="965.17" data-end="967.24">this it'll load asynchronously so I've</span> <span data-start="967.24" data-end="970.33">just removed that slow connection time</span> <span data-start="970.33" data-end="972.73">and round-trip to Google Fonts from my</span> <span data-start="972.73" data-end="975.91">critical rendering path but I still get</span> <span data-start="975.91" data-end="977.62">this stuff but it's just not in my</span> <span data-start="977.62" data-end="980.74">critical path anymore so I'm warming up</span> <span data-start="980.74" data-end="983.38">these connections and in order to both</span> <span data-start="983.38" data-end="985.75">use the subset and enable me to fall</span> <span data-start="985.75" data-end="989.26">back to the original web font I will</span> <span data-start="989.26" data-end="992.2">need to look into build something that's</span> </p>
<p><span data-start="992.2" data-end="996.73">CSS main that's users probably know what</span> <span data-start="996.73" data-end="998.71">to say there we go so I've rewritten all</span> <span data-start="998.71" data-end="1002.28">the usages so this was my original usage</span> <span data-start="1002.28" data-end="1005.61">as I said I want to use no Caesaria and</span> <span data-start="1005.61" data-end="1006.93">fall back to serife but now our</span> <span data-start="1006.93" data-end="1009.78">prepended this this subset so the effect</span> <span data-start="1009.78" data-end="1012.63">of this is that if a glyph is missing in</span> <span data-start="1012.63" data-end="1017.64">a web font these these declarations will</span> <span data-start="1017.64" data-end="1019.68">be tried in order so it'll start with my</span> <span data-start="1019.68" data-end="1021.84">subset figure out this glyph is missing</span> <span data-start="1021.84" data-end="1023.82">then I'd load the next one at least</span> <span data-start="1023.82" data-end="1027">that's the spec and Chrome and opera</span> <span data-start="1027" data-end="1029.82">does it correct Firefox has a bug which</span> </p>
<p><span data-start="1029.82" data-end="1031.71">I'm tracking right now it also has a</span> <span data-start="1031.71" data-end="1033.33">park where they load these things</span> <span data-start="1033.33" data-end="1035.4">upfront which means that you pay more</span> <span data-start="1035.4" data-end="1037.83">bytes but it actually doesn't infect</span> <span data-start="1037.83" data-end="1039.93">your your time — first meaningful paint</span> <span data-start="1039.93" data-end="1041.54">because the subset is already</span> <span data-start="1041.54" data-end="1043.56">pre-empting and and you can already</span> <span data-start="1043.56" data-end="1046.41">render before so even though some</span> <span data-start="1046.41" data-end="1047.79">browsers are loading a few more bites</span> <span data-start="1047.79" data-end="1051.21">there's still no downsides if your goal</span> <span data-start="1051.21" data-end="1053.04">is to get a first meaningful for paint</span> <span data-start="1053.04" data-end="1057.96">faster so I skipped over the hard part</span> <span data-start="1057.96" data-end="1060.96">which was figuring out which glyphs I'm</span> <span data-start="1060.96" data-end="1061.99">using</span> <span data-start="1061.99" data-end="1064.2">[Music]</span> <span data-start="1064.2" data-end="1067.529">it sounds easy and that's what we said</span> </p>
<p><span data-start="1067.529" data-end="1072.51">I happen to be a former colleague of one</span> <span data-start="1072.51" data-end="1074.73">of the web's foremost web font experts</span> <span data-start="1074.73" data-end="1077.61">Rammstein years ago we worked at the</span> <span data-start="1077.61" data-end="1080.34">same company and so we were having a</span> <span data-start="1080.34" data-end="1082.289">reunion birria like two years ago and I</span> <span data-start="1082.289" data-end="1083.7">was sitting there with another different</span> <span data-start="1083.7" data-end="1085.83">colleague and we were like hah I'm this</span> <span data-start="1085.83" data-end="1087.779">subsetting stuff how hard can that be</span> <span data-start="1087.779" data-end="1089.58">like you could just statically analyze</span> <span data-start="1089.58" data-end="1092.34">the the font or the text on the page and</span> <span data-start="1092.34" data-end="1094.62">then you know what cliffs you use right</span> <span data-start="1094.62" data-end="1098.19">and he goes no you cannot you cannot do</span> <span data-start="1098.19" data-end="1099.75">that there's all sorts of things and</span> <span data-start="1099.75" data-end="1101.19">we're drunk and we're not listening to</span> <span data-start="1101.19" data-end="1103.38">him we're like yeah yeah yeah we can do</span> <span data-start="1103.38" data-end="1106.799">this so the reason why we were that</span> <span data-start="1106.799" data-end="1109.62">cocky is that we spend a lot of time</span> <span data-start="1109.62" data-end="1111.809">building static analysis tools which</span> <span data-start="1111.809" data-end="1114.929">look at at a page as a whole as a one</span> <span data-start="1114.929" data-end="1116.88">single data model it has access to the</span> </p>
<p><span data-start="1116.88" data-end="1119.309">Dom to the CSS to JavaScript everything</span> <span data-start="1119.309" data-end="1121.169">at the same time which means that we</span> <span data-start="1121.169" data-end="1123.45">have the basis to do a static analysis</span> <span data-start="1123.45" data-end="1126">that would know which CSS applies to</span> <span data-start="1126" data-end="1129.899">which text so that's a tool set called</span> <span data-start="1129.899" data-end="1132.389">asset graph and it's using JSON</span> <span data-start="1132.389" data-end="1135.269">internally to model HTML so when we</span> <span data-start="1135.269" data-end="1136.95">started doing this Hybris driven</span> <span data-start="1136.95" data-end="1138.539">development we thought we'll just get</span> <span data-start="1138.539" data-end="1141.149">computed style and then we have the font</span> <span data-start="1141.149" data-end="1142.86">properties that we're interested in and</span> <span data-start="1142.86" data-end="1145.289">then we can figure out how they group to</span> <span data-start="1145.289" data-end="1147.09">the font files and then everything is</span> <span data-start="1147.09" data-end="1149.159">good handed off to a sub setting tool</span> <span data-start="1149.159" data-end="1151.98">and then we have a result jsm does not</span> <span data-start="1151.98" data-end="1153.99">have get computed style for inherited</span> <span data-start="1153.99" data-end="1159.48">properties so we implemented it which</span> <span data-start="1159.48" data-end="1162.779">turns out to teach me a lot about how</span> </p>
<p><span data-start="1162.779" data-end="1165.57">CSS font resolution is actually working</span> <span data-start="1165.57" data-end="1168.99">so just to do a short walk through you</span> <span data-start="1168.99" data-end="1172.169">you see the the the declaration you use</span> <span data-start="1172.169" data-end="1174.929">you see which selector applies to its</span> <span data-start="1174.929" data-end="1176.97">dom nodes the no declarations followed</span> <span data-start="1176.97" data-end="1179.82">you figure out this a specific font you</span> <span data-start="1179.82" data-end="1182.75">look up the front face declaration you</span> <span data-start="1182.75" data-end="1185.789">see which weights it has and if it's</span> <span data-start="1185.789" data-end="1188.399">italic and not and that classifies it to</span> <span data-start="1188.399" data-end="1191.309">which fonts you need to download so now</span> <span data-start="1191.309" data-end="1192.929">you have the weights and and the</span> <span data-start="1192.929" data-end="1194.73">approximate font and then if you don't</span> <span data-start="1194.73" data-end="1196.44">have all the funds for all the weights</span> <span data-start="1196.44" data-end="1198.06">that you specified it'll snap</span> <span data-start="1198.06" data-end="1200.1">- the ones available and then you need</span> <span data-start="1200.1" data-end="1202.65">to take care of things like you can set</span> <span data-start="1202.65" data-end="1204.54">a CSS property called font-weight:bold</span> <span data-start="1204.54" data-end="1207.69">er which means that after all this</span> <span data-start="1207.69" data-end="1209.55">snapping has happened it's gonna say oh</span> <span data-start="1209.55" data-end="1212.04">you want it I'm in a contact I've</span> <span data-start="1212.04" data-end="1213.93">already built but I want Boulder I'm</span> <span data-start="1213.93" data-end="1217.08">gonna do one higher of whatever is</span> <span data-start="1217.08" data-end="1218.64">available so all of these things are</span> <span data-start="1218.64" data-end="1221.49">very dynamic and very hard to track then</span> <span data-start="1221.49" data-end="1224.18">you have CSS generated content you have</span> <span data-start="1224.18" data-end="1226.83">visible attributes like placeholder</span> <span data-start="1226.83" data-end="1230.04">attributes then you have potentially</span> <span data-start="1230.04" data-end="1232.68">different states hover States active</span> <span data-start="1232.68" data-end="1234.75">states in CSS you have media queries</span> <span data-start="1234.75" data-end="1237.48">suddenly this problem is not just I have</span> <span data-start="1237.48" data-end="1239.25">a text node and I'm getting the computer</span> <span data-start="1239.25" data-end="1242.28">style its multi-dimensional multiple</span> <span data-start="1242.28" data-end="1245.43">states at the same time which all might</span> <span data-start="1245.43" data-end="1248.01">affect which glyphs and end up in which</span> <span data-start="1248.01" data-end="1252.36">pocket for which font file we ended up</span> <span data-start="1252.36" data-end="1255.87">actually implementing all of this and I</span> <span data-start="1255.87" data-end="1258.03">have not seen an implementation of this</span> <span data-start="1258.03" data-end="1260.13">before so I think this is genuinely a</span> <span data-start="1260.13" data-end="1262.92">new contribution there exists a</span> <span data-start="1262.92" data-end="1265.08">different tool called cliffhanger which</span> <span data-start="1265.08" data-end="1267.96">does get computed style for for text</span> <span data-start="1267.96" data-end="1270.15">nodes for also for attributes but</span> <span data-start="1270.15" data-end="1273.48">doesn't do the State thing so if you're</span> <span data-start="1273.48" data-end="1275.28">interested in in trying to look into</span> <span data-start="1275.28" data-end="1277.37">that cliffhanger is easier code to read</span> <span data-start="1277.37" data-end="1281.13">look at that and if you're taunting then</span> <span data-start="1281.13" data-end="1282.81">come speak to me and I'll walk you</span> <span data-start="1282.81" data-end="1285.12">through through our code and how we did</span> <span data-start="1285.12" data-end="1292.77">this so this tool only works for static</span> <span data-start="1292.77" data-end="1297.63">files for static pages so this means</span> <span data-start="1297.63" data-end="1299.61">that if you have a static page like</span> </p>
<p><span data-start="1299.61" data-end="1303.69">Jekyll or if they use Hugo or I don't</span> <span data-start="1303.69" data-end="1304.95">know there's a lot of different static</span> <span data-start="1304.95" data-end="1308.04">page generators these days this is a</span> <span data-start="1308.04" data-end="1311.85">tool for you you can keep doing the the</span> <span data-start="1311.85" data-end="1314.79">default recommended style of including</span> <span data-start="1314.79" data-end="1316.89">google fonts like this it also works</span> <span data-start="1316.89" data-end="1319.98">with local funds there is a there is a</span> <span data-start="1319.98" data-end="1321.51">Python dependency if you want to do</span> <span data-start="1321.51" data-end="1324.06">local subsetting it'll help you install</span> <span data-start="1324.06" data-end="1328.41">that when you when you hit that but if</span> <span data-start="1328.41" data-end="1330.72">you have a dynamic page you might be out</span> <span data-start="1330.72" data-end="1332.02">of luck</span> <span data-start="1332.02" data-end="1334.67">dynamic pages take several forms some</span> <span data-start="1334.67" data-end="1337.04">maybe have a static loading screen or a</span> <span data-start="1337.04" data-end="1339.32">static header then you could still run</span> <span data-start="1339.32" data-end="1340.55">this and you could get immediate</span> <span data-start="1340.55" data-end="1342.8">rendering of your static header but the</span> <span data-start="1342.8" data-end="1345.14">dynamic parts it doesn't really cover so</span> <span data-start="1345.14" data-end="1348.05">if you want to do fonts upsetting again</span> </p>
<p><span data-start="1348.05" data-end="1351.14">I cannot repeat this enough don't don't</span> <span data-start="1351.14" data-end="1354.14">do funds upsetting for that just don't</span> <span data-start="1354.14" data-end="1355.7">like it will not be enough to know</span> <span data-start="1355.7" data-end="1357.59">what's in your words in your translation</span> <span data-start="1357.59" data-end="1359.69">system or what's in on your pages</span> <span data-start="1359.69" data-end="1361.94">because there are weird States you could</span> <span data-start="1361.94" data-end="1363.56">get into and you cannot predict them</span> <span data-start="1363.56" data-end="1366.19">when you do dynamic JavaScript that said</span> <span data-start="1366.19" data-end="1368.9">preload preload print up preload</span> <span data-start="1368.9" data-end="1372.43">remember that go home and do it it's</span> <span data-start="1372.43" data-end="1375.47">it's like a half an hour change you can</span> <span data-start="1375.47" data-end="1377.09">download the web fonts from Google the</span> <span data-start="1377.09" data-end="1379.58">license allows you to they're available</span> <span data-start="1379.58" data-end="1381.32">on github I think they're even available</span> <span data-start="1381.32" data-end="1384.71">as NPM installs you can point a preload</span> <span data-start="1384.71" data-end="1387.74">link you can use an HTTP header if you</span> <span data-start="1387.74" data-end="1389.78">have access to to set your HTTP headers</span> <span data-start="1389.78" data-end="1391.73">this increases your performance</span> <span data-start="1391.73" data-end="1397.55">immensely so go and do that so I</span> <span data-start="1397.55" data-end="1400.43">encourage you to try this I want to help</span> <span data-start="1400.43" data-end="1401.93">you like if you have time in a break</span> </p>
<p><span data-start="1401.93" data-end="1403.97">I'll help you set this up if you have a</span> <span data-start="1403.97" data-end="1406.19">static page and and see it break in all</span> <span data-start="1406.19" data-end="1407.96">the funny ways that it can and then I'll</span> <span data-start="1407.96" data-end="1411.88">have Bakri posts that I can fix but I</span> <span data-start="1411.88" data-end="1414.35">want to close off with with this is just</span> <span data-start="1414.35" data-end="1417.98">one instance of a tool as I think it</span> <span data-start="1417.98" data-end="1420.86">should it should be built I think there</span> <span data-start="1420.86" data-end="1423.07">are not enough tools that allow you to</span> <span data-start="1423.07" data-end="1427.43">work in in a non complex way and then</span> <span data-start="1427.43" data-end="1429.05">abstract the complexity away from you</span> <span data-start="1429.05" data-end="1432.59">most of the tools that exist expose you</span> <span data-start="1432.59" data-end="1435.32">to tons of complexity with configuration</span> <span data-start="1435.32" data-end="1437.99">because you have to tell it everything</span> <span data-start="1437.99" data-end="1439.84">you have to tell at every entry point</span> <span data-start="1439.84" data-end="1442.19">everything to do you have to tell it how</span> <span data-start="1442.19" data-end="1444.14">to do it and you don't tell it what to</span> <span data-start="1444.14" data-end="1448.37">do so I I want to build tools that and I</span> <span data-start="1448.37" data-end="1451.13">want others to build tools that let you</span> <span data-start="1451.13" data-end="1454.1">achieve the goal and then just look at</span> <span data-start="1454.1" data-end="1457.07">your code and does the right thing and I</span> <span data-start="1457.07" data-end="1460.04">think this is one example of such tool I</span> <span data-start="1460.04" data-end="1461.9">might do a lightning talk later where</span> <span data-start="1461.9" data-end="1464.63">there might be another one I</span> <span data-start="1464.63" data-end="1465.98">what these tools to give people</span> <span data-start="1465.98" data-end="1469.19">abilities without having to know all the</span> <span data-start="1469.19" data-end="1471.8">crazy stuff that is behind it that's</span> <span data-start="1471.8" data-end="1474.14">upsetting stuff is so hard I don't</span> <span data-start="1474.14" data-end="1476.51">expect anybody to know it like I don't</span> <span data-start="1476.51" data-end="1478.79">even expect web font experts to do it</span> <span data-start="1478.79" data-end="1481.82">because it is so error-prone so I'm</span> <span data-start="1481.82" data-end="1484.04">really hoping that I can contribute that</span> <span data-start="1484.04" data-end="1487.19">people can do this and win something</span> <span data-start="1487.19" data-end="1492.5">from it but again subsetting that's just</span> <span data-start="1492.5" data-end="1495.05">the geekery I'm loading slightly less</span> <span data-start="1495.05" data-end="1497.87">fonts it's not where the gains come from</span> <span data-start="1497.87" data-end="1503">do pre loading so I'm really also hoping</span> <span data-start="1503" data-end="1505.19">that there might be designers in the</span> <span data-start="1505.19" data-end="1508.97">room or people who specialized in HTML</span> <span data-start="1508.97" data-end="1512.33">and CSS only and don't necessarily geek</span> <span data-start="1512.33" data-end="1514.4">out on web performance like I do and I</span> <span data-start="1514.4" data-end="1516.14">hope that they can they can use this and</span> <span data-start="1516.14" data-end="1518.54">that they can build faster experiences</span> <span data-start="1518.54" data-end="1522.79">so I think that's all the words I had I</span> <span data-start="1522.79" data-end="1524.81">think this room is not so good for</span> <span data-start="1524.81" data-end="1526.67">questions so I think we'll forego them</span> </p>
<p><span data-start="1526.67" data-end="1528.59">I'll be I'll be in front of the stage</span> <span data-start="1528.59" data-end="1530">and you can come and ask me questions if</span> <span data-start="1530" data-end="1532.49">you're interested and I'll leave you</span> <span data-start="1532.49" data-end="1535.97">with those words take a look at ads up</span> <span data-start="1535.97" data-end="1538.34">front you can install it from NPM</span> <span data-start="1538.34" data-end="1540.77">if you want to and give it a go and</span> <span data-start="1540.77" data-end="1542.93">tweet at me if it doesn't work I'll fix</span> <span data-start="1542.93" data-end="1544.77">it for you thank you</span> </p>
</section>