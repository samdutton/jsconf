<section>
<p><span data-start="20.039" data-end="22.47">I'm talking about preprocessor</span> <span data-start="22.47" data-end="26.609">preprocessor a STS harder to say than I</span> <span data-start="26.609" data-end="28.189">thought</span> <span data-start="28.189" data-end="31.259">STS stands for abstract syntax tree I'll</span> <span data-start="31.259" data-end="33.78">go into that more if you're you're not</span> <span data-start="33.78" data-end="35.43">familiar with it but I just thought I'd</span> <span data-start="35.43" data-end="38.699">get that other way up front I work at</span> <span data-start="38.699" data-end="39.78">strike now</span> <span data-start="39.78" data-end="43.649">so that's outdated I think I have one</span> <span data-start="43.649" data-end="45.96">more bulleted list but my style is a</span> <span data-start="45.96" data-end="48.72">little different and it's actually not</span> <span data-start="48.72" data-end="49.469">different at all</span> <span data-start="49.469" data-end="51.059">from the way I used to do presentations</span> <span data-start="51.059" data-end="52.92">so it's completely useless information</span> <span data-start="52.92" data-end="57.269">for you anyways abusing and hacking is</span> <span data-start="57.269" data-end="59.4">is a term I'm using in this presentation</span> <span data-start="59.4" data-end="62.25">to mean using something for a reason</span> <span data-start="62.25" data-end="66.17">outside of its intended purpose oh</span> <span data-start="66.17" data-end="69.84">that's their correct size how about this</span> </p>
<p><span data-start="69.84" data-end="74.25">HTML slides for the win so this is I</span> <span data-start="74.25" data-end="77.31">think some sass or s CSS specifically</span> <span data-start="77.31" data-end="81.049">and it's kind of like a fairly</span> <span data-start="81.049" data-end="83.82">declarative syntax so what is there to</span> <span data-start="83.82" data-end="86.52">hack what is there to abuse with just</span> <span data-start="86.52" data-end="89.01">some text that turns into CSS right so</span> <span data-start="89.01" data-end="91.17">it's not necessarily an obvious place</span> <span data-start="91.17" data-end="92.43">when you're talking code you can say</span> <span data-start="92.43" data-end="94.71">like oh I can inject this here or inject</span> <span data-start="94.71" data-end="96.87">that there but you're limited by syntax</span> <span data-start="96.87" data-end="98.49">here and it's not necessarily even like</span> <span data-start="98.49" data-end="100.58">I guess it is turing-complete</span> <span data-start="100.58" data-end="102.51">especially with like checked and stuff</span> <span data-start="102.51" data-end="105.54">any Ryan's got to talk about that so so</span> <span data-start="105.54" data-end="107.04">the place that we're gonna try and</span> <span data-start="107.04" data-end="109.5">inject ourselves is in the compilation</span> <span data-start="109.5" data-end="113.67">step so how does this sass so it's just</span> <span data-start="113.67" data-end="117.18">a smaller part of this same thing turn</span> <span data-start="117.18" data-end="119.76">into actual CSS right so how do we take</span> <span data-start="119.76" data-end="121.95">that variable pull it out and then put</span> <span data-start="121.95" data-end="124.5">it in the right place to output actually</span> <span data-start="124.5" data-end="129.78">decent CSS parsing and compiling so how</span> <span data-start="129.78" data-end="131.76">does parsing work so let's narrow it</span> <span data-start="131.76" data-end="133.739">down even further we just have a single</span> <span data-start="133.739" data-end="137.37">variable declaration in sass and</span> <span data-start="137.37" data-end="141.72">naturally sass is Ruby and I don't</span> <span data-start="141.72" data-end="143.76">really program Ruby so most of my will</span> <span data-start="143.76" data-end="146.599">be in JavaScript so sorry your Ruby fan</span> <span data-start="146.599" data-end="150.689">so parsing I can I can talk about it on</span> <span data-start="150.689" data-end="152.579">a high level here and that's just like</span> <span data-start="152.579" data-end="153.28">no</span> <span data-start="153.28" data-end="155.62">the syntax rules of the language and go</span> <span data-start="155.62" data-end="158.11">through and assign what everything is</span> <span data-start="158.11" data-end="160.569">this is a variable declaration or this</span> <span data-start="160.569" data-end="163.39">is a even more specifically a string or</span> <span data-start="163.39" data-end="166.54">a value or a semicolon right figure out</span> <span data-start="166.54" data-end="169.54">all those different parts so inside this</span> <span data-start="169.54" data-end="171.37">little little guy we have the the</span> <span data-start="171.37" data-end="172.78">variable prefix we can look for the</span> <span data-start="172.78" data-end="175.209">dollar sign and we know that hey this is</span> <span data-start="175.209" data-end="177.069">about to be a variable we know it's</span> <span data-start="177.069" data-end="178.63">gonna be a variable until we hit like</span> <span data-start="178.63" data-end="180.97">white space or a semicolon and in this</span> <span data-start="180.97" data-end="182.83">case we get the variable name it's blue</span> <span data-start="182.83" data-end="184.9">and then we get a semicolon then we can</span> <span data-start="184.9" data-end="187.18">have as much white space as we want and</span> <span data-start="187.18" data-end="188.8">then we get some random string and</span> <span data-start="188.8" data-end="191.5">that's gonna be the value most of the</span> <span data-start="191.5" data-end="193.959">time CSS will let you put anything in</span> <span data-start="193.959" data-end="196.3">there as long as it's not like the</span> <span data-start="196.3" data-end="198.1">semicolon or another colon or something</span> <span data-start="198.1" data-end="201.28">like that so any non invalid character</span> <span data-start="201.28" data-end="203.2">there it's going to be the value so it</span> <span data-start="203.2" data-end="204.61">might not actually be anything to the</span> <span data-start="204.61" data-end="207.75">browser but it would be valid and then</span> <span data-start="207.75" data-end="211.6">obviously the the rule delimiter so this</span> <span data-start="211.6" data-end="214.06">is how this would parse down whenever</span> <span data-start="214.06" data-end="218.14">sass was was pulling this in more</span> <span data-start="218.14" data-end="220.15">specifically it does that</span> <span data-start="220.15" data-end="221.86">programmatically so it's going to go</span> <span data-start="221.86" data-end="224.35">through and check every possibility of</span> <span data-start="224.35" data-end="227.019">each thing of each character that it</span> <span data-start="227.019" data-end="229.48">gets to and so this is the the most</span> <span data-start="229.48" data-end="231.4">simple parser that I could write on a</span> <span data-start="231.4" data-end="235.54">single slide you have a result array and</span> <span data-start="235.54" data-end="238.239">you just want to push each token on to</span> <span data-start="238.239" data-end="241.63">the array so you say I hit a semicolon</span> <span data-start="241.63" data-end="243.88">push the semicolon token which in this</span> <span data-start="243.88" data-end="245.739">case is the string semicolon probably</span> <span data-start="245.739" data-end="249.16">would not work out well but you go</span> <span data-start="249.16" data-end="251.049">through and then you you end up with a</span> <span data-start="251.049" data-end="253.03">list of each of the tokens so rather</span> <span data-start="253.03" data-end="255.22">than having just random text strings you</span> <span data-start="255.22" data-end="257.47">know like hey this is a variable this is</span> <span data-start="257.47" data-end="259.959">a rule delimiter this is a value and</span> <span data-start="259.959" data-end="264.55">this is a rule ending statement more</span> <span data-start="264.55" data-end="266.169">realistically most people are going to</span> <span data-start="266.169" data-end="269.86">write a parser expression generator a</span> <span data-start="269.86" data-end="273.16">peg a parser expression generator is is</span> <span data-start="273.16" data-end="274.66">what this is and you don't have to know</span> <span data-start="274.66" data-end="275.919">anything about this I just wanted to</span> <span data-start="275.919" data-end="279.1">make sure I was being realistic you kind</span> <span data-start="279.1" data-end="280.87">of define that like hey a class is a dot</span> <span data-start="280.87" data-end="283.15">followed by an identifier and then</span> <span data-start="283.15" data-end="284.86">whenever I get this just give me this</span> <span data-start="284.86" data-end="286">object back and then</span> <span data-start="286" data-end="288.19">a computer will generate a parser for</span> <span data-start="288.19" data-end="289.51">you so you don't have to write all those</span> <span data-start="289.51" data-end="291.82">like reverse while loops and do a look</span> <span data-start="291.82" data-end="293.05">ahead and all that stuff</span> <span data-start="293.05" data-end="296.38">so if you are looking into writing your</span> <span data-start="296.38" data-end="298.54">own parser I probably suggest starting</span> <span data-start="298.54" data-end="300.55">at a parser expression generator so you</span> <span data-start="300.55" data-end="304.48">just write the grammar and it generates</span> <span data-start="304.48" data-end="308.26">the parser much more simple so when</span> <span data-start="308.26" data-end="309.46">you're done you need to represent the</span> <span data-start="309.46" data-end="311.83">code as data instead of pure text so now</span> <span data-start="311.83" data-end="313.45">we have somewhere in between there we</span> <span data-start="313.45" data-end="315.49">have like here what all of our symbols</span> <span data-start="315.49" data-end="319.75">are we have tokens if you will so so</span> <span data-start="319.75" data-end="322.09">this first becomes this so we have the</span> <span data-start="322.09" data-end="323.74">the variable start which is that dollar</span> <span data-start="323.74" data-end="326.13">sign we have a string which is blue</span> <span data-start="326.13" data-end="328.45">that's technically like the variable</span> <span data-start="328.45" data-end="330.13">name and then we have like the equals</span> <span data-start="330.13" data-end="335.28">operator which in CSS is the colon the</span> <span data-start="335.28" data-end="337.96">string is is the value that we have</span> <span data-start="337.96" data-end="341.02">there and then we have a rule end a rule</span> <span data-start="341.02" data-end="343.56">ender Enders game coming up soon a</span> <span data-start="343.56" data-end="349.93">sponsor but we add structure so if you</span> <span data-start="349.93" data-end="353.44">go back here you can see that it's it's</span> <span data-start="353.44" data-end="355.479">a very small CSS file it actually would</span> <span data-start="355.479" data-end="359.62">output nothing on on the other end but</span> <span data-start="359.62" data-end="360.97">we have that and we turn it into this we</span> <span data-start="360.97" data-end="363.79">say this is a single node and inside of</span> <span data-start="363.79" data-end="366.52">it has two nodes inside of it and that</span> <span data-start="366.52" data-end="370.3">is of our name and a value and so now we</span> <span data-start="370.3" data-end="373.479">have this this idea of this is a single</span> <span data-start="373.479" data-end="375.479">node and inside of our two smaller nodes</span> <span data-start="375.479" data-end="378.4">and the way the entire CSS file is going</span> <span data-start="378.4" data-end="380.71">to parse out is into these leaf nodes or</span> <span data-start="380.71" data-end="381.94">write like this so you'll always have</span> <span data-start="381.94" data-end="384.88">like a variable name or a CSS value or a</span> </p>
<p><span data-start="384.88" data-end="388.18">CSS property and you can go deep into</span> <span data-start="388.18" data-end="390.55">your your tree which we'll talk about in</span> <span data-start="390.55" data-end="393.16">a second and everything reduces down</span> <span data-start="393.16" data-end="396.07">into these very simple things they're</span> <span data-start="396.07" data-end="399.4">just put all in a list together or in a</span> <span data-start="399.4" data-end="401.229">tree together depending on how deep you</span> <span data-start="401.229" data-end="404.62">go CSS is actually not very deep sass</span> <span data-start="404.62" data-end="407.05">and compass and all that stuff they</span> <span data-start="407.05" data-end="408.46">actually allow you to nest a lot further</span> <span data-start="408.46" data-end="410.07">and so when you're parsing</span> <span data-start="410.07" data-end="412.51">pre-processors you you actually do see</span> <span data-start="412.51" data-end="414.729">like larger nesting and so you have a</span> </p>
<p><span data-start="414.729" data-end="417.669">CSS syntax tree inside of a CSS syntax</span> <span data-start="417.669" data-end="418.93">tree instead of a CSS</span> <span data-start="418.93" data-end="425.039">in texture so this is more realistic for</span> <span data-start="425.039" data-end="427.27">another very small but it actually would</span> <span data-start="427.27" data-end="430.06">output something we say like our our</span> <span data-start="430.06" data-end="434.05">outer object is a stylesheet and inside</span> <span data-start="434.05" data-end="435.789">of it it has some declarations right so</span> <span data-start="435.789" data-end="438.789">style sheets have declarations first</span> <span data-start="438.789" data-end="441.94">thing we do is we do that we set blue</span> <span data-start="441.94" data-end="444.16">before so I've omitted that section so</span> <span data-start="444.16" data-end="447.81">this fits on mostly a slide pretty close</span> <span data-start="447.81" data-end="450.88">and so we've set that variable and then</span> <span data-start="450.88" data-end="452.68">we set the the left and right and so we</span> <span data-start="452.68" data-end="454.78">know what the the name is and we know</span> <span data-start="454.78" data-end="456.37">what the value is and then we have a</span> <span data-start="456.37" data-end="458.08">declaration and we say the selector is</span> <span data-start="458.08" data-end="461.889">here RP and dot stuff and so that would</span> <span data-start="461.889" data-end="463.36">whenever you compile that that would be</span> </p>
<p><span data-start="463.36" data-end="465.849">P comma dot stuff and then there would</span> <span data-start="465.849" data-end="467.41">be the brackets and inside that are the</span> <span data-start="467.41" data-end="469.509">rules and the rules you have a list of</span> <span data-start="469.509" data-end="470.86">rules and so this is just going to be a</span> <span data-start="470.86" data-end="474.34">list of rule nodes and so in this case</span> <span data-start="474.34" data-end="479.32">it's color and value so this would just</span> <span data-start="479.32" data-end="481.75">have a single value if we wanted more</span> <span data-start="481.75" data-end="483.57">rules we could have you know background</span> <span data-start="483.57" data-end="486.58">and then have have that whole set of</span> <span data-start="486.58" data-end="487.93">rules for background and things like</span> <span data-start="487.93" data-end="490.96">that visually this is what you might</span> <span data-start="490.96" data-end="496.419">write in SAS or stylus or less I think</span> <span data-start="496.419" data-end="498.76">the and syntax works in all of them</span> <span data-start="498.76" data-end="501.25">maybe someone probably knows but in this</span> <span data-start="501.25" data-end="503.409">case we're just saying we want to modify</span> <span data-start="503.409" data-end="506.199">the hover pseudo-class of the outer</span> <span data-start="506.199" data-end="508.87">class so this is not valid CSS at this</span> <span data-start="508.87" data-end="511.389">point but it is valid SAS and we're just</span> <span data-start="511.389" data-end="514.12">saying I want the original style of a</span> <span data-start="514.12" data-end="516.75">but I just want to change the hover case</span> <span data-start="516.75" data-end="520.27">for to be underlined in this case I'm</span> <span data-start="520.27" data-end="521.589">trying to simplify so that would</span> <span data-start="521.589" data-end="523.9">actually be kind of silly because you're</span> <span data-start="523.9" data-end="526.18">not sharing anything in the long run but</span> <span data-start="526.18" data-end="532.02">simple so this becomes this so this is</span> <span data-start="532.02" data-end="535.54">our object at the bottom is a stylesheet</span> <span data-start="535.54" data-end="537.31">we have a body node and we have an a</span> <span data-start="537.31" data-end="539.079">node and inside of that we have rules</span> <span data-start="539.079" data-end="541.329">the color is black one is text</span> <span data-start="541.329" data-end="544">decoration and the hover is a new level</span> <span data-start="544" data-end="546.82">more nested so if you go back here you</span> <span data-start="546.82" data-end="548.62">can see even in the code the brackets</span> <span data-start="548.62" data-end="552.329">kind of represent that nesting</span> <span data-start="552.329" data-end="556.25">and that is an abstract syntax tree so</span> <span data-start="556.25" data-end="559.829">it's not an ast is a kind of a scary</span> <span data-start="559.829" data-end="562.079">word and everyone kind of blank stare at</span> <span data-start="562.079" data-end="564.24">you unless they've worked with them</span> <span data-start="564.24" data-end="569.069">before but it's actually an easily break</span> <span data-start="569.069" data-end="571.49">down a bowl word that's totally also</span> <span data-start="571.49" data-end="575.73">hard to break down word but abstract</span> <span data-start="575.73" data-end="577.829">means that there's no rules you can make</span> <span data-start="577.829" data-end="580.35">them however you want it really should</span> <span data-start="580.35" data-end="582.66">just be like arbitrary syntax tree</span> <span data-start="582.66" data-end="585.54">because it's it's just like whatever you</span> <span data-start="585.54" data-end="587.88">want to do is cool as long as it's a</span> <span data-start="587.88" data-end="591.06">tree syntax implies that it's about</span> <span data-start="591.06" data-end="593.55">syntax so if you're parsing code then</span> <span data-start="593.55" data-end="595.92">it's a syntax tree and tree just means</span> <span data-start="595.92" data-end="598.5">that like there are objects with an</span> <span data-start="598.5" data-end="600.899">object so it's like a very very vague</span> <span data-start="600.899" data-end="603.029">term and it almost means nothing other</span> <span data-start="603.029" data-end="605.009">than it represents some sort of</span> <span data-start="605.009" data-end="608.25">structure for code but these are</span> <span data-start="608.25" data-end="611.31">generated by every preprocessor or at</span> <span data-start="611.31" data-end="614.339">least most so what can we do with this</span> <span data-start="614.339" data-end="616.949">section so we no longer are reading text</span> <span data-start="616.949" data-end="620.88">and we don't even have valid CSS yet so</span> <span data-start="620.88" data-end="624.589">we have this object that represents our</span> <span data-start="624.589" data-end="628.56">preprocessor data and data is really</span> <span data-start="628.56" data-end="632.01">important there we can change the data</span> <span data-start="632.01" data-end="634.56">we can read the data we can add to it we</span> <span data-start="634.56" data-end="637.139">can do anything we want at that point as</span> <span data-start="637.139" data-end="639.63">data it's it's much harder to regex in</span> <span data-start="639.63" data-end="642.18">extra rules and regex</span> <span data-start="642.18" data-end="645.029">out rules that you don't want than it is</span> <span data-start="645.029" data-end="647.55">to just say like hey change the rule of</span> <span data-start="647.55" data-end="650.459">the third node to this new thing or add</span> <span data-start="650.459" data-end="653.61">another rule it's a declarative way in</span> <span data-start="653.61" data-end="656.579">code to add things in rather than regex</span> <span data-start="656.579" data-end="659.6">and and string position and stuff so</span> <span data-start="659.6" data-end="662.79">there's a compilation phase after this</span> <span data-start="662.79" data-end="667.13">so what we'll do first is reduce your</span> <span data-start="667.13" data-end="671.73">preprocessor ast into a CSS ast so you</span> <span data-start="671.73" data-end="674.73">have this ast this is the data you have</span> <span data-start="674.73" data-end="677.25">two nodes here the first one is you're</span> <span data-start="677.25" data-end="679.709">setting a variable blue to this blue</span> <span data-start="679.709" data-end="682.29">color that we've been using and then we</span> <span data-start="682.29" data-end="684.449">have a rule somewhere later that</span> <span data-start="684.449" data-end="684.87">wouldn't</span> <span data-start="684.87" data-end="686.22">actually be that well I guess you can</span> <span data-start="686.22" data-end="688.26">set a variable inside of a declaration</span> <span data-start="688.26" data-end="692.04">you have a rule and it sets the color to</span> <span data-start="692.04" data-end="694.26">that variable named blue and so this is</span> <span data-start="694.26" data-end="698.07">not this is not a valid CSS node because</span> <span data-start="698.07" data-end="702.02">there are no variables and CSS yet and</span> <span data-start="702.02" data-end="704.85">so we couldn't compile this into CSS but</span> <span data-start="704.85" data-end="707.91">what the compiler does first is reduces</span> <span data-start="707.91" data-end="711.39">the ast from the preprocessor into one</span> <span data-start="711.39" data-end="713.49">that is valid in CSS so it would take</span> <span data-start="713.49" data-end="717.3">this store that blue was the variable</span> <span data-start="717.3" data-end="720.33">and then reduce it to just say hey this</span> <span data-start="720.33" data-end="723.12">node is the color of that color and so</span> <span data-start="723.12" data-end="725.19">you no longer have the invalid variable</span> <span data-start="725.19" data-end="727.02">node and now you have a totally valid</span> </p>
<p><span data-start="727.02" data-end="730.23">CSS node so you could compile that to :</span> <span data-start="730.23" data-end="732.81">or color : that blue color and that</span> <span data-start="732.81" data-end="735.08">would be totally valid so it does this</span> <span data-start="735.08" data-end="741.51">recursively until you get back to a</span> <span data-start="741.51" data-end="744.6">valid CSS ast and then you compile that</span> <span data-start="744.6" data-end="748.44">to text so reduction goes from this to</span> <span data-start="748.44" data-end="752.37">this and it goes leaves the trunk and I</span> <span data-start="752.37" data-end="755.16">call that up the tree but that's kind of</span> <span data-start="755.16" data-end="757.35">a weird leaves too trunk would be down</span> <span data-start="757.35" data-end="759.39">the tree I don't really know I think</span> <span data-start="759.39" data-end="760.83">there are people who disagree with me</span> <span data-start="760.83" data-end="768.839">especially really angrily on Twitter so</span> <span data-start="768.839" data-end="772.23">the recap of how that compilation step</span> <span data-start="772.23" data-end="774.63">works is first it takes this block and</span> <span data-start="774.63" data-end="776.94">it changes it into something like this</span> <span data-start="776.94" data-end="778.62">and I know that's ugly you don't have to</span> <span data-start="778.62" data-end="780.029">actually be able to read that this is a</span> <span data-start="780.029" data-end="782.73">declaration it's got color in it and</span> <span data-start="782.73" data-end="787.65">then there's declaration don't that's a</span> <span data-start="787.65" data-end="790.62">special type of CSS node you know it's</span> <span data-start="790.62" data-end="795.54">too advanced but so so you have</span> <span data-start="795.54" data-end="797.67">essentially a declaration inside of a</span> <span data-start="797.67" data-end="799.68">declaration here and that's invalid in</span> </p>
<p><span data-start="799.68" data-end="802.05">CSS it's valid in sass and so what you</span> <span data-start="802.05" data-end="804.63">do is you first reduce that to three</span> <span data-start="804.63" data-end="807.57">separate declarations and you'll notice</span> <span data-start="807.57" data-end="810.42">the a and a:hover are now mixed in the</span> <span data-start="810.42" data-end="812.52">second declaration and a hover has its</span> <span data-start="812.52" data-end="815.01">own third declaration with the extra two</span> <span data-start="815.01" data-end="816.12">characters of whitespace</span> <span data-start="816.12" data-end="819.129">that are bugging me</span> <span data-start="819.129" data-end="822.259">so and then you convert that to text and</span> <span data-start="822.259" data-end="824.689">since CSS knows how to take that ast and</span> <span data-start="824.689" data-end="827.47">turn it into text that's a very simple</span> <span data-start="827.47" data-end="830.929">compilation step and so this is what</span> <span data-start="830.929" data-end="834.619">this text from before this was our</span> <span data-start="834.619" data-end="836.72">original stuff we have the extra inside</span> <span data-start="836.72" data-end="838.339">declaration and we do those few things</span> <span data-start="838.339" data-end="840.29">and now we have two separate</span> <span data-start="840.29" data-end="843.649">declarations that make sense in CSS so</span> <span data-start="843.649" data-end="847.059">in words it takes one type of text</span> <span data-start="847.059" data-end="849.649">converts it into a known but arbitrary</span> <span data-start="849.649" data-end="852.619">data format then it converts that data</span> <span data-start="852.619" data-end="855.41">into a different but arbitrary unknown</span> <span data-start="855.41" data-end="857.809">data format and then it converts that</span> <span data-start="857.809" data-end="860.35">back into text and that's the entire</span> <span data-start="860.35" data-end="864.47">preprocessor world and nutshell and so</span> <span data-start="864.47" data-end="865.73">all of you should be able to just write</span> <span data-start="865.73" data-end="868.129">pre-processors now and that's the end of</span> <span data-start="868.129" data-end="872.959">my talk so this is these are the faces</span> <span data-start="872.959" data-end="874.759">you could probably break each one of</span> <span data-start="874.759" data-end="876.259">these down into to a lot of smaller</span> <span data-start="876.259" data-end="878.809">parts but really the only hard part is</span> <span data-start="878.809" data-end="881.149">that the rest is kind of like solved</span> <span data-start="881.149" data-end="882.589">computer science II stuff right it's</span> <span data-start="882.589" data-end="883.939">easy to write parts for expression</span> <span data-start="883.939" data-end="886.519">grammars and like compilers we've got a</span> <span data-start="886.519" data-end="888.949">lot of them we can we can do better I'm</span> <span data-start="888.949" data-end="891.199">sure but there are tools that you can</span> <span data-start="891.199" data-end="893.269">kind of just use off-the-shelf to do</span> <span data-start="893.269" data-end="896.449">text to data and data to text you have</span> <span data-start="896.449" data-end="898.639">to kind of write the the bindings but</span> <span data-start="898.639" data-end="900.489">that's about it so the only thing that</span> <span data-start="900.489" data-end="904.309">like in sass or in stylus that that</span> <span data-start="904.309" data-end="906.799">people are doing really is focusing on</span> <span data-start="906.799" data-end="909.169">data ones data to what data can I take</span> <span data-start="909.169" data-end="912.829">in to convert to this regular CSS data</span> <span data-start="912.829" data-end="916.459">that we know about so the hacking part</span> <span data-start="916.459" data-end="918.109">of this is is the fun part</span> <span data-start="918.109" data-end="921.589">so what can we do data one is very</span> <span data-start="921.589" data-end="923.509">interesting because you usually have the</span> <span data-start="923.509" data-end="925.579">most amount of data usually reducing</span> <span data-start="925.579" data-end="927.739">data into data to data to could be</span> <span data-start="927.739" data-end="929.959">interesting as well if you need to know</span> <span data-start="929.959" data-end="932.299">something about the CSS structure and</span> </p>
<p><span data-start="932.299" data-end="934.009">I'll use it a little bit in in a demo</span> <span data-start="934.009" data-end="937.399">but data one has the most amount the</span> <span data-start="937.399" data-end="939.35">most dense information that you that you</span> <span data-start="939.35" data-end="943.399">can have so just my my other bulleted</span> <span data-start="943.399" data-end="945.98">list here is some things you can do with</span> <span data-start="945.98" data-end="947.48">data one that I thought I'm off the top</span> <span data-start="947.48" data-end="948.279">of my head that I won't necessarily</span> <span data-start="948.279" data-end="950.629">actually show you how but you can go</span> <span data-start="950.629" data-end="951.48">through those leaf</span> <span data-start="951.48" data-end="953.549">and you say like oh I used that variable</span> <span data-start="953.549" data-end="955.47">let me just count up all the times that</span> <span data-start="955.47" data-end="957.6">that shows up you can say like it turns</span> <span data-start="957.6" data-end="960.149">out I never use these ten variables that</span> <span data-start="960.149" data-end="962.129">I declared at the top of my file and</span> <span data-start="962.129" data-end="963.899">that can be interesting</span> <span data-start="963.899" data-end="965.459">you can change variables in real time</span> <span data-start="965.459" data-end="967.859">you say well I know I set this as this</span> <span data-start="967.859" data-end="969.66">but I'm gonna go change half of them to</span> <span data-start="969.66" data-end="973.319">a new value just by replacing the dot</span> <span data-start="973.319" data-end="975.569">value of that node and then when it</span> <span data-start="975.569" data-end="977.189">compiles it doesn't know that you</span> <span data-start="977.189" data-end="979.499">changed something you can reduce</span> <span data-start="979.499" data-end="982.009">duplicate code you can go look for</span> <span data-start="982.009" data-end="985.139">duplicate selectors and and rules and</span> <span data-start="985.139" data-end="987.089">say like well let's get rid of these you</span> <span data-start="987.089" data-end="991.22">could write a linter I think Nicole</span> <span data-start="991.22" data-end="995.939">wrote one of those and you can output</span> <span data-start="995.939" data-end="997.829">statistics and do all sorts of fun stuff</span> <span data-start="997.829" data-end="1001.639">so I'll show you some some fun stuff so</span> <span data-start="1001.639" data-end="1003.35">as long as data one is valid when you're</span> <span data-start="1003.35" data-end="1004.879">done it doesn't matter what you did to</span> <span data-start="1004.879" data-end="1006.98">it so you could completely replace it</span> <span data-start="1006.98" data-end="1010.1">with a new ast and then compile it and</span> <span data-start="1010.1" data-end="1012.559">would just compile to your new ast I'd</span> <span data-start="1012.559" data-end="1015.139">probably be ill-advised so here's my</span> <span data-start="1015.139" data-end="1021.049">first example the important eyes ast</span> <span data-start="1021.049" data-end="1024.889">modifier so you take in data which is an</span> <span data-start="1024.889" data-end="1027.98">ast and usually have a type on</span> <span data-start="1027.98" data-end="1029.299">everything because that's how you know</span> <span data-start="1029.299" data-end="1031.13">what to do with it so we check to see if</span> <span data-start="1031.13" data-end="1033.319">it's a rule if it's a rule we change its</span> <span data-start="1033.319" data-end="1038">value to have important at the end is</span> <span data-start="1038" data-end="1041.6">that this is the Bango there is it on</span> <span data-start="1041.6" data-end="1046.519">the other side oh it really is that man</span> </p>
<p><span data-start="1046.519" data-end="1051.35">I'm I'm sick so I'll play that now it</span> <span data-start="1051.35" data-end="1053.36">goes on that side right someone tell me</span> <span data-start="1053.36" data-end="1055.399">no it doesn't all right man</span> <span data-start="1055.399" data-end="1060.799">CSS not a fan</span> <span data-start="1060.809" data-end="1066.19">anyways so you'll go through this rule</span> <span data-start="1066.19" data-end="1068.38">and you'll say if this is a rule well</span> <span data-start="1068.38" data-end="1070.24">which it is because we're going through</span> <span data-start="1070.24" data-end="1072.429">this rule you'll add important to the</span> <span data-start="1072.429" data-end="1073.84">value and then whenever it gets printed</span> <span data-start="1073.84" data-end="1075.549">out that'll have important at the end so</span> <span data-start="1075.549" data-end="1077.169">if it already had important you're kind</span> <span data-start="1077.169" data-end="1078.94">of screwed we didn't check and then</span> <span data-start="1078.94" data-end="1081.58">we'll say everything is recursive in a</span> <span data-start="1081.58" data-end="1084.12">tree right so you'll say my children</span> <span data-start="1084.12" data-end="1087.73">might be rules too if I'm not a rule and</span> <span data-start="1087.73" data-end="1090.4">then so go through each node recursively</span> <span data-start="1090.4" data-end="1092.32">down the tree and if it's a rule change</span> <span data-start="1092.32" data-end="1094.21">the value to have important at the end</span> <span data-start="1094.21" data-end="1097.78">of it and really in recursive functions</span> <span data-start="1097.78" data-end="1099.1">you should like return it and stuff like</span> <span data-start="1099.1" data-end="1100.929">that but in JavaScript we're passing on</span> <span data-start="1100.929" data-end="1102.64">the same object and it'll just work</span> <span data-start="1102.64" data-end="1106.99">sorry yes that's the whole one here's</span> <span data-start="1106.99" data-end="1112.44">the opposite the undo in turn work AST</span> <span data-start="1112.44" data-end="1114.58">so we're going to go straight into the</span> <span data-start="1114.58" data-end="1117.94">children of the ASD and we're gonna see</span> <span data-start="1117.94" data-end="1122.59">if the child is a rule and it matches on</span> <span data-start="1122.59" data-end="1126.429">the string important at all then just</span> <span data-start="1126.429" data-end="1129.73">return null and essentially delete that</span> <span data-start="1129.73" data-end="1132.309">node so if if a rule has important in it</span> <span data-start="1132.309" data-end="1135.88">no longer put it in the set of rules</span> <span data-start="1135.88" data-end="1138">that we're gonna send to the compiler</span> <span data-start="1138" data-end="1141.549">otherwise return the child and then do</span> <span data-start="1141.549" data-end="1144.1">that recursively and then we'll take out</span> <span data-start="1144.1" data-end="1146.59">all those null rules at the end with the</span> <span data-start="1146.59" data-end="1150.52">compact which is a non-standard array</span> <span data-start="1150.52" data-end="1152.86">function that I'm allowing you to trust</span> <span data-start="1152.86" data-end="1157.09">me on and those rules if there were ten</span> <span data-start="1157.09" data-end="1159.52">rules before and six of them had</span> <span data-start="1159.52" data-end="1161.32">important in them now you have four</span> <span data-start="1161.32" data-end="1162.669">rules and when they get compiled just</span> <span data-start="1162.669" data-end="1165.159">the four rules come out so you have both</span> <span data-start="1165.159" data-end="1169.15">ways to turn on globally importance or</span> <span data-start="1169.15" data-end="1170.919">to remove any rule with an important you</span> <span data-start="1170.919" data-end="1173.44">could also just remove the important tag</span> <span data-start="1173.44" data-end="1175.419">which would probably may be reasonable</span> <span data-start="1175.419" data-end="1178.84">but just write them don't write them to</span> <span data-start="1178.84" data-end="1181.299">begin with so this is every preprocessor</span> <span data-start="1181.299" data-end="1184.659">every preprocessor has this face this is</span> <span data-start="1184.659" data-end="1186.429">not unique to stylist or SAS or anything</span> <span data-start="1186.429" data-end="1191.95">that we're doing up here it is varying</span> <span data-start="1191.95" data-end="1193.12">levels of difficult</span> <span data-start="1193.12" data-end="1196.84">to actually get into this phase though</span> <span data-start="1196.84" data-end="1199.6">in different preprocessors rework is a</span> <span data-start="1199.6" data-end="1200.89">pretty new one</span> <span data-start="1200.89" data-end="1207.27">by TJ Holloway J Chuck it's close enough</span> </p>
<p><span data-start="1207.27" data-end="1210.79">Vision Media and he'd he brought stylus</span> <span data-start="1210.79" data-end="1213.25">originally and rework was kind of like</span> <span data-start="1213.25" data-end="1214.84">based on what he learned from that he</span> <span data-start="1214.84" data-end="1217.8">wrote this and it is essentially just</span> <span data-start="1217.8" data-end="1222.4">like exposing the ast layer as soon as I</span> <span data-start="1222.4" data-end="1223.9">submitted this talk maybe like two days</span> <span data-start="1223.9" data-end="1225.22">later he put this out and I was kind of</span> <span data-start="1225.22" data-end="1227.47">bummed but it actually made the demo way</span> <span data-start="1227.47" data-end="1231.37">easier so I was no longer bummed as a</span> <span data-start="1231.37" data-end="1236.59">kerning nightmare or what so let's go a</span> <span data-start="1236.59" data-end="1239.53">little more real-world so compilation of</span> <span data-start="1239.53" data-end="1241.51">styles is pretty fast right like I can</span> <span data-start="1241.51" data-end="1245.17">compile like that tan line CSS or sass</span> <span data-start="1245.17" data-end="1247.6">file and like milliseconds right that's</span> <span data-start="1247.6" data-end="1250.09">pretty cool but it's not fast if you</span> <span data-start="1250.09" data-end="1252.49">want like a slider that changes a</span> <span data-start="1252.49" data-end="1254.5">variable right you can never hook this</span> <span data-start="1254.5" data-end="1256.93">on to an unchanged event and have things</span> <span data-start="1256.93" data-end="1258.61">update on the page you get a send a</span> <span data-start="1258.61" data-end="1260.41">request back to the server have it</span> <span data-start="1260.41" data-end="1262.84">compile send the file back up re-inject</span> <span data-start="1262.84" data-end="1264.64">recalculate styles that would never work</span> <span data-start="1264.64" data-end="1266.23">you'd have to have it unlike a second</span> <span data-start="1266.23" data-end="1270.22">you know max of minimum delay on the</span> <span data-start="1270.22" data-end="1273.25">change events so if you're building a</span> <span data-start="1273.25" data-end="1276.64">theme builder which say what you will</span> <span data-start="1276.64" data-end="1277.96">about the real world goodness of that</span> <span data-start="1277.96" data-end="1280.84">but I had to do it you want a color</span> <span data-start="1280.84" data-end="1282.37">picker and you want a size slider for</span> <span data-start="1282.37" data-end="1283.39">some of your variables you don't</span> <span data-start="1283.39" data-end="1284.65">necessarily want to say like make this</span> <span data-start="1284.65" data-end="1286.51">thing bigger you want to say like make</span> <span data-start="1286.51" data-end="1289.15">my base color different right you wanted</span> <span data-start="1289.15" data-end="1290.71">to change all the places you're using</span> <span data-start="1290.71" data-end="1293.1">base color in your code and that's</span> <span data-start="1293.1" data-end="1296.2">signified by variables in your CSS files</span> <span data-start="1296.2" data-end="1298.51">and you want to do it in real time and</span> <span data-start="1298.51" data-end="1300.1">the only way to do that is to avoid</span> <span data-start="1300.1" data-end="1303.43">recompiling because a compile step is</span> <span data-start="1303.43" data-end="1307.6">just going to take too long so we'll go</span> <span data-start="1307.6" data-end="1312.52">to my demo so we have this fun page</span> <span data-start="1312.52" data-end="1317.17">conventionally 75 it all right so we're</span> <span data-start="1317.17" data-end="1319.24">running this this is a page with a</span> <span data-start="1319.24" data-end="1321.91">little bit of CSS I can show you my</span> <span data-start="1321.91" data-end="1326.789">example CSS file this is the my CSS</span> <span data-start="1326.789" data-end="1330.48">if I literally adapt my CSS it is my own</span> <span data-start="1330.48" data-end="1335.159">rework CSS preprocessor which has one</span> <span data-start="1335.159" data-end="1336.72">feature which is variable so I've turned</span> <span data-start="1336.72" data-end="1339.69">on variables so I'm using BG color for</span> <span data-start="1339.69" data-end="1341.789">this background border-radius big border</span> <span data-start="1341.789" data-end="1345.149">radius that type of stuff and then in my</span> <span data-start="1345.149" data-end="1348.36">index.html file I have a header and a</span> <span data-start="1348.36" data-end="1350.34">sub header and then I style that with</span> <span data-start="1350.34" data-end="1353.179">with those things and then somewhere</span> <span data-start="1353.179" data-end="1355.98">that isn't open I pass the data for what</span> <span data-start="1355.98" data-end="1357.45">those variables should be and I won't</span> <span data-start="1357.45" data-end="1360.179">try and open that right now so we have</span> <span data-start="1360.179" data-end="1362.669">values for this and this comes out as</span> </p>
<p><span data-start="1362.669" data-end="1364.499">CSS on the other end so now you can see</span> <span data-start="1364.499" data-end="1367.35">the values so this is example that's the</span> <span data-start="1367.35" data-end="1369.389">SS it comes out the other end</span> <span data-start="1369.389" data-end="1371.429">precompiled actually pre-compile onload</span> <span data-start="1371.429" data-end="1374.039">so each time it'll do that and you can</span> <span data-start="1374.039" data-end="1376.019">see you have a background color here we</span> <span data-start="1376.019" data-end="1378.99">have more background colors and so those</span> <span data-start="1378.99" data-end="1381.33">are getting set what I also add it was</span> <span data-start="1381.33" data-end="1384.179">an endpoint to add dot JSON to the end</span> <span data-start="1384.179" data-end="1389.249">of every single CSS file what that'll do</span> <span data-start="1389.249" data-end="1393.36">is it'll take the ast go find every</span> <span data-start="1393.36" data-end="1396.929">variable and then reduce essentially</span> <span data-start="1396.929" data-end="1398.97">flipped the file on its head so what we</span> <span data-start="1398.97" data-end="1401.129">have here is data that says this is the</span> </p>
<p><span data-start="1401.129" data-end="1403.049">BG color variable this is the app width</span> <span data-start="1403.049" data-end="1404.909">variable this is the border color and in</span> <span data-start="1404.909" data-end="1407.19">here we have a list of selectors that</span> <span data-start="1407.19" data-end="1410.249">end up using this variable and then the</span> <span data-start="1410.249" data-end="1412.59">rules that they use it on so we know</span> <span data-start="1412.59" data-end="1414.539">that dot container contains a border</span> <span data-start="1414.539" data-end="1416.759">radius where the value is big border</span> <span data-start="1416.759" data-end="1419.309">radius and that seems cool like we now</span> <span data-start="1419.309" data-end="1421.289">have a list of all our variables so that</span> <span data-start="1421.289" data-end="1424.409">was pretty easy to get based on on just</span> <span data-start="1424.409" data-end="1426.269">going through the nodes and saying is</span> <span data-start="1426.269" data-end="1428.73">this a variable node and if it is add it</span> <span data-start="1428.73" data-end="1430.619">to this list and then you kind of have</span> <span data-start="1430.619" data-end="1432.779">to do some hacky stuff in order to get</span> <span data-start="1432.779" data-end="1434.249">the selectors back out</span> <span data-start="1434.249" data-end="1437.279">depending on your preprocessor but we</span> <span data-start="1437.279" data-end="1439.98">can pull in that data here and it got</span> <span data-start="1439.98" data-end="1442.559">way bigger we can pull in that data here</span> <span data-start="1442.559" data-end="1444.899">and we have this thing I've injected on</span> <span data-start="1444.899" data-end="1446.73">the top and I have all the code for this</span> <span data-start="1446.73" data-end="1448.289">for you that I'm not going to walk</span> <span data-start="1448.289" data-end="1452.179">through because that's a fun demo but</span> <span data-start="1452.179" data-end="1454.259">essentially what we're doing here is we</span> <span data-start="1454.259" data-end="1456.21">go through those variables we list them</span> <span data-start="1456.21" data-end="1458.429">out here and then based on with they say</span> <span data-start="1458.429" data-end="1459.9">width or color I'll give</span> <span data-start="1459.9" data-end="1461.94">the correct picker forum and also tell</span> <span data-start="1461.94" data-end="1463.74">you how many times they they were used</span> <span data-start="1463.74" data-end="1467.01">and so bgcolor is used twice and we know</span> <span data-start="1467.01" data-end="1468.84">the selector and we know the rule so</span> </p>
<p><span data-start="1468.84" data-end="1470.34">I'll use the selector real fast to show</span> <span data-start="1470.34" data-end="1474.33">you the three pages on the three places</span> <span data-start="1474.33" data-end="1477.23">on the page that bgcolor actually gets</span> <span data-start="1477.23" data-end="1479.91">used or at least which elements so this</span> <span data-start="1479.91" data-end="1482.31">is being used on the HTML element the</span> <span data-start="1482.31" data-end="1484.26">body element which I guess starts at the</span> <span data-start="1484.26" data-end="1486.75">top of this thing since I have a margin</span> <span data-start="1486.75" data-end="1490.38">on it and then also bgcolor is used as</span> <span data-start="1490.38" data-end="1493.89">the text color for leaf them alone which</span> <span data-start="1493.89" data-end="1496.29">is more hilarious than you guys gave it</span> <span data-start="1496.29" data-end="1497.84">credit for</span> <span data-start="1497.84" data-end="1501.72">and so we're using a single variable it</span> <span data-start="1501.72" data-end="1503.58">shows up in two selectors and it's on</span> <span data-start="1503.58" data-end="1505.02">three elements and this is data that you</span> <span data-start="1505.02" data-end="1506.76">can never see like where are my</span> <span data-start="1506.76" data-end="1509.55">variables being used in my page that's</span> <span data-start="1509.55" data-end="1511.77">pretty cool you see like app width is</span> <span data-start="1511.77" data-end="1514.32">used on this you see border color border</span> <span data-start="1514.32" data-end="1516">radius all that stuff so that's pretty</span> <span data-start="1516" data-end="1519.48">cool but also we can we can inject new</span> <span data-start="1519.48" data-end="1521.7">styles we know the selector we know the</span> <span data-start="1521.7" data-end="1523.65">rule and we know our new value that we</span> <span data-start="1523.65" data-end="1525.51">want to try out so we can pop up a color</span> <span data-start="1525.51" data-end="1528.09">picker and say this is BG color and just</span> <span data-start="1528.09" data-end="1530.31">inject a totally new style like so we're</span> <span data-start="1530.31" data-end="1531.78">not recompiling we're injecting a new</span> <span data-start="1531.78" data-end="1534.57">style like a style element and we'll put</span> <span data-start="1534.57" data-end="1538.14">the selector bracket rule :</span> <span data-start="1538.14" data-end="1539.64">and then whatever we're picking from</span> <span data-start="1539.64" data-end="1541.53">this color selector on a change event so</span> <span data-start="1541.53" data-end="1544.16">we can do this straight off of our</span> <span data-start="1544.16" data-end="1546.2">variables so this is completely</span> <span data-start="1546.2" data-end="1550.17">generated from the data inside of your</span> <span data-start="1550.17" data-end="1551.91">ast you don't have to program this</span> <span data-start="1551.91" data-end="1553.47">somewhere else we can add a new variable</span> <span data-start="1553.47" data-end="1555.75">to our file it will automatically show</span> <span data-start="1555.75" data-end="1557.88">up in this list so we can come in and</span> <span data-start="1557.88" data-end="1560.67">change the app with to something that's</span> <span data-start="1560.67" data-end="1565.01">more CSS friendly change the border to</span> <span data-start="1565.01" data-end="1567.03">invariably if you give someone complete</span> <span data-start="1567.03" data-end="1568.98">control it looks like this every time</span> <span data-start="1568.98" data-end="1571.17">right this is my favorite doesn't like</span> <span data-start="1571.17" data-end="1574.15">that trips me out man</span> </p>
<p><span data-start="1574.15" data-end="1576.83">I'm I like nyquil right now but that's</span> <span data-start="1576.83" data-end="1580.46">that's good anyways and then we can get</span> <span data-start="1580.46" data-end="1582.44">a bitter header color in there and so</span> <span data-start="1582.44" data-end="1585.77">that's that's my one example of some</span> <span data-start="1585.77" data-end="1589.01">crazy stuff that you can do I have this</span> <span data-start="1589.01" data-end="1594.289">available at this URL talk slash abusing</span> <span data-start="1594.289" data-end="1596.84">- preprocessor  STS and you can see</span> <span data-start="1596.84" data-end="1598.97">that you had to run an Express app in</span> <span data-start="1598.97" data-end="1601.37">order to do that compilation step but</span> <span data-start="1601.37" data-end="1602.36">you can kind of see it's all well</span> <span data-start="1602.36" data-end="1606.2">commented on on how that works but thank</span> </p>
</section>