<section>
<p><span data-start="0" data-end="9.539">you</span> <span data-start="9.549" data-end="12.799">I'm Robert Kieffer I'm a facebook</span> <span data-start="12.799" data-end="16.52">engineer on the chat team and if you</span> <span data-start="16.52" data-end="18.59">need to contact me at any point I'm rufa</span> <span data-start="18.59" data-end="21.38">pretty much everywhere skype IRC Twitter</span> <span data-start="21.38" data-end="24.86">etc and I just want to thank you guys</span> <span data-start="24.86" data-end="26.599">for coming here I know we've got got</span> </p>
<p><span data-start="26.599" data-end="29.57">Isaac next door doing the NPM talk and I</span> <span data-start="29.57" data-end="32.78">actually really like mtm a lot and kind</span> <span data-start="32.78" data-end="34.129">of wish i was there as well to check</span> <span data-start="34.129" data-end="36.399">that out so I appreciate your time here</span> <span data-start="36.399" data-end="40.73">so let me start by giving a little</span> <span data-start="40.73" data-end="42.559">background on who I am since I don't</span> <span data-start="42.559" data-end="44.179">know how many of you I actually heard of</span> <span data-start="44.179" data-end="47.39">me I've been developing web apps for</span> <span data-start="47.39" data-end="49.989">actually quite a while I started writing</span> <span data-start="49.989" data-end="54.679">rich like MVC JavaScript applications in</span> <span data-start="54.679" data-end="60.14">the client back in 1998 1999 and I've</span> <span data-start="60.14" data-end="62.6">been doing that for pretty much the my</span> <span data-start="62.6" data-end="64.489">whole career since then I've at</span> <span data-start="64.489" data-end="67.19">companies like AOL Google most recently</span> </p>
<p><span data-start="67.19" data-end="69.2">Facebook and with a couple of startups</span> <span data-start="69.2" data-end="71.66">in between so I like to think I've got a</span> <span data-start="71.66" data-end="73.04">pretty good perspective on this whole</span> <span data-start="73.04" data-end="79.19">hold javascript thing um as far as my my</span> <span data-start="79.19" data-end="82.22">street cred with node goes I've got my</span> <span data-start="82.22" data-end="83.81">fingers on a couple of little things I</span> <span data-start="83.81" data-end="85.46">would say like modules that are more</span> <span data-start="85.46" data-end="86.9">micro libraries than anything else</span> <span data-start="86.9" data-end="90.35">things like node mine which i guess is</span> <span data-start="90.35" data-end="92.72">used and expressed and and connect these</span> <span data-start="92.72" data-end="96.83">days if you want to do RFC compliant</span> <span data-start="96.83" data-end="99.38">uuid generation my node uuid library is</span> <span data-start="99.38" data-end="103.16">the way to go jayus litmus is a ad hoc</span> <span data-start="103.16" data-end="106.58">benchmarking library I did that was the</span> <span data-start="106.58" data-end="108.92">basis of jas perf calm and then</span> <span data-start="108.92" data-end="111.439">a little library for doing n64</span> <span data-start="111.439" data-end="115.67">manipulation in a node thrift which</span> <span data-start="115.67" data-end="117.95">way'd winsome as has been putting</span> <span data-start="117.95" data-end="122.869">together and then within Facebook I seem</span> <span data-start="122.869" data-end="124.58">to have fallen into the role of internal</span> <span data-start="124.58" data-end="128.479">node evangelist so Adam wolf and I run</span> <span data-start="128.479" data-end="131.12">the the node group that's internal to</span> </p>
<p><span data-start="131.12" data-end="133.13">Facebook and I'll talk a little talk a</span> <span data-start="133.13" data-end="134.36">little bit more about what exactly that</span> <span data-start="134.36" data-end="138.44">means to evangelize within a company so</span> <span data-start="138.44" data-end="139.76">let me set the background for this a</span> <span data-start="139.76" data-end="142.22">little bit just to give you guys some</span> <span data-start="142.22" data-end="144.41">context and maybe to give those of you</span> <span data-start="144.41" data-end="146.03">who are here thinking I'm going to be</span> <span data-start="146.03" data-end="148.19">talking about us deploying thousands of</span> <span data-start="148.19" data-end="150.65">servers in production and all the hard</span> <span data-start="150.65" data-end="153.31">data and stuff that we learned from that</span> <span data-start="153.31" data-end="155.63">opportunity to go head over to Isaac's</span> <span data-start="155.63" data-end="158.239">talk because the reality is Facebook</span> <span data-start="158.239" data-end="160.209">isn't doing enough with node right now</span> <span data-start="160.209" data-end="164.239">we're actually just getting started but</span> </p>
<p><span data-start="164.239" data-end="166.01">I think what we are doing is pretty</span> <span data-start="166.01" data-end="167.87">interesting and more importantly what I</span> <span data-start="167.87" data-end="171.23">really want to talk about today is it's</span> <span data-start="171.23" data-end="173.209">sort of the note in the context of a</span> <span data-start="173.209" data-end="175.1">large company like Facebook where you</span> <span data-start="175.1" data-end="177.26">have to you have to deal with things at</span> <span data-start="177.26" data-end="180.799">a scale that really aren't being done at</span> <span data-start="180.799" data-end="182.75">very many other places around the well</span> <span data-start="182.75" data-end="188.959">around the country around the world so</span> <span data-start="188.959" data-end="190.459">what I'm going to talk about today is</span> <span data-start="190.459" data-end="191.989">like I said isn't really going to be</span> <span data-start="191.989" data-end="193.609">nuts and bolts details on how you deploy</span> <span data-start="193.609" data-end="195.59">thousands of nodes servers it's going to</span> <span data-start="195.59" data-end="198.47">be more about why I think facebook needs</span> <span data-start="198.47" data-end="202.13">node why we're not embracing it yet why</span> <span data-start="202.13" data-end="203.829">we're not that far along the curve and</span> <span data-start="203.829" data-end="206.09">what I and some of the other folks</span> <span data-start="206.09" data-end="207.5">within the company are doing to change</span> <span data-start="207.5" data-end="210.17">that and to what extent we're failing or</span> <span data-start="210.17" data-end="217.819">succeeding in that so why does why does</span> <span data-start="217.819" data-end="219.98">it company like Facebook need node I</span> <span data-start="219.98" data-end="222.049">mean one of the things that that we run</span> <span data-start="222.049" data-end="223.67">into or that I run into when I talk to</span> <span data-start="223.67" data-end="225.53">people within our company who aren't</span> <span data-start="225.53" data-end="229.069">note enthusiasts by nature is sort of</span> <span data-start="229.069" data-end="231.049">this well they're not impressed reaction</span> <span data-start="231.049" data-end="233.18">and a large part of that is I think that</span> <span data-start="233.18" data-end="234.92">the things that get JavaScript people</span> <span data-start="234.92" data-end="236.81">excited coming from sort of the client</span> </p>
<p><span data-start="236.81" data-end="237.88">JavaScript Amy</span> <span data-start="237.88" data-end="240.1">and having access to server side</span> <span data-start="240.1" data-end="241.99">JavaScript and you know in the form of</span> <span data-start="241.99" data-end="244.83">you know the single threaded event loop</span> <span data-start="244.83" data-end="247.15">just don't really turn them on there's</span> <span data-start="247.15" data-end="248.17">all these it there's all these</span> <span data-start="248.17" data-end="250.27">alternatives out there like lie bv live</span> <span data-start="250.27" data-end="253.9">event tornado event machine those</span> <span data-start="253.9" data-end="255.55">technical problems have been solved in</span> <span data-start="255.55" data-end="256.84">other languages you can solve them in</span> <span data-start="256.84" data-end="260.65">other languages and especially at</span> <span data-start="260.65" data-end="263.29">facebook where we already have you know</span> <span data-start="263.29" data-end="266.02">hundreds of millions of users and that</span> <span data-start="266.02" data-end="268.42">are being supported on servers by by</span> <span data-start="268.42" data-end="270.85">thousands of servers when you talk to</span> <span data-start="270.85" data-end="271.87">the people who put that there to put</span> <span data-start="271.87" data-end="274.6">that system in place it's really hard to</span> <span data-start="274.6" data-end="279.28">argue with success so there is a there</span> <span data-start="279.28" data-end="280.93">is a significant amount of I think well</span> <span data-start="280.93" data-end="284.47">justified resistance there so it does</span> <span data-start="284.47" data-end="286.99">beg this question of like well where is</span> <span data-start="286.99" data-end="289.06">the value to a really large company that</span> <span data-start="289.06" data-end="291.46">has established itself with technologies</span> <span data-start="291.46" data-end="296.11">that they're working and I guess the</span> <span data-start="296.11" data-end="297.07">answer to that I've actually been</span> <span data-start="297.07" data-end="298.45">thinking about this fair bit lately and</span> <span data-start="298.45" data-end="299.77">the answer that I guess I'll have to</span> <span data-start="299.77" data-end="302.47">sort of give you an anecdote from the</span> <span data-start="302.47" data-end="304.3">dark days of the internet when when I</span> <span data-start="304.3" data-end="307.57">first started doing JavaScript and this</span> <span data-start="307.57" data-end="310.77">was a small start-up I did back in</span> <span data-start="310.77" data-end="313.87">1999-2000 that was started by I and</span> <span data-start="313.87" data-end="317.56">three of my friends and of course one of</span> <span data-start="317.56" data-end="319.36">those was his CEO who's off doing CEO</span> <span data-start="319.36" data-end="322.69">things and the three of us were that</span> <span data-start="322.69" data-end="323.98">left three of us to do the end to be</span> <span data-start="323.98" data-end="325.24">through the engineering side of the</span> <span data-start="325.24" data-end="327.22">company and what we were doing was</span> <span data-start="327.22" data-end="330.34">building a well the goal the company was</span> <span data-start="330.34" data-end="332.8">to build microsoft office for the web so</span> </p>
<p><span data-start="332.8" data-end="336.28">Google Docs but done with JavaScript d</span> <span data-start="336.28" data-end="338.89">HTML and our first product was going to</span> <span data-start="338.89" data-end="340.87">be a productivity application</span> <span data-start="340.87" data-end="345.43">application so when we sat down the</span> <span data-start="345.43" data-end="346.42">three of us sort of looked at each other</span> <span data-start="346.42" data-end="347.56">and like well we know we're going to be</span> <span data-start="347.56" data-end="351.84">using javascript and HTML on the client</span> <span data-start="351.84" data-end="354.91">apache and java java servlets on the</span> <span data-start="354.91" data-end="357.31">middle layer and my suit my sequel in</span> <span data-start="357.31" data-end="359.65">SQL and a back-end and we had this</span> <span data-start="359.65" data-end="361.24">discussion of like okay well who's gonna</span> <span data-start="361.24" data-end="362.8">who's going to do what what are the</span> <span data-start="362.8" data-end="365.86">roles were going to assign and i ended</span> <span data-start="365.86" data-end="367.87">up drawing the short straw</span> <span data-start="367.87" data-end="372.94">found myself doing JavaScript so you</span> <span data-start="372.94" data-end="374.83">know that's what I ended up doing for</span> <span data-start="374.83" data-end="377.14">the next 12 years and sort of the irony</span> <span data-start="377.14" data-end="378.94">at the time was I never thought I was</span> <span data-start="378.94" data-end="380.29">going to put that on my resume because I</span> <span data-start="380.29" data-end="381.67">was sure this whole javascript thing was</span> <span data-start="381.67" data-end="385.36">just a passing fad so it fortunately</span> <span data-start="385.36" data-end="390.31">hasn't turned out that way the point of</span> <span data-start="390.31" data-end="393.28">this is that in that on that project and</span> <span data-start="393.28" data-end="394.96">pretty much every project I've been on</span> <span data-start="394.96" data-end="399.46">every web based application effort I've</span> <span data-start="399.46" data-end="401.29">under I've undergone has had this very</span> <span data-start="401.29" data-end="403.66">early conversation where engineers have</span> <span data-start="403.66" data-end="406.51">been cubby hold into one of those slots</span> <span data-start="406.51" data-end="408.88">are you a front-end engineer middle you</span> <span data-start="408.88" data-end="410.2">know middle where are you a back-end</span> <span data-start="410.2" data-end="416.02">database guy and um well that can be a</span> <span data-start="416.02" data-end="418.57">good thing I mean after all it does lead</span> <span data-start="418.57" data-end="419.83">to these conversations between people</span> <span data-start="419.83" data-end="423.19">that about well okay you've got you've</span> <span data-start="423.19" data-end="425.08">got Fred on the front end who needs</span> </p>
<p><span data-start="425.08" data-end="426.73">Maria doing who's doing the middleware</span> <span data-start="426.73" data-end="429.19">stuff to implement some point</span> <span data-start="429.19" data-end="431.83">functionality for and that enables this</span> <span data-start="431.83" data-end="433.18">conversation about well how should with</span> <span data-start="433.18" data-end="435.34">that what should that API look like to</span> <span data-start="435.34" data-end="438.91">what extent do do we need logic in that</span> <span data-start="438.91" data-end="442.54">middle layer versus on the client and it</span> <span data-start="442.54" data-end="444.04">creates these very well-thought-out</span> <span data-start="444.04" data-end="446.59">api's these very nice and modular and</span> <span data-start="446.59" data-end="449.5">structured interfaces at the end of the</span> <span data-start="449.5" data-end="451.48">day it really slows you down you have to</span> <span data-start="451.48" data-end="456.46">have this conversation and more</span> <span data-start="456.46" data-end="459.04">importantly it doesn't it doesn't allow</span> <span data-start="459.04" data-end="460.84">you to really distribute your resources</span> <span data-start="460.84" data-end="463.57">and one of the things that from that you</span> <span data-start="463.57" data-end="465.73">know from that company that really stuck</span> <span data-start="465.73" data-end="469.48">with me at the time was was a period</span> <span data-start="469.48" data-end="471.82">when we were actually in talks with AOL</span> <span data-start="471.82" data-end="475.21">to get acquired and they became to us on</span> <span data-start="475.21" data-end="477.37">a Monday and said hey you know we really</span> <span data-start="477.37" data-end="479.44">like this technology developed and this</span> <span data-start="479.44" data-end="481.06">team and you know you're selling us on</span> <span data-start="481.06" data-end="483.7">this whole stack of JavaScript d you</span> <span data-start="483.7" data-end="485.59">know really interactive applications but</span> <span data-start="485.59" data-end="487.93">we'd like you to prove that and what</span> <span data-start="487.93" data-end="489.37">we'd like you to do is build us a web</span> <span data-start="489.37" data-end="491.67">calendar a prototype because they had a</span> <span data-start="491.67" data-end="493.99">traditional static calendar application</span> <span data-start="493.99" data-end="496.24">and it was really for the slow and laggy</span> <span data-start="496.24" data-end="498.54">all these page turns</span> <span data-start="498.54" data-end="502.14">and so um they said yeah you know come</span> <span data-start="502.14" data-end="503.91">back a week from now and show us what</span> <span data-start="503.91" data-end="505.32">you've done with this you know give us a</span> <span data-start="505.32" data-end="507.6">prototype and of course our CEO being a</span> </p>
<p><span data-start="507.6" data-end="509.28">CEO immediately turned to us and said</span> <span data-start="509.28" data-end="511.11">hey I don't want to give them a</span> <span data-start="511.11" data-end="512.1">prototype I want to give them a</span> <span data-start="512.1" data-end="515.07">full-blown application and they're in</span> <span data-start="515.07" data-end="516.99">soo this conversation where we sort of</span> <span data-start="516.99" data-end="519.27">all turn to rob davis who was on our</span> <span data-start="519.27" data-end="520.95">back end and said hey what do we need to</span> <span data-start="520.95" data-end="523.05">do this and he said well give me a half</span> <span data-start="523.05" data-end="524.4">an hour and i'll implement the schema</span> <span data-start="524.4" data-end="525.93">you need for calendar events in our</span> <span data-start="525.93" data-end="527.97">database and so you know half an hour</span> <span data-start="527.97" data-end="530.88">later he came back and then we turn and</span> <span data-start="530.88" data-end="532.08">then we turn to Keith in the middle</span> <span data-start="532.08" data-end="533.19">layer and was like well what do we need</span> <span data-start="533.19" data-end="534.99">to transport this data back and forth</span> <span data-start="534.99" data-end="537.26">between the server in the front end and</span> <span data-start="537.26" data-end="539.4">keith is like well i really need to do</span> <span data-start="539.4" data-end="540.72">is whitelist the data types that were</span> <span data-start="540.72" data-end="543.24">sending and then they all looked at me</span> <span data-start="543.24" data-end="545.4">and like okay we need a calendar app and</span> <span data-start="545.4" data-end="547.47">you've got a week and i ended up</span> <span data-start="547.47" data-end="550.2">spending something like 120 hours over</span> <span data-start="550.2" data-end="551.67">the next week writing all this</span> <span data-start="551.67" data-end="553.98">javascript for a full-blown calendar</span> <span data-start="553.98" data-end="555.78">application it was incredibly rewarding</span> <span data-start="555.78" data-end="558.38">i mean it was an intense period of time</span> <span data-start="558.38" data-end="561.3">and it worked out really well AOL loved</span> <span data-start="561.3" data-end="563.19">it and my you know my wife went to take</span> <span data-start="563.19" data-end="565.32">me to dinner afterwards on the you know</span> <span data-start="565.32" data-end="566.94">after we'd given the presentation is</span> <span data-start="566.94" data-end="568.91">sort of a little celebratory thing and</span> <span data-start="568.91" data-end="571.44">about halfway through dinner i literally</span> <span data-start="571.44" data-end="574.44">just started shaking chills and you know</span> <span data-start="574.44" data-end="575.97">just completely exhausted and I was like</span> <span data-start="575.97" data-end="579.06">you know honey we gotta go home and the</span> <span data-start="579.06" data-end="580.71">reason I the reason why I'm going down</span> <span data-start="580.71" data-end="583.59">this path is that had we been using node</span> <span data-start="583.59" data-end="586.14">had we had JavaScript throughout our</span> <span data-start="586.14" data-end="588.27">whole technology stack instead of</span> <span data-start="588.27" data-end="590.07">everybody turning to me as the front end</span> <span data-start="590.07" data-end="591.78">guy and saying hey you've got to</span> <span data-start="591.78" data-end="593.04">implement this you're the only one</span> <span data-start="593.04" data-end="595.32">that's got this experience we could have</span> <span data-start="595.32" data-end="596.52">turned to the whole team and said hey</span> <span data-start="596.52" data-end="597.84">you know I know you guys have been doing</span> </p>
<p><span data-start="597.84" data-end="599.34">JavaScript in the middle layer and back</span> <span data-start="599.34" data-end="601.35">in but it's the same line which is the</span> <span data-start="601.35" data-end="603.51">same basic patterns and you can bring</span> <span data-start="603.51" data-end="605.04">all of that to the front you know to the</span> <span data-start="605.04" data-end="606.6">front-end development and really make</span> <span data-start="606.6" data-end="608.16">that work for us and instead of me doing</span> <span data-start="608.16" data-end="610.11">120 hours it would have been you know</span> <span data-start="610.11" data-end="611.4">three of us putting in a normal work</span> <span data-start="611.4" data-end="613.95">week um which would work that would have</span> <span data-start="613.95" data-end="615.12">worked out a lot better and probably</span> <span data-start="615.12" data-end="618.81">produced a better product in the end so</span> <span data-start="618.81" data-end="622.29">the point being for me the real value in</span> <span data-start="622.29" data-end="625.29">is not in not so much the technology</span> <span data-start="625.29" data-end="626.82">side of things but it's the</span> <span data-start="626.82" data-end="628.56">organizational and the cultural</span> <span data-start="628.56" data-end="630.69">differences in options that it enables</span> <span data-start="630.69" data-end="634.62">and I think that's often overlooked and</span> <span data-start="634.62" data-end="636.54">a small start-up you tend to get a lot</span> <span data-start="636.54" data-end="639.99">of cross discipline expertise anyways</span> <span data-start="639.99" data-end="641.55">but when you get into larger companies</span> <span data-start="641.55" data-end="644.61">like Facebook that's definitely less the</span> <span data-start="644.61" data-end="646.74">case and I think pretty much any project</span> <span data-start="646.74" data-end="648">that's got more than three people on it</span> <span data-start="648" data-end="650.16">has this degree of specialization to</span> <span data-start="650.16" data-end="657.69">some extent um so if there's this</span> <span data-start="657.69" data-end="660.36">benefit like why why isn't Facebook</span> <span data-start="660.36" data-end="662.88">going down this garden path you know why</span> <span data-start="662.88" data-end="664.319">aren't we why aren't we jumping all over</span> <span data-start="664.319" data-end="666.029">node and you know I think there's a lot</span> <span data-start="666.029" data-end="667.769">of reasons for that but the one that</span> <span data-start="667.769" data-end="671.16">really came to mind for me was basically</span> <span data-start="671.16" data-end="672.839">you know that that's saying about a</span> <span data-start="672.839" data-end="674.069">million monkeys at a million typewriters</span> <span data-start="674.069" data-end="676.529">eventually producing the collected works</span> <span data-start="676.529" data-end="681.3">of Shakespeare at Facebook we've got 600</span> <span data-start="681.3" data-end="685.56">million and not to say our users are</span> <span data-start="685.56" data-end="686.97">monkeys so please don't tweet that</span> <span data-start="686.97" data-end="688.589">because my boss is in the audience and</span> </p>
<p><span data-start="688.589" data-end="693.899">I'll get a call from HR but what we do</span> <span data-start="693.899" data-end="696.029">what we do have is just millions of</span> <span data-start="696.029" data-end="698.22">users that do all sorts of inexplicable</span> <span data-start="698.22" data-end="700.589">things and if you put a new technology</span> <span data-start="700.589" data-end="703.019">in production without thoroughly vetting</span> <span data-start="703.019" data-end="705.779">it they will discover every bug every</span> <span data-start="705.779" data-end="708.12">design flaw every performance weakness</span> <span data-start="708.12" data-end="711.48">that that technology has and the the</span> <span data-start="711.48" data-end="714.75">results of that are these guys they go</span> <span data-start="714.75" data-end="716.959">from being you know 600 million users to</span> <span data-start="716.959" data-end="720.93">these guys 600 million monkeys angry</span> <span data-start="720.93" data-end="723.24">monkeys and I have these all lined up</span> <span data-start="723.24" data-end="724.44">for a reason because they're organized</span> <span data-start="724.44" data-end="726.75">and you get things like the whole beacon</span> <span data-start="726.75" data-end="730.26">fiasco and you know all this this hubbub</span> <span data-start="730.26" data-end="732.209">over privacy issues not to dismiss that</span> <span data-start="732.209" data-end="735.42">because that's very important but it's</span> <span data-start="735.42" data-end="739.04">just no fun and so</span> <span data-start="739.04" data-end="741.57">that's where a lot of the the resistance</span> <span data-start="741.57" data-end="743.04">to note comes from in large</span> <span data-start="743.04" data-end="746.7">organizations but that's also very hand</span> <span data-start="746.7" data-end="749.46">wavy so let me go into a little bit more</span> <span data-start="749.46" data-end="753.86">detail on what that means at Facebook</span> <span data-start="753.86" data-end="757.2">performance is a top to your priority in</span> <span data-start="757.2" data-end="759.6">ways that are really surprising to me</span> </p>
<p><span data-start="759.6" data-end="760.53">I've actually only been at the company</span> <span data-start="760.53" data-end="763.32">since July which by the way it makes me</span> <span data-start="763.32" data-end="765.18">more senior than like forty four percent</span> <span data-start="765.18" data-end="770.46">of the company it's bizarre uh-huh so</span> <span data-start="770.46" data-end="771.81">one of the things that you find when you</span> <span data-start="771.81" data-end="775.11">join facebook is there is a an intense</span> <span data-start="775.11" data-end="777.84">focus on performance and cpu usage in</span> <span data-start="777.84" data-end="780.81">particular if if you can come in and you</span> <span data-start="780.81" data-end="783.21">can reduce average cpu usage on our web</span> <span data-start="783.21" data-end="786.03">to your machines by 1% you will be a</span> <span data-start="786.03" data-end="788.58">frickin rock star at the next</span> <span data-start="788.58" data-end="790.26">engineering All Hands our vp of</span> <span data-start="790.26" data-end="791.67">engineering will literally point you out</span> <span data-start="791.67" data-end="794.19">in the audience ask you to stand up put</span> <span data-start="794.19" data-end="795.99">your put your picture up on the screen</span> <span data-start="795.99" data-end="797.88">and say this person is saving us</span> <span data-start="797.88" data-end="801.95">millions of dollars it's that noteworthy</span> <span data-start="801.95" data-end="805.98">1% we've also developed our own</span> <span data-start="805.98" data-end="807.75">proprietary mama / re thats actually</span> <span data-start="807.75" data-end="809.82">open source web server called hip-hop</span> <span data-start="809.82" data-end="814.85">which is compiles PHP into native code</span> <span data-start="814.85" data-end="818.07">because of this issue similarly</span> <span data-start="818.07" data-end="820.38">reliability you know you need a system</span> <span data-start="820.38" data-end="822.39">that's gonna going to be bomb-proof day</span> <span data-start="822.39" data-end="824.73">in and day out or at least have well</span> <span data-start="824.73" data-end="828.39">understood failure characteristics and</span> <span data-start="828.39" data-end="830.58">both of these things i think the reality</span> <span data-start="830.58" data-end="832.77">with node is right now is that for a</span> <span data-start="832.77" data-end="834.83">company like Facebook or Google or Yahoo</span> <span data-start="834.83" data-end="837.12">there's really nobody up for us to look</span> <span data-start="837.12" data-end="838.86">around at and say oh those guys have</span> <span data-start="838.86" data-end="843.02">done it these issues are understood and</span> <span data-start="843.02" data-end="847.29">that's really scary and so the you know</span> <span data-start="847.29" data-end="850.23">this issue is it's certainly foremost in</span> <span data-start="850.23" data-end="851.94">the conversations I have with people and</span> <span data-start="851.94" data-end="854.16">then there's some other secondary issues</span> <span data-start="854.16" data-end="856.02">not related directly to the production</span> <span data-start="856.02" data-end="858.62">performance things like code inertia</span> </p>
<p><span data-start="858.62" data-end="861.62">Facebook has eight million lines of PHP</span> <span data-start="861.62" data-end="864.42">and that ruin that represents an</span> <span data-start="864.42" data-end="865.77">incredible investment of intellectual</span> <span data-start="865.77" data-end="869.22">capital and just as an aside we have</span> <span data-start="869.22" data-end="870.36">about three hundred thousand lines of</span> <span data-start="870.36" data-end="871.42">JavaScript</span> <span data-start="871.42" data-end="873.01">and the chat team has about twelve</span> <span data-start="873.01" data-end="874.78">thousand lines of airline that the chat</span> <span data-start="874.78" data-end="879.16">system runs so for people who care about</span> <span data-start="879.16" data-end="883.1">that sort of things that sort of thing</span> <span data-start="883.11" data-end="885.28">there's also things like deployment</span> <span data-start="885.28" data-end="888.37">processes and tools at a company like</span> <span data-start="888.37" data-end="890.29">Facebook where you have you know</span> <span data-start="890.29" data-end="891.97">thousands of web servers and production</span> <span data-start="891.97" data-end="893.62">rolling these things out is a</span> <span data-start="893.62" data-end="896.29">non-trivial task and you need a lot of</span> <span data-start="896.29" data-end="898.3">tools to help you do that and a lot of</span> <span data-start="898.3" data-end="899.86">people put a lot of effort into that and</span> <span data-start="899.86" data-end="903.27">of course any new technology makes that</span> <span data-start="903.27" data-end="905.65">sort of rocks the boat in that regard</span> <span data-start="905.65" data-end="909.55">and so your ops team your weekly push</span> <span data-start="909.55" data-end="911.08">team that's responsible for these things</span> <span data-start="911.08" data-end="912.01">they're going to look at you with a</span> <span data-start="912.01" data-end="915.37">really wary eye and then finally in we</span> <span data-start="915.37" data-end="917.05">have devtools so actually Facebook just</span> <span data-start="917.05" data-end="918.13">open source the product called</span> <span data-start="918.13" data-end="920.95">fabricator which is the internal tool be</span> <span data-start="920.95" data-end="923.11">used for browsing our source repository</span> <span data-start="923.11" data-end="927.25">and doing code reviews you may may want</span> <span data-start="927.25" data-end="928.33">to check that out it's actually pretty</span> <span data-start="928.33" data-end="930.49">cool I'm pretty impressed by how well</span> <span data-start="930.49" data-end="935.14">that works so I think that's sort of the</span> <span data-start="935.14" data-end="937.6">the litany of issues at the at the</span> <span data-start="937.6" data-end="939.31">cultural level that we run into when</span> <span data-start="939.31" data-end="941.53">talking about node with with people</span> <span data-start="941.53" data-end="946.18">inside the company so how do we get</span> <span data-start="946.18" data-end="947.98">across this chasm how do we actually get</span> <span data-start="947.98" data-end="950.23">people inside the company to embrace</span> <span data-start="950.23" data-end="952.48">this new technology that's got a lot of</span> <span data-start="952.48" data-end="953.59">sort of unknown performance</span> <span data-start="953.59" data-end="958.63">characteristics at Facebook scale so</span> <span data-start="958.63" data-end="960.82">what would I and the other folks are</span> <span data-start="960.82" data-end="962.86">within the company who are familiar with</span> <span data-start="962.86" data-end="964.96">node and enthusiastic about it are doing</span> <span data-start="964.96" data-end="966.58">is we started out with an internal</span> <span data-start="966.58" data-end="967.93">internal group which you know is</span> <span data-start="967.93" data-end="969.25">basically a mailing list there's nothing</span> <span data-start="969.25" data-end="972.97">to revolutionary about that and that</span> <span data-start="972.97" data-end="974.59">gives you some obvious benefits like it</span> <span data-start="974.59" data-end="976.6">allows you to coordinate the people who</span> <span data-start="976.6" data-end="978.13">are passionate about note all ready for</span> <span data-start="978.13" data-end="981.55">whatever reason we have about 60 people</span> <span data-start="981.55" data-end="982.9">in the group we share links to new</span> <span data-start="982.9" data-end="985.6">updates new modules various information</span> <span data-start="985.6" data-end="988.3">that that is pertinent to the sort of</span> <span data-start="988.3" data-end="993.52">things we're doing it also lets you</span> <span data-start="993.52" data-end="994.66">educate people who haven't heard about</span> <span data-start="994.66" data-end="997.12">note or just curious about it they have</span> <span data-start="997.12" data-end="998.77">a record of the discussion that's gone</span> <span data-start="998.77" data-end="1001.41">on before they found out about it gives</span> <span data-start="1001.41" data-end="1003.6">them a way to discover events so we</span> <span data-start="1003.6" data-end="1004.74">actually bring</span> <span data-start="1004.74" data-end="1006.33">people to talk about it we've had Ryan</span> <span data-start="1006.33" data-end="1008.88">and Matt Raney talk and that's been</span> <span data-start="1008.88" data-end="1010.649">really well received and I think it's</span> <span data-start="1010.649" data-end="1012.39">done a lot to really raise the awareness</span> <span data-start="1012.39" data-end="1015.93">and then the really surprising benefit</span> <span data-start="1015.93" data-end="1017.81">for me came in to lunch conversation</span> <span data-start="1017.81" data-end="1019.98">that I was having with some folks that</span> <span data-start="1019.98" data-end="1022.08">were in the node group and we were</span> <span data-start="1022.08" data-end="1023.73">talking about node and sort of how we</span> <span data-start="1023.73" data-end="1025.709">could get things you know moving inside</span> </p>
<p><span data-start="1025.709" data-end="1028.53">Facebook and a guy named Ben Mauer who's</span> <span data-start="1028.53" data-end="1032.579">the one of the founders of recaptcha the</span> <span data-start="1032.579" data-end="1033.839">captcha technology that you see around</span> <span data-start="1033.839" data-end="1037.35">the web alot kept pushing back and in</span> <span data-start="1037.35" data-end="1040.02">ways that i found kind of negative and</span> <span data-start="1040.02" data-end="1041.76">it was very disconcerting and i</span> <span data-start="1041.76" data-end="1042.99">eventually called him out on it i was</span> <span data-start="1042.99" data-end="1045.689">like dude why you know if you're this</span> <span data-start="1045.689" data-end="1047.459">down on node like why are you down on it</span> <span data-start="1047.459" data-end="1048.809">in the first place and further why are</span> <span data-start="1048.809" data-end="1052.71">you even in this group and his response</span> <span data-start="1052.71" data-end="1054.42">was essentially well I want to make sure</span> <span data-start="1054.42" data-end="1057">you guys don't do anything stupid and I</span> <span data-start="1057" data-end="1058.23">really don't think it's a good idea for</span> <span data-start="1058.23" data-end="1060">facebook to embree be embracing more</span> <span data-start="1060" data-end="1061.38">technologies and fat as a matter of fact</span> <span data-start="1061.38" data-end="1063.66">we should be using less and so he came</span> <span data-start="1063.66" data-end="1066.62">from the camp of simplicity being a</span> <span data-start="1066.62" data-end="1069.45">really important priority and a really</span> <span data-start="1069.45" data-end="1072.15">good way of minimizing the the overhead</span> <span data-start="1072.15" data-end="1073.98">involved in running all the systems that</span> </p>
<p><span data-start="1073.98" data-end="1076.95">Facebook runs and it took me a while to</span> <span data-start="1076.95" data-end="1078.24">come around to this point of view I</span> <span data-start="1078.24" data-end="1080.13">actually agree with him you know in</span> <span data-start="1080.13" data-end="1082.2">general you do want to have as few</span> <span data-start="1082.2" data-end="1084.29">technologies as possible at a company I</span> <span data-start="1084.29" data-end="1086.28">just happen to think node should be one</span> <span data-start="1086.28" data-end="1090.48">of those so um after thinking about this</span> <span data-start="1090.48" data-end="1092.04">for a while I realized that he's</span> <span data-start="1092.04" data-end="1093.39">actually doing an incredibly valuable</span> <span data-start="1093.39" data-end="1095.94">service for us and that he is keeping an</span> <span data-start="1095.94" data-end="1097.83">eye on us and making sure we don't screw</span> <span data-start="1097.83" data-end="1099.9">up pretty much early and really alien</span> <span data-start="1099.9" data-end="1101.79">alienate ourselves by doing something</span> <span data-start="1101.79" data-end="1104.22">that's going to permanently get people</span> <span data-start="1104.22" data-end="1108.12">resistant to the idea of node so you</span> <span data-start="1108.12" data-end="1109.62">know embrace your critics they're your</span> <span data-start="1109.62" data-end="1115.8">best friends and then in actual</span> <span data-start="1115.8" data-end="1117.27">practical terms in terms of what we're</span> <span data-start="1117.27" data-end="1120.12">doing with node we're trying to use it</span> <span data-start="1120.12" data-end="1121.98">everywhere we can that doesn't doesn't</span> <span data-start="1121.98" data-end="1124.41">put us in critical spots right now so</span> <span data-start="1124.41" data-end="1126.45">and ideally we're doing that in places</span> <span data-start="1126.45" data-end="1127.8">that allow us to touch the critical</span> <span data-start="1127.8" data-end="1129.33">systems so let me talk a little bit</span> <span data-start="1129.33" data-end="1133.22">about what that means in practical terms</span> <span data-start="1133.22" data-end="1136.14">this is sort of the menu of what we're</span> <span data-start="1136.14" data-end="1136.999">doing right now</span> <span data-start="1136.999" data-end="1138.709">and one of the advantages of having that</span> <span data-start="1138.709" data-end="1142.099">that node group is it lets us get a</span> <span data-start="1142.099" data-end="1143.449">pretty good idea of who's doing a lot</span> <span data-start="1143.449" data-end="1145.189">with a note inside Facebook and and so</span> <span data-start="1145.189" data-end="1148.189">here's the menu to start off with I</span> <span data-start="1148.189" data-end="1149.449">don't know how many people have heard of</span> <span data-start="1149.449" data-end="1150.979">j s game bench actually if you could</span> <span data-start="1150.979" data-end="1152.449">raise your hands like it knows what Jays</span> <span data-start="1152.449" data-end="1156.499">game inches okay so James game bench is</span> <span data-start="1156.499" data-end="1159.949">a JavaScript benchmarking suite for</span> <span data-start="1159.949" data-end="1162.619">html5 technologies related to game</span> <span data-start="1162.619" data-end="1164.599">development it's put together by a guy</span> <span data-start="1164.599" data-end="1168.799">named cauri and rekha and Bruce Adam do</span> <span data-start="1168.799" data-end="1173.019">you remember Bruce's a Bruce Rogers and</span> <span data-start="1173.019" data-end="1175.249">it's actually pretty cool because what</span> <span data-start="1175.249" data-end="1176.719">they're doing is bringing in much the</span> <span data-start="1176.719" data-end="1178.489">way like son by sunspider tests of</span> <span data-start="1178.489" data-end="1180.229">brought attention to javascript</span> <span data-start="1180.229" data-end="1182.029">performance they're bringing attention</span> <span data-start="1182.029" data-end="1186.709">to WebGL performance CSS animations and</span> <span data-start="1186.709" data-end="1188.689">various other technologies that game</span> <span data-start="1188.689" data-end="1191.659">developers are likely to use that's open</span> <span data-start="1191.659" data-end="1193.279">source and it comes with a node server</span> <span data-start="1193.279" data-end="1195.169">that you can use to run the tests and</span> <span data-start="1195.169" data-end="1198.019">the benchmarks we have a mobile</span> </p>
<p><span data-start="1198.019" data-end="1199.549">JavaScript framework under development</span> <span data-start="1199.549" data-end="1202.459">that will be announcing I don't actually</span> <span data-start="1202.459" data-end="1204.079">know one will be announcing it but the</span> <span data-start="1204.079" data-end="1207.709">intent is to open source that that uses</span> <span data-start="1207.709" data-end="1210.499">node for both a test server and also as</span> <span data-start="1210.499" data-end="1214.459">a build tool so in those cases I would</span> <span data-start="1214.459" data-end="1216.289">say there there's nothing too</span> <span data-start="1216.289" data-end="1217.669">extraordinary about those they are</span> <span data-start="1217.669" data-end="1220.579">fairly small projects the bulk of our</span> <span data-start="1220.579" data-end="1221.989">node work is actually being done on the</span> <span data-start="1221.989" data-end="1224.989">chat team and I think that's something</span> <span data-start="1224.989" data-end="1227.989">that it was really and it's something</span> <span data-start="1227.989" data-end="1229.369">that we sort of brought to the table as</span> <span data-start="1229.369" data-end="1232.129">mostly just because it gave us an</span> <span data-start="1232.129" data-end="1233.689">opportunity to explore the performance</span> <span data-start="1233.689" data-end="1237.949">characteristics of node so what we're</span> <span data-start="1237.949" data-end="1240.979">using it for is doing traffic analysis</span> <span data-start="1240.979" data-end="1244.099">of our production chat system so we</span> <span data-start="1244.099" data-end="1245.779">actually set up port replication and</span> <span data-start="1245.779" data-end="1248.959">we'll pull TCP traffic pull out a TCP</span> <span data-start="1248.959" data-end="1250.429">dump that over the course of an hour or</span> <span data-start="1250.429" data-end="1253.159">so and run that data through through</span> <span data-start="1253.159" data-end="1255.379">node and use the node pcap library to</span> <span data-start="1255.379" data-end="1259.369">analyze and get a get a performance or</span> <span data-start="1259.369" data-end="1261.469">rather a traffic profile of the HTTP and</span> <span data-start="1261.469" data-end="1263.869">thrift traffic and then we actually use</span> <span data-start="1263.869" data-end="1265.399">that and feed that information into our</span> <span data-start="1265.399" data-end="1267.36">load testing system that we use to</span> <span data-start="1267.36" data-end="1268.92">to actually test these production</span> <span data-start="1268.92" data-end="1273.27">systems and the cool thing about this is</span> <span data-start="1273.27" data-end="1275.37">that because we're using node alongside</span> <span data-start="1275.37" data-end="1277.86">this production data it actually gives</span> <span data-start="1277.86" data-end="1280.5">us a pretty good data point for how the</span> <span data-start="1280.5" data-end="1284.45">how node will perform in production and</span> <span data-start="1284.45" data-end="1286.559">unfortunately I don't really have hard</span> <span data-start="1286.559" data-end="1287.929">numbers i can give you folks because</span> <span data-start="1287.929" data-end="1290.01">we've been pretty heads down i'm just</span> <span data-start="1290.01" data-end="1291.72">trying to get this stuff working and i</span> <span data-start="1291.72" data-end="1294.15">don't know that we have a good enough</span> <span data-start="1294.15" data-end="1295.47">feel for what these performance</span> <span data-start="1295.47" data-end="1296.91">characteristics really are yet to go</span> <span data-start="1296.91" data-end="1298.74">public with those but that certainly</span> <span data-start="1298.74" data-end="1302.04">would be would be our intent I can I can</span> <span data-start="1302.04" data-end="1304.049">hand wave around things like for example</span> <span data-start="1304.049" data-end="1306.96">that that hours worth of traffic data we</span> <span data-start="1306.96" data-end="1308.37">run that through note in about ten</span> <span data-start="1308.37" data-end="1311.34">minutes a single node process so for</span> <span data-start="1311.34" data-end="1313.41">example we do know that if we put note</span> <span data-start="1313.41" data-end="1315.75">in production as a monitoring and</span> <span data-start="1315.75" data-end="1318.51">analysis system it we shouldn't have any</span> <span data-start="1318.51" data-end="1320.49">problem there performance wise it should</span> <span data-start="1320.49" data-end="1322.02">be able to handle handle the traffic we</span> <span data-start="1322.02" data-end="1325.26">throw at it as far as bandwidth and cpu</span> <span data-start="1325.26" data-end="1328.47">required there and then the last thing</span> <span data-start="1328.47" data-end="1329.76">that we're doing on that chat team and</span> <span data-start="1329.76" data-end="1331.65">this is more just my own efforts is</span> <span data-start="1331.65" data-end="1332.88">we're using it for what I call</span> <span data-start="1332.88" data-end="1336.09">production hacking so I've actually</span> <span data-start="1336.09" data-end="1338.309">found it to be really useful to set up a</span> <span data-start="1338.309" data-end="1340.89">node proxy server that alters the</span> <span data-start="1340.89" data-end="1342.63">behavior of our production system in a</span> <span data-start="1342.63" data-end="1344.22">way that I can still use the test with</span> <span data-start="1344.22" data-end="1346.38">the front end client so for example I</span> <span data-start="1346.38" data-end="1348.75">wanted to I'm in the process of adding</span> <span data-start="1348.75" data-end="1351.45">support for xhr and cores which require</span> <span data-start="1351.45" data-end="1354.48">various origin related headers in the</span> </p>
<p><span data-start="1354.48" data-end="1358.62">HTT HTT P packet and rather than going</span> <span data-start="1358.62" data-end="1360.179">in and mucking around in the airline</span> <span data-start="1360.179" data-end="1362.22">system and setting up my own tier of</span> <span data-start="1362.22" data-end="1364.559">back-end chat servers and then figure</span> <span data-start="1364.559" data-end="1365.7">out figure out how to reconfigure</span> <span data-start="1365.7" data-end="1367.2">everything so that my account the points</span> <span data-start="1367.2" data-end="1370.5">to that I instead just set up a you know</span> <span data-start="1370.5" data-end="1372.33">tell Firefox that point in my little</span> <span data-start="1372.33" data-end="1374.7">node proxy which I which I've set up to</span> <span data-start="1374.7" data-end="1376.26">actually modify those headers on the fly</span> <span data-start="1376.26" data-end="1377.73">in both directions and I can actually</span> <span data-start="1377.73" data-end="1380.549">add xhr core support to our production</span> <span data-start="1380.549" data-end="1384.33">system on my local box it's pretty cool</span> <span data-start="1384.33" data-end="1386.4">trick I highly recommend it I've done it</span> </p>
<p><span data-start="1386.4" data-end="1387.57">I've done stuff like that in a couple</span> <span data-start="1387.57" data-end="1390.45">cases and then the last thing we've done</span> <span data-start="1390.45" data-end="1393.299">is just enhance our internal tool chain</span> <span data-start="1393.299" data-end="1395.73">for deploying systems to actually</span> <span data-start="1395.73" data-end="1403.05">support node and NPM so um that's pretty</span> <span data-start="1403.05" data-end="1404.52">much the presentation there's a saying</span> <span data-start="1404.52" data-end="1408.33">at face book that we're one percent done</span> <span data-start="1408.33" data-end="1410.1">and you see little stickers all over the</span> <span data-start="1410.1" data-end="1411.69">place you know this chair is one percent</span> <span data-start="1411.69" data-end="1413.7">done this food is one percent done this</span> <span data-start="1413.7" data-end="1415.65">toilets one perfect one percent flushed</span> <span data-start="1415.65" data-end="1418.26">it's very cheesy but I actually think</span> <span data-start="1418.26" data-end="1421.59">it's what it gets a ton yet what are you</span> <span data-start="1421.59" data-end="1424.559">with that underlying with what that gets</span> <span data-start="1424.559" data-end="1426.6">at in the underlying statement is really</span> <span data-start="1426.6" data-end="1428.97">that it's a journey and in this case</span> <span data-start="1428.97" data-end="1431.16">we're not doing as much with notice i</span> <span data-start="1431.16" data-end="1433.26">think we'd like to be doing you know</span> <span data-start="1433.26" data-end="1435.33">we're one percent of the way but I'm</span> <span data-start="1435.33" data-end="1437.13">hopeful that in a year's time when we</span> <span data-start="1437.13" data-end="1440.22">come back that I'll have I'll have hard</span> <span data-start="1440.22" data-end="1442.05">data on what our performance is that</span> </p>
<p><span data-start="1442.05" data-end="1443.16">I'll be able to tell you guys yet</span> <span data-start="1443.16" data-end="1445.08">Facebook is running a thousand node</span> <span data-start="1445.08" data-end="1447.72">servers in production and it's saved us</span> <span data-start="1447.72" data-end="1450.66">this much CPU and you know and our</span> <span data-start="1450.66" data-end="1452.4">bandwidth our costs are down by X number</span> <span data-start="1452.4" data-end="1455.34">of dollars but I'll also still finish</span> <span data-start="1455.34" data-end="1457.26">with this slide that says we're one</span> <span data-start="1457.26" data-end="1458.79">percent done because I'm sure at that</span> <span data-start="1458.79" data-end="1461.94">time look the capabilities of node and</span> <span data-start="1461.94" data-end="1463.95">the landscape of the node community will</span> <span data-start="1463.95" data-end="1466.95">be that much larger so that's it if you</span> <span data-start="1466.95" data-end="1469.62">have any questions the question is what</span> <span data-start="1469.62" data-end="1475.06">are the airline guys think of node I</span> <span data-start="1475.07" data-end="1477.12">actually love it that's actually good</span> <span data-start="1477.12" data-end="1479.28">question because the short answer is</span> <span data-start="1479.28" data-end="1481.44">they actually like the airline system</span> <span data-start="1481.44" data-end="1484.23">they think it's it's perfectly capable</span> <span data-start="1484.23" data-end="1486.24">of handling the traffic of what we have</span> <span data-start="1486.24" data-end="1489.87">today and I'm inclined you know and it</span> <span data-start="1489.87" data-end="1493.679">seems to be working the flip side of</span> <span data-start="1493.679" data-end="1495.75">that is the airline guys that originally</span> <span data-start="1495.75" data-end="1498.29">wrote note I wrote the chat system are</span> <span data-start="1498.29" data-end="1500.549">pretty burned down on it and have gone</span> <span data-start="1500.549" data-end="1504.15">on to other projects and have left us in</span> <span data-start="1504.15" data-end="1506.25">some way you know I won't say this to</span> <span data-start="1506.25" data-end="1509.82">you know with too much resentment but</span> <span data-start="1509.82" data-end="1511.409">we've been kind of left holding the bag</span> <span data-start="1511.409" data-end="1513.6">and trying to find good airline</span> <span data-start="1513.6" data-end="1515.61">developers is a real challenge and I</span> <span data-start="1515.61" data-end="1517.23">think it gets back to it that point I</span> <span data-start="1517.23" data-end="1520.47">made about having us having a single</span> <span data-start="1520.47" data-end="1522.36">technology throughout your up and up and</span> <span data-start="1522.36" data-end="1523.8">down your staff actually gives you a lot</span> <span data-start="1523.8" data-end="1528">more options so um but yeah I mean</span> <span data-start="1528" data-end="1529.38">there's it's really interesting</span> <span data-start="1529.38" data-end="1531.179">conversation to get into the details of</span> <span data-start="1531.179" data-end="1535.83">how airline and no to compare anything</span> </p>
</section>