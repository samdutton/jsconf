<section>
<p><span data-start="12.91" data-end="16.55">thank you so can everyone hear me we're</span> <span data-start="16.55" data-end="18.74">good they gave me a laser pointer which</span> <span data-start="18.74" data-end="21.32">is a terrible idea but I can't point</span> <span data-start="21.32" data-end="23.33">that high otherwise so I've tweeted a</span> <span data-start="23.33" data-end="25.369">link to the slides my Twitter handrails</span> <span data-start="25.369" data-end="27.439">Calla had if you want to follow along if</span> <span data-start="27.439" data-end="28.43">you want to experiment instead of</span> <span data-start="28.43" data-end="30.29">listening to me feel free to go there</span> <span data-start="30.29" data-end="32.15">there's all sorts of information other</span> <span data-start="32.15" data-end="35.84">demos to look at other resources check</span> <span data-start="35.84" data-end="39.65">that out spoiler alright so I'm not</span> <span data-start="39.65" data-end="41">talked about the new mobile web because</span> <span data-start="41" data-end="43.07">we tried that once we tried an old</span> <span data-start="43.07" data-end="45.8">mobile web we had whap we had wml who</span> <span data-start="45.8" data-end="47.57">here remembers like Nokia feature phones</span> <span data-start="47.57" data-end="51.08">with wet ok hey I guess you come close</span> <span data-start="51.08" data-end="54.41">to to where Nokia is from and you get</span> <span data-start="54.41" data-end="57.91">people who remember that that's great um</span> <span data-start="57.91" data-end="60.65">the the power of the web and the reason</span> <span data-start="60.65" data-end="62.06">whap failed and the reason the iphone</span> <span data-start="62.06" data-end="63.23">and things like that I've succeeded is</span> <span data-start="63.23" data-end="65.96">that the web is one platform there's</span> <span data-start="65.96" data-end="68.869">only one web it's open its universal</span> <span data-start="68.869" data-end="71.689">it's decentralized the same web is on my</span> <span data-start="71.689" data-end="75.05">phone that is on my laptop there's no</span> <span data-start="75.05" data-end="77.57">single gatekeeper there's no web store</span> <span data-start="77.57" data-end="79.25">that I have to go to and convince</span> <span data-start="79.25" data-end="81.38">someone to let me publish on the web</span> <span data-start="81.38" data-end="83.659">there are many new domain providers mini</span> <span data-start="83.659" data-end="86.09">hosting providers have many options and</span> <span data-start="86.09" data-end="87.5">this is the power of the web as a medium</span> <span data-start="87.5" data-end="90.17">it's a very very low barrier to entry</span> <span data-start="90.17" data-end="92.87">very low friction Democratic medium and</span> </p>
<p><span data-start="92.87" data-end="96.8">I think that's important so I work for</span> <span data-start="96.8" data-end="99.01">Mozilla and Mozilla works for the web</span> <span data-start="99.01" data-end="101.69">Mozilla's a nonprofit that in its</span> <span data-start="101.69" data-end="103.37">manifesto states that the Internet is a</span> <span data-start="103.37" data-end="106.22">global public resource that must remain</span> <span data-start="106.22" data-end="108.979">open and accessible and a key to that is</span> <span data-start="108.979" data-end="110.62">ensuring that there's a balance between</span> <span data-start="110.62" data-end="113.81">private interest on the web and public</span> <span data-start="113.81" data-end="116.72">interest on the web the way that we work</span> <span data-start="116.72" data-end="119.33">to ensure that balance is about building</span> <span data-start="119.33" data-end="122.06">firefox firefox is a completely free</span> <span data-start="122.06" data-end="124.04">open-source web browser you can hack on</span> <span data-start="124.04" data-end="125.84">the code we're rewriting our dev tools</span> <span data-start="125.84" data-end="127.729">and react so if you know react you can</span> <span data-start="127.729" data-end="130.129">make a huge contribution come talk to me</span> <span data-start="130.129" data-end="131.15">later if you want to learn how to get</span> <span data-start="131.15" data-end="133.73">involved but we build Firefox so that</span> <span data-start="133.73" data-end="135.79">when the world's largest corporations</span> <span data-start="135.79" data-end="139.31">meet to determine what is going into the</span> <span data-start="139.31" data-end="140.78">web platform what the web is going to</span> <span data-start="140.78" data-end="143.06">look like that we have earned a place at</span> <span data-start="143.06" data-end="144.35">that table as a pea</span> <span data-start="144.35" data-end="146.06">and as a fellow implementer of the web</span> <span data-start="146.06" data-end="149.42">and that we can influence that we can</span> <span data-start="149.42" data-end="152.06">speak for the public good as someone</span> <span data-start="152.06" data-end="153.97">that doesn't have a profit motive I</span> <span data-start="153.97" data-end="155.84">think that's really important i think</span> <span data-start="155.84" data-end="157.52">the web is is a global resource it's a</span> <span data-start="157.52" data-end="159.38">public resource it needs to be preserved</span> <span data-start="159.38" data-end="161.09">feel free to talk to me about that</span> <span data-start="161.09" data-end="163.85">afterwards so part of the power of the</span> <span data-start="163.85" data-end="165.95">web is its ubiquity this is the internet</span> <span data-start="165.95" data-end="167.27">of twitter account talking about</span> <span data-start="167.27" data-end="170.03">all the failures in the iot field and</span> <span data-start="170.03" data-end="172.37">it's being displayed on a samsung smart</span> <span data-start="172.37" data-end="176.75">fridge in a showroom at a home appliance</span> <span data-start="176.75" data-end="179.93">store the power of this is that that's</span> <span data-start="179.93" data-end="183.4">mobile.twitter.com on that smart fridge</span> <span data-start="183.4" data-end="185.57">samsung didn't have to go out to twitter</span> <span data-start="185.57" data-end="187.49">and say hey will you please implement</span> <span data-start="187.49" data-end="191.75">twitter for fridge OS 10 and then they</span> <span data-start="191.75" data-end="193.49">didn't have another company say LG or</span> <span data-start="193.49" data-end="194.63">someone else coming and say ah but we</span> <span data-start="194.63" data-end="196.22">have a better fridge OS can you</span> <span data-start="196.22" data-end="197.24">implement for hours no they just</span> <span data-start="197.24" data-end="199.7">implement the web and they have access</span> <span data-start="199.7" data-end="201.32">to all the contents of the web has and</span> <span data-start="201.32" data-end="203.5">so the web has this this ability to</span> <span data-start="203.5" data-end="206.36">shape itself into new forms that we</span> <span data-start="206.36" data-end="208.55">hadn't imagined yet but all that content</span> <span data-start="208.55" data-end="212.09">is there it's hugely powerful if you</span> <span data-start="212.09" data-end="213.23">look closely there a couple things you</span> <span data-start="213.23" data-end="216.83">can you can learn about this this fridge</span> <span data-start="216.83" data-end="220.7">for one it's not using it's using the</span> </p>
<p><span data-start="220.7" data-end="222.08">Samsung built-in browser it's not using</span> <span data-start="222.08" data-end="224.9">Chrome or Firefox that's custom UI if</span> <span data-start="224.9" data-end="225.98">you scroll down further you can actually</span> <span data-start="225.98" data-end="228.29">see it's running Android but you also</span> <span data-start="228.29" data-end="231.2">know that it has a web connection inside</span> <span data-start="231.2" data-end="232.97">the showroom floor which means if you</span> <span data-start="232.97" data-end="234.47">buy the floor model depth of that fridge</span> <span data-start="234.47" data-end="236.9">you probably get access to home depot or</span> <span data-start="236.9" data-end="239.57">Sears Wi-Fi network so that's a pretty</span> <span data-start="239.57" data-end="242">good deal and we know that because if it</span> <span data-start="242" data-end="243.47">didn't have a web connection and we</span> <span data-start="243.47" data-end="245.24">tried to load mobile.twitter.com we'd</span> <span data-start="245.24" data-end="247.34">see something like this the connection</span> <span data-start="247.34" data-end="251.75">appears to be offline try again so the</span> <span data-start="251.75" data-end="253.28">web is ubiquitous but the web isn't</span> <span data-start="253.28" data-end="256.22">resilient the Twitter app will never do</span> <span data-start="256.22" data-end="257.69">this you never open twitter on your foam</span> <span data-start="257.69" data-end="260.45">and you're on a train or on a flight and</span> <span data-start="260.45" data-end="262.76">say oh I'm sorry just twitter isn't</span> <span data-start="262.76" data-end="264.56">available right now no you see what data</span> <span data-start="264.56" data-end="265.94">it had the last time it was available</span> <span data-start="265.94" data-end="268.64">and you can still compose tweets it'll</span> <span data-start="268.64" data-end="270.62">just say hey I can't send this until I'm</span> <span data-start="270.62" data-end="271.97">back online or I can't retrieve new</span> <span data-start="271.97" data-end="274.49">tweets until I'm back online so apps</span> <span data-start="274.49" data-end="276.94">have had this this user experience and</span> <span data-start="276.94" data-end="278.39">reliability</span> <span data-start="278.39" data-end="281.99">win over the web this talk is going to</span> <span data-start="281.99" data-end="285.11">talk about how to fix that before we go</span> <span data-start="285.11" data-end="286.55">on I'm going to be showing a fair amount</span> <span data-start="286.55" data-end="289.06">of code that uses some es6 features in</span> <span data-start="289.06" data-end="291.8">particular arrow functions you can think</span> <span data-start="291.8" data-end="293.69">of them as just a shorthand if you look</span> <span data-start="293.69" data-end="296.15">for that fat arrow there on the left</span> <span data-start="296.15" data-end="299.21">hand side are the parameters on the</span> <span data-start="299.21" data-end="301.04">right hand side is the return value so</span> <span data-start="301.04" data-end="303.11">these two lines are equivalent take X</span> <span data-start="303.11" data-end="306.35">return x times two there are some</span> <span data-start="306.35" data-end="307.88">nuances about how error functions are</span> <span data-start="307.88" data-end="309.83">different from normal functions but this</span> <span data-start="309.83" data-end="311.51">is a j/s conference you can ask anyone</span> <span data-start="311.51" data-end="314.29">else at your table and someone will know</span> <span data-start="314.29" data-end="316.22">the second thing you're going to see a</span> <span data-start="316.22" data-end="318.08">lot of our promises the signifier of</span> <span data-start="318.08" data-end="320.62">promises are this dot then method</span> <span data-start="320.62" data-end="324.23">promises are an official es6 codified</span> <span data-start="324.23" data-end="326.03">way of handling a synchronicity in</span> </p>
<p><span data-start="326.03" data-end="328.01">JavaScript we used to have to nest call</span> <span data-start="328.01" data-end="329.42">back inside call back inside call back</span> <span data-start="329.42" data-end="331.85">inside callback which worked but admit</span> <span data-start="331.85" data-end="333.94">that the order of execution of our code</span> <span data-start="333.94" data-end="336.86">wasn't a syntactic thing it wasn't this</span> <span data-start="336.86" data-end="338.12">statement than this statement this since</span> <span data-start="338.12" data-end="340.58">then this statement it was a side effect</span> <span data-start="340.58" data-end="343.4">of the nesting of our code makes a code</span> <span data-start="343.4" data-end="345.08">harder to reason about makes things</span> <span data-start="345.08" data-end="347.24">harder air is hard to deal with promises</span> <span data-start="347.24" data-end="349.7">let you just say do this dot then</span> <span data-start="349.7" data-end="351.41">whenever that finishes call this</span> <span data-start="351.41" data-end="354.02">callback then call this callback and if</span> <span data-start="354.02" data-end="355.88">any of them fail pass the error to this</span> <span data-start="355.88" data-end="358.85">handler you'll see this a lot fetch also</span> <span data-start="358.85" data-end="360.71">if you haven't seen it promisee</span> <span data-start="360.71" data-end="363.83">replacement for xml httprequest that's</span> <span data-start="363.83" data-end="365.96">valid syntax you say fetched you give it</span> <span data-start="365.96" data-end="368.12">a URL you can optionally pass like</span> <span data-start="368.12" data-end="371.72">method post I cannot I'm a professional</span> <span data-start="371.72" data-end="373.79">software developer I cannot write an xhr</span> <span data-start="373.79" data-end="376.28">request by hand thus intact can anyone</span> <span data-start="376.28" data-end="377.57">in the room do you remember the syntax</span> <span data-start="377.57" data-end="379.76">well enough all right you turn to</span> <span data-start="379.76" data-end="382.96">someone at your table improve it</span> <span data-start="382.97" data-end="385.35">fetch on the other game fetch data you</span> <span data-start="385.35" data-end="386.31">get a promise back the promise</span> <span data-start="386.31" data-end="388.74">eventually returns the data promises are</span> <span data-start="388.74" data-end="390.24">everywhere now that we have a way to</span> <span data-start="390.24" data-end="392.64">handle a synchronicity you'll see them</span> <span data-start="392.64" data-end="393.78">coming up in standards like fetch</span> <span data-start="393.78" data-end="396.24">service workers push background sync the</span> <span data-start="396.24" data-end="398.91">new es 2017 a sink and wait keywords are</span> <span data-start="398.91" data-end="401.25">just syntactic sugar around promises so</span> <span data-start="401.25" data-end="402.78">you'll have to understand how these work</span> </p>
<p><span data-start="402.78" data-end="405.24">I really recommend investing the time to</span> <span data-start="405.24" data-end="406.83">to go through some blog articles go</span> <span data-start="406.83" data-end="408.45">through some experiments figure these</span> <span data-start="408.45" data-end="411.87">things out so back on track reliability</span> <span data-start="411.87" data-end="414.51">how does service workers help us solve</span> <span data-start="414.51" data-end="418.13">reliability what's the service worker</span> <span data-start="418.13" data-end="420.39">showing hands who here knows what a</span> <span data-start="420.39" data-end="424.8">service worker is all right who here has</span> <span data-start="424.8" data-end="428.49">used them in production oh okay so maybe</span> <span data-start="428.49" data-end="430.05">if you can write an xhr by handed UV</span> <span data-start="430.05" data-end="431.97">service workers in production I believe</span> <span data-start="431.97" data-end="434.91">you on both of those counts there are</span> <span data-start="434.91" data-end="437.19">people doing this it's it's available</span> <span data-start="437.19" data-end="439.23">it's in the release versions of Firefox</span> <span data-start="439.23" data-end="442.56">and Chrome and opera basically service</span> <span data-start="442.56" data-end="445.38">workers are like script tags but for a</span> <span data-start="445.38" data-end="446.49">whole domain instead of for an</span> <span data-start="446.49" data-end="448.53">individual page so when you open a new</span> <span data-start="448.53" data-end="450.18">tab the scripts on the page run you</span> <span data-start="450.18" data-end="452.16">close the tab the scripts die service</span> <span data-start="452.16" data-end="454.5">workers aren't quite like that service</span> <span data-start="454.5" data-end="456.75">workers could be running without any</span> <span data-start="456.75" data-end="458.43">tabs open at all or you could have 10</span> <span data-start="458.43" data-end="460.41">tabs open all sharing the same service</span> <span data-start="460.41" data-end="465.18">worker so it's a way to start providing</span> <span data-start="465.18" data-end="467.13">an alternative to the page model of the</span> <span data-start="467.13" data-end="469.26">web not a replacement for an alternative</span> <span data-start="469.26" data-end="470.34">because there are some things in the</span> <span data-start="470.34" data-end="472.97">page model just doesn't work for of</span> <span data-start="472.97" data-end="474.87">course service workers are going to have</span> <span data-start="474.87" data-end="476.49">some some superpowers if they can run</span> <span data-start="476.49" data-end="478.77">without any tabs open and if they're</span> <span data-start="478.77" data-end="479.73">going to be able to do things like</span> <span data-start="479.73" data-end="482.07">making the web work offline so like any</span> <span data-start="482.07" data-end="484.08">other powerful API service workers</span> <span data-start="484.08" data-end="485.88">require a secure connection you have to</span> <span data-start="485.88" data-end="489.84">have a TLS certificate show hands let's</span> <span data-start="489.84" data-end="492.57">encrypt if people heard of used it okay</span> <span data-start="492.57" data-end="493.83">for those of you I haven't let's encrypt</span> <span data-start="493.83" data-end="495">as a joint venture between the</span> </p>
<p><span data-start="495" data-end="496.26">Electronic Frontier Foundation and</span> <span data-start="496.26" data-end="499.34">Mozilla to provide free TLS certificates</span> <span data-start="499.34" data-end="502.59">that are trusted by every browser that</span> <span data-start="502.59" data-end="504.24">are usable for anything private use</span> <span data-start="504.24" data-end="506.31">personal use corporate use for profit</span> <span data-start="506.31" data-end="509.34">whatever security should it shouldn't be</span> <span data-start="509.34" data-end="510.99">a choice between security and your</span> <span data-start="510.99" data-end="513.839">wallet so that's super great this tip if</span> <span data-start="513.839" data-end="515.19">you remember nothing else is worth at</span> <span data-start="515.19" data-end="515.79">least</span> <span data-start="515.79" data-end="518.46">two thousand kronor which to put it in</span> <span data-start="518.46" data-end="520.41">even further local terms is about for</span> <span data-start="520.41" data-end="524.37">pizza and a coke so so you could either</span> <span data-start="524.37" data-end="525.9">have a certificate or you could have a</span> <span data-start="525.9" data-end="529.17">certificate and some pizza I know what I</span> <span data-start="529.17" data-end="533.07">choose so how do these work you use a</span> <span data-start="533.07" data-end="534.84">script tag to do can I have per page</span> </p>
<p><span data-start="534.84" data-end="536.61">JavaScript for a service worker you have</span> <span data-start="536.61" data-end="539.46">to install the service worker file using</span> <span data-start="539.46" data-end="542.67">javascript so somewhere in a script tag</span> <span data-start="542.67" data-end="544.41">you check for support so you do feature</span> <span data-start="544.41" data-end="545.79">detection if service worker and</span> <span data-start="545.79" data-end="548.19">navigator then navigate our service</span> <span data-start="548.19" data-end="549.84">worker register and you pass it the</span> <span data-start="549.84" data-end="551.22">script to your JavaScript or the path to</span> <span data-start="551.22" data-end="553.8">your javascript file you can also set</span> <span data-start="553.8" data-end="555.63">the scope of the service worker by</span> <span data-start="555.63" data-end="557.46">default it would just be the folder that</span> <span data-start="557.46" data-end="559.62">the worker itself is N and this kind of</span> <span data-start="559.62" data-end="562.14">says what what page is my URL bar say</span> <span data-start="562.14" data-end="564.51">and what service worker gets to control</span> <span data-start="564.51" data-end="566.76">that page so by setting the scope to the</span> <span data-start="566.76" data-end="568.86">root any page on my domain could</span> <span data-start="568.86" data-end="569.94">potentially be controlled by this</span> <span data-start="569.94" data-end="572.76">service worker you can have multiple</span> <span data-start="572.76" data-end="574.53">service workers for your domain only one</span> <span data-start="574.53" data-end="576.03">will work at a time and the most</span> <span data-start="576.03" data-end="580.48">specific one is the one that's selected</span> <span data-start="580.49" data-end="582.51">one of the most immediate things you</span> <span data-start="582.51" data-end="584.64">might want to do is preload a cache we</span> <span data-start="584.64" data-end="585.84">want to make the web work offline there</span> <span data-start="585.84" data-end="587.07">are things you're going to want to have</span> <span data-start="587.07" data-end="588.06">available you're going to want your</span> <span data-start="588.06" data-end="589.11">stylesheet you're going to want your</span> <span data-start="589.11" data-end="592.41">basic a pelagic a service worker because</span> <span data-start="592.41" data-end="594.72">it's running in a separate thread it's</span> <span data-start="594.72" data-end="597.33">running independent of tabs every API</span> <span data-start="597.33" data-end="601.05">uses is event-based an asynchronous so</span> <span data-start="601.05" data-end="602.88">when we do this install step the</span> <span data-start="602.88" data-end="605.34">serviceworker file we downloaded saved</span> <span data-start="605.34" data-end="606.84">in the browser and it'll start running</span> <span data-start="606.84" data-end="608.97">the browser will then give it an install</span> <span data-start="608.97" data-end="610.59">event so we can add an event listener</span> <span data-start="610.59" data-end="613.17">for install and say alright don't</span> <span data-start="613.17" data-end="615.2">resolve this init like wait until we</span> <span data-start="615.2" data-end="618.36">open a cache and then add all these URLs</span> <span data-start="618.36" data-end="621.9">to the cash the caches API you say</span> <span data-start="621.9" data-end="624.03">caches that open and give it a name of a</span> <span data-start="624.03" data-end="625.59">cash if it doesn't exist it gets created</span> <span data-start="625.59" data-end="629.43">and then you get a cash reference to</span> <span data-start="629.43" data-end="632.07">that opened cash and you can do things</span> <span data-start="632.07" data-end="634.77">like add requests go and synthesize</span> <span data-start="634.77" data-end="637.77">requests delete things you can inspect</span> <span data-start="637.77" data-end="639.75">the whole cache the only things that</span> <span data-start="639.75" data-end="641.1">ever appear in this cache are things</span> <span data-start="641.1" data-end="643.41">that you put there it's subject to a</span> <span data-start="643.41" data-end="644.82">normal browser quotas like you would see</span> <span data-start="644.82" data-end="646.74">for index TV or other things if the</span> <span data-start="646.74" data-end="648.33">browser ever needs more space it'll stop</span> <span data-start="648.33" data-end="649.059">it will start</span> <span data-start="649.059" data-end="650.769">dropping from the least recently used</span> <span data-start="650.769" data-end="653.379">cash entire caches at once so you'll</span> <span data-start="653.379" data-end="655.029">never have a situation where like half</span> <span data-start="655.029" data-end="656.619">of your cash is missing either</span> <span data-start="656.619" data-end="658.179">everything you put in there is there or</span> <span data-start="658.179" data-end="661.599">nothing is there so I say all right on</span> <span data-start="661.599" data-end="663.159">the install event go and cash these</span> <span data-start="663.159" data-end="664.539">things for us they can be on other</span> <span data-start="664.539" data-end="665.889">domains they could be other resources</span> <span data-start="665.889" data-end="668.889">but we can say we want these files in</span> <span data-start="668.889" data-end="670.959">the cache and then the service worker</span> <span data-start="670.959" data-end="673.569">and this oh it's actually may be legible</span> <span data-start="673.569" data-end="675.969">a screen is huge if you're looking at</span> <span data-start="675.969" data-end="677.469">the slides yourself this is much more</span> <span data-start="677.469" data-end="678.789">legible but more important thing is just</span> <span data-start="678.789" data-end="684.489">these these graphics the serviceworker</span> <span data-start="684.489" data-end="687.399">can act as a proxy inside the users</span> <span data-start="687.399" data-end="690.279">browser that can intercept and modify</span> <span data-start="690.279" data-end="692.469">requests it can intercept and modify</span> <span data-start="692.469" data-end="694.749">responses so when a page goes and</span> <span data-start="694.749" data-end="696.239">request something like a style sheet</span> <span data-start="696.239" data-end="698.079">instead of going directly to the</span> </p>
<p><span data-start="698.079" data-end="700.239">Internet first a fetch event will happen</span> <span data-start="700.239" data-end="704.349">inside the serviceworker the</span> <span data-start="704.349" data-end="705.369">serviceworker could say all right well I</span> <span data-start="705.369" data-end="706.659">have that my cash I can respond from the</span> <span data-start="706.659" data-end="707.649">cache and that request will never</span> <span data-start="707.649" data-end="711.489">actually hit the network and it codes</span> <span data-start="711.489" data-end="712.779">pretty straightforward you can say all</span> <span data-start="712.779" data-end="713.829">right add an event listener for fetch</span> <span data-start="713.829" data-end="717.159">and then event respond with caches match</span> <span data-start="717.159" data-end="719.439">so caches match will search every cash</span> <span data-start="719.439" data-end="722.829">in that domain look for that events</span> <span data-start="722.829" data-end="725.199">request so that request object has the</span> </p>
<p><span data-start="725.199" data-end="728.979">URL the mode the method the headers and</span> <span data-start="728.979" data-end="731.409">then if we get a response back if the</span> <span data-start="731.409" data-end="733.379">response is truth if we had a cache hit</span> <span data-start="733.379" data-end="737.019">return from the cash otherwise go and</span> <span data-start="737.019" data-end="738.939">fetch out to the network just resend</span> <span data-start="738.939" data-end="742.539">that request it looks a little bit like</span> <span data-start="742.539" data-end="746.409">this started a page page once a file it</span> <span data-start="746.409" data-end="747.609">goes to the serviceworker service worker</span> <span data-start="747.609" data-end="750.009">says wait I'm going to check my cash if</span> <span data-start="750.009" data-end="751.629">that fails I'll go to the network and</span> <span data-start="751.629" data-end="755.079">I'll return that to the browser you can</span> <span data-start="755.079" data-end="756.549">also flip this and say actually I want</span> <span data-start="756.549" data-end="758.169">to try to go to the network first but if</span> <span data-start="758.169" data-end="760.359">that fails show the cash version so you</span> <span data-start="760.359" data-end="761.919">you're preferring the up-to-date version</span> <span data-start="761.919" data-end="765.669">and falling back to the cash you could</span> <span data-start="765.669" data-end="768.189">even build a hybrid that says I want to</span> <span data-start="768.189" data-end="770.109">try I want to immediately return the</span> <span data-start="770.109" data-end="773.169">cash version but in parallel I want to</span> <span data-start="773.169" data-end="774.249">go to the network and get an updated</span> <span data-start="774.249" data-end="778.4">version for the next time</span> <span data-start="778.41" data-end="780.72">as an example I've got a video here of</span> <span data-start="780.72" data-end="782.19">something happening on phone but there's</span> <span data-start="782.19" data-end="783.66">only one web so we're going to do it on</span> <span data-start="783.66" data-end="786.47">my desktop my normal browser instead</span> <span data-start="786.47" data-end="789.269">this is pokedex org which I previously</span> <span data-start="789.269" data-end="791.04">didn't understand anything about but</span> <span data-start="791.04" data-end="793.529">then Pokemon go happened and I can tell</span> <span data-start="793.529" data-end="796.86">you all about it so no one loss in the</span> <span data-start="796.86" data-end="798.48">author of pouch DB you wrote this as a</span> <span data-start="798.48" data-end="800.069">demo to show all sorts of techniques for</span> <span data-start="800.069" data-end="803.37">making sites work well offline one of</span> <span data-start="803.37" data-end="805.62">the things you'll notice is that in the</span> <span data-start="805.62" data-end="807.3">inspector all of the style sheets using</span> </p>
<p><span data-start="807.3" data-end="810.18">CSS spriting but it's just a normal link</span> <span data-start="810.18" data-end="812.16">rel stylesheet tag and it's a normal</span> <span data-start="812.16" data-end="816.87">script source j s main DJ s from the</span> <span data-start="816.87" data-end="820.68">perspective of this website it has no</span> <span data-start="820.68" data-end="821.85">idea that there's going to be a</span> <span data-start="821.85" data-end="823.259">serviceworker between it and the</span> <span data-start="823.259" data-end="824.819">internet it has no idea it's behind a</span> <span data-start="824.819" data-end="831.389">proxy but if i turn my Wi-Fi off what's</span> <span data-start="831.389" data-end="834">the network tab that's you know this</span> <span data-start="834" data-end="835.529">isn't surprising javascript can do this</span> <span data-start="835.529" data-end="841.589">but what if i refresh the page but still</span> <span data-start="841.589" data-end="843.72">worked if you look over the transferred</span> <span data-start="843.72" data-end="844.949">we can see that this is coming from a</span> <span data-start="844.949" data-end="846.269">serviceworker instead of the network and</span> <span data-start="846.269" data-end="847.699">we can actually go into any of these and</span> <span data-start="847.699" data-end="851.819">see the response headers we can see the</span> <span data-start="851.819" data-end="853.709">actual response this looks to the</span> <span data-start="853.709" data-end="855.63">browser just like a normal network</span> <span data-start="855.63" data-end="857.73">requests all the headers are there the</span> <span data-start="857.73" data-end="860.04">body is there it went out and just</span> <span data-start="860.04" data-end="861.36">instead of making it all the way to the</span> <span data-start="861.36" data-end="862.62">internet before it realized it didn't</span> <span data-start="862.62" data-end="864.06">have a network connection the</span> <span data-start="864.06" data-end="865.62">serviceworker stuff didn't said wait I</span> <span data-start="865.62" data-end="867.75">have that my cash I'm going to return</span> <span data-start="867.75" data-end="870.66">that in Firefox you can also go into the</span> <span data-start="870.66" data-end="874.339">storage panel look into cash storage and</span> <span data-start="874.339" data-end="876.329">see all of the files that are actually</span> <span data-start="876.329" data-end="878.339">cached by the site you also go into</span> <span data-start="878.339" data-end="880.98">index DB and see all the the pokemon</span> <span data-start="880.98" data-end="882.959">data is stored in there this whole site</span> <span data-start="882.959" data-end="886.17">is open source if you click on the about</span> <span data-start="886.17" data-end="888.209">link you get that super great resource</span> <span data-start="888.209" data-end="891.059">to look at and learn if we actually go</span> <span data-start="891.059" data-end="898.74">into the the worker another broke i'm</span> <span data-start="898.74" data-end="901.92">using a nightly build with some weird</span> <span data-start="901.92" data-end="904.199">settings so i'll go into about debugging</span> <span data-start="904.199" data-end="905.699">in firefox which will list all the</span> <span data-start="905.699" data-end="909.3">workers and so i can start this worker</span> <span data-start="909.3" data-end="911.64">up i can debug it</span> <span data-start="911.64" data-end="914.4">and then in here all right it's all</span> </p>
<p><span data-start="914.4" data-end="917.13">Babel if I'd whatever if we go into the</span> <span data-start="917.13" data-end="919.17">repo will do this later or you can do</span> <span data-start="919.17" data-end="920.49">this later on your own you'll see that</span> <span data-start="920.49" data-end="923.52">the code that Nolan's using literally is</span> <span data-start="923.52" data-end="927.63">these seven lines six lines we're saying</span> <span data-start="927.63" data-end="929.73">look in the cache if there's a response</span> <span data-start="929.73" data-end="932.55">return it otherwise go to the network so</span> <span data-start="932.55" data-end="933.9">you can do this for real and it it makes</span> <span data-start="933.9" data-end="936.51">a website that you know I can close it I</span> <span data-start="936.51" data-end="942.57">can open it again pokedex org just as if</span> </p>
<p><span data-start="942.57" data-end="944.97">I was online I'm not if I was in a</span> <span data-start="944.97" data-end="946.26">browser that didn't support service</span> <span data-start="946.26" data-end="948.51">workers like Safari and I try to go a</span> <span data-start="948.51" data-end="950.31">pokedex torg not connected to the</span> <span data-start="950.31" data-end="952.41">Internet so this is an interesting</span> <span data-start="952.41" data-end="953.79">property of service workers the first</span> <span data-start="953.79" data-end="955.77">time you hit the site you don't have the</span> <span data-start="955.77" data-end="957.12">serviceworker either even if your</span> <span data-start="957.12" data-end="959.97">browser supports it so your site always</span> <span data-start="959.97" data-end="962.01">has to work as if service workers</span> <span data-start="962.01" data-end="964.23">weren't there but if they are you get a</span> <span data-start="964.23" data-end="965.7">better experience when you come back and</span> <span data-start="965.7" data-end="968.04">when Apple finally decides to support</span> <span data-start="968.04" data-end="969.84">service workers so far our users will</span> <span data-start="969.84" data-end="971.58">also get a better experience without you</span> <span data-start="971.58" data-end="974.19">having to change any code the the nice</span> <span data-start="974.19" data-end="975.33">thing about service workers is that it</span> <span data-start="975.33" data-end="976.92">falls back to a traditional Internet</span> <span data-start="976.92" data-end="978.87">experience instead of being something</span> <span data-start="978.87" data-end="980.46">that locks people out you're not</span> <span data-start="980.46" data-end="982.29">splitting the web into the serviceworker</span> <span data-start="982.29" data-end="986.04">people and the people that don't let's</span> <span data-start="986.04" data-end="992.13">turn Wi-Fi back on service workers also</span> <span data-start="992.13" data-end="993.75">give you complete programmatic control</span> <span data-start="993.75" data-end="995.64">over requests and responses you don't</span> <span data-start="995.64" data-end="998.07">just have to do simple caching there's a</span> <span data-start="998.07" data-end="1000.59">link in the slides to this project SW</span> <span data-start="1000.59" data-end="1003.5">delta which will intercept requests and</span> <span data-start="1003.5" data-end="1006.05">append the version you have so if you</span> <span data-start="1006.05" data-end="1009.29">ask for URL main DJ s and the version</span> <span data-start="1009.29" data-end="1011.09">your cash is one dot one dot one this</span> <span data-start="1011.09" data-end="1013.16">will attend a query parameter cash one</span> <span data-start="1013.16" data-end="1014.9">that one not one and then it has a</span> <span data-start="1014.9" data-end="1016.4">server-side implementation it looks at</span> <span data-start="1016.4" data-end="1018.56">the difference between the latest</span> <span data-start="1018.56" data-end="1021.02">version and the cash version creates a</span> <span data-start="1021.02" data-end="1023.45">diff ships the diff back the service</span> <span data-start="1023.45" data-end="1025.04">worker applies the diff to the the</span> <span data-start="1025.04" data-end="1027.11">cached version puts that back in the</span> <span data-start="1027.11" data-end="1029.54">cache and then returns that and so this</span> <span data-start="1029.54" data-end="1033.14">is a way to kind of ship deltas and save</span> <span data-start="1033.14" data-end="1034.57">a lot of band let's save a lot of time</span> <span data-start="1034.57" data-end="1038.12">for questionable increases are</span> <span data-start="1038.12" data-end="1040.339">non-trivial increases in complexity but</span> <span data-start="1040.339" data-end="1041.51">it gives you an idea of the sorts of</span> <span data-start="1041.51" data-end="1043.73">creative uses you could use this for</span> <span data-start="1043.73" data-end="1045.41">it's not just</span> <span data-start="1045.41" data-end="1051.59">or this file as it is unmodified the</span> <span data-start="1051.59" data-end="1055.19">second big gap with web versus apps is</span> <span data-start="1055.19" data-end="1056.96">engagement throughout the rest of the</span> <span data-start="1056.96" data-end="1058.22">conference think about how many times</span> <span data-start="1058.22" data-end="1060.98">you take your phone out turn on the</span> <span data-start="1060.98" data-end="1062.15">screen just glance at what notifications</span> <span data-start="1062.15" data-end="1065">are there or how many times you pull</span> <span data-start="1065" data-end="1066.53">your phone out of your pocket because it</span> <span data-start="1066.53" data-end="1068.45">vibrated to tell you you how to</span> <span data-start="1068.45" data-end="1072.89">notification apps can tell you when</span> <span data-start="1072.89" data-end="1074.06">they're done with something you don't</span> <span data-start="1074.06" data-end="1075.14">have to go in and check I don't have to</span> <span data-start="1075.14" data-end="1076.91">go and see has dr finished uploading</span> <span data-start="1076.91" data-end="1079.04">this file by switching the tab or</span> <span data-start="1079.04" data-end="1081.26">refreshing it it'll tell me when it's</span> <span data-start="1081.26" data-end="1083.66">done and the web has had the ability to</span> <span data-start="1083.66" data-end="1086.21">provide notifications and they can show</span> <span data-start="1086.21" data-end="1087.26">up just like any other native</span> <span data-start="1087.26" data-end="1089.48">notification but they've been limited to</span> <span data-start="1089.48" data-end="1091.58">being on a single page as long as you</span> <span data-start="1091.58" data-end="1092.81">have the page open it can give you a</span> <span data-start="1092.81" data-end="1096.01">desktop notification slack does this</span> <span data-start="1096.01" data-end="1099.23">service workers get you away from that</span> <span data-start="1099.23" data-end="1101.27">page model they give you a script that</span> <span data-start="1101.27" data-end="1103.82">can run independent of the tabs so you</span> <span data-start="1103.82" data-end="1104.87">could actually have a service worker</span> <span data-start="1104.87" data-end="1107.78">that when it got an event show in a</span> <span data-start="1107.78" data-end="1110">notification even if the tab wasn't open</span> <span data-start="1110" data-end="1111.71">so you can close your gmail tab and</span> <span data-start="1111.71" data-end="1114.98">still get notifications of new mail in</span> <span data-start="1114.98" data-end="1116.51">fact Facebook is doing this in</span> <span data-start="1116.51" data-end="1118.61">production these are notifications</span> <span data-start="1118.61" data-end="1120.14">native notifications on Android coming</span> <span data-start="1120.14" data-end="1122.63">from facebook com without the browser</span> <span data-start="1122.63" data-end="1127.1">being open at all again service workers</span> <span data-start="1127.1" data-end="1128.81">are vented so we'll use the push event</span> <span data-start="1128.81" data-end="1132.62">for this when we get a push event we say</span> <span data-start="1132.62" data-end="1134.33">okay show notification with a title and</span> <span data-start="1134.33" data-end="1138.38">a body done so we've looked at three</span> <span data-start="1138.38" data-end="1139.55">events so far and service workers</span> <span data-start="1139.55" data-end="1141.59">install which is when you first get the</span> <span data-start="1141.59" data-end="1143.45">serviceworker fetch which is when a</span> <span data-start="1143.45" data-end="1144.92">network request goes out trigger by an</span> <span data-start="1144.92" data-end="1147.8">image tag or a script tag or an xhr push</span> <span data-start="1147.8" data-end="1150.41">which is when the site wants to notify</span> <span data-start="1150.41" data-end="1153.41">the browser somehow there are many other</span> <span data-start="1153.41" data-end="1155.72">events that exist or will be coming a</span> <span data-start="1155.72" data-end="1158.39">background sync is one that says wake up</span> <span data-start="1158.39" data-end="1159.53">the service worker and let it do some</span> <span data-start="1159.53" data-end="1161.99">work when I come back online there are</span> <span data-start="1161.99" data-end="1163.82">proposals and ideas for things like</span> <span data-start="1163.82" data-end="1165.35">geofencing wake up the service worker</span> <span data-start="1165.35" data-end="1167.57">and let it run a call back when I enter</span> <span data-start="1167.57" data-end="1170.15">a geographic area or wake it up at this</span> <span data-start="1170.15" data-end="1173.06">time and date the service worker story</span> <span data-start="1173.06" data-end="1174.65">is much more generic and much more</span> <span data-start="1174.65" data-end="1178.1">general a general purpose than the</span> <span data-start="1178.1" data-end="1179.03">specific application</span> <span data-start="1179.03" data-end="1183.83">of make it offline suggests so where</span> <span data-start="1183.83" data-end="1187.22">does this push up and come from well</span> <span data-start="1187.22" data-end="1190.55">first when you push it'll look like a</span> <span data-start="1190.55" data-end="1192.67">completely neat browser native OS native</span> <span data-start="1192.67" data-end="1194.75">notification right inside it you can</span> <span data-start="1194.75" data-end="1197.6">disable notifications because that can</span> <span data-start="1197.6" data-end="1198.59">be annoying of course you have to give</span> <span data-start="1198.59" data-end="1202.7">permission the way you get permission is</span> <span data-start="1202.7" data-end="1204.98">in your JavaScript on your page you say</span> <span data-start="1204.98" data-end="1207.71">navigator serviceworker ready then once</span> <span data-start="1207.71" data-end="1209">the serviceworker is ready you can call</span> <span data-start="1209" data-end="1213.56">push manager subscribe and then if the</span> <span data-start="1213.56" data-end="1214.97">user clicks ok you get a subscription</span> <span data-start="1214.97" data-end="1217.49">object that subscription object has all</span> <span data-start="1217.49" data-end="1219.59">the metadata you need to show</span> <span data-start="1219.59" data-end="1223.16">notifications on your users computers so</span> <span data-start="1223.16" data-end="1224.09">what you'll want to do is you want to</span> <span data-start="1224.09" data-end="1226.19">take that subscription object turn into</span> </p>
<p><span data-start="1226.19" data-end="1228.95">JSON post it to your back-end somewhere</span> <span data-start="1228.95" data-end="1230.75">and save it have a database row that</span> <span data-start="1230.75" data-end="1232.88">says this user account has this</span> <span data-start="1232.88" data-end="1238.34">subscription metadata Mozilla has a</span> <span data-start="1238.34" data-end="1239.39">website called the serviceworker</span> <span data-start="1239.39" data-end="1242.72">cookbook at the ever so klever service</span> <span data-start="1242.72" data-end="1248.21">work ers domain that has annotated</span> <span data-start="1248.21" data-end="1251.33">examples of all of this for the push</span> <span data-start="1251.33" data-end="1253.82">example what you'll see is when you get</span> <span data-start="1253.82" data-end="1255.8">that subscription back inside is this</span> <span data-start="1255.8" data-end="1259.4">enormously ridiculous URL at updates top</span> <span data-start="1259.4" data-end="1262.61">pushed at services mozilla com and if</span> <span data-start="1262.61" data-end="1269.39">you post to that URL and if the Wi-Fi</span> <span data-start="1269.39" data-end="1276.44">works there we go hello world I get a</span> <span data-start="1276.44" data-end="1279.59">notification you see that the domain</span> <span data-start="1279.59" data-end="1281.21">returned in 201 created which lets me</span> <span data-start="1281.21" data-end="1283.91">know that that message was successfully</span> <span data-start="1283.91" data-end="1286.37">in queued for delivery to the browser do</span> <span data-start="1286.37" data-end="1289.64">it again and because these are native</span> <span data-start="1289.64" data-end="1290.93">operating system messages they show up</span> <span data-start="1290.93" data-end="1293.06">in my notification drawer and dismiss</span> <span data-start="1293.06" data-end="1297.44">them and mass what the heck is happening</span> <span data-start="1297.44" data-end="1302.31">here where did this URL come from I</span> <span data-start="1302.32" data-end="1304.61">learned graph is about an hour ago and</span> <span data-start="1304.61" data-end="1306.71">built a graph for us instead of a</span> <span data-start="1306.71" data-end="1311.57">whiteboard what happens is the website</span> <span data-start="1311.57" data-end="1313.49">does that get</span> <span data-start="1313.49" data-end="1315.539">request it says I want to be able to</span> <span data-start="1315.539" data-end="1317.659">show you service show you notifications</span> <span data-start="1317.659" data-end="1320.279">the browser asks the user the user can</span> <span data-start="1320.279" data-end="1322.77">sense the browser will go up to a third</span> <span data-start="1322.77" data-end="1324.6">party service operated by your browser</span> <span data-start="1324.6" data-end="1326.76">manufacturer so chrome ones what chrome</span> <span data-start="1326.76" data-end="1328.83">run runs one of these Mozilla runs one</span> <span data-start="1328.83" data-end="1331.74">of these I'll say hey I need a URL that</span> </p>
<p><span data-start="1331.74" data-end="1334.529">I can give to a site to notify me that's</span> <span data-start="1334.529" data-end="1337.23">number two you for service will generate</span> <span data-start="1337.23" data-end="1340.08">a random URL set it back to the browser</span> <span data-start="1340.08" data-end="1341.85">the browser will generate some</span> <span data-start="1341.85" data-end="1343.919">cryptographic keys client-side and pass</span> <span data-start="1343.919" data-end="1346.649">the URL and the crypto keys in step 4</span> <span data-start="1346.649" data-end="1349.47">back to the website that's where this</span> <span data-start="1349.47" data-end="1352.44">massive string comes from that's in the</span> <span data-start="1352.44" data-end="1354.929">the subscription object then when the</span> <span data-start="1354.929" data-end="1356.279">website wants to communicate with the</span> <span data-start="1356.279" data-end="1358.049">browser does it through this push</span> <span data-start="1358.049" data-end="1360.33">service so it sends a message to that</span> <span data-start="1360.33" data-end="1361.98">service and that service access message</span> <span data-start="1361.98" data-end="1364.26">queue because your laptop may be turned</span> <span data-start="1364.26" data-end="1366.62">off your phone maybe an airplane mode</span> <span data-start="1366.62" data-end="1369.21">you'll notice that i sent the header TTL</span> <span data-start="1369.21" data-end="1370.77">60 this says that I want this to be</span> <span data-start="1370.77" data-end="1372.57">queued for a maximum of 60 seconds</span> <span data-start="1372.57" data-end="1374.549">before it expires so if user comes</span> <span data-start="1374.549" data-end="1376.71">online in the next 60 seconds deliver</span> <span data-start="1376.71" data-end="1381.419">the message otherwise drop it of course</span> <span data-start="1381.419" data-end="1382.62">this is all open source you want to see</span> <span data-start="1382.62" data-end="1384.029">how this works our implementation is out</span> <span data-start="1384.029" data-end="1387.059">there the benefit to this architecture</span> <span data-start="1387.059" data-end="1389.61">is it gives you a persistent location to</span> <span data-start="1389.61" data-end="1391.169">queue messages compared to you trying to</span> <span data-start="1391.169" data-end="1393.87">talk to the browser directly and it</span> <span data-start="1393.87" data-end="1395.1">saves battery life because the browser</span> <span data-start="1395.1" data-end="1397.59">can have a single WebSocket connected to</span> <span data-start="1397.59" data-end="1399.21">this one service instead of an arbitrary</span> <span data-start="1399.21" data-end="1400.89">number so for instance on Android</span> </p>
<p><span data-start="1400.89" data-end="1402.419">Firefox for Android actually uses the</span> <span data-start="1402.419" data-end="1404.429">push service will go and use Google</span> <span data-start="1404.429" data-end="1406.14">Cloud messaging because an android phone</span> <span data-start="1406.14" data-end="1408.149">will always have a connection to that</span> <span data-start="1408.149" data-end="1411.47">service so we kind of proxy to that</span> <span data-start="1411.47" data-end="1413.789">again everything in here is encrypted we</span> <span data-start="1413.789" data-end="1415.679">don't want access we don't want to</span> <span data-start="1415.679" data-end="1418.98">anything about what metadata or what</span> <span data-start="1418.98" data-end="1420.87">messages you're sending we don't want</span> <span data-start="1420.87" data-end="1422.1">have that responsibility we don't want</span> <span data-start="1422.1" data-end="1424.74">to have that potential for privacy</span> <span data-start="1424.74" data-end="1428.07">invasion so without any message body all</span> <span data-start="1428.07" data-end="1429.779">this does is just wake up the push event</span> <span data-start="1429.779" data-end="1432.419">and say hey I've got something if you</span> <span data-start="1432.419" data-end="1433.679">want to send a message by you have to</span> <span data-start="1433.679" data-end="1435.75">encrypt it to the keys that the browser</span> <span data-start="1435.75" data-end="1438.36">passes to you at the same time it sends</span> <span data-start="1438.36" data-end="1442.08">the URL if we take this example again we</span> <span data-start="1442.08" data-end="1445.919">go back into about debugging so you can</span> <span data-start="1445.919" data-end="1446.79">see that all the service work</span> <span data-start="1446.79" data-end="1448.29">are asleep right now because they wake</span> <span data-start="1448.29" data-end="1449.79">up they handle their event they go back</span> <span data-start="1449.79" data-end="1451.23">to sleep that's all you had those event</span> <span data-start="1451.23" data-end="1453.33">wait and tell and event respond with</span> <span data-start="1453.33" data-end="1455.64">functions or methods they say like wait</span> <span data-start="1455.64" data-end="1458.25">until this is done until you turn the</span> <span data-start="1458.25" data-end="1459.62">service worker off like I'm not done yet</span> <span data-start="1459.62" data-end="1464.82">so I start this up and I hit debug we</span> <span data-start="1464.82" data-end="1466.59">see the push of nth listener show</span> <span data-start="1466.59" data-end="1467.82">notification let's go ahead and set a</span> <span data-start="1467.82" data-end="1474.28">breakpoint there I come over here thing</span> <span data-start="1474.29" data-end="1477.08">whoops sorry that's a different instance</span> <span data-start="1477.08" data-end="1479.07">alright so I got the break point there</span> <span data-start="1479.07" data-end="1485.4">let's say I'm offline so normally if i</span> <span data-start="1485.4" data-end="1486.87">want to receive these push events i</span> <span data-start="1486.87" data-end="1488.22">would need to be connected to that</span> <span data-start="1488.22" data-end="1489.63">service but now that i'm offline i don't</span> <span data-start="1489.63" data-end="1492.39">have that connection inside about</span> <span data-start="1492.39" data-end="1493.62">debugging I've got this push button</span> <span data-start="1493.62" data-end="1495.15">which will actually synthesize a push</span> <span data-start="1495.15" data-end="1501.18">event client side so I can hit this wow</span> <span data-start="1501.18" data-end="1504.6">why isn't the debugger working so this</span> <span data-start="1504.6" data-end="1505.74">is what happens when you run a nightly</span> <span data-start="1505.74" data-end="1508.74">build this literally worked last week</span> <span data-start="1508.74" data-end="1510.99">but we have been splitting Firefox into</span> <span data-start="1510.99" data-end="1512.97">multiple processes and that sometimes</span> <span data-start="1512.97" data-end="1516.84">causes issues I will file a bug about</span> <span data-start="1516.84" data-end="1517.95">that once we're gone and I will tweet</span> <span data-start="1517.95" data-end="1519.27">the link you can all follow it and be</span> <span data-start="1519.27" data-end="1521.73">like this messed up dan on stage please</span> <span data-start="1521.73" data-end="1528.72">fix faster yeah oh wait no I'm an idiot</span> <span data-start="1528.72" data-end="1531.03">hang on check this out that's the</span> <span data-start="1531.03" data-end="1532.08">breakpoint inside the body because the</span> <span data-start="1532.08" data-end="1533.94">functions are even registered right or</span> <span data-start="1533.94" data-end="1535.2">the listeners always been already been</span> <span data-start="1535.2" data-end="1537.6">registered so if i run this now bing it</span> <span data-start="1537.6" data-end="1540.78">works another thing that's messing up on</span> <span data-start="1540.78" data-end="1542.31">stage is apple will turn on do not</span> <span data-start="1542.31" data-end="1543.78">disturb mode when you connect to a</span> <span data-start="1543.78" data-end="1545.22">projector so i've been sitting there</span> <span data-start="1545.22" data-end="1546.87">like why aren't there any notifications</span> <span data-start="1546.87" data-end="1548.04">and they're all just piling up in the</span> <span data-start="1548.04" data-end="1550.74">background alright so we've got this</span> <span data-start="1550.74" data-end="1554.1">event we look at it we can see it's a</span> <span data-start="1554.1" data-end="1558.42">push on it we can pop this open you know</span> <span data-start="1558.42" data-end="1560.07">see there's no data associate with it</span> <span data-start="1560.07" data-end="1562.29">whatever it's a debugger you can step</span> <span data-start="1562.29" data-end="1565.49">through it play with that on your own</span> <span data-start="1565.49" data-end="1568.89">the last thing at manifests these are</span> <span data-start="1568.89" data-end="1572.94">how we solve installation what do I mean</span> <span data-start="1572.94" data-end="1575.69">by that</span> <span data-start="1575.7" data-end="1578.08">when we think about apps native apps you</span> <span data-start="1578.08" data-end="1579.34">can install them you can put them on</span> <span data-start="1579.34" data-end="1580.48">your home screen you can rearrange them</span> <span data-start="1580.48" data-end="1582.549">give them a place of prominence on your</span> <span data-start="1582.549" data-end="1583.99">device if I'm going to be using the bus</span> <span data-start="1583.99" data-end="1585.07">schedule a lot if I'm going to be using</span> <span data-start="1585.07" data-end="1587.35">the weather website a lot I want to have</span> <span data-start="1587.35" data-end="1590.799">one tap access to that the web has</span> <span data-start="1590.799" data-end="1592.48">historically either you have bookmarks</span> <span data-start="1592.48" data-end="1594.309">which like gets super ugly 16 by 16</span> <span data-start="1594.309" data-end="1596.74">images scaled up to be the size of</span> <span data-start="1596.74" data-end="1598.929">whatever the launcher needs to be or you</span> <span data-start="1598.929" data-end="1600.429">have to go into your browser then into</span> <span data-start="1600.429" data-end="1602.14">the bookmark menu then go past all the</span> <span data-start="1602.14" data-end="1603.429">things you swear you were going to read</span> <span data-start="1603.429" data-end="1605.47">later and dig out the the thing you</span> <span data-start="1605.47" data-end="1607.419">wanted it'd be way nicer if we get add</span> <span data-start="1607.419" data-end="1609.85">stuff to the home screen that's what</span> <span data-start="1609.85" data-end="1611.679">manifests do you manifest act kind of</span> <span data-start="1611.679" data-end="1614.2">like head tags they provide metadata but</span> <span data-start="1614.2" data-end="1617.32">for multi-page contexts like web apps or</span> <span data-start="1617.32" data-end="1620.049">larger sites this is the production</span> <span data-start="1620.049" data-end="1622.12">manifester most of it for flipkart which</span> <span data-start="1622.12" data-end="1625.779">is an indian e-commerce retailer in the</span> <span data-start="1625.779" data-end="1626.95">head of their document they'll say link</span> <span data-start="1626.95" data-end="1630.33">rel manifest and point to this JSON file</span> <span data-start="1630.33" data-end="1633.399">then they can provide a name a short</span> <span data-start="1633.399" data-end="1636.419">name icons with various sizes and types</span> <span data-start="1636.419" data-end="1639.13">they can set the start URL to say the</span> <span data-start="1639.13" data-end="1642.039">experience for the site begins on this</span> <span data-start="1642.039" data-end="1644.32">page even if you're on some other page</span> <span data-start="1644.32" data-end="1647.5">later and you want to to interact with</span> <span data-start="1647.5" data-end="1649.21">this as an app it knows that that's the</span> <span data-start="1649.21" data-end="1651.159">home that's the initial starting</span> <span data-start="1651.159" data-end="1654.159">location you can launch our lock the</span> <span data-start="1654.159" data-end="1655.48">orientation into a portrait so when you</span> <span data-start="1655.48" data-end="1657.909">launch the app the phone turns the</span> <span data-start="1657.909" data-end="1661.21">correct way you can set display to stand</span> <span data-start="1661.21" data-end="1663.01">alone which hides the URL bar and makes</span> <span data-start="1663.01" data-end="1665.64">it look more like a nap appy experience</span> <span data-start="1665.64" data-end="1667.899">you can set a theme color background</span> <span data-start="1667.899" data-end="1670.84">color this display stand alone thing is</span> <span data-start="1670.84" data-end="1673.77">kind of interesting this is a video of</span> <span data-start="1673.77" data-end="1676.39">adding flipkart like to an android home</span> <span data-start="1676.39" data-end="1681.76">screen menu add to homescreen add if you</span> <span data-start="1681.76" data-end="1683.529">go home you can see the icon pops up the</span> <span data-start="1683.529" data-end="1684.94">name and icon are taken from the</span> <span data-start="1684.94" data-end="1686.89">manifest it looks just like a native app</span> <span data-start="1686.89" data-end="1688.87">when you tap it you get a launch screen</span> <span data-start="1688.87" data-end="1692.14">just like a native app and there's no</span> <span data-start="1692.14" data-end="1694.27">browser Chrome there's no URL bar no</span> <span data-start="1694.27" data-end="1697.21">back forward button if you weren't a</span> <span data-start="1697.21" data-end="1698.89">developer if you hadn't seen that</span> <span data-start="1698.89" data-end="1701.08">initial step you would have no idea that</span> <span data-start="1701.08" data-end="1705.07">this wasn't a native application in fact</span> <span data-start="1705.07" data-end="1706.149">a very well could have been I in the</span> <span data-start="1706.149" data-end="1707.32">same exact technologies you could be</span> <span data-start="1707.32" data-end="1707.929">using corto</span> <span data-start="1707.929" data-end="1709.22">or something and have built this already</span> <span data-start="1709.22" data-end="1710.96">as a native app it's just now you can</span> <span data-start="1710.96" data-end="1711.95">get there from the web instead of</span> <span data-start="1711.95" data-end="1716.84">proprietary paths but that's also kind</span> <span data-start="1716.84" data-end="1718.61">of weird because there's no URL bar and</span> <span data-start="1718.61" data-end="1720.289">the web is the web and how do you get</span> <span data-start="1720.289" data-end="1724.94">back to it the manifest spec is I think</span> <span data-start="1724.94" data-end="1727.73">the weakest of this trio of service</span> <span data-start="1727.73" data-end="1729.799">workers push and manifests because we</span> <span data-start="1729.799" data-end="1731.36">don't know how to surface it we don't</span> <span data-start="1731.36" data-end="1732.95">know how to tell users it like hey this</span> <span data-start="1732.95" data-end="1735.35">app those website wants to act like an</span> <span data-start="1735.35" data-end="1736.46">app it wants to be on your home screen</span> <span data-start="1736.46" data-end="1738.95">it's capable of doing that it knows how</span> <span data-start="1738.95" data-end="1741.08">to work offline and once you're in there</span> <span data-start="1741.08" data-end="1742.879">we don't really know how to say actually</span> <span data-start="1742.879" data-end="1744.2">if you want to send somebody link here's</span> <span data-start="1744.2" data-end="1746.629">how you get the URL we've experiment</span> <span data-start="1746.629" data-end="1748.039">with long pressing but that conflicts</span> <span data-start="1748.039" data-end="1750.529">with other things opera has recently</span> <span data-start="1750.529" data-end="1753.7">experimented with a rather interesting</span> <span data-start="1753.7" data-end="1756.74">option so where you swipe down and then</span> <span data-start="1756.74" data-end="1761.179">to the side and that pops from the app</span> <span data-start="1761.179" data-end="1763.19">experience into the browser experience</span> <span data-start="1763.19" data-end="1765.83">and then to get back they have this</span> <span data-start="1765.83" data-end="1770.59">little mobile phone badge by the URL bar</span> <span data-start="1770.59" data-end="1772.73">and soul I don't know clearly there's a</span> <span data-start="1772.73" data-end="1773.899">need for this sort of stuff there's a</span> <span data-start="1773.899" data-end="1776.45">need to be able to say here's my site's</span> <span data-start="1776.45" data-end="1778.07">name here's where it starts it really</span> <span data-start="1778.07" data-end="1779.57">only works in portrait mode though if</span> <span data-start="1779.57" data-end="1782.029">you're doing that you're maybe haven't</span> <span data-start="1782.029" data-end="1783.23">learned the lesson that the web can show</span> <span data-start="1783.23" data-end="1786.86">up on a fridge but I don't know about</span> <span data-start="1786.86" data-end="1788.24">this whole display stand alone thing</span> <span data-start="1788.24" data-end="1791.059">because is the web without URLs still</span> <span data-start="1791.059" data-end="1795.619">the web at all if you can't cut and</span> <span data-start="1795.619" data-end="1797.869">paste if you can't edit a URL like what</span> <span data-start="1797.869" data-end="1800.72">what is that so I don't know but we need</span> <span data-start="1800.72" data-end="1802.009">the rest of the metadata and we'll</span> <span data-start="1802.009" data-end="1803.539">figure it out this is somewhere that you</span> <span data-start="1803.539" data-end="1805.519">as developers by adopting this by</span> <span data-start="1805.519" data-end="1806.929">experiment with this can actually</span> <span data-start="1806.929" data-end="1808.669">provide a lot of meaningful input and</span> <span data-start="1808.669" data-end="1810.889">shape the direction of the web in the</span> <span data-start="1810.889" data-end="1814.399">the links on the slides repo and github</span> <span data-start="1814.399" data-end="1816.379">there's a link to the Firefox bug we've</span> <span data-start="1816.379" data-end="1818.899">just now started preparing to implement</span> <span data-start="1818.899" data-end="1820.49">display stand alone in Firefox for</span> </p>
<p><span data-start="1820.49" data-end="1823.7">Android there are a lot of open</span> <span data-start="1823.7" data-end="1824.779">questions you can come in you can</span> <span data-start="1824.779" data-end="1825.649">actually say well I've been thinking</span> <span data-start="1825.649" data-end="1827.629">about this of experiment with this this</span> <span data-start="1827.629" data-end="1830.2">doesn't work well this does work well so</span> <span data-start="1830.2" data-end="1832.309">it's something that we have to we have</span> <span data-start="1832.309" data-end="1833.86">to learn how to get there together</span> <span data-start="1833.86" data-end="1836.24">something that that's been very humbling</span> <span data-start="1836.24" data-end="1839.09">as a as a browser manufacturers we're</span> <span data-start="1839.09" data-end="1840.289">finally starting to realize that we</span> <span data-start="1840.289" data-end="1841.13">don't know how</span> <span data-start="1841.13" data-end="1844.31">to build websites we know how to build</span> <span data-start="1844.31" data-end="1847.49">web browsers but like those are big C++</span> <span data-start="1847.49" data-end="1849.23">code bases that are compiled and shipped</span> <span data-start="1849.23" data-end="1851.81">over the wire every couple of weeks or</span> <span data-start="1851.81" data-end="1853.45">every couple days for for hot patches</span> <span data-start="1853.45" data-end="1857.69">that don't resemble the web at all we've</span> <span data-start="1857.69" data-end="1858.89">had experiments like app cache that</span> <span data-start="1858.89" data-end="1860.72">totally failed app cache work great if</span> <span data-start="1860.72" data-end="1863">you were used it exactly how we wanted</span> <span data-start="1863" data-end="1864.8">you to use it to make the web work</span> <span data-start="1864.8" data-end="1866.42">offline but if you want to do something</span> <span data-start="1866.42" data-end="1869.48">fancy like that patching the response in</span> <span data-start="1869.48" data-end="1871.88">flight or if you want to say I want</span> <span data-start="1871.88" data-end="1874.49">specifically these things cached as a</span> <span data-start="1874.49" data-end="1877.61">fallback not as the primary resource we</span> <span data-start="1877.61" data-end="1879.23">didn't have have the tools for that so</span> <span data-start="1879.23" data-end="1880.88">the the browser manufacturers have</span> <span data-start="1880.88" data-end="1881.99">started trying to say all right let's</span> <span data-start="1881.99" data-end="1883.58">give the developers let's give you all</span> <span data-start="1883.58" data-end="1886.97">in this room and a set of tools a tool</span> <span data-start="1886.97" data-end="1888.65">box instead of a specific tool will give</span> <span data-start="1888.65" data-end="1890.18">you a tool box and we'll see what you do</span> <span data-start="1890.18" data-end="1891.86">and we'll try to learn from that it's</span> <span data-start="1891.86" data-end="1893.78">the same way that jQuery influenced the</span> <span data-start="1893.78" data-end="1896.78">document query selector method there was</span> <span data-start="1896.78" data-end="1898.85">a time when jquery and prototype and</span> <span data-start="1898.85" data-end="1900.68">moved to mootools and all these other</span> <span data-start="1900.68" data-end="1902.42">libraries competed on how fast they</span> <span data-start="1902.42" data-end="1904.88">could parse CSS selectors to find Dom</span> <span data-start="1904.88" data-end="1907.04">nodes because before those libraries the</span> <span data-start="1907.04" data-end="1908.6">way you selected Dom nodes was using an</span> <span data-start="1908.6" data-end="1911.87">xml query language called xpath because</span> <span data-start="1911.87" data-end="1913.46">browser manufacturers don't know how to</span> <span data-start="1913.46" data-end="1916.1">make websites but we can learn and when</span> <span data-start="1916.1" data-end="1917.51">we see these emergent properties and we</span> <span data-start="1917.51" data-end="1920.56">see people build things that make sense</span> <span data-start="1920.56" data-end="1922.76">then we can codify it so that's kind of</span> <span data-start="1922.76" data-end="1923.48">where we're starting with service</span> <span data-start="1923.48" data-end="1925.25">workers here's a bunch of tools or</span> <span data-start="1925.25" data-end="1926.99">toolbox we'll see what tools come out of</span> <span data-start="1926.99" data-end="1930.41">that the important things that we try to</span> <span data-start="1930.41" data-end="1933.89">work with the web I've seen people light</span> <span data-start="1933.89" data-end="1935.18">up at the suggestion they can hide the</span> </p>
<p><span data-start="1935.18" data-end="1937.37">URL bar like oh that's wonderful i can</span> <span data-start="1937.37" data-end="1939.62">finally disguise the fact that i'm using</span> <span data-start="1939.62" data-end="1941.24">the web I don't have to be a shame that</span> <span data-start="1941.24" data-end="1944.27">i'm using the web anymore and i think</span> <span data-start="1944.27" data-end="1946.4">that's that's not going to work</span> <span data-start="1946.4" data-end="1949.34">long-term the web has a lot of a lot of</span> <span data-start="1949.34" data-end="1951.8">quirks but when we work with them we get</span> <span data-start="1951.8" data-end="1953.48">to a better place so think about these</span> <span data-start="1953.48" data-end="1954.56">tools those things that you can use to</span> <span data-start="1954.56" data-end="1956.75">enhance your experience not replace the</span> <span data-start="1956.75" data-end="1960.14">web's experience i'm going to be around</span> <span data-start="1960.14" data-end="1962.57">all all day all day tomorrow please come</span> <span data-start="1962.57" data-end="1964.55">ask me more questions like I said the</span> <span data-start="1964.55" data-end="1966.05">the slides are online i tweeted the link</span> <span data-start="1966.05" data-end="1968.48">we also have two other m'zullians here</span> <span data-start="1968.48" data-end="1970.94">sitting in the back floki and ender who</span> <span data-start="1970.94" data-end="1972.98">will be doing a free workshop on these</span> <span data-start="1972.98" data-end="1974.57">technologies on monday</span> <span data-start="1974.57" data-end="1976.759">meetup.com / javascript iceland the</span> <span data-start="1976.759" data-end="1978.98">registration will open tomorrow just</span> <span data-start="1978.98" data-end="1982.159">after noon and kudos to these folks who</span> <span data-start="1982.159" data-end="1983.99">shared photos of the fridge in the pizza</span> <span data-start="1983.99" data-end="1986.45">so thank you so much I have stickers up</span> </p>
</section>