<section>
<p><span data-start="7.149" data-end="11.96">See if it works. Can someone help me in checking if it works? Yeah. Cool. So, thanks for joining.</span> <span data-start="11.96" data-end="17.31">This talk is about how ad blockers are being circumvented and basically what we're doing</span> <span data-start="17.31" data-end="22.43">to fight back. What are the challenges that we face on a daytoday basis and then what</span> <span data-start="22.43" data-end="28.58">are we trying to do to counter them? A little bit about me. I'm product owner of</span> <span data-start="28.58" data-end="35.94">anticircumvention which makes plus, and previously I was head of R&D where I basically tried</span> <span data-start="35.94" data-end="41.19">to use technology for making some solutions for people with disabilities. And before this</span> </p>
<p><span data-start="41.19" data-end="48.58">I used to work at Opera. Amongst many things also being part of the extensions platform.</span> <span data-start="48.58" data-end="56.07">So, an entire micro industry has basically popped up in the last few years promising</span> <span data-start="56.07" data-end="61.66">to bypass ad blockers. So, basically, they go to publishers and say that even if your</span> <span data-start="61.66" data-end="68.83">site isn't on the user's ad blockers white list, we can still find a way to show user's</span> <span data-start="68.83" data-end="74.02">ads. Generally, if you go to their websites, they'll say something we cover blocked ad</span> <span data-start="74.02" data-end="84.11">impressions, cover your blocked ads. This is more of a problem. Back in 2016 there was</span> <span data-start="84.11" data-end="92.63">a research paper that analyzed this. We found that at least 6.7% of the top five websites</span> <span data-start="92.63" data-end="100.08">engage in some form of anti-ad blocking. We call it circumvention. It's at the next level,</span> <span data-start="100.08" data-end="108.29">rough privacy badger, and others that are half of the ad blocking scripts in the dataset.</span> <span data-start="108.29" data-end="114.53">This was back in 2016. It's believed in 2019 this has scaled\heven more on both sides.</span> <span data-start="114.53" data-end="119.65">So, you have more people engaging in this kind of behavior. And there's also increased</span> <span data-start="119.65" data-end="125.09">amount of attention from ad blockers trying to look at this particular problem as well.</span> <span data-start="125.09" data-end="130.909">So, what exactly is circumvention? As I said, it's showing users ads by getting around the</span> <span data-start="130.909" data-end="136.93">ad blocker despite them not being on the ad blocker whitelist. Either implicitly or explicitly.</span> <span data-start="136.93" data-end="142.31">Now, for obvious reasons this is bad, yes. But there are some nonobvious reasons why</span> <span data-start="142.31" data-end="147.599">it's even worse. To talk about this, or to think about this,</span> <span data-start="147.599" data-end="152.75">let's look at some types of opinions towards ads and ad blockers. So, on the one hand,</span> <span data-start="152.75" data-end="157.439">you have some people who are just fine with that. Either they don't know about ad blockers</span> <span data-start="157.439" data-end="161.459">or they don't care. Or they, as a matter of principle, don't want it use ad blockers.</span> </p>
<p><span data-start="161.459" data-end="166.84">I know a few people like this. On the other hand, on the other extreme, you have people,</span> <span data-start="166.84" data-end="172.79">what I call the scorched Earth mentality. Where every ad is bad all the time and block</span> <span data-start="172.79" data-end="176.209">each and every one of them. Don't support any online ads, don't care about publisher</span> <span data-start="176.209" data-end="182.189">revenue. And this is a spectrum. There's something in between where it's like, okay, most ads</span> <span data-start="182.189" data-end="188.109">are bad. But not all of them are bad. As long as someone respects me and is not doing annoying</span> <span data-start="188.109" data-end="193.639">stuff, then I'm willing to give them a chance. And there's a lot of movement within the industry</span> <span data-start="193.639" data-end="200.51">to somehow take these ad companies and try to make sure that they follow some kind of</span> <span data-start="200.51" data-end="205.19">standards or some kind of rules for good behavior. Whether it's the coalition for better ads</span> <span data-start="205.19" data-end="209.9">or whether it's acceptable ads or something. Let's take a look at one of them, called the</span> <span data-start="209.9" data-end="214.29">acceptable ads criteria. No matter how big and powerful you are, no matter how much money</span> <span data-start="214.29" data-end="220.669">you have, it doesn't matter. At the end, if your ad has to be as part of the acceptable</span> <span data-start="220.669" data-end="225.219">ads criteria, these are things which are not allowed. And this is not an exhaustive list.</span> <span data-start="225.219" data-end="230.189">These are just some of the things. Animated ads, automated ads, expanding ads, popups,</span> <span data-start="230.189" data-end="236.23">pop unders, these are not allowed no matter how much influence you have. Now, it\hyou</span> <span data-start="236.23" data-end="242.29">can circumvent the ad blocker, you can do anything you want. You can make your ads as</span> <span data-start="242.29" data-end="249.2">intrusive and as annoying as possible. And that's what we've seen. When it comes to circumvented</span> <span data-start="249.2" data-end="254.849">ads, these are the worst of the worst on the web and make things miserable for people online.</span> </p>
<p><span data-start="254.849" data-end="261.169">This is why circumvention is maybe worse than what might appear as obvious.</span> <span data-start="261.169" data-end="266.65">Before we go, let's talk about how ad blockers work on a very, very high level. You have</span> <span data-start="266.65" data-end="271.36">a web page, it has ads. You have a browser extension installed. It's an ad blocker. What</span> <span data-start="271.36" data-end="279.52">it does is updates from a filter list which is a communitymaintained list of filter rules.</span> <span data-start="279.52" data-end="285.639">And if that site matches that filter rule, that piece of HTML or whatever is blocked,</span> <span data-start="285.639" data-end="289.74">right? And that's how you see a page without the ads.</span> <span data-start="289.74" data-end="295.34">Now, generally the biggest one, communitymaintained filter list is called easy list. But when</span> <span data-start="295.34" data-end="302.81">it comes to circumvention, we wanted our own, we launched the anticircumvention filter list.</span> <span data-start="302.81" data-end="310.36">It's to target circumvention. We wanted higher privileges to do more complex stuff. And it</span> <span data-start="310.36" data-end="316.199">allows us to react extremely fast to circumvention. If you see circumvention, we can push out</span> <span data-start="316.199" data-end="325.449">a change and it's there instantly. User cans generally update this by default every 60</span> <span data-start="325.449" data-end="332.68">minutes so it's regularly up to date. So, as we're moving fast towards circumvention</span> <span data-start="332.68" data-end="338.05">and pushing all of these filters, CV providers, or circumvention providers, they're forced</span> <span data-start="338.05" data-end="344.64">to become faster too. So much so that there's a constant war going on between the ad blocker</span> <span data-start="344.64" data-end="349.25">and the CV provider. In terms of we push out a filter to block their ads, they change the</span> <span data-start="349.25" data-end="353.33">content of the website. We once again push out a filter, they change things. So, this</span> <span data-start="353.33" data-end="359.689">goes on and on and on. And they keep an eye on the repo, it's open source. Anyone can</span> <span data-start="359.689" data-end="368.55">take a look. They constantly keep an eye. One example of this is where one of our colleagues</span> <span data-start="368.55" data-end="375.39">who pushes out a lot of filters on a particular website, had he found the source code, he</span> <span data-start="375.39" data-end="382.74">found his GitHub username as one of the classes. So, make going to a website and view the source</span> <span data-start="382.74" data-end="387.79">code and see your name over there. And this was kind of like I think from that website's</span> <span data-start="387.79" data-end="392.49">end, kind of like a wink, wink, nudge. Okay, we know what you're doing now, and this is</span> <span data-start="392.49" data-end="398.639">kind of like us acknowledging you. So, this is all about filters. But, you know,</span> <span data-start="398.639" data-end="403.31">it's a constant cat and mouse game between ad blockers and circumvention providers. And</span> <span data-start="403.31" data-end="407.86">somewhere in between this game became more complex. So, it's not just about, you know,</span> <span data-start="407.86" data-end="412.69">the cat chasing the mouse. There's just stopped and started playing chess. So, things are</span> <span data-start="412.69" data-end="419.449">becoming a little bit more complex. So, now we're gonna talk about snippets. There's</span> <span data-start="419.449" data-end="424.87">so, snippets are basically small JavaScript functions designed to counter one or more</span> <span data-start="424.87" data-end="430.979">circumvention techniques. Generally, they're use when had just writing a normal filter</span> <span data-start="430.979" data-end="435.569">isn't enough. So, you have to do something more complex. And a significant amount of</span> <span data-start="435.569" data-end="441.919">the filters in our filter list is, you know, using snippets. Snippets are also called scriptlets</span> <span data-start="441.919" data-end="446.59">in the block origin, for example. And if you want to take a look at the source code, everything</span> <span data-start="446.59" data-end="451.88">is open source, this is the URL. Let's look at case Studies of what we have</span> <span data-start="451.88" data-end="459.979">to deal with on ad blockers on a daily basis. There was this one CV provider which at no</span> <span data-start="459.979" data-end="464.939">time want you it take a look at what they're doing, right? So, what we did was kind I have</span> <span data-start="464.939" data-end="468.84">like a jujitsu move using their own energy against them and I'll explain about it in</span> <span data-start="468.84" data-end="474.24">the following way. So, the CV provider, what they used to do</span> <span data-start="474.24" data-end="479.909">was, whenever you try to go tots website and open up the developer tools, they used to</span> <span data-start="479.909" data-end="485.139">detect this and basically clean up all their code, remove the ads so that you cannot even</span> <span data-start="485.139" data-end="491.539">try to understand what's going on. You cannot even debug the code. Which is\h when I found</span> <span data-start="491.539" data-end="496.699">out I was like, what the hell is going on? So, we thought long and hard about this and</span> <span data-start="496.699" data-end="501.3">then we tried to use their own things against them. We developed a snippet which tricks</span> <span data-start="501.3" data-end="508.099">the developer tools into being already open, when they're not. They did the work for us.</span> </p>
<p><span data-start="508.099" data-end="511.699">They just removed the code themselves. [ Laughter ]</span> <span data-start="511.699" data-end="517.409">So, yeah. Since then they've caught on to this, so they no longer do this trick. But</span> <span data-start="517.409" data-end="523.57">it was quite effective and quite funny for us as well. Another thing I want to talk about</span> <span data-start="523.57" data-end="528.29">is something called the abort and property read, or abort and property write. Typically,</span> <span data-start="528.29" data-end="535.351">a lot of these sites or CV provider, they want to access a particular property or write</span> <span data-start="535.351" data-end="539.77">to a particular property. So, what we do is we kind of know which ones they're looking</span> <span data-start="539.77" data-end="545.59">for and we made a script to kind of block the script or abort the script as soon as</span> <span data-start="545.59" data-end="550.09">we detected they're trying to read a particular property or write to a particular property.</span> <span data-start="550.09" data-end="555.76">This idea was originally from the block origin. Even though our implementation in AVP is different</span> <span data-start="555.76" data-end="560.21">from theirs. But the overall idea was from there and we give credit over here as well</span> <span data-start="560.21" data-end="565.46">as in the source code and good on them for doing some wonderful work.</span> <span data-start="565.46" data-end="571.18">The next thing that I want to talk about is superfluous element stuffing. So, there are</span> <span data-start="571.18" data-end="579.4">a few highprofile websites, not just one. But a few. Which try to get around the fact</span> <span data-start="579.4" data-end="584.77">that, you know, you have posts and you have to\hmention which posts are sponsored. So,</span> <span data-start="584.77" data-end="590.01">of course, if it's just the normal text, you can search for the text that says sponsored</span> <span data-start="590.01" data-end="595.45">and that's the end of it. But they end up stuffing a bunch of elements. They break down</span> <span data-start="595.45" data-end="601.34">the word sponsored into different parts and then they do something like this. So, make</span> <span data-start="601.34" data-end="607.59">things clear a little bit more, this is what they do. So, as you can see, there's some</span> <span data-start="607.59" data-end="613.89">divs, there's some spans. Some of these elements are not going to be visible. The in ends it</span> <span data-start="613.89" data-end="620.19">will say ""Sponsored"" visually. But the source code says this.</span> </p>
<p><span data-start="620.19" data-end="628.32">How do you deal with this? It's really frustrating. It bloats up the page. It doesn't help anyone.</span> <span data-start="628.32" data-end="634.76">This is an approach that is gonna be there soon in AVP. We're still making a few adjustments</span> <span data-start="634.76" data-end="640.85">here and there. But basically, what you did is you go through all of these child elements.</span> <span data-start="640.85" data-end="645.52">And first what you have to do is remove the invisible stuff. Stuff that doesn't really</span> <span data-start="645.52" data-end="651.09">stuff which is what we call decoy elements. You check for invisible text, opacity zero</span> <span data-start="651.09" data-end="661.6">or font none, check for invisibility or collapse. And you ignore those. You go through the ones</span> <span data-start="661.6" data-end="667.99">that are invisible and take the inner text and you concatenate them. And if it says ""Sponsored,""</span> <span data-start="667.99" data-end="674.6">then you have your sponsored ads. Then you can do whatever you want with it.</span> <span data-start="674.6" data-end="681.1">This is the kind of stuff that ad blockers have to deal with daily. But this was still</span> <span data-start="681.1" data-end="688.48">okay. There's another example someone said that, okay, we have sponsored posts and we</span> <span data-start="688.48" data-end="693.94">have to make sure that this says sponsored. So, instead of text now they have something</span> <span data-start="693.94" data-end="698.87">where it's just an image. And inside the image there's text. And it's really bad for accessibility</span> <span data-start="698.87" data-end="704.17">because it doesn't even have an alt attribute. They don't care about anything. Even then</span> <span data-start="704.17" data-end="710.45">it will be okay to detect this, but what they also do is, you see this blank space? That's</span> <span data-start="710.45" data-end="713.761">also an image. That's the same PNG image as this one. The</span> <span data-start="713.761" data-end="719.01">only difference is that this is a transparent PNG so you can't see this and the other one</span> <span data-start="719.01" data-end="725.29">is a nontransparent PNG so you can't see that. So, it looks a little like this, it's a data</span> </p>
<p><span data-start="725.29" data-end="731.62">URI. And it's going to be really, really difficult to detect what's going to happen over here.</span> <span data-start="731.62" data-end="738.1">And to make things even more complex, they make minor variations in the way they're serving</span> <span data-start="738.1" data-end="744.92">images. In this example, this data URL for this data sponsored image can be any of the</span> <span data-start="744.92" data-end="751.62">three data URIs over here. And same for the data labels. It can be any of these things.</span> <span data-start="751.62" data-end="757">We had to look into the PNG spec and do a lot of work. Ultimately, we found out some</span> <span data-start="757" data-end="764.17">kind of pattern which was only applicable to the visible sponsored image.</span> <span data-start="764.17" data-end="767.8">And then what we did was basically it's just a matter of taking that image, converting</span> <span data-start="767.8" data-end="773.91">it to a basis before, looking for that pattern and matching it. If it does, then bingo. We</span> <span data-start="773.91" data-end="781.32">have our PNG ad label and then do the blocking. So, yeah, there's a lot of stuff that we have</span> <span data-start="781.32" data-end="786.87">to do with, you know, circumvention on a daily basis over here.</span> <span data-start="786.87" data-end="796.11">So, let's look at some gaps and challenges that we have. So, when it comes to this, we,</span> <span data-start="796.11" data-end="801.19">you know, when it comes to circumvention, the effort is being fought on multiple fronts.</span> <span data-start="801.19" data-end="806.61">It's not just one thing. So, we have people who are working on kind of reverse engineering</span> <span data-start="806.61" data-end="810.32">what they're doing. You know, people who are hard core JavaScript people. And then filter</span> <span data-start="810.32" data-end="817.52">list authors pushing out filters on an hourly basis. And then there's many other things</span> <span data-start="817.52" data-end="822.11">that I will talk about in the next few slides. On the other hand, even though we have some</span> <span data-start="822.11" data-end="828.9">really smart people working for us to kind of deal with this situation, they also have</span> <span data-start="828.9" data-end="834.06">some really smart people on their end. And they're willing to go through many creative</span> <span data-start="834.06" data-end="838.85">lengths to get around the ad blockers. It's a daily challenge to keep\hup with what</span> <span data-start="838.85" data-end="844.62">they're trying to do. And as I said, this thing is being fought on multiple levels.</span> </p>
<p><span data-start="844.62" data-end="853.73">Not just the technical level. Recently there is this landmark Supreme Court case. Basically,</span> <span data-start="853.73" data-end="860.01">what some publishers wanted to do was to kind of argue that ad blocking itself is illegal.</span> <span data-start="860.01" data-end="863.031">And they, you know, went through the lower courts, the higher courts and ultimately to</span> <span data-start="863.031" data-end="868.78">the Supreme Court. And ad block plus was at the vanguard of this and basically argued</span> <span data-start="868.78" data-end="874.13">that, no, it should be legal. And the Supreme Court of Germany said that, yes, it is actually</span> <span data-start="874.13" data-end="879.45">legal. And, you know, it's totally okay to use ad blockers and do ad blocking.</span> <span data-start="879.45" data-end="885.12">So, yeah. When it comes to fighting, you know, circumvention fighters or publishers, a lot</span> <span data-start="885.12" data-end="890.19">of times what you have is not just people using technical approaches, but sometimes</span> <span data-start="890.19" data-end="898.2">these kind of legal approaches as well. Gaps and challenges? So, apart from this thing,</span> <span data-start="898.2" data-end="903.26">one more thing is the fact that in Firefox you have an API called the content scripts</span> <span data-start="903.26" data-end="910.76">API. Which means that you can have a reliable way for the extension to\h for the extension</span> <span data-start="910.76" data-end="917.56">to run always before the sites code which is actually good in these circumvention things.</span> <span data-start="917.56" data-end="923.18">But in Chrome, you don't have an equivalent API so there's no reliable way to guarantee</span> <span data-start="923.18" data-end="928.68">that the extension scripts always runs before the site scripts. So, that's that. But there's</span> <span data-start="928.68" data-end="934.93">also the Chrome manifest V3 situation where there are some significant architecture changes</span> <span data-start="934.93" data-end="942.2">that might be coming which will be impacting a lot of ad blockers.</span> </p>
<p><span data-start="942.2" data-end="947.52">Some with welcome. The background page architecture might be displaced by a service worker, which</span> <span data-start="947.52" data-end="952.29">is good. There's a switch to a promisebased API rather than a callback API, which is also</span> <span data-start="952.29" data-end="957.1">good. But there are some major changes to the blocking portion of the web request API.</span> <span data-start="957.1" data-end="964.51">So, this is the part of the extensions API which allows you to block a network request.</span> <span data-start="964.51" data-end="969.54">And this is something which is going to be\h or at least announced to be changed. Instead,</span> <span data-start="969.54" data-end="977.02">they'll have a declarative rulebased instead, which is I think Apple. From most of the ad</span> <span data-start="977.02" data-end="981.95">blockers, if you read their opinion, it's still not in a good enough shape right now.</span> <span data-start="981.95" data-end="986.34">And updating the rules from the filter list might require a new version list. Right now,</span> <span data-start="986.34" data-end="990.23">if you want to update the rules in the easy list, all you have to do is update the easy</span> <span data-start="990.23" data-end="999.221">list. It's there. But if you have to do this new v3 thing, if you have to update the filter</span> <span data-start="999.221" data-end="1004.04">list you might need to do a whole new extension release and send in the extension to the Chrome</span> <span data-start="1004.04" data-end="1009.45">web store once again and gets moderated and released. And if you have to do this each</span> <span data-start="1009.45" data-end="1012.63">and every day multiple times a day, it's going to be impractical.</span> </p>
<p><span data-start="1012.63" data-end="1022.42">So, we worked together across ad blockers, Adblock Plus, Adblock\h Adguard, Ghostery</span> <span data-start="1022.42" data-end="1030.4">and two authors, Fanboy, as well as Malwarebytes. We gave the Chrome team feedback on one of</span> <span data-start="1030.4" data-end="1035.77">the things we would like in v3. What are the changes we would like? It seems that the Chrome</span> <span data-start="1035.77" data-end="1043.541">team is taking a look and kind of evaluating all of this. But at the same time, there's</span> <span data-start="1043.541" data-end="1051.07">a question mark over here on what do they really want to do? What is the\h what is the</span> <span data-start="1051.07" data-end="1056.99">end goal when it comes to ad blocking and, you know, when it comes to v3, what exactly</span> <span data-start="1056.99" data-end="1061.17">do they want? What is the quality that they want in terms of ad blocking?</span> <span data-start="1061.17" data-end="1066.18">There's this performance argument that, okay, you know, we want to make these changes because</span> <span data-start="1066.18" data-end="1070.86">we want to make things a little bit more performant. There's the security argument as well. But</span> <span data-start="1070.86" data-end="1078.17">at the same time when it comes to ad blockers, if the ad blockers are harmed, then circumvention</span> <span data-start="1078.17" data-end="1090.32">rises as well, and everyone is in a bad situation. Whether it comes to this, I'll just end with</span> <span data-start="1090.32" data-end="1097.32">this recentlyreleased W3C tag ethical web principles document which is something that</span> <span data-start="1097.32" data-end="1101.89">every browser maker\h everyone should read. But especially all the browser makers should</span> <span data-start="1101.89" data-end="1107.5">read. It says that people should be able to render content as they want. Users should</span> <span data-start="1107.5" data-end="1112.69">be able to install stylesheets, assistive browser extensions, blockers of unwanted content</span> <span data-start="1112.69" data-end="1118.75">or scripts of autoplayed videos. Through technology such as browser extensions, people must be</span> <span data-start="1118.75" data-end="1125.44">able to change web pages according to their needs. So, with this\h I think this is a pretty</span> <span data-start="1125.44" data-end="1130.29">good way to end the talk. If you have any questions regarding all of this, I'm here</span> <span data-start="1130.29" data-end="1141.58">after this talk and tomorrow as well. So, I'll just say, thank you so much.</span> </p>
</section>