<section>
<p><span data-start="37.879" data-end="40.739">so my name is Hakeem shoot it's my</span> <span data-start="40.739" data-end="42.42">privilege today to bring you out of the</span> <span data-start="42.42" data-end="45.179">lunch coma back onto track B I'll be</span> <span data-start="45.179" data-end="47.309">talking about technology called HJs</span> <span data-start="47.309" data-end="49.589">which allows you to run node.js and that</span> <span data-start="49.589" data-end="53.359">net framework called code in one process</span> <span data-start="53.359" data-end="56.129">so when you write an application today</span> <span data-start="56.129" data-end="58.71">you have a choice of many languages each</span> <span data-start="58.71" data-end="60.179">of them has its own strengths and</span> <span data-start="60.179" data-end="63.42">weaknesses if you choose not yes as your</span> <span data-start="63.42" data-end="65.22">back-end solution that these are some of</span> <span data-start="65.22" data-end="67.2">the challenges you have to deal with so</span> <span data-start="67.2" data-end="69.06">first of all no js' is not really cut</span> <span data-start="69.06" data-end="71.159">for doing CPU bound work and by CPU</span> <span data-start="71.159" data-end="72.78">bound I don't necessarily mean weather</span> <span data-start="72.78" data-end="74.939">prediction but even something as simple</span> <span data-start="74.939" data-end="76.619">as you know calculating a fibonacci</span> <span data-start="76.619" data-end="79.259">sequence if you do in a CPU bound work</span> <span data-start="79.259" data-end="81.299">in node.js you will effectively block</span> <span data-start="81.299" data-end="83.34">the node.js event loop and prevent your</span> <span data-start="83.34" data-end="86.369">web from serving subsequent HTTP</span> <span data-start="86.369" data-end="92.34">requests it is it is very infrequent</span> <span data-start="92.34" data-end="94.859">then you're developing an application a</span> <span data-start="94.859" data-end="96.39">new application in a complete vacuum</span> <span data-start="96.39" data-end="98.399">typically you'd have some ecosystem of</span> <span data-start="98.399" data-end="100.439">other subsystems or components that you</span> <span data-start="100.439" data-end="102.06">would want to either reuse or integrate</span> <span data-start="102.06" data-end="104.25">with and chances are these components</span> <span data-start="104.25" data-end="106.89">are not implemented in ondrea's but with</span> <span data-start="106.89" data-end="110.52">some other technology like JVM based or</span> <span data-start="110.52" data-end="114.57">or CLR based and lastly you know</span> <span data-start="114.57" data-end="116.899">javascript is not really cut for many</span> <span data-start="116.899" data-end="119.7">tasks out there and and far superior</span> <span data-start="119.7" data-end="122.07">implementations exist implemented in</span> <span data-start="122.07" data-end="124.32">other technologies and to write a really</span> <span data-start="124.32" data-end="126.06">good application you really have to have</span> <span data-start="126.06" data-end="128.34">a hybrid technology stack and be able to</span> <span data-start="128.34" data-end="131.19">reuse the components that do something</span> <span data-start="131.19" data-end="133.949">better</span> <span data-start="133.959" data-end="135.91">so a common solution to all these</span> <span data-start="135.91" data-end="137.77">problems in in no js' when you're</span> <span data-start="137.77" data-end="139.09">writing that hybrid application</span> <span data-start="139.09" data-end="141.81">consisting of many technologies is to</span> <span data-start="141.81" data-end="144.58">move the computation that is using other</span> <span data-start="144.58" data-end="146.47">technology to a different process so</span> <span data-start="146.47" data-end="147.94">you're introducing a process boundary</span> <span data-start="147.94" data-end="150.13">within your application establish some</span> <span data-start="150.13" data-end="151.959">form of inter process communication to</span> <span data-start="151.959" data-end="153.55">exchange data between the node Reyes</span> <span data-start="153.55" data-end="155.8">component and let's say Java or.net</span> <span data-start="155.8" data-end="161.349">component and this this approach</span> <span data-start="161.349" data-end="163.84">generally has two big disadvantages one</span> <span data-start="163.84" data-end="166.269">is the added complexity now you have two</span> <span data-start="166.269" data-end="167.709">processes instead of one you have to</span> <span data-start="167.709" data-end="170.459">deal with process lifetime management</span> <span data-start="170.459" data-end="173.709">many more kind of failure ingles of the</span> <span data-start="173.709" data-end="175.75">entire system and also you have added</span> <span data-start="175.75" data-end="178.51">latency arguably any inter-process</span> <span data-start="178.51" data-end="180.849">communication mechanism is going to have</span> <span data-start="180.849" data-end="184.12">higher latency than any in process call</span> <span data-start="184.12" data-end="186.94">within the same address address space so</span> <span data-start="186.94" data-end="188.62">there has to be a better way of solving</span> <span data-start="188.62" data-end="191.08">that hybrid application problem and in</span> <span data-start="191.08" data-end="192.819">case of CLR I believe the solution could</span> <span data-start="192.819" data-end="195.04">look like this</span> <span data-start="195.04" data-end="199.93">so MJS is a node.js module when you pull</span> <span data-start="199.93" data-end="202.06">that module into node.js application</span> <span data-start="202.06" data-end="203.95">what happens is that from the node.js</span> <span data-start="203.95" data-end="206.47">perspective it appears to be a native</span> <span data-start="206.47" data-end="208.81">module however the first thing it does</span> <span data-start="208.81" data-end="211.18">is actually spins up a CLR virtual</span> <span data-start="211.18" data-end="213.94">machine within the note process itself</span> <span data-start="213.94" data-end="215.68">so at that point you are running v8</span> <span data-start="215.68" data-end="218.709">which underpins nodejs and CLR which</span> <span data-start="218.709" data-end="220.72">allows you to run any of the CLR</span> <span data-start="220.72" data-end="222.519">languages within the same processes here</span> <span data-start="222.519" data-end="225.28">node.js code executes in addition to</span> <span data-start="225.28" data-end="226.81">that the add module provide a single</span> <span data-start="226.81" data-end="230.73">function called func the function takes</span> </p>
<p><span data-start="230.73" data-end="233.53">CLR code in a variety of representations</span> <span data-start="233.53" data-end="234.73">so we'll be talking about soon and</span> <span data-start="234.73" data-end="237.67">creates a JavaScript wrapper around that</span> <span data-start="237.67" data-end="240.489">call so in here we are basically we have</span> <span data-start="240.489" data-end="243.04">a async lambda expression in c-sharp</span> <span data-start="243.04" data-end="245.35">which accepts an input parameter and</span> <span data-start="245.35" data-end="246.94">returns a string there is a</span> <span data-start="246.94" data-end="249.1">concatenation of dotnet welcomes and</span> <span data-start="249.1" data-end="250.69">that input parameter C realized the</span> <span data-start="250.69" data-end="252.28">string</span> <span data-start="252.28" data-end="255.79">H fact creates a JavaScript proxy around</span> <span data-start="255.79" data-end="258.729">the c-sharp code and that proxy is</span> <span data-start="258.729" data-end="260.799">called hello the proxy is actually a</span> <span data-start="260.799" data-end="262.75">script function so next we are calling</span> <span data-start="262.75" data-end="264.64">it passing node.js is that single</span> <span data-start="264.64" data-end="266.59">parameter</span> <span data-start="266.59" data-end="268.78">and as is the case with the typical</span> <span data-start="268.78" data-end="270.97">async pattern in not is that hello</span> <span data-start="270.97" data-end="272.98">function accepts input parameter in the</span> <span data-start="272.98" data-end="274.51">callback function in the callback we are</span> <span data-start="274.51" data-end="275.71">basically displaying the result</span> <span data-start="275.71" data-end="277.81">generated by the by the seashore code so</span> <span data-start="277.81" data-end="284.42">let's let's take it for a spin</span> <span data-start="284.43" data-end="287.77">that's probably way too small something</span> <span data-start="287.77" data-end="297.43">happened with the retina see if I can</span> <span data-start="297.43" data-end="305.11">quickly fix this so this is our function</span> <span data-start="305.11" data-end="307.21">that you just a minute ago on the slide</span> <span data-start="307.21" data-end="311.169">if I run it basically it prints out that</span> <span data-start="311.169" data-end="312.729">net welcomes new Jaso at that point</span> <span data-start="312.729" data-end="314.74">we've been running the node process</span> </p>
<p><span data-start="314.74" data-end="317.32">I wasn't spinning any external processes</span> <span data-start="317.32" data-end="319.389">I was running that CLR code inside of</span> <span data-start="319.389" data-end="320.229">node</span> <span data-start="320.229" data-end="322.96">Xin windows and of course that this was</span> <span data-start="322.96" data-end="324.79">to be expected as Windows that are three</span> <span data-start="324.79" data-end="327.25">more runs on Windows but you can do the</span> <span data-start="327.25" data-end="333.729">same on a Mac as well so we have the</span> <span data-start="333.729" data-end="340.78">same problem here and I can run it on</span> <span data-start="340.78" data-end="342.49">the Mac on market is using a Shimano</span> <span data-start="342.49" data-end="345.64">instead of dotnet framework and you can</span> <span data-start="345.64" data-end="353.24">do the very same thing on the bun to</span> <span data-start="353.25" data-end="355.06">welcomes ingest so this is a</span> <span data-start="355.06" data-end="358.03">cross-platform capability to of</span> <span data-start="358.03" data-end="361.12">scripting CLR inside of a node.js</span> <span data-start="361.12" data-end="369.16">application so if scenes run on windows</span> <span data-start="369.16" data-end="372.729">on mark and on linux there have been</span> <span data-start="372.729" data-end="375.479">several attempts prior to address to</span> <span data-start="375.479" data-end="378.76">provide support for interurban CLR and</span> <span data-start="378.76" data-end="381.55">no js' most of these attempts were</span> <span data-start="381.55" data-end="383.289">trying to solve a very general problem</span> <span data-start="383.289" data-end="387.4">of allowing not dress code to call any</span> <span data-start="387.4" data-end="391.32">api in that net or any managed library</span> <span data-start="391.32" data-end="393.58">this is problematic because there is a</span> <span data-start="393.58" data-end="396.01">fundamental discrepancy between the</span> <span data-start="396.01" data-end="399.3">basic design of node.js and CL</span> <span data-start="399.3" data-end="401.729">no js' a single-threaded in even the</span> <span data-start="401.729" data-end="404.55">base see that is multi-threaded and</span> <span data-start="404.55" data-end="407.039">effectively by being multi-threaded it</span> <span data-start="407.039" data-end="409.259">also allows the number of synchronous</span> <span data-start="409.259" data-end="411.389">blocking calls and that meant framework</span> <span data-start="411.389" data-end="414.06">is actually it provides many blocking</span> <span data-start="414.06" data-end="417.06">calls that that if called from no js' on</span> <span data-start="417.06" data-end="419.159">the v8 singleton threat would directly</span> <span data-start="419.159" data-end="423.419">block the node.js event loop so edge is</span> <span data-start="423.419" data-end="427.65">takes a much more prescriptive approach</span> <span data-start="427.65" data-end="430.139">to the Interop and says that any code</span> <span data-start="430.139" data-end="432.81">that you want to invoke from not Jes</span> <span data-start="432.81" data-end="435.93">must be wrapped in an async delegate the</span> <span data-start="435.93" data-end="437.84">shape of the racing the delegate is</span> <span data-start="437.84" data-end="440.909">frank object task object which means</span> <span data-start="440.909" data-end="443.789">that the code you are calling from not</span> </p>
<p><span data-start="443.789" data-end="446.55">Jes in CLR must accept one parameter</span> <span data-start="446.55" data-end="448.379">which is of type type object it may be a</span> <span data-start="448.379" data-end="450.78">complex type and the returns a task</span> <span data-start="450.78" data-end="453.96">typed with an object a task is a the</span> <span data-start="453.96" data-end="457.05">sila concept that is a moral equivalent</span> <span data-start="457.05" data-end="459.9">of a Java future or a JavaScript promise</span> <span data-start="459.9" data-end="462.3">which is basically encapsulates a</span> <span data-start="462.3" data-end="465.569">concept of an asynchronous call that</span> <span data-start="465.569" data-end="467.55">will complete sometime in the future</span> <span data-start="467.55" data-end="470.25">with either a result or an error and</span> <span data-start="470.25" data-end="472.11">that concept of a promise can be very</span> <span data-start="472.11" data-end="473.639">easily mapped into the basic</span> <span data-start="473.639" data-end="476.849">asynchronous pattern of calling</span> <span data-start="476.849" data-end="478.77">functions in node.js which is basically</span> <span data-start="478.77" data-end="480.33">a function that accepts a parameter and</span> <span data-start="480.33" data-end="482.909">a callback method and the callback</span> <span data-start="482.909" data-end="485.039">method accepts an error an optional</span> <span data-start="485.039" data-end="487.86">error in a result and this is how how</span> <span data-start="487.86" data-end="491.039">this for these concepts map onto each</span> <span data-start="491.039" data-end="492.36">other</span> <span data-start="492.36" data-end="494.55">so what address gives you is basically</span> <span data-start="494.55" data-end="497.25">the ability to run a silicon</span> </p>
<p><span data-start="497.25" data-end="499.5">CLR virtual machine and v8 virtual</span> <span data-start="499.5" data-end="501.93">machine inside of a single process it</span> <span data-start="501.93" data-end="505.529">provides the capability to marshal data</span> <span data-start="505.529" data-end="508.319">between v8 and CLR reconcile the</span> <span data-start="508.319" data-end="509.94">threading models between not a threaded</span> <span data-start="509.94" data-end="514.05">CLR and simulated v8 and provides that</span> <span data-start="514.05" data-end="516.209">all within that framework of this very</span> <span data-start="516.209" data-end="517.26">prescriptive</span> <span data-start="517.26" data-end="521.88">interrupt pattern so why is this a</span> <span data-start="521.88" data-end="523.74">better way than spinning to processes</span> <span data-start="523.74" data-end="525.75">first of all because you don't have two</span> <span data-start="525.75" data-end="527.55">processes now you have just one and it</span> <span data-start="527.55" data-end="529.56">is definitely simpler to deploy simpler</span> <span data-start="529.56" data-end="531.41">to manage and simpler to think about and</span> <span data-start="531.41" data-end="533.04">second of all that is</span> <span data-start="533.04" data-end="535.829">but faster than any inter process</span> <span data-start="535.829" data-end="537.48">communication mechanisms that will be</span> <span data-start="537.48" data-end="539.339">required if you had multiple processes</span> <span data-start="539.339" data-end="542.579">to integrate a hybrid an application</span> <span data-start="542.579" data-end="545.779">consisting of hybrid technologies</span> <span data-start="545.779" data-end="547.74">specifically I've done some measurements</span> <span data-start="547.74" data-end="552.36">around providing the same application</span> <span data-start="552.36" data-end="555.63">logic where the dotnet process was</span> <span data-start="555.63" data-end="557.459">running separately from los Reyes and</span> <span data-start="557.459" data-end="559.11">there was an HTTP communication between</span> <span data-start="559.11" data-end="562.92">these two versus using address 2 to</span> <span data-start="562.92" data-end="564.449">perform the same functionality within</span> <span data-start="564.449" data-end="566.22">the scope of a single node.js process</span> <span data-start="566.22" data-end="567.48">and the latter approach the single</span> <span data-start="567.48" data-end="570.42">process approach was 30 times 32 times</span> <span data-start="570.42" data-end="573.69">faster and this is the similarly result</span> <span data-start="573.69" data-end="576.5">that you get across the three platforms</span> <span data-start="576.5" data-end="581.639">so CLR is you know c-sharp is largely</span> <span data-start="581.639" data-end="584.13">perceived as the kind of primary</span> <span data-start="584.13" data-end="586.8">language that CLR supports but just like</span> </p>
<p><span data-start="586.8" data-end="589.199">JVM see that support multiple languages</span> <span data-start="589.199" data-end="590.91">so address actually allows you to script</span> <span data-start="590.91" data-end="592.35">not only c-sharp but many other</span> <span data-start="592.35" data-end="595.35">languages so in here you can see an</span> <span data-start="595.35" data-end="597.949">async workflow expression in F sharp</span> <span data-start="597.949" data-end="600.24">there is integrated inside of a node.js</span> <span data-start="600.24" data-end="602.88">application this is Python using</span> <span data-start="602.88" data-end="605.899">ironpython implementation in top of CLR</span> <span data-start="605.899" data-end="608.88">this is power shell which is a scripting</span> <span data-start="608.88" data-end="612.42">language that only works in Windows and</span> <span data-start="612.42" data-end="615">lastly you can you can actually go and</span> <span data-start="615" data-end="617.269">implement your own languages or DSL</span> <span data-start="617.269" data-end="619.829">using the edge reyes extensibility</span> <span data-start="619.829" data-end="621.72">mechanism in this particular case I'm</span> <span data-start="621.72" data-end="624.779">actually scripting T sequel directly</span> <span data-start="624.779" data-end="628.5">from not Reyes the the baking</span> <span data-start="628.5" data-end="630.69">implementation is that that T sequel is</span> <span data-start="630.69" data-end="633.12">translated into a second extraction that</span> <span data-start="633.12" data-end="636.449">is passed to a do dotnet and that way</span> <span data-start="636.449" data-end="637.98">you can basically communicate with MS</span> <span data-start="637.98" data-end="640.05">sequel and fetch data from MS sequel in</span> <span data-start="640.05" data-end="642.089">a very easy way and arguably this is</span> <span data-start="642.089" data-end="646.17">actually the vastly superior way of</span> <span data-start="646.17" data-end="647.88">accessing a mythical data from not less</span> <span data-start="647.88" data-end="649.529">than any of the alternatives simply</span> <span data-start="649.529" data-end="651.48">because a do dotnet has been around for</span> <span data-start="651.48" data-end="652.279">over a decade</span> <span data-start="652.279" data-end="655.199">so predates anything that had been</span> <span data-start="655.199" data-end="656.85">created for not Reyes so the stable</span> <span data-start="656.85" data-end="659.91">tested and this is the de facto standard</span> <span data-start="659.91" data-end="663.93">of accessing I'm a sequel data from that</span> <span data-start="663.93" data-end="666.61">net</span> <span data-start="666.62" data-end="670.34">there are several ways you can pull in</span> </p>
<p><span data-start="670.34" data-end="672.24">CLR code into your knowledge race</span> <span data-start="672.24" data-end="674.79">application this is the kind of basic</span> <span data-start="674.79" data-end="677.28">primary mechanisms you pre-compiled your</span> <span data-start="677.28" data-end="679.23">sealer code into a minute assembly just</span> <span data-start="679.23" data-end="682.95">like you do a regular class library and</span> <span data-start="682.95" data-end="685.77">you call the h frank function and</span> <span data-start="685.77" data-end="687.48">provide assembly name type name and</span> <span data-start="687.48" data-end="689.61">method name that method of course must</span> <span data-start="689.61" data-end="691.41">have that prescriptive pattern that a</span> <span data-start="691.41" data-end="693.21">J's requires which is func object task</span> <span data-start="693.21" data-end="695.52">object but but from their own address</span> <span data-start="695.52" data-end="697.56">can basically create a JavaScript wrap</span> <span data-start="697.56" data-end="700.38">around that function call it the second</span> <span data-start="700.38" data-end="703.47">way is to actually provide a literal</span> <span data-start="703.47" data-end="705.57">code and there are three ways you can</span> <span data-start="705.57" data-end="707.04">provide that code either as a string</span> <span data-start="707.04" data-end="709.65">which is function of one you can do also</span> <span data-start="709.65" data-end="712.59">do a multi-line string the multi-line</span> <span data-start="712.59" data-end="716.16">string is a little hack I would say</span> <span data-start="716.16" data-end="718.44">because JavaScript definitely support</span> <span data-start="718.44" data-end="720.6">multi-line strings very well what I'm</span> <span data-start="720.6" data-end="723.6">doing here is I'm providing the edge</span> <span data-start="723.6" data-end="726.63">func function with an anonymous function</span> <span data-start="726.63" data-end="729.38">with a body that consists of a comment</span> <span data-start="729.38" data-end="732.84">it turns out that in v8 in particular if</span> <span data-start="732.84" data-end="735.09">you serialize such a function you'll</span> <span data-start="735.09" data-end="736.68">also get the body's he realized the</span> <span data-start="736.68" data-end="739.38">string so afterwards I'm I'm running a</span> <span data-start="739.38" data-end="741.21">simple regular expression to extract</span> <span data-start="741.21" data-end="743.43">that string compile it on the flight</span> <span data-start="743.43" data-end="745.92">when in memory CLR assembly and from</span> <span data-start="745.92" data-end="747.93">there own and three that wrapper the</span> </p>
<p><span data-start="747.93" data-end="751.92">JavaScript wrapper and F 3 you can</span> <span data-start="751.92" data-end="754.05">simply store your sealer coat in an</span> <span data-start="754.05" data-end="756.66">external cs5 and basically loaded up and</span> <span data-start="756.66" data-end="761.65">running</span> <span data-start="761.66" data-end="764.04">generally speaking CLR is a strongly</span> <span data-start="764.04" data-end="766.02">typed environment you'd expect all your</span> <span data-start="766.02" data-end="768.38">types to be to be declared upfront and</span> <span data-start="768.38" data-end="771">you'd have a class person with members</span> <span data-start="771" data-end="773.55">and so on however CLR also has a concept</span> <span data-start="773.55" data-end="777.18">of dynamics which allow you a way of</span> <span data-start="777.18" data-end="779.49">accessing data in a very similar way</span> <span data-start="779.49" data-end="781.38">that you'll be used to from loosely</span> <span data-start="781.38" data-end="783.87">typed environment like JavaScript so in</span> <span data-start="783.87" data-end="785.91">here we are constructing an input object</span> <span data-start="785.91" data-end="787.5">in JavaScript that has some nested</span> <span data-start="787.5" data-end="789.78">properties we are passing that input</span> <span data-start="789.78" data-end="792.09">object to the hello function which is</span> <span data-start="792.09" data-end="795.36">created via edge that funk and when you</span> <span data-start="795.36" data-end="798.85">look at how the data is accessed</span> <span data-start="798.85" data-end="801.339">within that async lambda expression is</span> <span data-start="801.339" data-end="804.16">actually with a simple dot dot dot line</span> <span data-start="804.16" data-end="806.86">and no types were required upfront you</span> <span data-start="806.86" data-end="808.449">can just dot your way into this data</span> <span data-start="808.449" data-end="814.99">structure using dynamics if you need to</span> <span data-start="814.99" data-end="816.459">write code that goes beyond a very</span> <span data-start="816.459" data-end="817.93">simple hello world you'll frequently</span> <span data-start="817.93" data-end="821.61">need to pull in extra assemblies or</span> <span data-start="821.61" data-end="824.76">namespaces so I borrowed some of the</span> <span data-start="824.76" data-end="827.35">syntax from Rosalie in the new C shop</span> <span data-start="827.35" data-end="830.29">compiler to allow you to actually plug</span> <span data-start="830.29" data-end="833.589">in by reference new new assemblies like</span> <span data-start="833.589" data-end="835.389">system data DLL if you want to use ad or</span> <span data-start="835.389" data-end="837.67">dotnet and using statements that are</span> <span data-start="837.67" data-end="839.74">kind of out of bound of a class I would</span> <span data-start="839.74" data-end="843.399">say so you know these these declarations</span> <span data-start="843.399" data-end="845.26">can be directly followed by an async</span> <span data-start="845.26" data-end="848.41">lambda expression without that markup</span> <span data-start="848.41" data-end="854.92">surrounding a class you can pass pretty</span> <span data-start="854.92" data-end="856.899">much any kind of data from JavaScript to</span> </p>
<p><span data-start="856.899" data-end="859.36">CLR a J's takes care of marshaling all</span> <span data-start="859.36" data-end="861.22">the basic data datatypes from ins</span> <span data-start="861.22" data-end="864.13">boolean strings to objects arrays and</span> <span data-start="864.13" data-end="869.17">buffer similarly you can pass very</span> <span data-start="869.17" data-end="871.81">similar data structures from CLR back to</span> <span data-start="871.81" data-end="874.6">not JSON returning the value all</span> <span data-start="874.6" data-end="877.87">civilization or isolation on marshalling</span> <span data-start="877.87" data-end="880.12">between the eight and CLR is done by</span> <span data-start="880.12" data-end="882.699">value so the moment you call that</span> <span data-start="882.699" data-end="884.5">function or the moment you return from</span> <span data-start="884.5" data-end="887.26">that function a copy of the data is</span> <span data-start="887.26" data-end="889.72">created either in v8 heap or CLR heap</span> <span data-start="889.72" data-end="891.85">and from there on the data lives in the</span> <span data-start="891.85" data-end="893.079">independently it has independent</span> <span data-start="893.079" data-end="896.98">lifetime so if you go and manipulate the</span> <span data-start="896.98" data-end="899.5">value of an array that you have passed</span> <span data-start="899.5" data-end="901.6">from one side to the other it won't have</span> <span data-start="901.6" data-end="904.72">any effect on the value of that array in</span> <span data-start="904.72" data-end="908.56">the other environment another the most</span> <span data-start="908.56" data-end="911.769">exciting marshalling feature that</span> <span data-start="911.769" data-end="913.149">address provides is actually the ability</span> <span data-start="913.149" data-end="916.089">to marshal functions so in addition to</span> <span data-start="916.089" data-end="917.949">marshaling basic data types you can also</span> <span data-start="917.949" data-end="921.029">marshal back a function as long as it</span> <span data-start="921.029" data-end="923.529">corresponds to the basic interrupt</span> <span data-start="923.529" data-end="925.72">pattern that address requires so in here</span> <span data-start="925.72" data-end="929.22">we can see an async lambda expression</span> <span data-start="929.22" data-end="930.85">that return</span> <span data-start="930.85" data-end="934.48">another async lambda expression back to</span> <span data-start="934.48" data-end="938.11">no js' when cold so when we are calling</span> <span data-start="938.11" data-end="939.31">that Creed hello function which</span> <span data-start="939.31" data-end="940.99">corresponds to the outer async lambda</span> <span data-start="940.99" data-end="944.11">expression it returns a low function</span> <span data-start="944.11" data-end="946.72">that we can later call now the reason</span> <span data-start="946.72" data-end="948.58">this is interesting is that it actually</span> <span data-start="948.58" data-end="951.31">allows you to manipulate manipulate</span> <span data-start="951.31" data-end="954.25">durable CLR state if you look at this</span> <span data-start="954.25" data-end="959.08">example we have a create counter</span> <span data-start="959.08" data-end="961.63">function this is the outer isn't lambda</span> <span data-start="961.63" data-end="964.3">expression and we are calling it</span> <span data-start="964.3" data-end="966.55">providing a value of 12 as an input</span> <span data-start="966.55" data-end="969.28">parameter the first thing it does is</span> <span data-start="969.28" data-end="971.26">actually storing that value of 12 in a</span> <span data-start="971.26" data-end="974.02">local Kay variable and then it is</span> <span data-start="974.02" data-end="975.94">returning an async lambda expression</span> <span data-start="975.94" data-end="978.19">which is implemented as a closure over</span> <span data-start="978.19" data-end="980.98">that local state and as you see the</span> <span data-start="980.98" data-end="982.6">implementation of that closure we are</span> <span data-start="982.6" data-end="985.42">basically increasing that local value of</span> </p>
<p><span data-start="985.42" data-end="988.63">K so we have just created a counter and</span> <span data-start="988.63" data-end="990.46">whenever we call that counter method</span> <span data-start="990.46" data-end="992.11">which is switch corresponds to that</span> <span data-start="992.11" data-end="996.49">inner function the value of K on the CLR</span> <span data-start="996.49" data-end="999.43">sight will get increased despite the</span> <span data-start="999.43" data-end="1001.47">fact that that variable is not directly</span> <span data-start="1001.47" data-end="1004.23">exposed to no js' so you can extend that</span> <span data-start="1004.23" data-end="1007.11">concept really exposing entire object</span> <span data-start="1007.11" data-end="1010.29">hierarchies from CLR to Drai's but K</span> <span data-start="1010.29" data-end="1012.21">could this will be an instance of a</span> <span data-start="1012.21" data-end="1015.6">person with many methods on it and what</span> <span data-start="1015.6" data-end="1017.91">you could return from that outer async</span> <span data-start="1017.91" data-end="1020.67">lambda expression is an anonymous object</span> <span data-start="1020.67" data-end="1022.74">with a number of functions that perform</span> <span data-start="1022.74" data-end="1025.59">a variety of tasks over that person is</span> <span data-start="1025.59" data-end="1030.09">nice so similarly to exporting a</span> <span data-start="1030.09" data-end="1032.73">function from CLR to not jsut can also</span> <span data-start="1032.73" data-end="1035.49">export a function from not rest to CLR</span> <span data-start="1035.49" data-end="1038.07">so in here we basically construct a</span> <span data-start="1038.07" data-end="1041.51">payload object that contains two basic</span> <span data-start="1041.51" data-end="1045.42">atomic data entries as well as a</span> <span data-start="1045.42" data-end="1049.08">property which is a function i call it x</span> <span data-start="1049.08" data-end="1051">two because all it does it takes an</span> <span data-start="1051" data-end="1052.74">input and multiplies it by two and cause</span> <span data-start="1052.74" data-end="1054.93">the callback without value so later on</span> <span data-start="1054.93" data-end="1058.08">when you pass that payload object to the</span> <span data-start="1058.08" data-end="1060.6">function created around some c-sharp</span> <span data-start="1060.6" data-end="1063.8">code you can extract the dot time</span> <span data-start="1063.8" data-end="1066.14">- method and cast it to that funk object</span> <span data-start="1066.14" data-end="1068.45">ask object delegate that a J's has</span> <span data-start="1068.45" data-end="1070.88">created around it so this is just again</span> <span data-start="1070.88" data-end="1073.88">a proxy around a JavaScript function</span> <span data-start="1073.88" data-end="1077.33">that lives in v8 and you can since this</span> <span data-start="1077.33" data-end="1080.45">is the the return type that function is</span> <span data-start="1080.45" data-end="1082.88">task object you can call it using the</span> <span data-start="1082.88" data-end="1085.55">very convenient a weight keyword in the</span> <span data-start="1085.55" data-end="1089.72">net framework which is basically like</span> <span data-start="1089.72" data-end="1091.76">yield from in Python which basically</span> <span data-start="1091.76" data-end="1097.15">doesn't block the the current thread and</span> <span data-start="1097.15" data-end="1099.74">still allows you to write asynchronous</span> <span data-start="1099.74" data-end="1101.6">programs that have the look and feel of</span> <span data-start="1101.6" data-end="1107.06">a synchronous application one other</span> <span data-start="1107.06" data-end="1109.67">exciting feature of edge is is the</span> <span data-start="1109.67" data-end="1111.59">ability to tap onto multi-threading in</span> </p>
<p><span data-start="1111.59" data-end="1116.47">CLR so the moment you call a function in</span> <span data-start="1116.47" data-end="1119.03">via AJ as a function in CLR you are</span> <span data-start="1119.03" data-end="1121.52">still executing on a v8 thread so if you</span> <span data-start="1121.52" data-end="1123.71">do anything blocking there you are not</span> <span data-start="1123.71" data-end="1125.09">race event loop will be blocked</span> <span data-start="1125.09" data-end="1126.68">however in CLR you have the option to</span> <span data-start="1126.68" data-end="1128.81">actually spin up a new CLR a thread pool</span> <span data-start="1128.81" data-end="1131">thread and perform some long-running</span> <span data-start="1131" data-end="1132.95">operation there so the equivalent of</span> <span data-start="1132.95" data-end="1134.33">that long-running operation here is a</span> <span data-start="1134.33" data-end="1136.07">task delay we are basically waiting for</span> <span data-start="1136.07" data-end="1138.17">five seconds but since we are doing that</span> <span data-start="1138.17" data-end="1140.36">waiting on a CLR thread pool thread the</span> <span data-start="1140.36" data-end="1141.65">single don't be it threat remains</span> <span data-start="1141.65" data-end="1143.84">unblocked and you're not jeaious event</span> <span data-start="1143.84" data-end="1145.97">loop is capable of accepting subsequent</span> <span data-start="1145.97" data-end="1150.53">processing subsequent requests I was</span> <span data-start="1150.53" data-end="1152.57">supposed to be an outbreak but we're out</span> <span data-start="1152.57" data-end="1155.03">of time so what we can build with this</span> <span data-start="1155.03" data-end="1157.25">zip compression zip compression is an</span> <span data-start="1157.25" data-end="1159.02">example we kind of lightweight CPU bound</span> <span data-start="1159.02" data-end="1161.24">operation you can't do that very easily</span> <span data-start="1161.24" data-end="1163.01">right now with node.js you have to spin</span> <span data-start="1163.01" data-end="1165.32">up an external process with a Jas you</span> <span data-start="1165.32" data-end="1167.09">can do it in process literally with a</span> <span data-start="1167.09" data-end="1168.95">single line of code because dotnet</span> <span data-start="1168.95" data-end="1170.03">framework support zip compression</span> <span data-start="1170.03" data-end="1174.59">they're very kind of usable API same</span> <span data-start="1174.59" data-end="1176.75">thing with image conversion dotnet has a</span> <span data-start="1176.75" data-end="1178.34">very rich</span> <span data-start="1178.34" data-end="1181.22">image processing capabilities you can</span> <span data-start="1181.22" data-end="1183.53">convert images between PNG and JPEG with</span> <span data-start="1183.53" data-end="1186.02">a literally a single API call but again</span> <span data-start="1186.02" data-end="1187.7">this is a CPU bound operation so you</span> <span data-start="1187.7" data-end="1189.59">would normally do it from from within</span> <span data-start="1189.59" data-end="1191.54">your node.js application even if you had</span> <span data-start="1191.54" data-end="1195.17">an API for it with edge you can run that</span> <span data-start="1195.17" data-end="1196.79">logic on a silver thread pool thread</span> <span data-start="1196.79" data-end="1197.639">without blocking the</span> <span data-start="1197.639" data-end="1200.879">dress event loop you can skip the sequel</span> <span data-start="1200.879" data-end="1202.469">we've been talking about it if you want</span> <span data-start="1202.469" data-end="1204.479">to go beyond the basic crud crud</span> <span data-start="1204.479" data-end="1207.719">capability David knew has actually</span> <span data-start="1207.719" data-end="1209.459">created a great article showing how to</span> <span data-start="1209.459" data-end="1211.109">call like stored procedures use</span> <span data-start="1211.109" data-end="1214.079">transactions around a sequel using edge</span> <span data-start="1214.079" data-end="1218.279">and a do dotnet similarly you can this</span> <span data-start="1218.279" data-end="1219.539">is a very interesting concept that's</span> <span data-start="1219.539" data-end="1221.129">kind of pushing it you can have an</span> <span data-start="1221.129" data-end="1223.32">express race application that subdivides</span> <span data-start="1223.32" data-end="1225.809">the URL space were part of that space is</span> <span data-start="1225.809" data-end="1227.849">handled by nodejs and part is handled by</span> <span data-start="1227.849" data-end="1232.639">dotnet that not actually defines an</span> <span data-start="1232.639" data-end="1235.049">interface very similar conceptually to</span> </p>
<p><span data-start="1235.049" data-end="1239.389">WS di in Python which called Owen which</span> <span data-start="1239.389" data-end="1241.829">allows you to write applications the</span> <span data-start="1241.829" data-end="1243.629">kind of web applications that are</span> <span data-start="1243.629" data-end="1244.829">abstracted away from the underlying</span> <span data-start="1244.829" data-end="1248.459">server and Bruno bias created an</span> <span data-start="1248.459" data-end="1250.549">extension of a Jas that allows you to</span> <span data-start="1250.549" data-end="1252.629">take these applications that and</span> <span data-start="1252.629" data-end="1255.389">applications and plug them into the edge</span> <span data-start="1255.389" data-end="1260.579">the Express Reyes pipeline you can also</span> <span data-start="1260.579" data-end="1262.559">call legacy job services there isn't</span> <span data-start="1262.559" data-end="1264.329">really a very good library in Andres for</span> <span data-start="1264.329" data-end="1265.709">calling soap simply because that</span> <span data-start="1265.709" data-end="1267.719">technology largely predates the</span> <span data-start="1267.719" data-end="1269.82">development of node that meant framework</span> <span data-start="1269.82" data-end="1271.739">has a very rich sub capabilities in the</span> <span data-start="1271.739" data-end="1272.849">form of windows communication foundation</span> <span data-start="1272.849" data-end="1276.419">so you can use that legacy services and</span> <span data-start="1276.419" data-end="1277.679">lastly I wanted to mention something</span> <span data-start="1277.679" data-end="1280.589">completely different if you if you</span> <span data-start="1280.589" data-end="1282.239">recall the basic interrupt pattern</span> <span data-start="1282.239" data-end="1286.139">between nod Reyes and CLR it is very</span> <span data-start="1286.139" data-end="1287.999">much symmetric it basically allows you</span> <span data-start="1287.999" data-end="1290.309">to call functions from one side to the</span> <span data-start="1290.309" data-end="1292.2">other export functions both ways and so</span> <span data-start="1292.2" data-end="1295.019">on so just as you can scrape the CLR</span> <span data-start="1295.019" data-end="1297.479">from node Reyes you can also script</span> <span data-start="1297.479" data-end="1301.619">node.js from CLR so so basically this</span> <span data-start="1301.619" data-end="1304.2">actually required compiling node.js as a</span> <span data-start="1304.2" data-end="1306.57">shared library rather than an executable</span> <span data-start="1306.57" data-end="1307.919">which is a standard distribution</span> <span data-start="1307.919" data-end="1309.929">mechanism but at this point you can</span> <span data-start="1309.929" data-end="1314.07">basically take no js' with a 70,000 NPM</span> <span data-start="1314.07" data-end="1316.619">modules and you know do things like run</span> <span data-start="1316.619" data-end="1318.629">connect middle word inside of asp net</span> <span data-start="1318.629" data-end="1322.049">around expressjs rendering engines in</span> <span data-start="1322.049" data-end="1327.209">asp net 2 and this is it so high level</span> <span data-start="1327.209" data-end="1329.19">basically address does it run</span> </p>
<p><span data-start="1329.19" data-end="1331.38">CLR a no dress code in one process</span> <span data-start="1331.38" data-end="1334.65">it is faster than having to processes it</span> </p>
</section>