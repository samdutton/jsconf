<section>
<p><span data-start="1.64" data-end="7.41">(Phillip Roberts) Hi everyone, come in and sit down. The last meeting in the afternoon.</span> <span data-start="7.41" data-end="12.82">Be quiet The speaker was Phillip Roberts, who worked in Scotland and drove over from London.</span> <span data-start="12.82" data-end="17.88">What Phillip is going to talk about is the event loop.</span> <span data-start="17.88" data-end="18.599">Please applaud Philip</span> <span data-start="18.599" data-end="20.939">Hello everyone, thank you very much for being able to speak on the platform, this is great</span> </p>
<p><span data-start="20.939" data-end="27.939">Can you allow me to stretch myself, I need to stretch it so that I don't look so weird</span> <span data-start="27.989" data-end="34.989">I want to talk about the event loop, what exactly is the event loop</span> <span data-start="35.149" data-end="42.149">As a JavaScript event loop. First, like he said, I work at Andyet</span> <span data-start="43.329" data-end="50.16">Andyet is a great little software company in the United States. If you need help developing some real-time applications, you can consider us</span> <span data-start="50.16" data-end="57.16">That's what we are good at. About 18 months ago, I was a professional JavaScript developer</span> <span data-start="58.35" data-end="65.35">I started thinking about how JavaScript actually works</span> <span data-start="65.5" data-end="71.759">I don't fully understand. I've heard that V8 is the JavaScript runtime environment in Chrome, but I don't know what it is and what it does</span> <span data-start="71.759" data-end="76.689">I've heard of single threading and it's clear that I'm using callback functions.</span> <span data-start="76.689" data-end="82.689">How does the callback function work? I started to do some reading,</span> <span data-start="82.689" data-end="85.979">I also did some experiments in the browser, which was probably the beginning.</span> <span data-start="85.979" data-end="92.979">My feeling at that time was, what exactly is JavaScript? The answer looks like this: "JavaScript is a single-threaded, non-blocking, asynchronous, interpreted scripting language"</span> <span data-start="93.86" data-end="99.899">Right, very cool. "I have a call stack, an event loop,</span> </p>
<p><span data-start="99.899" data-end="105.86">Callback queues and some other APIs. "OK, I don't have a computer science degree</span> <span data-start="105.86" data-end="111.42">What I want to say is that these terms are professional terms. I've heard of V8 and other operating environments and different browsers</span> <span data-start="111.42" data-end="115.869">So I want to ask V8: "Do you have call stacks, event loops, callback queues, and other APIs?"</span> <span data-start="115.869" data-end="120.299">"I have a call stack and heap and I don't know what else is"</span> <span data-start="120.299" data-end="127.299">Okay, it's fun. Well, 18 months have passed and I think I understand now</span> <span data-start="132.55" data-end="136.65">(Laughter) These are the things I want to share with you today. hope</span> <span data-start="136.65" data-end="142.76">This can help people who have a relatively short exposure to JavaScript understand why JavaScript is so weird</span> <span data-start="142.76" data-end="147.34">When you compare other languages, you may not understand why callbacks are a disaster but still introduced</span> <span data-start="147.34" data-end="152.97">If you are a experienced JavaScript developer, I hope to be able to</span> <span data-start="152.97" data-end="158.06">Let you gain some new insights into the runtime environment of JavaScript, so that you can think more carefully about it</span> <span data-start="158.06" data-end="165.06">So if we look at the environment in which JavaScript runs. For example V8, V8 is the JavaScript runtime environment in Chrome</span> </p>
<p><span data-start="166.9" data-end="173.9">This is a schematic diagram of the JavaScript runtime environment. Heap records memory allocation</span> <span data-start="177.31" data-end="184.069">Then there is the call stack, this is where things like frames are located</span> <span data-start="184.069" data-end="191.069">But if you clone the V8 code, then</span> <span data-start="191.489" data-end="197.989">When searching for setTimeout or DOM, HTTP requests are not in them</span> <span data-start="197.989" data-end="204.43">They don't exist in the V8 engine, I'm surprised by this. When you want to program asynchronously, these are the things you first consider using</span> <span data-start="204.43" data-end="211.43">But they don't exist in the source code of V8?唔 . very interesting. Well, these 18 months of exploration</span> <span data-start="212.45" data-end="216.819">I started to realize that this is an extremely important part</span> <span data-start="216.819" data-end="221.95">I hope you all understand what these parts are today</span> <span data-start="221.95" data-end="226.78">The first is the V8 operating environment, then the other things provided by the browser</span> <span data-start="226.78" data-end="233.22">Called web APIs, DOM, AJAX, setTimeout, and so on, and then mysterious</span> <span data-start="233.22" data-end="238.439">Event loop and callback queue. I'm sure you have heard these terms beforehand</span> </p>
<p><span data-start="238.439" data-end="243.43">But you don't necessarily understand how these parts fit together. Well,</span> <span data-start="243.43" data-end="247.989">I will start by explaining these terms. Maybe some people do n’t know, some people may know.</span> <span data-start="247.989" data-end="253.22">We go through it quickly, and it's clear that some people need to endure for a while</span> <span data-start="253.22" data-end="258.7">But I guess most people won't. Well, JavaScript is a single-threaded programming language</span> <span data-start="258.7" data-end="264.66">Single-threaded running environment, it has one and only one call stack, it can only do one thing at a time</span> <span data-start="264.66" data-end="270.58">This means single-threaded, the program can only run one piece of code at a time</span> <span data-start="270.58" data-end="275.13">So let's try to visualize what we just said</span> <span data-start="275.13" data-end="280.72">If I have some code like this on your left, we have some functions</span> <span data-start="280.72" data-end="286.11">A function that multiplies two numbers by multiply, and one that calls the square function of the former, square</span> <span data-start="286.11" data-end="290.92">A print function printSquare that calls square and prints the results using console.log</span> <span data-start="290.92" data-end="295.97">Then at the end we called printSquare. These codes look all right</span> <span data-start="295.97" data-end="302.97">OK, so let's run it. Call stack basically</span> </p>
<p><span data-start="304.44" data-end="308.66">A data structure that records the location of the current program.</span> <span data-start="308.66" data-end="312.8">Some function is put on the stack. If a function is currently left</span> <span data-start="312.8" data-end="318.62">This function will be popped off the stack, which is what the stack does. If you run this file</span> <span data-start="318.62" data-end="323.47">There will be a function similar to main, which refers to the file itself, we first put it on the stack</span> <span data-start="323.47" data-end="328.45">Then we look at the declared functions from top to bottom</span> <span data-start="328.45" data-end="332.77">Finally, printSquare, OK, we know that printSquare is called, so we</span> <span data-start="332.77" data-end="337.71">Pushed it on the stack, and then it called square, so it pushed it on the stack too</span> <span data-start="337.71" data-end="343.94">square also calls multiply and also pushes it onto the stack. Finally we got the return value of multiply</span> <span data-start="343.94" data-end="348.99">We popped multiply from the stack, then square got the return value, and popped square from the stack.</span> <span data-start="348.99" data-end="355.99">Finally to printSquare, it called console.log. There is no return value here.</span> <span data-start="357.04" data-end="361.68">We reached the last part of the function, and then we were done. This is a visual call stack</span> <span data-start="361.68" data-end="368.68">Can this be understood? (Yes, Phil) Good, then if you haven't heard about the call stack before</span> </p>
<p><span data-start="369.76" data-end="375.4">Now you know, when you are doing website development on the browser side,</span> <span data-start="375.4" data-end="380.24">If you run this code in Chorme, the baz function calls the bar function, and the bar function calls the foo function.</span> <span data-start="380.24" data-end="387.24">The foo function throws an error, we see that it will be like this</span> <span data-start="389.4" data-end="396.4">It prints the entire stack tree, the errors start from foo, to bar, to baz, to anonymous functions</span> <span data-start="398.05" data-end="405.05">That is to say the main function. Similarly, if you've heard terms like memory leaks</span> <span data-start="405.15" data-end="411.82">This is one example, what happens if we have a function foo that calls itself</span> </p>
<p><span data-start="411.82" data-end="418.82">We have a function that calls foo, and foo calls foo, and so on.</span> <span data-start="418.9" data-end="425.19">In the end Chrome will say, "You probably don't want to call it yourself 16,000 times"</span> <span data-start="425.19" data-end="431.34">"I terminated it for you so you can find where the bug is." OK</span> <span data-start="431.34" data-end="436.58">I may show you a call stack, and you may have noticed it while developing</span> <span data-start="436.58" data-end="442.77">Well, now there are some bigger problems.</span> <span data-start="442.77" data-end="449.77">What makes programs run slower? So let's talk about blocking</span> <span data-start="450.24" data-end="455.83">There is no strict definition of what is blocking and what is not blocking. It simply means that the code runs very slowly</span> <span data-start="455.83" data-end="461.23">For example, console.log is not slow, traversing from 1 to 1 billion is very slow, and network requests are very slow</span> <span data-start="461.23" data-end="468.23">Downloading pictures is also slow. Anything that performs very slowly on the stack is called blocking.</span> <span data-start="469.08" data-end="476.08">Here is a small example, let's say we have some pseudocode like this</span> <span data-start="477.04" data-end="484.04">Just like jQuery's AJAX request</span> <span data-start="484.61" data-end="490.16">If you don't add callback functions to AJAX requests, they will be synchronous</span> </p>
<p><span data-start="490.16" data-end="496.19">If we run it, first call getSync, then we are waiting . because</span> <span data-start="496.19" data-end="501.94">We are making network requests. Network requests are slow compared to the computer local, then</span> <span data-start="501.94" data-end="508.94">We will not proceed until the request is completed. Then continue to wait and continue. What i want to say is</span> <span data-start="512.58" data-end="519.18">These requests may never end, so .. well I can't wait to go home. it is finally over</span> <span data-start="519.18" data-end="525.84">When all this is done, the stack is cleared. Then if a programming language is single-threaded</span> <span data-start="525.84" data-end="530.87">For example ruby, the situation just happened. Ok we</span> <span data-start="530.87" data-end="536.35">To request a resource, we have to wait for the request to finish because there is no way</span> <span data-start="536.35" data-end="543.35">So what's wrong with this? The problem is that our code is running on the browser</span> <span data-start="544.36" data-end="551.36">So let's get started .. OK, this is Chrome</span> <span data-start="553.39" data-end="559.48">This is the code just run</span> <span data-start="559.48" data-end="564.38">I faked this with a while loop because it is synchronous and wants</span> <span data-start="564.38" data-end="571.38">Loop for five seconds before I can continue if I open the console here. We can see that</span> </p>
<p><span data-start="574.2" data-end="580.89">What happens, is requesting foo.com, why is this happening, I can't do anything, right,</span> <span data-start="580.89" data-end="585.49">Even the run button hasn't finished re-rendering when I click on it. Browser is</span> <span data-start="585.49" data-end="591.92">Blocked, it's stuck, it can't do anything until these requests are completed. And then all</span> <span data-start="591.92" data-end="596.03">Something popped up because I did some operations before and it understands that I've done it but it can't</span> <span data-start="596.03" data-end="603.03">Actually render. It cannot do anything. That's because if there is something in the call stack</span> <span data-start="603.96" data-end="610.84">Then here it is. Yes, it is still running. We have figured out the synchronization request,</span> <span data-start="610.84" data-end="615.7">Browsers can't do anything else right now. It cannot render, it cannot run any other code, it</span> <span data-start="615.7" data-end="620.49">its stuck. Not surprisingly, right. If we want people to have beautiful and smooth user interfaces, we can't block</span> <span data-start="620.49" data-end="627.49">Call stack. So, what should we do? Our easiest way is to provide asynchronous callbacks</span> </p>
<p><span data-start="627.62" data-end="634.62">There are almost no blocking functions in the browser, and the same is true in node, they are all</span> <span data-start="635.48" data-end="640.1">Is an asynchronous function, which basically means we run some code and give it a callback function</span> <span data-start="640.1" data-end="645.34">And run it later, if you've seen JavaScript code you've seen these asynchronous callbacks, this</span> <span data-start="645.34" data-end="652.34">What does it actually look like? Here are some simple examples to show where we have run. Code like this, console.log output</span> <span data-start="652.73" data-end="659.73">Hi, right. We run setTimeout, but we put console.log in the queue and run it later, so we skip</span> <span data-start="660.25" data-end="667.25">And run JSConf here, and then 5 seconds later, we output "there", right. Got it? Happy. basically</span> <span data-start="667.62" data-end="673.29">This is what setTimeout does. So, asynchronous callback with greeting to</span> <span data-start="673.29" data-end="680.29">We used to see chimneys .. how does it work? Let's run the code. CONSOLE.LOG Hi. setTimeout.</span> <span data-start="682.54" data-end="688.37">We know it wo n’t run immediately, we know it will run in five seconds, we</span> <span data-start="688.37" data-end="694.07">Ca n’t be pushed onto the stack, somehow, just after disappearing, we have no way like</span> <span data-start="694.07" data-end="701.07">Describe this, but we will come to it. We log in to JSConfEU, clear, after 5 seconds</span> <span data-start="701.19" data-end="708.19">Somehow magically "exists" appearing on the stack. How did it happen? This is-this</span> </p>
<p><span data-start="709.49" data-end="716.42">Basically, where the event loop comes in for concurrency. Yes, so I always have</span> <span data-start="716.42" data-end="720.05">The part is lying to you and telling you that JavaScript can only do one thing at a time.</span> <span data-start="720.05" data-end="724.15">It is true that the JavaScript runtime can only do one thing at a time. It cannot make a</span> <span data-start="724.15" data-end="728.51">AJAX requests while you are doing other code. And you are doing setTimeout which it cannot do</span> <span data-start="728.51" data-end="733.44">Another code. The reason we can do it is because there are so many browsers</span> <span data-start="733.44" data-end="738.57">Just when running. So, remember this diagram, one thing the JavaScript runtime can do</span> <span data-start="738.57" data-end="742.88">For a while, the browser gave us these other things, gave us these APIs we wanted, these</span> </p>
<p><span data-start="742.88" data-end="749.88">Is a valid thread, you can just make the call and the browser that piece</span> <span data-start="749.97" data-end="755.04">Everyone knows in this concurrent kick. If you look at this person</span> <span data-start="755.04" data-end="762.04">Basically the same node, not the network. Our API has a C ++ API and threads are</span> <span data-start="762.19" data-end="769.19">By C ++ is hidden from you. Now we have this picture let's see how to run this code</span> <span data-start="771.21" data-end="777.99">The fuller look of the browser looks like. So, as before, run the code, console</span> <span data-start="777.99" data-end="784.99">Login hi, hi login to console, concise. Now we can see what happens when we call it setTimeout.</span> <span data-start="785.029" data-end="792.029">We-we pass this callback function and delay, setTimeout is called. SetTimeout now</span> </p>
<p><span data-start="792.61" data-end="797.76">Is an API browser provided to us, it does not live on V8 sources, which is redundant</span> <span data-start="797.76" data-end="802.63">We stuff get our javascript running</span> <span data-start="802.63" data-end="809.6">time. Browser kicks off your timer. Now it has to deal with numbers</span> <span data-start="809.6" data-end="815.23">Down yours, right, so that means our call to setTimeout, itself is now complete, so we can pop it up</span> <span data-start="815.23" data-end="822.23">Stack. "JSConfEU", clear, so now we have this timer in Web API, it</span> <span data-start="824.839" data-end="830.67">It will finish in 5 seconds. Now the web API can't just start modifying your</span> <span data-start="830.67" data-end="835.41">Code, it ca n’t chuck something onto the stack when it is ready, if it does n’t it will appear</span> <span data-start="835.41" data-end="840.22">Randomly in the middle of your code so this is the task queue or callback queue</span> <span data-start="840.22" data-end="847.22">Kick, any network API pushes a callback to the task queue when it's done. At last</span> <span data-start="848.27" data-end="853.43">The event loop we get, the topic of the speech, what exactly is the event loop like</span> <span data-start="853.43" data-end="859.15">The simplest kind of piece is in this whole equation, and it has a very simple job.</span> <span data-start="859.15" data-end="863.16">The job of this event loop is to look at the stack and look in the task queue. If the stack</span> <span data-start="863.16" data-end="867.57">Empty it takes the first thing in the queue and pushes it onto the stack to effectively</span> <span data-start="867.57" data-end="874.18">run. So here we can see that the stack now obviously has a callback in the task queue,</span> <span data-start="874.18" data-end="879.62">When the event loop runs, it says, oh, I'll do something and push to the callback</span> </p>
<p><span data-start="879.62" data-end="885.18">Stacked. Remember its stack like JavaScript land, back to the house V8, callback will appear</span> <span data-start="885.18" data-end="892.18">Run on the stack, execute console.log "there" and we're done. Does that make sense? everyone</span> <span data-start="892.74" data-end="899.74">Where am I? Awesome! Ok. So now we can see how this works it could be the first</span> <span data-start="899.81" data-end="904.47">Confrontation you have had with asynchronous things which for some strange reason someone said</span> <span data-start="904.47" data-end="911.06">You want to call setTimeout to zero,-well, you want me to run the zero function</span> <span data-start="911.06" data-end="914.779">time? Why would I wrap it in a setTimeout? The first time you run across this piece, if</span> <span data-start="914.779" data-end="921.779">You are like me, I see what it is doing, but I don't know why. The reason is that, generally,</span> <span data-start="921.97" data-end="926.839">If you want to postpone things to the stack is clear. So we know that we are watching</span> <span data-start="926.839" data-end="929.5">This, if you write JavaScript, then we will see the same result, we want to</span> <span data-start="929.5" data-end="936.279">Look at "hi", "JSConf" and "there" will appear at the end. We can see that</span> </p>
<p><span data-start="936.279" data-end="941.75">How does this happen. The setTimeout is zero and now it will push to completion immediately</span> <span data-start="941.75" data-end="946.19">It goes to the queue, remember I said the event loop, it has to wait until the stack</span> <span data-start="946.19" data-end="951.24">Very clear before you can push the callback stack so your stack will continue</span> <span data-start="951.24" data-end="958.24">Run, execute console.log "hi", "jsconfeu" and clear, now the event loop can kick</span> <span data-start="958.339" data-end="965.339">And call the callback function. This is like an example of setTimeout being zero, and execution was delayed</span> <span data-start="966.36" data-end="973.36">The code, for whatever reason, ends at the stack. Or until the stack is clear. Ok.</span> <span data-start="974.73" data-end="981.48">So all these web APIs work the same way, if we have an AJAX request, we make an AJAX request</span> <span data-start="981.48" data-end="988.48">Using a callback URL, works the same way like this, oops sorry, console log, "hi" so that</span> </p>
<p><span data-start="988.48" data-end="992.649">An AJAX request, running this code AJAX request does not live in JavaScript</span> <span data-start="992.649" data-end="999.649">But the Web API in the browser, so we rotate it with the callback in the URL, your code</span> <span data-start="1000.12" data-end="1005.92">Can continue to run. Before that, after the XHR request is completed, or it may never be complete, this is</span> <span data-start="1005.92" data-end="1011.339">Fortunately, the stack can continue to run. Assuming it is finished, it is pushed to the queue and picked.</span> <span data-start="1011.339" data-end="1018.339">YoY event loop, it runs. This is where everything happens when an asynchronous call occurs.</span> </p>
<p><span data-start="1018.36" data-end="1025.36">Let's make a crazy complicated example, I hope this goes to work if you haven't realized</span> <span data-start="1025.6" data-end="1032.449">It's all in the theme there are 500 animation steps like this I did not know throughout this entire deck.</span> <span data-start="1032.449" data-end="1039.449">(Code blows up, flame animation) (Applause) Hmm .. no .. so .. funny, we</span> <span data-start="1055.179" data-end="1062.179">Give a link. Hmm .. it's big enough that others will see? Ok, so basically i wrote</span> <span data-start="1064.17" data-end="1071.17">This time talking to Scottish JS, I will say later that I broke half of the slide and ca n’t</span> <span data-start="1072.84" data-end="1077.29">Disdain to redo all the slides because it suffers ass in the keynote</span> <span data-start="1077.29" data-end="1084.29">Do it, so I took the much easier route (laughs) and write a tool that can visualize JavaScript</span> <span data-start="1086.75" data-end="1093.75">When the runtime environment is running, it is called a loop. So let's just run this example and where</span> </p>
<p><span data-start="1095.09" data-end="1100.9">Is the kind that we have to have a slide in this example, I have n’t evened XHR yet,</span> <span data-start="1100.9" data-end="1105.9">It works, I just haven't done it yet. As you can see in the code, we want to record something,</span> <span data-start="1105.9" data-end="1112.9">This is the gasket around addEventListener, setTimeout and we are going to make a console.log. -</span> <span data-start="1113.559" data-end="1120.179">I'm going to run it and see what happens and so on .. Add DOM API, add a timeout, code</span> <span data-start="1120.179" data-end="1127.179">To continue running, push the callback to run in it, and we're done in the queue.</span> <span data-start="1129.29" data-end="1134.97">If I click here, then it will trigger .. Network API, queue click callback</span> <span data-start="1134.97" data-end="1141.78">And run it. If I cluck a hundred times we can see what happens. I click, click</span> <span data-start="1141.78" data-end="1146.29">Not get processed immediately, itself is pushed to the queue, such as queue get</span> </p>
<p><span data-start="1146.29" data-end="1152.71">After processing, my click is finally processed, right. So, I have a few</span> <span data-start="1152.71" data-end="1159.71">For example, I want to run through here. Here we go, ok, so i just have to run through</span> <span data-start="1164.5" data-end="1171.429">A few examples are just a way to talk that you may already be running, there are several things</span> <span data-start="1171.429" data-end="1177.22">Haven't thought about the asynchronous API, in this example we call it four times the setTimeout</span> <span data-start="1177.22" data-end="1184.22">With said a second delay, and console.log "hi". Get queued by the callback at the time ..</span> <span data-start="1189.61" data-end="1194.47">This fourth callback, we are asking for a one second delay and it is still waiting for the callback</span> <span data-start="1194.47" data-end="1196.9">It's not running yet, right?</span> <span data-start="1196.9" data-end="1202.47">This illustrates-like what time out exactly what it is doing, this is not a guarantee</span> <span data-start="1202.47" data-end="1206.88">Time execution, this is a shortest time execution, just like zero of setTimeout</span> </p>
<p><span data-start="1206.88" data-end="1213.88">Run the code immediately, it runs the code around ten years old, sometimes, right? So .. here</span> <span data-start="1217.37" data-end="1224.37">For example, I want to talk about callbacks, so it depends on who speaks and how the phrase</span> <span data-start="1225.73" data-end="1230.03">Things, callbacks can be one of two things, callbacks can be any function, the other</span> <span data-start="1230.03" data-end="1235.92">Function calls or callbacks can be made more explicitly asynchronous callbacks as a</span> <span data-start="1235.92" data-end="1241.679">Get pushed back to the callback queue in the future. This code illustrates the difference,</span> <span data-start="1241.679" data-end="1248.25">Correct. On the array in the foreach method, it won't run, it needs a function, which you</span> <span data-start="1248.25" data-end="1252.64">The callback can be called, but it doesn't run it asynchronously, it runs inside it</span> <span data-start="1252.64" data-end="1259.64">The current stack. We can define an asynchronous forEach so it can take an array of a callback</span> <span data-start="1261.73" data-end="1267.12">And for each item in the array it will do a zero setTimeout with a callback,</span> <span data-start="1267.12" data-end="1273.01">I think this should pass the value, but any way, so, I want to run it, we can</span> <span data-start="1273.01" data-end="1278.14">See what's the difference, so for the first running code block, it has to sit</span> <span data-start="1278.14" data-end="1285.14">And blocking the stack, right? Until it's done, and in the asynchronous version, well, this slows down</span> <span data-start="1285.58" data-end="1291.08">Down but we basically have to queue a bunch of callbacks and they will clear</span> <span data-start="1291.08" data-end="1296.929">Then we can actually run through and make a console.log. Console.log in this example</span> </p>
<p><span data-start="1296.929" data-end="1301.29">It's fast, so the benefits of doing asynchronous aren't obvious, but let's say you do</span> <span data-start="1301.29" data-end="1308.29">Some processing on each element is a slow array. I think i have something to show</span> <span data-start="1312.02" data-end="1319.02">No, no, I don't know. Ok. So we said-oops. So I have a delay function</span> <span data-start="1321.54" data-end="1328.54">It's just slow, it's just a slow thing. So .. let's say handle asynchronous and handle synchronous here.</span> <span data-start="1335.24" data-end="1342.24">Okay now i am going to open i have one thing this morning and literally hacked it all together</span> <span data-start="1343.5" data-end="1347.78">Is to simulate redrawing or rendering the browser, which is what I haven't touched</span> <span data-start="1347.78" data-end="1354.76">What's going on, this interacts with rendering-I'm touched, but not really</span> <span data-start="1354.76" data-end="1361.76">Explain it. Therefore, basically the browser is restricted by what javascript you are doing,</span> <span data-start="1361.94" data-end="1367.59">Browser wants to redraw the screen every 16.6 milliseconds, 60 frame seconds</span> <span data-start="1367.59" data-end="1373.92">It is ideal, this is where it will do the redraw as fast as possible. But it is constrained by what you are doing</span> <span data-start="1373.92" data-end="1379.559">This is done in JavaScript for various reasons, so it is not actually rendered, if there is</span> <span data-start="1379.559" data-end="1384.9">Code on the stack, right. Like rendering a kind of call almost like in a callback</span> <span data-start="1384.9" data-end="1390.88">itself. It waits until the stack is clear. The difference is that in presenting a given</span> </p>
<p><span data-start="1390.88" data-end="1397.88">Higher priority than your callback, it queues a split every 16 milliseconds,</span> <span data-start="1398.59" data-end="1404.6">It can be clear before the stack that it actually does the rendering. So this is-</span> <span data-start="1404.6" data-end="1408.83">This rendering queue is just a simulation rendering, every second is this what I can do a rendering? Yes,</span> <span data-start="1408.83" data-end="1413.45">Can I do a presentation? Yes. Among them, because our code is not doing anything now. If I run</span> <span data-start="1413.45" data-end="1420.45">Code you can see while we are doing this kind of synchronization loop slowly through the array our rendering</span> </p>
<p><span data-start="1420.73" data-end="1425.85">Blocked, right, if our rendering is blocked you cannot select text on the screen, you cannot</span> <span data-start="1425.85" data-end="1431.61">Click something and see the response, right, like for example I showed before. At this</span> <span data-start="1431.61" data-end="1438.61">For example, okay, this is faster even though our queue is blocking the asynchronous timeout</span> <span data-start="1440.179" data-end="1444.58">But we are given-we kind of give every element a render because of the chance between</span> <span data-start="1444.58" data-end="1451.58">We have queued it to jump there asynchronously and do the rendering, is this</span> <span data-start="1453.02" data-end="1453.46">sense?</span> <span data-start="1453.46" data-end="1455.72"Audience member: Yes >> Yes, it's cool. So this is just a kind of-</span> <span data-start="1455.72" data-end="1460.36">It's like what a simulated rendering works, but it just really reflects</span> <span data-start="1460.36" data-end="1464.21">You when people say don't block the event loop, that's exactly what they're talking about</span> <span data-start="1464.21" data-end="1467.75">on. They say don't put inferior slow stacks because when you do code</span> <span data-start="1467.75" data-end="1473.929">The browser cannot do what it needs to do to create a beautiful fluid UI. This is why when you</span> <span data-start="1473.929" data-end="1479.59">Do image processing or animation effects like this if you don't have too much stuff to become sluggish</span> <span data-start="1479.59" data-end="1486.59">Be careful how you line up the code. So an example of this, we can use to see</span> <span data-start="1488.08" data-end="1495.08">Scrolling handlers-scroll handles like this-are like triggering a lot of scroll events in the DOM,</span> </p>
<p><span data-start="1496.44" data-end="1501.9">Yes, they like to trigger-I believe they like to trigger every 16 frames</span> <span data-start="1501.9" data-end="1508.12">Milliseconds if I have this code pair. In document.scroll, animated stuff,</span> <span data-start="1508.12" data-end="1515.12">Or do some work. If I have this code, for example I scroll it to be queued like</span> <span data-start="1515.29" data-end="1520.89">Tons of callback rights. Then it has to go through and process all these and each</span> <span data-start="1520.89" data-end="1526.059">If these are very slow, well, you do n’t block the stack, you</span> <span data-start="1526.059" data-end="1533.059">Floods queued events. So, it's like just helping visualization, I guess,</span> <span data-start="1534.299" data-end="1538.2">What happens when you actually trigger all these callbacks, there are ways to shake</span> <span data-start="1538.2" data-end="1544.46">This is fundamentally okay, we have to queue all these events, but let's do</span> <span data-start="1544.46" data-end="1551.46">I work slowly until the user every few seconds or stop scrolling for a certain amount of time</span> <span data-start="1554.86" data-end="1561.86">Think this is basically it. There is a whole other conversation in Hell about how this works. because</span> <span data-start="1563.929" data-end="1569.98">Basically the code is running, such code runs correctly at runtime, and it slows down</span> <span data-start="1569.98" data-end="1576.98">I run the parser through an Esprima and a JavaScript. When I insert a large loop,</span> <span data-start="1578.21" data-end="1585.21">For half a second, it's just slowly moving code. Shipped to web workers and did a whole bunch</span> </p>
<p><span data-start="1585.299" data-end="1591.47">Something visualizes what happened, and it makes sense to do it at runtime. entire</span> <span data-start="1591.47" data-end="1598.26">Other conversations are here. I'm super excited it will talk to anyone afterwards</span> </p>
</section>