<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>RqTxtOXcv8Y</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/RqTxtOXcv8Y?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="1.04" data-end="4.04">Thank you.</span> <span data-start="4.04" data-end="5.21">Is this on?</span> <span data-start="5.21" data-end="7.359">Can you all hear me?</span> <span data-start="7.359" data-end="10.44">All right.</span> <span data-start="10.44" data-end="11.44">There we go!</span> <span data-start="11.44" data-end="12.64">All right.</span> <span data-start="12.64" data-end="13.99">So, yeah.</span> <span data-start="13.99" data-end="21.2">My talk is simplifying, though I would have liked to see a talk titled simplifying complex</span> <span data-start="21.2" data-end="24.93">talk titles with fewer words.</span> <span data-start="24.93" data-end="28.02">I know what you might be thinking right now.</span> <span data-start="28.02" data-end="31.869">The react API, a little scary?</span> <span data-start="31.869" data-end="40.18">There's a good book in order to understand how to best work with it, and it's doing whatever</span> <span data-start="40.18" data-end="46.32">Danny says to do.</span> <span data-start="46.32" data-end="52.17">The second half of this talk is exactly what I'm talking about today, except in the more</span> <span data-start="52.17" data-end="55.94">general sense.</span> </p>
<p><span data-start="55.94" data-end="58.15">I want to talk about it, though.</span> <span data-start="58.15" data-end="64.33">Not in the context of React or you or angular or any of the last frameworks that came out</span> <span data-start="64.33" data-end="65.33">last week.</span> <span data-start="65.33" data-end="69.86">But I want to talk about it in a frameworkless context.</span> </p>
<p><span data-start="69.86" data-end="74.92">This is an idea that doesn't just apply to any framework or no framework in general,</span> <span data-start="74.92" data-end="77.72">but really any programming language as well.</span> <span data-start="77.72" data-end="81.96">We can see how it could help us simplify our UIs.</span> <span data-start="81.96" data-end="87.159">So I'm a pianist, and I have been playing for about 20 years.</span> <span data-start="87.159" data-end="94.89">This is the approach that I take to software development.</span> </p>
<p><span data-start="94.89" data-end="100.92">I made the analogy that if software is music, then developers are composers.</span> <span data-start="100.92" data-end="108.21">We're taking that music, and we're composing it in a way that is applicable to any language</span> <span data-start="108.21" data-end="109.44">or any platform.</span> <span data-start="109.44" data-end="112.549">And we do so in a variety of ways.</span> <span data-start="112.549" data-end="117.049">However, music's interesting, because with music, you have music notation, which you</span> <span data-start="117.049" data-end="118.049">just saw there.</span> <span data-start="118.049" data-end="120.37">Let's go back and see it.</span> <span data-start="120.37" data-end="122.64">So this stuff right here.</span> <span data-start="122.64" data-end="126.14">This music notation is hundreds and hundreds of years old.</span> <span data-start="126.14" data-end="133.189">However, the exact same notation is used today to represent music from classical, romantic,</span> <span data-start="133.189" data-end="135.59">whatever the hellï¿½Bjork is.</span> </p>
<p><span data-start="135.59" data-end="145.68">You can give a musician who understands how to read sheet music, and they will be able</span> <span data-start="145.68" data-end="147.06">to play it.</span> <span data-start="147.06" data-end="152.09">And this works for all instruments, and you know, all musicians of all levels.</span> <span data-start="152.09" data-end="161.98">So I was wondering, what is the music notation of user interfaces?</span> <span data-start="161.98" data-end="169.389">What do all user interfaces have in common, and how can we represent that declaratively?</span> <span data-start="169.389" data-end="173.969">So when we're working with software, we usually deal with APIs.</span> <span data-start="173.969" data-end="178.73">Good APIs have three main qualities.</span> <span data-start="178.73" data-end="180.159">They're well documented.</span> <span data-start="180.159" data-end="184.159">You can read the documentation and understand exactly what's happening with the API.</span> <span data-start="184.159" data-end="186.11">They are very predictable.</span> <span data-start="186.11" data-end="191.189">The API is going to work the exact same way every time.</span> <span data-start="191.189" data-end="192.87">And they're also testable.</span> <span data-start="192.87" data-end="194.909">You can test against an API.</span> <span data-start="194.909" data-end="200.999">They provide mocks for you or have a test database or something like that.</span> <span data-start="200.999" data-end="204.819">So user interfaces, though?</span> <span data-start="204.819" data-end="207.239">User interfaces are really complex.</span> </p>
<p><span data-start="207.239" data-end="213.309">I mean, does anyone find developing user interfaces easy?</span> <span data-start="213.309" data-end="217.12">Those of you watching online, no one raised their hand, which is good, because I would</span> <span data-start="217.12" data-end="219.989">have called them out if they did.</span> <span data-start="219.989" data-end="223.989">We have to deal with something called a human API.</span> <span data-start="223.989" data-end="227.26">That's all of you, all of our clients, everyone we work with.</span> </p>
<p><span data-start="227.26" data-end="232.719">Human API is undocumented or unpredictable, and we're untestable.</span> <span data-start="232.719" data-end="235.72">And we're also extremely buggy.</span> <span data-start="235.72" data-end="242.29">If you don't believe me, turn on an American news network, and you'll see proof of that.</span> <span data-start="242.29" data-end="243.29">So I work for Microsoft.</span> <span data-start="243.29" data-end="249.59">By the way, I'm not relating Microsoft to any of this terrible API stuff, I promise.</span> <span data-start="249.59" data-end="256.94">And at Microsoft, we have more than 50,000 software engineers throughout the world, and</span> <span data-start="256.94" data-end="259.9">at least 7 designers, I'm sure.</span> <span data-start="259.9" data-end="264.72">[ Laughter ] And we also serve one and a half billion customers.</span> <span data-start="264.72" data-end="266.3">I think this is just for windows.</span> <span data-start="266.3" data-end="269.62">It might be more than that.</span> <span data-start="269.62" data-end="275.56">When we're developing user interfaces for 1.5 billion people, we have to imagine all</span> <span data-start="275.56" data-end="278.59">the different ways a user could use the user interface.</span> </p>
<p><span data-start="278.59" data-end="282.21">And you know, this is different cultures and languages.</span> <span data-start="282.21" data-end="285.44">You wonder why diversity is so important in tech?</span> <span data-start="285.44" data-end="289.29">We have to reach the 1.5 billion people.</span> <span data-start="289.29" data-end="292.45">So we don't develop software for just one person.</span> <span data-start="292.45" data-end="298.98">However, when we're developing software with just the happy path in mind, that's essentially</span> <span data-start="298.98" data-end="300.44">what we're doing.</span> <span data-start="300.44" data-end="306">We're assuming that there's this ideal user who's using our applications in the exact</span> <span data-start="306" data-end="307.7">way that we want them to.</span> <span data-start="307.7" data-end="310.1">But this never happens.</span> <span data-start="310.1" data-end="314.16">We're going to take a look at the code example, but I don't want you to read too deeply into</span> <span data-start="314.16" data-end="315.16">the code.</span> <span data-start="315.16" data-end="319.06">I just want to see if you relate to this.</span> <span data-start="319.06" data-end="326.73">We're going to create a sample F where we query the flickr API and then the results.</span> <span data-start="326.73" data-end="332.31">Similar to what Dan was doing with movies in his last talk.</span> <span data-start="332.31" data-end="334.46">So it's pretty simple right?</span> </p>
<p><span data-start="334.46" data-end="335.59">We do a fetch.</span> <span data-start="335.59" data-end="340.5">Then when we get the data, we show it.</span> <span data-start="340.5" data-end="341.65">Are there any bugs here?</span> <span data-start="341.65" data-end="343.74">Are we done?</span> <span data-start="343.74" data-end="344.74">Well..</span> <span data-start="344.74" data-end="346.59">Let's say the data takes a long time to load.</span> <span data-start="346.59" data-end="347.59">Okay.</span> <span data-start="347.59" data-end="351">So now we have to set this loading flag, loading is true.</span> <span data-start="351" data-end="355.75">And once we finish loading data, then we have to set loading to false.</span> </p>
<p><span data-start="355.75" data-end="357.63">Are we done?</span> <span data-start="357.63" data-end="358.63">No.</span> <span data-start="358.63" data-end="360.65">What if we have an error.</span> <span data-start="360.65" data-end="365.75">Well, we have to hide the loading screen, show the error, right?</span> <span data-start="365.75" data-end="368.01">But, are we home free yet?</span> <span data-start="368.01" data-end="369.01">No.</span> <span data-start="369.01" data-end="376.28">Because, we also have to make sure that we clear the error once we try to search again.</span> <span data-start="376.28" data-end="379.3">As you can see, the complexity is getting bigger and bigger.</span> <span data-start="379.3" data-end="382.6">Now my onserve to vent handler is getting extremely huge.</span> </p>
<p><span data-start="382.6" data-end="386.43">I'm sure many of you can relate to this code.</span> <span data-start="386.43" data-end="390.64">Many of you will say yeah, some of my code looks like that.</span> <span data-start="390.64" data-end="391.8">Sure.</span> <span data-start="391.8" data-end="398.44">What if your boss comes to you and says we want the use tore be able to cancel the search,</span> <span data-start="398.44" data-end="400.95">because, you know, sometimes it takes too long.</span> <span data-start="400.95" data-end="403.67">Sometimes they want to search for something else.</span> <span data-start="403.67" data-end="406.78">That logic gets crazier.</span> <span data-start="406.78" data-end="408.22">I don't know if you can read that.</span> <span data-start="408.22" data-end="410.12">I'll zoom in for you.</span> <span data-start="410.12" data-end="417.58">But there's a lot of complexity in just one event handler.</span> <span data-start="417.58" data-end="422.16">You might know this as spaghetti code, where our code quickly gets unmanageable.</span> <span data-start="422.16" data-end="427.2">Some of you might see your engineers and think I don't do spaghetti code.</span> <span data-start="427.2" data-end="433.15">All of my code is modular and layered and separation of concerns.</span> </p>
<p><span data-start="433.15" data-end="437.42">You might not write spaghetti code, but you might write lasagne code, which is spaghetti</span> <span data-start="437.42" data-end="440.46">code in layers.</span> <span data-start="440.46" data-end="442.63">This is called the bottomup approach.</span> <span data-start="442.63" data-end="450.889">That approach is whenever you have an event like onclick or on change, you do all of the</span> <span data-start="450.889" data-end="452.26">logic in that event.</span> </p>
<p><span data-start="452.26" data-end="458.18">And that can refer to so many different actions, and some of those actions might change the</span> <span data-start="458.18" data-end="459.18">states.</span> <span data-start="459.18" data-end="465.24">But you have to choose which actions are executed, otherwise you might edit the state in a wrong</span> <span data-start="465.24" data-end="473.8">way, and you have to ad if statements.</span> <span data-start="473.8" data-end="476.24">There's a lot of downsides to this.</span> <span data-start="476.24" data-end="479.36">This bottomup code is difficult to test.</span> <span data-start="479.36" data-end="481.74">All the application logic lives in your mind.</span> <span data-start="481.74" data-end="486.55">So when you're writing your tests, you have to output it from the developer's mind on</span> <span data-start="486.55" data-end="487.55">to the tests.</span> <span data-start="487.55" data-end="490.78">And it makes it really hard to work with other developers.</span> </p>
<p><span data-start="490.78" data-end="492.86">The code is difficult to understand.</span> <span data-start="492.86" data-end="497.2">The code that I just showed you for showing and hiding the gallery, if you were to try</span> <span data-start="497.2" data-end="502.52">to parse that as a brandnew developer working on the project, you would find it really difficult</span> <span data-start="502.52" data-end="504.389">to do so.</span> <span data-start="504.389" data-end="508.65">The code will contain bugs, for sure, because there's going to be edge cases that you might</span> <span data-start="508.65" data-end="510.04">not have considered.</span> <span data-start="510.04" data-end="513.909">It will also be difficult to enhance, just like we've seen with cancellation.</span> <span data-start="513.909" data-end="518.749">And features, such as cancellation, make the code work.</span> <span data-start="518.749" data-end="525.81">They explode the potential possible states and actions that could happen in your application.</span> <span data-start="525.81" data-end="530.6">Here's an intuition for moving forward.</span> <span data-start="530.6" data-end="534.3">We have a realization that UI components are not independent.</span> <span data-start="534.3" data-end="539.889">We have frameworks that they isolate components and say these components fit in their nice</span> <span data-start="539.889" data-end="549.82">little box, and we can stick them in the page anywhere.</span> </p>
<p><span data-start="549.82" data-end="555.05">Everything they see on the screen is in the exact same context, and we have to coordinate</span> <span data-start="555.05" data-end="557.74">from components to component.</span> <span data-start="557.74" data-end="562.601">So another realization is that actions, which is what happens when you do an event, are</span> <span data-start="562.601" data-end="570.61">based both on the events executed, and the current state of the context.</span> <span data-start="570.61" data-end="578.86">And it's also that this event action paradigm is too simple to represent all the possible</span> <span data-start="578.86" data-end="580.071">states our app can be in.</span> <span data-start="580.071" data-end="585.21">So, what's the solution?</span> <span data-start="585.21" data-end="587.79">Standard statecharts.</span> <span data-start="587.79" data-end="595.04">I know a lot of you may have heard these before or studied them in school.</span> <span data-start="595.04" data-end="600.009">Even though you might know what these are, you probably haven't applied them to user</span> <span data-start="600.009" data-end="603.529">interfaces and actual software.</span> </p>
<p><span data-start="603.529" data-end="607.04">So, looking up material for this could be a little complicated.</span> <span data-start="607.04" data-end="616.579">I'm a visual person, and I'm going to do it in a very visual way.</span> <span data-start="616.579" data-end="620.3">First you have an initial state.</span> <span data-start="620.3" data-end="627.309">Then you have a finite number of states, which represents the states that the app could be</span> <span data-start="627.309" data-end="628.309">in.</span> <span data-start="628.309" data-end="632.93">When an app is in one state, it can't be in the other state at the same time.</span> <span data-start="632.93" data-end="639.259">You have a finite number of events, such as fetching, resolving, or rejecting a promise.</span> <span data-start="639.259" data-end="644.18">You have a mapping from state to state based on these events.</span> <span data-start="644.18" data-end="648.8">So for example, when you're fetching a promise and it resolves, you go to the fulfilled state.</span> <span data-start="648.8" data-end="652.36">And same way with reject and rejected state.</span> <span data-start="652.36" data-end="657.47">And you have a finite number of final states.</span> <span data-start="657.47" data-end="660.259">User interfaces can be continuous.</span> <span data-start="660.259" data-end="662.36">We could keep using them.</span> <span data-start="662.36" data-end="668.73">It doesn't say we're done, so go uninstall Instagram because you're not going to need</span> <span data-start="668.73" data-end="669.73">it.</span> <span data-start="669.73" data-end="676.439">If you go to this site, it's going to say promises are just a state machine.</span> </p>
<p><span data-start="676.439" data-end="679.889">That should give you a big clue with what we're working with here.</span> <span data-start="679.889" data-end="684.939">So the original app that I showed you, the gallery app can be modelled as the state machine</span> <span data-start="684.939" data-end="686.129">right here.</span> <span data-start="686.129" data-end="689.42">So we start in the idle state, and then we go to search.</span> <span data-start="689.42" data-end="690.98">Then we're in the searching state.</span> </p>
<p><span data-start="690.98" data-end="694.17">If we try to search again, it loops back.</span> <span data-start="694.17" data-end="695.3">It's like hold on.</span> <span data-start="695.3" data-end="696.8">We're already searching.</span> <span data-start="696.8" data-end="702.22">We can either resolve or reject the search results.</span> <span data-start="702.22" data-end="706.8">And from those two states, we could search again.</span> <span data-start="706.8" data-end="713.939">This is clearly seen by the arrows going from success or failure back to searching again.</span> </p>
<p><span data-start="713.939" data-end="722.04">So, the machine thatï¿½ the state machine that I envision looks sort of like this.</span> <span data-start="722.04" data-end="723.399">It's a JSON object.</span> <span data-start="723.399" data-end="729.49">I like JSON better than blackbox functions because you can enumerate all the possible</span> <span data-start="729.49" data-end="735.67">states and actions and be able to transition from one to the other with nice, simple function</span> <span data-start="735.67" data-end="736.7">right here.</span> </p>
<p><span data-start="736.7" data-end="743.8">For example, if we're in the searching state, and I get a resolve, then I just look it up</span> <span data-start="743.8" data-end="745.679">in this JSON object.</span> <span data-start="745.679" data-end="749.329">This searching, on resolve, success.</span> <span data-start="749.329" data-end="754.519">In type script, it's a record.</span> <span data-start="754.519" data-end="761.069">I guess it's the same in C#.</span> <span data-start="761.069" data-end="764.079">In PHP, they call for help.</span> <span data-start="764.079" data-end="766.19">I don't know.</span> <span data-start="766.19" data-end="771.35">So here's an example of what I just showed you.</span> </p>
<p><span data-start="771.35" data-end="776.459">If I were to search for icelandï¿½ let's search for goats first.</span> <span data-start="776.459" data-end="777.55">Let's say I don't want to search for goats.</span> <span data-start="777.55" data-end="780.249">I'll just cancel that.</span> <span data-start="780.249" data-end="790.79">Let's search for Iceland instead.</span> <span data-start="790.79" data-end="796.249">When we do the event of selecting a photo, we have a state transition that goes from</span> <span data-start="796.249" data-end="799.569">gallery to photo.</span> </p>
<p><span data-start="799.569" data-end="804.529">We can exit that, search again, cancel, search.</span> <span data-start="804.529" data-end="807.94">Let's cancel that.</span> <span data-start="807.94" data-end="809.079">Iceland.</span> <span data-start="809.079" data-end="812.889">And so you see it goes from state to state, and no matter how many times I try to break</span> <span data-start="812.889" data-end="818.74">this app, it's not going to deviate from this state machine that I have here.</span> </p>
<p><span data-start="818.74" data-end="823.059">And you see there was a few extra things such as actions over here.</span> <span data-start="823.059" data-end="826.199">When I'm done searching, update the items?</span> <span data-start="826.199" data-end="830.37">We're going to discuss that in a little further detail.</span> <span data-start="830.37" data-end="835.079">And also this is part of an article that I wrote which gives an introduction to finite</span> <span data-start="835.079" data-end="838.209">state machines.</span> <span data-start="838.209" data-end="842.04">So I use visual studio share.</span> </p>
<p><span data-start="842.04" data-end="844.16">I work on it and I also have to use it.</span> <span data-start="844.16" data-end="847.3">It's called dog fooding.</span> <span data-start="847.3" data-end="852.019">Anyway.. and this is sort of what it looks like.</span> <span data-start="852.019" data-end="856.709">And so, I don't know if we have Sarah and Burke in here.</span> <span data-start="856.709" data-end="860.489">Here's Burke right now.</span> <span data-start="860.489" data-end="864.369">You can think of it as Google docs for collaborative coding.</span> <span data-start="864.369" data-end="867.38">It's in preview in Microsoft.</span> <span data-start="867.38" data-end="872.17">And I have no control over what they're typing, and they're typing this in realtime.</span> <span data-start="872.17" data-end="877.47">With this live share, we can collaboratively code in the exact same document at the same</span> <span data-start="877.47" data-end="878.639">time.</span> </p>
<p><span data-start="878.639" data-end="884.119">These are a complex series of events that are happening at the same time, and so we</span> <span data-start="884.119" data-end="889.29">have to manage all of these possible events and all the possible states that this could</span> <span data-start="889.29" data-end="893.119">be in.</span> <span data-start="893.119" data-end="894.47">I have no idea..</span> <span data-start="894.47" data-end="895.47">Oh God.</span> <span data-start="895.47" data-end="897.699">Good luck breaking the demo.</span> </p>
<p><span data-start="897.699" data-end="899.11">It probably will, though.</span> <span data-start="899.11" data-end="900.11">Ha ha.</span> <span data-start="900.11" data-end="901.11">Anyway!</span> <span data-start="901.11" data-end="909.389">I'm going to end this before it gets too crazy..</span> <span data-start="909.389" data-end="914.72">One of the big things I have to work on in liveshare is this whole signin flow.</span> <span data-start="914.72" data-end="920.089">You would think that signing in is easy and, you know, signing in, signing out, all of</span> <span data-start="920.089" data-end="921.79">that.</span> <span data-start="921.79" data-end="923.1">But it's actually not.</span> <span data-start="923.1" data-end="926.649">Once you start drawing it out, it becomes a lot more complex.</span> </p>
<p><span data-start="926.649" data-end="929.009">So for example, there could be a signin failure.</span> <span data-start="929.009" data-end="931.459">You know, especially from Iceland.</span> <span data-start="931.459" data-end="933.6">I'm so glad that worked in Iceland.</span> <span data-start="933.6" data-end="936.939">All of our servers are based in the United States.</span> <span data-start="936.939" data-end="941.689">So when you have a signin success, then you go to the signin state.</span> <span data-start="941.689" data-end="943.91">From there you could go do two things.</span> <span data-start="943.91" data-end="947.769">You could either share a session or join a session.</span> <span data-start="947.769" data-end="953.869">So what I did was a couple months back, I refactored this part of the app so that it</span> <span data-start="953.869" data-end="957.339">uses an explicit state machine just like this.</span> <span data-start="957.339" data-end="958.889">We were getting a lot of bugs.</span> </p>
<p><span data-start="958.889" data-end="964.32">We were saying what if we're in the middle of sharing and the user signs out?</span> <span data-start="964.32" data-end="969.339">What if we join the session, and then we decide to share a session at the same time?</span> <span data-start="969.339" data-end="971.559">That shouldn't be allowed.</span> <span data-start="971.559" data-end="978.529">We had all of these if/else and switch statements, so I decided there has to be a better way.</span> <span data-start="978.529" data-end="983.79">I did the simple JSON object approach.</span> <span data-start="983.79" data-end="988.85">The state machine that I set up?</span> <span data-start="988.85" data-end="991.769">It was very easy to add telemetry to it.</span> <span data-start="991.769" data-end="998.369">I added telemetry, and I get this nice visual showing exactly the frequency of how users</span> <span data-start="998.369" data-end="1000.079">go from state to state.</span> <span data-start="1000.079" data-end="1005.059">So you could see obviously, most of the users go through this initializing and then signing</span> <span data-start="1005.059" data-end="1009.769">in state, and then you could either externally sign in, or you could sign out.</span> <span data-start="1009.769" data-end="1017.639">And then you could see that users tend to go to either joining or sharing, you know?</span> <span data-start="1017.639" data-end="1019.959">At about the same frequency.</span> <span data-start="1019.959" data-end="1021.36">And yeah.</span> </p>
<p><span data-start="1021.36" data-end="1027.61">So it clearly shows, too, how many users go to the error state and how many users go to</span> <span data-start="1027.61" data-end="1030.52">the success state for each of these states as well.</span> <span data-start="1030.52" data-end="1032.74">Now, these are very powerful insights.</span> <span data-start="1032.74" data-end="1037.52">Because while telemetry will only tell you an atomic bit of data, here is telemetry that</span> <span data-start="1037.52" data-end="1041.5">tells you the entire user flow of what's happening.</span> <span data-start="1041.5" data-end="1046.31">We could limit this to user and be able to see a nice path of what the user actually</span> <span data-start="1046.31" data-end="1047.81">did in the app.</span> <span data-start="1047.81" data-end="1055.84">So it's sort of like, you know, like the funnel diagrams, except even crazier.</span> </p>
<p><span data-start="1055.84" data-end="1058.94">We could also use state machines for integration testing.</span> <span data-start="1058.94" data-end="1063.47">And so this gets a little bit into graph theory, so bear with me a little bit.</span> <span data-start="1063.47" data-end="1070.24">Here we would be using a shortest path algorithm.</span> <span data-start="1070.24" data-end="1075.58">You could choose your favorite one.</span> <span data-start="1075.58" data-end="1083.35">It sounds like an Icelandic name.</span> <span data-start="1083.35" data-end="1086.78">Any of these formulas for finding the shortest path.</span> <span data-start="1086.78" data-end="1091.37">And so, for those who don't know, the shortest path is just going from one state to the other</span> <span data-start="1091.37" data-end="1093.28">with the minimal cost.</span> <span data-start="1093.28" data-end="1097.68">So you could imagine each of these arrows have a wait.</span> <span data-start="1097.68" data-end="1102.49">And so you just want to minimize, you know, how long it takes to get from one path to</span> <span data-start="1102.49" data-end="1103.49">the other.</span> <span data-start="1103.49" data-end="1108.43">Sort of like in Google maps, finding the shortest ETA from one point to the other.</span> <span data-start="1108.43" data-end="1110.34">So analytics would provide these waits.</span> <span data-start="1110.34" data-end="1115.28">And this represents all the happy paths a user could take.</span> <span data-start="1115.28" data-end="1121.87">If we want a user to, let's say, share a session, and get to the shared state, we would imagine</span> <span data-start="1121.87" data-end="1125.96">the user going from signed in to sharing to shared.</span> </p>
<p><span data-start="1125.96" data-end="1127.43">Just that simple.</span> <span data-start="1127.43" data-end="1134.66">These could be automatically generated from the JSON structure just like this.</span> <span data-start="1134.66" data-end="1138.28">But, remember, we're not just dealing with the happy paths.</span> <span data-start="1138.28" data-end="1146.36">So, we would do a death first search algorithm to find all the other paths a user could take.</span> <span data-start="1146.36" data-end="1151.3">Some of you might be thinking these algorithm things, I didn't think I would need them.</span> <span data-start="1151.3" data-end="1154.85">You sort of do; they're really helpful.</span> <span data-start="1154.85" data-end="1160.69">And so, these represent all the possible user flows.</span> <span data-start="1160.69" data-end="1168.28">You can imagine a user getting from state A to state C might not take the easiest route.</span> <span data-start="1168.28" data-end="1174.68">They might take a longer route to get all the way to C. And it reveals all the edge</span> <span data-start="1174.68" data-end="1176.01">cases.</span> <span data-start="1176.01" data-end="1180.29">When you model every single possible state with every single possible action, and you</span> <span data-start="1180.29" data-end="1187.61">get all of these flows, you're going to basically have 100,000% test coverage for anything that</span> <span data-start="1187.61" data-end="1189.34">could possibly happen in your app.</span> </p>
<p><span data-start="1189.34" data-end="1192.3">And of course these could all be automatically generated.</span> <span data-start="1192.3" data-end="1197.91">I caution against this, because you would be generating integration testsï¿½ it would</span> <span data-start="1197.91" data-end="1202.3">generate a lot of integration tests, which isn't necessarily a bad thing, but when you're</span> <span data-start="1202.3" data-end="1207.76">doing continuous integration, you don't want your tests to take four hours long.</span> <span data-start="1207.76" data-end="1212.88">It makes software bugs visually clear by drawing a map and putting them on the diagram.</span> <span data-start="1212.88" data-end="1217.28">You can see when I do this event, I'm going to the wrong state.</span> <span data-start="1217.28" data-end="1221.21">Or maybe I have an unhandled event, which does nothing.</span> <span data-start="1221.21" data-end="1225.19">Or maybe I have a missing transition.</span> <span data-start="1225.19" data-end="1226.19">That's shown here, too.</span> <span data-start="1226.19" data-end="1232.32">For example, Dan was showing the example where when you click a movie, it just waits and</span> <span data-start="1232.32" data-end="1237.13">waits, and then you get the next movie, and there's no loading state.</span> <span data-start="1237.13" data-end="1240.49">You can clearly see that in the state transition diagram.</span> <span data-start="1240.49" data-end="1243.86">And also, my favorite, race conditions.</span> </p>
<p><span data-start="1243.86" data-end="1250.29">These are just made completely nil and void with state machines, because you explicitly</span> <span data-start="1250.29" data-end="1254.18">say, when I get this event, I go to this state.</span> <span data-start="1254.18" data-end="1259.08">If I get another event after that that I don't care about, it's not going to cause a race</span> <span data-start="1259.08" data-end="1261.86">condition, because I will ignore that event.</span> <span data-start="1261.86" data-end="1264.15">And that's what state machines can help with.</span> <span data-start="1264.15" data-end="1268.55">Now I want to talk about Harold statecharts.</span> <span data-start="1268.55" data-end="1272.96">This could go on for hours and hours, because there's so much information here.</span> <span data-start="1272.96" data-end="1278.15">I'm going to give an overview of what these are and how these extend state machines in</span> <span data-start="1278.15" data-end="1282.11">order to improve the way we look at user interfaces.</span> </p>
<p><span data-start="1282.11" data-end="1286.73">Because, user interfaces can get complex, and finite state machines might not solve</span> <span data-start="1286.73" data-end="1288.88">everything.</span> <span data-start="1288.88" data-end="1292.89">So with statecharts, they are similar to state machines.</span> <span data-start="1292.89" data-end="1295.42">They are an extension of it.</span> <span data-start="1295.42" data-end="1298.4">Except we can have actions with Harel statecharts, too.</span> <span data-start="1298.4" data-end="1302.88">They actually do things to the state and the app.</span> <span data-start="1302.88" data-end="1310.85">We can have guards which prevent states from going from one to the other if something doesn't</span> <span data-start="1310.85" data-end="1312.18">match the condition.</span> </p>
<p><span data-start="1312.18" data-end="1317.88">If I'm trying to search for something, and the user didn't give me a search query, then</span> <span data-start="1317.88" data-end="1321.09">I'm not going to transition to the next state.</span> <span data-start="1321.09" data-end="1323.66">That could be declaratively modelled as well.</span> <span data-start="1323.66" data-end="1329.58">There's the idea of nested states.</span> <span data-start="1329.58" data-end="1330.78">This is parallel states.</span> <span data-start="1330.78" data-end="1338.19">It is not concurrent states where an app can be in two states at the same time.</span> <span data-start="1338.19" data-end="1342.83">It's more a way of simplifying the number of states you have so your state machine doesn't</span> <span data-start="1342.83" data-end="1344.37">look all crazy.</span> <span data-start="1344.37" data-end="1351.25">And also, history, which is a very common feature that many users would want in order</span> <span data-start="1351.25" data-end="1354.77">to go back to their safe state.</span> <span data-start="1354.77" data-end="1363.47">So I created this library called X states which models finite state machines and statecharts</span> <span data-start="1363.47" data-end="1368.94">in a declarative way, so that all you would have to do is use this JSON structure to model</span> <span data-start="1368.94" data-end="1374.73">your state machine, and then you would get the next state by calling transition on the</span> <span data-start="1374.73" data-end="1377.46">current state and the action.</span> <span data-start="1377.46" data-end="1383.31">It's functional, and it's going to work in any framework or no framework at all.</span> </p>
<p><span data-start="1383.31" data-end="1388.79">It also has the notion of actions, so it will return you an object telling you, these are</span> <span data-start="1388.79" data-end="1393.91">the next actions that you're going to take once you transition to a state.</span> <span data-start="1393.91" data-end="1398.85">It also has guards, so you could pass in some external state, and it will validate against</span> <span data-start="1398.85" data-end="1402.78">that external state and say, Okay, this condition is met.</span> <span data-start="1402.78" data-end="1405.12">So you go on to the next state.</span> <span data-start="1405.12" data-end="1411.09">It also has hierarchy so you can represent and compose machines easily.</span> <span data-start="1411.09" data-end="1418.12">It has orthogonality so you can represent parallel states and also represent remembered</span> <span data-start="1418.12" data-end="1419.13">states.</span> <span data-start="1419.13" data-end="1425.56">If you're doing a payment flow and you're asking for cash or card, the user can switch</span> <span data-start="1425.56" data-end="1428.63">between them, and the user gets to the review page.</span> <span data-start="1428.63" data-end="1432.08">You want to remember if the user chose cash or card.</span> <span data-start="1432.08" data-end="1436.63">So you go to method.history, and it would remember that.</span> <span data-start="1436.63" data-end="1442.44">And this is a purely functional, no side effect type of thing.</span> <span data-start="1442.44" data-end="1446.68">And so you can imagine the applications of where you could apply this.</span> </p>
<p><span data-start="1446.68" data-end="1453.02">One example of where you would use orthoganal states is this example.</span> <span data-start="1453.02" data-end="1455.74">Say you have bold, italic, or underline.</span> <span data-start="1455.74" data-end="1464.94">A user can use all or none of them, and it's represented by all of these eight states.</span> <span data-start="1464.94" data-end="1472.3">And you can imagine if we add more options such as align left, align center, justify,</span> <span data-start="1472.3" data-end="1475.99">it's going to explode into even more states.</span> <span data-start="1475.99" data-end="1484.87">With orthogonal statecharts, we just have this succinct representation of these possible</span> <span data-start="1484.87" data-end="1490.841">states, so that we know we can go from bold on to after, italics on to off, and same way</span> <span data-start="1490.841" data-end="1495.05">with underline, and we can represent all of those at the same time.</span> <span data-start="1495.05" data-end="1502.16">And also, hierarchy helps to reduce the number of arrows that you have in your finite state</span> <span data-start="1502.16" data-end="1503.16">machine.</span> <span data-start="1503.16" data-end="1507.57">So for example, both the success and failure states, we could search again and go back</span> <span data-start="1507.57" data-end="1509.29">to the searching state.</span> <span data-start="1509.29" data-end="1515.24">We could simplify this by just nesting them in a single state, the search state.</span> <span data-start="1515.24" data-end="1519.69">This is fully supported by X state, and yeah.</span> <span data-start="1519.69" data-end="1526.66">So, you could imagine how this would simplify just really complex state machines.</span> <span data-start="1526.66" data-end="1536.02">So, I released X state about six months ago at React rally, and since then, there has</span> <span data-start="1536.02" data-end="1541.94">been a lot of development and a lot of people actually using it to make projects such as</span> </p>
<p><span data-start="1541.94" data-end="1545.17">React automa and others.</span> <span data-start="1545.17" data-end="1550.02">And pretty soon, I'm going to be releasing another version, minor version.</span> <span data-start="1550.02" data-end="1554.68">Don't worry; nothing crazy, of Xstate where we improved the user ergonomics.</span> <span data-start="1554.68" data-end="1559.65">It's full SCXML.</span> <span data-start="1559.65" data-end="1561.1">It's not sexy.</span> <span data-start="1561.1" data-end="1565.95">Code is not sexy at all.</span> <span data-start="1565.95" data-end="1573.48">A Reactive interpreter, visualization interpreter, and a lot more examples.</span> </p>
<p><span data-start="1573.48" data-end="1581.23">In order to show you what I'm talking about, here is an example of a visualization tool.</span> <span data-start="1581.23" data-end="1586.9">That same JSON object that you passed into xstate and the same one I used for my gallery</span> <span data-start="1586.9" data-end="1598.5">app, this is one example of where you would use this.</span> <span data-start="1598.5" data-end="1605.28">My initial state is start, and I can hover over this search action, and go to this state.</span> <span data-start="1605.28" data-end="1610.57">Then I could see the possible different actionsï¿½ sorry, events that I could take from this</span> <span data-start="1610.57" data-end="1611.57">state.</span> <span data-start="1611.57" data-end="1614.11">So let's say I have a search success.</span> <span data-start="1614.11" data-end="1616.77">And so, I go into the gallery view.</span> <span data-start="1616.77" data-end="1623.86">And then I choose to search again, or I could select a photo.</span> <span data-start="1623.86" data-end="1633.63">So, I can visually see what's happening in my state machine by pasting in that JSON object.</span> <span data-start="1633.63" data-end="1638.2">That's hard to do with just a function, so that's why I decided to do it in a more declarative</span> <span data-start="1638.2" data-end="1640.31">way.</span> <span data-start="1640.31" data-end="1642.38">I'm going to be releasing this soon.</span> </p>
<p><span data-start="1642.38" data-end="1647.81">I want you all to enjoy the rest of the conference before I release it, so you can have time</span> <span data-start="1647.81" data-end="1648.97">to play with it afterwards.</span> <span data-start="1648.97" data-end="1652.25">That's my excuse, at least.</span> <span data-start="1652.25" data-end="1658.68">It's not out yet.</span> <span data-start="1658.68" data-end="1666.22">Now, it would be, you know, sort of remiss of me to not talk about sort of the downsides</span> <span data-start="1666.22" data-end="1673.19">of state machines and statecharts, but the truth is that you all are already creating</span> <span data-start="1673.19" data-end="1677.58">finite state machines and statecharts in your app already, and you don't even know it.</span> </p>
<p><span data-start="1677.58" data-end="1680.77">However, the ones that you're creating are implicit.</span> <span data-start="1680.77" data-end="1683.03">They're full of bugs.</span> <span data-start="1683.03" data-end="1685.03">They're incomplete.</span> <span data-start="1685.03" data-end="1690.25">And that's just the nature of how we code.</span> <span data-start="1690.25" data-end="1696.63">So the advantage of finite state machines and modeling them in a very explicit way is</span> <span data-start="1696.63" data-end="1703.49">that you reduce a lot of complexity up front just by getting rid of your if/else statements</span> <span data-start="1703.49" data-end="1707.6">and getting rid of your switch statements and having a direct mapping.</span> <span data-start="1707.6" data-end="1711.43">However, that quickly explodes into many, many different states.</span> <span data-start="1711.43" data-end="1717.15">So statecharts help manage that with a little higher complexity cost up front.</span> <span data-start="1717.15" data-end="1723.62">But in the long run, you will see it will be very easy to add features, remove features,</span> <span data-start="1723.62" data-end="1729.74">and handle different actions and different possible modes of your application.</span> <span data-start="1729.74" data-end="1735.63">So, of course, there's a lot of advantages to using statecharts, and the ones I am going</span> <span data-start="1735.63" data-end="1739.27">to quote are not actually from me.</span> <span data-start="1739.27" data-end="1741.24">They're from NASA.</span> <span data-start="1741.24" data-end="1748.11">A few years ago, NASA had to send this little vehicle right here all the way to Mars.</span> <span data-start="1748.11" data-end="1751.24">And they did so using statecharts.</span> </p>
<p><span data-start="1751.24" data-end="1756.27">So the advantages that they said was, first of all, there's visualized modeling.</span> <span data-start="1756.27" data-end="1763.65">So you could both model and examine the model of a state chart using visual tools.</span> <span data-start="1763.65" data-end="1769.31">You get these precise diagrams that tell you exactly what's going to happen when certain</span> <span data-start="1769.31" data-end="1773.4">conditions are met, when you're in a certain state, and this event happens.</span> <span data-start="1773.4" data-end="1778.08">When you're sending something to Mars, you can't exactly just send it there and hope</span> <span data-start="1778.08" data-end="1779.65">that it works, right?</span> <span data-start="1779.65" data-end="1785.8">You have to be absolutely sure that your billion dollar project is going to handle every single</span> <span data-start="1785.8" data-end="1788.24">possible state.</span> <span data-start="1788.24" data-end="1791.79">And so they also use state charts for automatic code generation.</span> <span data-start="1791.79" data-end="1796.93">I'm not a fan, but you could see how it could be beneficial.</span> <span data-start="1796.93" data-end="1799.97">Also, comprehensive test coverage.</span> <span data-start="1799.97" data-end="1806.47">By using state charts, they were able to generate just all of these integration tests where</span> <span data-start="1806.47" data-end="1811.87">they could test each and every one, and ensure that every single state was being hit, and</span> <span data-start="1811.87" data-end="1815.51">every single possible action or event was being handled.</span> <span data-start="1815.51" data-end="1822.61">Also, you know, being on a big project, you have a lot of requirement changes.</span> <span data-start="1822.61" data-end="1824.87">We want to add this to the rover.</span> </p>
<p><span data-start="1824.87" data-end="1827.22">We want to remove this functionality.</span> <span data-start="1827.22" data-end="1829.47">We want to change the way this works.</span> <span data-start="1829.47" data-end="1834.63">And when you're working on a big project, and you have these late breaking requirement</span> <span data-start="1834.63" data-end="1838.08">changes, then things can get really stressful.</span> <span data-start="1838.08" data-end="1843.07">With state charts, since you could clearly see the full flow of your application, you</span> <span data-start="1843.07" data-end="1848.67">could easily add and remove features without worrying what's going to break, what's going</span> <span data-start="1848.67" data-end="1853.25">to change, what's going to be affected.</span> <span data-start="1853.25" data-end="1855.76">So there are some disadvantages as well.</span> <span data-start="1855.76" data-end="1860.529">And the disadvantage is that my screen just went black.</span> <span data-start="1860.529" data-end="1863.98">I guess that means there are no disadvantages.</span> <span data-start="1863.98" data-end="1865.63">Ha ha.</span> <span data-start="1865.63" data-end="1866.63">Anyway..</span> <span data-start="1866.63" data-end="1871.61">Since the rest of my slides are forked, I want to show you this real quick.</span> <span data-start="1871.61" data-end="1876.58">I gave a talk about one and a half years ago.</span> <span data-start="1876.58" data-end="1880.34">It was at JSConf Iceland.</span> <span data-start="1880.34" data-end="1885.13">This is where I saw the primary use case for using state machines and statecharts.</span> </p>
<p><span data-start="1885.13" data-end="1894.53">There was this really complex UI design that I really wanted to model, and I found it pretty</span> <span data-start="1894.53" data-end="1899.16">difficult without using an explicit state machine or state chart.</span> <span data-start="1899.16" data-end="1904.25">So what I'm doing here, there's three different states.</span> <span data-start="1904.25" data-end="1905.809">This one.</span> </p>
<p><span data-start="1906.809" data-end="1908.62">And there's different actions as well.</span> <span data-start="1908.62" data-end="1914.08">So the user could pan right, but just a little bit.</span> <span data-start="1914.08" data-end="1921.08">So I handle that as a transition from going to state A, back to state A if they didn't</span> <span data-start="1921.08" data-end="1922.24">move far enough.</span> <span data-start="1922.24" data-end="1928.94">Of course, if they move far enough, it goes to the next state successfully.</span> <span data-start="1928.94" data-end="1934.13">And also, it handles, like, if I'm going up, and I decide to go left and right, it's not</span> <span data-start="1934.13" data-end="1938.809">going to do anything, because we're already going up and down.</span> <span data-start="1938.809" data-end="1943.99">So it knows when this event happens, don't try to go to a different state, because we're</span> <span data-start="1943.99" data-end="1952.57">already transitioning to one state.</span> </p>
<p><span data-start="1952.57" data-end="1956.63">I also wanted to mention two very good resources.</span> <span data-start="1956.63" data-end="1964.6">The first one is on spectrum.oi/statecharts.</span> <span data-start="1964.6" data-end="1969.65">This is a community where we talk about statecharts, their possible applications, and how they're</span> <span data-start="1969.65" data-end="1971.77">used everywhere.</span> <span data-start="1971.77" data-end="1974.8">Statecharts are nothing new.</span> <span data-start="1974.8" data-end="1978.55">They're invented by David Harel in 1987, which is what?</span> <span data-start="1978.55" data-end="1981">30 years ago?</span> <span data-start="1981" data-end="1983.02">This is not cuttingedge stuff.</span> <span data-start="1983.02" data-end="1987.68">If people are asking why aren't we using statecharts everywhere now?</span> </p>
<p><span data-start="1987.68" data-end="1993.97">Well, the thing is, they are in embedded systems or systems programming.</span> <span data-start="1993.97" data-end="1997.67">People do use statecharts in order to model their applications.</span> <span data-start="1997.67" data-end="2002.33">We don't, quite yet, but I think it's about time that we catch up to it.</span> <span data-start="2002.33" data-end="2012.6">And so, Eric Mogansen made a wonderful resource called the unfinished world of statecharts.</span> <span data-start="2012.6" data-end="2026.4">Over here, if you want to learn more information, there's a well wealth of information here.</span> <span data-start="2026.4" data-end="2034.14">I really want to encourage you to revisit your application and the way you think about</span> <span data-start="2034.14" data-end="2037.51">things, and actually try to visualize things.</span> <span data-start="2037.51" data-end="2043.49">You will see that by visualizing your application, all of its possible states, all the events</span> <span data-start="2043.49" data-end="2051.36">that could happen, that you're going to have a clearer representation of the possible bugs,</span> <span data-start="2051.36" data-end="2056.389">the possible features that you might have, the user improvements, and everything else.</span> </p>
<p><span data-start="2056.389" data-end="2058.72">So I want to thank you all for having me.</span> <span data-start="2058.72" data-end="2062.23">Unfortunately, I can't show you my last slide, because it's not working, but thank you.</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
