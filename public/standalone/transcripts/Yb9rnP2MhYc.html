<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Yb9rnP2MhYc</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/Yb9rnP2MhYc?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="8.51" data-end="17.91">hi seems cool yeah so I've been giving a</span> <span data-start="17.91" data-end="20.85">lot of introduction talks to note in the</span> <span data-start="20.85" data-end="24.39">last couple months and its really nice</span> <span data-start="24.39" data-end="27.33">to come to Jas Compton and be able to</span> <span data-start="27.33" data-end="30.779">make some small assumption about people</span> <span data-start="30.779" data-end="33.63">here knowing what note is and what it</span> <span data-start="33.63" data-end="37.829">does so I'm going to take the</span> <span data-start="37.829" data-end="43.32">opportunity to give you some things in</span> <span data-start="43.32" data-end="46.68">note that are less than perfect and that</span> <span data-start="46.68" data-end="51.719">need to be done and to hopefully</span> <span data-start="51.719" data-end="54.69">encourage some of you to contribute to</span> <span data-start="54.69" data-end="56.91">the project and work on these problems I</span> <span data-start="56.91" data-end="59.989">think that they're all kind of fun and</span> <span data-start="59.989" data-end="66.659">there's a lot of stuff to do so yes note</span> <span data-start="66.659" data-end="70.68">is gaining popularity it's really it's</span> <span data-start="70.68" data-end="74.159">really interesting and fun and I think</span> <span data-start="74.159" data-end="78.39">that you know it it actually has a</span> <span data-start="78.39" data-end="80.67">chance of becoming a real application</span> <span data-start="80.67" data-end="87.45">platform and we should work very hard to</span> <span data-start="87.45" data-end="90.299">try to make that the case or at least</span> </p>
<p><span data-start="90.299" data-end="95.909">I'm going to so yeah I hope that this</span> <span data-start="95.909" data-end="98.729">encourages somebody to work on some</span> <span data-start="98.729" data-end="104.909">stuff in note so problem one is the ssl</span> <span data-start="104.909" data-end="112.079">support in in node is is lacking and its</span> <span data-start="112.079" data-end="118.73">really unacceptable SSL is very much</span> <span data-start="118.73" data-end="121.4">an infrastructural protocol you almost</span> <span data-start="121.4" data-end="125.15">can't do internet without it and maybe</span> <span data-start="125.15" data-end="126.62">this wasn't the case a couple of years</span> <span data-start="126.62" data-end="129.5">ago but these days with more and more</span> <span data-start="129.5" data-end="136.4">websites defaulting to to SSL it really</span> <span data-start="136.4" data-end="140.78">needs to be done correctly and currently</span> </p>
<p><span data-start="140.78" data-end="144.95">Note has some bindings to openssl but</span> <span data-start="144.95" data-end="149.32">their buggy and they're incomplete and</span> <span data-start="149.32" data-end="154">they're not implemented in the best way</span> <span data-start="154" data-end="157.64">they're very much tied too tight into</span> <span data-start="157.64" data-end="160.49">the socket code and should be separated</span> <span data-start="160.49" data-end="164.48">a bit and all this makes for something</span> <span data-start="164.48" data-end="167.9">that is ultimately unusable and so so</span> <span data-start="167.9" data-end="171.86">this is really not acceptable and so I</span> <span data-start="171.86" data-end="174.86">think probably the most important</span> <span data-start="174.86" data-end="177.59">problem that needs to be done with note</span> <span data-start="177.59" data-end="181.46">is is that we need to have really good</span> <span data-start="181.46" data-end="187.81">support for for client and server ssl</span> <span data-start="187.81" data-end="190.22">with all these cool features you know</span> <span data-start="190.22" data-end="192.32">there there's a lot of talk about how to</span> <span data-start="192.32" data-end="195.8">speed up you know that the handshake</span> <span data-start="195.8" data-end="200.39">process and some of the new features and</span> <span data-start="200.39" data-end="202.97">that you can do with with SSL and I</span> <span data-start="202.97" data-end="207.23">think that you know we're kind of</span> <span data-start="207.23" data-end="210.489">starting from scratch with note and so</span> <span data-start="210.489" data-end="212.45">we might want to take this opportunity</span> <span data-start="212.45" data-end="218.09">to see how far we can we can go forward</span> <span data-start="218.09" data-end="220.73">with this can can we actually you know</span> <span data-start="220.73" data-end="223.48">implement a snap start sort of thing</span> <span data-start="223.48" data-end="226.97">even if openssl doesn't actually support</span> <span data-start="226.97" data-end="231.86">it yet</span> <span data-start="231.87" data-end="237.16">the second most important problem is the</span> <span data-start="237.16" data-end="240.28">fact that node is very much focused on</span> <span data-start="240.28" data-end="244.18">performance and a lot of thought goes</span> <span data-start="244.18" data-end="247.3">into how to make things as fast as</span> <span data-start="247.3" data-end="251.05">possible yet more or less we're</span> <span data-start="251.05" data-end="255.37">developing blindly so that we don't have</span> <span data-start="255.37" data-end="258.01">a continuous integration system for</span> <span data-start="258.01" data-end="261.88">performance tests there's been some work</span> <span data-start="261.88" data-end="265.3">done in this area to kind of get a</span> <span data-start="265.3" data-end="267.46">website up and have built bots that</span> <span data-start="267.46" data-end="270.55">produce graphs but there was too much</span> <span data-start="270.55" data-end="272.47">noise in the graphs and the the</span> <span data-start="272.47" data-end="274.889">benchmarks weren't weren't so effective</span> <span data-start="274.889" data-end="278.229">and build BOTS not it's kind of an</span> <span data-start="278.229" data-end="280.18">external project from note itself but</span> <span data-start="280.18" data-end="282.6">it's really important we need to know</span> <span data-start="282.6" data-end="286.12">when we make changes if it's affecting a</span> <span data-start="286.12" data-end="288.13">certain part of the system so at the</span> <span data-start="288.13" data-end="289.78">moment really the only thing that that's</span> <span data-start="289.78" data-end="294.37">being tested very often is the HGP hello</span> <span data-start="294.37" data-end="297.76">world server which is not really</span> <span data-start="297.76" data-end="300.46">important but basically anybody who</span> <span data-start="300.46" data-end="303.37">comes to note and tries it out is going</span> <span data-start="303.37" data-end="305.41">to open it up in write a HelloWorld</span> <span data-start="305.41" data-end="308.59">server in and see how fast is and you</span> <span data-start="308.59" data-end="310.27">know stupidly based their decision off</span> <span data-start="310.27" data-end="312.58">of that so we should address that point</span> <span data-start="312.58" data-end="317.11">if and I mean a hello world server does</span> <span data-start="317.11" data-end="320.05">exercise a lot of code but there's other</span> <span data-start="320.05" data-end="325.45">issues for example startup time it's</span> <span data-start="325.45" data-end="327.039">currently something like 40 milliseconds</span> <span data-start="327.039" data-end="332.039">on my laptop on the palm device it's</span> <span data-start="332.039" data-end="337.51">more than a second so this stuff needs</span> <span data-start="337.51" data-end="341.139">to be considered and we need to know</span> <span data-start="341.139" data-end="343.9">that when changes are being done that</span> <span data-start="343.9" data-end="354.659">they're not affecting performance</span> <span data-start="354.669" data-end="358.61">note introduces kind of some new ideas</span> <span data-start="358.61" data-end="360.949">about programming servers not not</span> <span data-start="360.949" data-end="363.86">necessarily new but takes them to an</span> <span data-start="363.86" data-end="368.06">extreme level and so if you've done</span> <span data-start="368.06" data-end="371.06">something with node you might realize</span> <span data-start="371.06" data-end="373.819">that you get into this situation pretty</span> <span data-start="373.819" data-end="377.86">often where an event is triggered and</span> <span data-start="377.86" data-end="380.24">you'll get an exception and you'll see</span> <span data-start="380.24" data-end="382.719">your stack trace and it's very small</span> <span data-start="382.719" data-end="385.759">because you're you're constantly killing</span> <span data-start="385.759" data-end="387.919">your it's a single step so you're</span> <span data-start="387.919" data-end="390.229">constantly trashing it all the time</span> <span data-start="390.229" data-end="393.5">every every every event you're you throw</span> <span data-start="393.5" data-end="395.18">it away and so you get very little</span> <span data-start="395.18" data-end="397.969">context into where errors are coming</span> <span data-start="397.969" data-end="402.5">from so like this example you have to</span> <span data-start="402.5" data-end="405.56">set timeouts and you don't know</span> <span data-start="405.56" data-end="408.289">beforehand which one necessarily is</span> <span data-start="408.289" data-end="410.99">going to execute the function f but one</span> <span data-start="410.99" data-end="413.18">of them is I mean this is very contrived</span> <span data-start="413.18" data-end="415.639">but you could you can imagine and you've</span> <span data-start="415.639" data-end="417.44">probably experienced situations where</span> <span data-start="417.44" data-end="419.839">two different events can lead to a</span> <span data-start="419.839" data-end="422.81">certain function and you need to know</span> <span data-start="422.81" data-end="425.089">where it originated from to solve the</span> <span data-start="425.089" data-end="431.93">problem how do you deal with this when</span> <span data-start="431.93" data-end="435.469">one solution of course is is some sort</span> <span data-start="435.469" data-end="439.12">of green thread co routine continued</span> <span data-start="439.12" data-end="446.33">continuation passing thing I don't want</span> <span data-start="446.33" data-end="449">to go into that at the moment but note</span> <span data-start="449" data-end="454.25">is not going to do that so right you</span> <span data-start="454.25" data-end="456.86">might get an error like this which you</span> <span data-start="456.86" data-end="458.599">know references the fact that there is a</span> <span data-start="458.599" data-end="460.939">neck section throne but doesn't actually</span> <span data-start="460.939" data-end="463.069">tell you from which set time outfit came</span> <span data-start="463.069" data-end="468.229">from so it's really hard to debug how</span> <span data-start="468.229" data-end="470.93">can we solve this problem it's not like</span> <span data-start="470.93" data-end="473.18">you know written into the laws of</span> <span data-start="473.18" data-end="475.639">physics that you need co routines to</span> <span data-start="475.639" data-end="477.18">solve this problem</span> <span data-start="477.18" data-end="478.61">perhaps we can think of something else</span> <span data-start="478.61" data-end="482.52">what if we limit ourselves to this to</span> <span data-start="482.52" data-end="484.5">this single stack world can we think of</span> <span data-start="484.5" data-end="488.14">some other ways of solving this problem</span> <span data-start="488.15" data-end="491.94">maybe every time you set up a new event</span> <span data-start="491.94" data-end="494.94">like startup set timeout if you make a</span> <span data-start="494.94" data-end="500.19">link to the previous event that created</span> <span data-start="500.19" data-end="502.61">that thing and you have this kind of</span> <span data-start="502.61" data-end="505.74">list of things that you could walk back</span> <span data-start="505.74" data-end="508.169">through history to find out where it</span> <span data-start="508.169" data-end="516.3">came from of course there's other things</span> <span data-start="516.3" data-end="518.94">that can be done with debugging v8 has</span> <span data-start="518.94" data-end="523.89">this really nice tcp server that that it</span> <span data-start="523.89" data-end="525.959">can start up and you can connect to it</span> <span data-start="525.959" data-end="529.94">and write a little JSON protocol between</span> <span data-start="529.94" data-end="533.209">the node process and your debugger and</span> <span data-start="533.209" data-end="537.27">kind of get information set set</span> <span data-start="537.27" data-end="541.1">breakpoints step through the execution</span> <span data-start="541.1" data-end="544.11">so you can do this currently with note</span> <span data-start="544.11" data-end="547.23">you do know dash dash debug and it will</span> <span data-start="547.23" data-end="553.5">start the server but it would be nice to</span> <span data-start="553.5" data-end="559.48">be able to turn this on dynamically so</span> <span data-start="559.49" data-end="562.95">maybe by sending the process of signal</span> <span data-start="562.95" data-end="564.779">it would start this TCP server and then</span> <span data-start="564.779" data-end="566.91">you could connect to it and and do stuff</span> <span data-start="566.91" data-end="571.74">and the v8 has has this live edit</span> <span data-start="571.74" data-end="573.48">feature which allows you to actually</span> <span data-start="573.48" data-end="575.73">change the running code and so I think</span> <span data-start="575.73" data-end="578.779">for a lot of people who are doing</span> <span data-start="578.779" data-end="581.279">frameworks on top of note that this</span> <span data-start="581.279" data-end="584.76">would be a really useful thing that you</span> <span data-start="584.76" data-end="586.89">could run your application at a normal</span> <span data-start="586.89" data-end="589.589">speed and then turn on this debugger</span> <span data-start="589.589" data-end="592.8">send the changes to the code change</span> <span data-start="592.8" data-end="595.77">change the send the diffs to to what</span> <span data-start="595.77" data-end="597.77">you've changed in the code and</span> <span data-start="597.77" data-end="599.94">disconnected and have it still running</span> <span data-start="599.94" data-end="605.64">but at a normal speed it would be nice</span> <span data-start="605.64" data-end="607.21">to</span> <span data-start="607.21" data-end="610.34">hit the process with a signal and get</span> <span data-start="610.34" data-end="613.99">some sort of heat profile or CPU profile</span> <span data-start="613.99" data-end="617.18">turns out and note one of the things</span> <span data-start="617.18" data-end="619.01">that we learned from from doing the node</span> <span data-start="619.01" data-end="623.24">knockout contest was there's often</span> <span data-start="623.24" data-end="625.25">memory leaks and in node programs it's</span> <span data-start="625.25" data-end="628.67">it's hard to debug where these leaks in</span> <span data-start="628.67" data-end="632.35">your JavaScript objects are coming from</span> <span data-start="632.35" data-end="635.09">it would be nice to be able to just kind</span> <span data-start="635.09" data-end="637.73">of hit your running server and get a</span> <span data-start="637.73" data-end="644.03">heat profile dtrace proked Joanne</span> <span data-start="644.03" data-end="646.1">recently hired brian Cantrell who's the</span> <span data-start="646.1" data-end="650.75">one of the creators of DTrace and so we</span> <span data-start="650.75" data-end="654.23">have plans to put these probes in as</span> <span data-start="654.23" data-end="658.55">much as possible so would be really nice</span> <span data-start="658.55" data-end="660.08">to get them into function calls so that</span> <span data-start="660.08" data-end="663.38">you could actually you know get stack</span> <span data-start="663.38" data-end="666.23">traces on CC where certain things</span> <span data-start="666.23" data-end="669.79">originated from with respect to to</span> </p>
<p><span data-start="669.79" data-end="675.23">JavaScript function calls but these</span> <span data-start="675.23" data-end="679.34">things seem hard it seems that that</span> <span data-start="679.34" data-end="681.98">inspecting the the VA keep and finding</span> <span data-start="681.98" data-end="685.33">out looking inspecting these objects is</span> <span data-start="685.33" data-end="691.23">probably going to be difficult so anyway</span> <span data-start="691.24" data-end="694.58">event emitter firing possibly some</span> <span data-start="694.58" data-end="696.56">things on the thread pool just event</span> <span data-start="696.56" data-end="698.54">everywhere so that we can we can kind of</span> <span data-start="698.54" data-end="700.7">poke at these processes and see what</span> <span data-start="700.7" data-end="702.83">they're doing and be able to inspect</span> <span data-start="702.83" data-end="710.15">note processes the fourth most important</span> <span data-start="710.15" data-end="713.81">problem is windows which almost nobody</span> <span data-start="713.81" data-end="716.98">cares about except for everybody which</span> <span data-start="716.98" data-end="719.54">is a bit unfortunate i certainly don't</span> <span data-start="719.54" data-end="723.32">care about windows i just would like to</span> <span data-start="723.32" data-end="727.13">run on windows so currently we have a</span> <span data-start="727.13" data-end="732.17">cig wind fort which is as far as i'm</span> <span data-start="732.17" data-end="735.23">concerned fine but windows people tell</span> <span data-start="735.23" data-end="737.96">me that windows people don't like that</span> <span data-start="737.96" data-end="742.37">and so it would be nice to have a native</span> <span data-start="742.37" data-end="745.01">windows port I'm it is a significant</span> <span data-start="745.01" data-end="748.04">user base and it's really you can't just</span> <span data-start="748.04" data-end="750.95">ignore it you have to have some story</span> <span data-start="750.95" data-end="755.26">there and for the moment cygwin is</span> <span data-start="755.26" data-end="758.27">reasonable but I think having a native</span> <span data-start="758.27" data-end="761.33">like an actual real native windows</span> <span data-start="761.33" data-end="765.23">program that ran well would be very</span> <span data-start="765.23" data-end="767.84">beneficial to a lot of people there's no</span> <span data-start="767.84" data-end="769.91">reason that we can't be doing windows</span> </p>
<p><span data-start="769.91" data-end="777.38">GUI apps with note so it's just that it</span> <span data-start="777.38" data-end="779.42">seems like it's going to be very hard</span> <span data-start="779.42" data-end="784.4">note is very much a UNIX program and not</span> <span data-start="784.4" data-end="788.84">a windows program and so in particular</span> <span data-start="788.84" data-end="791.84">the the event loop abstraction library</span> <span data-start="791.84" data-end="794.83">that note uses Libby V doesn't doesn't</span> <span data-start="794.83" data-end="801.46">support Windows very well it seems like</span> <span data-start="801.46" data-end="806.06">this can be dealt with but it's going to</span> <span data-start="806.06" data-end="809.63">really require some effort and it</span> <span data-start="809.63" data-end="813.83">requires somebody who's very familiar</span> <span data-start="813.83" data-end="817.49">with with windows system programming so</span> <span data-start="817.49" data-end="820.07">this is definitely not something that's</span> <span data-start="820.07" data-end="824.15">going to come from me but I hope that</span> <span data-start="824.15" data-end="827.48">somebody cares enough about it to sit</span> <span data-start="827.48" data-end="833.82">down and and do the work</span> <span data-start="833.83" data-end="837.13">it would be really nice to supposedly</span> </p>
<p><span data-start="837.13" data-end="840.82">Windows has a very fast event</span> <span data-start="840.82" data-end="847.69">notification system these IO completion</span> <span data-start="847.69" data-end="851.17">ports it would be nice to be able to use</span> <span data-start="851.17" data-end="853.75">those instead of select supposedly live</span> <span data-start="853.75" data-end="856.69">event to which is another event loop</span> <span data-start="856.69" data-end="860.41">abstraction library does this correctly</span> <span data-start="860.41" data-end="864.07">so one possibility is to actually crane</span> <span data-start="864.07" data-end="868.36">lift note off of Libby V and on to live</span> <span data-start="868.36" data-end="873.81">event to which sounds really painful and</span> </p>
<p><span data-start="873.81" data-end="877.06">Libby v's just so cute and like you just</span> <span data-start="877.06" data-end="878.77">really wouldn't actually want to do that</span> <span data-start="878.77" data-end="881.71">but it is nice that that live event to</span> <span data-start="881.71" data-end="883.72">is is going through great lengths to be</span> <span data-start="883.72" data-end="887.59">very compatible with windows so maybe</span> <span data-start="887.59" data-end="890.29">it's worth doing it would be a lot of</span> <span data-start="890.29" data-end="893.5">work but maybe you don't even care about</span> <span data-start="893.5" data-end="895.42">performance on windows too much maybe</span> <span data-start="895.42" data-end="899.08">maybe note could be I mean nobody's</span> <span data-start="899.08" data-end="900.52">really going to be running servers on</span> <span data-start="900.52" data-end="904.93">windows anyway so perhaps perhaps select</span> <span data-start="904.93" data-end="911.319">as okay</span> <span data-start="911.329" data-end="916.559">v8 has a has a 1 gigabyte heap</span> <span data-start="916.559" data-end="923.309">limitation on x64 just recently</span> <span data-start="923.309" data-end="928.11">discovered so this is of course a fairly</span> <span data-start="928.11" data-end="931.739">large problem I don't think we can</span> <span data-start="931.739" data-end="933.569">expect that processes are going to be</span> <span data-start="933.569" data-end="939.089">under 1 gig of memory so this needs to</span> <span data-start="939.089" data-end="945.36">be addressed one gig is a decent size 44</span> <span data-start="945.36" data-end="949.709">program so I I don't think we're</span> <span data-start="949.709" data-end="951.509">necessarily going to be bouncing against</span> <span data-start="951.509" data-end="956.009">that immediately but if people start</span> <span data-start="956.009" data-end="957.779">developing larger and larger frameworks</span> <span data-start="957.779" data-end="960.449">and you know maybe they're they're doing</span> <span data-start="960.449" data-end="962.97">a little in-memory database or something</span> <span data-start="962.97" data-end="964.799">like that you would definitely not want</span> <span data-start="964.799" data-end="969.389">this to be a restriction yeah</span> <span data-start="969.389" data-end="971.819">unfortunately v8 doesn't care so much</span> <span data-start="971.819" data-end="974.85">about this because websites don't get</span> <span data-start="974.85" data-end="978.6">that big so this this is some work that</span> <span data-start="978.6" data-end="985.259">will have to be done it's getting more</span> <span data-start="985.259" data-end="988.019">and more technical if as we go along so</span> </p>
<p><span data-start="988.019" data-end="992.61">I apologize copying strings out of v8</span> <span data-start="992.61" data-end="997.04">seems to be a problem so so if you do a</span> <span data-start="997.04" data-end="1001.61">little benchmark where you send a larger</span> <span data-start="1001.61" data-end="1005.48">and larger strings as a response notes</span> <span data-start="1005.48" data-end="1010.04">performance degradation with respect to</span> <span data-start="1010.04" data-end="1012.519">other dynamic language what web servers</span> <span data-start="1012.519" data-end="1015.079">so clearly we're doing something very</span> <span data-start="1015.079" data-end="1020.36">wrong and I think the the problem is</span> <span data-start="1020.36" data-end="1022.999">that basically we're doing two copies we</span> <span data-start="1022.999" data-end="1025.339">have to copy the string out of v8 seep</span> <span data-start="1025.339" data-end="1028.37">into some external buffer and then copy</span> <span data-start="1028.37" data-end="1030.98">it into the kernel or to the device or</span> <span data-start="1030.98" data-end="1034.519">whatever whereas the other people are</span> <span data-start="1034.519" data-end="1037.189">actually actually accessing the string</span> <span data-start="1037.189" data-end="1041.01">in the Ruby heap itself so it some</span> <span data-start="1041.01" data-end="1042.39">needs to be done here at least for</span> <span data-start="1042.39" data-end="1048.03">certain cases for example JSON dumps if</span> <span data-start="1048.03" data-end="1050.22">we could just be able to push those to a</span> <span data-start="1050.22" data-end="1055.5">socket a lot quicker removing one of</span> <span data-start="1055.5" data-end="1058.14">these these copies there I think it</span> <span data-start="1058.14" data-end="1063.93">would be very beneficial also not</span> <span data-start="1063.93" data-end="1073.53">non-trivial to solve this so the current</span> <span data-start="1073.53" data-end="1077.37">mechanism and note for for writing two</span> <span data-start="1077.37" data-end="1080.43">sockets is every time you call socket</span> <span data-start="1080.43" data-end="1083.07">dot right or if you're in a web server</span> <span data-start="1083.07" data-end="1085.83">you you say response dot right it maps</span> <span data-start="1085.83" data-end="1088.02">to the same thing is that it actually</span> <span data-start="1088.02" data-end="1091.74">execute the right sis call in line in</span> <span data-start="1091.74" data-end="1095.82">that in that function and it seems that</span> <span data-start="1095.82" data-end="1098.54">this is not the appropriate design I</span> <span data-start="1098.54" data-end="1102.18">think what needs to happen is I mean</span> <span data-start="1102.18" data-end="1104.16">what ends up happening is is that you</span> <span data-start="1104.16" data-end="1106.86">call write a bunch of times in one</span> <span data-start="1106.86" data-end="1110.46">iteration of the event loop and you end</span> <span data-start="1110.46" data-end="1112.44">up with small packets being pushed out</span> <span data-start="1112.44" data-end="1114.36">which is not what you want you want them</span> <span data-start="1114.36" data-end="1115.83">to be bunched up because within one</span> <span data-start="1115.83" data-end="1117.57">iteration of the event loop it's very</span> <span data-start="1117.57" data-end="1121.56">very quick right that these rights need</span> <span data-start="1121.56" data-end="1127.38">to be buffered into at the end up until</span> <span data-start="1127.38" data-end="1130.59">you go to select or a pole or whatever</span> <span data-start="1130.59" data-end="1132.48">they need to be buffered up and then</span> <span data-start="1132.48" data-end="1140.96">sent out and one dumped so node has this</span> <span data-start="1140.96" data-end="1144.57">this watch file thing which people</span> <span data-start="1144.57" data-end="1147.3">probably have used and on Linux it's</span> <span data-start="1147.3" data-end="1150">really great because it actually uses</span> <span data-start="1150" data-end="1152.58">that I notify stuff and so you actually</span> <span data-start="1152.58" data-end="1155.34">get an event from the colonel to to tell</span> <span data-start="1155.34" data-end="1158.58">you when when a file has changed but on</span> <span data-start="1158.58" data-end="1160.77">other operating systems it's just doing</span> <span data-start="1160.77" data-end="1163.32">a stat over and over again with some</span> <span data-start="1163.32" data-end="1166.05">interval between which is expensive and</span> <span data-start="1166.05" data-end="1167.72">it actually is doing this stat</span> <span data-start="1167.72" data-end="1170.48">synchronously in the main threat of</span> <span data-start="1170.48" data-end="1174.77">note so of course if if you're if you're</span> <span data-start="1174.77" data-end="1178.66">start watching a file on say and NFS</span> <span data-start="1178.66" data-end="1184.28">file system then that can block for an</span> <span data-start="1184.28" data-end="1186.62">arbitrary amount of time in the main</span> <span data-start="1186.62" data-end="1193.65">event so this is really not a good thing</span> <span data-start="1193.66" data-end="1196.97">other operating systems have ways of</span> <span data-start="1196.97" data-end="1198.559">getting events from the colonel it's not</span> <span data-start="1198.559" data-end="1201.32">the same as I notify but there there are</span> <span data-start="1201.32" data-end="1207.559">ways to do this on on OS X so this is a</span> <span data-start="1207.559" data-end="1210.44">bit of work but not too difficult I</span> <span data-start="1210.44" data-end="1215.15">think I think the main problem is that</span> <span data-start="1215.15" data-end="1218.059">that watch file references a path and</span> <span data-start="1218.059" data-end="1221.12">the other event notification systems</span> <span data-start="1221.12" data-end="1225.71">reference file descriptors so yeah we</span> <span data-start="1225.71" data-end="1227.65">either have to change the interface or</span> <span data-start="1227.65" data-end="1230.059">massage it a little bit into into</span> <span data-start="1230.059" data-end="1236.96">working so node has this this little</span> <span data-start="1236.96" data-end="1240.86">thread pool called Libby i/o which just</span> <span data-start="1240.86" data-end="1244.309">has a bunch of P threads and you kind of</span> <span data-start="1244.309" data-end="1248.39">send it little system calls to do things</span> <span data-start="1248.39" data-end="1250.34">that things that would block right if</span> <span data-start="1250.34" data-end="1252.559">you if you have to do a get address info</span> <span data-start="1252.559" data-end="1255.86">you send it to that thread pool and it</span> <span data-start="1255.86" data-end="1258.38">blocks fine but you know it does it in a</span> <span data-start="1258.38" data-end="1259.85">thread and your your main thread can</span> <span data-start="1259.85" data-end="1261.65">keep going and then you get notified</span> <span data-start="1261.65" data-end="1266.96">back on certain systems you do actually</span> <span data-start="1266.96" data-end="1271.549">have internal asynchronous i/o and so</span> <span data-start="1271.549" data-end="1273.38">you don't actually need to do this this</span> <span data-start="1273.38" data-end="1278.179">thread pool thing in user space so it</span> <span data-start="1278.179" data-end="1280.79">would be nice if if Libby io actually</span> <span data-start="1280.79" data-end="1284.99">used these the appropriate things on on</span> <span data-start="1284.99" data-end="1292.34">different systems so there those are my</span> <span data-start="1292.34" data-end="1298.19">my nine problems there's a new mailing</span> <span data-start="1298.19" data-end="1299.309">list</span> <span data-start="1299.309" data-end="1302.2">44 note because the other ones getting a</span> <span data-start="1302.2" data-end="1304.54">lot of traffic that's a lot of newbies</span> <span data-start="1304.54" data-end="1306.88">and so if you're interested in</span> <span data-start="1306.88" data-end="1308.41">development you should you should join</span> <span data-start="1308.41" data-end="1310.66">this and if you're interested in solving</span> <span data-start="1310.66" data-end="1313.059">any of these problems of course email me</span> <span data-start="1313.059" data-end="1316.299">and we can we can discuss it but yeah</span> <span data-start="1316.299" data-end="1319.87">it's very much encouraged okay so this</span> <span data-start="1319.87" data-end="1323.71">is mostly the end of my talk I also want</span> <span data-start="1323.71" data-end="1327.79">to announce that joint is is having a</span> <span data-start="1327.79" data-end="1331.75">new release of our noge service which we</span> <span data-start="1331.75" data-end="1336.07">did for the node knockout and so people</span> <span data-start="1336.07" data-end="1339.37">at this contest can can go to n.o de and</span> <span data-start="1339.37" data-end="1343.15">get a smart machine to deployed no taps</span> <span data-start="1343.15" data-end="1347.58">to this is not our final version but</span> <span data-start="1347.58" data-end="1350.32">another release of it so if you go to</span> <span data-start="1350.32" data-end="1354.16">n.o de you can register for an account</span> <span data-start="1354.16" data-end="1357.04">and there's some curl commands to do</span> <span data-start="1357.04" data-end="1360.69">because I in the end it's some rest api</span> <span data-start="1360.69" data-end="1362.679">you don't have to memorize these</span> <span data-start="1362.679" data-end="1365.14">commands right here but um go to noge</span> <span data-start="1365.14" data-end="1367.66">and you can get an account and and try</span> <span data-start="1367.66" data-end="1373.02">to push a a note app up to it and</span> <span data-start="1373.02" data-end="1378.309">hopefully in the next two months or so i</span> <span data-start="1378.309" data-end="1381.15">think we'll have an actual release that</span> <span data-start="1381.15" data-end="1384.82">we will charge money for and will be</span> <span data-start="1384.82" data-end="1393.64">open to the public so yes so sorry for</span> <span data-start="1393.64" data-end="1396.22">the very technical talk I hope I didn't</span> <span data-start="1396.22" data-end="1399.21">or anybody but are there any questions</span> <span data-start="1399.21" data-end="1409.65">about anything related to note yes</span> <span data-start="1409.66" data-end="1413.78">so the question is should i will I be</span> <span data-start="1413.78" data-end="1415.88">bundling a package manager with note and</span> <span data-start="1415.88" data-end="1422.049">the answer is no note is more or less</span> <span data-start="1422.049" data-end="1425.03">how it will be now that not much more</span> <span data-start="1425.03" data-end="1427.13">will go into it and I think it's</span> <span data-start="1427.13" data-end="1431.72">important to keep it small and so of</span> <span data-start="1431.72" data-end="1433.46">course there's a lot of work to do I've</span> <span data-start="1433.46" data-end="1435.41">just laid it all out but it's not</span> <span data-start="1435.41" data-end="1438.049">necessarily you know building a package</span> <span data-start="1438.049" data-end="1441.59">manager or doing the these library or</span> <span data-start="1441.59" data-end="1443.45">you know building a web framework I mean</span> <span data-start="1443.45" data-end="1447.23">the API that we have now is more you</span> <span data-start="1447.23" data-end="1448.85">know we might add a couple of things</span> <span data-start="1448.85" data-end="1450.53">here and there but but more or less this</span> <span data-start="1450.53" data-end="1456.799">is what it will be not my goal but the</span> <span data-start="1456.799" data-end="1468.83">person behind Michael that yes the the</span> <span data-start="1468.83" data-end="1483.1">heat profiling is already in v8</span> <span data-start="1483.11" data-end="1486.299">no originally had an the question is</span> <span data-start="1486.299" data-end="1488.279">about blocking versus async required</span> <span data-start="1488.279" data-end="1490.919">note originally had an async require but</span> </p>
<p><span data-start="1490.919" data-end="1493.59">I was convinced by the common J's people</span> <span data-start="1493.59" data-end="1495.389">to change it in the name of common Jas</span> <span data-start="1495.389" data-end="1507.72">so it will be synchronous sorry I</span> <span data-start="1507.72" data-end="1516.6">couldn't hear you it the asynchronous</span> <span data-start="1516.6" data-end="1518.429">require has always been there it was</span> <span data-start="1518.429" data-end="1520.619">recently removed there will be no hay</span> <span data-start="1520.619" data-end="1537.13">synchronous require Michael</span> <span data-start="1537.14" data-end="1541.65">but buffers are outside of VA so just v8</span> <span data-start="1541.65" data-end="1548.73">objects right so if you're doing like a</span> <span data-start="1548.73" data-end="1551.19">some sort of database you should</span> <span data-start="1551.19" data-end="1553.049">probably allocate a very large buffer</span> <span data-start="1553.049" data-end="1555.84">and do that instead of a big JavaScript</span> <span data-start="1555.84" data-end="1565.32">array or some other questions okay well</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
