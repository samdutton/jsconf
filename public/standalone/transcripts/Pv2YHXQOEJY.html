<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pv2YHXQOEJY</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/Pv2YHXQOEJY?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="0.16" data-end="1.16">Componentizing End-to-End Tests — Nicholas Boll</span> <span data-start="1.16" data-end="2.16"Audience member: Mic check.</span> <span data-start="2.16" data-end="3.16">Great, this works.</span> <span data-start="3.16" data-end="4.16">Guys doing well?</span> </p>
<p><span data-start="4.16" data-end="5.16">Woo!</span> <span data-start="5.16" data-end="6.16">OK.</span> <span data-start="6.16" data-end="7.16">All right, so for our next speaker, we have Nicholas Boll, talking about componentizing</span> <span data-start="7.16" data-end="8.16">end to end tests.</span> <span data-start="8.16" data-end="9.16">Are we ready?</span> <span data-start="9.16" data-end="10.16">All right!</span> <span data-start="10.16" data-end="11.16">[applause]</span> <span data-start="11.16" data-end="12.16"Audience member: All right, starting a little bit early.</span> <span data-start="12.16" data-end="13.16">Just waiting for the slides.</span> <span data-start="13.16" data-end="14.16">I think I'm hooked up.</span> <span data-start="14.16" data-end="15.16">OK, all right, I'm talking about componentizing end to end tests, so, this is my first time</span> <span data-start="15.16" data-end="16.16">being at a conference speaking, so  —  Audience: Whoo!</span> <span data-start="16.16" data-end="17.16">[applause]</span> </p>
<p><span data-start="17.16" data-end="21.949">Thank you, so I'm going to start with some ice-breaker questions that will make me feel</span> <span data-start="21.949" data-end="24.349">better.</span> <span data-start="24.349" data-end="28.5">So who here has written web applications?</span> <span data-start="28.5" data-end="29.599">Looks like quite a bit.</span> <span data-start="29.599" data-end="30.599">All right.</span> </p>
<p><span data-start="30.599" data-end="31.97">Who's written unit tests?</span> <span data-start="31.97" data-end="32.98">. Yeah.</span> <span data-start="32.98" data-end="35.02">All right.</span> <span data-start="35.02" data-end="40.3">So who writes end to end tests using Cypress, Selenium, etc.?</span> <span data-start="40.3" data-end="42.489">OK, less people.</span> <span data-start="42.489" data-end="49.01">All right, so who thinks they're easy to write, debug or maintain?</span> <span data-start="49.01" data-end="51.379">Not very many hands.</span> <span data-start="51.379" data-end="52.77">OK, cool.</span> <span data-start="52.77" data-end="54.039">So this talk will help.</span> <span data-start="54.039" data-end="59.61">All right, so I'm going to put a statement out there that writing end to end tests is</span> <span data-start="59.61" data-end="60.61">hard.</span> <span data-start="60.61" data-end="64.01">So one thing is figuring out how to select something.</span> </p>
<p><span data-start="64.01" data-end="66.44">Do you use  —  there's all kinds of different things?</span> <span data-start="66.44" data-end="69.61">Do you even control what they are going to be?</span> <span data-start="69.61" data-end="76.34">Race conditions, both in your applications and also maybe in your test runner.</span> <span data-start="76.34" data-end="79.79">Data can be hard to control.</span> <span data-start="79.79" data-end="82.58">And also UI changes tend to break tests.</span> <span data-start="82.58" data-end="88.7">I know that's for the last five years at a company, we had an offshore doing our end</span> <span data-start="88.7" data-end="94.24">to end tests for us, and they were  —  they had an entire team just trying to keep those</span> <span data-start="94.24" data-end="101.35">running, so the tests were constantly breaking.</span> </p>
<p><span data-start="101.35" data-end="105.67">Now that I've postulated all of that, I'm Nicholas Boll, I'm a design system engineer</span> <span data-start="105.67" data-end="107.07">at Workday.</span> <span data-start="107.07" data-end="109.4">It's kind of what it sounds like.</span> <span data-start="109.4" data-end="113.41">I'm an engineer on the design system to Workday.</span> <span data-start="113.41" data-end="116.67">It's called Canvas.</span> <span data-start="116.67" data-end="120.61">It's open source in July.</span> <span data-start="120.61" data-end="126.23">So how do we break down our applications, because we have to build complex applications,</span> <span data-start="126.23" data-end="127.84">so how do we do it?</span> <span data-start="127.84" data-end="131.92">So this is just a screenshot that I took from Essentia's website.</span> <span data-start="131.92" data-end="141.48">It's a complex application of just like a dashboard, some menu items, and stuff.</span> <span data-start="141.48" data-end="148.47">So we probably try and visualize how we would break this down and we'll probably draw boxes</span> <span data-start="148.47" data-end="152.09">around that, like layout boxes.</span> </p>
<p><span data-start="152.09" data-end="154.58">We might even call these components.</span> <span data-start="154.58" data-end="160.03">And obviously this application has multiple widgets, those widgets have titles.</span> <span data-start="160.03" data-end="161.66">We can start to see some common themes.</span> <span data-start="161.66" data-end="167.15">I had some color coding so the menu has menu items and I've outlined that with purple and</span> <span data-start="167.15" data-end="170.76">widgets I've outlined with red and the titles I've outlined with yellow.</span> <span data-start="170.76" data-end="175.33">So you can see these patterns of repeating piece that is repeat over and over again,</span> <span data-start="175.33" data-end="181.01">and this big problem was broken down into small pieces and built up to make this complex</span> <span data-start="181.01" data-end="183.73">dashboard application.</span> <span data-start="183.73" data-end="186.96">So how would we target that email icon?</span> <span data-start="186.96" data-end="189.87">So maybe we wanted to click on it.</span> <span data-start="189.87" data-end="191.62">So that one right there.</span> <span data-start="191.62" data-end="198.87">So we might choose the first option I had, which was a selector.</span> <span data-start="198.87" data-end="201.46">This is an option, this is called Xpath.</span> </p>
<p><span data-start="201.46" data-end="203.96">Hopefully you don't use that.</span> <span data-start="203.96" data-end="204.96">It's very fragile.</span> <span data-start="204.96" data-end="209">You can see the numbers in brackets, like 3, that's the third div under the body and</span> <span data-start="209" data-end="214.459">there was a second div under that one and then they anchor tagged.</span> <span data-start="214.459" data-end="216.02">You can maybe use a class.</span> <span data-start="216.02" data-end="219.81">That seems a little more stable, maybe.</span> <span data-start="219.81" data-end="222.27">That was a problem we had with our offshore team.</span> <span data-start="222.27" data-end="225.49">They tried to figure what selector would be best.</span> <span data-start="225.49" data-end="233.77">Obviously Xpath tried too often, so they tried class names.</span> <span data-start="233.77" data-end="236.17">So another option might be like a data test ID.</span> <span data-start="236.17" data-end="239.099">That is something that we could control and it made it a little bit more obvious that</span> <span data-start="239.099" data-end="243.24">that was something specifically for testing so that developers didn't accidentally change</span> <span data-start="243.24" data-end="246.87">that too often.</span> </p>
<p><span data-start="246.87" data-end="249.07">But then the next question is where do these selectors go?</span> <span data-start="249.07" data-end="250.74">Where do you put them?</span> <span data-start="250.74" data-end="253.91">So one option is co-located with your source code.</span> <span data-start="253.91" data-end="259">That seems like a pretty obvious choice, I've got the import React statement at the top</span> <span data-start="259" data-end="268.001">and I've just name it data test ID email so now you can grab that selector and you can</span> <span data-start="268.001" data-end="269.47">match that icon.</span> </p>
<p><span data-start="269.47" data-end="276.56">You can see that that's matched to the ID inside that email component.</span> <span data-start="276.56" data-end="278.06">So some pros and cons.</span> <span data-start="278.06" data-end="280.25">So it's very easy at the unit testing level.</span> <span data-start="280.25" data-end="282">It's nice and co-located.</span> <span data-start="282" data-end="283.68">It's easy to tell where it is.</span> <span data-start="283.68" data-end="290.68">It could be bad for end to end testing, so I don't work for Cypress, but I've contributed</span> <span data-start="290.68" data-end="295.47">there, so they gave me a nice t-shirt so if you do this in a Cypress test the way they</span> <span data-start="295.47" data-end="302.75">do that is every test becomes its own application that it wraps up  —  it injects itself into</span> <span data-start="302.75" data-end="309.72">your application's page, so what ends up happening is instead of just grabbing all of your test</span> <span data-start="309.72" data-end="314.21">code, it also is now grabbing the whole of React, so that can be bad.</span> </p>
<p><span data-start="314.21" data-end="319.24">It will slow down your test, because it has to compile and parse and all that the entire</span> <span data-start="319.24" data-end="322.59">application, not just test code.</span> <span data-start="322.59" data-end="326.4">So the next thing that we tried doing was doing a global selectors file where we just</span> <span data-start="326.4" data-end="329.06">listed out and tried to add names to all the selectors.</span> <span data-start="329.06" data-end="334.65">Now, this is a nice list because everything has test IDs, but we had complicated CSS selectors</span> <span data-start="334.65" data-end="335.65">before.</span> <span data-start="335.65" data-end="338.59">It was a little bit more obvious.</span> <span data-start="338.59" data-end="342.73">What was nice is this was in our source code so that we could at least see where it was,</span> <span data-start="342.73" data-end="349.18">whereas before it was in a different repository in a different technology that we didn't have</span> <span data-start="349.18" data-end="350.18">secure access to.</span> <span data-start="350.18" data-end="353.74">So we couldn't even see what selectors the offshore team chose.</span> <span data-start="353.74" data-end="355.4">So this was at least a little bit better.</span> <span data-start="355.4" data-end="361.4">We could import them all and at the bottom we just said, this is all my examples are</span> <span data-start="361.4" data-end="364.49">in Cypress, but this could work for any testing framework.</span> <span data-start="364.49" data-end="373.59">So we just got this, you just we just called it cy.get.</span> </p>
<p><span data-start="373.59" data-end="379.51">Pros and cons with that, it's easy to tell where everything is at once, but it's not</span> <span data-start="379.51" data-end="384.08">modular if you've done some Redux stuff and you have all of your reactions in one place,</span> <span data-start="384.08" data-end="388.71">that works pretty well until you get to a certain scale and then that file is just huge</span> <span data-start="388.71" data-end="394.19">and you accidentally add selectors multiple times, because the list is too long.</span> <span data-start="394.19" data-end="400.09">So you could have local selector files, so that's what we ended up moving to next.</span> <span data-start="400.09" data-end="407.889">So we had each area had its own kind of selector thing, so all the icons had a selector, and</span> <span data-start="407.889" data-end="415.8">then all of the like maybe cards had a selector, and then just in the index file we just exported</span> <span data-start="415.8" data-end="423.33">everything, so now we could just do name spacing so now I have a cy.get selectors is a little</span> <span data-start="423.33" data-end="425.02">bit cleaner.</span> <span data-start="425.02" data-end="430.52">So it was more modular, but then we quickly ran into an issue where are selectors powerful</span> <span data-start="430.52" data-end="432.699">enough?</span> <span data-start="432.699" data-end="438.1">We have complex applications so we have more and more complex interactions to do something</span> <span data-start="438.1" data-end="439.4">that we wanted to do.</span> </p>
<p><span data-start="439.4" data-end="443.97">It's pretty easy to describe in English, but it was harder to do in our implementation,</span> <span data-start="443.97" data-end="446.93">especially if it had to be repeated.</span> <span data-start="446.93" data-end="451.49">So how do you target an item in this to do and then check it off?</span> <span data-start="451.49" data-end="454.84">So I'm talking about this one down here.</span> </p>
<p><span data-start="454.84" data-end="459.79">So if theirs one, you might do, maybe you'd say that could be that Xpath or maybe you'd</span> <span data-start="459.79" data-end="466.6">get all the to-do items and pick the first one, but maybe we want to just grab it by</span> <span data-start="466.6" data-end="469.06">something that we can see within the application.</span> <span data-start="469.06" data-end="471.43">So we might want to grab it by that name.</span> <span data-start="471.43" data-end="476.87">Now, some of you might be alluding to the next part.</span> <span data-start="476.87" data-end="482.979">Could we just use  —  oops, sorry, that took a little bit.</span> <span data-start="482.979" data-end="488.389">This is too complicated for our selector, so we had to look for something else.</span> <span data-start="488.389" data-end="495.79">So I said before, all our examples are in Cypress, but it could work in any framework.</span> <span data-start="495.79" data-end="501.13">So then it was routed into testing library.</span> </p>
<p><span data-start="501.13" data-end="515.899">That added adapters for a bunch of different things, including React, Vue, Marco, cypress</span> <span data-start="515.899" data-end="521.879">and others.</span> <span data-start="521.879" data-end="524.889">But it's on one of the listed as one of their adapters.</span> <span data-start="524.889" data-end="529.91">So I thought that was pretty cool because kind of along that same idea.</span> <span data-start="529.91" data-end="537.68">So this is if you are using the to-do, using the testing library with the Cypress adapter,</span> <span data-start="537.68" data-end="543.42">you would use query by text and just say upgrade to SSD hard disks and then would you click</span> <span data-start="543.42" data-end="548.68">on it and then hopefully it doesn't work with how Sentra interacts with its application,</span> <span data-start="548.68" data-end="564.05">but that's cool if it works with the library which is around text and what about if it</span> <span data-start="564.05" data-end="571.829">is a little more specific where it doesn't quite work like a modern application the DOM</span> <span data-start="571.829" data-end="572.829">would work.</span> </p>
<p><span data-start="572.829" data-end="576.98">So you'd need something a little bit more custom to get the right thing.</span> <span data-start="576.98" data-end="580.529">So I coined it as component helpers.</span> <span data-start="580.529" data-end="583.639">Or basically component helper functions or helper functions.</span> <span data-start="583.639" data-end="585.949">We had a few different names for it.</span> <span data-start="585.949" data-end="587.79">So they look kind of like this.</span> <span data-start="587.79" data-end="600.48">So the first thing I did is just created a function called getto dobynow, the only place</span> <span data-start="600.48" data-end="605.3">that selector is available is inside of the helper itself, so your test code doesn't deal</span> <span data-start="605.3" data-end="607.629">with it at all.</span> </p>
<p><span data-start="607.629" data-end="609.589">The next with is giving it a check box.</span> <span data-start="609.589" data-end="618.19">And the last one is getting we want to check that to-do item and you can see I'm starting</span> <span data-start="618.19" data-end="622.209">to compose some of those helpers within the same file together.</span> <span data-start="622.209" data-end="627.22">So a check to-do item is now getting that item by its name.</span> <span data-start="627.22" data-end="632.279">It's getting the check box out of it and then it's clicking on it.</span> <span data-start="632.279" data-end="636.139">So it kind of looks like this.</span> <span data-start="636.139" data-end="641.87">We want the first check that to do item and then we wanted to grab it and get the check</span> <span data-start="641.87" data-end="646.61">box and do an assertion on it and make sure that it's checked.</span> <span data-start="646.61" data-end="651.87">now, you notice there's no selectors in T it's kind of the whole thing around page objects</span> <span data-start="651.87" data-end="655.89">where you're not dealing with the underlying driver directly, you're working at a little</span> <span data-start="655.89" data-end="664.519">bit higher level of abstraction it's not exactly like English, but it's fairly easy to read</span> <span data-start="664.519" data-end="666.8">and understand what's going to happen.</span> </p>
<p><span data-start="666.8" data-end="670.519">This worked well for our PMs and our QA to be able to have some confidence that we were</span> <span data-start="670.519" data-end="675.759">doing the testing that we wanted to do and that we said we were doing.</span> <span data-start="675.759" data-end="681.059">So other components, obviously like a button probably doesn't need much for helpers, because</span> <span data-start="681.059" data-end="686.509">all you can really do is click on it and maybe assert on its text.</span> <span data-start="686.509" data-end="688.1">But there could be other things.</span> <span data-start="688.1" data-end="690.139">So components with portaled content.</span> <span data-start="690.139" data-end="693.389">Now, portal is kind of something that was coined by React.</span> <span data-start="693.389" data-end="698.209">I think in Angular 4 they call it transfusion, but it's basically calling content and projecting</span> <span data-start="698.209" data-end="702.69">it to another place in the portal tree.</span> <span data-start="702.69" data-end="708.97">So if you can imagine a modal is like a picture frame and you want to take this picture and</span> <span data-start="708.97" data-end="712.22">shove it into the frame.</span> <span data-start="712.22" data-end="716.589">So that's what I'd describe as portaled content.</span> <span data-start="716.589" data-end="718.85">Something that moves somewhere else.</span> </p>
<p><span data-start="718.85" data-end="721.6">Portal specifically is going to be something different in the DOM.</span> <span data-start="721.6" data-end="726.529">So it's not not going to be a direct child.</span> <span data-start="726.529" data-end="731.089">It's going to be basically put at the bottom of the DOM so it's not confined by the overflow</span> <span data-start="731.089" data-end="735.149">of the container of the target.</span> <span data-start="735.149" data-end="741.449">So modals will do that so that it's not clipped by whatever that target is contained in.</span> <span data-start="741.449" data-end="746.72">So that can be tricky, because it's not  —  you can't just find t you can't just take the</span> <span data-start="746.72" data-end="748.38">target and do a dot-find.</span> <span data-start="748.38" data-end="753.37">But now it's going to be scoped to the document instead of that component.</span> <span data-start="753.37" data-end="759.339">So hierarchical menus, if we have multiple layers of a menu, you have to click on it</span> <span data-start="759.339" data-end="763.85">and then you have to find your item and click on it and it opens up another submenu and</span> <span data-start="763.85" data-end="765.47">then you want to click on it.</span> <span data-start="765.47" data-end="769.99">That can be more complex where you just want to describe the hierarchy of it to select</span> <span data-start="769.99" data-end="772.149">what you want.</span> <span data-start="772.149" data-end="774.699">Another one might be combo boxes.</span> <span data-start="774.699" data-end="780.639">We might have some complicated things around how you'd select things.</span> <span data-start="780.639" data-end="786.009">Cards, you might want to say I want a card of some domain type.</span> </p>
<p><span data-start="786.009" data-end="792.54">Like I worked in a cybersecurity company so we had things like alarm cards and case cards,</span> <span data-start="792.54" data-end="796.829">so we wanted to just select that card by its name, but we wanted to get the card and not</span> <span data-start="796.829" data-end="801.92">the text, so we could just have a component that would grab the card by whatever the name</span> <span data-start="801.92" data-end="804.149">contained or ID.</span> <span data-start="804.149" data-end="808.459">And then return that card and do other actions on it, like change the status.</span> <span data-start="808.459" data-end="814.649">Dashboard widgets, similar to the example that I had, and the biggest one at the company</span> <span data-start="814.649" data-end="815.73">I worked with was virtual lists.</span> <span data-start="815.73" data-end="819.639">We had virtual lists for everything, which definitely made testing things harder because</span> <span data-start="819.639" data-end="824.929">we couldn't just grab something in the DOM and then click on it, because it didn't exist</span> <span data-start="824.929" data-end="827.399">in the DOM, it was virtual.</span> </p>
<p><span data-start="827.399" data-end="832.6">So now I've got a demo of how I've done that using React select virtualize, I don't know</span> <span data-start="832.6" data-end="834.679">if anyone has ever used that before.</span> <span data-start="834.679" data-end="839.189">So this is kind of what it looks like.</span> <span data-start="839.189" data-end="844.42">This is with 8,000 items in it, so as I'm scrolling, it will actually keep going.</span> <span data-start="844.42" data-end="849.109">It's opening and closing pretty instantly because it's only rendering exactly what you</span> <span data-start="849.109" data-end="850.54">see.</span> </p>
<p><span data-start="850.54" data-end="860.449">You can just go on and you can scroll quickly and get to everything.</span> <span data-start="860.449" data-end="868.75">So I've got a simple spec here that just grabs it, so this is without any component helpers,</span> <span data-start="868.75" data-end="872.879">this is just we are going to grab it, we have to know what the selector is it going to be.</span> <span data-start="872.879" data-end="876.629">We have to know what the next thing is going to be, which in this case I want to open t</span> <span data-start="876.629" data-end="881.29">I want to find something that contains the number 5 and now I'm going to click on it</span> <span data-start="881.29" data-end="885.139">and I want to make an assertion that it still contains that 5.</span> <span data-start="885.139" data-end="889.889">So I have to know the implementation details of how this works.</span> <span data-start="889.889" data-end="894.769">So I've got the first test and this is what it looks like.</span> <span data-start="894.769" data-end="900.6">It should just work, it looks fine, so why would I need any helper for this?</span> <span data-start="900.6" data-end="908.74">Well, if the item I happen to want to be selecting is not on the first viewable page right now,</span> <span data-start="908.74" data-end="911.42">that's an implementation detail for how the component works.</span> <span data-start="911.42" data-end="917.439">So let's say I want to select the item number 100 so we'll just change this right here to</span> <span data-start="917.439" data-end="920.699">100.</span> </p>
<p><span data-start="920.699" data-end="927.529">Now, this should reload and it's going to sit here and wait and it will eventually fail,</span> <span data-start="927.529" data-end="933.98">because it can't actually click on an option that has the string 100 on it, because it's</span> <span data-start="933.98" data-end="934.98">down there.</span> <span data-start="934.98" data-end="940.579">Now, interestingly enough, if I refresh this, and manually scroll it down to the item of</span> <span data-start="940.579" data-end="943.879">100, it will pass.</span> <span data-start="943.879" data-end="950.22">So to movement people that just happens to be an implementation detail.</span> <span data-start="950.22" data-end="954.639">All I really want to do is select a specific item in this list, the fact that it's virtualized.</span> <span data-start="954.639" data-end="960.899">I don't really care about it.</span> <span data-start="960.899" data-end="964.85">I shouldn't really have to care about that difference.</span> </p>
<p><span data-start="964.85" data-end="968.649">But it went through and it did everything that you you would expect.</span> <span data-start="968.649" data-end="970.41">It grabbed this item by the selection.</span> <span data-start="970.41" data-end="973.209">It went ahead and clicked on it.</span> <span data-start="973.209" data-end="978.689">Then it found an item that contains 100, it clicked on it and then it ran an expectation</span> <span data-start="978.689" data-end="984.54">against that to make sure it contained this this dash 100 on there.</span> </p>
<p><span data-start="984.54" data-end="990.66">So I just looked at the implementation of React select virtualize, I'd never actually</span> <span data-start="990.66" data-end="994.629">used it before, so it just made those helpers.</span> <span data-start="994.629" data-end="1000.829">So I made some way of getting the component so that you could just call t you just import</span> <span data-start="1000.829" data-end="1006.669">this function and then you just call it: Then the select was a little interesting.</span> <span data-start="1006.669" data-end="1011.66">So what I ended up doing was I first grabbed that element and I'd click on it, just to</span> <span data-start="1011.66" data-end="1016.369">open it, then I'd end up getting this selector here, which normally you never have to think</span> <span data-start="1016.369" data-end="1017.369">about.</span> <span data-start="1017.369" data-end="1022.419">But this is the overflow container that contains all the virtualization.</span> <span data-start="1022.419" data-end="1024.85">So what I'm doing is I'm scrolling that.</span> <span data-start="1024.85" data-end="1031.29">So I'm sending a scroll event, I'm telling that container to scroll a little bit and</span> <span data-start="1031.29" data-end="1035.45">doing an assertion on it to see if the item I wanted it is there and if it's not I'll</span> <span data-start="1035.45" data-end="1043.2">tell it to keep scrolling and I'm telling it to make sure that React fully fleshes to</span> <span data-start="1043.2" data-end="1045.06">the DOM before that's done.</span> <span data-start="1045.06" data-end="1049.76">So here's the implementation of scroll, too, so this component opens it, or this helper</span> <span data-start="1049.76" data-end="1055.24">opens it, it grabs that container, it tells it to scroll, too, and it gives it a nice</span> <span data-start="1055.24" data-end="1056.69">long timeout.</span> </p>
<p><span data-start="1056.69" data-end="1062.69">The default is 4 seconds and it might take us longer, so I set that to 10 seconds.</span> <span data-start="1062.69" data-end="1065.93">Then once I've found it then I'm going to go ahead and click on it.</span> <span data-start="1065.93" data-end="1069.24">So what the scroll tool does is it's an async function.</span> <span data-start="1069.24" data-end="1076.06">It turns into a match that returns an async function that contains that element and it</span> <span data-start="1076.06" data-end="1082.89">will continuously see if there's any node in this node list that contains that string</span> <span data-start="1082.89" data-end="1089.71">that you gave it and if it doesn't, if the length is 0, it will make sure that the DOM</span> <span data-start="1089.71" data-end="1091.53">has been properly flushed.</span> <span data-start="1091.53" data-end="1102.51">It will set the scroll top to be + 20.</span> <span data-start="1102.51" data-end="1104.53">But it's hard to see what's going on.</span> <span data-start="1104.53" data-end="1110.77">So after that, then it just calls scroll top, sets it to the new scroll top selection, and</span> <span data-start="1110.77" data-end="1116.88">when it does, it will return that element so it can be clicked on later.</span> <span data-start="1116.88" data-end="1127.45">So what that ends up looking like, so I'm going to select that item No. 100.</span> <span data-start="1127.45" data-end="1134.65">And now I'm using my nice array API so I'm calling a get select.</span> <span data-start="1134.65" data-end="1140.77">I'm using pipe, so if people have used Cypress before, pipe is a plugin that I've made.</span> <span data-start="1140.77" data-end="1150.57">It's similar to .then, and then I just pipe in that end selection that I imported and</span> </p>
<p><span data-start="1150.57" data-end="1158.23">I give it what string I want it to match and then I'm doing an assertion of that containing</span> <span data-start="1158.23" data-end="1161.23">this text string.</span> <span data-start="1161.23" data-end="1163.98">So now this is what it ends up looking like.</span> <span data-start="1163.98" data-end="1168.04">It's going to scroll through automatically on its own and find the thing.</span> <span data-start="1168.04" data-end="1169.39">The right item.</span> </p>
<p><span data-start="1169.39" data-end="1172.1">So now I don't actually care if it's virtualized or not.</span> <span data-start="1172.1" data-end="1174.38">If it happens to be viewable or not.</span> <span data-start="1174.38" data-end="1177.5">It will just run through.</span> <span data-start="1177.5" data-end="1180.33">Now when I talked about pipe, this is what pipe gives me.</span> <span data-start="1180.33" data-end="1182.28">It gives me a nice little item here.</span> <span data-start="1182.28" data-end="1191.19">It tells me what function is called as well as a before and after of that call.</span> <span data-start="1191.19" data-end="1200.98">So if you use a .then, it doesn't actually show you any nice things in the log here.</span> <span data-start="1200.98" data-end="1205.36">So I'll slow that down a little bit and we'll watch that.</span> <span data-start="1205.36" data-end="1209.61">It's kind of fun to watch when it's running so we'll slow it down to maybe like 8 pixels</span> <span data-start="1209.61" data-end="1211.93">at a time.</span> </p>
<p><span data-start="1211.93" data-end="1219.64">So you can it's scrolling a lot slower, but it's the same basic concept.</span> <span data-start="1219.64" data-end="1225.07">And then once it finds the item it will either time out because it can't find it or it will</span> <span data-start="1225.07" data-end="1232.09">scroll enough that it finds it, it will select it and then it will move on.</span> <span data-start="1232.09" data-end="1240.62">All right.</span> </p>
<p><span data-start="1240.62" data-end="1247.64">So component helpers help us abstract our implementation details.</span> <span data-start="1247.64" data-end="1252.79">Just like components are a contract for developing our UI, component helpers are a contract for</span> <span data-start="1252.79" data-end="1259.39">testing our UI.</span> <span data-start="1259.39" data-end="1263.97">So we've  —  we ended up proving this over the course of two years, but the implementation</span> <span data-start="1263.97" data-end="1271.25">can be tested.</span> <span data-start="1271.25" data-end="1276">As long as our implementation, our component helpers are updated with the implementation,</span> <span data-start="1276" data-end="1277.93">nothing ended up breaking.</span> </p>
<p><span data-start="1277.93" data-end="1285.38">How we ended up doing it is our component library was pushed into our local NPM repository.</span> <span data-start="1285.38" data-end="1291.4">Our helpers were also pushed to that name repository under a like a /helpers.</span> <span data-start="1291.4" data-end="1297.44">So our CI was tied to testing out our helpers of our components so we so we could guarantee</span> <span data-start="1297.44" data-end="1304.22">that as long as our APIs did not change, the application test did not break.</span> <span data-start="1304.22" data-end="1309.67">If they did, our CI would catch it before it ever got to that point.</span> <span data-start="1309.67" data-end="1317.1">So what ended up happening is all of our application failures are because the application was breaking,</span> <span data-start="1317.1" data-end="1322.76">not because the components changed.</span> </p>
<p><span data-start="1322.76" data-end="1326.28">So component helpers can be composed.</span> <span data-start="1326.28" data-end="1333.82">So we ended up proving this out for  —  we had a multiple component libraries, and the</span> <span data-start="1333.82" data-end="1340.85">leaf node, the lowest Level 1 of our design system, it had these component helpers for</span> <span data-start="1340.85" data-end="1347.4">the very, very basic low-level components, and those were consumed by higher-level component</span> <span data-start="1347.4" data-end="1352.14">libraries, and those were consumed by widget repositories.</span> <span data-start="1352.14" data-end="1354.83">And then eventually it was consumed by the application.</span> <span data-start="1354.83" data-end="1360.26">So each level created their own helper abstraction layer and it kind of built on top of it.</span> <span data-start="1360.26" data-end="1365.69">So when we had more within our dashboard example we had some of those widgets or those apps.</span> <span data-start="1365.69" data-end="1370.63">They had some complex interactions and we just had easier ways of dealing with them.</span> <span data-start="1370.63" data-end="1374.68">One of them was like an identity list and it was using this idea where it would scroll</span> <span data-start="1374.68" data-end="1382.78">through identities and if it expected there to be an anonymous identity risk above a certain</span> <span data-start="1382.78" data-end="1389.61">level, it made it easier to give it some risk that we wanted it to test against and then</span> <span data-start="1389.61" data-end="1395.79">grab it and then move on.</span> <span data-start="1395.79" data-end="1398.96">So here are some of the links that I had.</span> <span data-start="1398.96" data-end="1403.08">First one is design.workday.com.</span> <span data-start="1403.08" data-end="1405.81">There's the ReactDOM testing library.</span> </p>
<p><span data-start="1405.81" data-end="1417.85">I have a link to the Sencha dashboard that I had and then cypress.io, there's no timer</span> <span data-start="1417.85" data-end="1420.42">up here so I have no idea where I'm at.</span> </p>
</section>

<section>
<p><span data-start="1420.42" data-end="1422.68"><span class="speaker">Audience</span>: 1:51.</span> <span data-start="1422.68" data-end="1428.43"Audience member: And this talk is supposed to end  —  I'm actually done.</span> <span data-start="1428.43" data-end="1430.341">I hope I didn't leave too much time left.</span> <span data-start="1430.341" data-end="1431.341">[laughter] [applause]</span> <span data-start="1431.341" data-end="1432.341">Everybody, we ended a bit early, if you go out to registration, we actually have swag</span> <span data-start="1432.341" data-end="1433.341">bags and this would be a good time to go get them.</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
