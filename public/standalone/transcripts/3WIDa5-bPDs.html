<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>3WIDa5-bPDs</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/3WIDa5-bPDs?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="0.12" data-end="10.4">you</span> <span data-start="10.41" data-end="13.809">so in 1989 Tim berners-lee first</span> <span data-start="13.809" data-end="15.79">proposed the world wide web project and</span> <span data-start="15.79" data-end="18.039">with that he'd his team at CERN invented</span> <span data-start="18.039" data-end="22.15">HTTP and HTML the first implementation</span> <span data-start="22.15" data-end="25.02">had one HP method and it was gap and</span> <span data-start="25.02" data-end="29.22">every response returned a HTML page</span> <span data-start="29.22" data-end="32.02">years before the creation of JPEGs or</span> <span data-start="32.02" data-end="35.95">Windows 3.1 with just HTTP and HTML the</span> <span data-start="35.95" data-end="38.5">first-ever web page was deployed and was</span> <span data-start="38.5" data-end="42.85">responsive as the first version of HTTP</span> <span data-start="42.85" data-end="46.36">was documented in 1991 multiple versions</span> <span data-start="46.36" data-end="47.62">and revisions over the next eight years</span> <span data-start="47.62" data-end="51.37">in a period of rapid evolution until</span> <span data-start="51.37" data-end="55.079">until HTTP 1.1 was finalized in 1999 and</span> <span data-start="55.079" data-end="58.3">what internet was born they should be</span> <span data-start="58.3" data-end="60.19">1.1 is what most of us would know is HP</span> <span data-start="60.19" data-end="61.899">one what most websites run on at the</span> <span data-start="61.899" data-end="64.96">moment so I may use HP 11.1 it to change</span> <span data-start="64.96" data-end="66.939">ibly but they're the same thing for the</span> <span data-start="66.939" data-end="71.799">extent of this talk in the preceding 20</span> <span data-start="71.799" data-end="73.479">years generations of developers use</span> <span data-start="73.479" data-end="74.979">these simple building blocks to create</span> <span data-start="74.979" data-end="77.02">engaging experiences of communities for</span> <span data-start="77.02" data-end="78.789">journalists musicians artists designers</span> <span data-start="78.789" data-end="80.679">crafters gamers and everything in</span> <span data-start="80.679" data-end="83.439">between we went from 386 s the Pentiums</span> <span data-start="83.439" data-end="85.299">to watches it more computing power than</span> <span data-start="85.299" data-end="87.429">the Space Shuttle has said people to the</span> <span data-start="87.429" data-end="92.319">moon we added JavaScript CSS images and</span> <span data-start="92.319" data-end="93.759">most importantly gifts to our toolbox</span> <span data-start="93.759" data-end="96.189">and with them we built new ways to</span> <span data-start="96.189" data-end="97.63">connect to communicate share in our</span> <span data-start="97.63" data-end="99.249">lives and engage with the world around</span> <span data-start="99.249" data-end="102.939">us the hypertext Transfer Protocol of</span> <span data-start="102.939" data-end="104.229">the revolutionary for its time is</span> <span data-start="104.229" data-end="105.429">crumbling under the weight of our modern</span> <span data-start="105.429" data-end="107.919">ambitions the design of the protocols at</span> <span data-start="107.919" data-end="109.329">odds with what we as developers are</span> <span data-start="109.329" data-end="110.979">building and with what our customers</span> <span data-start="110.979" data-end="116.259">expect in 1999 google announced they're</span> <span data-start="116.259" data-end="117.729">working internally on a modern revision</span> <span data-start="117.729" data-end="120.639">of HTTP they named a speedy speedy</span> <span data-start="120.639" data-end="122.049">primarily focus on reducing latency</span> <span data-start="122.049" data-end="124.479">which as a result had larger performance</span> <span data-start="124.479" data-end="127.119">improvements of HTTP one significant</span> <span data-start="127.119" data-end="128.619">performance improvements to rapid</span> <span data-start="128.619" data-end="129.91">adoption of the new protocol and</span> <span data-start="129.91" data-end="131.379">browsers and large sites like Facebook</span> <span data-start="131.379" data-end="136">and Google in 2012 looking to revitalize</span> </p>
<p><span data-start="136" data-end="136.81">HTTP to</span> <span data-start="136.81" data-end="139.84">nuvo HP with new version working group</span> <span data-start="139.84" data-end="141.61">took speedy and made it the initial spec</span> <span data-start="141.61" data-end="145.45">for HTTP to nature to spec was finalized</span> <span data-start="145.45" data-end="148.18">last year and as of now all major</span> <span data-start="148.18" data-end="149.86">browsers and web server support in the</span> <span data-start="149.86" data-end="154.03">HTTP 20 Spidey speedy for better or for</span> <span data-start="154.03" data-end="156.61">worse the story of HTTP two has become</span> <span data-start="156.61" data-end="158.26">tired to notions of free performance and</span> <span data-start="158.26" data-end="159.099">help make everything that web</span> <span data-start="159.099" data-end="161.38">performance sprung unfortunately the</span> <span data-start="161.38" data-end="163.06">promise of free performance comes with</span> <span data-start="163.06" data-end="164.59">some fine print and that's what I'm here</span> <span data-start="164.59" data-end="170.28">to talk about today so uh hi I'm Michael</span> </p>
<p><span data-start="170.28" data-end="173.739">I'm from Australia and I'm a front-end</span> <span data-start="173.739" data-end="176.65">performance engineer at 99designs and as</span> <span data-start="176.65" data-end="178.39">was said earlier and one of the</span> <span data-start="178.39" data-end="180.13">organizers of CSS company has confessed</span> <span data-start="180.13" data-end="182.44">rally on and i work on suburban source</span> <span data-start="182.44" data-end="183.819">projects you might be familiar with in</span> <span data-start="183.819" data-end="188.11">nerd Sasson lips eyes i want to start</span> <span data-start="188.11" data-end="189.22">off by saying what this talk won't be</span> <span data-start="189.22" data-end="192.28">about this is not insured HTTP to a lot</span> <span data-start="192.28" data-end="193.48">of great material out there a lot of</span> <span data-start="193.48" data-end="195.43">great talks and blog posts that could do</span> <span data-start="195.43" data-end="197.88">much better than I could in this time</span> <span data-start="197.88" data-end="200.17">what I will be talking about is some of</span> <span data-start="200.17" data-end="202.03">the differences when HTTP one HTTP two</span> <span data-start="202.03" data-end="204.42">and what this can mean for performance i</span> <span data-start="204.42" data-end="206.56">will quickly cover some fundamentals</span> <span data-start="206.56" data-end="207.579">necessary to illustrate these</span> <span data-start="207.579" data-end="210.07">differences so if networking protocols</span> <span data-start="210.07" data-end="212.2">in HTTP aren't your thing don't worry i</span> <span data-start="212.2" data-end="216.209">got you covered so let's jump right in</span> <span data-start="216.209" data-end="220">all in all HTTP is fairly simple you</span> <span data-start="220" data-end="221.53">connect to a server and then with a</span> <span data-start="221.53" data-end="223.239">small set of commands you instruct the</span> <span data-start="223.239" data-end="224.65">server perform some action and it</span> <span data-start="224.65" data-end="227.47">responds these actions issued as HTTP</span> <span data-start="227.47" data-end="231.519">methods in requests and metadata the</span> <span data-start="231.519" data-end="234.09">most common method being the get method</span> <span data-start="234.09" data-end="236.889">we instruct HTTP server to respond with</span> <span data-start="236.889" data-end="239.01">the contents of a file at a certain path</span> <span data-start="239.01" data-end="241.209">this simple interaction is largely</span> <span data-start="241.209" data-end="243.489">unchanged in the 25 years since tim</span> <span data-start="243.489" data-end="248.44">berners-lee created HTML HTTP they're a</span> <span data-start="248.44" data-end="250.09">bunch of other methods that I won't</span> <span data-start="250.09" data-end="251.44">cover today but for the most part of</span> <span data-start="251.44" data-end="253.63">boils down to a client in our case a</span> <span data-start="253.63" data-end="255.639">browser connects to a server and</span> <span data-start="255.639" data-end="259">requests something with metadata and a</span> <span data-start="259" data-end="261.43">method and the server responds with</span> <span data-start="261.43" data-end="263.95">content something like CSS HTML</span> </p>
<p><span data-start="263.95" data-end="268.84">Javascript underlying all this is our</span> <span data-start="268.84" data-end="271.419">tcp/ip this is the primary networking</span> <span data-start="271.419" data-end="273.46">protocol for all HP communication and</span> <span data-start="273.46" data-end="277.36">for the Internet in general it's with</span> <span data-start="277.36" data-end="279.55">this it's with these two protocols TCP</span> <span data-start="279.55" data-end="283.18">and IP that the two remote servers are</span> <span data-start="283.18" data-end="284.349">able to communicate and exchange</span> <span data-start="284.349" data-end="288.28">information efficiently being that it is</span> <span data-start="288.28" data-end="290.14">the primary protocol underpinning most</span> <span data-start="290.14" data-end="291.88">to the internet it's integral part of</span> <span data-start="291.88" data-end="293.14">what network performance is like when</span> <span data-start="293.14" data-end="296.349">using it so we'll cover that a bit one</span> <span data-start="296.349" data-end="299.62">of the important things of tcp/ip is the</span> <span data-start="299.62" data-end="302.11">connection and that involves a three-way</span> <span data-start="302.11" data-end="305.729">handshake essentially a client say your</span> <span data-start="305.729" data-end="308.38">browser will set will check to a server</span> <span data-start="308.38" data-end="311.169">and say hey Here I am with a syn packet</span> <span data-start="311.169" data-end="314.32">and a browser will say Here I am I see</span> <span data-start="314.32" data-end="316.57">you with a syn ACK packet and their clan</span> <span data-start="316.57" data-end="318.88">will be like I see you at the next are</span> <span data-start="318.88" data-end="323.02">communicating the details this aren't</span> <span data-start="323.02" data-end="324.34">particularly important the important</span> <span data-start="324.34" data-end="326.02">thing to take away from this is it takes</span> <span data-start="326.02" data-end="329.26">a full networking round trip from you to</span> <span data-start="329.26" data-end="330.88">the server on server back to you before</span> <span data-start="330.88" data-end="335.26">you can exchange any information so we</span> <span data-start="335.26" data-end="337">look at the anatomy of a request for a</span> <span data-start="337" data-end="340.169">page say the index HTML page first</span> <span data-start="340.169" data-end="342.37">client say the browser connects to a</span> <span data-start="342.37" data-end="344.86">server I do a handshake at one round</span> <span data-start="344.86" data-end="348.219">trip and then the browser can say hey</span> <span data-start="348.219" data-end="351.43">give me index dot HTML that goes to</span> <span data-start="351.43" data-end="353.05">server server does some work generates</span> <span data-start="353.05" data-end="355.03">the page rather be WordPress or a static</span> <span data-start="355.03" data-end="357.13">file the returns response in this case</span> </p>
<p><span data-start="357.13" data-end="360.64">HTML and that connection is closed if in</span> <span data-start="360.64" data-end="362.74">that response HTML there was a link to a</span> <span data-start="362.74" data-end="365.62">CSS file that process starts again you</span> <span data-start="365.62" data-end="368.169">find the server you handshake you then</span> <span data-start="368.169" data-end="370.51">request the server for a thing the</span> <span data-start="370.51" data-end="371.919">server does some work and returns it to</span> <span data-start="371.919" data-end="374.83">you and that connection is closed so</span> <span data-start="374.83" data-end="376.75">this is for round trips in total to ask</span> <span data-start="376.75" data-end="381.58">for a HTML file and a CSS file and this</span> <span data-start="381.58" data-end="384.18">this is important because one of the</span> <span data-start="384.18" data-end="386.83">fundamental things of tcp and white is</span> <span data-start="386.83" data-end="389.38">so reliable is it is a FIFO queue so</span> <span data-start="389.38" data-end="391.15">first in first out so the first thing a</span> <span data-start="391.15" data-end="393.28">server sends to you must be the first</span> <span data-start="393.28" data-end="394.66">thing you receive and your receipt and</span> <span data-start="394.66" data-end="395.82">you read them in order</span> <span data-start="395.82" data-end="397.38">if for some reason along the way due to</span> <span data-start="397.38" data-end="399.87">congestion or happenstance one of the</span> <span data-start="399.87" data-end="401.55">one of the Packers of data has dropped</span> <span data-start="401.55" data-end="403.8">on the floor or sequential packets are</span> <span data-start="403.8" data-end="405.75">just held by this by the client and</span> <span data-start="405.75" data-end="408.51">buffered and not read until we're able</span> <span data-start="408.51" data-end="410.1">to tell the server that hey we missed</span> <span data-start="410.1" data-end="411.81">something please resend it and then it</span> <span data-start="411.81" data-end="413.13">receives that and then reads the rescue</span> <span data-start="413.13" data-end="414.84">services that are it's a bit more</span> <span data-start="414.84" data-end="416.25">complicated than that but that's really</span> <span data-start="416.25" data-end="419.22">what we need for this talk and this will</span> <span data-start="419.22" data-end="420.51">happens at a layer well below anything</span> <span data-start="420.51" data-end="422.25">we see this is a networking layer in</span> <span data-start="422.25" data-end="424.71">often in your OS or in your browser and</span> <span data-start="424.71" data-end="426.48">so we have no control over it in our</span> <span data-start="426.48" data-end="428.52">code and the end result is that things</span> <span data-start="428.52" data-end="434.01">feel slow another impact of TCP another</span> <span data-start="434.01" data-end="435.33">feature tease be its position control</span> <span data-start="435.33" data-end="437.76">this is necessary because over the</span> </p>
<p><span data-start="437.76" data-end="439.34">Internet there's many different</span> <span data-start="439.34" data-end="443.34">bandwidths and between you and the</span> <span data-start="443.34" data-end="445.17">server community came to is intermediate</span> <span data-start="445.17" data-end="447.6">Abraxas many different computers and</span> <span data-start="447.6" data-end="449.49">servers always carry different bandwidth</span> <span data-start="449.49" data-end="451.56">and amplify that across the entire world</span> <span data-start="451.56" data-end="454.08">you can get into a case where people are</span> <span data-start="454.08" data-end="455.37">communicating at different speeds and</span> <span data-start="455.37" data-end="458.85">packets start backing up and you start</span> <span data-start="458.85" data-end="460.14">roping packets and soon you start</span> <span data-start="460.14" data-end="462.3">dropping packets the service has to</span> <span data-start="462.3" data-end="464.19">retransmit those packets that causes</span> <span data-start="464.19" data-end="465.78">more congestion causing you to drop more</span> <span data-start="465.78" data-end="468.54">packets causing you more weeks more</span> <span data-start="468.54" data-end="470.31">retransmits and more congestion and it</span> <span data-start="470.31" data-end="472.14">can go on on to the points can cripple</span> <span data-start="472.14" data-end="474.66">entire networks and has in the past so</span> <span data-start="474.66" data-end="477.06">as a result congestion controls start</span> <span data-start="477.06" data-end="478.35">with sending a really small window</span> <span data-start="478.35" data-end="479.76">saying I'm going to send you a little</span> <span data-start="479.76" data-end="481.53">bit and then the longer the connection</span> <span data-start="481.53" data-end="483.51">lives on the mortal sin kind of a test</span> <span data-start="483.51" data-end="484.89">to see whether capabilities that</span> <span data-start="484.89" data-end="487.95">bandwidth are and that's interesting</span> <span data-start="487.95" data-end="490.79">because it end up in this property of</span> </p>
<p><span data-start="490.79" data-end="494.04">TCP where most internet connect</span> <span data-start="494.04" data-end="495.9">communication is latency bound an</span> <span data-start="495.9" data-end="497.97">experiment done at Google a couple years</span> <span data-start="497.97" data-end="501">ago probably while ago now showed that</span> <span data-start="501" data-end="503.25">with increases in bandwidth start show</span> <span data-start="503.25" data-end="504.99">starring diminishing returns once about</span> <span data-start="504.99" data-end="507.84">5 megabits per second but increased but</span> <span data-start="507.84" data-end="510.57">decreases in latency have a linear</span> <span data-start="510.57" data-end="513.24">increase over time so the more you can</span> <span data-start="513.24" data-end="514.919">shrink down latency the faster things</span> <span data-start="514.919" data-end="516.99">get and this is due to the fact</span> <span data-start="516.99" data-end="518.969">everything requires your back and forth</span> <span data-start="518.969" data-end="523.12">round trip and the handshake must happen</span> <span data-start="523.13" data-end="526.44">so one of the things brought into HP 1.1</span> <span data-start="526.44" data-end="528.27">was you I'd ever keep alive in that you</span> <span data-start="528.27" data-end="529.32">can connect to a server</span> <span data-start="529.32" data-end="531.57">and keep that connection open for</span> <span data-start="531.57" data-end="533.82">multiple requests so still got a request</span> <span data-start="533.82" data-end="535.74">in what I sort of say please give me the</span> </p>
<p><span data-start="535.74" data-end="537.66">HTML file now please give me the CSS</span> <span data-start="537.66" data-end="539.79">file but you save yourself that extra</span> <span data-start="539.79" data-end="541.32">round trip in every connection each time</span> <span data-start="541.32" data-end="543.39">a new file until eventually one of this</span> <span data-start="543.39" data-end="544.98">one of the other client of the service</span> <span data-start="544.98" data-end="548.61">says ok I'm done close connection an</span> <span data-start="548.61" data-end="551.13">HTTP 1.1 was tried to bring in this idea</span> <span data-start="551.13" data-end="553.83">of pipelining extending the keep alive</span> <span data-start="553.83" data-end="556.29">keeping a connection over but saying hey</span> <span data-start="556.29" data-end="558.39">I know I need these three files give me</span> <span data-start="558.39" data-end="561.84">these three files at once and this runs</span> <span data-start="561.84" data-end="564.24">into the heddle ahead of line problem in</span> <span data-start="564.24" data-end="568.11">that the server must respond with one of</span> <span data-start="568.11" data-end="569.85">the files generally the first of all you</span> <span data-start="569.85" data-end="571.74">send but ice pack that receives an order</span> <span data-start="571.74" data-end="574.23">so you can't intermix sending those</span> <span data-start="574.23" data-end="576.3">files they must be sent in order so you</span> <span data-start="576.3" data-end="579.68">kind of lose a lot of the benefits of</span> <span data-start="579.68" data-end="583.95">use a lot of benefits of what you expect</span> <span data-start="583.95" data-end="587.13">miss because you can't multiplex so this</span> <span data-start="587.13" data-end="588.57">actually did have a lot of benefits in a</span> <span data-start="588.57" data-end="590.25">lot of cases but it proved really hard</span> <span data-start="590.25" data-end="593.43">to do well and there are classic cases</span> <span data-start="593.43" data-end="595.92">in Safari where you would mix up the</span> <span data-start="595.92" data-end="597.78">filename you requested with the actual</span> <span data-start="597.78" data-end="599.55">body causing image to show in the wrong</span> <span data-start="599.55" data-end="602.28">areas and intermediary proxies in the</span> <span data-start="602.28" data-end="603.78">world of which there are many would</span> <span data-start="603.78" data-end="605.43">understand these properly and mix up</span> <span data-start="605.43" data-end="607.11">response and garble responses so</span> <span data-start="607.11" data-end="608.58">although it actually has a lot of</span> <span data-start="608.58" data-end="610.23">benefits it's hard to do well and</span> <span data-start="610.23" data-end="611.58">there's a lot of bad actors in the world</span> <span data-start="611.58" data-end="613.65">up there that get in the way of it so</span> <span data-start="613.65" data-end="615.45">most browsers and servers will support</span> <span data-start="615.45" data-end="617.01">this where divorce turned off and</span> <span data-start="617.01" data-end="621.9">considered an advanced feature and</span> <span data-start="621.9" data-end="623.64">keeping these with these things in mind</span> <span data-start="623.64" data-end="626.46">you can see where when our common best</span> <span data-start="626.46" data-end="628.32">performance factors come from the exact</span> <span data-start="628.32" data-end="630.24">concatenations friday in lining and</span> <span data-start="630.24" data-end="631.92">domain shouting are all ways to work</span> <span data-start="631.92" data-end="633.69">around opening more connections and</span> <span data-start="633.69" data-end="637.44">doing more handshakes and avoiding</span> <span data-start="637.44" data-end="641.28">latency this is critical path is a way</span> <span data-start="641.28" data-end="642.78">of working around condition control in</span> <span data-start="642.78" data-end="645.99">the idea being you put C inline CSS into</span> <span data-start="645.99" data-end="648.18">the into your page but only put enough</span> <span data-start="648.18" data-end="649.38">in so you give fit within that first</span> <span data-start="649.38" data-end="651.36">window while toothpaste or testing your</span> <span data-start="651.36" data-end="655.47">connection so this is where HD video</span> <span data-start="655.47" data-end="658.76">comes in h2b to like</span> <span data-start="658.76" data-end="660.77">keeper lives and pipelining go forward</span> <span data-start="660.77" data-end="662.54">which is under reducing latency ways you</span> <span data-start="662.54" data-end="665.63">long live connections but something it</span> <span data-start="665.63" data-end="667.36">does differently is this idea of streams</span> <span data-start="667.36" data-end="669.83">and that you have one connection to a</span> <span data-start="669.83" data-end="671.72">server within that connection you have</span> <span data-start="671.72" data-end="674.09">multiple streams so this is like an</span> <span data-start="674.09" data-end="677.06">analogy of a kind of lanes on a highway</span> <span data-start="677.06" data-end="678.35">you have a highway to serve multiple</span> <span data-start="678.35" data-end="680.36">lanes a communication independent from</span> <span data-start="680.36" data-end="684.53">each other but they're bi-directional so</span> </p>
<p><span data-start="684.53" data-end="687.26">I can ask I can ask for three files at</span> <span data-start="687.26" data-end="689.75">the same time on one stream and get</span> <span data-start="689.75" data-end="691.49">those responses back on that stream</span> <span data-start="691.49" data-end="693.83">completely separate from another stream</span> <span data-start="693.83" data-end="697.64">which is regressing JavaScript and what</span> <span data-start="697.64" data-end="698.93">it has over pipelining that their of</span> <span data-start="698.93" data-end="701.15">multiplexing so as a request three CSS</span> <span data-start="701.15" data-end="703.46">files the server can respond to those</span> <span data-start="703.46" data-end="705.8">files in any order and in bits of pieces</span> <span data-start="705.8" data-end="707.81">so I can get the headers for one file</span> <span data-start="707.81" data-end="709.28">get the headers for another file and</span> <span data-start="709.28" data-end="711.26">it's part of its content and then after</span> <span data-start="711.26" data-end="712.61">that the next pack could be the content</span> <span data-start="712.61" data-end="714.92">of different file and this is baked into</span> <span data-start="714.92" data-end="716.54">the protocol so the servers and clients</span> <span data-start="716.54" data-end="718.25">understand how to reassemble these</span> <span data-start="718.25" data-end="720.71">things and each one of these packets</span> <span data-start="720.71" data-end="723.5">here is what's called the frame we're</span> <span data-start="723.5" data-end="724.55">not going to dig into frames too much</span> <span data-start="724.55" data-end="727.96">for this so as you can see with</span> <span data-start="727.96" data-end="730.94">multiplexing and a long live connections</span> <span data-start="730.94" data-end="733.07">and streams we're reducing a lot of</span> <span data-start="733.07" data-end="735.56">problems with bandwidth and working</span> <span data-start="735.56" data-end="737.21">around under the issues gesture control</span> <span data-start="737.21" data-end="739.97">being lots of tiny requests I mean one</span> <span data-start="739.97" data-end="741.65">on the request we at logic just from</span> <span data-start="741.65" data-end="743.6">troy windows we go flow more data more</span> <span data-start="743.6" data-end="746.75">freely and this is why people are</span> <span data-start="746.75" data-end="749.72">telling us that I really when I</span> <span data-start="749.72" data-end="751.04">performance is wrong you know I'm going</span> <span data-start="751.04" data-end="752.24">to worry about latency anyway about</span> <span data-start="752.24" data-end="754.46">congestion windows or bad with is free</span> <span data-start="754.46" data-end="758">and latency is not a problem and I took</span> <span data-start="758" data-end="761.3">this the research on internet is all in</span> <span data-start="761.3" data-end="763.46">this behavior it was very little work</span> <span data-start="763.46" data-end="765.68">bad we said about HTTP so with this</span> <span data-start="765.68" data-end="768.59">confidence we started moving towards htp</span> <span data-start="768.59" data-end="773.45">to at 99designs and before switch for</span> <span data-start="773.45" data-end="775.84">flicking the switch on this I</span> <span data-start="775.84" data-end="778.43">confidently said to my see to my boss</span> <span data-start="778.43" data-end="780.17">that it couldn't possibly any slower</span> <span data-start="780.17" data-end="784.58">we're fine to my chagrin we rapidly</span> <span data-start="784.58" data-end="787.37">started seeing decreases are we we soon</span> <span data-start="787.37" data-end="790.31">saw decreases in sight performance so</span> <span data-start="790.31" data-end="791.64">this next</span> <span data-start="791.64" data-end="793.5">save 15 minutes of my talk is me</span> <span data-start="793.5" data-end="797.43">systematically eating my own hat so I</span> <span data-start="797.43" data-end="800.73">work for 99 designs where a crowdsourced</span> <span data-start="800.73" data-end="802.32">graphics design marketplace which is</span> <span data-start="802.32" data-end="803.79">purely to say that images are very</span> <span data-start="803.79" data-end="805.8">important we have lots and lots of</span> <span data-start="805.8" data-end="808.65">images and to measure our site</span> <span data-start="808.65" data-end="812.64">performance we pick some key metrics we</span> <span data-start="812.64" data-end="814.47">focus more on perceived performance from</span> <span data-start="814.47" data-end="816.03">the user so we use a couple of ways of</span> <span data-start="816.03" data-end="817.77">doing this these are dashboards the</span> <span data-start="817.77" data-end="821.01">float around our office so we look at</span> <span data-start="821.01" data-end="823.98">content Dom content loaded to determine</span> <span data-start="823.98" data-end="825.51">if synchronous groups are delaying our</span> <span data-start="825.51" data-end="828.84">page loads we look at the first paint to</span> <span data-start="828.84" data-end="830.4">see if delay if rendering is being</span> <span data-start="830.4" data-end="833.28">delayed by fonts or CSS look at time to</span> <span data-start="833.28" data-end="835.92">visually complete to look at non blonde</span> <span data-start="835.92" data-end="837.66">non render blocking resources like</span> <span data-start="837.66" data-end="840.75">images and asynchronous scripts and one</span> <span data-start="840.75" data-end="842.91">of our main proxies at a glance is speed</span> <span data-start="842.91" data-end="844.71">index which gives us a good idea of</span> <span data-start="844.71" data-end="846.54">visual completion over time our sites</span> <span data-start="846.54" data-end="848.52">being drawn faster are they finishing</span> <span data-start="848.52" data-end="851.61">faster and visual pollution is mostly</span> <span data-start="851.61" data-end="853.44">concerned with what's above the viewport</span> <span data-start="853.44" data-end="854.61">so the initial viewed as the site</span> <span data-start="854.61" data-end="857.19">thought look like it loaded fast and to</span> <span data-start="857.19" data-end="859.56">get a lot of this data we use an app</span> <span data-start="859.56" data-end="861.54">quad caliber subsidies calabar and we</span> <span data-start="861.54" data-end="863.36">fetch the data route to store it locally</span> <span data-start="863.36" data-end="865.35">so before I get to some of the problems</span> <span data-start="865.35" data-end="867.18">in HD too we did see the great</span> <span data-start="867.18" data-end="870.32">improvements pages like our designer</span> <span data-start="870.32" data-end="873.45">portfolios which a typical</span> <span data-start="873.45" data-end="874.74">representative typical page on our site</span> <span data-start="874.74" data-end="876.57">you know they're mostly latency bound</span> <span data-start="876.57" data-end="878.43">lots of really small files need to be</span> <span data-start="878.43" data-end="880.2">pulled down lots of really small images</span> <span data-start="880.2" data-end="882.96">and for these pages we saw like a five</span> <span data-start="882.96" data-end="884.46">percent improvement on speed index so</span> <span data-start="884.46" data-end="887.18">pages look like that were drawing faster</span> <span data-start="887.18" data-end="889.44">the time to first paint was comparable</span> <span data-start="889.44" data-end="891.54">so the first paint would happen around</span> <span data-start="891.54" data-end="893.22">the same time and HP one versus age to</span> <span data-start="893.22" data-end="895.05">be too but the page would finish drawing</span> <span data-start="895.05" data-end="900.24">faster interesting interestingly was the</span> <span data-start="900.24" data-end="902.28">initial render the first drawer on the</span> <span data-start="902.28" data-end="904.77">page was macht HDD to which you'd expect</span> <span data-start="904.77" data-end="906.3">as you'll be getting more data at the</span> <span data-start="906.3" data-end="910.26">same time one of the bad things and the</span> <span data-start="910.26" data-end="911.55">thing that really stuck out to us was</span> <span data-start="911.55" data-end="913.92">our designer galleries these are</span> <span data-start="913.92" data-end="916.32">extremely me have each pages so between</span> <span data-start="916.32" data-end="918.69">80 pages on average and a page can be</span> <span data-start="918.69" data-end="921.15">delay between 500 to 5 to 10 megs of</span> <span data-start="921.15" data-end="923.94">images and these pages are Bam Bam</span> <span data-start="923.94" data-end="924.329">whisperer</span> <span data-start="924.329" data-end="929.1">not latency bound so because there</span> <span data-start="929.1" data-end="930.42">weren't latency bound we didn't expect</span> <span data-start="930.42" data-end="932.73">the reduction latency would have much</span> <span data-start="932.73" data-end="936.869">impact on the performance these pages we</span> <span data-start="936.869" data-end="939.769">actually saw a five to ten percent</span> <span data-start="939.769" data-end="942.299">faster time the visual completion speed</span> <span data-start="942.299" data-end="945.809">index us are slower so these pages would</span> <span data-start="945.809" data-end="948.48">finish drawing much slower and HP to the</span> </p>
<p><span data-start="948.48" data-end="951.929">HP one but we did see faster page load</span> <span data-start="951.929" data-end="954.48">times which suggests that the reduced</span> <span data-start="954.48" data-end="956.459">latency was having an effect which was</span> <span data-start="956.459" data-end="960.6">very concentrated to us we also did some</span> <span data-start="960.6" data-end="962.519">high latency testing because mobile is</span> <span data-start="962.519" data-end="965.04">important to us and to everybody for</span> <span data-start="965.04" data-end="967.259">this we use web page tests and compared</span> <span data-start="967.259" data-end="972.089">to HP 1hp to continue to have more</span> <span data-start="972.089" data-end="973.769">complete first paints so more data was</span> <span data-start="973.769" data-end="975.509">getting there sooner and we'll drawing</span> <span data-start="975.509" data-end="977.04">more complete the very first in the user</span> <span data-start="977.04" data-end="979.769">saw but they'd happen noticeably later</span> <span data-start="979.769" data-end="981.569">so the first pen would happen much</span> <span data-start="981.569" data-end="984.839">before much later than the HP one paints</span> <span data-start="984.839" data-end="989.04">but they'd be way more complete and we</span> <span data-start="989.04" data-end="990.419">were continually seeing faster page</span> <span data-start="990.419" data-end="992.22">loads so all the data was getting to the</span> <span data-start="992.22" data-end="996.029">user far faster eventually but we were</span> <span data-start="996.029" data-end="998.97">seeing much slower time to draw the page</span> <span data-start="998.97" data-end="1007.129">completely so to kind of sum that up for</span> <span data-start="1007.129" data-end="1008.6">a typical page full of images on our</span> <span data-start="1008.6" data-end="1010.699">site ones were latency bound lots of</span> <span data-start="1010.699" data-end="1013.339">small farms a lot of small images we</span> <span data-start="1013.339" data-end="1015.169">were seeing a five percent faster time</span> <span data-start="1015.169" data-end="1018.919">to visually complete the entire page but</span> <span data-start="1018.919" data-end="1020.689">for extremely me hedge pages pages that</span> <span data-start="1020.689" data-end="1022.489">were latency bound painters it did a lot</span> <span data-start="1022.489" data-end="1024.5">of work and transfer a lot of data who</span> <span data-start="1024.5" data-end="1027.049">actually saw much slower visual</span> <span data-start="1027.049" data-end="1028.25">completion some between five to ten</span> <span data-start="1028.25" data-end="1031.97">percent slower than previously and on</span> <span data-start="1031.97" data-end="1034.789">high latency connections with low speed</span> <span data-start="1034.789" data-end="1038.539">say mobile networks we saw greater</span> <span data-start="1038.539" data-end="1040.789">delays in reaching visual completion but</span> <span data-start="1040.789" data-end="1043.699">in all tests the initial paints were</span> <span data-start="1043.699" data-end="1044.99">more complete even though that happened</span> <span data-start="1044.99" data-end="1053.33">much later so to summarize bandwidth</span> <span data-start="1053.33" data-end="1055.34">bound pages sniffing it longer to reach</span> <span data-start="1055.34" data-end="1057.35">visual completion despite loading way</span> <span data-start="1057.35" data-end="1058.16">faster and we</span> <span data-start="1058.16" data-end="1059.93">couldn't figure out why initially this</span> <span data-start="1059.93" data-end="1062.12">was unexpected to us so our first</span> <span data-start="1062.12" data-end="1065.3">hypothesis was network saturation it</span> <span data-start="1065.3" data-end="1067.19">could it be that requesting so many</span> <span data-start="1067.19" data-end="1070.25">things at once and having a single</span> <span data-start="1070.25" data-end="1072.56">connection that could multiplex was that</span> <span data-start="1072.56" data-end="1075.08">draining the training resources away</span> <span data-start="1075.08" data-end="1077.3">from other things in the page like CSS</span> <span data-start="1077.3" data-end="1079.31">and JavaScript that would actually block</span> <span data-start="1079.31" data-end="1082.22">the rendering of the page in your</span> <span data-start="1082.22" data-end="1083.99">typical hp1 water flow you see things</span> <span data-start="1083.99" data-end="1086.93">are staged so things that happen earlier</span> <span data-start="1086.93" data-end="1088.4">in the page tend to be loaded earlier</span> <span data-start="1088.4" data-end="1090.65">and you get a good distribution of</span> <span data-start="1090.65" data-end="1093.71">bandwidth across your requests so</span> <span data-start="1093.71" data-end="1095.21">looking at these Network waterfalls we</span> <span data-start="1095.21" data-end="1098.3">couldn't actually see that happening z</span> <span data-start="1098.3" data-end="1099.38">says with loading when sister should</span> <span data-start="1099.38" data-end="1101.09">load just blowing JavaScript reload</span> <span data-start="1101.09" data-end="1102.92">image loading image should load and they</span> <span data-start="1102.92" data-end="1104.09">think the loading and finishing at the</span> <span data-start="1104.09" data-end="1107.87">same time so our next hypothesis with</span> <span data-start="1107.87" data-end="1111.74">loading priority in h2 be one you have</span> <span data-start="1111.74" data-end="1114.97">this limit of 60 / connections per host</span> <span data-start="1114.97" data-end="1117.86">and this creates that first in first out</span> <span data-start="1117.86" data-end="1119.69">q are talking about where the first</span> <span data-start="1119.69" data-end="1121.46">thing in your page tends to be the first</span> <span data-start="1121.46" data-end="1122.9">thing requested and the first thing</span> <span data-start="1122.9" data-end="1124.87">responded to then things happen in order</span> <span data-start="1124.87" data-end="1128.09">as a result the relation of things in</span> <span data-start="1128.09" data-end="1129.8">your document document tend to be the</span> <span data-start="1129.8" data-end="1131.18">relation of things will load so you have</span> <span data-start="1131.18" data-end="1132.68">some control over the loading order of</span> <span data-start="1132.68" data-end="1137.6">things with HTTP to it's a it allows</span> <span data-start="1137.6" data-end="1140.39">multiple requests and responses over the</span> <span data-start="1140.39" data-end="1141.59">one connection happened at the exact</span> <span data-start="1141.59" data-end="1144.2">same time as a result you don't really</span> <span data-start="1144.2" data-end="1146.96">get that priority anymore everything</span> <span data-start="1146.96" data-end="1148.91">sees you at Oxford at the same time I</span> <span data-start="1148.91" data-end="1150.38">said just give me what you got no figure</span> <span data-start="1150.38" data-end="1151.88">it out and you kind of lose control of</span> <span data-start="1151.88" data-end="1153.35">like what should we loaded first what</span> <span data-start="1153.35" data-end="1155.24">should be loaded last what things are</span> <span data-start="1155.24" data-end="1158.06">more important than others so the</span> <span data-start="1158.06" data-end="1159.11">browsers do you have built-in</span> <span data-start="1159.11" data-end="1160.73">prioritization for this but you lose</span> <span data-start="1160.73" data-end="1162.23">control any document in your document so</span> <span data-start="1162.23" data-end="1164.27">you could very well be that images the</span> <span data-start="1164.27" data-end="1165.86">bottom of the page or given the same</span> <span data-start="1165.86" data-end="1167.09">priorities images on top of the page</span> <span data-start="1167.09" data-end="1169.94">causing those longer-term visual</span> <span data-start="1169.94" data-end="1174.47">completion so part of this we'd consider</span> <span data-start="1174.47" data-end="1176.39">the putting the best practice of putting</span> <span data-start="1176.39" data-end="1178.31">scripts part of our pages was closing</span> <span data-start="1178.31" data-end="1179.3">those scripts to get like a higher</span> <span data-start="1179.3" data-end="1180.95">priority and actually pushing off image</span> <span data-start="1180.95" data-end="1183.95">loading resources but we were able to</span> <span data-start="1183.95" data-end="1186.74">figure out this was in the case because</span> <span data-start="1186.74" data-end="1188.42">don't complete loaded at the same time</span> <span data-start="1188.42" data-end="1190.49">and don't be blocked on these JavaScript</span> <span data-start="1190.49" data-end="1192.11">files so with that being in the same</span> <span data-start="1192.11" data-end="1193.58">place and ask monitoring that we could</span> <span data-start="1193.58" data-end="1195.26">tell that the priority of this group's</span> <span data-start="1195.26" data-end="1197">weren't being moved and weren't changing</span> <span data-start="1197" data-end="1199.49">the render properties of the page so I</span> <span data-start="1199.49" data-end="1200.84">later came down something happening at</span> <span data-start="1200.84" data-end="1202.04">the network layer things just weren't</span> <span data-start="1202.04" data-end="1204.08">coming to us the way we expected to as</span> <span data-start="1204.08" data-end="1207.77">faster picking to come just release the</span> <span data-start="1207.77" data-end="1211.12">idea of resource priority in practice</span> <span data-start="1211.12" data-end="1213.11">the browsers download queue is</span> <span data-start="1213.11" data-end="1216.049">prioritized so starting a team adding</span> <span data-start="1216.049" data-end="1217.79">image requests before final script</span> <span data-start="1217.79" data-end="1219.29">bottom of the page doesn't delay script</span> <span data-start="1219.29" data-end="1221.42">loading at all these a coding behavioral</span> <span data-start="1221.42" data-end="1223.73">resource is undocumented however it</span> <span data-start="1223.73" data-end="1225.41">constantly changes our pilot problem is</span> <span data-start="1225.41" data-end="1226.73">that browsers have their own heuristics</span> <span data-start="1226.73" data-end="1229.22">in how they load things but typically</span> <span data-start="1229.22" data-end="1231.44">images have very low priority things</span> <span data-start="1231.44" data-end="1232.7">like fonts and java better higher</span> <span data-start="1232.7" data-end="1234.44">priority and one of the interesting</span> <span data-start="1234.44" data-end="1236.72">about is browser heuristics it developed</span> <span data-start="1236.72" data-end="1238.94">by browser vendors over time to suit the</span> <span data-start="1238.94" data-end="1240.86">current trends so an interesting one now</span> <span data-start="1240.86" data-end="1243.77">is the hero image heuristic so images</span> <span data-start="1243.77" data-end="1246.44">get a very low priority browsers will</span> <span data-start="1246.44" data-end="1247.73">find the first image in the page and</span> <span data-start="1247.73" data-end="1249.71">make it a very high priority the idea</span> <span data-start="1249.71" data-end="1251.179">being a lot of sites have is big hero</span> <span data-start="1251.179" data-end="1252.95">image and that should load first and</span> <span data-start="1252.95" data-end="1254.15">given the same priority assists in</span> </p>
<p><span data-start="1254.15" data-end="1257.809">JavaScript so knowing these heuristics</span> <span data-start="1257.809" data-end="1260.27">are in play we want to look at the</span> <span data-start="1260.27" data-end="1264.23">stream without that limit of six</span> <span data-start="1264.23" data-end="1266.179">connections person we get HTTP one we</span> <span data-start="1266.179" data-end="1267.799">could see ad image requests all firing</span> <span data-start="1267.799" data-end="1270.08">ones to the server and the server would</span> <span data-start="1270.08" data-end="1271.25">then respond to them simultaneously</span> <span data-start="1271.25" data-end="1272.929">because they wouldn't know which was</span> <span data-start="1272.929" data-end="1274.79">more important than the other and the</span> <span data-start="1274.79" data-end="1277.66">browser would draw them as they came in</span> <span data-start="1277.66" data-end="1279.95">this had an interesting effect and we</span> <span data-start="1279.95" data-end="1282.679">see something like this comparing HTTP</span> <span data-start="1282.679" data-end="1286.13">one and HTTP two we'd see that the HTTP</span> <span data-start="1286.13" data-end="1288.77">one page was drawing this image on the</span> <span data-start="1288.77" data-end="1290.99">fire image much slower which meant that</span> <span data-start="1290.99" data-end="1293.66">it was getting the packets much slower</span> <span data-start="1293.66" data-end="1295.28">but we knew that these pages were</span> <span data-start="1295.28" data-end="1297.799">finishing to load generally much faster</span> <span data-start="1297.799" data-end="1301.07">which led us into the area that let us</span> <span data-start="1301.07" data-end="1303.14">down the track of thinking that there</span> <span data-start="1303.14" data-end="1304.97">was some sort of bandwidth contention in</span> <span data-start="1304.97" data-end="1306.35">that the browser was treating all images</span> <span data-start="1306.35" data-end="1307.97">equally so there were images much</span> <span data-start="1307.97" data-end="1309.23">further down the page that were being</span> <span data-start="1309.23" data-end="1312.2">rendered and parse problem comes down to</span> <span data-start="1312.2" data-end="1314.48">is if all images are the same size and</span> <span data-start="1314.48" data-end="1316.549">the bandwidth distributed equally they</span> <span data-start="1316.549" data-end="1318.169">should all load equally and this page</span> <span data-start="1318.169" data-end="1320.09">would have been faster but in this case</span> <span data-start="1320.09" data-end="1322.7">this image on the right is slightly</span> <span data-start="1322.7" data-end="1323.97">larger than a 200</span> <span data-start="1323.97" data-end="1326.21">left and as a result it has a different</span> <span data-start="1326.21" data-end="1328.26">requires more data and is then drawn</span> <span data-start="1328.26" data-end="1329.37">differently as different loading</span> <span data-start="1329.37" data-end="1331.38">characteristics and because the</span> <span data-start="1331.38" data-end="1332.7">bandwidth is being distributed to pages</span> <span data-start="1332.7" data-end="1334.94">images off the page we see this kind of</span> <span data-start="1334.94" data-end="1337.77">phased loading much slower than an HTTP</span> <span data-start="1337.77" data-end="1340.26">one which had a baked in priority saying</span> <span data-start="1340.26" data-end="1341.82">this image is more important than images</span> <span data-start="1341.82" data-end="1345.75">down the bottom of the page um so there</span> <span data-start="1345.75" data-end="1348.24">is some fine print with htp really not</span> <span data-start="1348.24" data-end="1350.7">many people talking about an allegra</span> <span data-start="1350.7" data-end="1352.92">goreck of the chrome team said this</span> <span data-start="1352.92" data-end="1355.5">really well I with HTTP to the browser</span> <span data-start="1355.5" data-end="1356.97">relies on the server I to deliver the</span> <span data-start="1356.97" data-end="1360.78">responses in optimal way it's not just a</span> <span data-start="1360.78" data-end="1362.49">number of bytes or requests per second</span> <span data-start="1362.49" data-end="1364.05">by the order in which the bites are</span> <span data-start="1364.05" data-end="1366.99">delivered near test rotation carefully</span> <span data-start="1366.99" data-end="1370.62">the these loading heuristics that exists</span> <span data-start="1370.62" data-end="1373.44">are undocumented and they're</span> <span data-start="1373.44" data-end="1376.4">undocumented on purpose the idea is that</span> <span data-start="1376.4" data-end="1379.71">browser vendors can choose what</span> <span data-start="1379.71" data-end="1380.91">heuristics work better for their</span> <span data-start="1380.91" data-end="1382.56">customers in their environments they can</span> <span data-start="1382.56" data-end="1385.07">analyze that I'm they know better and</span> <span data-start="1385.07" data-end="1387.54">they differ between versions a change in</span> <span data-start="1387.54" data-end="1388.92">a heuristic in a version can actually</span> <span data-start="1388.92" data-end="1391.41">improve certain sites but significant</span> <span data-start="1391.41" data-end="1393.9">affect other sites and they're not</span> <span data-start="1393.9" data-end="1395.28">documented and they're not told about</span> <span data-start="1395.28" data-end="1397.14">these things and have a general for all</span> <span data-start="1397.14" data-end="1400.32">sites so what is good for a big hero</span> <span data-start="1400.32" data-end="1401.85">image may not be good for a site that is</span> <span data-start="1401.85" data-end="1403.38">an app were single page app and these</span> <span data-start="1403.38" data-end="1407.97">are concerns gotta be balanced so HTTP</span> <span data-start="1407.97" data-end="1410.43">to took this shift and says as a</span> <span data-start="1410.43" data-end="1412.38">developer on your site you know it's</span> <span data-start="1412.38" data-end="1414.15">best for your site I change the</span> <span data-start="1414.15" data-end="1416.55">landscape of resource prioritization the</span> <span data-start="1416.55" data-end="1417.93">responsibilities now shared between the</span> <span data-start="1417.93" data-end="1420.66">browser and the server the browser gives</span> <span data-start="1420.66" data-end="1423.96">the server hints unlike this stream so</span> <span data-start="1423.96" data-end="1425.97">it knows the stream of serving image</span> <span data-start="1425.97" data-end="1427.62">user says this stream has a priority</span> <span data-start="1427.62" data-end="1429.42">much lower than the priority of the</span> <span data-start="1429.42" data-end="1432.12">stream serving CSS and that is low on</span> <span data-start="1432.12" data-end="1434.46">the stream serving JavaScript as an</span> <span data-start="1434.46" data-end="1435.87">option the browser has whether it works</span> <span data-start="1435.87" data-end="1437.85">that way is different and most streams</span> <span data-start="1437.85" data-end="1440.16">tend to be the same for the time being</span> <span data-start="1440.16" data-end="1442.89">it's a change between browsers but this</span> <span data-start="1442.89" data-end="1444.87">is the server can ignore that the server</span> <span data-start="1444.87" data-end="1447.96">can just say actually I know that on</span> <span data-start="1447.96" data-end="1450.21">this page we have lots of images so</span> <span data-start="1450.21" data-end="1452.19">these get a higher priority than the</span> </p>
<p><span data-start="1452.19" data-end="1454.08">JavaScript that affects a button at the</span> <span data-start="1454.08" data-end="1455.49">bottom of the page and you can build</span> <span data-start="1455.49" data-end="1456.82">that control into your own server</span> <span data-start="1456.82" data-end="1458.679">in practice is much harder because he</span> <span data-start="1458.679" data-end="1459.909">sent you to see the anodyne are in these</span> <span data-start="1459.909" data-end="1461.71">servers yourself but if you run her own</span> <span data-start="1461.71" data-end="1463.36">HTTP servers you can put in your own</span> <span data-start="1463.36" data-end="1464.769">heuristics and it's option you now have</span> <span data-start="1464.769" data-end="1468.399">and she didn't have with HTTP one but</span> <span data-start="1468.399" data-end="1470.46">this ends up being a double-edged sword</span> <span data-start="1470.46" data-end="1472.72">resource prioritization existing in both</span> <span data-start="1472.72" data-end="1474.639">the client and the server I can really</span> <span data-start="1474.639" data-end="1477.1">muddy the waters and open up way more</span> <span data-start="1477.1" data-end="1481.48">problems we weren't aware of and put but</span> <span data-start="1481.48" data-end="1482.679">it does give the ability put the</span> <span data-start="1482.679" data-end="1484.149">developer in charge and the developer</span> <span data-start="1484.149" data-end="1485.59">who knows their site can do really great</span> <span data-start="1485.59" data-end="1488.019">things I previously hinted at the idea</span> <span data-start="1488.019" data-end="1489.789">of weights and weight as a hint the</span> <span data-start="1489.789" data-end="1492.909">browser gives at priority this happens</span> <span data-start="1492.909" data-end="1495.25">in HTTP one where the browser uses the</span> <span data-start="1495.25" data-end="1497.139">idea of priority to then determine what</span> <span data-start="1497.139" data-end="1500.049">order to send requests in in HTTP two we</span> <span data-start="1500.049" data-end="1501.94">send all requests the same time but we</span> <span data-start="1501.94" data-end="1503.62">apply a weight signifying its priority</span> <span data-start="1503.62" data-end="1505.269">something with a lower weight has less</span> <span data-start="1505.269" data-end="1506.769">priority and should get less bandwidth</span> <span data-start="1506.769" data-end="1508.36">there's something of a higher weight so</span> <span data-start="1508.36" data-end="1510.49">images ver CSS for a sponsor JavaScript</span> <span data-start="1510.49" data-end="1512.44">the browser can assign these different</span> <span data-start="1512.44" data-end="1513.94">streams and different weights and saying</span> <span data-start="1513.94" data-end="1517.419">these are more important than others the</span> <span data-start="1517.419" data-end="1519.789">servers fries with more all that if you</span> <span data-start="1519.789" data-end="1521.289">don't control eserver it's on you to</span> <span data-start="1521.289" data-end="1525.82">test your service actually doing and</span> <span data-start="1525.82" data-end="1527.74">dependencies so dependencies are</span> <span data-start="1527.74" data-end="1529.69">interesting and one of the big things if</span> </p>
<p><span data-start="1529.69" data-end="1532.95">HTTP two streams in that we can say that</span> <span data-start="1532.95" data-end="1535.539">although something is important it's</span> <span data-start="1535.539" data-end="1536.86">only important if its parent has already</span> <span data-start="1536.86" data-end="1540.009">loaded this allows you to say that here</span> <span data-start="1540.009" data-end="1541.69">all the JavaScript files on my site but</span> <span data-start="1541.69" data-end="1542.71">don't wasn't loading anything else</span> <span data-start="1542.71" data-end="1544.779">you've loaded jQuery or here are the</span> <span data-start="1544.779" data-end="1546.46">images on my site but these three at the</span> <span data-start="1546.46" data-end="1547.96">top of the page are way more important</span> <span data-start="1547.96" data-end="1549.639">to 32 bottom of the page and you can</span> <span data-start="1549.639" data-end="1555.009">describe this with dependencies so some</span> <span data-start="1555.009" data-end="1556.48">of the takeaways my investigation was</span> <span data-start="1556.48" data-end="1558.309">simply that there's no such thing as</span> <span data-start="1558.309" data-end="1559.75">free performance and this is something</span> <span data-start="1559.75" data-end="1561.039">our browser vendors have known for a</span> <span data-start="1561.039" data-end="1564.029">very long time web performance is a</span> <span data-start="1564.029" data-end="1568.029">series of trade-offs and new ones any</span> <span data-start="1568.029" data-end="1571.5">heavy image-heavy pages tend to prefer</span> </p>
<p><span data-start="1571.5" data-end="1574.299">HTTP two connections only when the bat</span> <span data-start="1574.299" data-end="1577.45">total bandwidth is less than the latency</span> <span data-start="1577.45" data-end="1579.909">incurred if your server lab which</span> <span data-start="1579.909" data-end="1582.429">bandwidth if your bandwidth is less than</span> <span data-start="1582.429" data-end="1583.929">the latency would have incurred then you</span> <span data-start="1583.929" data-end="1585.159">gain a lot running single long live</span> <span data-start="1585.159" data-end="1586.96">connection if you're very bound with</span> <span data-start="1586.96" data-end="1588.85">heavy reducing latency</span> <span data-start="1588.85" data-end="1591.58">actually save you that much so it's the</span> <span data-start="1591.58" data-end="1593.86">right mix of high latency and low</span> <span data-start="1593.86" data-end="1596.53">bandwidth you can see really big against</span> <span data-start="1596.53" data-end="1598.21">and these are the site lots of small CSS</span> <span data-start="1598.21" data-end="1601.78">files a lot of small images another</span> <span data-start="1601.78" data-end="1603.22">thing to take away from this is HTTP two</span> <span data-start="1603.22" data-end="1605.29">is very new and the surface area for the</span> <span data-start="1605.29" data-end="1608.08">protocol is huge you have resource</span> <span data-start="1608.08" data-end="1609.94">weight prioritization you have resource</span> <span data-start="1609.94" data-end="1611.68">dependency prioritization you have</span> <span data-start="1611.68" data-end="1614.02">multiplicity heuristics and you have</span> <span data-start="1614.02" data-end="1617.49">streamer connection flows these things</span> <span data-start="1617.49" data-end="1619.24">although the implementation is</span> <span data-start="1619.24" data-end="1621.13">documented the heuristics art it's</span> <span data-start="1621.13" data-end="1624.85">really free to you as developers for</span> <span data-start="1624.85" data-end="1627.01">sites people who building servers CDN</span> <span data-start="1627.01" data-end="1628.99">owners as on all of you to figure out</span> <span data-start="1628.99" data-end="1630.91">what is best for your situation of your</span> <span data-start="1630.91" data-end="1634.54">audience I hope and there is work in</span> <span data-start="1634.54" data-end="1635.83">browsers coming through to hint at these</span> <span data-start="1635.83" data-end="1638.83">so for you in markup or in JavaScript be</span> <span data-start="1638.83" data-end="1640.42">able to say these resources are more</span> <span data-start="1640.42" data-end="1641.41">important than others and have some</span> <span data-start="1641.41" data-end="1643.12">control over that or that appears to be</span> <span data-start="1643.12" data-end="1646.15">a while off just yet and there are other</span> <span data-start="1646.15" data-end="1648.73">glaring issues with hd2 that make this</span> <span data-start="1648.73" data-end="1650.73">really hard one is a lack of visibility</span> </p>
<p><span data-start="1650.73" data-end="1653.29">HTTP to unlock a should be one is a</span> <span data-start="1653.29" data-end="1655.12">binary protocol it's no longer clear</span> <span data-start="1655.12" data-end="1656.8">text over the wire you can't look at</span> <span data-start="1656.8" data-end="1658.69">what's happening requires specialized</span> <span data-start="1658.69" data-end="1660.55">tools and because it all happens over a</span> <span data-start="1660.55" data-end="1663.4">ssl it requires either man in building</span> <span data-start="1663.4" data-end="1665.53">your connection or doing it manually via</span> <span data-start="1665.53" data-end="1668.05">some sort of CLI that gives you access</span> <span data-start="1668.05" data-end="1671.68">to emulate a browser and dev tools</span> <span data-start="1671.68" data-end="1673.33">simply haven't caught up here they have</span> <span data-start="1673.33" data-end="1675.25">the information but it's very hard to</span> <span data-start="1675.25" data-end="1678.37">show to show in the dev console our</span> <span data-start="1678.37" data-end="1680.47">minds are programmed our experiences</span> <span data-start="1680.47" data-end="1682.45">print program to waterfalls of HTTP one</span> <span data-start="1682.45" data-end="1683.86">let us really apply history between</span> </p>
<p><span data-start="1683.86" data-end="1685.84">Timor and as a while all the tools still</span> <span data-start="1685.84" data-end="1687.52">catching up for a long time tools</span> <span data-start="1687.52" data-end="1690.1">reporting collection times being wrong</span> <span data-start="1690.1" data-end="1691.99">because of the way then attempted SSL</span> <span data-start="1691.99" data-end="1695.62">and these issues are bound and as I</span> <span data-start="1695.62" data-end="1697.39">mentioned the binary protocol makes it</span> <span data-start="1697.39" data-end="1700.27">very hard to sniff what's happening you</span> <span data-start="1700.27" data-end="1702.88">can only have a good intuition of what</span> <span data-start="1702.88" data-end="1704.89">what's been what's being sent you can no</span> <span data-start="1704.89" data-end="1706.51">longer you can't easily inspect the</span> <span data-start="1706.51" data-end="1708.34">heuristic supplier you can't see the</span> <span data-start="1708.34" data-end="1709.99">server's prioritizing something over</span> <span data-start="1709.99" data-end="1712.06">something else what order their packets</span> <span data-start="1712.06" data-end="1714.22">are coming in and that's multiplexing</span> <span data-start="1714.22" data-end="1715.39">payback we really important and have</span> <span data-start="1715.39" data-end="1719.17">really subtle effects so there's some</span> <span data-start="1719.17" data-end="1720.909">great resources in this area</span> </p>
<p><span data-start="1720.909" data-end="1724.889">HTTP to 101 is a quick video by soma</span> <span data-start="1724.889" data-end="1727.389">hopeful most high-performance browser</span> <span data-start="1727.389" data-end="1730.119">networking is must read for anyone who</span> <span data-start="1730.119" data-end="1731.71">work in sac performance or you care a</span> <span data-start="1731.71" data-end="1733.599">sub performance earlier gorica the</span> <span data-start="1733.599" data-end="1735.309">chrome team covers loaders material and</span> <span data-start="1735.309" data-end="1737.529">way more detail and is responsible for</span> <span data-start="1737.529" data-end="1739.419">much material in the beginning of this</span> <span data-start="1739.419" data-end="1742.749">talk has to be to hear is less optimized</span> <span data-start="1742.749" data-end="1745.659">is a one hour long talk by Alico gorrik</span> <span data-start="1745.659" data-end="1747.009">it's definitely worth watching but is</span> <span data-start="1747.009" data-end="1751.84">very in-depth HD 1.5 HP to an 1.5 world</span> <span data-start="1751.84" data-end="1753.789">by peter wilson this is a great talk or</span> <span data-start="1753.789" data-end="1755.739">not chopping on HP to train just yet and</span> <span data-start="1755.739" data-end="1758.32">some of the trade-offs and keeping in</span> <span data-start="1758.32" data-end="1759.609">mind that many of our users are still on</span> </p>
<p><span data-start="1759.609" data-end="1763.47">HP one it will be for visible future and</span> <span data-start="1763.47" data-end="1765.789">this is a blog post i wrote that goes</span> <span data-start="1765.789" data-end="1768.309">into many of the things we ran into</span> <span data-start="1768.309" data-end="1770.919">secure the hd2 in more detail and some</span> <span data-start="1770.919" data-end="1772.509">more waterfalls at some of the quizzes</span> <span data-start="1772.509" data-end="1776.859">we came to and thank you that is the</span> <span data-start="1776.859" data-end="1786.58">wrong way</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
