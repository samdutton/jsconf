<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>1j0Xw_VPyIo</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/1j0Xw_VPyIo?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="17.17" data-end="19.96">my name is John David Dalton and I'm</span> <span data-start="19.96" data-end="22.45">doing a presentation over benchmarking</span> <span data-start="22.45" data-end="27.58">and so I'll get into that all right I</span> <span data-start="27.58" data-end="29.68">wanted to do a talk about benchmarking</span> <span data-start="29.68" data-end="32.879">because right after jay is comfy you I</span> <span data-start="32.879" data-end="35.47">got into trying to benchmark my own</span> <span data-start="35.47" data-end="37.87">framework and I noticed I noticed there</span> <span data-start="37.87" data-end="41.86">was a lack of good quality JavaScript</span> <span data-start="41.86" data-end="44.8">benchmarks for framework code or for</span> <span data-start="44.8" data-end="48.07">just snippets in general and so I</span> <span data-start="48.07" data-end="52.33">started looking at task speed slick</span> <span data-start="52.33" data-end="56.5">speed and the the popular benchmarks</span> <span data-start="56.5" data-end="61.269">like v8 sweet son spider and Kraken and</span> <span data-start="61.269" data-end="63.309">looking to see you know how they</span> <span data-start="63.309" data-end="67.36">measured JavaScript performance and what</span> </p>
<p><span data-start="67.36" data-end="69.97">I found along the way was that there's a</span> <span data-start="69.97" data-end="71.979">lot of inconsistencies and a lot of</span> <span data-start="71.979" data-end="75.34">problems with measuring JavaScript</span> <span data-start="75.34" data-end="78.19">performance and getting a good idea of</span> <span data-start="78.19" data-end="83.14">the the actual performance so let's get</span> <span data-start="83.14" data-end="86.77">into it the the main ones i looked at</span> <span data-start="86.77" data-end="90.369">where sunspider cracking and v8 I also</span> <span data-start="90.369" data-end="92.979">looked at Dromio which is I'll cover in</span> <span data-start="92.979" data-end="95.49">the next one these benchmarks are</span> <span data-start="95.49" data-end="99.28">running synthetic bench synthetic speed</span> <span data-start="99.28" data-end="102.609">tests so they're they're doing tasks</span> <span data-start="102.609" data-end="105.13">like looking at like a 3d matrix or</span> <span data-start="105.13" data-end="108.13">doing some string manipulation and</span> <span data-start="108.13" data-end="109.63">they're they're saying that that is</span> <span data-start="109.63" data-end="111.64">representative of what applications</span> <span data-start="111.64" data-end="115.869">might be doing and will will gauge the</span> <span data-start="115.869" data-end="118.469">speed of your your browsers in this case</span> <span data-start="118.469" data-end="121.359">but</span> </p>
<p><span data-start="121.359" data-end="124.28">Dromio yo on the other hand is is a</span> <span data-start="124.28" data-end="127.189">different one and it measures not only</span> <span data-start="127.189" data-end="130.54">the same benchmarks of sunspider and and</span> <span data-start="130.54" data-end="134.959">v8 sweet but also has dom tests dom</span> <span data-start="134.959" data-end="137.09">tests are important because for example</span> <span data-start="137.09" data-end="141.14">ie8 or ie9 performs very well in some of</span> <span data-start="141.14" data-end="143.48">the synthetic benchmarks like SunSpider</span> <span data-start="143.48" data-end="147.17">but is is one of the worst performance</span> <span data-start="147.17" data-end="150.59">wise on dom manipulation and so having</span> <span data-start="150.59" data-end="152.709">relevant meaningful benchmarks</span> <span data-start="152.709" data-end="155.36">accessible to those guys the developers</span> <span data-start="155.36" data-end="157.13">for IE would it would have helped them</span> <span data-start="157.13" data-end="159.56">maybe pinpoint to narrow down more</span> <span data-start="159.56" data-end="161.11">meaningful benchmarks in their own</span> <span data-start="161.11" data-end="168.23">browser tests so i'm a co-developer on</span> </p>
<p><span data-start="168.23" data-end="170.989">Jas perf calm how many people have used</span> <span data-start="170.989" data-end="174.56">Jas perf awesome great so I make the</span> <span data-start="174.56" data-end="177.44">thing that makes this work which is a</span> <span data-start="177.44" data-end="180.049">benchmark framework called benchmark Jas</span> <span data-start="180.049" data-end="185.5">so i'll write their benchmark j/s calm</span> <span data-start="185.5" data-end="188.42">what I as I was looking at those other</span> <span data-start="188.42" data-end="192.65">solutions I took it apart rewrote the</span> <span data-start="192.65" data-end="196.04">the underlying code from Jas perf from</span> <span data-start="196.04" data-end="198.889">scratch and I wanted to make like the</span> <span data-start="198.889" data-end="202.13">most thorough benchmarking framework for</span> </p>
<p><span data-start="202.13" data-end="203.569">JavaScript and this runs and almost</span> <span data-start="203.569" data-end="206.329">anything it should support Safari 2.00</span> <span data-start="206.329" data-end="212.12">to IE 10 preview to node norwall ringo</span> <span data-start="212.12" data-end="214.639">rhino all of your bases should be</span> <span data-start="214.639" data-end="219.079">covered so let's get to this there's</span> <span data-start="219.079" data-end="221.42">also a small project i started working</span> <span data-start="221.42" data-end="225.97">on called x stats j/s which is j s /</span> <span data-start="225.97" data-end="229.94">tests a little snippets of JavaScript</span> <span data-start="229.94" data-end="232.43">and usually it's you start the timer you</span> <span data-start="232.43" data-end="234.669">do the snippet then you you in the timer</span> <span data-start="234.669" data-end="236.78">but this is more of a passive</span> <span data-start="236.78" data-end="239.599">benchmarking tool this allows you to to</span> <span data-start="239.599" data-end="241.489">monitor the frames per second the memory</span> <span data-start="241.489" data-end="243.13">usage and certain browsers that support</span> <span data-start="243.13" data-end="244.59">monitoring the memory</span> <span data-start="244.59" data-end="247.319">and and a little millisecond timer that</span> <span data-start="247.319" data-end="249.75">too and this is a rewrite of something</span> <span data-start="249.75" data-end="253.709">that mr. du bid but he used a Candace</span> <span data-start="253.709" data-end="256.38">element minds using just raw HTML to</span> <span data-start="256.38" data-end="259.739">like their Li Oh is there to dren der</span> <span data-start="259.739" data-end="261.6">that so it's taking away less from the</span> <span data-start="261.6" data-end="263.25">actual application or trying to</span> <span data-start="263.25" data-end="265.71">benchmark in mobile devices especially</span> <span data-start="265.71" data-end="268.83">if you've got canvas on the page you're</span> <span data-start="268.83" data-end="270.27">eating away at the performance that</span> <span data-start="270.27" data-end="271.68">you're actually trying to measure so</span> <span data-start="271.68" data-end="276.53">that's a passive approach there and</span> <span data-start="276.53" data-end="279.21">there's there's basically there's a few</span> <span data-start="279.21" data-end="280.8">patterns when you when you benchmark</span> <span data-start="280.8" data-end="284.88">things the most common one is you have a</span> <span data-start="284.88" data-end="287.01">while loop you start a timer you have</span> <span data-start="287.01" data-end="288.69">let's say you're counting down 100</span> <span data-start="288.69" data-end="291.54">executions and then you you end your</span> <span data-start="291.54" data-end="292.71">timer and then you subtract the</span> <span data-start="292.71" data-end="294.419">difference and get get a millisecond</span> <span data-start="294.419" data-end="298.49">count and that's done in things like</span> <span data-start="298.49" data-end="303.87">slick speed test speed sunspider nodes</span> <span data-start="303.87" data-end="306.93">benchmarks basically it's the most</span> <span data-start="306.93" data-end="310.62">common and probably the worst kind of</span> <span data-start="310.62" data-end="314.1">benchmark to do because because if</span> <span data-start="314.1" data-end="315.78">they're fixed iterations it means as</span> <span data-start="315.78" data-end="317.91">hardware and as your environments are</span> <span data-start="317.91" data-end="319.77">getting faster eventually you're going</span> <span data-start="319.77" data-end="322.07">to get a lot of zero millisecond record</span> <span data-start="322.07" data-end="325.229">readings and zero milliseconds you can't</span> <span data-start="325.229" data-end="326.58">do anything with that I mean there's no</span> <span data-start="326.58" data-end="329.49">way to compare 0 to 0 so that is the</span> <span data-start="329.49" data-end="333.82">major flaw with with doing it this way</span> <span data-start="333.83" data-end="336.21">but there's another pattern and this is</span> <span data-start="336.21" data-end="338.52">the one that Dromio uses and this is</span> <span data-start="338.52" data-end="341.729">also what v8 sweet uses they basically</span> <span data-start="341.729" data-end="346.41">run a test for one second repeatedly for</span> <span data-start="346.41" data-end="348.96">one second and then calculate the</span> <span data-start="348.96" data-end="351.78">operations per second and do it that way</span> <span data-start="351.78" data-end="353.52">and that gives you a better read but</span> <span data-start="353.52" data-end="356.7">it's still not quite there because</span> <span data-start="356.7" data-end="359.789">they're forcing all browsers to run this</span> <span data-start="359.789" data-end="362.639">this test for one second and if you're</span> <span data-start="362.639" data-end="365.84">doing especially small tests that are</span> <span data-start="365.84" data-end="368.01">your testing something that executes a</span> <span data-start="368.01" data-end="369.72">lot of times you're going to end up</span> <span data-start="369.72" data-end="372.289">choking up the browser and law</span> <span data-start="372.289" data-end="374.509">you know when you're running this and so</span> <span data-start="374.509" data-end="376.069">what I one of the things I learned</span> <span data-start="376.069" data-end="377.96">whatever I was developing benchmark Jas</span> <span data-start="377.96" data-end="381.619">is that you actually don't need to run a</span> <span data-start="381.619" data-end="384.05">test for one second one second was was</span> <span data-start="384.05" data-end="386.93">something that they added for IES poor</span> <span data-start="386.93" data-end="388.879">timer resolution which I'll get into in</span> <span data-start="388.879" data-end="391.669">another slide but basically it can only</span> <span data-start="391.669" data-end="394.669">it can only measure 15 about 15</span> <span data-start="394.669" data-end="398.349">milliseconds for the older I ease and</span> <span data-start="398.349" data-end="400.309">the newer ones like what four</span> <span data-start="400.309" data-end="404.99">milliseconds the ie9 and so whenever you</span> <span data-start="404.99" data-end="406.699">put that into a formula to figure out</span> <span data-start="406.699" data-end="409.849">the crispy how long you need to run a</span> <span data-start="409.849" data-end="411.559">test to get a percentage uncertainty of</span> <span data-start="411.559" data-end="414.249">like one percent it ends up being about</span> <span data-start="414.249" data-end="417.199">750 milliseconds and so most most of</span> <span data-start="417.199" data-end="419.809">these things just run for one second but</span> <span data-start="419.809" data-end="421.789">if you if you apply that to working</span> <span data-start="421.789" data-end="423.68">browsers normal browsers that have a one</span> <span data-start="423.68" data-end="426.589">millisecond resolution you bet a you</span> <span data-start="426.589" data-end="428.389">only really need to run a test for 50</span> <span data-start="428.389" data-end="430.729">milliseconds and so what what that</span> <span data-start="430.729" data-end="432.949">allows you to do is that with with tests</span> <span data-start="432.949" data-end="437.269">like v8 sweet and even SunSpider they</span> <span data-start="437.269" data-end="439.039">run these tests multiple times and then</span> <span data-start="439.039" data-end="441.74">they perform statistical analysis on</span> <span data-start="441.74" data-end="443.93">them and what what this allows you to do</span> <span data-start="443.93" data-end="446.659">is because I run the test for a smaller</span> <span data-start="446.659" data-end="448.969">amount of time only 50 milliseconds I'm</span> <span data-start="448.969" data-end="452.99">able to run more samples of that test</span> <span data-start="452.99" data-end="455.029">and then that will help me reduce the</span> <span data-start="455.029" data-end="457.37">margin of error of the end result so</span> <span data-start="457.37" data-end="458.93">that's that's something that they could</span> <span data-start="458.93" data-end="464.209">make it actually tweak there so a big</span> <span data-start="464.209" data-end="466.159">problem I see with or something I've</span> <span data-start="466.159" data-end="468.349">seen with and these these are actual</span> </p>
<p><span data-start="468.349" data-end="471.229">URLs you can visit there to see this</span> <span data-start="471.229" data-end="475.61">this test is context a lot of times</span> <span data-start="475.61" data-end="478.369">those developers will see the the green</span> <span data-start="478.369" data-end="481.099">result or the red result and make like</span> <span data-start="481.099" data-end="483.379">an instant snap decision Wow one is</span> <span data-start="483.379" data-end="485.959">totally better than the other and I hope</span> <span data-start="485.959" data-end="488.98">that you guys take some</span> <span data-start="488.98" data-end="491.86">just step back and go well wait a minute</span> <span data-start="491.86" data-end="496.96">that's you know that's 538 million per</span> <span data-start="496.96" data-end="498.85">second I mean that's crazy fast and the</span> <span data-start="498.85" data-end="502.69">slowest is 12 million operations a</span> <span data-start="502.69" data-end="505.93">second that's still crazy fast you're</span> <span data-start="505.93" data-end="507.67">not going to be bad either way if you</span> <span data-start="507.67" data-end="509.32">use either one of them so just kind of</span> <span data-start="509.32" data-end="511.15">pay attention to the operations per</span> <span data-start="511.15" data-end="514">second and and not necessarily just</span> <span data-start="514" data-end="516.22">which one is being you're being told is</span> <span data-start="516.22" data-end="518.65">the fastest so there's another thing</span> <span data-start="518.65" data-end="520.95">that goes into context and that is</span> <span data-start="520.95" data-end="523.84">consistency and reproducible being able</span> <span data-start="523.84" data-end="527.5">to reproduce results consistently in</span> <span data-start="527.5" data-end="529.78">this case you'll notice it's the exact</span> <span data-start="529.78" data-end="534.01">same test done three times and the end</span> <span data-start="534.01" data-end="537.64">result they vary a little but the system</span> <span data-start="537.64" data-end="539.71">is able to detect that and say hey these</span> <span data-start="539.71" data-end="540.94">are all statistically indistinguishable</span> <span data-start="540.94" data-end="543.91">from each other and so it says hey</span> <span data-start="543.91" data-end="546.28">they're all the fastest and that's</span> <span data-start="546.28" data-end="547.66">another reason why you don't necessarily</span> <span data-start="547.66" data-end="549.54">need to get hung up on the actual</span> <span data-start="549.54" data-end="551.8">operations per second because they'll</span> <span data-start="551.8" data-end="555.85">bury about five percent from test to</span> <span data-start="555.85" data-end="557.5">retest and I that's been pretty</span> <span data-start="557.5" data-end="560.08">consistent even into like mobile</span> <span data-start="560.08" data-end="563.41">browsing on mobile safari it's and then</span> <span data-start="563.41" data-end="565.99">on IE i noticed that if i increased it</span> <span data-start="565.99" data-end="570.13">from three times two let's see two more</span> <span data-start="570.13" data-end="571.66">than that even like this is an empty</span> <span data-start="571.66" data-end="573.59">test so that's dead code removal</span> <span data-start="573.59" data-end="576.05">but you can see that the result still</span> <span data-start="576.05" data-end="578.6">says it's they're very close and that's</span> <span data-start="578.6" data-end="582.56">because it's it's got a larger sample</span> <span data-start="582.56" data-end="584.87">size a lower margin of error and you can</span> <span data-start="584.87" data-end="586.37">see the margin of error there's a point</span> <span data-start="586.37" data-end="592.4">for 4.7 3.06 or point 46 and so using a</span> <span data-start="592.4" data-end="594.68">formula to be able to detect the</span> <span data-start="594.68" data-end="596.81">statistical significance between results</span> <span data-start="596.81" data-end="599">you're able to get a consistent read</span> <span data-start="599" data-end="601.76">every time and that's important there's</span> <span data-start="601.76" data-end="603.8">one issue I'll back up one slide here</span> <span data-start="603.8" data-end="607.22">there's actually a Firefox trace monkey</span> <span data-start="607.22" data-end="608.87">bug that has an issue with repeating</span> <span data-start="608.87" data-end="611.95">code blocks in getting gradually slower</span> <span data-start="611.95" data-end="615.17">results so there was a nice work around</span> <span data-start="615.17" data-end="616.43">with that where I have to access the</span> <span data-start="616.43" data-end="618.5">window object manipulate a variable</span> <span data-start="618.5" data-end="621.65">between each test so far Firefox has</span> <span data-start="621.65" data-end="624.17">been the one that's had the most engine</span> <span data-start="624.17" data-end="625.85">problems trying to get a bead on</span> <span data-start="625.85" data-end="629.72">performance so why is reproducing</span> <span data-start="629.72" data-end="631.85">results important well this is this is</span> </p>
<p><span data-start="631.85" data-end="636.14">Sun spiders result here and you can see</span> <span data-start="636.14" data-end="638">this is what I took this in my mobile</span> <span data-start="638" data-end="640.58">phone and I ran it I ran the same test</span> <span data-start="640.58" data-end="643.34">twice for the browser and you can see</span> <span data-start="643.34" data-end="645.77">there it says my browser is there's a</span> <span data-start="645.77" data-end="647.27">significant difference between my</span> <span data-start="647.27" data-end="649.7">browser and my browser and that's that's</span> <span data-start="649.7" data-end="652.91">incorrect and this is what browser</span> <span data-start="652.91" data-end="656.66">vendors are using to to to tweak their</span> <span data-start="656.66" data-end="660.98">stuff I mean this is this is so bad if</span> <span data-start="660.98" data-end="662.33">we go in here you'll actually notice</span> <span data-start="662.33" data-end="663.83">there's code there's there's there's</span> <span data-start="663.83" data-end="665.78">bugs and their actual formula for</span> <span data-start="665.78" data-end="668.12">calculating significance of results</span> <span data-start="668.12" data-end="670.67">you'll see there there's a typo there</span> <span data-start="670.67" data-end="672.68">and they're actually using an incorrect</span> <span data-start="672.68" data-end="677.12">formula whenever I was investigating how</span> <span data-start="677.12" data-end="679.34">to do benchmarking the hardest part was</span> <span data-start="679.34" data-end="681.32">finding formulas and finding accurate</span> <span data-start="681.32" data-end="684.59">formulas and I don't know statistics</span> <span data-start="684.59" data-end="686.6">naturally I mean I'm came from a</span> <span data-start="686.6" data-end="688.34">multimedia background so I had to do a</span> <span data-start="688.34" data-end="691.04">lot of research and trying to figure out</span> <span data-start="691.04" data-end="694.19">how this is done and it was surprising</span> <span data-start="694.19" data-end="694.93">you get into</span> <span data-start="694.93" data-end="699.37">little things like for example when</span> <span data-start="699.37" data-end="701.92">you're comparing rates there's there's a</span> <span data-start="701.92" data-end="705.22">there's a thing called a geometric mean</span> <span data-start="705.22" data-end="707.95">which is something that VA sweet uses</span> <span data-start="707.95" data-end="711.029">for theirs and then there's there's a</span> <span data-start="711.029" data-end="713.8">there's a harmonic mean and when you're</span> <span data-start="713.8" data-end="715.42">dealing with rates in this case</span> <span data-start="715.42" data-end="717.94">operations per second the harmonic mean</span> <span data-start="717.94" data-end="721.48">is preferred but Dromio it deals with</span> <span data-start="721.48" data-end="723.73">rates but it uses the geometric mean so</span> <span data-start="723.73" data-end="726.339">you get these slightly slanted views of</span> <span data-start="726.339" data-end="729.58">performance because their formulas</span> <span data-start="729.58" data-end="735.31">aren't quite correct so getting down to</span> <span data-start="735.31" data-end="738.22">the issue back where it was I ease timer</span> <span data-start="738.22" data-end="739.66">resolution where it's 15 milliseconds</span> <span data-start="739.66" data-end="742.06">versus one millisecond vs 4 milliseconds</span> <span data-start="742.06" data-end="744.97">on different environments how do you get</span> <span data-start="744.97" data-end="747.7">a consistent resolution and what I found</span> <span data-start="747.7" data-end="749.86">was that you can you can actually expose</span> <span data-start="749.86" data-end="753.64">the Javas nanosecond timer so you can</span> <span data-start="753.64" data-end="756.49">get nanosecond ish resolution in the</span> <span data-start="756.49" data-end="758.47">browser just by doing this tiny little</span> <span data-start="758.47" data-end="761.11">java basically I'm just exposing the</span> <span data-start="761.11" data-end="764.11">method and so now all browsers that</span> <span data-start="764.11" data-end="766.839">support java and this is yjs perf you'll</span> <span data-start="766.839" data-end="769.3">see your little java icon power up there</span> <span data-start="769.3" data-end="771.85">if you're using JSP and it's because we</span> <span data-start="771.85" data-end="775.26">by default if this is in the page</span> <span data-start="775.26" data-end="778.54">benchmark j/s will use the nano second</span> <span data-start="778.54" data-end="781.12">timer and it's not quite nanosecond</span> <span data-start="781.12" data-end="783.97">resolution because there's there's a</span> <span data-start="783.97" data-end="785.8">cost of communicating between JavaScript</span> <span data-start="785.8" data-end="787.99">and Java but it's still better than the</span> <span data-start="787.99" data-end="790.69">15 millisecond issue of IE and it's</span> <span data-start="790.69" data-end="792.459">still better it's still better than a</span> <span data-start="792.459" data-end="795.73">millisecond resolution so it gives you a</span> <span data-start="795.73" data-end="798.31">better more consistent way to do that</span> <span data-start="798.31" data-end="800.92">and it keeps the tests fast in different</span> <span data-start="800.92" data-end="803.68">environments like for IE if without this</span> <span data-start="803.68" data-end="805.81">we would detect the default time and it</span> <span data-start="805.81" data-end="808.12">would say 750 milliseconds and that just</span> <span data-start="808.12" data-end="812.73">plugs along on your bench marks so I</span> <span data-start="812.73" data-end="817.05">mentioned formulas and this is gross and</span> <span data-start="817.05" data-end="820.6">really boring but there's there's all</span> <span data-start="820.6" data-end="824.62">kinds of formulas that go into figuring</span> <span data-start="824.62" data-end="827.76">out statistical significance and and</span> <span data-start="827.76" data-end="829.99">meaningful information to your</span> <span data-start="829.99" data-end="831.88">benchmarks and data and so for example</span> <span data-start="831.88" data-end="833.89">there's the mean there's the variance</span> <span data-start="833.89" data-end="837.82">there is the sample a DV standard</span> <span data-start="837.82" data-end="840.25">deviation there's the standard error of</span> <span data-start="840.25" data-end="843.04">the mean I mean all of this stuff is is</span> <span data-start="843.04" data-end="845.529">is useful and you can you end up getting</span> <span data-start="845.529" data-end="847.9">that that nice display on Jasper where</span> <span data-start="847.9" data-end="850.06">it shows you the operations per second</span> <span data-start="850.06" data-end="852.55">your margin of error and then it's able</span> <span data-start="852.55" data-end="854.589">based with all these formulas be able to</span> <span data-start="854.589" data-end="857.26">tell the statistical significance of one</span> <span data-start="857.26" data-end="860.589">result versus another and this is where</span> <span data-start="860.589" data-end="864.52">it goes here for the statistical</span> <span data-start="864.52" data-end="866.68">significance and what was interesting is</span> <span data-start="866.68" data-end="868.51">now I mentioned before the formula i'm</span> <span data-start="868.51" data-end="870.64">using is something called a two-sample</span> <span data-start="870.64" data-end="875.17">t-test and it's great on paper and it's</span> <span data-start="875.17" data-end="879.1">something that sunspider uses i'm sure</span> <span data-start="879.1" data-end="881.65">some other ones use but i noticed that</span> <span data-start="881.65" data-end="883.51">in real life whenever you're comparing</span> <span data-start="883.51" data-end="885.97">javascript performance that it was way</span> <span data-start="885.97" data-end="887.83">too sensitive and as you saw with the</span> <span data-start="887.83" data-end="889.66">the SunSpider result where it said i was</span> <span data-start="889.66" data-end="892.959">significantly faster than myself that's</span> <span data-start="892.959" data-end="895.66">because this this formula is is really</span> <span data-start="895.66" data-end="898.45">sensitive and so I threw in a five</span> <span data-start="898.45" data-end="900.61">percent wiggle room there and that that</span> <span data-start="900.61" data-end="902.8">seems to be very consistent across</span> <span data-start="902.8" data-end="905.41">browsers so that's that's something to</span> <span data-start="905.41" data-end="908.62">consider um like I said I don't learn I</span> </p>
<p><span data-start="908.62" data-end="912.07">I didn't learn a lot of this stuff like</span> <span data-start="912.07" data-end="914.709">naturally I mean I had to to do a lot of</span> <span data-start="914.709" data-end="920.07">research and I really dug the videos on</span> <span data-start="920.07" data-end="922.48">Khan Academy like if you need to learn</span> <span data-start="922.48" data-end="924.13">something and this is the standard error</span> <span data-start="924.13" data-end="925.379">of the mean</span> <span data-start="925.379" data-end="927.839">and he just spells it out really nice</span> <span data-start="927.839" data-end="930.869">and so that was I use that I recommend</span> <span data-start="930.869" data-end="934.709">that you guys could check that out so</span> <span data-start="934.709" data-end="938.299">what are the gotchas of benchmarking and</span> <span data-start="938.299" data-end="942.449">so there was a lot of drama with ie9 and</span> <span data-start="942.449" data-end="946.679">SunSpider there's accusations going back</span> <span data-start="946.679" data-end="948.299">and forth and are they cheating or not</span> <span data-start="948.299" data-end="949.679">it just turned out to be dead code</span> <span data-start="949.679" data-end="953.069">removal and that's something you have to</span> <span data-start="953.069" data-end="955.379">consider like I would say the majority</span> <span data-start="955.379" data-end="957.299">of the benchmark Sanjay Esper are</span> <span data-start="957.299" data-end="960.409">probably bad benchmarks and it's because</span> <span data-start="960.409" data-end="964.229">making good benchmarks is hard and I</span> <span data-start="964.229" data-end="966.239">took care of the the part of measuring</span> <span data-start="966.239" data-end="968.369">the actual performance but now it's up</span> <span data-start="968.369" data-end="970.859">to developers and everyone else to kind</span> <span data-start="970.859" data-end="972.989">of make really good benchmarks so some</span> <span data-start="972.989" data-end="975.989">of the issues you can have our dead code</span> <span data-start="975.989" data-end="978.019">removal so like before where I had that</span> <span data-start="978.019" data-end="982.109">that empty block here that's dead that</span> <span data-start="982.109" data-end="983.639">could be dead pogrom well I mean that's</span> <span data-start="983.639" data-end="986.879">basically just running nothing and so</span> <span data-start="986.879" data-end="988.379">that you have to be careful of</span> <span data-start="988.379" data-end="989.729">benchmarking stuff like that because</span> <span data-start="989.729" data-end="991.829">then if your if your engine is optimized</span> <span data-start="991.829" data-end="993.479">to remove that stuff and it's going to</span> <span data-start="993.479" data-end="995.22">perform faster than something that's not</span> <span data-start="995.22" data-end="997.559">optimized to remove that then there's</span> <span data-start="997.559" data-end="999.299">other issues where you have like</span> <span data-start="999.299" data-end="1001.939">long-running tasks like crank crankshaft</span> <span data-start="1001.939" data-end="1003.859">can kick in and you'll see the the</span> <span data-start="1003.859" data-end="1006.769">performance results change there or for</span> <span data-start="1006.769" data-end="1008.749">example opera has query schlechter all</span> <span data-start="1008.749" data-end="1010.699">but it caches its result and so since</span> <span data-start="1010.699" data-end="1012.769">this benchmark is based on repeating</span> <span data-start="1012.769" data-end="1014.899">things to get operations for a second</span> <span data-start="1014.899" data-end="1017.239">it's you're getting a cached result so</span> <span data-start="1017.239" data-end="1020.509">there's there's considerations there and</span> <span data-start="1020.509" data-end="1022.039">you just need to be aware of your actual</span> <span data-start="1022.039" data-end="1025.189">environment there's also reasons why for</span> <span data-start="1025.189" data-end="1028.039">example drumeo isn't as preferred as</span> <span data-start="1028.039" data-end="1032.12">cracking is because it does it has all</span> <span data-start="1032.12" data-end="1033.74">of its tests in a closure and then it</span> <span data-start="1033.74" data-end="1036.25">accesses variables on the global and</span> <span data-start="1036.25" data-end="1038.72">when it does that there's a performance</span> <span data-start="1038.72" data-end="1041.899">hit with Firefox and so they don't</span> <span data-start="1041.899" data-end="1043.07">prefer that test they want</span> <span data-start="1043.07" data-end="1045.35">show it on local variables because it</span> <span data-start="1045.35" data-end="1048.47">makes them you know look better so this</span> <span data-start="1048.47" data-end="1050.72">you have to keep that in mind with this</span> <span data-start="1050.72" data-end="1053.66">this kind of testing two I provide API</span> <span data-start="1053.66" data-end="1055.76">so you can do local test but by default</span> <span data-start="1055.76" data-end="1058.4">you're you're going from a closure to</span> <span data-start="1058.4" data-end="1061.55">the local the global variables so keep</span> <span data-start="1061.55" data-end="1063.41">that mind to whatever your you're doing</span> <span data-start="1063.41" data-end="1068.86">that it affects your your stuff okay and</span> <span data-start="1068.86" data-end="1083.07">so questions anyone nothing you yeah</span> <span data-start="1083.08" data-end="1087.83">does that affect</span> </p>
<p><span data-start="1087.84" data-end="1092.01">I i missed the actual talk on that there</span> <span data-start="1092.01" data-end="1094.409">they this has to deal with the timer</span> <span data-start="1094.409" data-end="1099.45">resolution and basically if you run the</span> <span data-start="1099.45" data-end="1101.34">new date and the new date what's the</span> <span data-start="1101.34" data-end="1103.169">smallest amount of time in there that</span> <span data-start="1103.169" data-end="1105.45">you can that you can read and that's how</span> <span data-start="1105.45" data-end="1107.07">I find the minimum the minimum</span> <span data-start="1107.07" data-end="1109.38">resolution and in this case I do it in</span> <span data-start="1109.38" data-end="1110.909">the for loop until you get a difference</span> <span data-start="1110.909" data-end="1116.07">in time and with ie9 i'm told it's it's</span> <span data-start="1116.07" data-end="1118.26">four milliseconds now and i actually</span> <span data-start="1118.26" data-end="1119.4">don't have to worry about it because my</span> <span data-start="1119.4" data-end="1121.74">script detects that the minimum time so</span> <span data-start="1121.74" data-end="1123.27">that that's really what it would detect</span> <span data-start="1123.27" data-end="1127.83">on the run speed the the long running</span> <span data-start="1127.83" data-end="1130.44">tests i run on Jas / if I run them for</span> <span data-start="1130.44" data-end="1133.14">five seconds just so I can get more of a</span> <span data-start="1133.14" data-end="1135.419">sample size so it usually ends up being</span> <span data-start="1135.419" data-end="1137.25">about a hundred which is above and</span> <span data-start="1137.25" data-end="1140.789">beyond most benchmarks I think Dromio</span> <span data-start="1140.789" data-end="1144.48">does five and sunspider does 10 so</span> <span data-start="1144.48" data-end="1146.58">having that bigger size just reduces the</span> <span data-start="1146.58" data-end="1148.169">margin of error but i don't know if that</span> <span data-start="1148.169" data-end="1150.51">that would that should not affect the</span> <span data-start="1150.51" data-end="1153.659">the length the benchmark runs it'll</span> <span data-start="1153.659" data-end="1155.69">affect the overall performance though</span> <span data-start="1155.69" data-end="1168.52">cool yes</span> <span data-start="1168.53" data-end="1172.31">yeah that I I did i used it i went into</span> <span data-start="1172.31" data-end="1175.58">all of that nano and micro benchmarking</span> <span data-start="1175.58" data-end="1177.32">on should i use new date should i use</span> <span data-start="1177.32" data-end="1180.68">date now should i use get time all in it</span> <span data-start="1180.68" data-end="1182.93">doesn't matter it's it's so tiny that</span> <span data-start="1182.93" data-end="1186.56">it's they're using one versus the other</span> <span data-start="1186.56" data-end="1189.11">is statistically indistinguishable from</span> <span data-start="1189.11" data-end="1191.45">them in fact there is there some</span> <span data-start="1191.45" data-end="1192.65">benchmarks that you know try to</span> <span data-start="1192.65" data-end="1196.61">calibrate out the cost and the overhead</span> <span data-start="1196.61" data-end="1198.65">of the the iteration like the while loop</span> <span data-start="1198.65" data-end="1199.79">you're actually having to do in the</span> <span data-start="1199.79" data-end="1201.92">function clunk and getting and entering</span> <span data-start="1201.92" data-end="1204.46">the execution context but i found that</span> <span data-start="1204.46" data-end="1207.5">whenever you subtract that calibration</span> <span data-start="1207.5" data-end="1210.08">cost from your end result you actually</span> <span data-start="1210.08" data-end="1211.76">get a higher margin of error so it</span> <span data-start="1211.76" data-end="1213.74">swallows any of the accuracy you were</span> <span data-start="1213.74" data-end="1217.04">hoping to gain by calibrating out that</span> <span data-start="1217.04" data-end="1219.74">stuff so in the end it's it's better to</span> <span data-start="1219.74" data-end="1221.42">just leave it in it's not a noticeable</span> <span data-start="1221.42" data-end="1234.05">difference oh</span> <span data-start="1234.06" data-end="1237.78">the that's Matthias's is the the main</span> <span data-start="1237.78" data-end="1240.75">drive behind me maintaining that and</span> <span data-start="1240.75" data-end="1242.43">that's just his design choice that's</span> <span data-start="1242.43" data-end="1245.37">simple it's really just he'd want it to</span> <span data-start="1245.37" data-end="1249.54">be very very simple to do so cool all</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
