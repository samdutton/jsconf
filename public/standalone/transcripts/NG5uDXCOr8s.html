<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>NG5uDXCOr8s</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/NG5uDXCOr8s?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="37.38" data-end="40.21">hey everybody welcome to my talk on</span> <span data-start="40.21" data-end="42.16">campus performance tips you will learn</span> <span data-start="42.16" data-end="46.18">how to pixels well as Adam mentioned my</span> <span data-start="46.18" data-end="48.4">name is Angelina if you are interested</span> <span data-start="48.4" data-end="50.98">in complaining about code sometimes</span> <span data-start="50.98" data-end="53.26">retweeted articles about code a curated</span> <span data-start="53.26" data-end="55.09">selection of red panda gifts or perhaps</span> <span data-start="55.09" data-end="56.26">you're just interested in the slides</span> <span data-start="56.26" data-end="58.329">from this talk afterwards you can follow</span> <span data-start="58.329" data-end="62.1">me as Angelina Magnum on Twitter so</span> <span data-start="62.1" data-end="64.659">whenever I start writing code on the</span> </p>
<p><span data-start="64.659" data-end="65.409">Internet</span> <span data-start="65.409" data-end="68.039">which is basically all that we do</span> <span data-start="68.039" data-end="69.909">invariably when I'm learning something</span> <span data-start="69.909" data-end="72.46">new I come across this idea you know</span> <span data-start="72.46" data-end="74.259">that you should just write code worried</span> <span data-start="74.259" data-end="76.81">about performance later and in essence</span> <span data-start="76.81" data-end="78.219">this is actually mostly true you don't</span> <span data-start="78.219" data-end="81.069">want to try and over optimize too early</span> <span data-start="81.069" data-end="82.59">otherwise you're spending a lot of time</span> <span data-start="82.59" data-end="84.759">tweaking things which may not have a</span> <span data-start="84.759" data-end="86.319">larger impact on the project you're</span> <span data-start="86.319" data-end="89.71">working on but more importantly in my</span> <span data-start="89.71" data-end="91.45">opinion you'll get distracted from all</span> <span data-start="91.45" data-end="92.92">the code that you should be writing to</span> <span data-start="92.92" data-end="94.959">get the project done so the person that</span> <span data-start="94.959" data-end="96.49">wrote this or that writes quote quotes</span> <span data-start="96.49" data-end="97.78">like this on the internet and you often</span> <span data-start="97.78" data-end="99.249">find this attached to performance</span> <span data-start="99.249" data-end="101.499">related articles I think is mostly</span> <span data-start="101.499" data-end="104.74">correct but I don't think entirely I</span> <span data-start="104.74" data-end="105.88">think we should think about this just a</span> <span data-start="105.88" data-end="109.539">little bit differently so I like to say</span> <span data-start="109.539" data-end="112.179">now as of yesterday optimizations are a</span> <span data-start="112.179" data-end="114.429">last step best practices should be every</span> <span data-start="114.429" data-end="116.38">step so I'm hoping today that I give you</span> <span data-start="116.38" data-end="118.42">some ideas about best practices working</span> <span data-start="118.42" data-end="119.979">with canvas that are easy for people</span> <span data-start="119.979" data-end="122.469">that are both new to canvas and maybe</span> <span data-start="122.469" data-end="123.909">seasoned people I hope that I teach you</span> <span data-start="123.909" data-end="125.56">one or two things that you you didn't</span> <span data-start="125.56" data-end="128.74">already know so first of all let's</span> <span data-start="128.74" data-end="133">travel back in time to the 1990s so once</span> <span data-start="133" data-end="135.29">upon a time in the 1990s</span> <span data-start="135.29" data-end="137.15">we had some limitations in our browser</span> <span data-start="137.15" data-end="138.53">right there wasn't a lot we could do</span> <span data-start="138.53" data-end="140.81">with a drawing we had HTML which you</span> <span data-start="140.81" data-end="142.519">know before the word web application was</span> <span data-start="142.519" data-end="144.799">even a thing we could create you know</span> <span data-start="144.799" data-end="146.659">documents that were just mostly like</span> <span data-start="146.659" data-end="148.519">documents we got introduced to CSS which</span> <span data-start="148.519" data-end="150.859">provided some styling for said documents</span> <span data-start="150.859" data-end="152.18">and it actually took quite a while till</span> <span data-start="152.18" data-end="153.95">we could do sophisticated drawing these</span> <span data-start="153.95" data-end="155.989">days in 2014 you can do really</span> <span data-start="155.989" data-end="158.51">sophisticated CSS transforms and</span> <span data-start="158.51" data-end="160.79">animations and there's like if you ever</span> <span data-start="160.79" data-end="163.7">go over onto a code pen there's some</span> <span data-start="163.7" data-end="165.349">really fantastic examples of the stuff</span> <span data-start="165.349" data-end="166.34">that people are doing there</span> <span data-start="166.34" data-end="169.879">so when early programmers of the 1990s</span> <span data-start="169.879" data-end="171.739">came up against the limitations of the</span> <span data-start="171.739" data-end="173.239">browser and thought like well I want to</span> <span data-start="173.239" data-end="174.919">make a I want to make a game and keep in</span> <span data-start="174.919" data-end="177.29">mind javascript wasn't cool yet it was</span> <span data-start="177.29" data-end="179.18">still you know like a new kid on the</span> <span data-start="179.18" data-end="179.659">block</span> <span data-start="179.659" data-end="183.53">and when people were met up against the</span> <span data-start="183.53" data-end="185.06">boundary of the browser they sought to</span> <span data-start="185.06" data-end="187.909">extend the browser using plugins so a</span> <span data-start="187.909" data-end="189.409">couple of the early things that we had</span> <span data-start="189.409" data-end="191.81">for drawing the web was VRML or ver</span> </p>
<p><span data-start="191.81" data-end="194.389">Mille which was a standardized markup</span> <span data-start="194.389" data-end="196.609">language for describing objects in 3d</span> <span data-start="196.609" data-end="198.34">space and applying textures to them and</span> <span data-start="198.34" data-end="201.199">that kind of was a thing but then it</span> <span data-start="201.199" data-end="202.76">really wasn't it was superseded by</span> <span data-start="202.76" data-end="204.26">something called X 3d and then it was</span> <span data-start="204.26" data-end="206.049">superseded by like everything else and</span> <span data-start="206.049" data-end="208.159">then there were these things Java</span> <span data-start="208.159" data-end="210.47">applets this one still exists you can</span> <span data-start="210.47" data-end="213.739">play it on the internet and you should</span> <span data-start="213.739" data-end="215.239">check it out because it's really a blast</span> <span data-start="215.239" data-end="215.959">from the past</span> <span data-start="215.959" data-end="218.359">although the Java like the latest Java</span> </p>
<p><span data-start="218.359" data-end="220.069">Runtime for the browser will warn you</span> <span data-start="220.069" data-end="221.09">that there's like tons of security</span> <span data-start="221.09" data-end="222.859">exceptions I can leave out that this</span> <span data-start="222.859" data-end="224.75">didn't install viruses on my computer so</span> <span data-start="224.75" data-end="226.22">if you do feel like going into the past</span> <span data-start="226.22" data-end="231.979">at your own risk so at least there's at</span> <span data-start="231.979" data-end="232.909">least two and I mean there's there's</span> <span data-start="232.909" data-end="233.84">more than just the three I'm going to</span> <span data-start="233.84" data-end="234.769">talk about but of course there's also</span> <span data-start="234.769" data-end="236.81">Macromedia Flash which eventually went</span> <span data-start="236.81" data-end="239.269">on to become and Dobey product and flash</span> <span data-start="239.269" data-end="241.129">is still around</span> <span data-start="241.129" data-end="243.739">I don't know for how long and that's for</span> <span data-start="243.739" data-end="245.299">good reason because we have some better</span> <span data-start="245.299" data-end="247.22">methods for drawing in the browser we</span> <span data-start="247.22" data-end="249.319">have AP eyes in the browser for doing</span> <span data-start="249.319" data-end="251.509">drawing and creating animations so we've</span> <span data-start="251.509" data-end="253.129">got this canvas tag which is basically</span> <span data-start="253.129" data-end="254.209">all you need for drawing but then</span> <span data-start="254.209" data-end="256.94">there's also this SVG thing too so when</span> <span data-start="256.94" data-end="258.859">do you use SVG and when to use canvas</span> <span data-start="258.859" data-end="260.769">we'll explore that in just a little bit</span> <span data-start="260.769" data-end="263.06">first of all let's take a look at a</span> <span data-start="263.06" data-end="264.919">simple animation with canvas and I've</span> <span data-start="264.919" data-end="266.96">got like a little code pen up here that</span> </p>
<p><span data-start="266.96" data-end="269.06">I whipped up you can see on the</span> <span data-start="269.06" data-end="270.08">t'ayn said I guess that's a little bit</span> <span data-start="270.08" data-end="271.37">small and see if I can zoom in and not</span> <span data-start="271.37" data-end="273.97">have this be terrible it's kind of okay</span> <span data-start="273.97" data-end="276.8">collapse of pain alright so we've got</span> <span data-start="276.8" data-end="278.6">just a canvas element there and over on</span> <span data-start="278.6" data-end="279.86">the right hand side I'm grabbing the</span> <span data-start="279.86" data-end="281.84">canvas element throw it into a variable</span> <span data-start="281.84" data-end="283.85">set some other variables like width and</span> <span data-start="283.85" data-end="284.75">height so don't have to recalculate</span> <span data-start="284.75" data-end="286.669">those times that recalculate those every</span> <span data-start="286.669" data-end="289.61">time I need them and then there's this</span> <span data-start="289.61" data-end="292.43">thing called the context as I call I use</span> <span data-start="292.43" data-end="294.29">canvas like get context I tell it using</span> <span data-start="294.29" data-end="295.43">this string that I would like a 2d</span> <span data-start="295.43" data-end="298.4">context as opposed to a WebGL context</span> <span data-start="298.4" data-end="300.11">which we will get to and if you're</span> <span data-start="300.11" data-end="301.91">unfamiliar with canvas you can think of</span> <span data-start="301.91" data-end="304.22">a context kind of like a toolbox in a</span> <span data-start="304.22" data-end="306.02">sense much like a traditional artist</span> <span data-start="306.02" data-end="307.61">that's drawing on a canvas you will have</span> <span data-start="307.61" data-end="309.32">a toolbox that's filled with things like</span> <span data-start="309.32" data-end="312.38">paints and colors you know you know</span> <span data-start="312.38" data-end="314.18">brushes that can draw lines of various</span> <span data-start="314.18" data-end="316.28">widths and so I find that for people who</span> <span data-start="316.28" data-end="318.229">are beginners the best metaphor that</span> </p>
<p><span data-start="318.229" data-end="319.97">I've found and this is thanks to a</span> <span data-start="319.97" data-end="321.26">friend of mine is actually that you</span> <span data-start="321.26" data-end="322.82">should think of the context kind of like</span> <span data-start="322.82" data-end="326.69">a toolbox we're not just doing simple</span> <span data-start="326.69" data-end="327.919">drawing here right this is actually a</span> <span data-start="327.919" data-end="330.11">really fabulous animating Red Square</span> <span data-start="330.11" data-end="332.3">it's basically the best animating Red</span> </p>
<p><span data-start="332.3" data-end="333.86">Square and what we're doing here is</span> <span data-start="333.86" data-end="334.97">we've got this function called draw</span> <span data-start="334.97" data-end="337.4">where we call requestanimationframe and</span> <span data-start="337.4" data-end="338.6">then we call draw there and although</span> <span data-start="338.6" data-end="340.97">that does look like recursion what we're</span> <span data-start="340.97" data-end="342.979">doing the first time we call it is we're</span> <span data-start="342.979" data-end="344.03">actually basically saying in the browser</span> <span data-start="344.03" data-end="345.59">please the next time you have a frame</span> <span data-start="345.59" data-end="347.75">for animating give it to me and then do</span> <span data-start="347.75" data-end="349.82">all this stuff and then we're telling</span> <span data-start="349.82" data-end="350.87">our context that we're kind of like</span> <span data-start="350.87" data-end="353.06">dipping our brush in this bright blue</span> <span data-start="353.06" data-end="354.65">color and then drawing from the origin</span> <span data-start="354.65" data-end="356.45">of zero zero on the top left we did we</span> <span data-start="356.45" data-end="358.99">draw and paint the whole canvas blue and</span> <span data-start="358.99" data-end="361.43">then we hold on to that we save it and</span> <span data-start="361.43" data-end="363.889">then we actually translate our origin</span> <span data-start="363.889" data-end="365.66">points for where we're drawing from and</span> <span data-start="365.66" data-end="368.84">then we rotate and we do the same thing</span> <span data-start="368.84" data-end="370.669">again we dip our brush in this really</span> <span data-start="370.669" data-end="373.07">bright red color and we do a fill rect</span> <span data-start="373.07" data-end="375.05">which is painting a rectangle and then</span> <span data-start="375.05" data-end="376.46">we restore it and bam you've got this</span> <span data-start="376.46" data-end="378.68">animation so I mean we did that and you</span> <span data-start="378.68" data-end="379.82">know I mean there's a lot of comments in</span> <span data-start="379.82" data-end="381.32">here but less than less than 50 lines</span> <span data-start="381.32" data-end="384.59">with really verbose comments for for you</span> <span data-start="384.59" data-end="386.78">know beginners so that's you know kind</span> <span data-start="386.78" data-end="388.28">of okay oh wait that's a terminal you</span> <span data-start="388.28" data-end="391.43">don't want that where's my talk all</span> <span data-start="391.43" data-end="393.86">right so that's pretty simple the</span> <span data-start="393.86" data-end="395.15">interesting corollary here is that</span> <span data-start="395.15" data-end="397.19">there's a simple loop that's updating</span> <span data-start="397.19" data-end="398.51">the canvas and one of the things I've</span> <span data-start="398.51" data-end="400.789">noticed is that if people do not have a</span> <span data-start="400.789" data-end="402.59">computer science graphics background</span> <span data-start="402.59" data-end="403.97">or they've never messed around with</span> <span data-start="403.97" data-end="406.58">canvas and some of you some people just</span> <span data-start="406.58" data-end="407.81">actually never thought like well how</span> <span data-start="407.81" data-end="409.1">does the video game work and actually</span> <span data-start="409.1" data-end="410.96">video game works in the simplest sense</span> <span data-start="410.96" data-end="413.21">of by updating the screen in a loop and</span> <span data-start="413.21" data-end="414.919">then you add you know gameplay and game</span> <span data-start="414.919" data-end="416.51">state to that and that's how a game is</span> <span data-start="416.51" data-end="417.86">made so if you've ever wondered like how</span> <span data-start="417.86" data-end="419.45">are your video video games are made even</span> <span data-start="419.45" data-end="421.82">at you know the highest level of Triple</span> </p>
<p><span data-start="421.82" data-end="423.56">A games this is essentially a core part</span> <span data-start="423.56" data-end="426.29">of how games work so we did that with</span> <span data-start="426.29" data-end="429.05">canvas now let's take a look at this</span> <span data-start="429.05" data-end="431.96">thing called WebGL and let's try it</span> <span data-start="431.96" data-end="432.95">lecture what we're going to do is we're</span> <span data-start="432.95" data-end="434.15">going to take a look an example that</span> <span data-start="434.15" data-end="437.08">draws and animates the exact same square</span> <span data-start="437.08" data-end="439.639">okay so over on the nope that's not the</span> <span data-start="439.639" data-end="441.2">one okay over on the left hand side here</span> <span data-start="441.2" data-end="444.2">we have see we've got canvas okay but</span> <span data-start="444.2" data-end="445.22">there's some other stuff here we've got</span> <span data-start="445.22" data-end="447.71">this thing that's called in some script</span> <span data-start="447.71" data-end="451.1">tag here on its own a GL frag color and</span> <span data-start="451.1" data-end="452.389">that doesn't look like something I've</span> <span data-start="452.389" data-end="454.28">seen in JavaScript then we've got this</span> <span data-start="454.28" data-end="458.21">other thing GL position never seen that</span> <span data-start="458.21" data-end="460.49">before and over on the right hand side</span> <span data-start="460.49" data-end="467.279">here yeah we it's pretty short right oh</span> <span data-start="467.289" data-end="470.06">this is all the draw one animating</span> <span data-start="470.06" data-end="471.5">square oh no I'm not done yet look keeps</span> <span data-start="471.5" data-end="474.979">going whoo okay okay so there's this</span> </p>
<p><span data-start="474.979" data-end="477.08">WebGL thing it's considerably more of a</span> <span data-start="477.08" data-end="478.669">boasts in the canvas API that's an</span> <span data-start="478.669" data-end="481.13">observation we can make so far and WebGL</span> <span data-start="481.13" data-end="483.65">for the uninitiated I assume that most</span> <span data-start="483.65" data-end="485.21">people probably heard about WebGL and</span> <span data-start="485.21" data-end="488.12">passing at least it's using basically</span> <span data-start="488.12" data-end="490.07">the OpenGL language on the web's like</span> <span data-start="490.07" data-end="492.32">almost like a port of that to basically</span> <span data-start="492.32" data-end="494.57">get closer to the metal push off a bunch</span> <span data-start="494.57" data-end="496.01">of calculations and graphics work onto</span> <span data-start="496.01" data-end="497.78">the GPU and so it has significant</span> <span data-start="497.78" data-end="500.93">advantages over just the 2d canvas API</span> <span data-start="500.93" data-end="502.16">which I introduced we're going to talk a</span> <span data-start="502.16" data-end="505.82">little bit more about that so yeah that</span> <span data-start="505.82" data-end="508.37">was a simple animation with WebGL and</span> <span data-start="508.37" data-end="511.1">honestly that thing was so long that I</span> <span data-start="511.1" data-end="512.57">mean I we just can't even really go</span> <span data-start="512.57" data-end="514.7">through all of it that didn't scale well</span> <span data-start="514.7" data-end="516.409">but you get the point I love this guy</span> <span data-start="516.409" data-end="520.13">looks so much alright so if you're not</span> <span data-start="520.13" data-end="521.959">coming from an OpenGL background like</span> <span data-start="521.959" data-end="523.279">and you want to use WebGL you basically</span> <span data-start="523.279" data-end="526.4">got to learn a new language and you've</span> <span data-start="526.4" data-end="527.66">got to be introduced these things called</span> <span data-start="527.66" data-end="530.029">shaders which are kind of an important</span> <span data-start="530.029" data-end="531.44">concept you can't really get around that</span> <span data-start="531.44" data-end="534.44">either so shaders simplified almost too</span> <span data-start="534.44" data-end="536.03">much and anybody who's a pro and hearing</span> <span data-start="536.03" data-end="536.45">me say the</span> <span data-start="536.45" data-end="538.19">stuff is gonna be like but but not but</span> <span data-start="538.19" data-end="541.22">not actually but not all shaders and oh</span> <span data-start="541.22" data-end="543.11">no this didn't scale well I wonder if I</span> <span data-start="543.11" data-end="547.18">can refresh this give me a sec here</span> <span data-start="547.18" data-end="550.61">let's see yeah there we go</span> <span data-start="550.61" data-end="552.95">so shaders simplified almost too much</span> <span data-start="552.95" data-end="554.93">are basically individual programs that</span> <span data-start="554.93" data-end="557">run on the GPU and give your 3d drawings</span> <span data-start="557" data-end="559.04">life and what I mean by that very simply</span> <span data-start="559.04" data-end="561.65">we've got two kinds vertex rate vertex</span> <span data-start="561.65" data-end="563.84">shaders they transform position they run</span> <span data-start="563.84" data-end="565.85">once per vertex in a mesh before these</span> <span data-start="565.85" data-end="567.62">other things called fragment shaders and</span> <span data-start="567.62" data-end="570.2">a mesh you can think of as a bunch of</span> <span data-start="570.2" data-end="574.04">connected vertices fragment shaders run</span> <span data-start="574.04" data-end="576.44">once per pixel between vertices to</span> <span data-start="576.44" data-end="579.23">essentially paint your 3d objects you</span> <span data-start="579.23" data-end="581.21">can't make 3d stuff with WebGL with</span> <span data-start="581.21" data-end="585.11">without using shaders so I'm just</span> <span data-start="585.11" data-end="586.52">sitting here talking about canvas and</span> </p>
<p><span data-start="586.52" data-end="587.87">WebGL and then I mentioned this thing</span> <span data-start="587.87" data-end="590.06">called SVG scalable vector graphics and</span> <span data-start="590.06" data-end="591.11">you're probably wondering like how do I</span> <span data-start="591.11" data-end="593">know when to use which of those so let's</span> <span data-start="593" data-end="595.58">go through like some of the reasons you</span> <span data-start="595.58" data-end="597.68">might want to use one or the other so</span> <span data-start="597.68" data-end="599.3">scalable vector graphics are pretty</span> <span data-start="599.3" data-end="600.77">interesting so you want to use scalable</span> <span data-start="600.77" data-end="602.99">vector graphics when you want something</span> <span data-start="602.99" data-end="606.44">with a Dom like internal hierarchy SVG</span> <span data-start="606.44" data-end="608.12">has the ability to have these nodes that</span> <span data-start="608.12" data-end="609.47">behave very Dom like and they'll fire</span> <span data-start="609.47" data-end="611.12">events for you so if you're looking for</span> <span data-start="611.12" data-end="612.38">something with simple interactions a</span> </p>
<p><span data-start="612.38" data-end="615.41">Plus SVG is pretty cool you want to be</span> <span data-start="615.41" data-end="616.88">able to easily draw non square shapes</span> <span data-start="616.88" data-end="618.08">because that's vector based it does a</span> <span data-start="618.08" data-end="619.85">really really nice smooth curve so</span> <span data-start="619.85" data-end="621.01">that's pretty awesome</span> <span data-start="621.01" data-end="623.54">if you're scaling dimensions is</span> <span data-start="623.54" data-end="625.88">important then this is actually pretty</span> <span data-start="625.88" data-end="628.13">fantastic again being vector based we'll</span> <span data-start="628.13" data-end="630.74">talk about what to do to properly scale</span> <span data-start="630.74" data-end="632.18">a canvas if you need to and still keep</span> <span data-start="632.18" data-end="634.34">things performant but if possible just</span> <span data-start="634.34" data-end="637.09">don't resize your canvas depending on</span> <span data-start="637.09" data-end="638.78">implementation and stuff the</span> <span data-start="638.78" data-end="640.1">interpolation can make it look really</span> <span data-start="640.1" data-end="645.17">goofy if you don't need if you don't</span> <span data-start="645.17" data-end="648.2">need a billion nodes because depending</span> <span data-start="648.2" data-end="650.72">again on SVG implementation having lots</span> <span data-start="650.72" data-end="652.79">and lots of nodes in SVG can degrade</span> <span data-start="652.79" data-end="655.7">performance I did talk to some people</span> <span data-start="655.7" data-end="658.22">and someone on platform mentioned that</span> <span data-start="658.22" data-end="660.2">it really does vary by implementation in</span> <span data-start="660.2" data-end="661.91">fact there's some stuff that seems to be</span> <span data-start="661.91" data-end="663.8">for some SVG implementations that could</span> <span data-start="663.8" data-end="665.81">be pushed onto the GPU but isn't it's on</span> <span data-start="665.81" data-end="668.33">the CPU and rendering like lots of</span> <span data-start="668.33" data-end="671.18">curves and gets to be a pain so</span> <span data-start="671.18" data-end="675.589">no to you speedy judicious if you want</span> <span data-start="675.589" data-end="677.48">to display a mostly static chart or</span> <span data-start="677.48" data-end="679.31">create a simple point-and-click game</span> <span data-start="679.31" data-end="681.41">simple user interactions with really</span> <span data-start="681.41" data-end="682.94">smooth nice graphics that you want to</span> <span data-start="682.94" data-end="684.32">scale well that's when you want to use</span> </p>
<p><span data-start="684.32" data-end="687.74">SVG so a cool idea is rather using SVG</span> <span data-start="687.74" data-end="689.42">for game you could build like a games</span> <span data-start="689.42" data-end="691.58">level editor using SVG and that's</span> <span data-start="691.58" data-end="694.52">probably a pretty good use so when do</span> <span data-start="694.52" data-end="695.87">you want to use canvas and we mean the</span> <span data-start="695.87" data-end="698.48">2d canvas API the very first example</span> <span data-start="698.48" data-end="701.27">that we use so maybe you don't want an</span> <span data-start="701.27" data-end="703.22">internal structure a Dom like structure</span> <span data-start="703.22" data-end="704.69">handling events for you you want control</span> <span data-start="704.69" data-end="707.87">over which pixels exactly fire events so</span> <span data-start="707.87" data-end="709.399">you can have ultimate precision by</span> <span data-start="709.399" data-end="711.19">controlling each individual pixel</span> <span data-start="711.19" data-end="713.39">probably you want something maybe retro</span> <span data-start="713.39" data-end="715.37">fabulous because 8-bit style art it</span> <span data-start="715.37" data-end="717.2">turns out kind of hard to do with canvas</span> <span data-start="717.2" data-end="719.18">but doing or probably kind of hard to do</span> <span data-start="719.18" data-end="721.52">with SVG but much easier to do with</span> <span data-start="721.52" data-end="723.32">canvas so recommend if you that's the</span> <span data-start="723.32" data-end="724.459">style you're going forward that you're</span> <span data-start="724.459" data-end="726.38">going to want to use canvas and if you</span> <span data-start="726.38" data-end="727.85">want to make a fast paced game not just</span> <span data-start="727.85" data-end="729.77">a point-and-click something that's a</span> <span data-start="729.77" data-end="731.6">shoot-'em-up FPS or if you want to</span> <span data-start="731.6" data-end="733.16">display real time visualizations and</span> <span data-start="733.16" data-end="735.43">charts canvas is going to be your friend</span> <span data-start="735.43" data-end="738.74">now WebGL this magic thing I was telling</span> <span data-start="738.74" data-end="740.48">you about they can offload stuff onto</span> <span data-start="740.48" data-end="743.36">the GPU gets you better performance when</span> <span data-start="743.36" data-end="745.25">performance is the most important thing</span> <span data-start="745.25" data-end="747.86">you want to you want to use WebGL and in</span> <span data-start="747.86" data-end="751.399">fact you can still draw with you know</span> </p>
<p><span data-start="751.399" data-end="753.23">WebGL in 2d which was the example I</span> <span data-start="753.23" data-end="754.94">showed you obviously the most popular</span> <span data-start="754.94" data-end="757.16">thing to do is draw on 3d with it but if</span> <span data-start="757.16" data-end="758.99">you drew on 2d with WebGL and you deal</span> <span data-start="758.99" data-end="760.76">with all that for both Ness you can</span> <span data-start="760.76" data-end="763.1">actually get much more performant 2d</span> <span data-start="763.1" data-end="764.959">animations 2d games than just drawing</span> <span data-start="764.959" data-end="766.76">with the canvas API so that's something</span> <span data-start="766.76" data-end="768.41">to consider if you know performance is</span> <span data-start="768.41" data-end="771.589">an issue and if you want to draw loss of</span> <span data-start="771.589" data-end="773.51">3d shapes I'm comparing this here</span> <span data-start="773.51" data-end="775.64">actually as well to a lot of three 3d</span> </p>
<p><span data-start="775.64" data-end="778.19">CSS transforms animations not because</span> <span data-start="778.19" data-end="780.14">like one or two of those aren't terribly</span> <span data-start="780.14" data-end="781.91">performant in fact our browsers are</span> <span data-start="781.91" data-end="783.77">pretty fast these days right but if you</span> <span data-start="783.77" data-end="785.69">have lots and lots and lots of 3d shapes</span> <span data-start="785.69" data-end="787.25">and lots and lots and lots of layers and</span> <span data-start="787.25" data-end="788.99">transparency and effects and you've got</span> <span data-start="788.99" data-end="791.51">tons of dom nodes well things are going</span> <span data-start="791.51" data-end="792.95">to actually slow down quite a bit so I</span> <span data-start="792.95" data-end="795.26">would recommend using WebGL instead of</span> <span data-start="795.26" data-end="797.81">doing that although I think the 3d CSS</span> <span data-start="797.81" data-end="800.66">stuff we can do now is pretty wicked so</span> <span data-start="800.66" data-end="802.49">often you know you think like you saw</span> <span data-start="802.49" data-end="804.2">that you saw this like in Angelina</span> <span data-start="804.2" data-end="807.89">like an example of WebGL and I showed</span> <span data-start="807.89" data-end="809.48">you how to simply draw so it's basically</span> <span data-start="809.48" data-end="810.68">simple now that you know one or two</span> <span data-start="810.68" data-end="813.38">things about WebGL you can basically</span> <span data-start="813.38" data-end="814.76">that's it you know just there you go</span> <span data-start="814.76" data-end="816.26">that was how to draw square now go make</span> <span data-start="816.26" data-end="818.72">a game right so it's not that simple but</span> <span data-start="818.72" data-end="819.86">there are lots of really excellent</span> <span data-start="819.86" data-end="822.26">tutorials on the internet that will that</span> <span data-start="822.26" data-end="825.47">will help you out with that so I just</span> <span data-start="825.47" data-end="827.6">wanted to make sure people sort of knew</span> <span data-start="827.6" data-end="830.93">the appropriate uses of canvas SVG WebGL</span> <span data-start="830.93" data-end="832.1">before we actually get onto the meat of</span> <span data-start="832.1" data-end="834.11">everything which is of course talking</span> <span data-start="834.11" data-end="835.85">about canvas performance and WebGL</span> <span data-start="835.85" data-end="838.34">performance so you might say to yourself</span> <span data-start="838.34" data-end="840.56">but I want to write JavaScript I don't</span> <span data-start="840.56" data-end="842.03">want to learn a new language I mean</span> <span data-start="842.03" data-end="843.11">those shades were cool but I don't</span> <span data-start="843.11" data-end="844.52">really want to be writing shaders</span> <span data-start="844.52" data-end="846.05">explicitly that was just like a lot of</span> <span data-start="846.05" data-end="848.45">code just to make us square I mean oh my</span> <span data-start="848.45" data-end="849.65">gosh</span> <span data-start="849.65" data-end="850.7">but there are some libraries that will</span> <span data-start="850.7" data-end="852.14">help you the most popular one and of</span> <span data-start="852.14" data-end="853.25">course that a lot of you might be</span> <span data-start="853.25" data-end="855.2">familiar with is three J's which</span> <span data-start="855.2" data-end="857.24">abstract way working with 3d and web</span> <span data-start="857.24" data-end="859.73">with WebGL tween jeaious is an excellent</span> <span data-start="859.73" data-end="861.53">library for basically animating between</span> <span data-start="861.53" data-end="863.84">smoothly and then I found this other one</span> <span data-start="863.84" data-end="865.04">that I think is really really excellent</span> <span data-start="865.04" data-end="867.11">for if you're doing 2d rendering it's</span> <span data-start="867.11" data-end="869.63">called pix ejs and it's a it's like I</span> <span data-start="869.63" data-end="871.61">said a 2d WebGL render but they're all</span> <span data-start="871.61" data-end="873.17">some thing is it has a canvas fallback</span> <span data-start="873.17" data-end="875.54">if you can't shove stuff onto the GPU so</span> <span data-start="875.54" data-end="876.92">that's really nice if you're doing 2d</span> <span data-start="876.92" data-end="879.55">games and you're going cross-platform</span> <span data-start="879.55" data-end="883.1">right so when you're using a library if</span> <span data-start="883.1" data-end="884.42">it's written by somebody else and it's</span> <span data-start="884.42" data-end="886.52">not something that has you know a lot of</span> <span data-start="886.52" data-end="888.08">community support you know maybe it's</span> <span data-start="888.08" data-end="889.52">like a new game framework or something</span> <span data-start="889.52" data-end="891.11">that you found you're kind of like well</span> <span data-start="891.11" data-end="892.85">the screenshots look really cool and the</span> <span data-start="892.85" data-end="894.26">demos are really cool maybe I'll use</span> <span data-start="894.26" data-end="897.05">this you know something like 3GS is I</span> <span data-start="897.05" data-end="898.31">guess a little bit battle-hardened</span> <span data-start="898.31" data-end="899.48">because there are a lot of people that</span> <span data-start="899.48" data-end="902.72">work on it my friend Sola is here she's</span> <span data-start="902.72" data-end="904.43">actually the author of tween J's we were</span> <span data-start="904.43" data-end="906.05">talking about three J's last night</span> <span data-start="906.05" data-end="907.76">really yeah there's this guy in Slovenia</span> <span data-start="907.76" data-end="909.59">who's amazing he spends like hours</span> <span data-start="909.59" data-end="911.81">optimizing all the shaders and in every</span> <span data-start="911.81" data-end="914.14">browser so to that guy hats off to you</span> <span data-start="914.14" data-end="916.13">so he's done a lot of the hard work for</span> <span data-start="916.13" data-end="918.53">you making sure that the you know your</span> </p>
<p><span data-start="918.53" data-end="920.93">CPU and GPU are not doing extra work</span> <span data-start="920.93" data-end="923.93">however imagine a situation where you</span> <span data-start="923.93" data-end="926.03">have you know a set of functions</span> <span data-start="926.03" data-end="927.32">someone's created like a nice API to</span> <span data-start="927.32" data-end="929.06">abstract away some of this work for you</span> <span data-start="929.06" data-end="931.34">and you have a phone you call a canvas</span> <span data-start="931.34" data-end="933.62">like clear the canvas yourself and then</span> <span data-start="933.62" data-end="935.48">maybe you call a function that you know</span> <span data-start="935.48" data-end="936.92">is opaque to you because you haven't</span> <span data-start="936.92" data-end="937.97">looked at the source code and</span> <span data-start="937.97" data-end="940.25">called prepare canvas so intuitive you</span> <span data-start="940.25" data-end="941.629">might be like okay first I'm gonna clear</span> <span data-start="941.629" data-end="943.579">the canvas and then I'm gonna prepare it</span> <span data-start="943.579" data-end="945.439">and then I do some work sure that sounds</span> <span data-start="945.439" data-end="947.029">intuitive to me but what happens you</span> <span data-start="947.029" data-end="949.579">know if prepare canvas also calls a</span> <span data-start="949.579" data-end="951.5">clear canvas then you're doing what's</span> <span data-start="951.5" data-end="953.899">called redundant draw calls so and</span> <span data-start="953.899" data-end="955.699">that's just doing work twice like come</span> <span data-start="955.699" data-end="957.079">on we don't want to do that so let's</span> <span data-start="957.079" data-end="960.29">actually take a look at that one good</span> <span data-start="960.29" data-end="961.819">way to inspect this is using the canvas</span> <span data-start="961.819" data-end="963.92">inspector in Firefox which we landed I</span> <span data-start="963.92" data-end="965.629">think just a couple months ago we</span> <span data-start="965.629" data-end="967.009">actually announced it at GDC and</span> <span data-start="967.009" data-end="969.56">actually um use the shader editor to</span> <span data-start="969.56" data-end="971.36">which will actually pull up WebGL</span> <span data-start="971.36" data-end="972.68">shaders I'll show you in a moment</span> <span data-start="972.68" data-end="974.3">because if you are somebody who is a</span> <span data-start="974.3" data-end="975.769">little bit curious abut under the hood</span> <span data-start="975.769" data-end="977.81">you can actually live edit those shaders</span> <span data-start="977.81" data-end="979.91">in the browser and see them update in</span> <span data-start="979.91" data-end="981.439">real time it's an excellent learning to</span> <span data-start="981.439" data-end="982.939">like when I was diving into this stuff I</span> <span data-start="982.939" data-end="984.769">was like oh okay this isn't so bad</span> <span data-start="984.769" data-end="986.509">having that immediate feedback is really</span> <span data-start="986.509" data-end="988.42">great kind of like using a ripple</span> <span data-start="988.42" data-end="991.31">alright so let's go through this step by</span> <span data-start="991.31" data-end="995.329">step frame by frame so this is an</span> <span data-start="995.329" data-end="997.939">example here of inefficient canvas usage</span> <span data-start="997.939" data-end="1000.129">actually and it's a very simple example</span> <span data-start="1000.129" data-end="1003.22">so it's deceptive but will actually take</span> <span data-start="1003.22" data-end="1004.87">a look here with the canvas inspector</span> <span data-start="1004.87" data-end="1007.35">let me see if I can make this bigger so</span> <span data-start="1007.35" data-end="1009.43">that's kind of getting bigger maybe a</span> <span data-start="1009.43" data-end="1011.139">bit bigger okay we'll see how it will</span> <span data-start="1011.139" data-end="1012.309">see how the inspector responds to that</span> <span data-start="1012.309" data-end="1015.009">let's scroll up here a bit and I got to</span> <span data-start="1015.009" data-end="1017.889">reload the page click on this to record</span> <span data-start="1017.889" data-end="1020.199">animation frames call stack okay so what</span> <span data-start="1020.199" data-end="1023.41">we have here is basically the canvas</span> <span data-start="1023.41" data-end="1025.51">inspector when you grab a snapshot of it</span> <span data-start="1025.51" data-end="1027.37">will show you basically all the draw</span> <span data-start="1027.37" data-end="1030.039">calls that are going to be executed in</span> <span data-start="1030.039" data-end="1032.14">order to implement like the next step of</span> <span data-start="1032.14" data-end="1034.059">animation so I mean this is a really</span> <span data-start="1034.059" data-end="1035.049">simple one so at the bottom we've</span> <span data-start="1035.049" data-end="1036.37">rolling about these like three frames</span> <span data-start="1036.37" data-end="1038.53">right here for more sophisticated stuff</span> <span data-start="1038.53" data-end="1040.48">like if you go to the WebGL playground</span> <span data-start="1040.48" data-end="1043.03">and take a look at some of the examples</span> <span data-start="1043.03" data-end="1044.589">there and that's like on Heroku I</span> <span data-start="1044.589" data-end="1047.35">believe then you can actually you know</span> <span data-start="1047.35" data-end="1048.789">run some of these in the canvas</span> <span data-start="1048.789" data-end="1050.409">inspector you can go into the shade or</span> <span data-start="1050.409" data-end="1051.669">editor and play with them and then</span> <span data-start="1051.669" data-end="1053.049">really see what's going on under the</span> <span data-start="1053.049" data-end="1054.46">hood and the canvas are supporting the</span> </p>
<p><span data-start="1054.46" data-end="1055.78">WebGL playground on heroic is actually</span> <span data-start="1055.78" data-end="1056.74">pretty good because it's got like the</span> <span data-start="1056.74" data-end="1058.059">live code that you can edit in the page</span> <span data-start="1058.059" data-end="1059.95">anyway but this is really good for</span> <span data-start="1059.95" data-end="1061.63">seeing performance so if we look</span> <span data-start="1061.63" data-end="1064.69">actually at the code here is my bad cams</span> <span data-start="1064.69" data-end="1066.159">example I've got this all stuffed in the</span> <span data-start="1066.159" data-end="1068.47">head don't actually do this we've got</span> <span data-start="1068.47" data-end="1071.049">here C requestanimationframe looks kind</span> <span data-start="1071.049" data-end="1071.559">of similar</span> <span data-start="1071.559" data-end="1072.94">to our example when we're animating</span> <span data-start="1072.94" data-end="1074.559">there you can see that we're doing a</span> <span data-start="1074.559" data-end="1077.47">fill style right here and a fill rekts</span> <span data-start="1077.47" data-end="1079.09">and then we're calling this function I</span> <span data-start="1079.09" data-end="1080.08">was kind of using this example of</span> <span data-start="1080.08" data-end="1082.299">prepare frame if we go over into the</span> <span data-start="1082.299" data-end="1083.679">canvas inspector you'll see that we've</span> <span data-start="1083.679" data-end="1085.509">got some duplicated calls your fill rect</span> <span data-start="1085.509" data-end="1088.269">is being called twice and stroke style</span> <span data-start="1088.269" data-end="1089.83">is being called twice there's no reason</span> <span data-start="1089.83" data-end="1091.749">to duplicate effort if we go back into</span> <span data-start="1091.749" data-end="1093.34">our code and we take a look and we'll</span> <span data-start="1093.34" data-end="1095.919">see that when we're calling prepare</span> <span data-start="1095.919" data-end="1098.019">frame there we go that fill rect is</span> <span data-start="1098.019" data-end="1100.029">called and drawcircle also sets a stroke</span> <span data-start="1100.029" data-end="1101.74">style as well so this is a really</span> <span data-start="1101.74" data-end="1104.769">obvious example of duplicated draw calls</span> <span data-start="1104.769" data-end="1107.619">and from inspecting a couple games over</span> <span data-start="1107.619" data-end="1109.21">the last while I recognized that there</span> <span data-start="1109.21" data-end="1110.679">are often cases where things look like</span> <span data-start="1110.679" data-end="1114.129">repeat draw calls but sometimes there is</span> <span data-start="1114.129" data-end="1116.2">like some meaning towards you know</span> <span data-start="1116.2" data-end="1118.059">behind the scenes that's not obvious to</span> <span data-start="1118.059" data-end="1119.889">why that might be there but when you do</span> <span data-start="1119.889" data-end="1121.6">see those in you know the canvas</span> <span data-start="1121.6" data-end="1123.19">inspector it's a pretty good indication</span> <span data-start="1123.19" data-end="1125.529">that you might want to take a look at</span> <span data-start="1125.529" data-end="1127.749">that in your code or look at the library</span> <span data-start="1127.749" data-end="1129.46">that's you picked up and didn't really</span> <span data-start="1129.46" data-end="1130.899">vet very hard on the internet and</span> <span data-start="1130.899" data-end="1132.999">because reducing the number of these</span> <span data-start="1132.999" data-end="1134.649">redundant draw calls can actually make a</span> <span data-start="1134.649" data-end="1135.279">difference</span> <span data-start="1135.279" data-end="1138.249">now this example isn't using shaders I</span> <span data-start="1138.249" data-end="1140.86">do have that WebGL example again the one</span> <span data-start="1140.86" data-end="1142.33">that we were using the code pens if we</span> <span data-start="1142.33" data-end="1144.46">inspect that and we pop over to oh I</span> <span data-start="1144.46" data-end="1147.429">don't have the shader editor so let's</span> <span data-start="1147.429" data-end="1148.929">turn that on if you're all looking for</span> <span data-start="1148.929" data-end="1150.369">the canvas in spectrum the shader editor</span> <span data-start="1150.369" data-end="1151.6">just got to click on like the sprocket</span> </p>
<p><span data-start="1151.6" data-end="1153.159">II thing the Firefox dev tools and</span> <span data-start="1153.159" data-end="1155.74">enable the shader editor there we go</span> <span data-start="1155.74" data-end="1159.85">awesome reload the page and so what's</span> <span data-start="1159.85" data-end="1161.559">going on here is when we were taking a</span> <span data-start="1161.559" data-end="1162.879">look in that code pen earlier we had</span> <span data-start="1162.879" data-end="1163.99">some script tags at how these things</span> <span data-start="1163.99" data-end="1167.039">called you know GL position and GL frag</span> <span data-start="1167.039" data-end="1169.6">and these things of course are our</span> <span data-start="1169.6" data-end="1171.73">vertex shaders and our fragment shaders</span> <span data-start="1171.73" data-end="1173.769">so actually what we can do is we can</span> <span data-start="1173.769" data-end="1175.57">actually go in here and we can modify</span> <span data-start="1175.57" data-end="1177.369">some of the stuff and what happens if I</span> <span data-start="1177.369" data-end="1179.74">show you just do it — that's not gonna</span> <span data-start="1179.74" data-end="1184.84">do anything there we go yeah pink square</span> <span data-start="1184.84" data-end="1186.279">so you can see that that updates in real</span> <span data-start="1186.279" data-end="1187.899">time for you which makes debugging and</span> <span data-start="1187.899" data-end="1189.429">learning I think this stuff a whole lot</span> <span data-start="1189.429" data-end="1191.44">better let's get those out of the way</span> <span data-start="1191.44" data-end="1194.379">keep on going step by step frame by</span> <span data-start="1194.379" data-end="1196.419">frame everybody so now let's dive right</span> <span data-start="1196.419" data-end="1197.95">into those performance best practices</span> <span data-start="1197.95" data-end="1200.619">that people are you know here for the</span> <span data-start="1200.619" data-end="1201.85">first thing is you want to make sure use</span> <span data-start="1201.85" data-end="1203.679">whole pixel rendering and what that</span> <span data-start="1203.679" data-end="1205.36">means is when you're specifying</span> <span data-start="1205.36" data-end="1207.34">you know like a draw operation don't use</span> <span data-start="1207.34" data-end="1208.87">floats if you don't have to if for some</span> <span data-start="1208.87" data-end="1209.95">reason your calculating something</span> <span data-start="1209.95" data-end="1211.96">dynamically and you get a float call</span> <span data-start="1211.96" data-end="1213.94">math dot floor or use bitwise operations</span> <span data-start="1213.94" data-end="1215.62">on it in order to make nice round</span> <span data-start="1215.62" data-end="1218.559">numbers because the cpu ends up having</span> <span data-start="1218.559" data-end="1220">to do a whole bunch of extra calculators</span> <span data-start="1220" data-end="1221.5">to ramp calculations to round them</span> <span data-start="1221.5" data-end="1223.27">anyway to give you a nice anti-aliasing</span> <span data-start="1223.27" data-end="1225.22">effect so just try and stay away from</span> <span data-start="1225.22" data-end="1227.95">that where possible cache your drawing</span> <span data-start="1227.95" data-end="1230.53">in an off-screen canvas image copying is</span> <span data-start="1230.53" data-end="1232.12">actually cheaper than redrawing pixels</span> <span data-start="1232.12" data-end="1234.549">so what you can do is something kind of</span> <span data-start="1234.549" data-end="1237.4">like this just create a canvas don't add</span> <span data-start="1237.4" data-end="1240.1">it to the DOM and then render some stuff</span> <span data-start="1240.1" data-end="1241.75">there and then render it onto the canvas</span> <span data-start="1241.75" data-end="1243.16">and that actually is a really great way</span> <span data-start="1243.16" data-end="1248.11">to to deal with deals performance so if</span> <span data-start="1248.11" data-end="1249.46">you're doing something has multiple</span> <span data-start="1249.46" data-end="1250.45">layers maybe you're doing kind of like a</span> <span data-start="1250.45" data-end="1252.52">parallax background if you've ever seen</span> <span data-start="1252.52" data-end="1254.14">like if you ever pulled apart old like</span> </p>
<p><span data-start="1254.14" data-end="1255.669">Super Nintendo games and stuff and seen</span> <span data-start="1255.669" data-end="1257.89">all the layers that go into the and into</span> <span data-start="1257.89" data-end="1259.75">that use kind of the same principle use</span> <span data-start="1259.75" data-end="1261.76">like sort of transparency and move the</span> <span data-start="1261.76" data-end="1263.44">layers a little bit and you can you can</span> <span data-start="1263.44" data-end="1265.9">that's actually a lot better than using</span> <span data-start="1265.9" data-end="1267.549">just one canvas because often you know</span> <span data-start="1267.549" data-end="1269.71">you're just using part of each canvas to</span> <span data-start="1269.71" data-end="1271.24">create a whole scene and you're drawing</span> <span data-start="1271.24" data-end="1272.59">just little portions of the candidates</span> <span data-start="1272.59" data-end="1274.39">rather than one big thing all over and</span> <span data-start="1274.39" data-end="1276.7">over again that being said only draw</span> <span data-start="1276.7" data-end="1278.2">what you have to there there's some</span> <span data-start="1278.2" data-end="1279.7">tutorials out there that I recommend you</span> <span data-start="1279.7" data-end="1282.549">poke around and find that will show you</span> <span data-start="1282.549" data-end="1284.35">how to only draw what you have to that</span> <span data-start="1284.35" data-end="1286.21">is to say don't redraw the entire canvas</span> <span data-start="1286.21" data-end="1288.25">only draw pixels that have changed like</span> <span data-start="1288.25" data-end="1289.33">basically though you can see the</span> <span data-start="1289.33" data-end="1290.89">recurring theme here's don't do any more</span> <span data-start="1290.89" data-end="1293.679">work than you absolutely have to if you</span> <span data-start="1293.679" data-end="1295.36">have a large unchanging background</span> <span data-start="1295.36" data-end="1296.95">behind your game like it literally is a</span> <span data-start="1296.95" data-end="1299.08">static thing then just apply it using</span> </p>
<p><span data-start="1299.08" data-end="1301.33">CSS don't draw it in canvas there's just</span> <span data-start="1301.33" data-end="1303.25">no reason to do that so that's a pretty</span> <span data-start="1303.25" data-end="1305.08">simple one I'm confident that most of</span> <span data-start="1305.08" data-end="1307.03">you I hope know how to use CSS you guys</span> <span data-start="1307.03" data-end="1309.419">are JavaScript developers so yeah but</span> <span data-start="1309.419" data-end="1315.429">and yeah large unchanging background</span> <span data-start="1315.429" data-end="1317.08">apply with CSS and here's just an</span> <span data-start="1317.08" data-end="1318.82">example of using multiple layers</span> <span data-start="1318.82" data-end="1320.26">actually with multiple canvases which</span> <span data-start="1320.26" data-end="1321.46">totally should have been with the</span> <span data-start="1321.46" data-end="1324.97">previous example but haha and then so</span> <span data-start="1324.97" data-end="1326.26">this is actually mostly applicable to</span> <span data-start="1326.26" data-end="1327.91">charts or maybe a game where you're</span> <span data-start="1327.91" data-end="1330.79">dealing with real time data so latency</span> <span data-start="1330.79" data-end="1332.2">is a thing right that's kind of a</span> <span data-start="1332.2" data-end="1333.85">problem I've seen people do real-time</span> <span data-start="1333.85" data-end="1335.38">charts and like the data will kind of</span> <span data-start="1335.38" data-end="1337.09">come in and it stutters and I know</span> <span data-start="1337.09" data-end="1338.47">immediately that they're not using a</span> <span data-start="1338.47" data-end="1339.01">queue</span> <span data-start="1339.01" data-end="1340.9">to deal with that so what you want to do</span> <span data-start="1340.9" data-end="1343.39">- you know animate smoothly and you know</span> <span data-start="1343.39" data-end="1345.46">avoid these latency issues as don't just</span> <span data-start="1345.46" data-end="1347.5">animate stuff when it comes in when you</span> <span data-start="1347.5" data-end="1349.45">get your data put it in a queue and then</span> <span data-start="1349.45" data-end="1351.22">it's some regular interval that you've</span> <span data-start="1351.22" data-end="1353.59">determined you know mitigate some of</span> <span data-start="1353.59" data-end="1356.29">your latency effects then then pull that</span> <span data-start="1356.29" data-end="1358.09">and pull off the next bit of data</span> <span data-start="1358.09" data-end="1359.89">animate that onto your off-screen canvas</span> <span data-start="1359.89" data-end="1361.9">and then when ready animate that onto</span> <span data-start="1361.9" data-end="1364.54">your your your canvas that your user can</span> <span data-start="1364.54" data-end="1368.05">see if you scale the canvas that all use</span> <span data-start="1368.05" data-end="1370.78">a css3 transform because those are GPU</span> <span data-start="1370.78" data-end="1372.25">accelerated when done right and that's</span> <span data-start="1372.25" data-end="1373.45">what we're looking for here so that's</span> <span data-start="1373.45" data-end="1374.94">pretty fantastic</span> <span data-start="1374.94" data-end="1377.38">and here's just an example right here of</span> <span data-start="1377.38" data-end="1379.12">doing that so you can actually do that</span> <span data-start="1379.12" data-end="1381.7">in JavaScript or you can apply it using</span> </p>
<p><span data-start="1381.7" data-end="1383.74">CSS and maybe it'll just scale Boop to</span> <span data-start="1383.74" data-end="1385.27">the viewport that you're looking for I</span> <span data-start="1385.27" data-end="1386.89">figure this stuff is actually pretty</span> <span data-start="1386.89" data-end="1390.16">simple for you so don't write your own</span> <span data-start="1390.16" data-end="1392.08">matrix operations library there's a</span> <span data-start="1392.08" data-end="1393.37">bunch of libraries out there that have</span> <span data-start="1393.37" data-end="1394.69">been already written and already</span> <span data-start="1394.69" data-end="1396.25">obsessed over for those optimizations</span> <span data-start="1396.25" data-end="1398.41">and at some point you might be like well</span> <span data-start="1398.41" data-end="1400.15">I don't know I don't like the API</span> <span data-start="1400.15" data-end="1401.95">surface of this library so I'm just</span> <span data-start="1401.95" data-end="1405.31">gonna write my own just don't like just</span> <span data-start="1405.31" data-end="1407.74">just don't because honestly it takes a</span> <span data-start="1407.74" data-end="1409.15">lot of time and debugging to get right</span> <span data-start="1409.15" data-end="1410.71">and unless you're somebody with the with</span> <span data-start="1410.71" data-end="1412.3">extensive background you're probably</span> <span data-start="1412.3" data-end="1413.41">going to mess it up get some of the</span> <span data-start="1413.41" data-end="1414.28">calculations</span> <span data-start="1414.28" data-end="1416.08">you know use an algorithm that's not</span> <span data-start="1416.08" data-end="1418.12">super optimized and impact your own</span> <span data-start="1418.12" data-end="1419.92">performance because you were you know</span> <span data-start="1419.92" data-end="1421.69">ambitious I mean that being said maybe</span> <span data-start="1421.69" data-end="1423.07">don't ship it in production for like</span> <span data-start="1423.07" data-end="1424.63">something you want and users to use and</span> <span data-start="1424.63" data-end="1426.28">make it a side project you can be</span> <span data-start="1426.28" data-end="1427.27">ambitious and write your own matrix</span> <span data-start="1427.27" data-end="1429.79">operation library but okay lots of peer</span> <span data-start="1429.79" data-end="1431.41">feedback on that sort of stuff and just</span> <span data-start="1431.41" data-end="1434.68">mostly don't do it so here's some other</span> <span data-start="1434.68" data-end="1436.18">stuff that affects performance that</span> <span data-start="1436.18" data-end="1438.37">might that's not necessarily directly a</span> <span data-start="1438.37" data-end="1440.8">canvas thing but definitely causes</span> <span data-start="1440.8" data-end="1443.74">problems avoid frequent calls to local</span> <span data-start="1443.74" data-end="1445.57">storage every time you do that it can</span> <span data-start="1445.57" data-end="1448.24">actually be a performance hit so do</span> <span data-start="1448.24" data-end="1449.59">those at particular intervals like for</span> <span data-start="1449.59" data-end="1450.91">example if you've got a game with levels</span> <span data-start="1450.91" data-end="1453.1">do that it like the score screen in</span> <span data-start="1453.1" data-end="1455.23">between levels if it's a game that</span> <span data-start="1455.23" data-end="1456.7">involves like a lot of real time stuff</span> <span data-start="1456.7" data-end="1458.83">and you want to somehow save state so</span> <span data-start="1458.83" data-end="1460.36">that like if you user gets disconnected</span> <span data-start="1460.36" data-end="1463.78">they can reconnect you know do that in</span> <span data-start="1463.78" data-end="1465.73">between turns somehow just find an</span> <span data-start="1465.73" data-end="1466.87">appropriate time to do it when things</span> <span data-start="1466.87" data-end="1468.34">like aren't animating and you're not</span> <span data-start="1468.34" data-end="1469.99">doing like a major draw or update</span> <span data-start="1469.99" data-end="1472.32">basically so just choose where</span> <span data-start="1472.32" data-end="1474.509">or you or when and where you call to</span> <span data-start="1474.509" data-end="1478.49">store things to local storage carefully</span> <span data-start="1478.49" data-end="1481.61">so really when you're when you're</span> <span data-start="1481.61" data-end="1483.69">creating something and doing stuff with</span> <span data-start="1483.69" data-end="1484.23">canvas</span> <span data-start="1484.23" data-end="1486.809">don't just keep creating new objects</span> <span data-start="1486.809" data-end="1491.33">willy-nilly reuse them from a pool</span> <span data-start="1491.33" data-end="1498.299">because if you don't if you don't you're</span> <span data-start="1498.299" data-end="1500.039">gonna get a graph in the chrome timeline</span> <span data-start="1500.039" data-end="1502.409">that looks something like this so a few</span> <span data-start="1502.409" data-end="1503.46">of you might know of course what's</span> <span data-start="1503.46" data-end="1507.409">what's going on here it's so like uh-oh</span> <span data-start="1507.409" data-end="1510.09">and it kind of drops off and this is a</span> <span data-start="1510.09" data-end="1511.86">game I found actually there's a really</span> <span data-start="1511.86" data-end="1514.08">simple person of course they're really</span> <span data-start="1514.08" data-end="1516.24">popular 2048 which by the way you guys</span> <span data-start="1516.24" data-end="1517.47">should check out threes I think it's a</span> <span data-start="1517.47" data-end="1518.759">way cooler implementation but somebody</span> <span data-start="1518.759" data-end="1520.019">here has gone and implemented a 3d</span> <span data-start="1520.019" data-end="1522.179">version of it and it's pretty simple</span> <span data-start="1522.179" data-end="1523.47">right like I started playing this was</span> <span data-start="1523.47" data-end="1525.629">like oh yeah this is really fun animated</span> <span data-start="1525.629" data-end="1527.789">nicely but the first time I started</span> <span data-start="1527.789" data-end="1529.799">playing it I mean my macbook air can</span> <span data-start="1529.799" data-end="1531.33">actually handle some pretty decent games</span> <span data-start="1531.33" data-end="1533.25">on steam without chugging and heating up</span> <span data-start="1533.25" data-end="1535.529">this game it looks really simple it was</span> <span data-start="1535.529" data-end="1537.6">like oh my god what are you doing to me</span> <span data-start="1537.6" data-end="1539.1">and it like got really really warm and</span> <span data-start="1539.1" data-end="1540.779">so I mean looking in the code was</span> <span data-start="1540.779" data-end="1542.34">actually if the code is actually not all</span> <span data-start="1542.34" data-end="1543.6">that straightforward it's it's up on</span> <span data-start="1543.6" data-end="1546.509">github and you know there's a couple</span> <span data-start="1546.509" data-end="1547.71">things that look like we're done and</span> <span data-start="1547.71" data-end="1549.57">draw calls but they were in three.js so</span> </p>
<p><span data-start="1549.57" data-end="1550.62">I'm not going to kind of trust the three</span> <span data-start="1550.62" data-end="1552.69">J's people but you know looking at this</span> <span data-start="1552.69" data-end="1555.84">timeline in in chrome you see this and</span> <span data-start="1555.84" data-end="1558.69">what's happening there is when it looked</span> <span data-start="1558.69" data-end="1559.62">in the code this person is actually</span> <span data-start="1559.62" data-end="1561.87">creating new tween objects all the time</span> <span data-start="1561.87" data-end="1563.7">rather than reusing them so it's like a</span> <span data-start="1563.7" data-end="1565.529">new object new object no garbage</span> <span data-start="1565.529" data-end="1567.36">collection and garbage collection is a</span> <span data-start="1567.36" data-end="1569.639">performance hit so please reuse objects</span> <span data-start="1569.639" data-end="1572.549">from an object pool you want to keep the</span> <span data-start="1572.549" data-end="1574.529">garbage collector board I know it's that</span> <span data-start="1574.529" data-end="1576.779">awesome feature to have but keep it as</span> <span data-start="1576.779" data-end="1578.909">bored as possible and so this here is</span> <span data-start="1578.909" data-end="1580.11">like the biggest wall of text you're</span> <span data-start="1580.11" data-end="1581.429">going to get in the presentation but</span> <span data-start="1581.429" data-end="1583.019">it's a simple example and of course I'll</span> <span data-start="1583.019" data-end="1584.22">give it the slides afterwards because</span> <span data-start="1584.22" data-end="1586.23">this is a little bit longer but you want</span> <span data-start="1586.23" data-end="1588.029">to basically initialize a pool of Woking</span> <span data-start="1588.029" data-end="1590.58">common objects and then you know pull</span> <span data-start="1590.58" data-end="1592.169">out an object use it for something put</span> <span data-start="1592.169" data-end="1593.49">it back in the pool and then you know</span> <span data-start="1593.49" data-end="1595.32">initialize it for something else and</span> <span data-start="1595.32" data-end="1597.12">that actually will be a lot better</span> <span data-start="1597.12" data-end="1598.559">because you're not doing a whole bunch</span> <span data-start="1598.559" data-end="1600.51">of garbage collection at these various</span> <span data-start="1600.51" data-end="1601.83">intervals that will then make your</span> <span data-start="1601.83" data-end="1603.69">animation and your game stutter if I</span> <span data-start="1603.69" data-end="1605.7">keep going with that 2048 game and we</span> <span data-start="1605.7" data-end="1605.91">start</span> <span data-start="1605.91" data-end="1607.29">getting more and more cubes and I just</span> <span data-start="1607.29" data-end="1608.94">keep going and flipping it around it</span> <span data-start="1608.94" data-end="1611.37">will start to stutter another another</span> <span data-start="1611.37" data-end="1613.32">tool to use as an FPS counter you can</span> <span data-start="1613.32" data-end="1615.24">actually find stats j/s which I believe</span> <span data-start="1615.24" data-end="1618.21">is I think I was talking to John John</span> </p>
<p><span data-start="1618.21" data-end="1620.1">David Dalton yesterday he made that and</span> <span data-start="1620.1" data-end="1621.66">then like now it's kind of in three J s</span> <span data-start="1621.66" data-end="1623.46">or mr. doob uses it so there's like a</span> <span data-start="1623.46" data-end="1624.84">little like JavaScript implementation</span> <span data-start="1624.84" data-end="1626.49">Chrome if you go into the dev tools</span> <span data-start="1626.49" data-end="1628.41">press escape while you're in there</span> <span data-start="1628.41" data-end="1630">you'll see a little rendering tab and</span> <span data-start="1630" data-end="1631.5">they have an FPS tool as well that's</span> <span data-start="1631.5" data-end="1632.49">that's really cool it actually it's</span> <span data-start="1632.49" data-end="1633.84">really badass it makes me feel like I'm</span> <span data-start="1633.84" data-end="1635.1">in the future it's like red and black</span> <span data-start="1635.1" data-end="1638.73">moving lines and then Firefox has got a</span> <span data-start="1638.73" data-end="1640.8">really nice integrated FPS widget that's</span> <span data-start="1640.8" data-end="1642.18">going to be shipping with our profiler</span> <span data-start="1642.18" data-end="1644.46">once we ship our brand-new profiler so</span> <span data-start="1644.46" data-end="1646.44">that's a thing so you know another part</span> <span data-start="1646.44" data-end="1648.21">about basically as another good metric</span> <span data-start="1648.21" data-end="1650.04">is to like you know look at your game</span> <span data-start="1650.04" data-end="1652.74">and see when your frame rate really</span> <span data-start="1652.74" data-end="1655.23">fluctuates or when it just like drops</span> <span data-start="1655.23" data-end="1657.08">down to ten like if I keep going in this</span> <span data-start="1657.08" data-end="1658.32">2048 game</span> </p>
<p><span data-start="1658.32" data-end="1659.85">I've got limited time so I'm not going</span> <span data-start="1659.85" data-end="1661.17">to pull it up but trust me if you just</span> <span data-start="1661.17" data-end="1664.17">find this game it's if you look for</span> <span data-start="1664.17" data-end="1666.93">cubics 2048 you'll find it and just run</span> <span data-start="1666.93" data-end="1668.76">an FPS counters you keep doing this and</span> <span data-start="1668.76" data-end="1670.5">you'll watch it go pew all the way down</span> <span data-start="1670.5" data-end="1672.93">so very fun game to play regardless</span> <span data-start="1672.93" data-end="1676.95">though so I'm some miscellaneous micro</span> <span data-start="1676.95" data-end="1679.17">optimizations remember I said like these</span> <span data-start="1679.17" data-end="1680.61">up until now these are mostly best</span> <span data-start="1680.61" data-end="1683.58">practices for doing your canvas stuff if</span> <span data-start="1683.58" data-end="1684.84">you get to the end and you really do</span> <span data-start="1684.84" data-end="1686.1">want to try and get a little bit more</span> <span data-start="1686.1" data-end="1687.63">bang for your buck out of performance</span> <span data-start="1687.63" data-end="1689.07">these are a few tips that I picked up</span> <span data-start="1689.07" data-end="1692.58">from really great articles on Mozilla</span> <span data-start="1692.58" data-end="1694.44">hacks talking to my friends who are from</span> <span data-start="1694.44" data-end="1696.27">like higher level wizards than I am at</span> <span data-start="1696.27" data-end="1698.16">canvas and there's also some good stuff</span> <span data-start="1698.16" data-end="1700.17">on html5 rocks as well from people at</span> </p>
<p><span data-start="1700.17" data-end="1703.77">Google use bitwise operators instead of</span> <span data-start="1703.77" data-end="1705.42">math dot floor a little bit more</span> <span data-start="1705.42" data-end="1708.12">performant clear arrays with length zero</span> <span data-start="1708.12" data-end="1710.64">to avoid creating a new array use</span> <span data-start="1710.64" data-end="1712.68">if-else over switch and actually I have</span> <span data-start="1712.68" data-end="1714.93">an article that I I can link to when I</span> <span data-start="1714.93" data-end="1717.06">send these out that has J s perfs for</span> <span data-start="1717.06" data-end="1720.83">for these use date now over new date a</span> <span data-start="1720.83" data-end="1723.36">voyage shadow blur you can do that to a</span> <span data-start="1723.36" data-end="1725.37">praia playa FEX two primitives but that</span> <span data-start="1725.37" data-end="1726.57">can actually be a performance hit as</span> <span data-start="1726.57" data-end="1729.18">well so oh my god this is so much stuff</span> <span data-start="1729.18" data-end="1730.83">right so everybody's like either really</span> <span data-start="1730.83" data-end="1732.45">quiet cuz they're like oh my god I'm in</span> <span data-start="1732.45" data-end="1734.91">are holy I'm totally confused but</span> <span data-start="1734.91" data-end="1736.41">that's good hopefully whatever I've said</span> <span data-start="1736.41" data-end="1738.43">you today makes you think like hmm</span> <span data-start="1738.43" data-end="1739.93">and now I've got like this handy bag of</span> <span data-start="1739.93" data-end="1741.76">tricks for working with canvas I don't</span> <span data-start="1741.76" data-end="1743.11">need to be afraid about going out there</span> <span data-start="1743.11" data-end="1744.34">and experimenting because you've got</span> <span data-start="1744.34" data-end="1746.17">like these ideas you can keep in the</span> <span data-start="1746.17" data-end="1748.12">back of your mind so that your canvas</span> <span data-start="1748.12" data-end="1749.53">stuff ends up being really fun for your</span> <span data-start="1749.53" data-end="1751.45">plans to favorite part of me ends up</span> <span data-start="1751.45" data-end="1753.01">being really fun for your friends to</span> <span data-start="1753.01" data-end="1755.32">play with on probably most devices in</span> <span data-start="1755.32" data-end="1757.5">fact a lot of these tips came from</span> <span data-start="1757.5" data-end="1759.7">tactics that people use for shipping</span> <span data-start="1759.7" data-end="1762.85">games on Firefox OS which the phones</span> <span data-start="1762.85" data-end="1765.73">that were shipping are you know they're</span> <span data-start="1765.73" data-end="1767.53">not your iPhone 5 and that's on purpose</span> <span data-start="1767.53" data-end="1769.99">actually they have much less power much</span> <span data-start="1769.99" data-end="1771.97">less memory than the fancy phones that</span> <span data-start="1771.97" data-end="1773.92">probably you or I have the ideas that</span> <span data-start="1773.92" data-end="1775.09">we're shipping these to emerging and</span> <span data-start="1775.09" data-end="1777.1">developing markets and pricing them</span> <span data-start="1777.1" data-end="1778.57">competitively so that people that would</span> <span data-start="1778.57" data-end="1780.82">buy a future phone will instead maybe be</span> <span data-start="1780.82" data-end="1782.53">introduced to smartphones and spend more</span> <span data-start="1782.53" data-end="1784.09">time on the web and stuff like that but</span> <span data-start="1784.09" data-end="1785.83">actually a really great metric is</span> </p>
<p><span data-start="1785.83" data-end="1788.29">Firefox list phones are super cheap you</span> <span data-start="1788.29" data-end="1789.79">can buy own for under 100 bucks if your</span> <span data-start="1789.79" data-end="1791.41">game runs really well on one of these</span> <span data-start="1791.41" data-end="1793.9">like less powerful like memory</span> <span data-start="1793.9" data-end="1795.73">constrained phones you can be pretty</span> <span data-start="1795.73" data-end="1797.38">confident it's gonna run really well in</span> <span data-start="1797.38" data-end="1799.27">other devices actually because you're</span> <span data-start="1799.27" data-end="1801.04">only ever as best as your worst</span> <span data-start="1801.04" data-end="1804.49">performing case in my opinion so that's</span> <span data-start="1804.49" data-end="1806.5">basically it I hope you enjoyed this</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
