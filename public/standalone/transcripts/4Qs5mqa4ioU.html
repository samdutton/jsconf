<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>4Qs5mqa4ioU</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/4Qs5mqa4ioU?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="20.64" data-end="28.039">All right, hi everyone, my name is Artur, I work on the Google security team as an engineer</span> <span data-start="28.039" data-end="32.8">and what my team does is we try to make sure that we don't have security vulnerabilities</span> <span data-start="32.8" data-end="38.61">in our products, as you might know Google has a lot of web application, web-apps are</span> <span data-start="38.61" data-end="47.66">a big part of our world and we work with external researchers that get paid for findings vulnerabilities</span> <span data-start="47.66" data-end="50.93">in our products when we miss something.</span> <span data-start="50.93" data-end="56.87">This puts us in a position where we find out a lot about new patterns and flaws that can</span> <span data-start="56.87" data-end="62.609">affect the security of our web applications, because a lot of are web-apps are built using</span> <span data-start="62.609" data-end="69.13">open sources frameworks like angular and other ones, we learn about patterns that can affect</span> <span data-start="69.13" data-end="78.22">security and your web-apps possibly as well, right after we update code we often get new</span> <span data-start="78.22" data-end="80.759">data about some security flaws.</span> <span data-start="80.759" data-end="87.82">My hope for this talk is to share some of this with you and I'm very, I'm very happy</span> <span data-start="87.82" data-end="92.659">that Anand Vemuri hopefully already scared you a little bit when it comes to security</span> <span data-start="92.659" data-end="99.14">and the impact of cross-site scripting, so I my intent is to build up on this a little</span> <span data-start="99.14" data-end="103.28">bit and show you some angular-specific examples.</span> </p>
<p><span data-start="103.28" data-end="108.09">Before I start, can you guys raise your hand if you know what angular is or if you have</span> <span data-start="108.09" data-end="112.45">written angular code in the past — ok, this is music to my ears.</span> <span data-start="112.45" data-end="116.149">Ok, so let's get started.</span> <span data-start="116.149" data-end="121.56">This is a security talk, this is JSConf so I will not tell you anything about securing</span> <span data-start="121.56" data-end="126.899">your database, or your back up systems, so not going to talk about server security at</span> <span data-start="126.899" data-end="131.53">all, we're going to talk about client security and client security here is making sure that</span> <span data-start="131.53" data-end="138.48">the users of your web applications don't get, cannot get compromised or attacked by evil</span> <span data-start="138.48" data-end="140.21">websites or networks.</span> <span data-start="140.21" data-end="145.32">Client security is a fairly broad area as well and, you know, if you want to have a</span> <span data-start="145.32" data-end="149.819">secure website you should have HTTPS and prevent a bunch of other things, but we're not going</span> <span data-start="149.819" data-end="158.25">to talk about that in general either, I will focus on the biggest threat that is sort of,</span> <span data-start="158.25" data-end="166.98">as an industry or web application developers we have been facing since web-apps have existed.</span> </p>
<p><span data-start="166.98" data-end="173.54">I know this is a subjective view but, at least at Google this is something that we are super</span> <span data-start="173.54" data-end="174.909">concerned about.</span> <span data-start="174.909" data-end="177.54">So, cross-site scripting.</span> <span data-start="177.54" data-end="181.73">Also the other thing is that for the other flaws, the other common things that we are</span> <span data-start="181.73" data-end="186.93">worried about in web applications we have relatively a good way of preventing them,</span> <span data-start="186.93" data-end="193.41">it might not be super straightforward, but if you want to prevent eavesdroppers getting</span> <span data-start="193.41" data-end="205.12">access to your users' data in your web app, you can deploy HTTPS and security engineers</span> <span data-start="205.12" data-end="206.98">will tell you what to do, it will be ok.</span> </p>
<p><span data-start="206.98" data-end="214.239">For cross-site scripting it's not usually that simple, there are no panaceas that will</span> <span data-start="214.239" data-end="219.75">prevent your developers from introducing cross-site scripting bugs.</span> <span data-start="219.75" data-end="229.81">If you have been here for Anand Vemuri's talk, most of you have, this is cross-site scripting,</span> <span data-start="229.81" data-end="236.08">cross-site scripting got introduced if you have a HTTP parameter that you output to your</span> <span data-start="236.08" data-end="241.93">page without any escape, right, so you have a script, you have a get parameter, you write</span> <span data-start="241.93" data-end="251.33">it out and then what an evil website can do, they can point to that URL and make your user</span> <span data-start="251.33" data-end="252.69">execute an evil script.</span> <span data-start="252.69" data-end="258.959">One example of an evil script was something that Anand Vemuri showed, basically someone</span> <span data-start="258.959" data-end="265.36">gave a webcam permissions to your website, they can transparently enable it and sort</span> <span data-start="265.36" data-end="266.771">of spy on your users, but it</span> <span data-start="266.771" data-end="269.68">goes much beyond that actually.</span> </p>
<p><span data-start="269.68" data-end="274.78">So what the evil code can do once it's injected into your origin, your domain, it has full</span> <span data-start="274.78" data-end="281.76">access to everything your user can do in the web app, if you think of rich ecosystems of</span> <span data-start="281.76" data-end="289.11">application, such as any major provider, Google, Facebook, Twitter, most of your apps, the</span> <span data-start="289.11" data-end="295.23">HorseDrawingTycoon app that Curtis will talk about in the next session, if you are an,</span> <span data-start="295.23" data-end="300.21">attacker and can inject evil code you can get access to everything a web application</span> <span data-start="300.21" data-end="306.849">has and you can attack other apps that live in the same domain as a cross-site scripting</span> <span data-start="306.849" data-end="309.599">bug.</span> </p>
<p><span data-start="309.599" data-end="318.899">We worry about the fact you can persist your access as an attacker after you exploit cross-site</span> <span data-start="318.899" data-end="322.19">scripting for a given user.</span> <span data-start="322.19" data-end="329.04">What this means, even two months later, even after the developer closes the cross-site</span> <span data-start="329.04" data-end="335.279">scripting vulnerability the attacker might still be able to retain some access to the</span> <span data-start="335.279" data-end="336.86">web app, so that is super scary.</span> <span data-start="336.86" data-end="345.11">So, but you know, the good thing is that traditionally as JavaScript developers we did not have to</span> <span data-start="345.11" data-end="354.5">worry too much about, you know, the various ways in which you can introduce XSS into the</span> <span data-start="354.5" data-end="360.13">web-apps, when you purely write JavaScript code there are only a few APIs that might</span> <span data-start="360.13" data-end="366.57">be able to, that could lead to cross-site scripting, so things like setting inner HTML,</span> <span data-start="366.57" data-end="378.37">document.write, when you set HTML, when you set JavaScript URIs on window open navigation</span> <span data-start="378.37" data-end="384.56">and so on, maybe five years ago if you kept all of those in mind when you were writing</span> <span data-start="384.56" data-end="395.12">your JavaScript code, you would be safe from say 95% of the bugs that would otherwise introduced,</span> <span data-start="395.12" data-end="399.58">be careful with all the APIs.</span> <span data-start="399.58" data-end="405.45">The thing that is different these days, we don't really write web applications that use</span> <span data-start="405.45" data-end="414.05">those primatives directly, it's fairly rare, stuff like that rarely happens, it's rare</span> <span data-start="414.05" data-end="420.37">for modern well designed web application to use document.write, there are circumstances</span> <span data-start="420.37" data-end="423.71">where you might have to do that, but it's not that common.</span> </p>
<p><span data-start="423.71" data-end="429.07">The reason that's the case, there are many new frameworks and many new APIs that were</span> <span data-start="429.07" data-end="434.57">introduced to make our lives easier, as part of the big web frameworks, so we don't have</span> <span data-start="434.57" data-end="447.55">to use the bare metal — it does make our life easier, it makes it easier to use the APIs</span> <span data-start="447.55" data-end="453.2">without really understanding, if you have a framework that wraps around one of these</span> <span data-start="453.2" data-end="459.36">functions then you are still vulnerable to the same class of issues, but even though</span> <span data-start="459.36" data-end="464.37">you have not written code that uses the dangerous API directly.</span> <span data-start="464.37" data-end="470.589">So, one of the things that has been, one of the frameworks that has become fairly popular</span> <span data-start="470.589" data-end="477.2">recently has been angular, to be honest I'm sure that almost all of you know way more</span> <span data-start="477.2" data-end="483.39">about angular than I do, I'm not an angular developer or Evangelist for that matter, I'm</span> <span data-start="483.39" data-end="490.719">a security engineer, I know enough to break angular apps but not enough to build with</span> <span data-start="490.719" data-end="497.01">angular, but that's ok, hopefully if you don't know too much about angular, I will show you</span> <span data-start="497.01" data-end="501.469">the bare things you need to understand, code examples that we will talk about.</span> <span data-start="501.469" data-end="509.18">Angular is pretty popular, just in case you forgot all about angular in the ten minutes</span> <span data-start="509.18" data-end="514.07">since I asked you if you know angular, this is how it works, three short steps.</span> </p>
<p><span data-start="514.07" data-end="520.55">You include the angular JavaScript somewhere on your page, then you write something that</span> <span data-start="520.55" data-end="528.12">looks like HTML, sort of, so, you know, you write mark-up and you also have these ng-attributes</span> <span data-start="528.12" data-end="535.66">that allow your application to do the angular magic, right, you can have loops, you can</span> <span data-start="535.66" data-end="543.24">have, you know, data-bindings, the must have syntax that will be important in a few</span> <span data-start="543.24" data-end="554.65">minutes, it's not specific to angular, it's one of the big users of moustache syntax,</span> <span data-start="554.65" data-end="564.89">the last thing is to behind the JavaScript that you write for your controller, to the</span> <span data-start="564.89" data-end="573.75">appropriate DOM element that has all the bindings and angular syntax, right, it's fairly straightforward</span> <span data-start="573.75" data-end="579.31">conceptually it allows really powerful, really cool web applications to be built.</span> </p>
<p><span data-start="579.31" data-end="586.09">There is a lot of APIs, the template syntax is very rich, you can do a lot with that,</span> <span data-start="586.09" data-end="593.1">there is components, a lot of APIs for requesting data from the server and you know, really</span> <span data-start="593.1" data-end="596.44">lots of cool stuff you can look at examples, it's great.</span> <span data-start="596.44" data-end="602.72">All right, so, you know, I've set it up a little bit, you know angular, you know this</span> <span data-start="602.72" data-end="607.66">is an security talk, so what, what's the deal?</span> <span data-start="607.66" data-end="614.99">So, when you start using these frameworks there are a lot of things that might look</span> <span data-start="614.99" data-end="620.67">to be, might seem to be very safe, but actually when you, when you sort of look more closely</span> <span data-start="620.67" data-end="623.05">turns out there are subtle issues there.</span> <span data-start="623.05" data-end="628.09">So, the first issue that we have actually run into several times in several of our applications</span> <span data-start="628.09" data-end="635.16">is what happens if you mix angular and surfer-side template systems, so I hope that most if you,</span> <span data-start="635.16" data-end="639.55">when you generate mark-up on the server are using a templatetime, as Anand Vemuri was</span> <span data-start="639.55" data-end="643.47">saying earlier, this is something that gives you context escaping so you don't have to</span> <span data-start="643.47" data-end="653.41">do it manually because you need different types of escaping, the template server will</span> <span data-start="653.41" data-end="655.67">take care of all of that for you.</span> </p>
<p><span data-start="655.67" data-end="663.39">In the past you would have a template, you would render it and even if you had evil inputs</span> <span data-start="663.39" data-end="670.3">to your application, the template system would, by default, just escape it, properly for the</span> <span data-start="670.3" data-end="675.33">context, at least if you are using a good template system and most, most reasonable,</span> <span data-start="675.33" data-end="678.45">modern frameworks use those and you are fine.</span> <span data-start="678.45" data-end="681.55">So, ok, so what this problem really?</span> <span data-start="681.55" data-end="686.53">So this is what happens when you, when you use a template system on the server-side and</span> <span data-start="686.53" data-end="688.74">angular.</span> <span data-start="688.74" data-end="693.34">The only difference here is that we have included some angular elements in are template right,</span> <span data-start="693.34" data-end="703.6">we have the ng-app, but what happens is and this is in the bottom code box, that the template</span> <span data-start="703.6" data-end="710.81">system will escape all your HTML meta characters, you can't just inject HTML but your server-side</span> <span data-start="710.81" data-end="721.47">system knows much about the moustache system, you if you allow this kind of output, angular</span> <span data-start="721.47" data-end="728.47">when it processes the page after it loads it will do it's magic, try to find directives</span> <span data-start="728.47" data-end="733.57">in the angular controlled DOM element and it will execute them.</span> </p>
<p><span data-start="733.57" data-end="738.17">What this means is that as an attacker you might not be able to inject straight up mark-up,</span> <span data-start="738.17" data-end="746.85">but you can use angular data bindings, execute arbitrary angular controller functions so</span> <span data-start="746.85" data-end="754.16">basically do anything that is defined in your angular controllers and also the sort of really</span> <span data-start="754.16" data-end="760.87">big thing that, that is not often talked about, is that it's possible to escape out of the</span> <span data-start="760.87" data-end="774.779">angular box, and once you can inject the moustache since tax — if you go to the angular security</span> <span data-start="774.779" data-end="780.11">page they will tell you, you should not mix client side and server-side templates, it</span> <span data-start="780.11" data-end="788.52">can lead to the interesting interactions between the two, that will, that will — that can possibly</span> <span data-start="788.52" data-end="789.9">make your app vulnerable.</span> </p>
<p><span data-start="789.9" data-end="795.47">There are good reasons to do this, if you retrofit angular into existing web applications</span> <span data-start="795.47" data-end="803.18">that are often generated alongside server-side templates then you will have these issues.</span> <span data-start="803.18" data-end="807.97">Also if you want to pre-populate part of your page with data the server knows about and</span> <span data-start="807.97" data-end="814.77">you want to avoid a separate call back to get this data, it's sort of natural to do</span> <span data-start="814.77" data-end="820.45">this, it's one pattern that is surprisingly interesting.</span> <span data-start="820.45" data-end="827.72">Ok so let's say we go about this, we create our Angular part of the page statically we</span> <span data-start="827.72" data-end="834.97">don't have any server-side template generation we just have a very simple application here,</span> <span data-start="834.97" data-end="842.69">which has just one image and alt tag and displays the fav icon.</span> <span data-start="842.69" data-end="848.47">We have a controller, the controller has a dangerous function but we're not executing</span> <span data-start="848.47" data-end="852.819">it so everything is fine, nothing to worry about here.</span> </p>
<p><span data-start="852.819" data-end="860.68">So what happens if before we run Angular on the page, we insert and we run another completely</span> <span data-start="860.68" data-end="867.18">innocuous JavaScript function, what this function is doing is finding all the image elements</span> <span data-start="867.18" data-end="874.779">on the page, and it's adding an alt attribute to every image it's probably a really crappy</span> <span data-start="874.779" data-end="881.32">use of the alt attribute you should never do this but we're just adding some data image</span> <span data-start="881.32" data-end="882.66">from our site.</span> <span data-start="882.66" data-end="887.47">When the location is something that is controlled in part by the user because you can open any</span> <span data-start="887.47" data-end="893.77">web page with location.hash, the URL fragment at the end is something that the user controls</span> <span data-start="893.77" data-end="901.279">but the alt tag, the alt attribute it's not async, it's normally if you do this nothing</span> <span data-start="901.279" data-end="902.279">bad will happen.</span> <span data-start="902.279" data-end="909.33">If you insert a script tag or HTML markup it will not render it's just like a bit of</span> <span data-start="909.33" data-end="917.02">text, but what happens here when this interaction appears, is before Angular is invoked after</span> <span data-start="917.02" data-end="923.17">our function runs, we will suddenly have this bit of DOM where you have an alt attribute</span> <span data-start="923.17" data-end="933.589">which data so assuming that the attacker injected a bit of Angular markup in the URL what Angular</span> <span data-start="933.589" data-end="938.36">sees when it tries to parse the page is an alt attribute with a data binding.</span> </p>
<p><span data-start="938.36" data-end="944.38">It will look at it think ok well now there is something for me I will execute it.</span> <span data-start="944.38" data-end="953.23">Again as an attacker, you are able to inject arbitrary JavaScript and compromise the application.</span> <span data-start="953.23" data-end="958.68">So this is another example of an interaction where before everything would have been safe,</span> <span data-start="958.68" data-end="963.81">but because you are using a client side powerful framework you start having problems.</span> <span data-start="963.81" data-end="968.44">All right, so let me give you another example.</span> <span data-start="968.44" data-end="974.31">So one of the most powerful features of Angular and other similar framework Ss are in includes</span> <span data-start="974.31" data-end="983.51">where you don't have to have all your HTML syntax inline but you can include sub templates</span> <span data-start="983.51" data-end="988.82">and these templates will be rendered as part of your application so it's really great.</span> <span data-start="988.82" data-end="995.48">It allows angular to fetch a little bit of markup anywhere from the server, render it</span> <span data-start="995.48" data-end="1000.19">in it's super useful.</span> <span data-start="1000.19" data-end="1006.44">So in here what we're doing is we have this NG, including that is based on the scope of</span> <span data-start="1006.44" data-end="1012.74">the controller so when we set the template URL variable we're saying this is just a pass</span> <span data-start="1012.74" data-end="1016.399">to an HTML file on our server.</span> <span data-start="1016.399" data-end="1021.53">So again nothing to worry about it's fine the user language is controlled, by the user</span> <span data-start="1021.53" data-end="1025.179">possibly but it doesn't seem like there's anything super wrong here.</span> </p>
<p><span data-start="1025.179" data-end="1026.179">Right?</span> <span data-start="1026.179" data-end="1030.579">Well hopefully by now you know that all the examples are tricky, yes there is something</span> <span data-start="1030.579" data-end="1034.6">wrong and there is something bad that can happen in this application.</span> <span data-start="1034.6" data-end="1042.74">So if the user can control this variable, part of the URL from which Angular loads the</span> <span data-start="1042.74" data-end="1050.9">template what they can do is they can add and this is actually very reminiscent of old</span> <span data-start="1050.9" data-end="1058.47">server where you have directory reversal you are sometimes on the server able to read files</span> <span data-start="1058.47" data-end="1060.67">from different directories than you would expect.</span> <span data-start="1060.67" data-end="1063.52">Here is the same but it's on the client.</span> <span data-start="1063.52" data-end="1065.92">So when this sort of</span> <span data-start="1065.92" data-end="1074.38">evil language variable is embedded as part of the include value, what will happen is</span> <span data-start="1074.38" data-end="1082.67">that this URL is no longer pointing to/angular templates/something it can point to a URL</span> <span data-start="1082.67" data-end="1089.34">on your website that redirects to a completely external site that might be controlled by</span> <span data-start="1089.34" data-end="1090.89">the user.</span> </p>
<p><span data-start="1090.89" data-end="1100.01">Because under the hood what Angular is doing is XML HTTP request if it replies with all</span> <span data-start="1100.01" data-end="1106.27">the cross origin headers the data that the attacker supplies will now be include as part</span> <span data-start="1106.27" data-end="1112.49">of our application that can contain HTML and arbitrary scripts.</span> <span data-start="1112.49" data-end="1118.809">Something that I should mention here is that Angular does have a mechanism that will, that</span> <span data-start="1118.809" data-end="1125.15">by default prevent this from happening, but Angular also considers anything under your</span> <span data-start="1125.15" data-end="1128.16">domain to be a trusted resource.</span> <span data-start="1128.16" data-end="1134.87">So to angular this URL/angular/templates, this looks like a trusted resource, it points</span> <span data-start="1134.87" data-end="1141.4">to your web server it has no easy way of knowing that eventually if the browser follows all</span> <span data-start="1141.4" data-end="1145.33">the redirects this can contain untrusted data.</span> <span data-start="1145.33" data-end="1152.55">So by default if you use those kind of patterns, your application will be vulnerable.</span> <span data-start="1152.55" data-end="1154.64">So another example.</span> <span data-start="1154.64" data-end="1163.63">So, let's say that just hypothetically you have a HorseDrawingTycoon application, and</span> <span data-start="1163.63" data-end="1173.1">you use JCP in that, complete hypothetical HorseDrawingTycoon I am sure most of you are</span> <span data-start="1173.1" data-end="1182.3">familiar with JSONP, I am not sure why it's called JSON, it doesn't look like padding</span> <span data-start="1182.3" data-end="1186.85">to me that's what it's called four few years I guess the name stuck.</span> <span data-start="1186.85" data-end="1198.53">It's how you JSONP in angular there's a convenience rapper for JSONP, you can call a HTTP object,</span> <span data-start="1198.53" data-end="1205.84">what happens is the URL you pass to this function will be used as a script source if you think</span> <span data-start="1205.84" data-end="1213">about what that means you will not manually ever write JavaScript code that says create</span> <span data-start="1213" data-end="1218.97">a document, create element script then as a source assign evil.com to it, but when you</span> <span data-start="1218.97" data-end="1227.52">use the JSONP API in a way that's is commonly used especially for restful APIs, you say</span> </p>
<p><span data-start="1227.52" data-end="1238.4">I want to load JSONP from my server, /app then there is something that is potentially</span> <span data-start="1238.4" data-end="1239.64">controlled by the user.</span> <span data-start="1239.64" data-end="1248.49">A name of your object, or an identifier of your object, and if you create a URL like</span> <span data-start="1248.49" data-end="1257.62">this, it's the same kind of pattern that we just saw with the NG include example.</span> <span data-start="1257.62" data-end="1269.04">Basically if as part of the URL you have, ./you will fetch an open re-direct or from</span> <span data-start="1269.04" data-end="1270.53">an evil site.</span> <span data-start="1270.53" data-end="1277.73">Again now the evil application cannot respond with HTML but it can respond with an evil</span> <span data-start="1277.73" data-end="1279.88">straight up JavaScript.</span> </p>
<p><span data-start="1279.88" data-end="1287.87">So maybe the JSONP API is not that common but what is really common in angular applications</span> <span data-start="1287.87" data-end="1294.64">is the HTTP get API, any time you want to retrieve something from your server or any</span> <span data-start="1294.64" data-end="1300.309">external resource you use HTTP get.</span> <span data-start="1300.309" data-end="1307.429">If you just want to load say JSON, not JSONP but JSON or any other thing you generate from</span> <span data-start="1307.429" data-end="1313.53">the server you will have a very similar issue.</span> <span data-start="1313.53" data-end="1317.51">So this is actually a very common pattern we see.</span> <span data-start="1317.51" data-end="1324.45">By itself if you just use HTTP get on a potentially external untrusted resource it's not terrible</span> <span data-start="1324.45" data-end="1329.32">because what will end up happening is that you will issue an XML HTTP request your application</span> <span data-start="1329.32" data-end="1335.03">will get the data but if it discards is or does nothing with it you will be safe because</span> <span data-start="1335.03" data-end="1340.25">the data just by calling HTTP get you are not doing anything that’s super scary but</span> <span data-start="1340.25" data-end="1347.89">what actually happens is that the data that you obtain from the server, is used for something</span> <span data-start="1347.89" data-end="1350.36">later, like generating parts of the page.</span> <span data-start="1350.36" data-end="1357.16">So in here if we call inner HTML we assign inner HTML us any of the data we have got</span> <span data-start="1357.16" data-end="1362.82">from what we think is our server about it's actually an attacker called response.</span> </p>
<p><span data-start="1362.82" data-end="1367.64">We will again have a problem because inner HTML is a DOM sync, then we have a bug.</span> <span data-start="1367.64" data-end="1375.86">I’m sure you are thinking about what I said before which is no-one really writes code</span> <span data-start="1375.86" data-end="1378.67">that uses inner HTML directly anymore, so this is</span> <span data-start="1378.67" data-end="1380.4">sort of a fake example right?</span> <span data-start="1380.4" data-end="1386.25">Yes it's a fake example, but what ends up happening much more common in practice, is</span> <span data-start="1386.25" data-end="1394.21">that rather than using inner HTML directly what you end up doing is instead of using</span> <span data-start="1394.21" data-end="1401.391">inner HTML you use some of the jQ lite rappers that let you create part of the DOM your JQ</span> <span data-start="1401.391" data-end="1415.04">lite is a sub-set you just get some of these convenience methods eye HTML, append and others,</span> <span data-start="1415.04" data-end="1424.309">and in here if you get the data from the attacker and then you call append, this is sort of</span> <span data-start="1424.309" data-end="1430.47">in visibly wraps round the inner HTML DOM sync, and you might have a problem.</span> <span data-start="1430.47" data-end="1438.03">So in the past, if I were a security engineer, reviewing the code of a JavaScript application,</span> <span data-start="1438.03" data-end="1443.309">I would grab for an inner HTML, crap for a bunch of these other patterns, but in here</span> <span data-start="1443.309" data-end="1449.34">we have angular and any other framework like that injecting their own wrappers that do</span> <span data-start="1449.34" data-end="1454.64">the same thing but are sort of hard for both the security engineer and the developer writing</span> <span data-start="1454.64" data-end="1458.34">the code to understand, that they are potentially dangerous.</span> </p>
<p><span data-start="1458.34" data-end="1465.62">There's no big list that you can Google and sort of know that these function calls are</span> <span data-start="1465.62" data-end="1467.4">dangerous.</span> <span data-start="1467.4" data-end="1473.799">So you just sort of have to keep that in mind.</span> <span data-start="1473.799" data-end="1477.74">We're almost done, I just have a couple of things to show you that are maybe a little</span> <span data-start="1477.74" data-end="1486.61">less used but also interesting from the sort of new way of doing things perspective.</span> </p>
<p><span data-start="1486.61" data-end="1493.48">So angular and other frameworks give you direct access some of the interesting parsing functionality</span> <span data-start="1493.48" data-end="1495.58">that the framework has to do.</span> <span data-start="1495.58" data-end="1501.41">So rather than create a bit of HTML sort of statically then in invoking angular on it</span> <span data-start="1501.41" data-end="1509.1">you can create a string on JavaScript then call interpolate and angular will do the same</span> <span data-start="1509.1" data-end="1518.15">thing it would normally do on your page substitute data bindings, render HTML the same thing</span> <span data-start="1518.15" data-end="1519.809">as compiling.</span> <span data-start="1519.809" data-end="1524.71">If you parse any untrusted data to any of those function if you manually need to call</span> <span data-start="1524.71" data-end="1531.83">them for some reason you will also have another cross-site scripting bug.</span> <span data-start="1531.83" data-end="1536.98">The final example that I wanted to show you is something that Anand also mentioned earlier,</span> <span data-start="1536.98" data-end="1544.73">and that is probably the most common thing that is like to happen in angular applications</span> <span data-start="1544.73" data-end="1553.83">in the past if you wanted to render some HTML, that the potential lay has JavaScript attributes</span> <span data-start="1553.83" data-end="1560.95">or things that might be dangerous in some way, but if you trust it you control all the</span> <span data-start="1560.95" data-end="1569.57">input you can say ngbinding HTML safe it will be fine but this a dangerous API because any</span> <span data-start="1569.57" data-end="1574.23">time you pass user controlled data to it you will have a bug.</span> <span data-start="1574.23" data-end="1581.32">Now angular actually prevented this from happening in new versions, so now you just a have ngbindHTML</span> <span data-start="1581.32" data-end="1587.799">which will by default sanitise all the markup you give the if you give it a script it will</span> <span data-start="1587.799" data-end="1593.799">escape everything if you give it a bold tag it will keep it because it's knows it's safe.</span> </p>
<p><span data-start="1593.799" data-end="1600.7">There's a whole family of functions that let you trust bits of data as HTML, basically</span> <span data-start="1600.7" data-end="1605.99">tell angular this fine don't worry about it don't escape it I have checked it's correct.</span> <span data-start="1605.99" data-end="1613.17">This tends to be used improperly as scary with scary frequency.</span> <span data-start="1613.17" data-end="1616.58">All right, ok.</span> <span data-start="1616.58" data-end="1620.41">So, like what's the point of all this?</span> <span data-start="1620.41" data-end="1624.98">What I thought initially as I was working on this talk I thought ok I will try to scare</span> <span data-start="1624.98" data-end="1630.87">you a little bit, and then I will give you solutions for all these things because why</span> <span data-start="1630.87" data-end="1631.87">wouldn't</span> </p>
<p><span data-start="1631.87" data-end="1632.87">I?</span> <span data-start="1632.87" data-end="1636.63">I don't want to be a jerk I want to tell you how to write secure code, but in the end I</span> <span data-start="1636.63" data-end="1641.7">decided I will probably be a little bit of a jerk and not tell you how to fix it and</span> <span data-start="1641.7" data-end="1646.28">the reason is that even if I told you how to address all these patterns, that that we</span> <span data-start="1646.28" data-end="1655.62">saw on the previous slides it would not comprehensively cover all of the sharp edges of the framework</span> <span data-start="1655.62" data-end="1657.559">that you might need to be concerned about.</span> <span data-start="1657.559" data-end="1661.47">So you would come out of this room thinking ok I know everything there is to know about</span> <span data-start="1661.47" data-end="1667.22">angular security I will avoid these thing it will be fine, but in practice it's not</span> <span data-start="1667.22" data-end="1671.19">like that because first of all angular is just one of many frameworks and second of</span> <span data-start="1671.19" data-end="1675.46">all, there are many other things in angular that we don't yet know about the framework</span> <span data-start="1675.46" data-end="1681.68">changes, so instead of giving you specific recipes or patterns for how to avoid it I</span> <span data-start="1681.68" data-end="1685.42">will ask you to do 3 things, sort of to keep in mind at a high level.</span> </p>
<p><span data-start="1685.42" data-end="1687.26">First of all, read the box.</span> <span data-start="1687.26" data-end="1692.97">I know as developers we often want to get things running there's a lot of pressures,</span> <span data-start="1692.97" data-end="1697.679">but if you want to have a secure application, usually what will really had is read the docks</span> <span data-start="1697.679" data-end="1703.46">from your framework they will tell you what you have to keep in mind or what you have</span> <span data-start="1703.46" data-end="1704.74">to worry about.</span> <span data-start="1704.74" data-end="1710.37">The second thing is talk to security people, either in person or on Twitter, ask them I’m</span> <span data-start="1710.37" data-end="1714.44">using angular what should I be worried about.</span> </p>
<p><span data-start="1714.44" data-end="1721.95">Because they, we as security folks get super excited about these minute that led to thee</span> <span data-start="1721.95" data-end="1728.84">problems if you want to talk to me later I am super happy to do it I love to do it.</span> <span data-start="1728.84" data-end="1729.84">That's second thing.</span> <span data-start="1729.84" data-end="1736.559">The third thing I want to leave you with is I wanted to show you that these kind of things</span> <span data-start="1736.559" data-end="1744.36">can be, that interactions between these components and the ways in which you can use new frameworks</span> <span data-start="1744.36" data-end="1751.98">are super cool exciting and it's fun to think about it, and it's fun to break your on applications.</span> <span data-start="1751.98" data-end="1755.71">Next time you write code like this think about whether it could possibly be vulnerable to</span> <span data-start="1755.71" data-end="1759.84">one of the things I showed and overall this is just super fun.</span> <span data-start="1759.84" data-end="1765.679">I think it's almost as fun as HorseDrawingTycoon kind of game.</span> </p>
<p><span data-start="1765.679" data-end="1770.95">With this I will leave it to Curtis who has the next presentation about something that</span> <span data-start="1770.95" data-end="1772.25">I am sure you will not guess what it is.</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
