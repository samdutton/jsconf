<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MTtE_cyMSgE</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/MTtE_cyMSgE?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="17.35" data-end="19.72">yeah this is my personal subtitle of the</span> <span data-start="19.72" data-end="21.28">talk which is why you know give me one</span> <span data-start="21.28" data-end="25.63">point oh and it's kind of funny actually</span> <span data-start="25.63" data-end="28.54">because that subtitle is really sort of</span> <span data-start="28.54" data-end="30.76">the crux of the talk but before I go</span> <span data-start="30.76" data-end="32.95">into that I'm trailer Robbins I go by</span> <span data-start="32.95" data-end="34.989">the index zero on the Internet I started</span> <span data-start="34.989" data-end="36.85">a company called no jitsu with some guys</span> <span data-start="36.85" data-end="39.25">back there and that little seal there</span> <span data-start="39.25" data-end="41.53">everything is that we made this so and</span> <span data-start="41.53" data-end="43.39">when I say that no one point 0 is really</span> <span data-start="43.39" data-end="45.4">the crux of this talk is that it's just</span> <span data-start="45.4" data-end="47.44">what's the problem right how do you run</span> <span data-start="47.44" data-end="49.3">something in production that is by</span> <span data-start="49.3" data-end="52.239">definition unstable right like it's kind</span> <span data-start="52.239" data-end="53.86">of a it's a catch-22 right it's a</span> </p>
<p><span data-start="53.86" data-end="57.07">Occam's razor you know it's no good what</span> <span data-start="57.07" data-end="59.32">do you do let's start small right like</span> <span data-start="59.32" data-end="61.57">little things right you probably want to</span> <span data-start="61.57" data-end="65.11">be listening for errors so this is a</span> <span data-start="65.11" data-end="67.96">pretty common pattern but what the thing</span> <span data-start="67.96" data-end="69.67">is in a lot of this code that I see</span> <span data-start="69.67" data-end="72.13">people don't include the last line right</span> <span data-start="72.13" data-end="74.47">so they don't include process not exit</span> <span data-start="74.47" data-end="76.57">so that means that oh I've got something</span> <span data-start="76.57" data-end="77.83">went wrong and I'm just going to assume</span> <span data-start="77.83" data-end="80.02">that that things are fine and things</span> <span data-start="80.02" data-end="81.939">will fix themselves that's that's wrong</span> <span data-start="81.939" data-end="83.56">don't do that you're gonna you're going</span> <span data-start="83.56" data-end="86.5">to kick yourself later I think I could</span> <span data-start="86.5" data-end="88.539">name five off the top of my head your</span> </p>
<p><span data-start="88.539" data-end="90.969">HTTP parser is borked you know the</span> <span data-start="90.969" data-end="92.53">sockets are going to stay open when they</span> <span data-start="92.53" data-end="94.299">should be half closed like the list goes</span> <span data-start="94.299" data-end="96.24">on just don't do this use this snippet</span> <span data-start="96.24" data-end="99.009">log your log things somewhere if you're</span> <span data-start="99.009" data-end="100.75">really good you can log it in database</span> <span data-start="100.75" data-end="104.439">so you know grey log 2 we use log liat</span> <span data-start="104.439" data-end="106.719">no jitsu it's great service hoptoad I</span> <span data-start="106.719" data-end="109.479">know people use that too and you know</span> <span data-start="109.479" data-end="110.829">when I talk about listening for errors</span> <span data-start="110.829" data-end="113.2">you really gotta listen for errors like</span> <span data-start="113.2" data-end="115">all of them even the ones that aren't</span> <span data-start="115" data-end="117.399">documented as errors and this is a great</span> <span data-start="117.399" data-end="120.369">little snippet this will get you so this</span> <span data-start="120.369" data-end="121.329">is we're going to make an outgoing</span> <span data-start="121.329" data-end="123.399">request to google com really really</span> <span data-start="123.399" data-end="125.409">simple straightforward stuff and the</span> </p>
<p><span data-start="125.409" data-end="127.149">HTTP module is going to return us a</span> <span data-start="127.149" data-end="129.52">request and that request actually throws</span> <span data-start="129.52" data-end="131.35">an error event if something goes wrong</span> <span data-start="131.35" data-end="134.319">in the inner socket and that little code</span> <span data-start="134.319" data-end="135.7">line on the bottom is where this error</span> <span data-start="135.7" data-end="137.2">gets thrown and you can read through</span> <span data-start="137.2" data-end="139.51">that if you're really interested but if</span> <span data-start="139.51" data-end="141.43">you don't catch this error your apps</span> <span data-start="141.43" data-end="143.37">just going to crash for no good reason</span> <span data-start="143.37" data-end="146.11">so you want to look at where the error</span> <span data-start="146.11" data-end="147.94">events are you want to read the docs and</span> <span data-start="147.94" data-end="149.59">see what</span> <span data-start="149.59" data-end="151.66">aventa meters throw the error event and</span> <span data-start="151.66" data-end="154.03">this little you know string error is</span> <span data-start="154.03" data-end="156.91">significant in that anytime you emit</span> <span data-start="156.91" data-end="159.58">error if it's not trapped it's going to</span> <span data-start="159.58" data-end="161.56">get thrown as a process unhandled</span> <span data-start="161.56" data-end="162.7">exception error so it's going to</span> <span data-start="162.7" data-end="164.2">escalate immediately to exiting your</span> <span data-start="164.2" data-end="166.569">process which obviously is something</span> <span data-start="166.569" data-end="168.4">that you don't want to do I mean you</span> <span data-start="168.4" data-end="169.66">want to keep your process running as</span> <span data-start="169.66" data-end="174.459">long as you can so that everyone get</span> <span data-start="174.459" data-end="175.989">that we got eighty percent of people</span> <span data-start="175.989" data-end="177.76">using your prodding this before it's old</span> <span data-start="177.76" data-end="180.549">news another one is that you know I</span> <span data-start="180.549" data-end="183.28">mentioned events and a vented I oh I'm</span> <span data-start="183.28" data-end="185.59">sure that's come up a lot and you need</span> <span data-start="185.59" data-end="187.66">to watch for these things right this is</span> <span data-start="187.66" data-end="190.45">a we rent run and maintain a project</span> <span data-start="190.45" data-end="193.09">called node HTTP proxy which is a basic</span> <span data-start="193.09" data-end="194.95">straightforward reverse proxy written in</span> <span data-start="194.95" data-end="196.9">node it's pretty fast you know it</span> <span data-start="196.9" data-end="198.61">competes with things that are like NC</span> <span data-start="198.61" data-end="200.049">which is kind of whole point of node</span> <span data-start="200.049" data-end="203.5">itself but this was a fun bug defined</span> <span data-start="203.5" data-end="205.299">which is that you know the event in</span> <span data-start="205.299" data-end="207.31">meters we're getting more listeners</span> <span data-start="207.31" data-end="209.29">every time so there was some sort of</span> <span data-start="209.29" data-end="212.29">weak in my event emitter listener and</span> <span data-start="212.29" data-end="214.239">that's can be a real problem i mean</span> <span data-start="214.239" data-end="216.1">let's look at this code sample right so</span> </p>
<p><span data-start="216.1" data-end="218.23">I've got the events module I'm going to</span> <span data-start="218.23" data-end="221.019">require that and then I'm gonna you know</span> <span data-start="221.019" data-end="222.549">do something right and when I do</span> <span data-start="222.549" data-end="224.709">something i'm going to say you know</span> <span data-start="224.709" data-end="227.079">return event emitter and later on and</span> <span data-start="227.079" data-end="229.03">MIT the done event and this is a pattern</span> <span data-start="229.03" data-end="231.299">you see all over the node code base that</span> <span data-start="231.299" data-end="234.01">HTTP example that i was going through</span> <span data-start="234.01" data-end="237.45">earlier was pretty much the same thing</span> <span data-start="237.45" data-end="240.01">but the problem is is that this done</span> <span data-start="240.01" data-end="242.919">event only gets emitted once right so</span> <span data-start="242.919" data-end="246.31">why would you use the first block which</span> <span data-start="246.31" data-end="248.319">says hey I want to listen to this done</span> <span data-start="248.319" data-end="251.109">event in perpetuity in that there could</span> <span data-start="251.109" data-end="253.06">be many done events being emitted from</span> <span data-start="253.06" data-end="255.989">this particular event emitter over time</span> <span data-start="255.989" data-end="259.45">versus I know as a user that this</span> <span data-start="259.45" data-end="261.01">particular event emitter is only going</span> <span data-start="261.01" data-end="263.41">to vit the done event once so I should</span> <span data-start="263.41" data-end="266.349">use that once which will remove the</span> <span data-start="266.349" data-end="268.539">event handler once the event has fired</span> <span data-start="268.539" data-end="271.21">the first time and you know you ask</span> <span data-start="271.21" data-end="272.8">yourself well this doesn't really matter</span> <span data-start="272.8" data-end="274.45">right you know I'll just have latent</span> <span data-start="274.45" data-end="276.61">event two meters or you know event</span> <span data-start="276.61" data-end="279.099">handlers around problem is as garbage</span> <span data-start="279.099" data-end="280.78">collection in long running processes</span> <span data-start="280.78" data-end="283.18">because if you actually have some</span> <span data-start="283.18" data-end="286.15">thing in the event handler that's</span> <span data-start="286.15" data-end="287.949">outside of the original closure scope</span> <span data-start="287.949" data-end="289.21">that you would have wanted to get</span> <span data-start="289.21" data-end="291.94">garbage collected if that event emitter</span> <span data-start="291.94" data-end="293.919">or throw that event handler for that</span> <span data-start="293.919" data-end="296.56">particular emitter is not removed then</span> <span data-start="296.56" data-end="298.03">that function is still around and it</span> <span data-start="298.03" data-end="300.039">needs to maintain that reference over</span> <span data-start="300.039" data-end="302.59">time and this can be really tricky and</span> <span data-start="302.59" data-end="306.07">hard to debug so just be aware that over</span> <span data-start="306.07" data-end="307.81">time you should just be as conservative</span> <span data-start="307.81" data-end="309.55">as you can about listening to events and</span> <span data-start="309.55" data-end="314.289">adding functional listeners so use a</span> <span data-start="314.289" data-end="317.71">process monitor upstart monett I wrote</span> <span data-start="317.71" data-end="319.75">this thing called forever I'm going to</span> <span data-start="319.75" data-end="321.34">walk through a little example of it it's</span> <span data-start="321.34" data-end="323.59">all written a note I've gotten some some</span> <span data-start="323.59" data-end="325.63">crap for you know reinventing the wheel</span> <span data-start="325.63" data-end="327.91">but I like this to a lot that's what</span> <span data-start="327.91" data-end="330.669">kind of why I wrote it right so let me</span> <span data-start="330.669" data-end="336.52">grab my tool and so let's imagine that</span> <span data-start="336.52" data-end="339.43">my resolution was terrible and i need to</span> <span data-start="339.43" data-end="346.509">change it Oh back to the back to the</span> <span data-start="346.509" data-end="352.409">monitor problem 1024 x 768 no that's</span> <span data-start="352.409" data-end="356.74">that's the right size oh well we'll do a</span> <span data-start="356.74" data-end="362.32">live sorry about this guy's this is just</span> <span data-start="362.32" data-end="369.29">the wrong size</span> <span data-start="369.3" data-end="372.79">let's try this one this one looks better</span> <span data-start="372.79" data-end="381.04">yeah here we go okay cool so I'm gonna</span> <span data-start="381.04" data-end="386.95">jump into the project and I actually</span> <span data-start="386.95" data-end="389.83">have it open over here and it's a good</span> <span data-start="389.83" data-end="392.65">little sample of some of the just you</span> <span data-start="392.65" data-end="394.33">know simple code samples under this</span> <span data-start="394.33" data-end="396.88">examples library that I use to say hey</span> <span data-start="396.88" data-end="398.71">what are the common cases that people</span> <span data-start="398.71" data-end="401.23">are going to do and how can we prevent</span> <span data-start="401.23" data-end="403.66">against those things miss behaving badly</span> <span data-start="403.66" data-end="406.75">even when you accept the concept of user</span> <span data-start="406.75" data-end="409.12">error so things like you know just</span> <span data-start="409.12" data-end="410.74">always throw I mean what happens when I</span> <span data-start="410.74" data-end="412.42">just run a process that always throws an</span> <span data-start="412.42" data-end="413.77">exception right that's probably not a</span> <span data-start="413.77" data-end="416.95">not a good thing to write or in this</span> <span data-start="416.95" data-end="419.11">case this is probably the simplest hello</span> <span data-start="419.11" data-end="420.82">world app that you're ever going to see</span> <span data-start="420.82" data-end="422.89">a node right we grab something from the</span> <span data-start="422.89" data-end="424.72">command line we create a server we</span> <span data-start="424.72" data-end="426.85">listened on the specified port we write</span> <span data-start="426.85" data-end="428.68">something really really straightforward</span> <span data-start="428.68" data-end="430.9">stuff and what happens what I want to</span> <span data-start="430.9" data-end="432.22">run that kind of forever right so</span> <span data-start="432.22" data-end="436.21">forever start examples server and I can</span> <span data-start="436.21" data-end="437.74">continue to pass command-line options</span> <span data-start="437.74" data-end="440.41">through forever tooth child process and</span> <span data-start="440.41" data-end="441.85">so here I'm going to tell it to listen</span> <span data-start="441.85" data-end="444.82">on 80 80 and so you know forever saw</span> <span data-start="444.82" data-end="448.3">that process that script and now I can't</span> <span data-start="448.3" data-end="450.88">fight and tight we can see that that guy</span> <span data-start="450.88" data-end="454.6">is running we can see that it has to pee</span> </p>
<p><span data-start="454.6" data-end="456.13">IDs right so this is going to start up a</span> <span data-start="456.13" data-end="458.5">forever process and to monitor the child</span> <span data-start="458.5" data-end="460.6">process that it starts for you and in</span> <span data-start="460.6" data-end="461.98">that case the significant one is that</span> <span data-start="461.98" data-end="463.54">the first one is the child process</span> <span data-start="463.54" data-end="465.49">second one is the forever process so if</span> </p>
<p><span data-start="465.49" data-end="471.76">I kill 1925 now I have a new process all</span> <span data-start="471.76" data-end="473.8">right restart it for me and you can see</span> <span data-start="473.8" data-end="475.99">that the uptime on the left there has</span> <span data-start="475.99" data-end="477.82">been reset so it will just keep going</span> <span data-start="477.82" data-end="479.59">forever it's kind of a whole point and I</span> <span data-start="479.59" data-end="483.25">can stop it right and now it's not there</span> <span data-start="483.25" data-end="487.36">anymore so this is useful I really enjoy</span> <span data-start="487.36" data-end="488.95">using it and we actually have some other</span> <span data-start="488.95" data-end="490.24">tools at nerd Jitsu that we're going to</span> <span data-start="490.24" data-end="492.36">be talking about on thursday at no time</span> <span data-start="492.36" data-end="496.11">that this play is really nice with so</span> <span data-start="496.11" data-end="500.039">back to the talk which way is it this</span> <span data-start="500.039" data-end="506.819">way there we go so listen forevers use</span> <span data-start="506.819" data-end="509.099">process monitor great the next one</span> <span data-start="509.099" data-end="510.569">really is you want stabilize your</span> <span data-start="510.569" data-end="513.14">dependencies I think this is sort of a</span> <span data-start="513.14" data-end="515.519">catch-22 of the node community that a</span> <span data-start="515.519" data-end="517.86">lot of people who are new to know don't</span> <span data-start="517.86" data-end="519.839">necessarily pick up on immediately think</span> <span data-start="519.839" data-end="521.43">there are a lot of modules out there and</span> <span data-start="521.43" data-end="522.81">that is at the same time a great thing</span> <span data-start="522.81" data-end="524.7">but also kind of bad things you need to</span> <span data-start="524.7" data-end="526.14">know which ones are good who's</span> <span data-start="526.14" data-end="527.7">contributing a lot who's writing these</span> <span data-start="527.7" data-end="530.31">things and also just include them in</span> <span data-start="530.31" data-end="533.88">your package JSON files this is one of</span> <span data-start="533.88" data-end="535.709">the ones that I love to find in people's</span> <span data-start="535.709" data-end="537.269">production environments right you just</span> <span data-start="537.269" data-end="539.69">forgot to install this particular</span> <span data-start="539.69" data-end="543.54">dependency on that box and now it's not</span> <span data-start="543.54" data-end="545.31">there so how do you solve that problem</span> <span data-start="545.31" data-end="547.709">if you're not diligent about reading</span> <span data-start="547.709" data-end="549.839">through your own code and finding your</span> <span data-start="549.839" data-end="551.91">dependencies beforehand before you</span> <span data-start="551.91" data-end="555.48">deploy and in this case I wrote another</span> <span data-start="555.48" data-end="557.94">tool to do this and it's called the</span> <span data-start="557.94" data-end="559.62">required analyzer and it will do it for</span> <span data-start="559.62" data-end="563.13">you so let's walk through that again in</span> <span data-start="563.13" data-end="565.649">another small sample so in this case</span> <span data-start="565.649" data-end="570.959">let's just run it on forever so when I</span> <span data-start="570.959" data-end="572.79">talk about package.json files I mean I</span> <span data-start="572.79" data-end="575.339">kind of assumed everybody seen one but</span> <span data-start="575.339" data-end="577.829">here's the forever package.json so it's</span> <span data-start="577.829" data-end="580.019">got some repository some keywords and</span> <span data-start="580.019" data-end="582.39">some dependencies right so a bunch of</span> <span data-start="582.39" data-end="584.279">dependencies in here I've maintained</span> <span data-start="584.279" data-end="586.86">this myself but let's just kill those we</span> <span data-start="586.86" data-end="588.48">don't want those anymore we're just no</span> <span data-start="588.48" data-end="589.649">dependencies there's going to be a bad</span> <span data-start="589.649" data-end="592.92">application developer but now I'm just</span> <span data-start="592.92" data-end="598.47">going to find them again so it's going</span> <span data-start="598.47" data-end="600.63">to analyze the raw dependencies find</span> <span data-start="600.63" data-end="602.699">them for me and find a subset of them</span> <span data-start="602.699" data-end="604.019">because right now it's only going to be</span> <span data-start="604.019" data-end="607.339">looking at the package.json for my main</span> <span data-start="607.339" data-end="611.98">property so</span> <span data-start="611.98" data-end="614.56">when I say that I mean main right here</span> <span data-start="614.56" data-end="617.02">as in it's actually kind of a fun tool</span> <span data-start="617.02" data-end="618.76">to read through because what it actually</span> <span data-start="618.76" data-end="621.01">does it goes out and it spawns off a</span> <span data-start="621.01" data-end="627.13">child process for my mouse it's always</span> <span data-start="627.13" data-end="633.15">lost it spawns off a child process for</span> <span data-start="633.15" data-end="636.79">this and this is actually really simple</span> <span data-start="636.79" data-end="638.71">a little file all it does is it kind of</span> <span data-start="638.71" data-end="642.94">monkey patches the internal module load</span> <span data-start="642.94" data-end="645.04">inside of a node.js and then outputs</span> <span data-start="645.04" data-end="646.6">everything that goes into your require</span> <span data-start="646.6" data-end="648.49">statements and processes those and</span> <span data-start="648.49" data-end="650.92">analyzes them later obviously you would</span> <span data-start="650.92" data-end="652.06">never want to include this code in</span> <span data-start="652.06" data-end="653.56">production which is why it spawns it as</span> <span data-start="653.56" data-end="655.06">a child process to keep everything in</span> <span data-start="655.06" data-end="657.16">isolation and then it just sort of reads</span> <span data-start="657.16" data-end="658.9">through and says oh well what's I 9pm</span> <span data-start="658.9" data-end="661.18">what's a local file and then just build</span> <span data-start="661.18" data-end="662.08">that out right it back to your</span> <span data-start="662.08" data-end="664.27">package.json so in this case we go back</span> <span data-start="664.27" data-end="666.4">to the forever package.json we see we</span> <span data-start="666.4" data-end="668.08">have some dependencies in here now I</span> <span data-start="668.08" data-end="671.29">actually want to keep by a long list so</span> </p>
<p><span data-start="671.29" data-end="680.26">I'll keep those so this is a little</span> <span data-start="680.26" data-end="681.64">thing I mentioned at the beginning of my</span> <span data-start="681.64" data-end="683.02">talk but we're actually be pushing this</span> <span data-start="683.02" data-end="684.64">out to all the projects that we use and</span> <span data-start="684.64" data-end="686.62">maintain in production and no jitsu so</span> <span data-start="686.62" data-end="688.15">if you look for this seal like we're on</span> <span data-start="688.15" data-end="689.77">top of it I kind of have a reputation</span> <span data-start="689.77" data-end="693.07">for not sleeping and it's true I all I</span> <span data-start="693.07" data-end="697.17">do is work so if it's broken I'll fix it</span> <span data-start="697.17" data-end="700.72">the next kind of big catch-22 in node is</span> <span data-start="700.72" data-end="703">that people don't really structure their</span> <span data-start="703" data-end="704.41">code at all or there is just no</span> <span data-start="704.41" data-end="707.68">convention commonly accepted that is the</span> <span data-start="707.68" data-end="709.51">right way to structure your code so this</span> <span data-start="709.51" data-end="711.1">is a pretty common example of how I</span> <span data-start="711.1" data-end="713.32">choose to structure my code but you</span> <span data-start="713.32" data-end="715.12">should just pick something and stick to</span> <span data-start="715.12" data-end="717.94">it so here you've got you know bin is</span> <span data-start="717.94" data-end="720.55">basically all of your runtime files I've</span> <span data-start="720.55" data-end="722.11">got some configuration probably with</span> <span data-start="722.11" data-end="724.78">environments and then you know under lib</span> <span data-start="724.78" data-end="726.73">is all of your app code and I typically</span> <span data-start="726.73" data-end="728.32">will have another folder underneath that</span> <span data-start="728.32" data-end="730.99">called you know app name and then app</span> <span data-start="730.99" data-end="733.69">name Jas and just to name space those</span> <span data-start="733.69" data-end="736.21">things a little bit nicer and then some</span> <span data-start="736.21" data-end="738.7">public static files and some tests</span> <span data-start="738.7" data-end="741.61">similarly named spaced vendor I guess</span> <span data-start="741.61" data-end="742.9">that's probably a draw over from the</span> </p>
<p><span data-start="742.9" data-end="745.42">Ruby days of various gets</span> <span data-start="745.42" data-end="747.67">modules that you can't get through NPM</span> <span data-start="747.67" data-end="750.16">and you'll you'll thank me when you</span> <span data-start="750.16" data-end="751.93">start running big apps in production and</span> <span data-start="751.93" data-end="754.06">you actually use a code template at all</span> <span data-start="754.06" data-end="756.34">because I've seen way too many Express</span> <span data-start="756.34" data-end="757.9">applications that just have one giant</span> <span data-start="757.9" data-end="760.33">server file and it's it's really</span> <span data-start="760.33" data-end="765.13">annoying to debug so lastly here is</span> <span data-start="765.13" data-end="767.77">decide on a network architecture and by</span> <span data-start="767.77" data-end="769.87">that I really mean you know to proxy or</span> <span data-start="769.87" data-end="772.15">not to proxy that is the question and</span> <span data-start="772.15" data-end="773.92">you're probably looking at me like what</span> <span data-start="773.92" data-end="776.8">is he talking about so the first option</span> <span data-start="776.8" data-end="778.27">here is that you can share a file</span> <span data-start="778.27" data-end="780.61">descriptor between multiple servers and</span> <span data-start="780.61" data-end="783.34">this is actually written into a library</span> <span data-start="783.34" data-end="786.85">that I like called cluster and what it</span> <span data-start="786.85" data-end="788.23">does is that it essentially says okay</span> <span data-start="788.23" data-end="790.18">i'm going to start up as a server then</span> <span data-start="790.18" data-end="791.62">i'm going to make a file descriptor that</span> <span data-start="791.62" data-end="793.09">represents a eunuch socket for a</span> <span data-start="793.09" data-end="794.8">particular port and then i'm going to</span> <span data-start="794.8" data-end="797.35">spawn up a bunch of children that's the</span> <span data-start="797.35" data-end="799.06">second code sample here and i'm going to</span> <span data-start="799.06" data-end="801.31">pass them those file descriptors and</span> <span data-start="801.31" data-end="803.17">tell them hey you should use this file</span> <span data-start="803.17" data-end="806.95">descriptor for your STD of course the</span> <span data-start="806.95" data-end="808.69">second option here this doesn't scale</span> <span data-start="808.69" data-end="810.16">horizontally right you can only do this</span> <span data-start="810.16" data-end="812.65">on a single machine the second option if</span> <span data-start="812.65" data-end="814.27">you're ever going to do any sort of</span> <span data-start="814.27" data-end="816.76">horizontal scaling is to use a</span> <span data-start="816.76" data-end="820.09">round-robin proxy and a forward HTTP</span> <span data-start="820.09" data-end="822.1">proxy which is what we do at no jitsu</span> <span data-start="822.1" data-end="825.13">because we scale out your application to</span> <span data-start="825.13" data-end="826.84">a bunch of small machines and then we</span> <span data-start="826.84" data-end="828.82">basically do a variant of simple</span> <span data-start="828.82" data-end="830.98">round-robin proxying pretty much like</span> <span data-start="830.98" data-end="833.41">this so you can see up there we have two</span> </p>
<p><span data-start="833.41" data-end="835.93">IP addresses and the port's that they're</span> <span data-start="835.93" data-end="838.03">listening on and then we create a proxy</span> <span data-start="838.03" data-end="840.4">server and we just say hey grab the next</span> <span data-start="840.4" data-end="843.13">address proxy to the target a pen that</span> <span data-start="843.13" data-end="845.35">to the end of the list rinse repeat just</span> <span data-start="845.35" data-end="847.3">keep doing that so you can start up your</span> <span data-start="847.3" data-end="849.4">application on different ports on the</span> <span data-start="849.4" data-end="850.69">same machine and then just round-robin</span> <span data-start="850.69" data-end="854.23">proxy between them so i think i actually</span> <span data-start="854.23" data-end="855.85">have a couple of minutes to take some</span> <span data-start="855.85" data-end="867.079">questions so anybody yeah</span> </p>
<p><span data-start="867.089" data-end="869.059">Oh</span> <span data-start="869.059" data-end="871.189">so the things that it misses right now</span> <span data-start="871.189" data-end="872.499">and the thing is is that it has a</span> <span data-start="872.499" data-end="875.329">full-fledged API in code that you could</span> <span data-start="875.329" data-end="877.579">find those for but right now the CLI</span> <span data-start="877.579" data-end="879.589">tool just looks for the main property in</span> <span data-start="879.589" data-end="881.659">the package.json so if you have bin</span> <span data-start="881.659" data-end="883.099">scripts that have dependencies that</span> <span data-start="883.099" data-end="885.799">aren't referenced by your individual</span> <span data-start="885.799" data-end="888.289">main library it's going to miss those if</span> <span data-start="888.289" data-end="890.389">you have test dependencies that it's</span> <span data-start="890.389" data-end="892.249">missing but I'm going to probably adding</span> <span data-start="892.249" data-end="893.869">that in the next week or two of you know</span> <span data-start="893.869" data-end="895.849">just add extra properties look at those</span> <span data-start="895.849" data-end="909.06">files run them that kind of stuff</span> <span data-start="909.07" data-end="911.54">yeah I mean that's a good point you know</span> </p>
<p><span data-start="911.54" data-end="913.76">I've seen some other libraries there was</span> <span data-start="913.76" data-end="916.37">another require analyzer that I saw that</span> <span data-start="916.37" data-end="918.44">was just written so ridiculously poorly</span> <span data-start="918.44" data-end="921.17">that I had compelled to write it</span> <span data-start="921.17" data-end="923.51">correctly and you know the main reason</span> <span data-start="923.51" data-end="925.58">there that wife was written report is</span> <span data-start="925.58" data-end="927.38">that all of the interesting code was</span> <span data-start="927.38" data-end="929.15">under their bin folder so there was</span> <span data-start="929.15" data-end="930.95">absolutely no opportunity for you as a</span> <span data-start="930.95" data-end="933.16">developer to use that programmatically</span> <span data-start="933.16" data-end="936.71">and so if I I didn't jump on the network</span> <span data-start="936.71" data-end="937.97">because I don't feel like getting pooped</span> <span data-start="937.97" data-end="940.76">on on Twitter so I don't have any</span> <span data-start="940.76" data-end="943.19">internet right now but I would jump to</span> <span data-start="943.19" data-end="944.78">the project page and show you some of</span> <span data-start="944.78" data-end="946.46">those samples but again both of these</span> <span data-start="946.46" data-end="948.02">projects they're on my github there on</span> <span data-start="948.02" data-end="950.15">the ninjutsu github so check those out</span> <span data-start="950.15" data-end="952.31">open an issue I usually respond to the</span> <span data-start="952.31" data-end="964.7">same day</span> <span data-start="964.71" data-end="966.64">you know that's that's a good question</span> <span data-start="966.64" data-end="970.72">it's it's a question that we answer</span> <span data-start="970.72" data-end="972.19">differently at no jitsu I think than</span> <span data-start="972.19" data-end="974.95">most people because we write 75% of all</span> <span data-start="974.95" data-end="976.27">the libraries that we use in production</span> <span data-start="976.27" data-end="978.97">but generally you probably want to have</span> <span data-start="978.97" data-end="981.22">some upper bound or instead of just</span> <span data-start="981.22" data-end="982.45">having an upper bound just have a</span> <span data-start="982.45" data-end="984.52">straight equals and then you can track</span> <span data-start="984.52" data-end="986.05">those and manage those yourself as you</span> <span data-start="986.05" data-end="989.05">go up but honestly for sort of where</span> <span data-start="989.05" data-end="990.61">nodes maturity is going back to the</span> <span data-start="990.61" data-end="993.01">subtitle of this talk overall you should</span> <span data-start="993.01" data-end="995.41">be looking at the packages watching the</span> <span data-start="995.41" data-end="998.47">commits like as Michael Rogers one of</span> <span data-start="998.47" data-end="1000.66">the organizers of note comp and Jas comp</span> <span data-start="1000.66" data-end="1002.67">says that note is the first technology</span> <span data-start="1002.67" data-end="1004.41">to grow up in a post github age and</span> <span data-start="1004.41" data-end="1006.48">that's really made a lot of difference</span> <span data-start="1006.48" data-end="1007.83">like you should be using it you should</span> <span data-start="1007.83" data-end="1010.38">be following people that's how I stay up</span> <span data-start="1010.38" data-end="1012.21">with things and it's really become a</span> <span data-start="1012.21" data-end="1017.07">necessity at this point all right thank</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
