<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>E0w7Tc0f2fA</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/E0w7Tc0f2fA?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="0.11" data-end="5.16">hello Cascadia welcome to the N API</span> <span data-start="5.16" data-end="7.98">session my name is Etta Shea and I'm a</span> <span data-start="7.98" data-end="11.13">developer at Adobe I'm here today to get</span> <span data-start="11.13" data-end="13.139">you all excited about writing native</span> <span data-start="13.139" data-end="16.32">modules in no js' in building</span> <span data-start="16.32" data-end="18.539">functionality that would bridge the</span> <span data-start="18.539" data-end="21.72">grand old C++ language with the modern</span> <span data-start="21.72" data-end="28.05">the hip the class II JavaScript a few</span> <span data-start="28.05" data-end="31.199">tidbits about me I work in San Francisco</span> <span data-start="31.199" data-end="34.2">and I am co-located with most of the</span> <span data-start="34.2" data-end="43.23">former flash team here's a view of this</span> </p>
<p><span data-start="43.23" data-end="46.219">San Francisco skyline right from my desk</span> <span data-start="46.219" data-end="48.6">over the years I've worked with a</span> <span data-start="48.6" data-end="51.18">variety of technology stacks I've worked</span> <span data-start="51.18" data-end="53.239">on flagship desktop applications</span> <span data-start="53.239" data-end="55.949">award-winning mobile software but my</span> <span data-start="55.949" data-end="58.739">heart still lies with the vamp the first</span> <span data-start="58.739" data-end="61.079">website that I worked on was all in</span> <span data-start="61.079" data-end="63.87">flash and the lamp stack we cared a lot</span> <span data-start="63.87" data-end="69.27">about ie6 back then over time I have</span> <span data-start="69.27" data-end="72.049">moved on and covered up the HTML</span> <span data-start="72.049" data-end="75.509">progression with that I've been</span> <span data-start="75.509" data-end="76.74">rewriting my website</span> <span data-start="76.74" data-end="78.9">the latest rewrite happened just a month</span> <span data-start="78.9" data-end="81.57">ago when I moved off bootstrap on to CSS</span> <span data-start="81.57" data-end="86.759">grid and Adobe I work on a background</span> <span data-start="86.759" data-end="89.34">process this process synchronizes all</span> <span data-start="89.34" data-end="91.38">the network i/o that adobe applications</span> <span data-start="91.38" data-end="93.03">due to the cloud</span> <span data-start="93.03" data-end="95.28">since it is i/o heavy the best</span> <span data-start="95.28" data-end="97.829">technology to write this in is no js'</span> <span data-start="97.829" data-end="101.13">and adobe this ship a node.js based</span> <span data-start="101.13" data-end="103.56">process a node.js based background</span> <span data-start="103.56" data-end="105.899">process to millions of customers that</span> <span data-start="105.899" data-end="107.82">run our products if you've used</span> </p>
<p><span data-start="107.82" data-end="109.829">Photoshop in the last three four years</span> <span data-start="109.829" data-end="111.45">you would have interacted with this</span> <span data-start="111.45" data-end="114.63">process in the background since we</span> <span data-start="114.63" data-end="115.92">shipped to a variety of machine</span> <span data-start="115.92" data-end="118.53">configurations and node.js is really</span> <span data-start="118.53" data-end="121.11">built for the server side there are some</span> <span data-start="121.11" data-end="123.329">issues that node doesn't solve and for</span> <span data-start="123.329" data-end="125.25">that we need to go down to the native</span> <span data-start="125.25" data-end="128.129">layer and to go down to the native layer</span> <span data-start="128.129" data-end="132.18">means working in C++ I am the go-to guy</span> <span data-start="132.18" data-end="133.379">in my team to</span> <span data-start="133.379" data-end="137.579">with C++ and I've been doing it for the</span> <span data-start="137.579" data-end="140.31">last three years in this talk today</span> <span data-start="140.31" data-end="142.98">we'll talk about why we should write or</span> <span data-start="142.98" data-end="145.739">when we should write native code we will</span> <span data-start="145.739" data-end="147.659">talk about the various ways to interact</span> <span data-start="147.659" data-end="152.159">with native code from Vidin nodejs we</span> <span data-start="152.159" data-end="154.409">will go through a running example of a n</span> <span data-start="154.409" data-end="158.31">a n n API based plugin to node.js a</span> <span data-start="158.31" data-end="161.37">module that looks like JavaScript but is</span> <span data-start="161.37" data-end="164.34">written in C++ we will do a synchronous</span> <span data-start="164.34" data-end="167.069">asynchronous version as well and then</span> <span data-start="167.069" data-end="168.75">we'll be also running it in electron</span> </p>
<p><span data-start="168.75" data-end="171.359">I'll share some tips and tricks to be</span> <span data-start="171.359" data-end="173.549">successful in the native world and leave</span> <span data-start="173.549" data-end="175.98">you all with a bunch of resources to</span> <span data-start="175.98" data-end="177.659">play with at the end of the conference</span> <span data-start="177.659" data-end="181.349">as JavaScript developers we are like</span> <span data-start="181.349" data-end="184.739">astronauts we fly in the space and don't</span> <span data-start="184.739" data-end="187.26">really care about what happens down at</span> <span data-start="187.26" data-end="192.18">the mother earth actually sometimes we</span> <span data-start="192.18" data-end="194.639">do have to sometimes each Iowa script</span> <span data-start="194.639" data-end="196.65">developers do have to go down a layer</span> <span data-start="196.65" data-end="200.09">into the world of unmanaged memory of</span> <span data-start="200.09" data-end="203.459">multi-threaded architectures and my</span> <span data-start="203.459" data-end="210.9">favorite segmentation faults this what</span> <span data-start="210.9" data-end="212.459">let me talk about what this talk is not</span> <span data-start="212.459" data-end="217.169">about this talk is not about the v8</span> <span data-start="217.169" data-end="219.209">engine the engine that's used to build</span> <span data-start="219.209" data-end="221.94">node.js we will not be going into the v8</span> <span data-start="221.94" data-end="223.65">internals or learning how it works</span> <span data-start="223.65" data-end="226.829">this talk is also not about the C++</span> <span data-start="226.829" data-end="228.659">programming language why we will be</span> <span data-start="228.659" data-end="231.03">using C++ there are better ways to learn</span> </p>
<p><span data-start="231.03" data-end="235.59">C++ this talk is also not about</span> <span data-start="235.59" data-end="237.449">improving the performance of your node</span> <span data-start="237.449" data-end="239.84">based application frankly speaking</span> <span data-start="239.84" data-end="242.43">poorly written native code would be a</span> <span data-start="242.43" data-end="244.439">lot worse than average JavaScript code</span> <span data-start="244.439" data-end="249.989">it would crash your app what this talk</span> <span data-start="249.989" data-end="252.09">is really about is about building</span> <span data-start="252.09" data-end="254.34">modules it's about extending the node</span> <span data-start="254.34" data-end="256.409">ecosystem with the functionality that</span> <span data-start="256.409" data-end="258.209">was not practically or efficiently</span> <span data-start="258.209" data-end="260.13">possible with the current state of</span> </p>
<p><span data-start="260.13" data-end="262.68">JavaScript it's about writing a module</span> <span data-start="262.68" data-end="265.38">that looks and behaves just like any</span> <span data-start="265.38" data-end="266.78">other module in the node</span> <span data-start="266.78" data-end="268.79">ecosystem but in from the insight is</span> <span data-start="268.79" data-end="274.19">written in a very different way so let's</span> <span data-start="274.19" data-end="276.56">get started why would we write native</span> <span data-start="276.56" data-end="278.69">code that's a big question that comes up</span> <span data-start="278.69" data-end="280.46">whenever we talk about native code</span> <span data-start="280.46" data-end="284.78">javascript has everything well there are</span> <span data-start="284.78" data-end="287.21">a few things that make JavaScript</span> <span data-start="287.21" data-end="289.63">slightly difficult to write for example</span> <span data-start="289.63" data-end="293.54">your OSS are mostly written in C C++ or</span> <span data-start="293.54" data-end="295.34">expose their functionality in those</span> <span data-start="295.34" data-end="297.8">languages something new came out the</span> <span data-start="297.8" data-end="300.47">dark mode in Mohave what do you do do</span> <span data-start="300.47" data-end="302.24">you wait for it to be standardized to</span> <span data-start="302.24" data-end="305.18">use it in a node app you could directly</span> <span data-start="305.18" data-end="308.33">include it for in C++ in electron you</span> <span data-start="308.33" data-end="310.52">could write C++ code to read the current</span> <span data-start="310.52" data-end="312.47">state or the dark mode and show it to</span> <span data-start="312.47" data-end="313.69">the user</span> <span data-start="313.69" data-end="316.04">the second big reason to write native</span> <span data-start="316.04" data-end="318.8">code is if you have some C++ code lying</span> <span data-start="318.8" data-end="322.84">around C++ is a thirty-year-old</span> <span data-start="322.84" data-end="326.21">developed very values language we have</span> <span data-start="326.21" data-end="328.46">tons of production ready code in C++ and</span> <span data-start="328.46" data-end="331.72">not all of that compiles to webassembly</span> <span data-start="331.72" data-end="334.76">so kind we are kind of forced if you</span> <span data-start="334.76" data-end="335.9">want to do you want to rewrite</span> <span data-start="335.9" data-end="338.39">everything in jeaious or maybe just for</span> <span data-start="338.39" data-end="340.13">this case let's use what we have and</span> <span data-start="340.13" data-end="342.169">that is a very good use case for going</span> <span data-start="342.169" data-end="345.979">down native another important case where</span> <span data-start="345.979" data-end="347.69">we actually have to go down native is</span> <span data-start="347.69" data-end="351.41">when we need to crunch numbers now</span> <span data-start="351.41" data-end="353.27">javascript is the best language for</span> <span data-start="353.27" data-end="355.46">doing i/o if you have to communicate</span> <span data-start="355.46" data-end="357.35">over the network or file system is your</span> <span data-start="357.35" data-end="359.51">main mode of communication right yes</span> <span data-start="359.51" data-end="362.9">don't go native but then if you have to</span> <span data-start="362.9" data-end="364.85">do heavy number crunching something that</span> <span data-start="364.85" data-end="367.85">would burn the CPU hot it's better to go</span> <span data-start="367.85" data-end="370.1">down to the native layer you'll save</span> <span data-start="370.1" data-end="374.539">quite a lot of dollars in summary the</span> <span data-start="374.539" data-end="376.58">only reason to write native code is that</span> <span data-start="376.58" data-end="379.4">we are not JavaScript developers we are</span> <span data-start="379.4" data-end="381.77">solution providers to a problem and we</span> <span data-start="381.77" data-end="382.76">are building race cars</span> <span data-start="382.76" data-end="385.64">we love the metal too much but then in a</span> <span data-start="385.64" data-end="387.979">race car we do need some plastic we do</span> <span data-start="387.979" data-end="391.28">need some rubber and therefore to build</span> <span data-start="391.28" data-end="395.69">a race car let's assemble everything so</span> <span data-start="395.69" data-end="397.22">let's talk about the various ways to</span> <span data-start="397.22" data-end="400.249">communicate with native code in node.js</span> <span data-start="400.249" data-end="402.529">process that's my favorite and I think</span> <span data-start="402.529" data-end="404.029">that's the one that most of you would</span> <span data-start="404.029" data-end="406.999">have already used child process comes</span> <span data-start="406.999" data-end="409.369">natively in node you can just require</span> <span data-start="409.369" data-end="411.499">child process from any of your modules</span> <span data-start="411.499" data-end="414.559">and huge trial process child process</span> <span data-start="414.559" data-end="416.719">runs in its own process and therefore</span> <span data-start="416.719" data-end="420.289">you can write typical Nord code your no</span> <span data-start="420.289" data-end="422.239">thread would not be blocked when a child</span> <span data-start="422.239" data-end="424.879">process is running you can get it to run</span> <span data-start="424.879" data-end="427.309">asynchronously pass it arguments and</span> <span data-start="427.309" data-end="430.189">take that as a result a process it's</span> <span data-start="430.189" data-end="433.639">perfect perfect for what it does but it</span> <span data-start="433.639" data-end="435.469">does have a few limitations and there</span> <span data-start="435.469" data-end="437.149">are a few cases where it does not work</span> <span data-start="437.149" data-end="439.879">that well what if the functionality that</span> <span data-start="439.879" data-end="442.249">you want is not natively available or</span> <span data-start="442.249" data-end="444.229">easily possible with a shell script or a</span> <span data-start="444.229" data-end="446.929">bad script or direct command line are</span> <span data-start="446.929" data-end="450.11">you willing to ship another binary will</span> <span data-start="450.11" data-end="452.149">that binary work well given the</span> <span data-start="452.149" data-end="453.829">antivirus that some user has installed</span> <span data-start="453.829" data-end="458.899">somewhere in Japan how do I know and</span> <span data-start="458.899" data-end="461.119">that is a big reason to be careful with</span> <span data-start="461.119" data-end="463.039">child processes you're writing into</span> <span data-start="463.039" data-end="465.079">shell directly and there are cases where</span> <span data-start="465.079" data-end="468.289">it's not a good idea especially if stdio</span> <span data-start="468.289" data-end="470.269">is not enough the communication with</span> <span data-start="470.269" data-end="472.159">child processes normally happens to the</span> <span data-start="472.159" data-end="474.709">standard input output and error ports</span> <span data-start="474.709" data-end="476.869">now the problem with that is it's good</span> <span data-start="476.869" data-end="478.729">if you want to work with that but say</span> <span data-start="478.729" data-end="480.289">you're passing a large amount of image</span> <span data-start="480.289" data-end="482.149">data you'll have to go down to the file</span> <span data-start="482.149" data-end="486.829">system which is very complicated child</span> <span data-start="486.829" data-end="489.379">process is like a tow-truck it can get</span> <span data-start="489.379" data-end="491.479">you to your destination but I would</span> <span data-start="491.479" data-end="497.959">never want to talk about that let's talk</span> <span data-start="497.959" data-end="500.809">about something better FFI or foreign</span> <span data-start="500.809" data-end="503.179">function injection FFI is not really a</span> <span data-start="503.179" data-end="505.489">node concept it is a concept that's</span> <span data-start="505.489" data-end="508.129">there in all programming languages the</span> <span data-start="508.129" data-end="509.719">binary interface of the C programming</span> <span data-start="509.719" data-end="512.779">languages has been standardized as the</span> <span data-start="512.779" data-end="514.519">interface for information exchange</span> <span data-start="514.519" data-end="518.12">between languages in short if you have a</span> </p>
<p><span data-start="518.12" data-end="520.61">C style library then any language can</span> <span data-start="520.61" data-end="522.379">read through the binary and directly</span> <span data-start="522.379" data-end="524.449">call into the functionality so if a</span> <span data-start="524.449" data-end="526.399">method is exporting a C style library</span> <span data-start="526.399" data-end="529.37">you can directly read it from nodejs and</span> <span data-start="529.37" data-end="530.269">call into it</span> <span data-start="530.269" data-end="533.99">no writing C++ no writing C you are</span> <span data-start="533.99" data-end="536.45">still in GS and there is a native module</span> <span data-start="536.45" data-end="538.79">available in node called f fi or f fi</span> <span data-start="538.79" data-end="541.57">napi in node 10-plus which can do that</span> <span data-start="541.57" data-end="544.61">it is actually the best approach if you</span> <span data-start="544.61" data-end="546.74">have a library with C style code lying</span> <span data-start="546.74" data-end="547.16">there</span> <span data-start="547.16" data-end="550.1">the reason you can use it in multiple</span> <span data-start="550.1" data-end="552.74">languages your C guy can write the C</span> <span data-start="552.74" data-end="555.62">code and you can focus on Jas but it has</span> <span data-start="555.62" data-end="558.86">its own set of disadvantages for example</span> <span data-start="558.86" data-end="563.42">the J's bridge to C++ is still slow the</span> <span data-start="563.42" data-end="565.37">other big disadvantage which affects GS</span> <span data-start="565.37" data-end="568.31">developers is that C developers like to</span> <span data-start="568.31" data-end="571.37">take on the main thread if the C library</span> <span data-start="571.37" data-end="573.2">is actually slow and you're actually</span> <span data-start="573.2" data-end="574.55">doing number crunching you would want to</span> <span data-start="574.55" data-end="576.44">do this in a background thread don't</span> <span data-start="576.44" data-end="578.45">stall my application while this thing is</span> <span data-start="578.45" data-end="581.32">running and you cannot do that with FF I</span> <span data-start="581.32" data-end="584">for doing something like that you need</span> <span data-start="584" data-end="586.37">more something more advanced FF I is</span> <span data-start="586.37" data-end="588.47">more like a toy it works for what it</span> <span data-start="588.47" data-end="590.66">works but if it doesn't look for a</span> <span data-start="590.66" data-end="595.19">better solution now note is build in v8</span> <span data-start="595.19" data-end="598.73">v8 is a C++ based library and what that</span> <span data-start="598.73" data-end="602.45">means is you can directly call C++ why</span> <span data-start="602.45" data-end="604.25">are the v8 API is excellent and extend</span> <span data-start="604.25" data-end="606.89">node so simple you'll get the full</span> <span data-start="606.89" data-end="609.56">performance of v8 you can extend v8 and</span> <span data-start="609.56" data-end="612.62">write new JavaScript maybe write es 2019</span> <span data-start="612.62" data-end="617.81">in your module but then there is one big</span> <span data-start="617.81" data-end="618.52">problem</span> <span data-start="618.52" data-end="621.32">v8 releases a new version every month</span> <span data-start="621.32" data-end="623.39">and they cannot guarantee the</span> <span data-start="623.39" data-end="625.399">compatibility of their API across</span> <span data-start="625.399" data-end="628.31">releases what that means is that if I</span> <span data-start="628.31" data-end="630.56">write a node module using the v8 API is</span> <span data-start="630.56" data-end="634.37">next month I'm I need to rewrite it no</span> <span data-start="634.37" data-end="636.62">one can maintain that and that node team</span> <span data-start="636.62" data-end="639.17">realized it very early that is why they</span> <span data-start="639.17" data-end="641.69">created na N and wrapper over the v8 API</span> <span data-start="641.69" data-end="644.42">which hides the changes as v8 changes</span> <span data-start="644.42" data-end="647.3">and if you use any and you can recompile</span> <span data-start="647.3" data-end="649.37">your module across various versions of</span> <span data-start="649.37" data-end="652.13">node and it will continue to run nor</span> <span data-start="652.13" data-end="655.13">rewriting needed NN was built as a</span> <span data-start="655.13" data-end="657.32">specific solution to a very specific</span> <span data-start="657.32" data-end="660.92">problem that was to hide v8 and it does</span> <span data-start="660.92" data-end="663.17">the job perfectly but it was never</span> <span data-start="663.17" data-end="665.529">thought out to be a very well-defined</span> </p>
<p><span data-start="665.529" data-end="667.68">C++ interface</span> <span data-start="667.68" data-end="669.839">jiae's communication and it starts to</span> <span data-start="669.839" data-end="672.63">show its age for example you need to</span> <span data-start="672.63" data-end="675.6">understand v8 to use any and properly</span> <span data-start="675.6" data-end="678.68">you need to recompile with every release</span> <span data-start="678.68" data-end="681.36">people who use multiple versions of</span> <span data-start="681.36" data-end="683.16">north would have seen this error at some</span> <span data-start="683.16" data-end="685.74">point or the other this error comes in</span> <span data-start="685.74" data-end="688.98">because of any n n n is highly tied to a</span> <span data-start="688.98" data-end="692.13">version of node and so if you want to</span> <span data-start="692.13" data-end="693.81">switch your node version there are</span> <span data-start="693.81" data-end="696.87">problems more than that if you happen to</span> <span data-start="696.87" data-end="699.12">be writing electron and have your unit</span> <span data-start="699.12" data-end="701.37">tests in node you will only be</span> <span data-start="701.37" data-end="707.49">recompiling for the entire day another</span> <span data-start="707.49" data-end="709.44">issue with any n is that it's so</span> <span data-start="709.44" data-end="711.69">complicated to set up any n that you</span> <span data-start="711.69" data-end="713.25">will be actually ending up setting up</span> <span data-start="713.25" data-end="716.25">your production machine to have a C</span> <span data-start="716.25" data-end="719.1">compiler a Python compiler and the</span> </p>
<p><span data-start="719.1" data-end="720.839">JavaScript runtime just to use</span> <span data-start="720.839" data-end="723.63">JavaScript in production which is not</span> <span data-start="723.63" data-end="726.57">really a good thing to do any n is like</span> <span data-start="726.57" data-end="728.94">manual transmission you need to know</span> <span data-start="728.94" data-end="730.47">what gear to go into for your</span> <span data-start="730.47" data-end="732.779">application to work otherwise this error</span> <span data-start="732.779" data-end="736.47">awaits now if any n is manual let's talk</span> <span data-start="736.47" data-end="740.16">about the automatic the n API the N API</span> <span data-start="740.16" data-end="743.01">has been marked stable with no ten and</span> <span data-start="743.01" data-end="746.16">for the last 15 days no 10 has been the</span> <span data-start="746.16" data-end="748.8">LTS version of node so n API is</span> <span data-start="748.8" data-end="751.92">production-ready n api has a very</span> <span data-start="751.92" data-end="755.67">well-defined binary interface that is it</span> <span data-start="755.67" data-end="759.779">is a bi-stable in short the node team</span> <span data-start="759.779" data-end="761.43">guarantees that if you write something</span> <span data-start="761.43" data-end="764.22">using the N API you can not only use it</span> <span data-start="764.22" data-end="766.68">in the past versions of node node eight</span> <span data-start="766.68" data-end="769.02">where it was experimental and no 10 but</span> <span data-start="769.02" data-end="771.329">also in the future versions the node a</span> <span data-start="771.329" data-end="773.43">node team will gain will try to make</span> <span data-start="773.43" data-end="775.44">sure that your napi mod you stays</span> <span data-start="775.44" data-end="777">relevant and you do not need to</span> <span data-start="777" data-end="779.73">recompile across your users n api</span> <span data-start="779.73" data-end="781.74">provides a full set of utility methods</span> <span data-start="781.74" data-end="785.43">to communicate with c++ in a proper JS</span> <span data-start="785.43" data-end="787.68">way for example it hides all the</span> <span data-start="787.68" data-end="790.23">complications around pointers it hides</span> <span data-start="790.23" data-end="792.27">how to create a background thread in a</span> <span data-start="792.27" data-end="795.54">very simple method and electron rebuild</span> <span data-start="795.54" data-end="798.42">is officially dead once we have all</span> <span data-start="798.42" data-end="800.71">plugins that have moved to the N API</span> <span data-start="800.71" data-end="803.2">now before I talk about how to write</span> <span data-start="803.2" data-end="805.24">some napi code I would like to know how</span> <span data-start="805.24" data-end="807.52">many if you've heard about C++ before my</span> <span data-start="807.52" data-end="811.81">talk everyone how many of you actually</span> <span data-start="811.81" data-end="815.8">used C++ or written C++ code it's quite</span> <span data-start="815.8" data-end="819.04">a few how many of you will love C++ love</span> <span data-start="819.04" data-end="823.66">it more than JavaScript again at your</span> <span data-start="823.66" data-end="825.97">question because C++ is much more</span> <span data-start="825.97" data-end="827.95">difficult to write and unless you really</span> <span data-start="827.95" data-end="829.99">need to I would prefer to stay in the</span> <span data-start="829.99" data-end="833.41">jail and less socials to show some</span> <span data-start="833.41" data-end="836.44">sample an API based code so I have a es6</span> <span data-start="836.44" data-end="839.47">module that exports a property X which</span> <span data-start="839.47" data-end="841.95">is a function that returns hello world</span> <span data-start="841.95" data-end="845.13">this is what it would look like in es5</span> <span data-start="845.13" data-end="850.27">slightly more verbose but look at C++ it</span> <span data-start="850.27" data-end="853.149">looks very complicated but actually it's</span> <span data-start="853.149" data-end="855.37">very simple from the C++ standards at</span> <span data-start="855.37" data-end="858.1">the bottom of the file we have this node</span> </p>
<p><span data-start="858.1" data-end="860.98">API module which is declaring that the</span> <span data-start="860.98" data-end="863.05">module dot exports come from the export</span> <span data-start="863.05" data-end="865.27">method and the name of the module comes</span> <span data-start="865.27" data-end="867.22">from the JIP file the JIP file is</span> <span data-start="867.22" data-end="869.05">equivalent to packet or JSON in the</span> <span data-start="869.05" data-end="871.63">native world in the exports method we</span> <span data-start="871.63" data-end="874.9">are setting a property X to be the Foo</span> <span data-start="874.9" data-end="876.82">function which has been converted from a</span> <span data-start="876.82" data-end="879.4">c function to a JS function and in the</span> <span data-start="879.4" data-end="880.87">Foo function we are returning a string</span> <span data-start="880.87" data-end="884.26">hello world at the top of the file there</span> <span data-start="884.26" data-end="886.5">is any P I dot H which we are including</span> <span data-start="886.5" data-end="889.18">include is kind of like imports I think</span> <span data-start="889.18" data-end="891.7">most of us are C++ developers so I don't</span> <span data-start="891.7" data-end="893.339">need to go into details for all of that</span> <span data-start="893.339" data-end="895.47">now what we'll be doing today is</span> <span data-start="895.47" data-end="898.33">building or showing a running native</span> <span data-start="898.33" data-end="900.7">module let's go to a hypothetical</span> <span data-start="900.7" data-end="903.37">situation that I have been very lucky in</span> </p>
<p><span data-start="903.37" data-end="905.91">Vegas</span> <span data-start="905.92" data-end="910.81">and not only that all of you have been</span> <span data-start="910.81" data-end="913.99">luckier so while I get some cash you get</span> <span data-start="913.99" data-end="916.6">to drive a brand new car and as you</span> <span data-start="916.6" data-end="918.64">drive through the Vegas Strip you see me</span> <span data-start="918.64" data-end="921.28">in your sideview mirror and for another</span> <span data-start="921.28" data-end="923.26">lucky break it's actually raining in</span> <span data-start="923.26" data-end="928.18">Vegas and that is what we would be doing</span> <span data-start="928.18" data-end="931.42">we'll be taking an image adding a rain</span> <span data-start="931.42" data-end="933.55">effect to it overlaying it with another</span> <span data-start="933.55" data-end="935.83">image and fitting it inside a frame we</span> <span data-start="935.83" data-end="937.68">are doing all of this using imagemagick</span> <span data-start="937.68" data-end="940.81">image magic is an open source C++ API</span> <span data-start="940.81" data-end="943.99">for image manipulation very popular on</span> <span data-start="943.99" data-end="945.43">the server side very popular on the</span> <span data-start="945.43" data-end="947.29">command line you can read all about it</span> <span data-start="947.29" data-end="949.53">it's all over the Internet</span> <span data-start="949.53" data-end="954.97">so let's get started and I'm here in the</span> <span data-start="954.97" data-end="958.9">middle of a test file where I'm loading</span> <span data-start="958.9" data-end="962.04">a module called version dot node in</span> <span data-start="962.04" data-end="965.17">version dot node we export a method</span> <span data-start="965.17" data-end="967.03">called version which returns the current</span> <span data-start="967.03" data-end="970.42">node version as a string and I'm logging</span> <span data-start="970.42" data-end="972.76">it onto the console let's look at</span> <span data-start="972.76" data-end="975.25">binding dot chip which represents the</span> <span data-start="975.25" data-end="977.92">packet or JSON for this module it has</span> <span data-start="977.92" data-end="979.54">the similar things just like packet or</span> </p>
<p><span data-start="979.54" data-end="981.58">JSON the name is called target name</span> <span data-start="981.58" data-end="983.53">because we are C++ developers you want</span> <span data-start="983.53" data-end="987.55">to make it a bit more confusing than it</span> <span data-start="987.55" data-end="990.16">has dependencies which is an array and</span> <span data-start="990.16" data-end="992.38">it can run some shell scripts or note</span> <span data-start="992.38" data-end="995.02">scripts directly we have some flags to</span> <span data-start="995.02" data-end="996.73">tell the compiler how to compile it and</span> <span data-start="996.73" data-end="1000.42">we have some OS specific stuff and that</span> <span data-start="1000.42" data-end="1002.61">is all there is to it when node would</span> <span data-start="1002.61" data-end="1004.41">read this file it would understand that</span> <span data-start="1004.41" data-end="1005.94">it is native code and compile this</span> <span data-start="1005.94" data-end="1008.37">binary let's go into the binary version</span> <span data-start="1008.37" data-end="1011.49">or the C++ version of this module this</span> <span data-start="1011.49" data-end="1013.65">looks exactly like the demo that a</span> <span data-start="1013.65" data-end="1016.44">sample code that I just showed so at the</span> <span data-start="1016.44" data-end="1018">bottom of the file we again have known</span> </p>
<p><span data-start="1018" data-end="1020.25">API module the name comes from the JIP</span> <span data-start="1020.25" data-end="1022.86">file there is a method called init which</span> <span data-start="1022.86" data-end="1024.69">has a property called version which is</span> <span data-start="1024.69" data-end="1027.87">the function get version in the get</span> <span data-start="1027.87" data-end="1029.55">version function we are returning a</span> <span data-start="1029.55" data-end="1031.47">string which we are instead of</span> <span data-start="1031.47" data-end="1033.57">hard-coding hello world getting from the</span> <span data-start="1033.57" data-end="1035.88">imagemagick api which we've included by</span> <span data-start="1035.88" data-end="1039">a magic plus plus dot h now as i execute</span> <span data-start="1039" data-end="1039.63">this and my</span> <span data-start="1039.63" data-end="1041.16">a console I think it's slightly</span> <span data-start="1041.16" data-end="1043.92">difficult to see we have image magic</span> <span data-start="1043.92" data-end="1046.89">version 7 being logged that is the</span> <span data-start="1046.89" data-end="1048.39">version of image magic that's installed</span> <span data-start="1048.39" data-end="1050.91">on my machine now that we've gone</span> <span data-start="1050.91" data-end="1053.1">through a hello world I will like you to</span> <span data-start="1053.1" data-end="1054.63">go through something a little more</span> <span data-start="1054.63" data-end="1057.36">complicated so in this second example we</span> <span data-start="1057.36" data-end="1059.16">are reading a file called photos or JPEG</span> <span data-start="1059.16" data-end="1062.58">which is a binary image file please</span> <span data-start="1062.58" data-end="1064.17">don't point at read file sync I know</span> <span data-start="1064.17" data-end="1068.34">it's bad code once we get the image file</span> <span data-start="1068.34" data-end="1072.09">we load the info dot node info provider</span> <span data-start="1072.09" data-end="1074.55">native module which exports a method</span> <span data-start="1074.55" data-end="1076.08">process image which is going to process</span> <span data-start="1076.08" data-end="1080.16">this image and return a.j saab jekt this</span> <span data-start="1080.16" data-end="1082.74">object I am logging on to console many</span> </p>
<p><span data-start="1082.74" data-end="1084.54">JavaScript developers don't know that</span> <span data-start="1084.54" data-end="1086.31">JSON dot stringify actually can take</span> <span data-start="1086.31" data-end="1088.92">more than one argument the third</span> <span data-start="1088.92" data-end="1090.69">argument of JSON dot stringify is</span> <span data-start="1090.69" data-end="1093.57">extremely useful this is the number of</span> <span data-start="1093.57" data-end="1095.22">white spaces so you can get a pretty</span> <span data-start="1095.22" data-end="1098.22">fide JSON string from a JavaScript</span> <span data-start="1098.22" data-end="1100.26">object directly without going to J's</span> <span data-start="1100.26" data-end="1102.65">beautify or whatever you guys are using</span> <span data-start="1102.65" data-end="1105.81">coming back to native code let's look at</span> <span data-start="1105.81" data-end="1108.57">info dot CC the code for the info dot</span> <span data-start="1108.57" data-end="1111.09">node module the bottom of the file looks</span> <span data-start="1111.09" data-end="1113.16">exactly like I've just shown to you all</span> <span data-start="1113.16" data-end="1115.44">of you the name comes from the JIP file</span> <span data-start="1115.44" data-end="1118.08">the init method provides the exports the</span> <span data-start="1118.08" data-end="1120.09">expose is actually a property called</span> <span data-start="1120.09" data-end="1122.16">process image which comes from the</span> <span data-start="1122.16" data-end="1125.07">process image C++ function now let's get</span> <span data-start="1125.07" data-end="1127.26">into the process image function the</span> <span data-start="1127.26" data-end="1128.88">first thing to note is that it doesn't</span> <span data-start="1128.88" data-end="1131.07">take multiple arguments it takes an info</span> <span data-start="1131.07" data-end="1133.59">object this info object is very similar</span> <span data-start="1133.59" data-end="1135.9">to the arguments object in Jas or the</span> <span data-start="1135.9" data-end="1138.32">triple dot args like you write in es6</span> <span data-start="1138.32" data-end="1140.94">then from this info object we can verify</span> <span data-start="1140.94" data-end="1143.07">that the parameters being passed are</span> <span data-start="1143.07" data-end="1145.2">correct and if they are not we throw a</span> </p>
<p><span data-start="1145.2" data-end="1147.69">JS exception why we want to do that</span> <span data-start="1147.69" data-end="1149.55">they're still living in the world of</span> <span data-start="1149.55" data-end="1151.62">segmentation false if we make a mistake</span> <span data-start="1151.62" data-end="1154.02">our program would crash and therefore we</span> <span data-start="1154.02" data-end="1157.2">want to be extra careful it's better to</span> <span data-start="1157.2" data-end="1158.82">get into the unhandled exception in the</span> <span data-start="1158.82" data-end="1161.13">notes place rather than crashing here in</span> <span data-start="1161.13" data-end="1165.27">C once we know that it is a buffer we</span> <span data-start="1165.27" data-end="1167.97">can convert it from a raw JSON buffer</span> <span data-start="1167.97" data-end="1169.92">typescript folks would understand that</span> <span data-start="1169.92" data-end="1171.45">this looks very close to typescript</span> <span data-start="1171.45" data-end="1173.4">and generic since</span> <span data-start="1173.4" data-end="1175.53">plus plus have been an inspiration for a</span> <span data-start="1175.53" data-end="1177.39">lot of languages including typescript</span> <span data-start="1177.39" data-end="1179.73">once we converted to a buffer we have</span> <span data-start="1179.73" data-end="1181.89">direct access to the raw binary data and</span> <span data-start="1181.89" data-end="1184.68">the length of the buffer we can use this</span> <span data-start="1184.68" data-end="1186.6">to pass on and create an image magic</span> <span data-start="1186.6" data-end="1189.18">image now from the image I'm not doing</span> <span data-start="1189.18" data-end="1190.62">much I'm reading the width and the</span> <span data-start="1190.62" data-end="1192.9">height of the image a few attributes and</span> <span data-start="1192.9" data-end="1195.75">then creating a JS object creating a J's</span> <span data-start="1195.75" data-end="1198.81">in C++ is a little more verbose than</span> <span data-start="1198.81" data-end="1202.14">creating it is in GS so I need to create</span> <span data-start="1202.14" data-end="1203.82">an object with the width height created</span> <span data-start="1203.82" data-end="1206.16">and modified parameters which I again</span> <span data-start="1206.16" data-end="1207.84">get from the number in string tied data</span> <span data-start="1207.84" data-end="1211.23">and then I return it back to node now as</span> </p>
<p><span data-start="1211.23" data-end="1213.75">I executed in my debug console you</span> <span data-start="1213.75" data-end="1215.28">should see that I'm loading a full at</span> <span data-start="1215.28" data-end="1217.8">the image the mod if the Creator time is</span> <span data-start="1217.8" data-end="1220.23">actually right now and that is because I</span> <span data-start="1220.23" data-end="1222.8">passed on a binary image to image magic</span> <span data-start="1222.8" data-end="1225.15">image magic did not get to read a file</span> <span data-start="1225.15" data-end="1226.83">from disk and that is why it was just</span> <span data-start="1226.83" data-end="1228.42">created when the binary editor was</span> <span data-start="1228.42" data-end="1230.43">provided and it did not have a modified</span> <span data-start="1230.43" data-end="1233.82">time the demo that I just showed was</span> <span data-start="1233.82" data-end="1236.34">kind of a example that we would not like</span> <span data-start="1236.34" data-end="1237.99">to use in production it's doing</span> <span data-start="1237.99" data-end="1240.9">processing in the main thread right and</span> <span data-start="1240.9" data-end="1244.86">main thread stalls and our application</span> <span data-start="1244.86" data-end="1247.05">stops working so let's do something</span> <span data-start="1247.05" data-end="1248.61">where it goes to a background thread</span> <span data-start="1248.61" data-end="1251.25">takes a callback gives us the processed</span> <span data-start="1251.25" data-end="1254.4">image in our callback now we pass it on</span> <span data-start="1254.4" data-end="1258.15">and save the file as edit dot JPEG on to</span> <span data-start="1258.15" data-end="1261.69">our console let's look at the code for</span> <span data-start="1261.69" data-end="1264.78">edit dot C C now this also starts just</span> <span data-start="1264.78" data-end="1266.43">like the code that I showed for the</span> <span data-start="1266.43" data-end="1268.8">previous two examples we again get the</span> <span data-start="1268.8" data-end="1270.75">name from the Gipp file the init method</span> <span data-start="1270.75" data-end="1273.15">provides a method called edit which is</span> <span data-start="1273.15" data-end="1275.85">the function edit in the function edit</span> <span data-start="1275.85" data-end="1277.77">we validate the arguments just like we</span> <span data-start="1277.77" data-end="1280.11">did in the previous example and then</span> <span data-start="1280.11" data-end="1282.21">instead of doing some calculation we</span> <span data-start="1282.21" data-end="1284.55">create a worker called image modifier</span> <span data-start="1284.55" data-end="1286.95">which takes the buffer and they call</span> <span data-start="1286.95" data-end="1289.83">back and then we queue that worker on a</span> <span data-start="1289.83" data-end="1292.17">background thread we are not creating</span> <span data-start="1292.17" data-end="1294.75">background threads manually oh god it's</span> <span data-start="1294.75" data-end="1296.34">so difficult to create background</span> <span data-start="1296.34" data-end="1300.96">threads things like deadlocks they stall</span> <span data-start="1300.96" data-end="1301.89">your application</span> <span data-start="1301.89" data-end="1305.58">do not waste CPU but you don't run this</span> <span data-start="1305.58" data-end="1307.08">is so much better</span> <span data-start="1307.08" data-end="1310.019">and API provides direct access to run</span> <span data-start="1310.019" data-end="1311.909">stuff in a background thread and it</span> <span data-start="1311.909" data-end="1314.309">manages the thread pool now let's look</span> <span data-start="1314.309" data-end="1318.299">at the image modifier class event</span> <span data-start="1318.299" data-end="1319.98">modifier derived from an async worker</span> <span data-start="1319.98" data-end="1321.179">which and capsule eights all the</span> <span data-start="1321.179" data-end="1323.549">background thread calculations a sync</span> <span data-start="1323.549" data-end="1325.98">worker takes a callback and it ensures</span> <span data-start="1325.98" data-end="1330.51">the unmanaged memory part of C++ so when</span> <span data-start="1330.51" data-end="1332.039">we need the koala back back again after</span> <span data-start="1332.039" data-end="1334.47">execution in the background thread the</span> <span data-start="1334.47" data-end="1335.85">async worker will ensure that the</span> <span data-start="1335.85" data-end="1337.919">callback has not been garbage collected</span> <span data-start="1337.919" data-end="1343.019">by v8 and we can use it again we can</span> <span data-start="1343.019" data-end="1344.94">directly copy in values that we get like</span> <span data-start="1344.94" data-end="1347.37">numbers and strings but in this case I</span> <span data-start="1347.37" data-end="1349.71">am passing a lot of binary data and we</span> <span data-start="1349.71" data-end="1351.389">don't want to copy the binary data in</span> <span data-start="1351.389" data-end="1353.639">the J's thread and that is why we are</span> <span data-start="1353.639" data-end="1356.37">using the node buffer despite the</span> <span data-start="1356.37" data-end="1358.409">presence of array buffers nor buffer is</span> <span data-start="1358.409" data-end="1361.62">not dead because of a reason node buffer</span> <span data-start="1361.62" data-end="1364.169">is a very special object the binary data</span> <span data-start="1364.169" data-end="1366.809">of node buffer is accessible even from</span> <span data-start="1366.809" data-end="1369.36">background threads and that is why node</span> <span data-start="1369.36" data-end="1372.99">buffer still exists and to do that what</span> <span data-start="1372.99" data-end="1374.22">we are doing is you're marking it</span> <span data-start="1374.22" data-end="1376.409">persistent so that accidentally the node</span> <span data-start="1376.409" data-end="1378.6">buffer does not get deleted it will get</span> <span data-start="1378.6" data-end="1381.899">garbage collected once this class object</span> <span data-start="1381.899" data-end="1384.87">is destroyed and then we are keeping a</span> <span data-start="1384.87" data-end="1386.73">reference to the actual binary data and</span> <span data-start="1386.73" data-end="1388.59">the length of the data to pass on to</span> <span data-start="1388.59" data-end="1391.98">image magic and API will ensure that my</span> <span data-start="1391.98" data-end="1393.659">execute method is actually called in the</span> <span data-start="1393.659" data-end="1395.909">background thread now in the execute</span> <span data-start="1395.909" data-end="1398.1">method I am passing on that image data</span> <span data-start="1398.1" data-end="1400.98">to image magic I'm loading a few images</span> </p>
<p><span data-start="1400.98" data-end="1405.24">I specified array in effect I overlay it</span> <span data-start="1405.24" data-end="1408.09">with my water image and then change its</span> <span data-start="1408.09" data-end="1413.24">dimension to fit it inside the car frame</span> <span data-start="1413.24" data-end="1415.98">once I am done I can write this output</span> <span data-start="1415.98" data-end="1418.44">to another variable we don't have to</span> <span data-start="1418.44" data-end="1421.74">write to disk now note is happy passing</span> <span data-start="1421.74" data-end="1424.26">this variable directly to the J's land</span> <span data-start="1424.26" data-end="1427.2">we do not need to copy it over or waste</span> <span data-start="1427.2" data-end="1430.019">our memory or CPU doing things with the</span> <span data-start="1430.019" data-end="1432.69">data we can directly use it in Jas but</span> <span data-start="1432.69" data-end="1434.789">unfortunately event magic does not allow</span> <span data-start="1434.789" data-end="1436.77">me to and therefore I need to copy this</span> <span data-start="1436.77" data-end="1439.139">data into a binary object into a basic</span> <span data-start="1439.139" data-end="1441.059">object now to do that</span> <span data-start="1441.059" data-end="1442.919">I'm using this but this is not really</span> <span data-start="1442.919" data-end="1445.019">stalling your JavaScript read all this</span> <span data-start="1445.019" data-end="1446.37">code is running in your background</span> <span data-start="1446.37" data-end="1448.83">thread in the execute method so your JS</span> <span data-start="1448.83" data-end="1451.23">code will still be performant once that</span> <span data-start="1451.23" data-end="1453.419">method executes we get to the on ok</span> <span data-start="1453.419" data-end="1455.22">method which is again called in the J's</span> <span data-start="1455.22" data-end="1457.889">thread where we can execute JavaScript</span> <span data-start="1457.889" data-end="1460.35">and this method what we are doing is</span> <span data-start="1460.35" data-end="1463.019">getting a callback and calling it with</span> <span data-start="1463.019" data-end="1464.82">as the error argument and D</span> <span data-start="1464.82" data-end="1467.669">buffer as the success argument now</span> <span data-start="1467.669" data-end="1468.99">there's one more thing that we need to</span> <span data-start="1468.99" data-end="1471.929">remember and that is this line which is</span> <span data-start="1471.929" data-end="1474.779">not really declaring a c++ variable that</span> <span data-start="1474.779" data-end="1476.669">we are not going to use this is actually</span> <span data-start="1476.669" data-end="1479.549">creating a J scope all functions in J s</span> <span data-start="1479.549" data-end="1482.58">are automatically having a scope but</span> <span data-start="1482.58" data-end="1484.08">since we are not creating a function we</span> <span data-start="1484.08" data-end="1485.549">directly calling a function we need to</span> <span data-start="1485.549" data-end="1488.19">create a scope manually and once the</span> <span data-start="1488.19" data-end="1490.23">scope is destroyed if any of the objects</span> <span data-start="1490.23" data-end="1492.24">created in the scope are not referenced</span> <span data-start="1492.24" data-end="1492.869">anywhere</span> <span data-start="1492.869" data-end="1495.509">there could be garbage collected now</span> <span data-start="1495.509" data-end="1497.07">let's see how I create the buffer to</span> <span data-start="1497.07" data-end="1499.289">pass on the buffer is again created by</span> <span data-start="1499.289" data-end="1500.519">the buffer new just like you were using</span> <span data-start="1500.519" data-end="1502.98">string new or a number new a buffer is</span> <span data-start="1502.98" data-end="1505.2">slightly more complicated in sense that</span> <span data-start="1505.2" data-end="1507.869">it takes this an asynchronous function</span> <span data-start="1507.869" data-end="1510.869">called a C++ lambda we need to do this</span> <span data-start="1510.869" data-end="1514.289">because C++ still has managed doesn't</span> <span data-start="1514.289" data-end="1516.48">have managed memory so for unmanaged</span> <span data-start="1516.48" data-end="1518.129">memory when this buffer is actually</span> <span data-start="1518.129" data-end="1520.11">garbage collected we will need to free</span> <span data-start="1520.11" data-end="1521.669">the internal data and that is what we</span> <span data-start="1521.669" data-end="1525.72">are doing now as I execute this you</span> <span data-start="1525.72" data-end="1527.46">won't see anything in the console but</span> <span data-start="1527.46" data-end="1530.1">will successfully log done and instead</span> <span data-start="1530.1" data-end="1532.23">of showing what I was doing since I'm</span> <span data-start="1532.23" data-end="1533.999">running out of time I'll show you</span> <span data-start="1533.999" data-end="1536.429">something cooler now what I'm going to</span> <span data-start="1536.429" data-end="1538.86">do is without recompiling I'm going to</span> <span data-start="1538.86" data-end="1541.379">load it in electron and as I click on</span> <span data-start="1541.379" data-end="1544.71">this here it is the same code running an</span> <span data-start="1544.71" data-end="1548.07">electron no recompilation and i am going</span> <span data-start="1548.07" data-end="1550.289">to make a fool of myself now as i take a</span> <span data-start="1550.289" data-end="1552.029">selfie of myself in front of all of you</span> <span data-start="1552.029" data-end="1554.91">on the stage yeah</span> <span data-start="1554.91" data-end="1557.34">and it does that processing and it's</span> <span data-start="1557.34" data-end="1565.38">instantly available for me to save now</span> <span data-start="1565.38" data-end="1567.9">the same thing is available at napi dot</span> <span data-start="1567.9" data-end="1570.2">efficient dot me feel free to try it out</span> <span data-start="1570.2" data-end="1574.2">after my speech and have a souvenir for</span> <span data-start="1574.2" data-end="1576.96">the conference and I'm already out of</span> <span data-start="1576.96" data-end="1578.64">time so I'll just make it quick</span> <span data-start="1578.64" data-end="1581.22">the best tips to work with native code</span> <span data-start="1581.22" data-end="1584.67">are actually three things rule number</span> <span data-start="1584.67" data-end="1587.61">one do not write native code try to see</span> <span data-start="1587.61" data-end="1589.65">if something that is not native can</span> <span data-start="1589.65" data-end="1592.32">solve the problem for you because child</span> <span data-start="1592.32" data-end="1593.91">processes are good for a lot of cases</span> <span data-start="1593.91" data-end="1596.85">and so is FFI and unless you really need</span> <span data-start="1596.85" data-end="1600.45">native code do not write native code the</span> <span data-start="1600.45" data-end="1602.49">second rule of writing native code is do</span> <span data-start="1602.49" data-end="1604.85">not give it to a native developer</span> <span data-start="1604.85" data-end="1607.5">because they don't understand Jas</span> <span data-start="1607.5" data-end="1610.23">they'll hog your main thread write it</span> <span data-start="1610.23" data-end="1613.23">like beautiful Jas and ugly C++ and you</span> <span data-start="1613.23" data-end="1617.49">will be successful the third rule of</span> <span data-start="1617.49" data-end="1620.34">writing native code is again to remember</span> <span data-start="1620.34" data-end="1623.75">the first rule don't write native god if</span> <span data-start="1623.75" data-end="1626.19">you have it in some native code just</span> <span data-start="1626.19" data-end="1628.62">evaluate if you need it Jas is evolving</span> <span data-start="1628.62" data-end="1630.72">and over time more and more stuff is</span> <span data-start="1630.72" data-end="1633.12">moving to Jas what you needed in native</span> <span data-start="1633.12" data-end="1636.3">a year back may be redundant now keep</span> <span data-start="1636.3" data-end="1639.57">yourself up to date the code for all of</span> <span data-start="1639.57" data-end="1642.72">my demos are available at napi in my</span> <span data-start="1642.72" data-end="1645.15">github repo the sample service is</span> <span data-start="1645.15" data-end="1647.42">available at n API dot Atisha dot me</span> <span data-start="1647.42" data-end="1650.46">that's all I have to say drive safely</span> <span data-start="1650.46" data-end="1652.47">if you're going to use native code thank</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
