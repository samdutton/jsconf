<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PXfwHAfCGoc</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/PXfwHAfCGoc?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="8.54" data-end="13.62">so my name is Phillip I'm gonna talk to</span> <span data-start="13.62" data-end="16.049">you about messing around with the</span> <span data-start="16.049" data-end="17.64">netbook well messing around with</span> <span data-start="17.64" data-end="19.83">javascript in the Dom to figure out</span> <span data-start="19.83" data-end="22.08">different network characteristics the</span> <span data-start="22.08" data-end="24.08">title here is smaller than what's on the</span> <span data-start="24.08" data-end="26.46">on the website because that wouldn't</span> <span data-start="26.46" data-end="30.869">actually fit in my slides so I'm gonna</span> <span data-start="30.869" data-end="34.52">get started everyone here web developer</span> <span data-start="34.52" data-end="38.79">yeah alright so the web basically runs</span> <span data-start="38.79" data-end="41.129">on three protocols HTTP at the top</span> <span data-start="41.129" data-end="43.98">running on tcp and that override be</span> <span data-start="43.98" data-end="45.719">below that it couldn't really be</span> <span data-start="45.719" data-end="48.42">anything but we have this dry of</span> <span data-start="48.42" data-end="51.719">protocols made by three guys over the</span> <span data-start="51.719" data-end="54.6">course of maybe 20 years starting from</span> <span data-start="54.6" data-end="57.6">1974 on incidentally they have just one</span> <span data-start="57.6" data-end="60.48">beard between them so we'll surf bargain</span> <span data-start="60.48" data-end="64.08">and Tim berners-lee windsurf see anyone</span> <span data-start="64.08" data-end="68.1">at the beard later on we got JavaScript</span> <span data-start="68.1" data-end="71.189">and one one guy with one beard and</span> <span data-start="71.189" data-end="73.439">discovered the good parts so we're gonna</span> <span data-start="73.439" data-end="75.39">throw all of that out of the window and</span> <span data-start="75.39" data-end="81.799">play with the nasty parts all right so</span> <span data-start="81.799" data-end="84.24">number one latency who knows what</span> <span data-start="84.24" data-end="89.159">network latency is great so I have 30</span> <span data-start="89.159" data-end="92.729">minutes and I have a lot to cover who</span> <span data-start="92.729" data-end="96.18">wants to time me 71 I've got six</span> <span data-start="96.18" data-end="98.85">different topics to go through so let's</span> <span data-start="98.85" data-end="101.34">hope five minutes per topic right so</span> <span data-start="101.34" data-end="102.96">let's do latency and let's see if I can</span> <span data-start="102.96" data-end="109.32">keep it under five minutes so this this</span> <span data-start="109.32" data-end="111.149">is an image from cable map that info</span> <span data-start="111.149" data-end="113.85">it's looking at one of the undersea</span> <span data-start="113.85" data-end="116.82">cables between that goes between Germany</span> <span data-start="116.82" data-end="119.61">and the u.s. typically it takes light</span> <span data-start="119.61" data-end="122.399">about 23 milliseconds to go from Berlin</span> <span data-start="122.399" data-end="125.67">to New York if you put that through</span> <span data-start="125.67" data-end="127.77">fiber takes 35 milliseconds because</span> <span data-start="127.77" data-end="130.92">light travels at sixty-six percent of</span> <span data-start="130.92" data-end="134.01">its speed within 50 now if you actually</span> <span data-start="134.01" data-end="136.59">need to go send a network signal you</span> <span data-start="136.59" data-end="138.81">need to send light there send it back</span> <span data-start="138.81" data-end="140.64">and actually do it two more times</span> <span data-start="140.64" data-end="144.45">because of losses within different</span> <span data-start="144.45" data-end="146.61">devices so that 35 milliseconds actually</span> <span data-start="146.61" data-end="148.44">becomes something like 70 milliseconds</span> <span data-start="148.44" data-end="151.08">so if we try to ping from one end to the</span> <span data-start="151.08" data-end="153.03">other that's more or less what you'd see</span> <span data-start="153.03" data-end="158.16">70 to 80 milliseconds this is fine we</span> <span data-start="158.16" data-end="159.45">know this because of physics we know</span> <span data-start="159.45" data-end="162.18">this if we actually see two cities we</span> <span data-start="162.18" data-end="165.06">know how long it's going to take but</span> <span data-start="165.06" data-end="166.47">what happens if you're sitting on your</span> <span data-start="166.47" data-end="167.94">web server you have no idea where your</span> <span data-start="167.94" data-end="169.44">users coming from all you know where</span> <span data-start="169.44" data-end="170.61">they're coming from based on the IP</span> <span data-start="170.61" data-end="174">address but you don't know what route</span> <span data-start="174" data-end="176.129">they taking to get to your box so you</span> <span data-start="176.129" data-end="178.26">want to do some other something else to</span> <span data-start="178.26" data-end="180.599">measure the actual latency and that's</span> <span data-start="180.599" data-end="183.09">what we're going to look at so latency</span> <span data-start="183.09" data-end="185.94">of round trip time which is what we</span> <span data-start="185.94" data-end="187.8">really care about is the time it takes</span> <span data-start="187.8" data-end="190.14">to send a packet and get a response back</span> <span data-start="190.14" data-end="193.65">from the user so we look at an HTTP</span> <span data-start="193.65" data-end="196.11">request it looks like this the client</span> <span data-start="196.11" data-end="199.319">sends a get request and the server</span> <span data-start="199.319" data-end="201.989">handles that request and sends back a</span> <span data-start="201.989" data-end="204.81">response now if your get request is</span> <span data-start="204.81" data-end="206.73">small enough it should fit within a</span> <span data-start="206.73" data-end="210.12">single DCP packet so one HTTP request is</span> <span data-start="210.12" data-end="212.25">actually one tcp package and if your</span> <span data-start="212.25" data-end="214.349">response is small enough as well it</span> <span data-start="214.349" data-end="216.18">should fit within another TCP packet so</span> <span data-start="216.18" data-end="217.47">you'll get back a response and you'll</span> <span data-start="217.47" data-end="219.39">get back an acknowledgement as well with</span> <span data-start="219.39" data-end="223.89">that everyone okay so far so how would</span> <span data-start="223.89" data-end="226.56">we measure this time any guesses using</span> <span data-start="226.56" data-end="236.86">only javascript within the browser</span> <span data-start="236.87" data-end="245.04">bread</span> <span data-start="245.05" data-end="248.33">right so that's actually exactly what my</span> <span data-start="248.33" data-end="255.44">code does so I take the start date set a</span> <span data-start="255.44" data-end="257.329">timer that measures the male's</span> <span data-start="257.329" data-end="259.91">milliseconds of the current time then</span> <span data-start="259.91" data-end="262.58">load an image from wherever my server is</span> <span data-start="262.58" data-end="265.13">and on the onload I measure the end time</span> <span data-start="265.13" data-end="267.199">take the difference and that should be</span> <span data-start="267.199" data-end="269.419">the round-trip time right who thinks</span> <span data-start="269.419" data-end="274.01">that's right anyone else everyone else</span> <span data-start="274.01" data-end="277.22">thinks it's wrong why do you think it's</span> <span data-start="277.22" data-end="282.74">wrong</span> <span data-start="282.75" data-end="285.39">browser needs processing time we so that</span> <span data-start="285.39" data-end="287.25">the browser's going to file the onload</span> <span data-start="287.25" data-end="289.53">as soon as the the image is available</span> <span data-start="289.53" data-end="291.75">this is not being displayed on screen so</span> <span data-start="291.75" data-end="294.96">it's it's just as long as it's available</span> <span data-start="294.96" data-end="296.61">there the browser is going to fire the</span> <span data-start="296.61" data-end="297.81">armlet so it's not a problem with</span> <span data-start="297.81" data-end="300.6">browser processing time the server could</span> <span data-start="300.6" data-end="302.07">require some processing time to actually</span> <span data-start="302.07" data-end="304.95">load that image from disk but let's say</span> <span data-start="304.95" data-end="307.35">we do this for every single user we do</span> <span data-start="307.35" data-end="309.24">it more than once that image is going to</span> <span data-start="309.24" data-end="311.31">be cached in ram so we don't even worry</span> <span data-start="311.31" data-end="320.13">about that anyone else so that's right</span> <span data-start="320.13" data-end="321.69">the time it would take to download the</span> <span data-start="321.69" data-end="323.19">image we can make our image small enough</span> <span data-start="323.19" data-end="325.89">so I typically use a 1 by 1 GF which is</span> <span data-start="325.89" data-end="329.85">35 bytes in size 35 by x + ahead of 312</span> <span data-start="329.85" data-end="332.88">bytes is totally less than thousand 24</span> <span data-start="332.88" data-end="335.91">bytes which is more or less what a TCP</span> <span data-start="335.91" data-end="339.48">packet is so even with downloading image</span> <span data-start="339.48" data-end="340.95">it should still fit in a single TCP</span> <span data-start="340.95" data-end="342.72">packet and we can't get smaller than</span> <span data-start="342.72" data-end="350.16">that perfect so a problem is a TCP</span> <span data-start="350.16" data-end="352.89">handshake right so we're not really</span> <span data-start="352.89" data-end="354.81">measuring just a round-trip time we are</span> <span data-start="354.81" data-end="356.67">measuring TCP handshake plus round-trip</span> <span data-start="356.67" data-end="359.01">time so whenever you make a first</span> <span data-start="359.01" data-end="361.62">request to a server what happens is your</span> <span data-start="361.62" data-end="363.72">client sends a syn packet that's one tcp</span> <span data-start="363.72" data-end="365.49">packet the only thing it has a flag</span> <span data-start="365.49" data-end="369.36">that's a sin saying synchronized and the</span> <span data-start="369.36" data-end="371.13">server response saying I acknowledge</span> <span data-start="371.13" data-end="373.47">your sin and I send you my own sin and</span> <span data-start="373.47" data-end="375.99">then the client has to respond saying I</span> <span data-start="375.99" data-end="378.9">acknowledge Austin so now we've come</span> <span data-start="378.9" data-end="381.21">come pleated this three-way handshake</span> <span data-start="381.21" data-end="383.43">and our connection is established and</span> <span data-start="383.43" data-end="384.78">that's when you can start sending data</span> <span data-start="384.78" data-end="387.48">so we actually sent three packets to and</span> <span data-start="387.48" data-end="389.55">fro before we send up first get requests</span> <span data-start="389.55" data-end="392.61">so what we're doing in this case is</span> <span data-start="392.61" data-end="394.98">actually measuring the time of five</span> <span data-start="394.98" data-end="399.06">packets right and not two packets so how</span> <span data-start="399.06" data-end="403.21">do we get around that any guesses</span> <span data-start="403.21" data-end="407.41">sorry handshake first how do I measure</span> <span data-start="407.41" data-end="410.169">when my hand shakes dance how do how do</span> </p>
<p><span data-start="410.169" data-end="418.909">I measure when the handshake is done</span> <span data-start="418.919" data-end="423.069">alright pretty good keep-alive so let's</span> <span data-start="423.069" data-end="427.139">keep that in mind keep alive anyone else</span> <span data-start="427.139" data-end="429.849">fetching two images right so fetch two</span> <span data-start="429.849" data-end="434.71">images with keep alive so you guys are</span> <span data-start="434.71" data-end="438.529">actually have you seen my slides before</span> <span data-start="438.539" data-end="441.25">alright so basically that's what we do</span> <span data-start="441.25" data-end="444.43">we we rely on the fact that HTTP 1.1 by</span> <span data-start="444.43" data-end="447.18">default has connection keep-alive so</span> <span data-start="447.18" data-end="450.099">what that means is when a client makes a</span> <span data-start="450.099" data-end="452.62">request to a server it'll keep that TCP</span> <span data-start="452.62" data-end="454.99">connection open for a certain amount of</span> <span data-start="454.99" data-end="457.09">time typically defined by the default</span> <span data-start="457.09" data-end="461.199">keep-alive time I think that's between</span> <span data-start="461.199" data-end="463.18">15 and 30 seconds depending on your web</span> <span data-start="463.18" data-end="466.21">server so this client makes a connection</span> <span data-start="466.21" data-end="468.25">to a TCP connection so it does the</span> <span data-start="468.25" data-end="470.139">handshake and once that handshake is</span> <span data-start="470.139" data-end="471.82">done it'll keep that connection open for</span> <span data-start="471.82" data-end="474.4">15 seconds and make as many requests as</span> <span data-start="474.4" data-end="476.59">are necessary on that same TCP</span> <span data-start="476.59" data-end="479.05">connection so what we do is we do one</span> <span data-start="479.05" data-end="482.44">request do I get that that would</span> <span data-start="482.44" data-end="484.75">initiate the first handshake the onload</span> <span data-start="484.75" data-end="486.52">would file after the image is downloaded</span> <span data-start="486.52" data-end="489.15">and then do another request right and</span> <span data-start="489.15" data-end="491.38">that second request does not need a</span> <span data-start="491.38" data-end="492.729">handshake because it's going over the</span> <span data-start="492.729" data-end="495.219">same TCP connection as long as we start</span> <span data-start="495.219" data-end="497.71">that request after the first image was</span> <span data-start="497.71" data-end="500.86">downloaded so the code to do that is</span> <span data-start="500.86" data-end="503.05">slightly more complicated but not too</span> <span data-start="503.05" data-end="506.349">much we go through two images on the</span> <span data-start="506.349" data-end="508.03">onload event of the first one we</span> <span data-start="508.03" data-end="511.09">download the second one is the code</span> <span data-start="511.09" data-end="515.349">clear to everyone if you have any</span> <span data-start="515.349" data-end="519.43">questions with the code can ask me but</span> <span data-start="519.43" data-end="521.89">basically that what it's doing is it</span> <span data-start="521.89" data-end="524.529">loads an image and the onload event</span> <span data-start="524.529" data-end="526.329">measures the time and then loads the</span> <span data-start="526.329" data-end="528.25">image again we throw in some cash</span> <span data-start="528.25" data-end="529.899">busting code in there because we don't</span> <span data-start="529.899" data-end="531.67">want the second load to come up from</span> <span data-start="531.67" data-end="533.46">cash we wanted to always come from</span> <span data-start="533.46" data-end="536.46">server so now we have to the same image</span> <span data-start="536.46" data-end="539.79">loaded twice from the same server the</span> <span data-start="539.79" data-end="542.13">round-trip time is really the or rather</span> <span data-start="542.13" data-end="544.23">the latency is the time it took the</span> <span data-start="544.23" data-end="546.09">second image to load and then now that</span> <span data-start="546.09" data-end="548.58">we know the latency if we subtract that</span> <span data-start="548.58" data-end="550.11">from the time it took the first image to</span> <span data-start="550.11" data-end="552.15">load we also know how long it takes the</span> </p>
<p><span data-start="552.15" data-end="556.47">TCP handshake to happen right any</span> <span data-start="556.47" data-end="559.29">questions about that so now we can</span> <span data-start="559.29" data-end="560.88">compare because now we know it takes</span> <span data-start="560.88" data-end="563.25">three packets to do a TCP handshake and</span> <span data-start="563.25" data-end="565.82">two packets to download an image</span> <span data-start="565.82" data-end="568.32">typically that image should be</span> <span data-start="568.32" data-end="571.44">two-thirds of the so RTP should be</span> <span data-start="571.44" data-end="576.59">two-thirds of TCP so that makes sense</span> <span data-start="576.59" data-end="580.47">any questions so far how am i doing on</span> <span data-start="580.47" data-end="584.58">time nine minutes so i'm good i finished</span> <span data-start="584.58" data-end="587.7">two parts in nine minutes the third part</span> <span data-start="587.7" data-end="591.27">is going to be tough so you'll notice</span> <span data-start="591.27" data-end="593.64">that we ignored dns lookup time here</span> <span data-start="593.64" data-end="596.01">alright the first connection was</span> <span data-start="596.01" data-end="598.23">actually it doesn't just do a TCP</span> <span data-start="598.23" data-end="600.66">handshake it also needs to do a DNS</span> <span data-start="600.66" data-end="602.34">lookup and we're going to ignore that</span> <span data-start="602.34" data-end="604.83">for now all right we'll assume DNS has</span> <span data-start="604.83" data-end="606.24">been cached but we'll deal with that</span> <span data-start="606.24" data-end="610.44">later assuming a half time so if you</span> <span data-start="610.44" data-end="614.64">notes on this I use a 1 by 1 jiff 35</span> <span data-start="614.64" data-end="616.68">bytes in size and experimented with</span> <span data-start="616.68" data-end="618.15">different types of images the first</span> <span data-start="618.15" data-end="620.58">thing i tried was just in a 204 head up</span> <span data-start="620.58" data-end="623.73">back 204 is no content so I don't</span> <span data-start="623.73" data-end="626.28">actually send any data the problem with</span> <span data-start="626.28" data-end="628.47">that is it will fire an on error event</span> <span data-start="628.47" data-end="631.8">and not an onload event does anyone see</span> <span data-start="631.8" data-end="634.05">a problem with an on-air event I could</span> <span data-start="634.05" data-end="635.79">still measure the time when the ordinary</span> <span data-start="635.79" data-end="639.76">files right</span> <span data-start="639.77" data-end="641.7">exactly I might get a different error</span> <span data-start="641.7" data-end="643.53">right what happens with me users network</span> <span data-start="643.53" data-end="646.08">isn't connected the network drops after</span> <span data-start="646.08" data-end="648.15">he loads my first page so I'm going to</span> <span data-start="648.15" data-end="650.07">get an on error simply because you</span> <span data-start="650.07" data-end="652.53">couldn't connect to the server or there</span> <span data-start="652.53" data-end="654.12">could be a DNS outage or any other</span> <span data-start="654.12" data-end="655.53">outage that's going to cause that error</span> <span data-start="655.53" data-end="657.33">which won't actually measure the latency</span> <span data-start="657.33" data-end="660.51">so I definitely want an onload event I</span> <span data-start="660.51" data-end="664.11">then tried a PNG with which was zero</span> <span data-start="664.11" data-end="667.32">bytes in size then also doesn't work it</span> <span data-start="667.32" data-end="671.7">also fires a non era another interesting</span> <span data-start="671.7" data-end="674.25">with thing with a 2-0 for is uncertain</span> <span data-start="674.25" data-end="676.59">mobile devices it doesn't fire any</span> <span data-start="676.59" data-end="679.53">events so there's no one error no unload</span> <span data-start="679.53" data-end="681.75">nothing it might it'll actually loads up</span> <span data-start="681.75" data-end="684.78">but it doesn't doesn't fly any months so</span> <span data-start="684.78" data-end="686.16">this was the smallest image I could</span> <span data-start="686.16" data-end="688.71">possibly get that actually fits within a</span> </p>
<p><span data-start="688.71" data-end="690.72">TCP packet and also fires an onload</span> <span data-start="690.72" data-end="698.37">event files on all right so third one</span> <span data-start="698.37" data-end="701.03">I'm gonna do now is network throughput</span> <span data-start="701.03" data-end="703.05">does everyone know what network</span> <span data-start="703.05" data-end="706.74">throughput is how does it differ from</span> <span data-start="706.74" data-end="712.73">bandwidth</span> <span data-start="712.74" data-end="717.42">after an hour and bites a dog right</span> <span data-start="717.42" data-end="722.35">right right so you think of it like the</span> <span data-start="722.35" data-end="724.98">station wagon thing right you can put</span> <span data-start="724.98" data-end="727.42">hundreds of magnetic tapes or other data</span> <span data-start="727.42" data-end="729.01">in a station wagon and drive from one</span> <span data-start="729.01" data-end="730.72">place to another and you'll have really</span> <span data-start="730.72" data-end="733.39">high bandwidth right because you get so</span> <span data-start="733.39" data-end="736.6">many petabytes of data across but the</span> <span data-start="736.6" data-end="738.46">latency is so bad so yeah effective</span> <span data-start="738.46" data-end="741.46">throughput is not very good if you take</span> <span data-start="741.46" data-end="743.32">the whole amount of time that it takes</span> <span data-start="743.32" data-end="746.2">to get the data across what we're</span> <span data-start="746.2" data-end="748.8">actually going to measure is how much</span> <span data-start="748.8" data-end="751.96">how much effective use of a network</span> <span data-start="751.96" data-end="754.39">connection we can use so even if i have</span> <span data-start="754.39" data-end="757.72">3 mech data connection i might only be</span> <span data-start="757.72" data-end="759.61">able to use one megabit to actually</span> <span data-start="759.61" data-end="762.64">download data because of various reasons</span> <span data-start="762.64" data-end="764.32">so it should be fairly simple to</span> <span data-start="764.32" data-end="766.33">calculate right download something large</span> <span data-start="766.33" data-end="768.34">and measure how long it takes to</span> <span data-start="768.34" data-end="772">download that this is everyone okay with</span> <span data-start="772" data-end="774.79">that oh do you see holes in this</span> <span data-start="774.79" data-end="780.8">approach</span> <span data-start="780.81" data-end="783.93">alright so looking at that it should be</span> <span data-start="783.93" data-end="785.55">fairly simple we take the same code that</span> <span data-start="785.55" data-end="787.529">we used before just use a larger image</span> <span data-start="787.529" data-end="790.47">and instead of just taking the time we</span> <span data-start="790.47" data-end="792.54">take the size so we use an image of</span> <span data-start="792.54" data-end="795.66">known size divided by the time I also</span> <span data-start="795.66" data-end="797.64">multiply by 1000 here because time is in</span> <span data-start="797.64" data-end="799.44">milliseconds and I want kilobits</span> <span data-start="799.44" data-end="801.42">kilobytes per second or kilo bits per</span> <span data-start="801.42" data-end="804.8">second depending on how I store the size</span> <span data-start="804.8" data-end="807.93">so does this make sense the do you think</span> <span data-start="807.93" data-end="816.03">this will work in all cases</span> <span data-start="816.04" data-end="819.14">tcp or IP packets overhead yeah there is</span> <span data-start="819.14" data-end="823.55">going to be some overhead do we care is</span> <span data-start="823.55" data-end="827.18">it who here is a network engineer not a</span> <span data-start="827.18" data-end="830.81">web developer right so as web developers</span> <span data-start="830.81" data-end="834.17">we don't care about TCP overhead we care</span> <span data-start="834.17" data-end="836.12">specifically how long does it take if I</span> <span data-start="836.12" data-end="839.66">have an image that's 200 kilobytes how</span> <span data-start="839.66" data-end="841.43">long is it going to take for my user to</span> <span data-start="841.43" data-end="843.86">download that so I don't really care</span> <span data-start="843.86" data-end="846.65">about tcp / even though yeah I know it's</span> <span data-start="846.65" data-end="849.02">going to be there and my throughput for</span> <span data-start="849.02" data-end="851.84">me as a web developer is how how much</span> <span data-start="851.84" data-end="855.26">usage my HTTP data is going to make off</span> <span data-start="855.26" data-end="857.84">the network connection so the problem</span> <span data-start="857.84" data-end="860.45">with this it works in some cases it</span> <span data-start="860.45" data-end="863.06">works as long as your image is small</span> <span data-start="863.06" data-end="867.41">enough so naturally I would have</span> <span data-start="867.41" data-end="869.06">finished the talk now if it were that</span> <span data-start="869.06" data-end="871.73">simple the problem is something called</span> </p>
<p><span data-start="871.73" data-end="874.91">TCP slow start who's familiar with TCP</span> <span data-start="874.91" data-end="878.66">slow start you want to tell us what it</span> <span data-start="878.66" data-end="882.52">is yeah start to the lower rate right</span> <span data-start="882.52" data-end="887.8">the client accepts the highway right</span> <span data-start="887.8" data-end="891.14">until the client drops again ready these</span> <span data-start="891.14" data-end="894.279">people we start the connection and</span> <span data-start="894.279" data-end="898.16">alright so yeah DCP slow start was</span> <span data-start="898.16" data-end="900.32">basically created to avoid network</span> <span data-start="900.32" data-end="902.69">congestion let's assume that a server</span> <span data-start="902.69" data-end="905.32">sends data as fast as it possibly can</span> <span data-start="905.32" data-end="907.79">now typically servers are way faster</span> <span data-start="907.79" data-end="909.98">than service network connections are way</span> <span data-start="909.98" data-end="912.339">faster than a home users network</span> <span data-start="912.339" data-end="914.63">connections so if they just throw out</span> <span data-start="914.63" data-end="917.6">data as fast as they possibly can the</span> <span data-start="917.6" data-end="918.56">network is going to get clogged</span> <span data-start="918.56" data-end="920.66">somewhere in between and everything else</span> <span data-start="920.66" data-end="923.06">is going to slow down so what servers do</span> <span data-start="923.06" data-end="925.04">is they'll send two packets first and</span> <span data-start="925.04" data-end="927.38">then wait oh well any end of a TCP</span> <span data-start="927.38" data-end="929.42">connection will send two packets and</span> <span data-start="929.42" data-end="930.77">then wait for an acknowledgement and</span> <span data-start="930.77" data-end="932.21">when it gets the acknowledgement it says</span> <span data-start="932.21" data-end="934.22">if it gets the acknowledgement within a</span> <span data-start="934.22" data-end="935.9">certain amount of time it says okay this</span> <span data-start="935.9" data-end="938.66">client can actually handle that speed so</span> <span data-start="938.66" data-end="940.82">let's try increasing the speed so it'll</span> <span data-start="940.82" data-end="944.12">double it and keep keep increasing it as</span> <span data-start="944.12" data-end="945.529">as long as it keeps getting</span> <span data-start="945.529" data-end="946.91">acknowledgments within the amount of</span> <span data-start="946.91" data-end="949.37">time now if any acknowledgement actually</span> <span data-start="949.37" data-end="951.2">doesn't come through in the amount of</span> <span data-start="951.2" data-end="954.47">time the the other end will assume that</span> <span data-start="954.47" data-end="956.99">all right the send is congested it's</span> <span data-start="956.99" data-end="959.12">buffers are full it can accept more data</span> <span data-start="959.12" data-end="961.81">so I'm going to back down and reduce the</span> <span data-start="961.81" data-end="965.06">reduce the number of packets i can send</span> <span data-start="965.06" data-end="968">so by default the window size is set to</span> <span data-start="968" data-end="969.8">2 which means i'm going to send two</span> <span data-start="969.8" data-end="970.91">packets and then wait for an</span> <span data-start="970.91" data-end="972.23">acknowledgement and when i get the</span> <span data-start="972.23" data-end="973.76">acknowledgement and then going to send</span> <span data-start="973.76" data-end="975.02">four packets and wait for an</span> <span data-start="975.02" data-end="977.45">acknowledgement and so on so the problem</span> <span data-start="977.45" data-end="979.1">is we have all this dead time right</span> <span data-start="979.1" data-end="981.47">between sending the second packet and</span> <span data-start="981.47" data-end="983.75">second sending the third packet we're</span> <span data-start="983.75" data-end="985.43">doing nothing the network's not being</span> <span data-start="985.43" data-end="987.2">used at all and so we're not really</span> <span data-start="987.2" data-end="989.87">measuring how good that network</span> <span data-start="989.87" data-end="993.62">connection is we are measuring for just</span> <span data-start="993.62" data-end="995.06">opening a connection at that point of</span> <span data-start="995.06" data-end="997.67">time how good it is not how how good</span> <span data-start="997.67" data-end="999.86">it's going to be going forward so we</span> <span data-start="999.86" data-end="1003.64">need to do something else a simple thing</span> <span data-start="1003.64" data-end="1006.67">is use a resource that fits within a</span> <span data-start="1006.67" data-end="1009.73">window right so something that fits</span> <span data-start="1009.73" data-end="1012.79">within two packets is that going to work</span> <span data-start="1012.79" data-end="1017.11">any guesses can we use maybe a 2</span> <span data-start="1017.11" data-end="1019.42">kilobyte image and say I'll measure the</span> <span data-start="1019.42" data-end="1021.13">time it took a two kilobyte image to</span> <span data-start="1021.13" data-end="1023.31">download</span> <span data-start="1023.32" data-end="1026.23">the problem is we have a wide variety of</span> <span data-start="1026.23" data-end="1029.68">network connection types that vary in</span> <span data-start="1029.68" data-end="1031.78">the effective bandwidth they provide to</span> <span data-start="1031.78" data-end="1035.079">users so you use a 2 kilobyte image on a</span> <span data-start="1035.079" data-end="1037.27">3 megabit connection it's going to</span> <span data-start="1037.27" data-end="1038.68">download really fast it's not going to</span> <span data-start="1038.68" data-end="1041.29">use up any of the bandwidth at all you</span> <span data-start="1041.29" data-end="1043.48">want to use a large image for some</span> <span data-start="1043.48" data-end="1046.42">network connection that fast but what</span> <span data-start="1046.42" data-end="1052.4">happens if you use a net large image and</span> <span data-start="1052.41" data-end="1056.11">does that it yeah that's it so try and</span> <span data-start="1056.11" data-end="1060.07">use a different image so start off with</span> <span data-start="1060.07" data-end="1062.14">a small image that's going to fit within</span> <span data-start="1062.14" data-end="1064.72">that to packet size and then once that</span> <span data-start="1064.72" data-end="1066.7">is downloaded I'll say ok now my window</span> <span data-start="1066.7" data-end="1068.53">size is going to be increased so let's</span> <span data-start="1068.53" data-end="1070.09">now put in an image that's going to fit</span> <span data-start="1070.09" data-end="1072.55">within 4 packets and once that downloads</span> <span data-start="1072.55" data-end="1074.47">then try loading an image that's going</span> <span data-start="1074.47" data-end="1076.12">to fit within eight packets and so on</span> <span data-start="1076.12" data-end="1078.61">alright so keep increasing it until I</span> <span data-start="1078.61" data-end="1081.72">reach a level that I'm comfortable with</span> <span data-start="1081.72" data-end="1084.82">so this is more or less the code that</span> <span data-start="1084.82" data-end="1087.25">would do that it goes from multiple</span> <span data-start="1087.25" data-end="1090.22">images and calculates the time it would</span> <span data-start="1090.22" data-end="1092.71">take to download each of them and then</span> <span data-start="1092.71" data-end="1094.27">says okay that's my effective bandwidth</span> <span data-start="1094.27" data-end="1096.58">looking at the largest image the problem</span> <span data-start="1096.58" data-end="1099.16">with this is slow Network really large</span> <span data-start="1099.16" data-end="1102.79">image say 100 megabyte image on a 64</span> <span data-start="1102.79" data-end="1104.56">kbps connection how long is that going</span> <span data-start="1104.56" data-end="1108.16">to take to download even with a full</span> <span data-start="1108.16" data-end="1110.02">window size it's going to take a long</span> <span data-start="1110.02" data-end="1111.37">time the users just going to be waiting</span> <span data-start="1111.37" data-end="1114.04">for you to do your measurement so not a</span> <span data-start="1114.04" data-end="1117.48">good idea so what we end up doing is</span> <span data-start="1117.48" data-end="1120.07">let's say we we throw in a time out and</span> <span data-start="1120.07" data-end="1121.81">say alright I'm going to download it</span> <span data-start="1121.81" data-end="1123.67">still download images in ascending or</span> <span data-start="1123.67" data-end="1126.7">size but I'm going to set it timeout</span> <span data-start="1126.7" data-end="1128.89">value for each of them so if an image</span> <span data-start="1128.89" data-end="1130.75">times out if it takes longer than say</span> <span data-start="1130.75" data-end="1133.42">point eight seconds or one second to</span> <span data-start="1133.42" data-end="1135.07">download I'm going to say ok this</span> <span data-start="1135.07" data-end="1136.75">network connection cannot handle an</span> <span data-start="1136.75" data-end="1138.67">image larger than the size and that's</span> <span data-start="1138.67" data-end="1142.48">where I'm going to stop so we go from we</span> <span data-start="1142.48" data-end="1144.34">actually tested with images starting</span> <span data-start="1144.34" data-end="1146.29">from 11 kilobytes going all the way up</span> <span data-start="1146.29" data-end="1150.19">to six hundred megabytes so we have</span> <span data-start="1150.19" data-end="1151.99">images of those sizes and we set a time</span> <span data-start="1151.99" data-end="1154.75">upset between 800 milliseconds and</span> <span data-start="1154.75" data-end="1156.47">twelve hundred milliseconds</span> <span data-start="1156.47" data-end="1158.419">so if an image times out we say that's</span> <span data-start="1158.419" data-end="1160.039">the last image we're going to download</span> <span data-start="1160.039" data-end="1161.84">measure the time it takes that image to</span> <span data-start="1161.84" data-end="1164.419">load and this is what we're doing here</span> <span data-start="1164.419" data-end="1167">so we have a set time out there when the</span> <span data-start="1167" data-end="1169.52">time out files we just set say that this</span> <span data-start="1169.52" data-end="1174.02">image expired the time out if the images</span> <span data-start="1174.02" data-end="1175.61">on load actually files clear the time</span> <span data-start="1175.61" data-end="1178.28">outs so that we don't we don't fail it</span> <span data-start="1178.28" data-end="1182.87">and then we end the test if any of the</span> <span data-start="1182.87" data-end="1184.52">images time up so when an image time's</span> <span data-start="1184.52" data-end="1186.08">up we say that's the end of the test</span> <span data-start="1186.08" data-end="1188.33">let's go ahead and start measurement at</span> <span data-start="1188.33" data-end="1190.039">that point of time so do our</span> <span data-start="1190.039" data-end="1192.23">calculations at that point the</span> <span data-start="1192.23" data-end="1194.45">calculation code is actually this pretty</span> <span data-start="1194.45" data-end="1195.77">much the same as what we saw in the</span> <span data-start="1195.77" data-end="1197.84">first case just take the size of the</span> <span data-start="1197.84" data-end="1199.309">largest image and the time it took to</span> <span data-start="1199.309" data-end="1201.98">download and do either to get the</span> <span data-start="1201.98" data-end="1206.96">bandwidth so you think that's good</span> <span data-start="1206.96" data-end="1216.679">enough right all right how would we deal</span> <span data-start="1216.679" data-end="1224.87">with that checksum the image</span> <span data-start="1224.88" data-end="1226.96">how do you check someone image on the</span> <span data-start="1226.96" data-end="1231.37">client-side canvas I guess throw it into</span> <span data-start="1231.37" data-end="1234.16">canvas get the image data and check some</span> <span data-start="1234.16" data-end="1238.39">all right I've never tried that so I've</span> <span data-start="1238.39" data-end="1239.92">never tried that so I don't know but</span> <span data-start="1239.92" data-end="1242.14">actually thinking about mobile networks</span> <span data-start="1242.14" data-end="1244.6">we actually saw a problem not just with</span> <span data-start="1244.6" data-end="1247.21">mobile networks but mm different kinds</span> <span data-start="1247.21" data-end="1249.37">of networks if you run the same</span> <span data-start="1249.37" data-end="1251.29">bandwidth test multiple times you're</span> <span data-start="1251.29" data-end="1253.03">going to get different results all</span> <span data-start="1253.03" data-end="1254.5">rights simply because there's network</span> <span data-start="1254.5" data-end="1255.94">jitter there's other things happening on</span> <span data-start="1255.94" data-end="1261.07">the network so you can't really rely</span> <span data-start="1261.07" data-end="1263.74">just do a single test and say that's my</span> <span data-start="1263.74" data-end="1265.3">users network throughput I'm going to</span> <span data-start="1265.3" data-end="1266.92">store it in a cookie and assume that</span> <span data-start="1266.92" data-end="1268.72">that's how fast the network is every</span> <span data-start="1268.72" data-end="1272.62">time they come to us so I'm not going to</span> <span data-start="1272.62" data-end="1274">show you the code here but what we end</span> <span data-start="1274" data-end="1276.34">up doing is statistical sampling we run</span> <span data-start="1276.34" data-end="1278.32">it the same test multiple times at</span> <span data-start="1278.32" data-end="1280.87">different times and then take the median</span> <span data-start="1280.87" data-end="1282.28">of all of them so we don't take the</span> <span data-start="1282.28" data-end="1284.2">fastest we don't take the slowest we</span> <span data-start="1284.2" data-end="1286.66">take a median and say that's more or</span> <span data-start="1286.66" data-end="1289.48">less an order of magnitude of the users</span> <span data-start="1289.48" data-end="1292.66">network throughput so typical error</span> <span data-start="1292.66" data-end="1294.79">rates we've seen is actually twenty-five</span> <span data-start="1294.79" data-end="1297.07">to thirty percent in actually getting</span> <span data-start="1297.07" data-end="1300.01">the network throughput whereas in terms</span> <span data-start="1300.01" data-end="1302.89">of latency we see an error 4.5 to one</span> <span data-start="1302.89" data-end="1305.5">percent so you can see the difference in</span> <span data-start="1305.5" data-end="1308.56">mesh in accuracy of the two different</span> <span data-start="1308.56" data-end="1313.6">measurements right yeah so the code is</span> <span data-start="1313.6" data-end="1315.64">actually fairly big if you do want to</span> <span data-start="1315.64" data-end="1317.56">see the code for this it's in boomerang</span> <span data-start="1317.56" data-end="1320.77">project which is on github and have a</span> <span data-start="1320.77" data-end="1322.36">link to that at the end of my slides</span> <span data-start="1322.36" data-end="1327.07">right so number for DNS how am i doing</span> <span data-start="1327.07" data-end="1332.62">on time eight minutes to go so we spoke</span> <span data-start="1332.62" data-end="1334.15">about DNS briefly in the beginning</span> <span data-start="1334.15" data-end="1336.52">anyone know how we're going to calculate</span> <span data-start="1336.52" data-end="1343.15">the NS time</span> <span data-start="1343.16" data-end="1348.34">no one</span> <span data-start="1348.35" data-end="1351.149">right so yeah that's that's more or less</span> <span data-start="1351.149" data-end="1352.95">what you do is make to request one with</span> <span data-start="1352.95" data-end="1354.779">the post name and the second with the IP</span> <span data-start="1354.779" data-end="1357.09">address or the other way around and take</span> <span data-start="1357.09" data-end="1360.029">the difference between the two so time</span> <span data-start="1360.029" data-end="1363.659">with DNS minus time without DNS which is</span> <span data-start="1363.659" data-end="1365.309">the same code again that we've used</span> <span data-start="1365.309" data-end="1367.07">except we have different host names</span> <span data-start="1367.07" data-end="1371.629">right so this works in many cases except</span> <span data-start="1371.629" data-end="1374.669">what happens if the DNS the host name</span> <span data-start="1374.669" data-end="1378.98">was already cashed in browsers DNS is</span> <span data-start="1378.98" data-end="1384.019">there some way to flush the cache</span> <span data-start="1384.029" data-end="1387.429">you can do it is that gonna happen</span> <span data-start="1387.429" data-end="1393.22">immediately yeah someone else I have</span> <span data-start="1393.22" data-end="1396.76">they Hannah look up an invalid hostname</span> <span data-start="1396.76" data-end="1398.919">which will return a non era and you</span> <span data-start="1398.919" data-end="1401.11">that'll that'll have written an on-air</span> <span data-start="1401.11" data-end="1403.51">oh right and you can't tell the</span> <span data-start="1403.51" data-end="1406.69">difference between a non era because DNS</span> <span data-start="1406.69" data-end="1408.669">was wrong or because something else</span> <span data-start="1408.669" data-end="1416.559">failed yep right so pretty much that's</span> <span data-start="1416.559" data-end="1418.57">that's what you do i'm i'm not putting</span> <span data-start="1418.57" data-end="1420.85">the code here but dns is already cashed</span> <span data-start="1420.85" data-end="1422.83">what you do is set up a wild-card dns</span> <span data-start="1422.83" data-end="1426.33">entry on your server say anything dot</span> <span data-start="1426.33" data-end="1429.07">hostname com maps to this one IP address</span> <span data-start="1429.07" data-end="1431.35">and then generate a random hostname on</span> <span data-start="1431.35" data-end="1435.25">the client side just pay 64 encode a a</span> <span data-start="1435.25" data-end="1438.25">random number and look up that hostname</span> <span data-start="1438.25" data-end="1440.2">so the probability of it being cached is</span> <span data-start="1440.2" data-end="1442.57">pretty low right there's still a chance</span> <span data-start="1442.57" data-end="1445">that that random host name was already</span> <span data-start="1445" data-end="1447.159">cash but it's fairly low so you do a</span> <span data-start="1447.159" data-end="1451.87">lookup for a random host name there's</span> <span data-start="1451.87" data-end="1453.399">another problem so we're looking at</span> <span data-start="1453.399" data-end="1455.529">hostname and IP address what happens if</span> <span data-start="1455.529" data-end="1459.58">we're doing we are assigning IP lookups</span> <span data-start="1459.58" data-end="1462.22">based on geolocation so you can't just</span> <span data-start="1462.22" data-end="1464.08">use a static hope and static IP address</span> <span data-start="1464.08" data-end="1469.27">in that case</span> <span data-start="1469.28" data-end="1476.6">any guesses yeah well you may or may not</span> <span data-start="1476.6" data-end="1483.71">be controlling the DNS so so okay if you</span> <span data-start="1483.71" data-end="1485.96">do control the DNS yeah you know exactly</span> <span data-start="1485.96" data-end="1487.34">where they're coming from when they make</span> <span data-start="1487.34" data-end="1489.26">the request so you can set the IP at</span> <span data-start="1489.26" data-end="1490.91">that point of time again you might be</span> <span data-start="1490.91" data-end="1493.16">route around robbing going round robin</span> <span data-start="1493.16" data-end="1494.51">between host names with the nursing</span> <span data-start="1494.51" data-end="1497.24">between IPS within a single zone so</span> <span data-start="1497.24" data-end="1500.48">another way to do that is you do a one</span> <span data-start="1500.48" data-end="1503.99">look up with the host name then do</span> <span data-start="1503.99" data-end="1506.24">another look up after you finish the</span> <span data-start="1506.24" data-end="1508.25">first look up to two lookups in parallel</span> <span data-start="1508.25" data-end="1510.89">so do to image loads in parallel right</span> <span data-start="1510.89" data-end="1513.14">so the first one is going to do a DNS</span> <span data-start="1513.14" data-end="1516.92">lookup plus a TCP handshake the second</span> <span data-start="1516.92" data-end="1519.86">one is going to use the connection</span> <span data-start="1519.86" data-end="1521.75">that's already open so there's no dns</span> <span data-start="1521.75" data-end="1525.34">lookup but it does just as a round-trip</span> <span data-start="1525.34" data-end="1528.2">using those two you get dns plus tcp and</span> <span data-start="1528.2" data-end="1530.09">then the second one that's running in</span> <span data-start="1530.09" data-end="1531.71">third one that's running in parallel</span> <span data-start="1531.71" data-end="1534.32">there's a TCP handshake plus a roundtrip</span> <span data-start="1534.32" data-end="1536.51">so you take the difference of the first</span> <span data-start="1536.51" data-end="1538.37">and a third one and that gives you the</span> </p>
<p><span data-start="1538.37" data-end="1541.7">DNS lookup time so I haven't put code</span> <span data-start="1541.7" data-end="1544.73">here for that because again it gets way</span> <span data-start="1544.73" data-end="1546.35">too complicated but you can look it up</span> <span data-start="1546.35" data-end="1551.36">in the DNS plugin in boomerang right so</span> <span data-start="1551.36" data-end="1554.81">boomerang has various plugins for doing</span> <span data-start="1554.81" data-end="1557.15">Network lookups and this is in DNS</span> <span data-start="1557.15" data-end="1560.39">plugin how am i doing on time five</span> <span data-start="1560.39" data-end="1567.94">minutes to go two parts to go so ipv6</span> <span data-start="1567.94" data-end="1570.35">what we really want to measure with ipv6</span> <span data-start="1570.35" data-end="1573.44">well ipv6 is still not very widely</span> <span data-start="1573.44" data-end="1575.57">spread so the main thing we really want</span> <span data-start="1575.57" data-end="1577.82">to know is is ipv6 supported by this</span> <span data-start="1577.82" data-end="1580.64">user or this user's network connection</span> <span data-start="1580.64" data-end="1583.36">and if it is supported how fast is it</span> <span data-start="1583.36" data-end="1586.28">not just how fast is it but how fast is</span> <span data-start="1586.28" data-end="1591.2">it to do a DNS lookup for a qua da for a</span> <span data-start="1591.2" data-end="1594.14">record and how fast is it to just load</span> <span data-start="1594.14" data-end="1598.46">an image from there so we do two</span> <span data-start="1598.46" data-end="1600.26">different things first try to load an</span> <span data-start="1600.26" data-end="1602.34">image from an ipv6</span> <span data-start="1602.34" data-end="1604.62">so host using the ipv6 address not using</span> <span data-start="1604.62" data-end="1606.87">a hostname by using the ipv6 address</span> <span data-start="1606.87" data-end="1610.2">itself if that times out and we set a</span> <span data-start="1610.2" data-end="1612.09">reasonable time out that either times</span> <span data-start="1612.09" data-end="1615.029">out our gives us an on error then we say</span> <span data-start="1615.029" data-end="1617.34">ipv6 is not supported by the source so</span> <span data-start="1617.34" data-end="1619.32">we'll just stop at that point of time if</span> <span data-start="1619.32" data-end="1621.48">it does go through and we do get a</span> <span data-start="1621.48" data-end="1623.58">response then we measure the latency of</span> <span data-start="1623.58" data-end="1626.07">that and go through the next step which</span> <span data-start="1626.07" data-end="1628.11">is try to load the same image using a</span> <span data-start="1628.11" data-end="1631.679">hostname so the first test first test</span> <span data-start="1631.679" data-end="1633.87">checks of ipv6 is supported the second</span> <span data-start="1633.87" data-end="1637.679">test checks if dns lookup of ipv6 hosts</span> <span data-start="1637.679" data-end="1639.63">works so it's important that this</span> <span data-start="1639.63" data-end="1641.429">hostname only resolved to an ipv6</span> <span data-start="1641.429" data-end="1645.75">address and not to an ipv4 address I've</span> <span data-start="1645.75" data-end="1647.789">had trouble finding some hosting</span> <span data-start="1647.789" data-end="1649.409">providers don't actually let you do that</span> <span data-start="1649.409" data-end="1651.149">they'll always give you an ipv4 address</span> <span data-start="1651.149" data-end="1654.27">and let you add an ipv6 address to it so</span> <span data-start="1654.27" data-end="1655.89">if you have that kind of a provider you</span> <span data-start="1655.89" data-end="1658.44">can't really do this test things likely</span> <span data-start="1658.44" data-end="1662.07">note will allow you to do that ec2 if</span> <span data-start="1662.07" data-end="1665.64">you use there and the load balancer it</span> <span data-start="1665.64" data-end="1667.529">allows you to assign only an ipv6</span> <span data-start="1667.529" data-end="1670.74">address so using that you can tell</span> <span data-start="1670.74" data-end="1675.97">whether DNS lookup works for ipv6 or not</span> <span data-start="1675.98" data-end="1678.63">so again the full code for this is in</span> <span data-start="1678.63" data-end="1681.87">boomerangs ipv6 plugin it's too big to</span> <span data-start="1681.87" data-end="1684.149">fit on a slide so I not put it here does</span> <span data-start="1684.149" data-end="1685.679">anyone want to see it I can open it up</span> <span data-start="1685.679" data-end="1692.48">in a text editor no all right so finally</span> <span data-start="1692.48" data-end="1696.029">network scanning using javascript how</span> <span data-start="1696.029" data-end="1699.38">would you go about this in two minutes</span> <span data-start="1699.38" data-end="1702.419">so where network scanning is actually</span> <span data-start="1702.419" data-end="1704.88">quite a wide topic but what we care</span> <span data-start="1704.88" data-end="1706.919">about is a few different things first</span> <span data-start="1706.919" data-end="1709.26">find out what kind of network the users</span> <span data-start="1709.26" data-end="1711.51">on and secondly do they have anything</span> <span data-start="1711.51" data-end="1713.01">interesting running on their private</span> <span data-start="1713.01" data-end="1717.57">network right so the interesting thing</span> <span data-start="1717.57" data-end="1719.01">about JavaScript running within a</span> <span data-start="1719.01" data-end="1720.659">browser that's different from a port</span> <span data-start="1720.659" data-end="1723.299">scanner or something running on my host</span> <span data-start="1723.299" data-end="1725.64">is that javascript has access to the</span> <span data-start="1725.64" data-end="1728.25">users private network so if the users on</span> <span data-start="1728.25" data-end="1730.559">a lan connecting by a gateway to the</span> <span data-start="1730.559" data-end="1732.87">internet i can get javascript in there</span> <span data-start="1732.87" data-end="1734.52">onto their browser that's then going to</span> <span data-start="1734.52" data-end="1734.88">run</span> <span data-start="1734.88" data-end="1736.95">privileges of their browser so it has</span> <span data-start="1736.95" data-end="1738.81">access to the internal network that I</span> <span data-start="1738.81" data-end="1742.65">don't have access to from outside so you</span> <span data-start="1742.65" data-end="1744.72">can scan the users private land how</span> <span data-start="1744.72" data-end="1746.88">would you do that I'll try and load</span> <span data-start="1746.88" data-end="1749.61">something from 192.168 point 1 point 1</span> <span data-start="1749.61" data-end="1752.19">or 0 point 0.1 or 10 point zero point</span> <span data-start="1752.19" data-end="1754.08">zero point one you can hydrate through</span> <span data-start="1754.08" data-end="1755.52">these pretty quickly run them all in</span> <span data-start="1755.52" data-end="1761.28">parallel and find out what loads once</span> <span data-start="1761.28" data-end="1763.32">you find out which network they're on</span> <span data-start="1763.32" data-end="1765.62">whether they on 192 or gender or point 0</span> <span data-start="1765.62" data-end="1768.2">then you'll start looking for common</span> <span data-start="1768.2" data-end="1771.48">look for standard routers so every</span> <span data-start="1771.48" data-end="1774.54">single router words and linksys or net</span> <span data-start="1774.54" data-end="1777.09">here something they have a logo right</span> <span data-start="1777.09" data-end="1780.66">and that logo is not protected by an</span> <span data-start="1780.66" data-end="1782.25">admin username and password so try to</span> <span data-start="1782.25" data-end="1784.89">low load that logo image if the lower</span> <span data-start="1784.89" data-end="1786.66">logo image loads if you get an onload</span> <span data-start="1786.66" data-end="1788.55">event firing you know that's the kind of</span> <span data-start="1788.55" data-end="1791.58">router they using then you basically try</span> <span data-start="1791.58" data-end="1792.99">standard exploits for that particular</span> <span data-start="1792.99" data-end="1796.62">router try and gain access to it most</span> <span data-start="1796.62" data-end="1798.15">people don't change default user names</span> <span data-start="1798.15" data-end="1801.21">and passwords so you can actually try</span> <span data-start="1801.21" data-end="1803.34">and login it is assuming they're already</span> <span data-start="1803.34" data-end="1805.5">on the private network they can actually</span> <span data-start="1805.5" data-end="1807.57">get admin access so they don't allow</span> <span data-start="1807.57" data-end="1809.4">admin access from the external interface</span> <span data-start="1809.4" data-end="1810.78">but the allow admin access from the</span> <span data-start="1810.78" data-end="1813">internal interface except Java scripts</span> <span data-start="1813" data-end="1815.87">going in from the internal interface so</span> <span data-start="1815.87" data-end="1818.94">yeah you can get admin access if you're</span> <span data-start="1818.94" data-end="1820.56">lucky and they've recently logged in the</span> <span data-start="1820.56" data-end="1822.12">cookies are still in their browser and</span> <span data-start="1822.12" data-end="1824.7">the Brazil happily log you in without</span> <span data-start="1824.7" data-end="1826.98">you having to pass username and password</span> <span data-start="1826.98" data-end="1832.62">in using a 401 auth so that's that's one</span> <span data-start="1832.62" data-end="1833.82">thing to do and there's actually an</span> <span data-start="1833.82" data-end="1836.49">example this guy named Sammy come car</span> <span data-start="1836.49" data-end="1839.76">built a script that will actually do all</span> <span data-start="1839.76" data-end="1842.04">of this go into your router get your mac</span> <span data-start="1842.04" data-end="1844.92">address do a google location look up and</span> <span data-start="1844.92" data-end="1847.59">figure out your home address just by you</span> <span data-start="1847.59" data-end="1851.81">visiting a website</span> <span data-start="1851.82" data-end="1854.28">the other thing you can do is then scan</span> <span data-start="1854.28" data-end="1856.8">the internal network so it instils once</span> <span data-start="1856.8" data-end="1858.54">you know which network they were which</span> <span data-start="1858.54" data-end="1860.16">subnet they're on you start scanning</span> <span data-start="1860.16" data-end="1862.32">that for interesting ports so look for</span> <span data-start="1862.32" data-end="1866.06">port 80 look for port 22 oh look for 43</span> <span data-start="1866.06" data-end="1869.91">3306 you could look for the admin ports</span> <span data-start="1869.91" data-end="1872.84">of different database services and</span> <span data-start="1872.84" data-end="1875.82">measure how long it takes to respond so</span> <span data-start="1875.82" data-end="1877.92">in most cases you'll always get a non</span> <span data-start="1877.92" data-end="1881.04">error for these things because let's say</span> <span data-start="1881.04" data-end="1882.6">a mysql server is not going to respond</span> <span data-start="1882.6" data-end="1885.24">to an HTTP request so you'll get it well</span> <span data-start="1885.24" data-end="1886.77">it's not going to respond with HTTP</span> <span data-start="1886.77" data-end="1888.84">you're going to get mysql protocol back</span> <span data-start="1888.84" data-end="1890.85">so you'll get a non error for most of</span> <span data-start="1890.85" data-end="1894.24">them but you'll get some error so if</span> <span data-start="1894.24" data-end="1896.16">it's a short time out that means you</span> <span data-start="1896.16" data-end="1897.81">make a request there's nothing there you</span> <span data-start="1897.81" data-end="1900.3">get a connection refused error that</span> <span data-start="1900.3" data-end="1902.1">times out really quickly remember it's</span> <span data-start="1902.1" data-end="1903.93">on their local network it's not going</span> <span data-start="1903.93" data-end="1905.46">over the internet so it times out</span> <span data-start="1905.46" data-end="1907.65">quickly if it takes a little longer time</span> <span data-start="1907.65" data-end="1909.12">to time out and you'll actually have to</span> <span data-start="1909.12" data-end="1910.98">test this out on your own network to</span> <span data-start="1910.98" data-end="1912.99">find out what it is so a little longer</span> <span data-start="1912.99" data-end="1914.67">to timeout it means something's</span> <span data-start="1914.67" data-end="1917.07">listening there but it's not HTTP and if</span> <span data-start="1917.07" data-end="1919.59">it takes a fairly reasonably a long time</span> <span data-start="1919.59" data-end="1922.08">to time out it's probably HTTP you've</span> <span data-start="1922.08" data-end="1923.91">got a response from an HTTP server but</span> <span data-start="1923.91" data-end="1926.1">it's not an image so it timed out</span> <span data-start="1926.1" data-end="1930.54">actually you got an error at the at the</span> <span data-start="1930.54" data-end="1932.46">passer level within the browser rather</span> <span data-start="1932.46" data-end="1935.55">than at the connection level then you</span> <span data-start="1935.55" data-end="1937.65">try an iframe so an iframe can load any</span> </p>
<p><span data-start="1937.65" data-end="1940.14">HTTP content and it will return an</span> <span data-start="1940.14" data-end="1942.93">onload if HTTP loads and then on error</span> <span data-start="1942.93" data-end="1945.99">if non HD be loads so those are the</span> <span data-start="1945.99" data-end="1949.62">different things you try and that</span> <span data-start="1949.62" data-end="1953.67">basically concludes my top two minutes</span> <span data-start="1953.67" data-end="1957.27">over right so source code for most of</span> <span data-start="1957.27" data-end="1959.49">this stuff is either at the boomerang</span> <span data-start="1959.49" data-end="1963.48">project yep or the last one the network</span> <span data-start="1963.48" data-end="1969.38">scanning stuff is Sameera PL / map xss</span> <span data-start="1969.38" data-end="1984.05">any questions</span> <span data-start="1984.06" data-end="1988.76">alright</span> <span data-start="1988.77" data-end="1992.82">oh so</span> <span data-start="1992.83" data-end="1995.44">so let me repeat the question says by</span> <span data-start="1995.44" data-end="1997.09">scanning internal ports can we figure</span> <span data-start="1997.09" data-end="1999.22">out what the business of that particular</span> <span data-start="1999.22" data-end="2004.89">person is right I don't know anyone just</span> <span data-start="2004.89" data-end="2006.33">by knowing what services they're running</span> <span data-start="2006.33" data-end="2007.59">internally would you be able to tell</span> <span data-start="2007.59" data-end="2017.58">what all right assuming it's running</span> </p>
<p><span data-start="2017.58" data-end="2026.94">HTTP because but but would you would you</span> <span data-start="2026.94" data-end="2029.49">get that back using javascript that can</span> <span data-start="2029.49" data-end="2035.58">only read HTTP well no you can get into</span> <span data-start="2035.58" data-end="2037.26">connect so you know that it can connect</span> <span data-start="2037.26" data-end="2039.269">but you'll always get an error you won't</span> <span data-start="2039.269" data-end="2047.21">get actually get a responsible</span> <span data-start="2047.22" data-end="2053.59">like it but you'll always have an HTTP</span> <span data-start="2053.59" data-end="2061.75">header other all right all right so i</span> <span data-start="2061.75" data-end="2062.98">don't know you can do various things</span> <span data-start="2062.98" data-end="2065.59">i've also tried doing a soap so doing</span> <span data-start="2065.59" data-end="2067.84">posting to a soap service if you can</span> <span data-start="2067.84" data-end="2070.18">send a crafted soap request and find out</span> <span data-start="2070.18" data-end="2072.13">what servers running there you can do</span> <span data-start="2072.13" data-end="2073.81">interesting things sometimes again if</span> <span data-start="2073.81" data-end="2076.75">there's in securely configured services</span> <span data-start="2076.75" data-end="2079.12">you can actually get that service to</span> <span data-start="2079.12" data-end="2081.04">post a response back to your external</span> <span data-start="2081.04" data-end="2083.14">web service so you can get it to do like</span> <span data-start="2083.14" data-end="2087.04">an LS or do whatever and send data so</span> <span data-start="2087.04" data-end="2088.93">actually post data to your external web</span> <span data-start="2088.93" data-end="2090.91">service where you then see what's</span> <span data-start="2090.91" data-end="2092.53">running there all right any other</span> <span data-start="2092.53" data-end="2096.96">questions</span> </p>
<p><span data-start="2096.97" data-end="2114.64">I sorry I can okay all right so we're</span> <span data-start="2114.64" data-end="2115.78">not really reading anything we're just</span> <span data-start="2115.78" data-end="2117.52">testing to see if something's there or</span> <span data-start="2117.52" data-end="2121.15">not you can't you can't really read</span> <span data-start="2121.15" data-end="2122.59">what's there because it's cross-domain</span> <span data-start="2122.59" data-end="2124.42">although it's running as a script node</span> <span data-start="2124.42" data-end="2128.65">within your with in New York or within</span> <span data-start="2128.65" data-end="2131.41">your page and it's loading an image so</span> <span data-start="2131.41" data-end="2132.97">you can make a cross-domain request your</span> <span data-start="2132.97" data-end="2136.65">car just can't read the response okay</span> <span data-start="2136.65" data-end="2141.22">anything else any other questions but so</span> </p>
<p><span data-start="2141.22" data-end="2143.32">I'm gonna stop here and let the next</span> <span data-start="2143.32" data-end="2145.69">speaker Jago right if you have more</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
