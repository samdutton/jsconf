<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>M3BM9TB-8yA</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/M3BM9TB-8yA?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="0.089" data-end="4.16">Hello.</span> <span data-start="4.16" data-end="19.18">Hey, so, yeah, I kind of wanted to give a different talk about some other stuff, but</span> <span data-start="19.18" data-end="23.56">I wasn't ready, so this is a make-up talk.</span> <span data-start="23.56" data-end="30.13">It's been some years since Node came out, and it's kind of stabilised, and it's a thing,</span> <span data-start="30.13" data-end="33.71">and it's kind of going into its direction.</span> <span data-start="33.71" data-end="39.89">I thought I would look back on it and tell you what I think about Node.</span> <span data-start="39.89" data-end="44.88">So, sorry, I'm a little nervous.</span> <span data-start="44.88" data-end="47.98">Excuse my wavering voice.</span> </p>
<p><span data-start="47.98" data-end="50.04">Right, some background.</span> <span data-start="50.04" data-end="55.43">I created Node and managed it through its initial development for a couple of years,</span> <span data-start="55.43" data-end="67.77">and, my goal, as you may know was really around IO, and doing event-driven IO in JavaScript.</span> <span data-start="67.77" data-end="74.259">I think that focus was really important in 2009 for getting server-side JavaScript off</span> <span data-start="74.259" data-end="83.02">the frowned, because, as we know now, JavaScript is sing-threaded, and like — I'm sorry.</span> <span data-start="83.02" data-end="88.03">And — sorry, lost my train of thought.</span> <span data-start="88.03" data-end="97.21">JavaScript is single-threaded, blah, blah, blah, that allowed Node to succeed.</span> <span data-start="97.21" data-end="106.049">I felt that Node was doing well in the IO department.</span> <span data-start="106.049" data-end="116.479">Like we had protocol supports, like HTTP, and HTTPS, and we ported Node to windows using</span> <span data-start="116.479" data-end="124.06">a nice systems calls IOCP, and we were running on Linux, Mac, and it had a relatively small</span> <span data-start="124.06" data-end="125.06">core.</span> <span data-start="125.06" data-end="129.409">I mean, it kind of got out of hand a little bit, but it was okay.</span> <span data-start="129.409" data-end="136.25">It has a stable API, MPM was out, and there were people adding modules.</span> <span data-start="136.25" data-end="140.53">I was like, "This project is done now."</span> <span data-start="140.53" data-end="142.29">So wrong!</span> <span data-start="142.29" data-end="151.79">Right, obviously, this is a tremendous effort to keep Node running on everybody's machines</span> <span data-start="151.79" data-end="160.239">as it does today, and keep it updated with JavaScript, and fix the issues with it, and</span> <span data-start="160.239" data-end="167.819">many people have been involved in this effort, many of them are here.</span> </p>
<p><span data-start="167.819" data-end="175.609">And I'm sorry, I'm probably being leaving out many important people.</span> <span data-start="175.609" data-end="182.239">I personally was kind of done with Node, and went on to do other.</span> <span data-start="182.239" data-end="187.959">It's only really in the last six months that I've started using it heavily again.</span> <span data-start="187.959" data-end="196.39">Largely because Go came out, and I was interested in servers, and doing fast servers, and, Go</span> <span data-start="196.39" data-end="199.79">is a better language for doing Fast servers.</span> <span data-start="199.79" data-end="203.34">There was no need for me to be using Node.</span> <span data-start="203.34" data-end="208.04">But, I think Node is quite nice.</span> <span data-start="208.04" data-end="210.67">JavaScript is really quite nice.</span> </p>
<p><span data-start="210.67" data-end="217.269">In particular, dynamic languages with very nice.</span> <span data-start="217.269" data-end="220.93">And they're nice for certain things, I should say.</span> <span data-start="220.93" data-end="226.269">I think if you're building a server, and you want to really control every aspect of it,</span> <span data-start="226.269" data-end="231.769">absolutely, you want it to be statically typed, but in scientific computing, for example,</span> <span data-start="231.769" data-end="238.73">there is a lot of one-off calculations, you're kind of typing into a Jupiter notebook, and</span> <span data-start="238.73" data-end="241.15">you really don't want to hit a type error at that point.</span> <span data-start="241.15" data-end="243.159">You're just trying to plot something, right?</span> <span data-start="243.159" data-end="246.56">There's a time and place for dynamic languages.</span> </p>
<p><span data-start="246.56" data-end="248.349">Prototyping things is another situation.</span> <span data-start="248.349" data-end="252.519">Like you want to move very fast, you don't want to worry about what the abstractions</span> <span data-start="252.519" data-end="255.64">are, you just want to be dynamic.</span> <span data-start="255.64" data-end="262.21">JavaScript, obviously, I mean maybe there's many people that don't agree, but here they</span> <span data-start="262.21" data-end="263.21">do.</span> <span data-start="263.21" data-end="265.84">It is the best dynamic language.</span> <span data-start="265.84" data-end="277.75">So, right, using Node is kind of like nails on chalkboard to me at times, just because</span> <span data-start="277.75" data-end="284.889">I see the bugs that I introduced that aren't really bugs at this point, they're just how</span> <span data-start="284.889" data-end="287.96">it works, but they are bugs.</span> <span data-start="287.96" data-end="293.07">And they were design mistakes made that just cannot be corrected now because there's so</span> <span data-start="293.07" data-end="302.65">much software there that uses it, and I don't know, it offends my sensibilities.</span> </p>
<p><span data-start="302.65" data-end="304.979">It could have been much nicer.</span> <span data-start="304.979" data-end="310.36">So, one regret would be that I didn't stick with promises.</span> <span data-start="310.36" data-end="317.349">So, promises were added very early, and I foolishly removed them not very long after</span> <span data-start="317.349" data-end="322.03">with the idea that we should be minimal and promises introduced an extra object into every</span> <span data-start="322.03" data-end="329.19">callback, and I could see my reasoning at the time, but had that gone differently, it</span> <span data-start="329.19" data-end="336.979">might have made the ecosystem around building asynch await stuff happen faster unclear.</span> </p>
<p><span data-start="336.979" data-end="342.81">It is an alternate history that we will never know.</span> <span data-start="342.81" data-end="347.78">Maybe it was a good thing that promises were removed because it allowed the ecosystem to</span> <span data-start="347.78" data-end="350.729">develop their own tools, and we found the right abstraction.</span> <span data-start="350.729" data-end="355.28">But, I have often thought that I wish I had left that in.</span> <span data-start="355.28" data-end="357.19">That was a rash decision.</span> <span data-start="357.19" data-end="361.72">Did I say all of this?</span> <span data-start="361.72" data-end="363.09">Yes.</span> <span data-start="363.09" data-end="368.94">Another regret is security, because JavaScript is a very secure sandbox, unlike Python, right?</span> <span data-start="368.94" data-end="373.879">Unfortunately, in Node, we just bounce to everything and is there is zero security.</span> <span data-start="373.879" data-end="377.319">You run a Node programme, you have access to all sorts of system calls.</span> <span data-start="377.319" data-end="385.47">That was really a missed opportunity to be able to make a sever side run time that could</span> <span data-start="385.47" data-end="387.55">potentially be secured in certain situations.</span> <span data-start="387.55" data-end="391.16">Obviously, if you wanted to give access to the disk, then people are going to be able</span> <span data-start="391.16" data-end="397.12">to exploit the disk, but there are certain situations where you want to run a programme</span> <span data-start="397.12" data-end="403.539">outside of the web browser, but you don't want to to access the disk or network.</span> </p>
<p><span data-start="403.539" data-end="405.28">For example, a linter.</span> <span data-start="405.28" data-end="413.11">It would be nice to download the massive codebase that Lint is and run it without it taking</span> <span data-start="413.11" data-end="417.74">over my computer — which it could.</span> <span data-start="417.74" data-end="421.18">Yes.</span> <span data-start="421.18" data-end="428.889">Yes, probably biggest regret is the build system.</span> <span data-start="428.889" data-end="430.25">Such a pain.</span> <span data-start="430.25" data-end="436.38">Build systems are very, very difficult and very, very important to building projects.</span> <span data-start="436.38" data-end="442.63">Node uses this thing called jip.</span> <span data-start="442.63" data-end="449.33">If you're writing a module that links to a C library, you use this thing called jip to</span> <span data-start="449.33" data-end="455.83">compile that C library and link it into Node, right?</span> <span data-start="455.83" data-end="462.52">Jip is this thing that Chrome used to use, but Chrome, like abandoned jip for this other</span> <span data-start="462.52" data-end="466.09">tool called GN several years later.</span> <span data-start="466.09" data-end="470.87">We couldn't have predicted that, but that's what happens.</span> <span data-start="470.87" data-end="475.62">Now it has been many years since that happened, and Node is the sole user of jip.</span> <span data-start="475.62" data-end="484.009">It is a funky interface, a JSON file, but it's in Python.</span> <span data-start="484.009" data-end="485.849">It's very terrible.</span> </p>
<p><span data-start="485.849" data-end="487.97">Node has several wrappers around this.</span> <span data-start="487.97" data-end="489.77">One of them is called node.jip.</span> <span data-start="489.77" data-end="494.86">It is layers upon layers of unnecessary complexity.</span> <span data-start="494.86" data-end="497.36">V8 doesn't build with jip any more.</span> <span data-start="497.36" data-end="503.59">It has a jip wrapper to support node, there is just so much unnecessary complex technology</span> <span data-start="503.59" data-end="508.479">there, and, gentlemen, frankly, I think this is one of the biggest failures of the Node</span> <span data-start="508.479" data-end="511.15">technical leadership.</span> <span data-start="511.15" data-end="513.81">It should be dealt with.</span> <span data-start="513.81" data-end="524.65">So, I think yes, I am not sure which direction would be the right way to go at this point.</span> <span data-start="524.65" data-end="525.75">It's a difficult problem.</span> <span data-start="525.75" data-end="536.75">There's a lot of software to support, but I do think that I kind of made a kind of rash</span> <span data-start="536.75" data-end="542.86">decision in thinking that everybody should compile their extension modules.</span> <span data-start="542.86" data-end="547.4">We could have gone with a foreign function interface, which doesn't require any compiling</span> <span data-start="547.4" data-end="552.96">necessarily, although you have to have your dependencies there, but I think this could</span> <span data-start="552.96" data-end="561.37">have been a much more natural and easy interface for people who want to link to system libraries,</span> <span data-start="561.37" data-end="568.7">and many people suggested this to me, namely Bryan Cantrell, but I totally ignored them.</span> </p>
<p><span data-start="568.7" data-end="580.19">And, yes, LBUV moved to autotools which is unacceptable and regrettable.</span> <span data-start="580.19" data-end="582.66">You know who you are!</span> <span data-start="582.66" data-end="584.58">[Laughter].</span> <span data-start="584.58" data-end="585.58">I didn't do that.</span> <span data-start="585.58" data-end="589.3">That's a regret for somebody else.</span> <span data-start="589.3" data-end="591.12">[Laughter].</span> <span data-start="591.12" data-end="593.58">So, right been.</span> </p>
<p><span data-start="593.58" data-end="594.58">Another thing.</span> <span data-start="594.58" data-end="595.58">Package JSON.</span> <span data-start="595.58" data-end="600.16">It is like the life blood of JavaScript at this point.</span> <span data-start="600.16" data-end="607.98">But, you know, at some point, it wasn't, and Isaac of MPM fame more or less defined it,</span> <span data-start="607.98" data-end="613.77">although there might have been some sort of specification, and I largely sanctioned it,</span> <span data-start="613.77" data-end="621.31">and made it popular by allowing require in Node semantics to look into package JSON and</span> <span data-start="621.31" data-end="625.13">look through files.</span> <span data-start="625.13" data-end="634.08">This makes package JSON necessary for programmes, for Node programmes where it was not before,</span> <span data-start="634.08" data-end="640.65">and then ultimately, I included MPM into Node which made MPM made them the standard Node</span> <span data-start="640.65" data-end="655.74">distribution service, and yes, so, I have this problem about the little abstract, but</span> <span data-start="655.74" data-end="662.96">in your JavaScript programme, right, if you require some module, that doesn't completely</span> <span data-start="662.96" data-end="664.8">specify what that module is.</span> <span data-start="664.8" data-end="672.08">It also needs to be defined in your pack age JSON, that is part of the resolution algorithm,</span> <span data-start="672.08" data-end="680.41">like, which version it is and what not, in order to install it, and you also have this</span> <span data-start="680.41" data-end="684.01">Node modules folder which does the modules resolution.</span> <span data-start="684.01" data-end="693.36">So, you know, kind of linking to a package requires a lot of systems here, a lot of components</span> <span data-start="693.36" data-end="697.03">that is not — what's that?</span> </p>
<p><span data-start="697.03" data-end="699.55">I cloud.</span> <span data-start="699.55" data-end="700.81">Urgh.</span> <span data-start="700.81" data-end="703.32">All right.</span> <span data-start="703.32" data-end="711.67">So, yes, I mean, pack age JSON, the problem I have with it is that it gives this rise</span> <span data-start="711.67" data-end="717.74">to a concept of a module as this directory of files, where that wasn't really a concept</span> <span data-start="717.74" data-end="718.74">before.</span> <span data-start="718.74" data-end="720.07">Like we had JavaScript files.</span> <span data-start="720.07" data-end="725.42">On the web, we had JavaScript files, and you can script-tag include them all over the place.</span> <span data-start="725.42" data-end="726.71">There's, like, thing.</span> </p>
<p><span data-start="726.71" data-end="730.98">There is no module pack age as there is in MPM.</span> <span data-start="730.98" data-end="735.86">It is not a necessary abstraction.</span> <span data-start="735.86" data-end="741.39">Package JSON has all this unnecessary noise in it.</span> <span data-start="741.39" data-end="742.87">Like why am I filling this out?</span> <span data-start="742.87" data-end="745.04">I feel like a bookkeeper.</span> <span data-start="745.04" data-end="752.19">This is unnecessary stuff so do when all I'm trying to do is link to a library.</span> <span data-start="752.19" data-end="758.58">I will get to relative URLs.</span> <span data-start="758.58" data-end="765.14">Of course, Node modules get very big because it kind of has this vendoring by default semantics</span> <span data-start="765.14" data-end="772.43">where modules are installed locally into your project folder, so you tend to have, if you</span> <span data-start="772.43" data-end="776">have multiple projects, it gets big.</span> <span data-start="776" data-end="777.19">This was my idea.</span> <span data-start="777.19" data-end="782.47">I regret it.</span> </p>
<p><span data-start="782.47" data-end="788.22">The whole algorithm or resolving module names is just wildly complex.</span> <span data-start="788.22" data-end="796.75">It is kind of been added to over time in ways that are regrettable.</span> <span data-start="796.75" data-end="806.42">I feel like the vendored by default, idea behind Node modules which is what I was going</span> <span data-start="806.42" data-end="811.3">for there was kind of had good intentions, that we know exactly what we are linking to.</span> <span data-start="811.3" data-end="817.13">It was supposed to be explicit, but, in practice, like a Node path type thing, a Python path</span> <span data-start="817.13" data-end="821.12">type thing would have worked.</span> </p>
<p><span data-start="821.12" data-end="824.22">You set an environmental variable.</span> <span data-start="824.22" data-end="831.42">It just deviates greatly from how browsers do stuff, and it's my fault, and I'm very</span> <span data-start="831.42" data-end="836.56">sorry, and, unfortunately, it is impossible to undo now.</span> <span data-start="836.56" data-end="844.09">Also, this whole thing where you don't include the extension in the require module.</span> <span data-start="844.09" data-end="845.45">Why?</span> <span data-start="845.45" data-end="848.62">It's like needlessly non-explicit.</span> <span data-start="848.62" data-end="852.37">You now have to, like, probe the file system for different things.</span> <span data-start="852.37" data-end="855.96">Did you mean .just, .ts?</span> <span data-start="855.96" data-end="861.76">No, just writing the .. extension in there!</span> <span data-start="861.76" data-end="864.81">[Applause].</span> <span data-start="864.81" data-end="871.77">I'm glad you guys agree with me, because there is still some debate about this stuff.</span> </p>
<p><span data-start="871.77" data-end="873.86">People like the extension list thing.</span> <span data-start="873.86" data-end="874.93">It is cleaner.</span> <span data-start="874.93" data-end="877.19">Like no!</span> <span data-start="877.19" data-end="879.41">Yes.</span> <span data-start="879.41" data-end="880.61">Said all that.</span> <span data-start="880.61" data-end="881.64">Also, index.js.</span> <span data-start="881.64" data-end="883">I'm sorry.</span> <span data-start="883" data-end="884">I thought it was cute.</span> <span data-start="884" data-end="885.34">There's index.html.</span> <span data-start="885.34" data-end="892.91">I thought when you include a directory, it would look up index.js.</span> <span data-start="892.91" data-end="896.02">This was needlessly introduced.</span> <span data-start="896.02" data-end="901.63">What I've come to learn now that I'm age willing is that, like, when you're designing a programme,</span> <span data-start="901.63" data-end="905.23">there are things that you think might be cute to add in.</span> <span data-start="905.23" data-end="906.79">You always regret those.</span> <span data-start="906.79" data-end="917.14">If those are unnecessary and simply cute, like don't do them.</span> </p>
<p><span data-start="917.14" data-end="921.66">My problems with Node aren't so much around the IO, and honestly, I like Node.</span> <span data-start="921.66" data-end="922.67">I like programming in it.</span> <span data-start="922.67" data-end="925.11">I think it is relatively nice.</span> <span data-start="925.11" data-end="932.79">It is Unix-y but my problems are more to do with the module system and how it manages</span> <span data-start="932.79" data-end="934.59">user code.</span> <span data-start="934.59" data-end="939.76">And I think this is largely because, when I was making Node, like it was very focused</span> <span data-start="939.76" data-end="941.23">on getting this IO stuff.</span> <span data-start="941.23" data-end="951.01">I was nerding out hard-core on e pull and the module system was essentially an afterthought</span> <span data-start="951.01" data-end="957.94">that got added on as users needed this stuff, and it is reflected in how Node works now.</span> </p>
<p><span data-start="957.94" data-end="962.92">So, yes, with that in mind, I was writing up this talk.</span> <span data-start="962.92" data-end="965.12">It seemed negative.</span> <span data-start="965.12" data-end="970.52">I thought this is shitty to come you mean in front of people and complain about stuff</span> <span data-start="970.52" data-end="977.49">without giving like you should offer some sort of solution, or like at least a prototype</span> <span data-start="977.49" data-end="982.56">of how things might be differently, or how Node might be differently if you designed</span> <span data-start="982.56" data-end="987.67">it today, and all I say is that don't try out this code.</span> <span data-start="987.67" data-end="990.39">It's very, very unusable at this moment.</span> <span data-start="990.39" data-end="992.09">It does not do anything.</span> <span data-start="992.09" data-end="1001.58">Unless you're well versed in LLDB, you should not try building it, but that said, you might</span> <span data-start="1001.58" data-end="1010.53">want to check out — Dano is a secure typescript runtime on V8 working on the tag line.</span> <span data-start="1010.53" data-end="1020.01">Not so sure about that this is a new piece of software, one month old.</span> </p>
<p><span data-start="1020.01" data-end="1027.38">This is my riffing on what I think would be a nice server time runtime these days.</span> <span data-start="1027.38" data-end="1030.919">Event IO is taken for granted.</span> <span data-start="1030.919" data-end="1032.24">We have to do that.</span> <span data-start="1032.24" data-end="1035.329">What else is important?</span> <span data-start="1035.329" data-end="1037.209">For one, security.</span> <span data-start="1037.209" data-end="1040.589">It would be nice to utilise that JavaScript is a sandbox.</span> <span data-start="1040.589" data-end="1048.71">By default no write access, and that users can then opt into various access.</span> <span data-start="1048.71" data-end="1054.37">So, if you want to allow it to access the network, you do dash dash allow network.</span> <span data-start="1054.37" data-end="1062.22">This allows people in situations, you have some code that you want to run without giving</span> <span data-start="1062.22" data-end="1069.519">it much access to the system that you're you are running on, and this allows you to do</span> <span data-start="1069.519" data-end="1074.2">that via the fact that JavaScript is a runtime.</span> </p>
<p><span data-start="1074.2" data-end="1090.51">We don't bind or allow the system to reach into the operating system.</span> <span data-start="1090.51" data-end="1093">All system pulls are done through a message past.</span> <span data-start="1093" data-end="1098.99">There's a single entry point where it's found all over the place, it's very difficult to</span> <span data-start="1098.99" data-end="1106.1">keep track of what is happening in those single entry points, and this has caused a lot of</span> <span data-start="1106.1" data-end="1124.389">problems trying to find the domains, and [sound feed distorted].</span> <span data-start="1124.389" data-end="1131.509">I thought for many years, , having this .. thing would be nice.</span> <span data-start="1131.509" data-end="1135.16">Here's a pig description of what it is.</span> <span data-start="1135.16" data-end="1141.309">You have like the deno process which is written in Go at the moment, although I'm debating</span> <span data-start="1141.309" data-end="1148.85">whether that is the right choice, and you have V8 running there inside of it, and there</span> <span data-start="1148.85" data-end="1156.45">is the send-and-receive calls that are bound into V8, and it can send and receive proto-buff</span> <span data-start="1156.45" data-end="1157.45">messages.</span> <span data-start="1157.45" data-end="1159.779">They're array buffers.</span> <span data-start="1159.779" data-end="1166.429">There is a dispatcher that kind of like sends out messages to various different modules,</span> <span data-start="1166.429" data-end="1172.159">so these modules can kind of on both sides of the kind of privileged and unprivileged</span> <span data-start="1172.159" data-end="1180.03">boundary sync up, and the Go side can handle the system calls and return your request for</span> <span data-start="1180.03" data-end="1186.529">a set time out into a sleeper, whatever, and, in V8, you have a similar module system.</span> </p>
<p><span data-start="1186.529" data-end="1193.62">Inside of V8 itself, you have the typescript compiler, built into the whole executable.</span> <span data-start="1193.62" data-end="1194.7">I love type typescript.</span> <span data-start="1194.7" data-end="1199.11">It is the best thing.</span> <span data-start="1199.11" data-end="1206.289">I don't know the people who did this work at Microsoft, but, man, it is very pragmatic</span> <span data-start="1206.289" data-end="1212.139">and well done and approachable, and I just love the fact that you can start hacking in</span> <span data-start="1212.139" data-end="1216.82">normal JavaScript and just slowly kind of build your project up.</span> <span data-start="1216.82" data-end="1220.279">This was one of the goals of Dart.</span> <span data-start="1220.279" data-end="1227.11">Do you know Dart?</span> <span data-start="1227.11" data-end="1230.22">Total failure!</span> <span data-start="1230.22" data-end="1235.72">Very good intentions and cool, but obviously, a failure at this point.</span> <span data-start="1235.72" data-end="1241.49">Typescript took a totally different approach to the problem and worked completely in JavaScript</span> <span data-start="1241.49" data-end="1248.74">and I think you know, solved it in a way that is satisfying many people, so, if you have</span> <span data-start="1248.74" data-end="1252.25">not been using typescript, like please check it out.</span> <span data-start="1252.25" data-end="1255.889">I want this thing to do typescript, because I like it.</span> </p>
<p><span data-start="1255.889" data-end="1264.84">Also, I want to simplify the module system, so screw all this stuff about how Node modules</span> <span data-start="1264.84" data-end="1266.429">work, and that.</span> <span data-start="1266.429" data-end="1270.47">I can't be compatible with Node, like otherwise you end up building Node.</span> <span data-start="1270.47" data-end="1274.46">There's no attempt at compatibility with existent software.</span> <span data-start="1274.46" data-end="1277.73">This is mostly a thought expert, right.</span> <span data-start="1277.73" data-end="1283.5">I think it would be cute if you just import via where the source code came from, as you</span> <span data-start="1283.5" data-end="1285.26">do in the web, right?</span> <span data-start="1285.26" data-end="1286.679">There's a source file there.</span> <span data-start="1286.679" data-end="1290.129">You link to that source file and now you've linked it into your programme.</span> <span data-start="1290.129" data-end="1292.99">If it is a relative, you electric do a relative include.</span> <span data-start="1292.99" data-end="1297.52">You should obviously provide an extension.</span> <span data-start="1297.52" data-end="1301.23">You might be wondering, "I don't want this source code changing out from under me, this</span> <span data-start="1301.23" data-end="1302.35">seems fishy."</span> <span data-start="1302.35" data-end="1304.96">Well, it won't.</span> </p>
<p><span data-start="1304.96" data-end="1311.33">So the first time you do this, if you don't have the URL loaded, then it downloads it,</span> <span data-start="1311.33" data-end="1313.36">and it caches it somewhere.</span> <span data-start="1313.36" data-end="1316.649">And, then it never updates that again.</span> <span data-start="1316.649" data-end="1319.159">When you run it again, it is still using the same code.</span> <span data-start="1319.159" data-end="1327.499">However, you can do a  — reload as you do in the browser — that's my Control R hand signal.</span> <span data-start="1327.499" data-end="1334.649">It has a similar semantics where it will do a hard reload of all the cache files.</span> </p>
<p><span data-start="1334.649" data-end="1339.1">And, yes, you can do vendoring and stuff by giving it a different place where it downloads</span> <span data-start="1339.1" data-end="1341.409">these files.</span> <span data-start="1341.409" data-end="1346.22">I think this is viable.</span> <span data-start="1346.22" data-end="1354.659">Typescript compiler built into it, blah, blah, blah, Deno hooks into .. yes, so, I mean,</span> <span data-start="1354.659" data-end="1359.049">typescript should work out the box, and obviously JavaScript should still work out of the box</span> <span data-start="1359.049" data-end="1368.08">but that's trivial because typescript is a super set of JavaScript, and yes.</span> <span data-start="1368.08" data-end="1373.87">At the moment, it its start-up time is slow at one second which is completely unacceptable.</span> </p>
<p><span data-start="1373.87" data-end="1381.799">However, I'm working on using V8 snapshots to snapshot the entire compiler, and plus</span> <span data-start="1381.799" data-end="1384.12">other optimisations that have to be done.</span> <span data-start="1384.12" data-end="1387.86">I'm confident it can be improved greatly.</span> <span data-start="1387.86" data-end="1394.73">And so, Deno also, I don't like shipping all of these files, I hate that, I think it should</span> <span data-start="1394.73" data-end="1402.09">be a single executable, so it should be an executable that doesn't link to too many things</span> <span data-start="1402.09" data-end="1406.83">so you can just download the executable and run it.</span> <span data-start="1406.83" data-end="1411.429">And yes, just generally take advantage of the fact that we are in the future now, and</span> <span data-start="1411.429" data-end="1413.16">things are great.</span> <span data-start="1413.16" data-end="1423.74">In the build process in Node, there is a complicated set-up of defining require, requiring the</span> <span data-start="1423.74" data-end="1428.74">files, build them in a bundle, but now we have parcel, which is really great, by the</span> <span data-start="1428.74" data-end="1435.86">way, so, what I can do is I can write kind of a normal Node programme structure to be</span> <span data-start="1435.86" data-end="1444.44">the internal systems of Deno and then run Parcel on it, use it, and that will use Node's</span> <span data-start="1444.44" data-end="1450.129">module resolution scheme and stuff but now I have a single bundled JavaScript file and</span> <span data-start="1450.129" data-end="1452.11">I can dump that into V8.</span> </p>
<p><span data-start="1452.11" data-end="1457.45">That makes the whole process of building this thing much simpler.</span> <span data-start="1457.45" data-end="1463.62">Yes, and, great infrastructure exists now in native code, right?</span> <span data-start="1463.62" data-end="1466.2">Part of Node was writing a web server.</span> <span data-start="1466.2" data-end="1469.94">We spent a lot of time on the HTTP parser.</span> <span data-start="1469.94" data-end="1471.129">There's no need to do that.</span> <span data-start="1471.129" data-end="1473.46">That's done at this point.</span> <span data-start="1473.46" data-end="1480.429">If this ends up being Go, then you link into the HTTP routines which are super good or</span> <span data-start="1480.429" data-end="1489.149">maybe use Rust or C++, and, in the situation, there are easy ways to link into high-level</span> <span data-start="1489.149" data-end="1498.639">code, high-level native code these days, and I think that that really ease s the job of</span> <span data-start="1498.639" data-end="1502.07">this thing.</span> </p>
<p><span data-start="1502.07" data-end="1505.5">Yeah.</span> <span data-start="1505.5" data-end="1511.119">And so miscellaneous things like just die immediately when you have an unhandled promise.</span> <span data-start="1511.119" data-end="1517.64">Who has ever wanted to, "Maybe I will add a catch handler later?</span> <span data-start="1517.64" data-end="1519.99">I don't want this to die immediately."</span> </p>
<p><span data-start="1519.99" data-end="1525.2">No, it should die as soon as it gets an error.</span> <span data-start="1525.2" data-end="1530.159">Should support top-level — but it's not hard.</span> <span data-start="1530.159" data-end="1532.96">And be browser compatible.</span> <span data-start="1532.96" data-end="1540.1">In Node, I remember thinking like window is a really dumb variable name for the global</span> <span data-start="1540.1" data-end="1541.559">scope.</span> <span data-start="1541.559" data-end="1545.309">It is not a window, it should be called "global".</span> <span data-start="1545.309" data-end="1547.71">Yes, I don't know.</span> </p>
<p><span data-start="1547.71" data-end="1552.33">That was a mistake because now we have this whole, like, incompatibility issue with the</span> <span data-start="1552.33" data-end="1554.419">browser.</span> <span data-start="1554.419" data-end="1560.58">Where Deno with overlap with the browser, it should should use the browser semantics,</span> <span data-start="1560.58" data-end="1565.37">the browser functions, and what not.</span> <span data-start="1565.37" data-end="1567.289">Check it out maybe.</span> <span data-start="1567.289" data-end="1568.289">I don't know.</span> <span data-start="1568.289" data-end="1569.289">It is a prototype.</span> <span data-start="1569.289" data-end="1576.69">It was just — yes, I think I'm mildly happy with it so far.</span> <span data-start="1576.69" data-end="1577.759">Yes.</span> <span data-start="1577.759" data-end="1584.34">If you have any comments or questions, I guess you can't ask me now, but please email me,</span> <span data-start="1584.34" data-end="1593.58">and, yeah, first person to implement an HTTP server gets a star!</span> <span data-start="1593.58" data-end="1594.929">I still have three minutes left.</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
