<!DOCTYPE html>

<!--
Copyright 2019 Google LLC

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

  https://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="author" content="//google.com">
  <meta name="description" content="web.dev LIVE video transcript">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>F2cL4EOAztk</title>
  <link rel="stylesheet" href="../css/main.css">
</head>

<body>

<iframe id="youtube" src="https://www.youtube.com/embed/F2cL4EOAztk?enablejsapi=1"></iframe>

<div id="container">

<div id="options">
  <div id="google-translate"></div>
  <div>
    <input type="checkbox" id="videoSticky" checked>
    <label for="videoSticky">Video position sticky</label>
  </div>
  <div>
    <input type="checkbox" id="captionScroll" checked>
    <label for="captionScroll">Keep current caption visible</label>
  </div>
</div>

<section>
<p><span data-start="1.64" data-end="13.5">Thank you, thank you.</span> <span data-start="13.5" data-end="27.18">Welcome everyone, it's great to be in Berlin, I like how this powerful the community is.</span> <span data-start="27.18" data-end="31.929">This is my second year, and it's not just a pleasure, it's a get honor to be on this</span> <span data-start="31.929" data-end="37.059">side of the room as a speaker, and, well, it's amazing.</span> </p>
<p><span data-start="37.059" data-end="41.6">First of all, let me tell you that I have not watched inception.</span> <span data-start="41.6" data-end="48.25">You're thinking, what kind of person has not watched that movie and why is he using that</span> <span data-start="48.25" data-end="49.43">title then.</span> <span data-start="49.43" data-end="57.079">It's just a coincidence, it's just that for this particular talk I like how JS inception</span> <span data-start="57.079" data-end="63.46">sounded because this talk is about implementing things in script engine in I didn't want I</span> <span data-start="63.46" data-end="69.21">wanted to use this very nice logo\h‑‑ I wanted to use this very nice low go, that</span> <span data-start="69.21" data-end="77.6">I wanted to use for a wile that is all CSS, that I have been tweaking a bit after CSS</span> <span data-start="77.6" data-end="79.72">conference the other day.</span> <span data-start="79.72" data-end="82.27">So well, this is all HTML.</span> <span data-start="82.27" data-end="90.85">But, let me introduce myself, as you know, I'm Adrian, I'm from Spain, I live in Helsinki.</span> <span data-start="90.85" data-end="96.82">It's a bit strange, I enjoy the winter, it's cold.</span> <span data-start="96.82" data-end="103.72">I love free software and getting into travel.</span> <span data-start="103.72" data-end="109.5">The first one, free software, Igalia a few years ago, and I working this still, and hopefully</span> <span data-start="109.5" data-end="117.88">for years to come, and the second part is to build machines and Compilers, it's not</span> <span data-start="117.88" data-end="123.88">the most useful thing for people to like, it's also a bit of low level for JSConf, no</span> <span data-start="123.88" data-end="130.44">worries, we're not going to touch almost C + + code today.</span> </p>
<p><span data-start="130.44" data-end="137.349">Yeah, I said travel those\h‑‑ can be quite complex.</span> <span data-start="137.349" data-end="147">And lastly the last year we have been collaborating with Bloomberg to bring ES features into JavaScript</span> <span data-start="147" data-end="154.739">engine, also spider monkey, and also modern layout to CSS.</span> <span data-start="154.739" data-end="160.989">And if you have not watched it in CSS Conf, I would suggest you to look at the grid layout</span> <span data-start="160.989" data-end="165.71">from Friday, it was very nice, and it was great to see all the positive responses on</span> <span data-start="165.71" data-end="169.12">Twitter while the talk was going on.</span> <span data-start="169.12" data-end="170.569">That's very nice.</span> <span data-start="170.569" data-end="179.48">So, I'm going to explain what this inception is about, how do we get the JavaScript into</span> <span data-start="179.48" data-end="187.069">our engine, V8, and we have time from the talk, we will keep trying to come up with</span> <span data-start="187.069" data-end="193.09">a small implementation for feature of ES 6, try to add it in the 8 and refine it a bit</span> <span data-start="193.09" data-end="195.879">as long as\h‑‑ as much as the time allows.</span> <span data-start="195.879" data-end="200.819">So, there's going to be live coding, I hope nothing blows, because this is the endt kind</span> <span data-start="200.819" data-end="204.069">of thing that can go wrong.</span> <span data-start="204.069" data-end="214.349">Well, to make things even clearer this is not about trance piling, this is not about</span> <span data-start="214.349" data-end="217.879">changing JavaScript and trans piling it from ES 6‑ES 8 or current engine.</span> </p>
<p><span data-start="217.879" data-end="223.81">It's not about explaining other languages into JavaScript.</span> <span data-start="223.81" data-end="230.12">It is not about implementing a JavaScript engine in JavaScript itself, that can be done,</span> <span data-start="230.12" data-end="235.5">it's surely a lot of fun, and, it's the kind of thing you do when you have a lot of time,</span> <span data-start="235.5" data-end="240.739">but, we oar more interested in getting our things into actual process, and getting them</span> <span data-start="240.739" data-end="248.519">in OGS, getting them in places where people could use them, established process, so, this</span> <span data-start="248.519" data-end="257.41">is more about adding feature in the JavaScript engine, trying to touch less of C + + as possible.</span> <span data-start="257.41" data-end="263.92">Because, the thing is, once the basic built\h‑‑ machine, the basics are impresented, there's</span> <span data-start="263.92" data-end="268.92">not much to prevent using the language itself to implement things.</span> <span data-start="268.92" data-end="274.42">This is the same that happen was CRC + +, you is the C Compiler, the C Compiler you</span> <span data-start="274.42" data-end="279.95">can use it to build a C library or C + + library and use that in our program, why couldn't</span> <span data-start="279.95" data-end="285.75">we use JavaScript to impresent parts of JavaScript or parts of the standard library or at least</span> <span data-start="285.75" data-end="292.44">as much as we can and then use then in our own engine? Well, actually we can, and there's</span> <span data-start="292.44" data-end="298.88">a good number of reasons to do that, I think we can all agree at JSConf we prefer to use</span> </p>
<p><span data-start="298.88" data-end="305.49">JavaScript in C + +, it's easier, faster to develop, we don't have to go with all this</span> <span data-start="305.49" data-end="312.94">code compiled real test check cycle, so that gets faster.</span> <span data-start="312.94" data-end="318.74">It makes us more productive, and very often the algorithms are more easily understandable</span> <span data-start="318.74" data-end="324.12">and more maintainable if we just write it down in JavaScript, and any way there's another</span> <span data-start="324.12" data-end="326.48">reason we oar not doing it.</span> <span data-start="326.48" data-end="329.13">I can do it well, I can do it just because.</span> <span data-start="329.13" data-end="336.88">And this one or two not so obvious reasons, and one of them is that the modern jus in</span> <span data-start="336.88" data-end="344.62">time Compilers are really really good at generating machine code, they're so good that they can't</span> <span data-start="344.62" data-end="353.09">make faster code than our hand made\h‑‑ they can make faster code than C + + code.</span> <span data-start="353.09" data-end="354.64">How is that possible? It's amazing.</span> <span data-start="354.64" data-end="358.97">The thing is, the Runtime in C + + there's still going to be a moment in which the JavaScript</span> <span data-start="358.97" data-end="361.47">code is going to have to call into the C + + Runtime</span> <span data-start="361.47" data-end="368.72">'s two worlds, JavaScript world and C + + world, whatever you use in JavaScript world</span> <span data-start="368.72" data-end="375.25">you have to convert to C + + values, arrange the tags, arrange other things, make sure</span> <span data-start="375.25" data-end="381.63">you call into C + + with proper calling conventions, this takes time.</span> </p>
<p><span data-start="381.63" data-end="387.67">This layer of batter in the JavaScript world and C + + takes time.</span> <span data-start="387.67" data-end="395.78">If the functions are likely to be well implemented by the JavaScript engine, we'd rather implement</span> <span data-start="395.78" data-end="401.01">them in JavaScript, we have all the jumping from JavaScript to C plus plus and that's</span> <span data-start="401.01" data-end="403.61">what makes it faster.</span> <span data-start="403.61" data-end="410.2">Also, engines make very good guesses about types of things, so you can just\h‑‑ most</span> <span data-start="410.2" data-end="415.49">of the time, well, let's just generate perfect code for integrals, so, yeah, they make very</span> <span data-start="415.49" data-end="422.1">good code, so there's no reason to not to say yeah, let's make it in C + + of because</span> <span data-start="422.1" data-end="427.6">it's faster, it may with slower in C + +.</span> <span data-start="427.6" data-end="431.7">Then, any way again, just because and it's fun.</span> <span data-start="431.7" data-end="438.79">To give you an idea of how much JavaScript is using engines, this is from yesterday,</span> <span data-start="438.79" data-end="448.21">I made the numbers yesterday, having checked with total count of lines of code, there's\h‑‑</span> <span data-start="448.21" data-end="452.58">there's most of the JavaScript code is used in V8.</span> </p>
<p><span data-start="452.58" data-end="458.34">That's the spider monkey following very JavaScript code one kilo byte, maybe they're trying to</span> <span data-start="458.34" data-end="463.65">make one of those one kilo byte JavaScript contest.</span> <span data-start="463.65" data-end="468.96">There's a reason for that, the JavaScript core can revert to an interpreter, so it doesn't</span> <span data-start="468.96" data-end="475.58">always generate machine code in that case it's faster to use C + + Runtime that you</span> <span data-start="475.58" data-end="477.75">have to call in to.</span> <span data-start="477.75" data-end="483.9">So it's my guess about why JavaScript core is not using more JavaScript.</span> <span data-start="483.9" data-end="491.13">Of course, these numbers are not counting test suites or tools, it's the Runtime or</span> <span data-start="491.13" data-end="492.76">parts of time in JavaScript.</span> <span data-start="492.76" data-end="501.21">V8 looks like the perfect match for this kind of task, that's one of the reasons I use V8</span> <span data-start="501.21" data-end="503.02">for this demo today.</span> <span data-start="503.02" data-end="511.7">So, I was saying, implement ES 6 feature, so, I've been checking, until last week, which</span> <span data-start="511.7" data-end="518.01">features from ES 6 are not just in V8 that also they can be implement in the JavaScript,</span> <span data-start="518.01" data-end="523.39">also that nobody else is really trying to impresent them, to try to come up with something</span> <span data-start="523.39" data-end="526.46">new, it's not done by anyone.</span> <span data-start="526.46" data-end="532.95">And, there's one thing that's not done and it's a lot of methods from type arrays.</span> <span data-start="532.95" data-end="539.22">Well, similar to the ones in normal arrays, but they just work with type arrays, this</span> <span data-start="539.22" data-end="542.09">kind of Int array, Int 32 array.</span> </p>
<p><span data-start="542.09" data-end="553.87">That have continue use memory baking, for example those are used by ASMGS, etc.</span> <span data-start="553.87" data-end="566.33">So, for today let's implement t Int array\h‑‑ while it ease easy, if we were patching the</span> <span data-start="566.33" data-end="574.03">poet type ourselves, there's one slide, small thing that is not handled by this function,</span> <span data-start="574.03" data-end="577.12">so let's see a more spec compliant version.</span> <span data-start="577.12" data-end="582.39">And this is the second argument for each\h‑‑ we can change the binding of these for call</span> <span data-start="582.39" data-end="588.58">back that is called for each of the elements, this is actual lay version that we can go</span> <span data-start="588.58" data-end="589.78">and implement now.</span> </p>
<p><span data-start="589.78" data-end="592.83">So, let's do that.</span> <span data-start="592.83" data-end="597.81">Of\h‑‑ some music for this.</span> <span data-start="597.81" data-end="613.92">(Jazz lounge music) so you can see the SRC inside the 8, there's JavaScript file, there's</span> <span data-start="613.92" data-end="617.02">one called type array that looks very good.</span> <span data-start="617.02" data-end="619.86">Will it's go there.</span> <span data-start="619.86" data-end="622">\h‑‑ let's go there.</span> <span data-start="622" data-end="629.38">Oh, JavaScript, surprise, great, well, several things that look a bit not so much like JavaScript,</span> <span data-start="629.38" data-end="634.86">let's just go to the end and patch in our prototype.</span> <span data-start="634.86" data-end="645.69">So for each is the function we oar implementing, Coltbolt, function keyboard, that's important.</span> <span data-start="645.69" data-end="655.36">Well if this is , then,\h‑‑ not this, but this, the argument past is undefined,</span> <span data-start="655.36" data-end="661.62">then spec says that these arguments should be implicit this, use of one for this function,</span> <span data-start="661.62" data-end="665.06">so, it goes that way, let's make a loop.</span> </p>
<p><span data-start="665.06" data-end="669.18">This is like almost of the loops that go over arrays.</span> <span data-start="669.18" data-end="674.61">This is this length.</span> <span data-start="674.61" data-end="675.97">There.</span> <span data-start="675.97" data-end="683.55">So, we call the callback, we use this call function to change the binding of this, and,</span> <span data-start="683.55" data-end="686.87">we pass data in the position there.</span> </p>
<p><span data-start="686.87" data-end="690.72">Can this really be this easy.</span> <span data-start="690.72" data-end="693.37">Let's check it.</span> <span data-start="693.37" data-end="696.03">Let's build it.</span> <span data-start="696.03" data-end="700.92">It's of course only generating some stuff, "building" including the JavaScript into V8,</span> <span data-start="700.92" data-end="708.83">I'm going to talk in a moment about how the works\h‑‑ Ooops, extension internal complylation</span> <span data-start="708.83" data-end="709.83">error.</span> </p>
<p><span data-start="709.83" data-end="711.46">That doesn't look for good.</span> <span data-start="711.46" data-end="717.64">Maybe the JavaScript is not as JavaScriptty as expected.</span> <span data-start="717.64" data-end="721.38">Let's look at data view there.</span> <span data-start="721.38" data-end="724.44">More things here, let's see what it does.</span> <span data-start="724.44" data-end="726.1">Oh, that's a bit funny.</span> <span data-start="726.1" data-end="727.1">Oh, maybe\h‑‑ ..</span> <span data-start="727.1" data-end="732.06">while we impresenting thing in the Runtime, maybe, maybe.</span> <span data-start="732.06" data-end="736.68">Let's see if there's any other ..</span> <span data-start="736.68" data-end="737.68">function.</span> <span data-start="737.68" data-end="741.77">Subtype array, maybe we should move our code here.</span> <span data-start="741.77" data-end="745.75">Well, install functions, that looks good.</span> <span data-start="745.75" data-end="754.07">But look at this, it acts as prototype here and uses global Hlmmm, probably some kind</span> <span data-start="754.07" data-end="761.46">of module system thing work here, let's try the global in the front and make maybe it</span> <span data-start="761.46" data-end="763.22">works.</span> </p>
<p><span data-start="763.22" data-end="767.64">Again the build phase is fast, let's see if it compiles this time.</span> <span data-start="767.64" data-end="774.15">Blah, blah, blah, this time it works.</span> <span data-start="774.15" data-end="776.55">That's great.</span> <span data-start="776.55" data-end="778.95">So, amazing.</span> <span data-start="778.95" data-end="787.29">We have just became V8 hackers, ten minutes, who wants a full CS degree on a Compilers</span> <span data-start="787.29" data-end="788.29">master.</span> </p>
<p><span data-start="788.29" data-end="797.72">Let's just go fetch V8 now of start hacking V8 JavaScript in there and make the engine</span> <span data-start="797.72" data-end="803.279">do what you want it to do.</span> <span data-start="803.279" data-end="813.19">I actually want to show that it works.</span> <span data-start="813.19" data-end="818.66">Oh rings it sounds a bit strange that duringing the compilation phase, splits the error, well,</span> <span data-start="818.66" data-end="826.11">I compile the JavaScript, it actually is, because, it makes sure that it's not going</span> <span data-start="826.11" data-end="834.02">to generate errors later at Runtime, and kind of compile version is included in the V8 library.</span> <span data-start="834.02" data-end="836.55">Ah, there it is.</span> <span data-start="836.55" data-end="842.52">Now, let's make an array.</span> <span data-start="842.52" data-end="845.92">Three elements for example.</span> <span data-start="845.92" data-end="851.11">And we have from each.</span> <span data-start="851.11" data-end="858.11">But, hey we have to see if it works, maybe it doesn't work.</span> <span data-start="858.11" data-end="864.6">For example we can change one of the elements, that's usual in semantics, for each function\h‑‑</span> <span data-start="864.6" data-end="866.72">do for print.</span> <span data-start="866.72" data-end="868.83">Hey, it works.</span> <span data-start="868.83" data-end="876.08">Wow! So we have now V8 works implement in the JavaScript, it was previewed into machine</span> <span data-start="876.08" data-end="881.86">code when building, what else can we ask for? Well, there are a couple of things that we</span> <span data-start="881.86" data-end="883.38">could improve here.</span> </p>
<p><span data-start="883.38" data-end="887.77">Let me stop the music.</span> <span data-start="887.77" data-end="889.78">There.</span> <span data-start="889.78" data-end="896.61">So, of just a couple of things that we'll be tempted to do now because there is not</span> <span data-start="896.61" data-end="904.74">only INT 8 array, Int 32 array, all of those array that are type arrays, so we would be</span> <span data-start="904.74" data-end="906.83">tempted to do this.</span> <span data-start="906.83" data-end="908.67">This would actually work.</span> <span data-start="908.67" data-end="912.24">We could patch all the prototypes.</span> <span data-start="912.24" data-end="915.99">A bit of work, we have to duplicate those lines in there.</span> <span data-start="915.99" data-end="922.15">But, of course we can do I but these, it's not necessarily a good idea, remember that</span> <span data-start="922.15" data-end="928">the Compiler doesn't\h‑‑ is not specialized in one version of the code for each function,</span> <span data-start="928" data-end="936.11">so ited may fail its guess for the types, so what we want to do is rather have a copy</span> <span data-start="936.11" data-end="942.22">of each of the function that is of\h‑‑ the same code inside, but it's one of the</span> <span data-start="942.22" data-end="948.17">arrays gets it's own version, when the Compiler makes an optimized version guessing the types,</span> <span data-start="948.17" data-end="953.02">it can do a perfect version matching each one of the types.</span> </p>
<p><span data-start="953.02" data-end="958.51">And, now, this is a really starting to get a bit tedious and a bit boring to write all</span> <span data-start="958.51" data-end="959.51">those.</span> <span data-start="959.51" data-end="965.16">So fortunately I was saying some strange things in the JavaScript code that V8 uses, they</span> <span data-start="965.16" data-end="971.63">have a kind of macro expansion thing that we can use to, well, to make one implementation</span> <span data-start="971.63" data-end="977.91">that generates one copy for each of the\h‑‑ for each of the functions.</span> <span data-start="977.91" data-end="980.839">For each of the array types.</span> <span data-start="980.839" data-end="985.05">And this is going to be good because the co‑generator for each one of the versions once they get</span> <span data-start="985.05" data-end="988.34">hot and have been used for a while and types having guessed.</span> </p>
<p><span data-start="988.34" data-end="992.86">The code will generate the best it can.</span> <span data-start="992.86" data-end="995.96">Let's see how we can use that.</span> <span data-start="995.96" data-end="998.58">I'm going to have the same music.</span> <span data-start="998.58" data-end="1005.589">Okay, so let's go back.</span> <span data-start="1005.589" data-end="1016.08">Type in array\h‑‑ type array thereupon, let's cutlet's go, up, up, up.</span> <span data-start="1016.08" data-end="1023.33">Macro type array,ID element size, it looks like it's generating copy of things, and this</span> <span data-start="1023.33" data-end="1027.3">name thing here must be replaced.</span> <span data-start="1027.3" data-end="1037.6">For what? Well, for name is 8 array, it can be in 16 array, let's move our version here.</span> <span data-start="1037.6" data-end="1047.63">So based\h‑‑ let's be nice, so, instead of Int array, we write name, Hmm ..</span> <span data-start="1047.63" data-end="1054.08">is that enough? It seems, so, well, now, it's version of type array supported by V8, automatically</span> <span data-start="1054.08" data-end="1062.01">gets 4 H function had it's prototype, each one gets it's unique version.</span> </p>
<p><span data-start="1062.01" data-end="1068.58">So this should make it that in each one of the type array classes their prototype has</span> <span data-start="1068.58" data-end="1071.24">of reach, that's super.</span> <span data-start="1071.24" data-end="1076.44">Let's see if any syntax errors or things.</span> <span data-start="1076.44" data-end="1080.18">Ooop, there's an error again.</span> <span data-start="1080.18" data-end="1081.19">This was not planned.</span> <span data-start="1081.19" data-end="1085.03">The other one was.</span> <span data-start="1085.03" data-end="1090.68">So what's the problem here? Maybe it's not\h‑‑ it's a little bit picky because the macro</span> <span data-start="1090.68" data-end="1100.34">extension is not very smart, so times it will appear in places where one doesn't expect.</span> <span data-start="1100.34" data-end="1105.76">So let's see.</span> <span data-start="1105.76" data-end="1114.429">Now it seems to work.</span> <span data-start="1114.429" data-end="1122.81">Be sure to put colons and semi colons, you never know how the macro processor is working,</span> <span data-start="1122.81" data-end="1128.34">I have not checked the code, it just works, sometimes makes thing\h‑‑ things work</span> <span data-start="1128.34" data-end="1129.78">again.</span> </p>
<p><span data-start="1129.78" data-end="1138.76">Oh, it's a lot of time.</span> <span data-start="1138.76" data-end="1146.13">If it sounds like elevator music, it's because it's almost elevator music.</span> <span data-start="1146.13" data-end="1157.79">I have to make sure I have was picking something with clear rights and those kind of things.</span> <span data-start="1157.79" data-end="1163.909">V8 is already revealed, maybe I can just run the V8.</span> <span data-start="1163.909" data-end="1165.67">\h‑‑ harmony also.</span> <span data-start="1165.67" data-end="1169.29">Probably is not ..</span> <span data-start="1169.29" data-end="1176.53">that's a bit of a bummer.</span> </p>
<p><span data-start="1176.53" data-end="1181.98">If you want to hack in to Compilers get a fast machine for lots of memory for the linking.</span> <span data-start="1181.98" data-end="1183.12">There we go.</span> <span data-start="1183.12" data-end="1186.679">I go on harmony this time we are.</span> <span data-start="1186.679" data-end="1193.85">Let's see N 16 array of prototype for each.</span> <span data-start="1193.85" data-end="1195.25">Oh, yeah, it's there.</span> <span data-start="1195.25" data-end="1203.34">Will it work this time, let's try again with Int for each.</span> <span data-start="1203.34" data-end="1205.72">Let's make another one.</span> <span data-start="1205.72" data-end="1207.84">This time Uint 32 array, two elements.</span> </p>
<p><span data-start="1207.84" data-end="1215.51">For example, B for each.</span> <span data-start="1215.51" data-end="1221.679">Let's try this argument handling works the second parameter.</span> <span data-start="1221.679" data-end="1228.51">To make it even nicer, let's make this an arrow function.</span> <span data-start="1228.51" data-end="1240.51">So let's print these plus X\h‑‑ let's process stream for example.</span> <span data-start="1240.51" data-end="1241.51">Why not.</span> <span data-start="1241.51" data-end="1243.17">Hey, it works, wow! Amazing, and functions are starting to work.</span> <span data-start="1243.17" data-end="1244.17">So cool.</span> <span data-start="1244.17" data-end="1252.59">Don't rely on the scoping of arguments on this so far, but it works, and we got automatically</span> <span data-start="1252.59" data-end="1261.73">from a simple\h‑‑ just one implementation a copy of the function in each one of the</span> <span data-start="1261.73" data-end="1265.22">prototypes of all the type of array classes.</span> </p>
<p><span data-start="1265.22" data-end="1271.7">We could make it a bit nicer, we could use install functions we saw over there, and then</span> <span data-start="1271.7" data-end="1275.69">once it's nice enough we could send it for review and get it to V8.</span> <span data-start="1275.69" data-end="1285.59">We're just one step far from being a person that has a co‑meet in JavaScript engine,</span> <span data-start="1285.59" data-end="1289.87">so, I hope after this talk you all go hacking your laptops to start implementing all those</span> <span data-start="1289.87" data-end="1292.96">missing type array methods.</span> <span data-start="1292.96" data-end="1299.73">It will get a bit tough with the review process, but it's going to be nice, and you'll be also</span> <span data-start="1299.73" data-end="1301.52">Compiler hackers.</span> <span data-start="1301.52" data-end="1309.74">There was those funny thing in the V8 code, this is not the type array, I can actually</span> <span data-start="1309.74" data-end="1311.47">show this one.</span> <span data-start="1311.47" data-end="1313.15">This is from normal array\h‑‑ (Chuckles ..</span> <span data-start="1313.15" data-end="1314.15">normal ray..</span> <span data-start="1314.15" data-end="1327.07">) we have the code for each're\h‑‑ we have this things that are ruersble, to UINT</span> <span data-start="1327.07" data-end="1333.26">32, but what is this, JavaScript without types? It's a Spec function.</span> <span data-start="1333.26" data-end="1337.929">Wow! Person sign get the follow\h‑‑ percent sign get default receiver.</span> <span data-start="1337.929" data-end="1344.07">Those things are there for a reason are certain things that we should know about</span> <span data-start="1344.07" data-end="1348.49">the V8 Runtime and similarly happens to spider monkey just that it's different.</span> </p>
<p><span data-start="1348.49" data-end="1355.53">There's a different approach to certain things because it's not as fast to do everything</span> <span data-start="1355.53" data-end="1360.8">in JavaScript or it's not possible to do all, all of everything in JavaScript, because just</span> <span data-start="1360.8" data-end="1367.24">as I was saying the initiallytion of the Runtime is done early during the initiallytion of</span> <span data-start="1367.24" data-end="1372.309">the JavaScript engine\h‑‑ so there are certain features that my not be available.</span> <span data-start="1372.309" data-end="1378.851">Also, to impresent certain parts of the JavaScript specification, we need more information, we</span> <span data-start="1378.851" data-end="1384.11">may need to know if a function is anker report function or if\h‑‑ an Error function or</span> <span data-start="1384.11" data-end="1393.5">amore malfunction, we know if it's an Error function it will throw and normal one doesn't,</span> <span data-start="1393.5" data-end="1398.72">but throwing\h‑‑ is slow, slower than just checking a flag, actually the Runtime</span> <span data-start="1398.72" data-end="1405.6">the "so‑called" not native functions which allow the introspect the Runtime and the JavaScript</span> <span data-start="1405.6" data-end="1409.14">can manipulate and know more about internals of the Runtime.</span> <span data-start="1409.14" data-end="1414.53">So, of course, this is all implementation dependent, that's why it's different in V8</span> <span data-start="1414.53" data-end="1416.429">and different in spider monkey.</span> </p>
<p><span data-start="1416.429" data-end="1424.12">And the parser actually knows about this, there's a low native syntax flag, we can try</span> <span data-start="1424.12" data-end="1428.44">nit the V8 interpreter, there's a lot of functions.</span> <span data-start="1428.44" data-end="1434.29">There's some helper functions done in JavaScript,\h‑‑ wants to check, so these helper functions</span> <span data-start="1434.29" data-end="1442.299">are ones that don't have the percent sign, and the functions correspond, roughly, to</span> <span data-start="1442.299" data-end="1446.559">operations as specified in the language specification.</span> <span data-start="1446.559" data-end="1452.169">So, for example, in the specification there's other finishing of what\h‑‑ is expected</span> <span data-start="1452.169" data-end="1458.99">to do and the algorithms in the specification are written down using the reference those</span> <span data-start="1458.99" data-end="1465.36">basic operations that are impresented as helpers here, so the algorithms that exist in V8,</span> <span data-start="1465.36" data-end="1472.64">most of them try to mimic the algorithm if way it's written in the algorithm specification,</span> <span data-start="1472.64" data-end="1480.38">it's easier to do, easier to correspond to the spec, but it makes it harder time me meant</span> <span data-start="1480.38" data-end="1492.5">on JavaScript engines, I would recommend to check this navetives yes, Runtime yes, macro,</span> </p>
<p><span data-start="1492.5" data-end="1500.36">V I, and there's alsod the C + + functionses like this, get the full receiver, this gets</span> <span data-start="1500.36" data-end="1507.51">what would be the "this" target function, so it checks change and other things that</span> <span data-start="1507.51" data-end="1512.61">we have known implicitly when we were doing the first implementation of forage, you can</span> <span data-start="1512.61" data-end="1523.27">check those in Runtime C C and, there should be Runtime function\h‑‑ there, Runtime</span> <span data-start="1523.27" data-end="1528.93">function is declared with this macro, this gets scope count, it counts how many scope</span> <span data-start="1528.93" data-end="1530.61">there is are.</span> <span data-start="1530.61" data-end="1537.049">You actually know\h‑‑ the engine to go over those, but with a little time and checking</span> <span data-start="1537.049" data-end="1543.64">code examples from the rest of V8 is not that difficult to get the use the same constructs</span> <span data-start="1543.64" data-end="1550.65">as the engine\h‑‑ so just check the code and the other GS files and try to follow the</span> <span data-start="1550.65" data-end="1553.32">same style and check the specification.</span> <span data-start="1553.32" data-end="1558.65">The specification of JavaScript is quite big, it's something that may get into your way.</span> <span data-start="1558.65" data-end="1562.85">It may look like it's difficult to go over because it's not written in a very accessible</span> <span data-start="1562.85" data-end="1569">language, looking for examples in the rest of the JavaScript code is better and of course,</span> <span data-start="1569" data-end="1574.99">at some point you will need to check the spec to make sure things work as expected.</span> </p>
<p><span data-start="1574.99" data-end="1577.97">About V8 and how it's built, it took a bit.</span> <span data-start="1577.97" data-end="1587.6">Actually it picks all the GS code, puts it in to C + + file as bytes, that is linked</span> <span data-start="1587.6" data-end="1597.96">into V8 node nap shot, it's a small utility that comes with V8 that is built with V8 base</span> <span data-start="1597.96" data-end="1602.84">that doesn't include the Runtime, and what it does is it generates the code for it by</span> <span data-start="1602.84" data-end="1605.71">loading those JavaScripts and running them.</span> <span data-start="1605.71" data-end="1613.61">And, dumps\h‑‑ makes a dump of the JavaScript heap where the code is and variables and in</span> <span data-start="1613.61" data-end="1624.6">a V8\h‑‑ Lib format that is snapshot and\h‑‑ library, so it's much faster to load, so if</span> <span data-start="1624.6" data-end="1631.6">you have\h‑‑ your stand alone application that uses V8 you can modify the bootstrap.CC</span> <span data-start="1631.6" data-end="1637.65">file and include other scripts of JavaScript that you have me loaded and precompiled that</span> <span data-start="1637.65" data-end="1641.62">are always available as soon as the application starts.</span> </p>
<p><span data-start="1641.62" data-end="1647.12">So, that's something that is quite nice to have.</span> <span data-start="1647.12" data-end="1655.33">So, well, we're running out of time, but I tell have a couple of remarks: As results</span> <span data-start="1655.33" data-end="1662.08">of being here today with me, what I want you to be aware is that it's not only C + + and</span> <span data-start="1662.08" data-end="1669.251">JavaScript engines, it's a way to start hacking engines speaking\h‑‑ INT task that we</span> <span data-start="1669.251" data-end="1675.309">may know better, like JavaScript, and you can pick your favorite engine and hack on</span> <span data-start="1675.309" data-end="1676.309">them.</span> <span data-start="1676.309" data-end="1680.95">Don't be\h‑‑ don't be squared of the spec.</span> <span data-start="1680.95" data-end="1687.02">Ask, go to the ES discuss mailing list, ask for clarifications, sometimes a spec is not</span> <span data-start="1687.02" data-end="1690.71">clear, especially ES 6 parts that are still changing a bit.</span> <span data-start="1690.71" data-end="1695.44">Sometimes you ask for a clarification and goes, oh, this is not very well specified,</span> <span data-start="1695.44" data-end="1697.63">let's give it another try.</span> <span data-start="1697.63" data-end="1704.049">So, well, I hope\h‑‑ I hope you are now all encouraged to go hack on engines, we need</span> <span data-start="1704.049" data-end="1708.75">more people like you to implement this.</span> </p>
</section>

<!-- div#container ends -->
</div>

<img alt="The End" id="fin" src="../images/fin.jpg">

<script>
/*eslint-disable */
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'en',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    }, 'google-translate');
}
/* eslint-enable */
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script src="../js/main.js"></script>

</body>

</html>
