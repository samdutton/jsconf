1
00:00:16,990 --> 00:00:19,310

hola amigos welcome back from lunch i

2
00:00:19,310 --> 00:00:21,170
hope you enjoyed it I did it was great I

3
00:00:21,170 --> 00:00:24,470
am well you know who I am my name's on

4
00:00:24,470 --> 00:00:25,700
the thing and everything but it's my

5
00:00:25,700 --> 00:00:27,260
first time in Argentina my first time in

6
00:00:27,260 --> 00:00:28,820
Latin America I could not have been more

7
00:00:28,820 --> 00:00:31,970
welcome than I am right now it was also

8
00:00:31,970 --> 00:00:34,520
my birthday four days ago so can i get

9
00:00:34,520 --> 00:00:36,970
affiliate companies

10
00:00:36,970 --> 00:00:48,039
[Applause]

11
00:00:48,039 --> 00:00:54,170
buzzer buzzer that's great so let's talk

12
00:00:54,170 --> 00:00:57,050
about how we build messenger calm if you

13
00:00:57,050 --> 00:00:59,659
don't know messenger calm is a full page

14
00:00:59,659 --> 00:01:02,120
react application on which you can send

15
00:01:02,120 --> 00:01:04,159
and receive facebook messenger messages

16
00:01:04,159 --> 00:01:07,369
or we had a lot of fun building it but

17
00:01:07,369 --> 00:01:09,380
why would we even build such a thing

18
00:01:09,380 --> 00:01:10,580
when there's already a perfectly

19
00:01:10,580 --> 00:01:13,130
functioning chat interface on facebook

20
00:01:13,130 --> 00:01:15,950
com well the initial personally stated

21
00:01:15,950 --> 00:01:18,289
many reasons oh it's a full page

22
00:01:18,289 --> 00:01:20,479
application reno meant for chat it's

23
00:01:20,479 --> 00:01:22,700
distraction-free it's great but there's

24
00:01:22,700 --> 00:01:24,080
also something that happened after we

25
00:01:24,080 --> 00:01:26,030
launched that we didn't think about you

26
00:01:26,030 --> 00:01:28,520
see a lot of big companies block access

27
00:01:28,520 --> 00:01:30,259
to facebook com on their corporate

28
00:01:30,259 --> 00:01:31,940
networks because they want people to be

29
00:01:31,940 --> 00:01:34,729
productive i suppose but they don't

30
00:01:34,729 --> 00:01:36,440
block access to messenger com so people

31
00:01:36,440 --> 00:01:41,509
are free to chat even at work but before

32
00:01:41,509 --> 00:01:43,250
we get into messenger com we should talk

33
00:01:43,250 --> 00:01:45,319
about how we front end at facebook and i

34
00:01:45,319 --> 00:01:46,520
really believe we should start using

35
00:01:46,520 --> 00:01:49,009
front end as a verb it's hard to talk

36
00:01:49,009 --> 00:01:52,430
about things otherwise but we fronted a

37
00:01:52,430 --> 00:01:53,539
facebook like any other company

38
00:01:53,539 --> 00:01:56,060
basically we use modules it's a very

39
00:01:56,060 --> 00:01:58,310
simple paradigm it's a proven paradigm

40
00:01:58,310 --> 00:02:00,920
it works well if you're not using

41
00:02:00,920 --> 00:02:02,630
modules I really urge you to think about

42
00:02:02,630 --> 00:02:04,700
maybe incorporating modules in your

43
00:02:04,700 --> 00:02:07,429
workflow and modules are supposed to be

44
00:02:07,429 --> 00:02:08,929
simple and simple to use simple to

45
00:02:08,929 --> 00:02:10,820
implement to create a modulated Facebook

46
00:02:10,820 --> 00:02:12,859
it's very very simple you open up a file

47
00:02:12,859 --> 00:02:15,410
you give it a nice name messenger food

48
00:02:15,410 --> 00:02:18,440
at CSS and you add this doc block this

49
00:02:18,440 --> 00:02:20,989
doc book as it obviously says provides

50
00:02:20,989 --> 00:02:22,910
the module messenger foo it's not a very

51
00:02:22,910 --> 00:02:24,230
useful module right now because it does

52
00:02:24,230 --> 00:02:28,100
nothing so let's add one rule to it the

53
00:02:28,100 --> 00:02:29,299
quick of you my already notice that

54
00:02:29,299 --> 00:02:30,440
there's something weird over there

55
00:02:30,440 --> 00:02:32,630
there's a slash but that's that's our

56
00:02:32,630 --> 00:02:35,540
syntax for rules we use the module name

57
00:02:35,540 --> 00:02:37,040
and then use what the rule name actually

58
00:02:37,040 --> 00:02:41,000
is ah that makes sense because you can't

59
00:02:41,000 --> 00:02:43,760
change rules from other modules right

60
00:02:43,760 --> 00:02:46,389
this is encapsulation that we provide

61
00:02:46,389 --> 00:02:48,590
why would you ever want to do this I

62
00:02:48,590 --> 00:02:50,380
will sometimes you do because

63
00:02:50,380 --> 00:02:53,200
composition is a thing so we do provide

64
00:02:53,200 --> 00:02:56,750
public classes and you use public

65
00:02:56,750 --> 00:02:58,700
classes to style other rules that are

66
00:02:58,700 --> 00:03:00,440
explicitly stated as this can

67
00:03:00,440 --> 00:03:02,000
be changed by a thing that encapsulates

68
00:03:02,000 --> 00:03:05,540
me but this is also bad why would you

69
00:03:05,540 --> 00:03:07,070
always want to change a rule from

70
00:03:07,070 --> 00:03:09,590
another module this will fail you can't

71
00:03:09,590 --> 00:03:10,460
commit this you can't register

72
00:03:10,460 --> 00:03:12,530
production you have to combine it with

73
00:03:12,530 --> 00:03:14,960
your own classes very simple rules very

74
00:03:14,960 --> 00:03:17,120
simple encapsulation this is how we do

75
00:03:17,120 --> 00:03:19,070
CSS modules at Facebook and we find that

76
00:03:19,070 --> 00:03:21,500
it works pretty well but this is all you

77
00:03:21,500 --> 00:03:23,600
need just one rule is all you need to

78
00:03:23,600 --> 00:03:25,310
have an actual module that you are free

79
00:03:25,310 --> 00:03:29,060
to use inside say react this is a simple

80
00:03:29,060 --> 00:03:31,730
example react component as you can say

81
00:03:31,730 --> 00:03:34,490
whether provides module degradation we

82
00:03:34,490 --> 00:03:36,590
also have a flow decoration over there

83
00:03:36,590 --> 00:03:39,890
in the dark block I strongly suggest you

84
00:03:39,890 --> 00:03:42,230
to strongly type your javascript files

85
00:03:42,230 --> 00:03:44,570
it may seem like a lot of effort to do

86
00:03:44,570 --> 00:03:47,960
up front but it really pays off in the

87
00:03:47,960 --> 00:03:49,790
long term it catches bugs before they

88
00:03:49,790 --> 00:03:53,450
even run in your browser but yes that's

89
00:03:53,450 --> 00:03:55,460
how you use the class name you just you

90
00:03:55,460 --> 00:03:56,660
know put the class name in the class

91
00:03:56,660 --> 00:03:58,820
name and you're done or you can do more

92
00:03:58,820 --> 00:04:02,000
fancy things like give it a hash a map

93
00:04:02,000 --> 00:04:05,630
where the value is whether to use the

94
00:04:05,630 --> 00:04:09,730
key to which it belongs right ah and

95
00:04:09,730 --> 00:04:11,480
some of you might have noticed that

96
00:04:11,480 --> 00:04:13,370
little thing the CX that's always there

97
00:04:13,370 --> 00:04:17,120
and indeed CX is always there CX is our

98
00:04:17,120 --> 00:04:19,850
class transform function it takes in

99
00:04:19,850 --> 00:04:22,150
classes and gives in strings right and

100
00:04:22,150 --> 00:04:24,770
it's always there we always use this to

101
00:04:24,770 --> 00:04:26,600
add a class name to an element and

102
00:04:26,600 --> 00:04:29,180
because it's always there we can do some

103
00:04:29,180 --> 00:04:31,930
fancy things at our build step our

104
00:04:31,930 --> 00:04:35,060
scripts will run over all our code and

105
00:04:35,060 --> 00:04:37,460
look for CX instances and look at the

106
00:04:37,460 --> 00:04:39,740
class names and by looking at the class

107
00:04:39,740 --> 00:04:42,530
names from those modules we know which

108
00:04:42,530 --> 00:04:44,750
files we need all right so static

109
00:04:44,750 --> 00:04:46,850
analysis we know which files will be

110
00:04:46,850 --> 00:04:49,190
required by this JavaScript module so we

111
00:04:49,190 --> 00:04:51,800
load them up and ship them automatically

112
00:04:51,800 --> 00:04:53,870
I've been at Facebook for about two

113
00:04:53,870 --> 00:04:57,230
years now and I have not once manually

114
00:04:57,230 --> 00:05:00,110
written a link tag or a style import tag

115
00:05:00,110 --> 00:05:01,910
everything is done automatically and

116
00:05:01,910 --> 00:05:03,500
this saves you of headache because you

117
00:05:03,500 --> 00:05:08,300
never forget to include your styles so

118
00:05:08,300 --> 00:05:10,610
we optimize a lot for the two most this

119
00:05:10,610 --> 00:05:12,950
is one example where we automatically

120
00:05:12,950 --> 00:05:13,580
bundle your

121
00:05:13,580 --> 00:05:16,400
ESS for you and what I mean with the two

122
00:05:16,400 --> 00:05:18,289
modes of software is not that you read

123
00:05:18,289 --> 00:05:21,860
code more than you write code I mean the

124
00:05:21,860 --> 00:05:24,439
human mode and the the Machine mode and

125
00:05:24,439 --> 00:05:25,939
they're pretty different right as a

126
00:05:25,939 --> 00:05:28,219
human being I want you only have to

127
00:05:28,219 --> 00:05:30,469
write transform and I want something to

128
00:05:30,469 --> 00:05:32,689
magically do all this for me I'm sure

129
00:05:32,689 --> 00:05:34,520
everybody feels the same way all right

130
00:05:34,520 --> 00:05:36,500
so obviously we have tools like this in

131
00:05:36,500 --> 00:05:39,409
place we also do we also go one step

132
00:05:39,409 --> 00:05:41,330
further and we optimized for machines as

133
00:05:41,330 --> 00:05:44,719
well because if you're using Firefox you

134
00:05:44,719 --> 00:05:46,099
don't care about the WebKit and

135
00:05:46,099 --> 00:05:47,629
Microsoft transformed you only care

136
00:05:47,629 --> 00:05:49,729
about the mass transformed so we do

137
00:05:49,729 --> 00:05:50,960
create different versions of style

138
00:05:50,960 --> 00:05:52,280
sheets and we ship the appropriate one

139
00:05:52,280 --> 00:05:54,050
to your browser so we only ship the

140
00:05:54,050 --> 00:05:56,330
bytes that we need the ship now this

141
00:05:56,330 --> 00:05:58,129
saves bytes that we need to send down

142
00:05:58,129 --> 00:06:00,710
the wire obviously and bites directly

143
00:06:00,710 --> 00:06:02,930
translate into energy and we save a lot

144
00:06:02,930 --> 00:06:05,000
of energy so much energy can say from

145
00:06:05,000 --> 00:06:06,680
this every day that we can raise the

146
00:06:06,680 --> 00:06:08,270
temperature of the entire board Osiris

147
00:06:08,270 --> 00:06:10,430
City to California levels in its winter

148
00:06:10,430 --> 00:06:14,840
for like a whole year but this is not

149
00:06:14,840 --> 00:06:16,789
the only thing we do the next thing I'm

150
00:06:16,789 --> 00:06:18,080
going to talk about is a pet peeve of

151
00:06:18,080 --> 00:06:20,599
mine I really hate this but I have to

152
00:06:20,599 --> 00:06:23,270
talk about it so it doesn't matter if

153
00:06:23,270 --> 00:06:25,729
something is zero pixels or zero percent

154
00:06:25,729 --> 00:06:28,849
or zero elephants from the right it's

155
00:06:28,849 --> 00:06:32,029
still on the right the unit is

156
00:06:32,029 --> 00:06:33,949
superfluous there we shouldn't add it

157
00:06:33,949 --> 00:06:37,490
ever so we remove it automatically you

158
00:06:37,490 --> 00:06:38,690
might want to add it because that's how

159
00:06:38,690 --> 00:06:40,580
you want to write code but that's not

160
00:06:40,580 --> 00:06:42,229
what we ship to the client we ship what

161
00:06:42,229 --> 00:06:44,779
we need to ship that also saves bites

162
00:06:44,779 --> 00:06:47,719
and remember bites save energy energy is

163
00:06:47,719 --> 00:06:51,110
important the easiest way to save bites

164
00:06:51,110 --> 00:06:53,839
and energy and file size in general is

165
00:06:53,839 --> 00:06:56,779
to change the class names right to munge

166
00:06:56,779 --> 00:07:00,800
your names human and machine work in

167
00:07:00,800 --> 00:07:02,629
different modes as a human I need this

168
00:07:02,629 --> 00:07:04,729
this tells me a story just tells me as

169
00:07:04,729 --> 00:07:06,469
the title rule from the messenger foo

170
00:07:06,469 --> 00:07:08,960
module a machine doesn't care a machine

171
00:07:08,960 --> 00:07:10,639
needs a unique string that's all it

172
00:07:10,639 --> 00:07:12,830
needs so we do this as well at our bill

173
00:07:12,830 --> 00:07:14,300
stepp if we transform everything from

174
00:07:14,300 --> 00:07:15,620
something this is humanly readable to

175
00:07:15,620 --> 00:07:16,940
something that's not really human

176
00:07:16,940 --> 00:07:20,229
readable so back to our initial

177
00:07:20,229 --> 00:07:23,089
JavaScript example where we use this at

178
00:07:23,089 --> 00:07:27,080
runtime CX says yes use both classes but

179
00:07:27,080 --> 00:07:27,830
these classes ever

180
00:07:27,830 --> 00:07:29,630
been transformed at bill step into

181
00:07:29,630 --> 00:07:31,580
something very very short and it is a

182
00:07:31,580 --> 00:07:33,680
lot simpler than what we had we would

183
00:07:33,680 --> 00:07:36,370
have had to ship down originally and

184
00:07:36,370 --> 00:07:38,990
this is where most people stop with

185
00:07:38,990 --> 00:07:43,250
their optimizations we go a bit forward

186
00:07:43,250 --> 00:07:45,440
so there's one more thing you can do and

187
00:07:45,440 --> 00:07:48,440
we use packager for it packager does

188
00:07:48,440 --> 00:07:51,470
what it sounds like it does it looks at

189
00:07:51,470 --> 00:07:53,930
how we use code how we load our modules

190
00:07:53,930 --> 00:07:56,900
right we oh we always load these two

191
00:07:56,900 --> 00:07:58,730
files together apparently when we

192
00:07:58,730 --> 00:08:00,620
require the javascript file we

193
00:08:00,620 --> 00:08:02,390
apparently also always load these two

194
00:08:02,390 --> 00:08:05,780
CSS files packager will analyze how

195
00:08:05,780 --> 00:08:07,910
these are loaded and will transform

196
00:08:07,910 --> 00:08:10,300
these two files into just one file

197
00:08:10,300 --> 00:08:13,640
that's saving one network request never

198
00:08:13,640 --> 00:08:15,860
request you know saves bytes saves

199
00:08:15,860 --> 00:08:18,640
energy all that stuff it's very good and

200
00:08:18,640 --> 00:08:21,170
of course you know this is an example of

201
00:08:21,170 --> 00:08:23,870
package name the randomly generated by

202
00:08:23,870 --> 00:08:26,780
machines so sometimes machines randomly

203
00:08:26,780 --> 00:08:29,450
generate bad things some of you ready

204
00:08:29,450 --> 00:08:30,830
see the problem this was an actual

205
00:08:30,830 --> 00:08:32,810
package name that was generated some

206
00:08:32,810 --> 00:08:36,200
time ago and ad blockers went crazy that

207
00:08:36,200 --> 00:08:37,790
day they thought this was an ad when in

208
00:08:37,790 --> 00:08:41,000
fact this was a very crucial JavaScript

209
00:08:41,000 --> 00:08:46,210
for chat to work it was a fun day and

210
00:08:46,210 --> 00:08:49,340
and even here I got asked a lot or

211
00:08:49,340 --> 00:08:52,400
whether we prefer SAS or less or stylus

212
00:08:52,400 --> 00:08:54,710
or what do we use and what we use

213
00:08:54,710 --> 00:08:58,340
neither of course we believe that anyone

214
00:08:58,340 --> 00:08:59,930
should be able to use Facebook but we

215
00:08:59,930 --> 00:09:02,090
also believe that if you have the skills

216
00:09:02,090 --> 00:09:04,370
that are required to build a basic web

217
00:09:04,370 --> 00:09:07,370
app HTML and CSS in some JavaScript

218
00:09:07,370 --> 00:09:09,800
that's all you need to be able to work

219
00:09:09,800 --> 00:09:12,530
at Facebook so we don't use last or less

220
00:09:12,530 --> 00:09:15,770
or SAS so that we don't you know stop

221
00:09:15,770 --> 00:09:17,150
people from flying to Facebook or

222
00:09:17,150 --> 00:09:18,470
joining face began being productive on

223
00:09:18,470 --> 00:09:21,350
their first day nonetheless we do

224
00:09:21,350 --> 00:09:23,270
realize their value because they are

225
00:09:23,270 --> 00:09:25,040
extremely helpful and powerful all the

226
00:09:25,040 --> 00:09:27,020
preprocessors so we do kind of have our

227
00:09:27,020 --> 00:09:29,030
own things on the side one of them would

228
00:09:29,030 --> 00:09:31,970
be our CSS constants which is our

229
00:09:31,970 --> 00:09:34,340
implementation of the you know CSS

230
00:09:34,340 --> 00:09:37,820
variables obviously you use CSS constant

231
00:09:37,820 --> 00:09:39,980
with the VAR keyword but that's a

232
00:09:39,980 --> 00:09:41,329
discussion for another time

233
00:09:41,329 --> 00:09:44,149
so I hope that now you maybe have an

234
00:09:44,149 --> 00:09:46,999
idea of how things happen at Facebook

235
00:09:46,999 --> 00:09:48,350
and how they get in you know from my

236
00:09:48,350 --> 00:09:50,899
hands into your browser so let's talk

237
00:09:50,899 --> 00:09:53,540
about my future before we talk about

238
00:09:53,540 --> 00:09:57,439
messenger we need to talk about how chat

239
00:09:57,439 --> 00:10:02,059
got rewritten in 2011-2012 the whole of

240
00:10:02,059 --> 00:10:03,769
child was rewritten from the ground up

241
00:10:03,769 --> 00:10:06,920
and the people who did this back then

242
00:10:06,920 --> 00:10:09,110
had this wonderful idea to create these

243
00:10:09,110 --> 00:10:11,689
style agnostic components they would not

244
00:10:11,689 --> 00:10:13,459
know how to present information but they

245
00:10:13,459 --> 00:10:14,899
would know how to get information and

246
00:10:14,899 --> 00:10:17,329
pass it along to another component the

247
00:10:17,329 --> 00:10:18,559
other component will be a renderer and

248
00:10:18,559 --> 00:10:20,540
we call these components containers and

249
00:10:20,540 --> 00:10:23,149
that's how a lot of our infrastructure

250
00:10:23,149 --> 00:10:25,249
is built container render a container

251
00:10:25,249 --> 00:10:28,399
renderer you know something wraps a

252
00:10:28,399 --> 00:10:29,689
presenter and that's wrap again in

253
00:10:29,689 --> 00:10:30,980
another container that is wrapped in the

254
00:10:30,980 --> 00:10:32,420
other presenter and so on it's like a

255
00:10:32,420 --> 00:10:34,939
big big rap we call this shawarma driven

256
00:10:34,939 --> 00:10:40,309
development it works a simple example

257
00:10:40,309 --> 00:10:42,499
say we have a theoretical module that

258
00:10:42,499 --> 00:10:44,119
lists recent conversations that you've

259
00:10:44,119 --> 00:10:46,699
had it would call into the style

260
00:10:46,699 --> 00:10:48,439
agnostic components hey I want

261
00:10:48,439 --> 00:10:51,169
conversations this is your presenter the

262
00:10:51,169 --> 00:10:52,459
component that knows how to render them

263
00:10:52,459 --> 00:10:55,309
an optional class name for some styling

264
00:10:55,309 --> 00:10:57,860
hooks and inside that component it just

265
00:10:57,860 --> 00:11:00,139
says yeah sure I got the threads and it

266
00:11:00,139 --> 00:11:01,369
passes them down to the component it

267
00:11:01,369 --> 00:11:02,839
doesn't know what the what the renderer

268
00:11:02,839 --> 00:11:04,369
is why they will do with them and

269
00:11:04,369 --> 00:11:07,160
doesn't care and again the shawarma wrap

270
00:11:07,160 --> 00:11:08,689
goes deeper and deeper container

271
00:11:08,689 --> 00:11:12,110
renderer container renderer so because

272
00:11:12,110 --> 00:11:13,879
we were able to reuse most of the

273
00:11:13,879 --> 00:11:16,489
infrastructure from facebook com we

274
00:11:16,489 --> 00:11:19,309
could focus on you know CSS a lot more

275
00:11:19,309 --> 00:11:21,889
which is great and the first thing we

276
00:11:21,889 --> 00:11:23,929
decided was we don't want to pull the

277
00:11:23,929 --> 00:11:26,540
old browsers facebook com different

278
00:11:26,540 --> 00:11:28,040
story right we believe everyone should

279
00:11:28,040 --> 00:11:29,959
be able to use facebook regardless of

280
00:11:29,959 --> 00:11:31,759
their device and there is capabilities

281
00:11:31,759 --> 00:11:34,730
but messenger calm was a new product and

282
00:11:34,730 --> 00:11:36,860
by definition there was a niche product

283
00:11:36,860 --> 00:11:38,559
so we didn't need this all-encompassing

284
00:11:38,559 --> 00:11:42,230
support dropping support for all the

285
00:11:42,230 --> 00:11:44,839
browsers meant we could use new CSS

286
00:11:44,839 --> 00:11:48,339
stuff like transforms but mostly flexbox

287
00:11:48,339 --> 00:11:50,329
initially you know we wanted something

288
00:11:50,329 --> 00:11:52,939
that has a simple clean three-column

289
00:11:52,939 --> 00:11:54,860
layout and we implemented using

290
00:11:54,860 --> 00:11:58,700
Xbox and mmm it didn't really work too

291
00:11:58,700 --> 00:12:00,680
well the first time because you know

292
00:12:00,680 --> 00:12:02,810
flexbox has had about three different

293
00:12:02,810 --> 00:12:04,370
types of implementation and they've all

294
00:12:04,370 --> 00:12:07,070
had different stages of evolution and we

295
00:12:07,070 --> 00:12:08,690
wrote our static transform rules the

296
00:12:08,690 --> 00:12:10,190
things you know analyze our code and

297
00:12:10,190 --> 00:12:12,710
ship you know change it to be production

298
00:12:12,710 --> 00:12:14,720
ready at various stages of that

299
00:12:14,720 --> 00:12:16,430
evolution so sometimes we had

300
00:12:16,430 --> 00:12:18,680
conflicting rules we would export very

301
00:12:18,680 --> 00:12:20,660
bad things to Safari or very bad things

302
00:12:20,660 --> 00:12:23,930
to Microsoft but after we fixed them and

303
00:12:23,930 --> 00:12:26,600
revamp the whole way we've powers

304
00:12:26,600 --> 00:12:29,240
flexbox rules we finally had a nice

305
00:12:29,240 --> 00:12:31,430
looking thing we think it's nice-looking

306
00:12:31,430 --> 00:12:34,910
I hope you agree so we had we had layout

307
00:12:34,910 --> 00:12:37,570
out of the way we got right pretty early

308
00:12:37,570 --> 00:12:39,680
but we weren't out of the woods because

309
00:12:39,680 --> 00:12:42,050
bad things just happen to people you

310
00:12:42,050 --> 00:12:46,050
know can you tell what's wrong with this

311
00:12:46,060 --> 00:12:49,640
let me let me make it bigger so

312
00:12:49,640 --> 00:12:51,230
obviously the comma is jumping and it

313
00:12:51,230 --> 00:12:53,660
shouldn't why with a comma jump and in

314
00:12:53,660 --> 00:12:56,360
right-to-left languages as you're typing

315
00:12:56,360 --> 00:12:58,070
and you want to add a common type comma

316
00:12:58,070 --> 00:13:01,430
space as you do sometimes the comma will

317
00:13:01,430 --> 00:13:03,590
flip it space is placed with the space

318
00:13:03,590 --> 00:13:08,210
and we had no idea why turns out it was

319
00:13:08,210 --> 00:13:10,540
because we were using one fun definition

320
00:13:10,540 --> 00:13:12,740
messenger calm is a web app like many

321
00:13:12,740 --> 00:13:14,750
web apps we have one font family itself

322
00:13:14,750 --> 00:13:16,340
on stack and we use it everywhere right

323
00:13:16,340 --> 00:13:18,650
everything inherited we were happy we

324
00:13:18,650 --> 00:13:20,150
were using helvetica neue which

325
00:13:20,150 --> 00:13:22,040
apparently has this problem if you're

326
00:13:22,040 --> 00:13:24,140
using a right-to-left locale and you're

327
00:13:24,140 --> 00:13:26,180
typing sometimes it will decide to

328
00:13:26,180 --> 00:13:28,310
magically switch the comma in the space

329
00:13:28,310 --> 00:13:30,650
it is a very poor experience for people

330
00:13:30,650 --> 00:13:33,680
who have to type in right to left so we

331
00:13:33,680 --> 00:13:35,720
don't have just one fun definition for

332
00:13:35,720 --> 00:13:37,070
people who are typing in right-to-left

333
00:13:37,070 --> 00:13:40,340
we use aerial which is the fallback

334
00:13:40,340 --> 00:13:43,310
phone for facebook on as well and I hear

335
00:13:43,310 --> 00:13:45,770
the gasps and people are going re oh yes

336
00:13:45,770 --> 00:13:47,690
re oh the boring old re oh but the

337
00:13:47,690 --> 00:13:49,640
battle-tested Ariel has been around for

338
00:13:49,640 --> 00:13:52,070
ages it's had its kinks wire and ironed

339
00:13:52,070 --> 00:13:55,220
out down any problems like that I with

340
00:13:55,220 --> 00:13:57,650
REO it might be boring but it also works

341
00:13:57,650 --> 00:14:00,560
well another thing we were doing wrong

342
00:14:00,560 --> 00:14:03,440
is we wanted using pixels facebook.com

343
00:14:03,440 --> 00:14:06,050
uses pixels because it has many

344
00:14:06,050 --> 00:14:08,499
components right messenger com is

345
00:14:08,499 --> 00:14:10,869
a full page application we shouldn't use

346
00:14:10,869 --> 00:14:12,759
pixels it would be hard to use because

347
00:14:12,759 --> 00:14:14,919
we need to use percentage based

348
00:14:14,919 --> 00:14:17,979
everything mostly about most of the

349
00:14:17,979 --> 00:14:19,839
components that were for layout or were

350
00:14:19,839 --> 00:14:22,029
for positioning some things required

351
00:14:22,029 --> 00:14:25,649
pixels so we need to re-implement them

352
00:14:25,649 --> 00:14:28,809
not only that but we need to be able to

353
00:14:28,809 --> 00:14:30,429
accurately represent when you send one

354
00:14:30,429 --> 00:14:33,549
photo of shawarma or two or three or so

355
00:14:33,549 --> 00:14:37,089
on in short we need to be responsive in

356
00:14:37,089 --> 00:14:38,979
a lot of ways and you can be responsive

357
00:14:38,979 --> 00:14:40,539
in a lot of ways not only by changing

358
00:14:40,539 --> 00:14:42,099
you know from pixels to percentage based

359
00:14:42,099 --> 00:14:45,519
but from providing a better canvas to

360
00:14:45,519 --> 00:14:50,319
your viewers on the data we launched we

361
00:14:50,319 --> 00:14:51,939
got featured on good products as you do

362
00:14:51,939 --> 00:14:54,819
and one person spent I don't know how

363
00:14:54,819 --> 00:14:56,919
long doing exactly that just resizing

364
00:14:56,919 --> 00:14:58,719
the browser back and forth taking notes

365
00:14:58,719 --> 00:15:01,029
and when we hide or show the right hand

366
00:15:01,029 --> 00:15:03,279
column and you made this an amazing

367
00:15:03,279 --> 00:15:05,439
review about how much thought and effort

368
00:15:05,439 --> 00:15:09,519
we put into this and this may be cool

369
00:15:09,519 --> 00:15:11,709
but it's also very in-your-face it's a

370
00:15:11,709 --> 00:15:13,359
very big change when you don't have

371
00:15:13,359 --> 00:15:15,789
enough room we'll take that away so that

372
00:15:15,789 --> 00:15:16,809
you have enough room to view the

373
00:15:16,809 --> 00:15:18,759
conversation properly that's very

374
00:15:18,759 --> 00:15:20,589
obvious but you can be responsive on a

375
00:15:20,589 --> 00:15:24,309
much smaller scale to messenger calm is

376
00:15:24,309 --> 00:15:25,899
a messenger app therefore it looks like

377
00:15:25,899 --> 00:15:28,539
your messenger app on your phone so

378
00:15:28,539 --> 00:15:30,879
titles are centered I but if the title

379
00:15:30,879 --> 00:15:33,879
is long and the space gets short it's

380
00:15:33,879 --> 00:15:37,209
really hard to truncate you know Center

381
00:15:37,209 --> 00:15:39,669
aligned text if you have an icon on one

382
00:15:39,669 --> 00:15:44,199
side of it it is not fun and CSS alone

383
00:15:44,199 --> 00:15:46,299
couldn't really help us here maybe

384
00:15:46,299 --> 00:15:49,689
element query if we ever get it so

385
00:15:49,689 --> 00:15:51,789
instead of using a CSS only solution

386
00:15:51,789 --> 00:15:53,889
which wouldn't have really worked we

387
00:15:53,889 --> 00:15:55,899
measure the sizes in JavaScript and if

388
00:15:55,899 --> 00:15:57,339
we detect that there is going to be an

389
00:15:57,339 --> 00:15:59,589
overflow we flush the text to the left

390
00:15:59,589 --> 00:16:01,149
and we apply to occasion been and it

391
00:16:01,149 --> 00:16:05,469
looks okay so it's not a CSS only

392
00:16:05,469 --> 00:16:07,599
solution and it doesn't matter having a

393
00:16:07,599 --> 00:16:10,269
CSS only solution does nothing except be

394
00:16:10,269 --> 00:16:13,209
of CSS only solution no one cares the

395
00:16:13,209 --> 00:16:14,439
people who use your application won't

396
00:16:14,439 --> 00:16:16,029
care if its CSS only or you use some

397
00:16:16,029 --> 00:16:18,309
JavaScript the developers will have to

398
00:16:18,309 --> 00:16:20,109
maintain this after you won't care

399
00:16:20,109 --> 00:16:22,060
either it's only a bragging Dart

400
00:16:22,060 --> 00:16:25,060
isn't that important but I mentioned

401
00:16:25,060 --> 00:16:27,220
that messenger calm is a messenger app

402
00:16:27,220 --> 00:16:30,970
and well as a messenger app it follows

403
00:16:30,970 --> 00:16:33,100
some style guides we have one style

404
00:16:33,100 --> 00:16:35,440
guide on Facebook right the design looks

405
00:16:35,440 --> 00:16:36,910
cohesive everything looks like it's

406
00:16:36,910 --> 00:16:38,830
connected that gets in its right place

407
00:16:38,830 --> 00:16:41,200
because on facebook com everything

408
00:16:41,200 --> 00:16:44,650
follows do you know what this is say its

409
00:16:44,650 --> 00:16:48,640
name yes they follow the fig and we have

410
00:16:48,640 --> 00:16:50,710
a similar style guide from messenger can

411
00:16:50,710 --> 00:16:55,870
you guess what we call it we call it the

412
00:16:55,870 --> 00:16:59,880
MiG the messenger interface guide

413
00:16:59,880 --> 00:17:01,930
obviously fig stands for facebook

414
00:17:01,930 --> 00:17:06,520
interface guide we built that the

415
00:17:06,520 --> 00:17:08,140
interface guide around the time we were

416
00:17:08,140 --> 00:17:10,330
building messenger calm and it wasn't

417
00:17:10,330 --> 00:17:12,040
just designers who are working on it it

418
00:17:12,040 --> 00:17:13,720
was everybody involved in the project

419
00:17:13,720 --> 00:17:16,300
and we found that was a much better

420
00:17:16,300 --> 00:17:18,490
experience than waiting for designers to

421
00:17:18,490 --> 00:17:20,620
finalize something this way we have back

422
00:17:20,620 --> 00:17:21,970
and forth and productive discussions

423
00:17:21,970 --> 00:17:23,590
about what made sense of what didn't

424
00:17:23,590 --> 00:17:28,720
make sense so compared it to my facebook

425
00:17:28,720 --> 00:17:31,300
button messenger button our button looks

426
00:17:31,300 --> 00:17:33,180
a lot like a link trust me it's a button

427
00:17:33,180 --> 00:17:34,930
but even though they may look

428
00:17:34,930 --> 00:17:38,250
differently they still apply that same

429
00:17:38,250 --> 00:17:40,810
design agnostic component kind of

430
00:17:40,810 --> 00:17:43,330
concept to them they both wrap an

431
00:17:43,330 --> 00:17:45,880
abstract button that really knows how to

432
00:17:45,880 --> 00:17:47,710
be a button oh that's all it does it

433
00:17:47,710 --> 00:17:49,330
knows how to be a button really really

434
00:17:49,330 --> 00:17:51,100
well it knows how to beat a bobble it

435
00:17:51,100 --> 00:17:52,780
knows how to present the right labels

436
00:17:52,780 --> 00:17:54,220
and also be you know screen reader

437
00:17:54,220 --> 00:17:56,320
accessible and we just add some starting

438
00:17:56,320 --> 00:17:58,420
to it and because we were able to reuse

439
00:17:58,420 --> 00:18:00,220
all of those components on facebook com

440
00:18:00,220 --> 00:18:02,320
we saved a lot of time but we also got

441
00:18:02,320 --> 00:18:04,930
accessibility for free I want to take a

442
00:18:04,930 --> 00:18:07,180
moment to emphasize that it doesn't

443
00:18:07,180 --> 00:18:08,920
matter how beautiful your product is if

444
00:18:08,920 --> 00:18:14,230
you can't see it so we got accessibility

445
00:18:14,230 --> 00:18:15,820
for free and we improve the point where

446
00:18:15,820 --> 00:18:19,120
we could while maintaining our style

447
00:18:19,120 --> 00:18:21,070
guide which is great and our struggle

448
00:18:21,070 --> 00:18:23,800
has constantly evolved because initially

449
00:18:23,800 --> 00:18:25,900
we always had yes messenger blue and

450
00:18:25,900 --> 00:18:27,700
everything was messengered blue but as

451
00:18:27,700 --> 00:18:29,110
I'm sure you know you can now change

452
00:18:29,110 --> 00:18:31,420
colors and you can have different colors

453
00:18:31,420 --> 00:18:34,720
and well the day that they started doing

454
00:18:34,720 --> 00:18:35,500
this on Iowa

455
00:18:35,500 --> 00:18:37,750
an Android we caught wind of it before

456
00:18:37,750 --> 00:18:40,420
it was public we saw it and we thought

457
00:18:40,420 --> 00:18:41,860
yeah that's a cool idea let's let's do

458
00:18:41,860 --> 00:18:44,130
this to one went yeah let's just do it

459
00:18:44,130 --> 00:18:46,660
so we wanted to get an internal test

460
00:18:46,660 --> 00:18:49,690
ready um changing the bubbles was

461
00:18:49,690 --> 00:18:52,510
actually very simple but the one thing

462
00:18:52,510 --> 00:18:54,790
that kept is busy the whole day was that

463
00:18:54,790 --> 00:18:59,020
little thing that little thing used to

464
00:18:59,020 --> 00:19:02,320
be an image it was just a raster image

465
00:19:02,320 --> 00:19:05,200
of a thick and we thought okay we can

466
00:19:05,200 --> 00:19:08,290
change the images to be you know 12

467
00:19:08,290 --> 00:19:10,450
images as many calls as we have and then

468
00:19:10,450 --> 00:19:12,160
though that doesn't know I don't want to

469
00:19:12,160 --> 00:19:14,110
manage 12 images for one icon and then

470
00:19:14,110 --> 00:19:18,880
have 25 icon no I know how you CSS

471
00:19:18,880 --> 00:19:21,400
filters great right you have the hero

472
00:19:21,400 --> 00:19:23,050
Tate when I talked about them you can do

473
00:19:23,050 --> 00:19:26,710
amazing things with them and this was at

474
00:19:26,710 --> 00:19:29,020
6pm when I started calling out on

475
00:19:29,020 --> 00:19:31,150
Twitter for help because CSS filters

476
00:19:31,150 --> 00:19:33,820
won't really really work you can't

477
00:19:33,820 --> 00:19:36,370
predictably change one color to another

478
00:19:36,370 --> 00:19:38,440
if you know both the car you for me

479
00:19:38,440 --> 00:19:40,030
where you want to get em where you want

480
00:19:40,030 --> 00:19:43,240
to start from because they use different

481
00:19:43,240 --> 00:19:45,430
color space is the way you analyze and

482
00:19:45,430 --> 00:19:46,930
reason about colors and JavaScript will

483
00:19:46,930 --> 00:19:49,570
be very different than how CSS filters

484
00:19:49,570 --> 00:19:52,000
will apply that those transforms and if

485
00:19:52,000 --> 00:19:53,260
you want to make sure that you're using

486
00:19:53,260 --> 00:19:55,390
the same space then the math becomes

487
00:19:55,390 --> 00:19:59,320
obnoxious and all of that to change one

488
00:19:59,320 --> 00:20:01,960
icon is not worth it also the typos that

489
00:20:01,960 --> 00:20:03,670
everyone made that day where sometimes

490
00:20:03,670 --> 00:20:09,490
awful so in the end in the end we we

491
00:20:09,490 --> 00:20:11,230
scrape the whole CSS filter thing and

492
00:20:11,230 --> 00:20:13,120
weary implemented the image using a

493
00:20:13,120 --> 00:20:16,330
simple live with a border inside of it

494
00:20:16,330 --> 00:20:18,400
and we're using custom current color to

495
00:20:18,400 --> 00:20:20,620
change the colors it's a lot easier and

496
00:20:20,620 --> 00:20:24,190
this leads into my next point d I just

497
00:20:24,190 --> 00:20:26,620
don't like the image tag I mean it's

498
00:20:26,620 --> 00:20:29,080
okay for an image but I don't like

499
00:20:29,080 --> 00:20:30,850
displaying images with the image tag

500
00:20:30,850 --> 00:20:33,460
because it's just so obtuse I don't like

501
00:20:33,460 --> 00:20:35,620
it at all remember we need to do this

502
00:20:35,620 --> 00:20:38,530
and we want this to look nice you want

503
00:20:38,530 --> 00:20:40,000
this to look nice as well it's it's

504
00:20:40,000 --> 00:20:42,880
better if shawarma looks nice but to do

505
00:20:42,880 --> 00:20:44,830
this with images you can already start

506
00:20:44,830 --> 00:20:46,600
to see in your mind what the problems

507
00:20:46,600 --> 00:20:48,100
would be you have to stretch them they

508
00:20:48,100 --> 00:20:48,340
look

509
00:20:48,340 --> 00:20:50,020
horrible you need to crop them how do

510
00:20:50,020 --> 00:20:51,460
you copy couple on the server what if

511
00:20:51,460 --> 00:20:54,100
you resize the browser the problems are

512
00:20:54,100 --> 00:20:56,080
endless so obviously we don't use images

513
00:20:56,080 --> 00:20:58,419
because if we would then we couldn't do

514
00:20:58,419 --> 00:21:00,700
this if you send a link and we attack

515
00:21:00,700 --> 00:21:02,350
the link has an image and we'll take the

516
00:21:02,350 --> 00:21:04,360
images big enough will display it in

517
00:21:04,360 --> 00:21:07,210
this wide format firstly if you send a

518
00:21:07,210 --> 00:21:08,890
link and we detect it has an image but

519
00:21:08,890 --> 00:21:11,049
the image is pretty small will fall back

520
00:21:11,049 --> 00:21:14,080
to the compact layout this is the exact

521
00:21:14,080 --> 00:21:16,210
same component using mostly the same CSS

522
00:21:16,210 --> 00:21:18,039
rules except for the one that positions

523
00:21:18,039 --> 00:21:21,610
de image which is not an image because

524
00:21:21,610 --> 00:21:23,169
you can't do that with an image you can

525
00:21:23,169 --> 00:21:24,700
do it reliably and it doesn't work and

526
00:21:24,700 --> 00:21:26,950
cropping well you don't get cropping but

527
00:21:26,950 --> 00:21:28,179
you do get cropping with background

528
00:21:28,179 --> 00:21:30,940
position and background size and all you

529
00:21:30,940 --> 00:21:32,529
need to do is set the URL to what you

530
00:21:32,529 --> 00:21:34,840
would set the image and then CSS will

531
00:21:34,840 --> 00:21:39,570
pick up everywhere else doing this

532
00:21:39,570 --> 00:21:42,669
enabled us do some funny things like add

533
00:21:42,669 --> 00:21:45,039
maps to our components because they were

534
00:21:45,039 --> 00:21:47,799
so apparently well separated people were

535
00:21:47,799 --> 00:21:49,419
able to implement other types of

536
00:21:49,419 --> 00:21:51,789
attachments not just links but hey yes

537
00:21:51,789 --> 00:21:53,110
your thing is on the way it will arrive

538
00:21:53,110 --> 00:21:54,640
there you can Pan the map and all the

539
00:21:54,640 --> 00:21:58,630
things arm or you know go one step

540
00:21:58,630 --> 00:22:00,789
further stickers I'm sure you use

541
00:22:00,789 --> 00:22:02,649
stickers on messenger they're all

542
00:22:02,649 --> 00:22:04,169
implemented the same way on web and

543
00:22:04,169 --> 00:22:06,340
payment receipts I don't know if you

544
00:22:06,340 --> 00:22:08,020
have messenger payments in Argentina do

545
00:22:08,020 --> 00:22:11,380
you know I'm sorry it's a very cool

546
00:22:11,380 --> 00:22:14,049
product that we have in America it's

547
00:22:14,049 --> 00:22:15,820
really really easy to semi to your

548
00:22:15,820 --> 00:22:19,120
friends but but that was the cool thing

549
00:22:19,120 --> 00:22:22,120
that they are we like the most yes we

550
00:22:22,120 --> 00:22:24,460
were the first complex web application

551
00:22:24,460 --> 00:22:26,169
to live on a domain that's not facebook

552
00:22:26,169 --> 00:22:28,960
com but use facebook com infrastructure

553
00:22:28,960 --> 00:22:31,929
Oh what we mostly like with other people

554
00:22:31,929 --> 00:22:34,360
who then came to build upon our platform

555
00:22:34,360 --> 00:22:36,309
they said it was a pleasure because our

556
00:22:36,309 --> 00:22:38,470
components were small rather silly but

557
00:22:38,470 --> 00:22:40,600
flexible and you could use them in a way

558
00:22:40,600 --> 00:22:42,539
that always respected the style guide

559
00:22:42,539 --> 00:22:45,370
and was powerful enough to be able to

560
00:22:45,370 --> 00:22:46,990
you know compose them into something

561
00:22:46,990 --> 00:22:50,409
better and by the way even if we don't

562
00:22:50,409 --> 00:22:53,169
use image tags to display images you

563
00:22:53,169 --> 00:22:55,899
should still use image tags in the dom

564
00:22:55,899 --> 00:22:58,690
because a screen reader can reason about

565
00:22:58,690 --> 00:23:00,700
an image tag it knows what it is it

566
00:23:00,700 --> 00:23:01,960
knows how to read it out

567
00:23:01,960 --> 00:23:04,990
you can also right-click and save it so

568
00:23:04,990 --> 00:23:06,820
over most of the images you see here

569
00:23:06,820 --> 00:23:08,950
there's actually an invisible image

570
00:23:08,950 --> 00:23:11,320
element that has the same URL just so

571
00:23:11,320 --> 00:23:15,309
you can right click and save as and all

572
00:23:15,309 --> 00:23:16,659
these lessons that we've learned and all

573
00:23:16,659 --> 00:23:19,169
these problems that we've had to fix

574
00:23:19,169 --> 00:23:22,210
have you know accumulated in our minds

575
00:23:22,210 --> 00:23:24,399
and we had a lot of fun building

576
00:23:24,399 --> 00:23:26,320
messenger calm in a nice clean interface

577
00:23:26,320 --> 00:23:28,480
everything is a lot flatter it follows

578
00:23:28,480 --> 00:23:31,450
the messenger style guide and then we

579
00:23:31,450 --> 00:23:33,640
took a look at from where we started you

580
00:23:33,640 --> 00:23:35,890
know the big chat rewrite of 2011 2012

581
00:23:35,890 --> 00:23:39,970
and that was a while ago so applying the

582
00:23:39,970 --> 00:23:42,250
knowledge that we've gained and the

583
00:23:42,250 --> 00:23:44,320
designs that the saga that we've matured

584
00:23:44,320 --> 00:23:46,720
we've also redesigned chat on facebook

585
00:23:46,720 --> 00:23:54,730
com quite recently so in closing I would

586
00:23:54,730 --> 00:23:56,200
like you to use messenger com if you're

587
00:23:56,200 --> 00:23:59,049
not already it makes it very easy to

588
00:23:59,049 --> 00:24:00,370
talk to your team to talk to your

589
00:24:00,370 --> 00:24:02,320
friends to talk to anyone it's a

590
00:24:02,320 --> 00:24:05,260
distraction free environment and let me

591
00:24:05,260 --> 00:24:06,549
know what you think I am here all day

592
00:24:06,549 --> 00:24:11,050
and i'm looking forward to talk to you

