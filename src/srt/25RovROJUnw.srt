1
00:00:00,320 --> 00:00:02,070

[Music]

2
00:00:02,070 --> 00:00:03,840
[Applause]

3
00:00:03,840 --> 00:00:05,660
[Music]

4
00:00:05,660 --> 00:00:07,410
[Applause]

5
00:00:07,410 --> 00:00:09,280
[Music]

6
00:00:09,280 --> 00:00:11,020
[Applause]

7
00:00:11,020 --> 00:00:12,780
[Music]

8
00:00:12,780 --> 00:00:16,860
[Applause]

9
00:00:16,870 --> 00:00:23,250
[Music]

10
00:00:23,250 --> 00:00:24,779
[Applause]

11
00:00:24,779 --> 00:00:27,369
all right so I wrote a story and I'm

12
00:00:27,369 --> 00:00:29,410
going to tell you about my story

13
00:00:29,410 --> 00:00:35,020
so me and my browser so this is me I'm a

14
00:00:35,020 --> 00:00:37,090
web developer I write code for work

15
00:00:37,090 --> 00:00:39,539
that's what I get paid to do and

16
00:00:39,539 --> 00:00:42,489
sometimes I feed that to a thing called

17
00:00:42,489 --> 00:00:46,930
browser that's the box and then comes up

18
00:00:46,930 --> 00:00:52,570
as a awesome sauce so when I started it

19
00:00:52,570 --> 00:00:55,060
was like yes this is really interesting

20
00:00:55,060 --> 00:00:57,820
so I learned so many other tools like

21
00:00:57,820 --> 00:01:00,820
jQuery and act and then I figure out the

22
00:01:00,820 --> 00:01:03,040
browser and browser he buys me back like

23
00:01:03,040 --> 00:01:07,570
awesome web application you know and

24
00:01:07,570 --> 00:01:10,000
then I got like used to it so like I'm

25
00:01:10,000 --> 00:01:13,210
gonna learn more libraries I added on

26
00:01:13,210 --> 00:01:17,920
top of jQuery and the act d3 right I fed

27
00:01:17,920 --> 00:01:20,680
them and then suddenly browser became

28
00:01:20,680 --> 00:01:27,130
unhappy I don't know why but I was told

29
00:01:27,130 --> 00:01:29,760
that I need to learn my you know tools

30
00:01:29,760 --> 00:01:34,360
so I added typescript and bubble to my

31
00:01:34,360 --> 00:01:37,930
Taulbee and I sent it to a browser once

32
00:01:37,930 --> 00:01:40,720
again and you know it's not quite

33
00:01:40,720 --> 00:01:46,540
unhappy but it's like janky as hell so

34
00:01:46,540 --> 00:01:49,630
at this point I'm like I don't like

35
00:01:49,630 --> 00:01:53,830
browser like I don't know about you why

36
00:01:53,830 --> 00:01:57,409
are you keeping distance from me

37
00:01:57,409 --> 00:01:59,869
I just wanted to be friends with you

38
00:01:59,869 --> 00:02:02,479
like the beginning I really liked

39
00:02:02,479 --> 00:02:05,259
hanging out with you it was all a song

40
00:02:05,259 --> 00:02:08,599
you know you write HTML put it into

41
00:02:08,599 --> 00:02:10,160
browser don't even need a server

42
00:02:10,160 --> 00:02:14,420
something moose amazing so I started

43
00:02:14,420 --> 00:02:17,959
realized maybe it's me it's me that's

44
00:02:17,959 --> 00:02:20,720
outside of the brother who is not

45
00:02:20,720 --> 00:02:23,390
understanding and maybe what I need to

46
00:02:23,390 --> 00:02:31,580
do is to understand what is inside so

47
00:02:31,580 --> 00:02:34,580
when I was a kid so I grew up in Japan

48
00:02:34,580 --> 00:02:37,450
there's a thing called papers theater or

49
00:02:37,450 --> 00:02:41,180
Kamishibai which is exactly this you get

50
00:02:41,180 --> 00:02:43,819
a stack of paper ordered there is a

51
00:02:43,819 --> 00:02:45,709
story on the back there's gonna read a

52
00:02:45,709 --> 00:02:48,640
picture and then you work through and

53
00:02:48,640 --> 00:02:51,110
you know these are the things that you

54
00:02:51,110 --> 00:02:51,920
would get

55
00:02:51,920 --> 00:02:54,799
I don't know communal events or library

56
00:02:54,799 --> 00:02:57,950
you know one of those days that somebody

57
00:02:57,950 --> 00:02:59,630
needs to book for you instead of the

58
00:02:59,630 --> 00:03:01,970
book it might be the box and I used to

59
00:03:01,970 --> 00:03:04,730
love it both performing and being the

60
00:03:04,730 --> 00:03:07,579
audience because the stories that they

61
00:03:07,579 --> 00:03:10,310
tell inside of the paper theater box is

62
00:03:10,310 --> 00:03:12,170
like classic like the stories that

63
00:03:12,170 --> 00:03:15,019
everybody knows the story is the many

64
00:03:15,019 --> 00:03:18,859
different paper sorry the the picture

65
00:03:18,859 --> 00:03:21,530
books are written for kids but the

66
00:03:21,530 --> 00:03:24,079
people who is producing the deck set for

67
00:03:24,079 --> 00:03:26,840
paper theater intimately understood the

68
00:03:26,840 --> 00:03:29,540
the nature of this simple sliding box

69
00:03:29,540 --> 00:03:32,180
and sometimes on the back of the card

70
00:03:32,180 --> 00:03:34,670
they have kind of like a direction of

71
00:03:34,670 --> 00:03:37,549
how to perform them it's a slide halfway

72
00:03:37,549 --> 00:03:41,239
the dis part and then slide it out so

73
00:03:41,239 --> 00:03:44,480
they knew the environment and they knew

74
00:03:44,480 --> 00:03:48,350
the stage and they fed the content that

75
00:03:48,350 --> 00:03:53,540
it's best suited for the job if you can

76
00:03:53,540 --> 00:04:00,889
switch to the slides so this was me

77
00:04:00,889 --> 00:04:04,280
hello genius cool it's been amazing to

78
00:04:04,280 --> 00:04:05,180
be back

79
00:04:05,180 --> 00:04:07,220
I spoke three years ago when I spoke

80
00:04:07,220 --> 00:04:09,680
three years ago this was me I

81
00:04:09,680 --> 00:04:12,409
still beginning of my journey into doing

82
00:04:12,409 --> 00:04:15,230
this development thing for work I always

83
00:04:15,230 --> 00:04:18,410
worked in tech but not getting paid

84
00:04:18,410 --> 00:04:20,449
writing code so I was trying to figure

85
00:04:20,449 --> 00:04:25,990
this out and this is maybe me now-ish

86
00:04:25,990 --> 00:04:29,630
the difference is that I now care about

87
00:04:29,630 --> 00:04:32,509
my config files I care about what goes

88
00:04:32,509 --> 00:04:35,810
into my build a pipeline but I don't

89
00:04:35,810 --> 00:04:39,919
mean II mmm consider myself as a like a

90
00:04:39,919 --> 00:04:44,210
expert web developer but since the three

91
00:04:44,210 --> 00:04:47,660
years ago when I spark I got you know to

92
00:04:47,660 --> 00:04:51,139
new job I guess and you know so I feel

93
00:04:51,139 --> 00:04:53,270
like confident that I am progressing and

94
00:04:53,270 --> 00:04:55,430
I am employable and I am doing this for

95
00:04:55,430 --> 00:04:59,449
work speaking of work beginning of this

96
00:04:59,449 --> 00:05:03,440
year I was assigned to a project with

97
00:05:03,440 --> 00:05:06,650
three other engineers who I consider all

98
00:05:06,650 --> 00:05:11,840
of them advanced than me they were the

99
00:05:11,840 --> 00:05:14,300
one who is writing a UI framework they

100
00:05:14,300 --> 00:05:16,039
were the one who is writing spec for

101
00:05:16,039 --> 00:05:19,039
service workers and CSS they knew their

102
00:05:19,039 --> 00:05:21,949
craft and you can imagine my

103
00:05:21,949 --> 00:05:24,110
intimidation on writing a first poly

104
00:05:24,110 --> 00:05:27,590
quest to them being under microscope of

105
00:05:27,590 --> 00:05:30,020
the person who react and you were

106
00:05:30,020 --> 00:05:37,669
writing UI so I felt this like divide a

107
00:05:37,669 --> 00:05:40,669
between them and me not of the personal

108
00:05:40,669 --> 00:05:42,590
divide about just the knowledge and the

109
00:05:42,590 --> 00:05:44,389
level of conversation that they are

110
00:05:44,389 --> 00:05:46,430
having if you go routine needing that

111
00:05:46,430 --> 00:05:47,539
their level of accomplish you know that

112
00:05:47,539 --> 00:05:49,669
they were having is that like oh I don't

113
00:05:49,669 --> 00:05:51,590
want to use that CSS because it doesn't

114
00:05:51,590 --> 00:05:54,380
transform whatever that means I don't

115
00:05:54,380 --> 00:05:56,900
mean like like this API because it

116
00:05:56,900 --> 00:05:58,580
doesn't use compositor whatever that

117
00:05:58,580 --> 00:06:00,800
means they're gonna debate on like

118
00:06:00,800 --> 00:06:02,570
whether to do the event delegation or

119
00:06:02,570 --> 00:06:07,280
bubbling I'm like either way so I felt

120
00:06:07,280 --> 00:06:09,650
like they knew the behind the scenes of

121
00:06:09,650 --> 00:06:10,669
browser and they are making

122
00:06:10,669 --> 00:06:13,430
sophisticated choice so I decided it's

123
00:06:13,430 --> 00:06:16,940
time to join them going back on the

124
00:06:16,940 --> 00:06:20,000
other side and then investigate what the

125
00:06:20,000 --> 00:06:21,260
heck is going on inside

126
00:06:21,260 --> 00:06:24,260
the browser so this talk I change the

127
00:06:24,260 --> 00:06:26,690
talk title from the abstract so this is

128
00:06:26,690 --> 00:06:30,170
the how to be a web master inside a look

129
00:06:30,170 --> 00:06:33,350
at modern web browser and I called it

130
00:06:33,350 --> 00:06:35,300
how to be a master because I consider

131
00:06:35,300 --> 00:06:38,480
the person master or craftsman to be the

132
00:06:38,480 --> 00:06:41,660
person who intimately knows their tools

133
00:06:41,660 --> 00:06:44,780
in order to do their job there is a lot

134
00:06:44,780 --> 00:06:47,270
of register to traditional masters in

135
00:06:47,270 --> 00:06:49,580
Japan and all of them like I love

136
00:06:49,580 --> 00:06:51,620
watching those documentaries all of them

137
00:06:51,620 --> 00:06:54,050
intimately knows the craft and their

138
00:06:54,050 --> 00:06:57,440
tools so my intent was that it by

139
00:06:57,440 --> 00:06:59,540
understanding the to love my job browser

140
00:06:59,540 --> 00:07:04,340
try to be a web master in order to go

141
00:07:04,340 --> 00:07:07,400
into how browser internals I need to

142
00:07:07,400 --> 00:07:10,220
cover a few of the computer concepts

143
00:07:10,220 --> 00:07:12,230
before going to it because I promised

144
00:07:12,230 --> 00:07:14,200
the organizers that this talk will be

145
00:07:14,200 --> 00:07:18,770
nope no requirement for previous

146
00:07:18,770 --> 00:07:20,960
knowledge so few concepts that I want to

147
00:07:20,960 --> 00:07:23,240
talk about before go in it and then fair

148
00:07:23,240 --> 00:07:26,770
warning I am making very very very

149
00:07:26,770 --> 00:07:29,150
generalization of these concepts if you

150
00:07:29,150 --> 00:07:31,550
disagree with me please tell me how you

151
00:07:31,550 --> 00:07:35,180
think so the pool side tomorrow so the

152
00:07:35,180 --> 00:07:38,030
first thing is a CPU sometimes called

153
00:07:38,030 --> 00:07:41,060
central processing unit CPU is a

154
00:07:41,060 --> 00:07:43,280
hardware on your computer that is really

155
00:07:43,280 --> 00:07:45,110
good at doing a lot of computational

156
00:07:45,110 --> 00:07:47,120
tasks they can handle a lot of things

157
00:07:47,120 --> 00:07:49,700
but they can they do it one by one as

158
00:07:49,700 --> 00:07:52,880
the tasks come as in the modern

159
00:07:52,880 --> 00:07:55,190
computers case it is there that you only

160
00:07:55,190 --> 00:07:58,550
have one core the worker for CPU you

161
00:07:58,550 --> 00:08:00,590
usually have a few of them on your

162
00:08:00,590 --> 00:08:03,410
computer so they're doing even more work

163
00:08:03,410 --> 00:08:06,710
all together another concept is a GPU

164
00:08:06,710 --> 00:08:10,400
graphics processing unit GPU also does

165
00:08:10,400 --> 00:08:12,710
computations and can perform and there's

166
00:08:12,710 --> 00:08:17,150
a core but GPU control into CPU is

167
00:08:17,150 --> 00:08:22,130
really good at doing simple tasks all at

168
00:08:22,130 --> 00:08:26,120
once with many many many more cores so

169
00:08:26,120 --> 00:08:29,720
as the name suggests they were primarily

170
00:08:29,720 --> 00:08:31,610
started to be used by a graphics card

171
00:08:31,610 --> 00:08:33,170
and I'm putting the graphics on the

172
00:08:33,170 --> 00:08:33,750
computer

173
00:08:33,750 --> 00:08:36,539
my aim turning on and off the million

174
00:08:36,539 --> 00:08:39,210
bits of the pixels in the computer but

175
00:08:39,210 --> 00:08:41,250
they're gaining a lot more computational

176
00:08:41,250 --> 00:08:43,380
power so accelerated GPU computing and

177
00:08:43,380 --> 00:08:46,410
they can do a little more math basically

178
00:08:46,410 --> 00:08:49,710
to do so but they do it fast all

179
00:08:49,710 --> 00:08:54,960
together so you might see the machine or

180
00:08:54,960 --> 00:08:56,940
the computer hardware the CPU and GPU

181
00:08:56,940 --> 00:08:59,820
lives and your application not just web

182
00:08:59,820 --> 00:09:03,900
application lives on top of them and CPU

183
00:09:03,900 --> 00:09:06,420
and GPU is hunting whatever the logic

184
00:09:06,420 --> 00:09:09,530
that you put into the application well

185
00:09:09,530 --> 00:09:11,160
not quite

186
00:09:11,160 --> 00:09:13,020
in between your application and machine

187
00:09:13,020 --> 00:09:15,120
hardware there is usually a operating

188
00:09:15,120 --> 00:09:17,190
system that is kind of facilitating

189
00:09:17,190 --> 00:09:19,560
communications between them so in

190
00:09:19,560 --> 00:09:23,340
Chrome's case - in order to put a

191
00:09:23,340 --> 00:09:26,280
graphics on the screen clone publishes a

192
00:09:26,280 --> 00:09:29,010
OpenGL command that sometimes on some

193
00:09:29,010 --> 00:09:31,080
other platform just directly fed into

194
00:09:31,080 --> 00:09:33,270
but on Windows that goes through a

195
00:09:33,270 --> 00:09:35,850
conversion phase to convert it into like

196
00:09:35,850 --> 00:09:39,030
X I think that is more suited for a

197
00:09:39,030 --> 00:09:42,600
graphics on Windows so another concept

198
00:09:42,600 --> 00:09:45,030
that I want to talk about is a process

199
00:09:45,030 --> 00:09:48,210
and threat and I apologize in advance a

200
00:09:48,210 --> 00:09:51,240
fairly abstract visualization contrôlée

201
00:09:51,240 --> 00:09:55,350
- CPU and GPU but like process since the

202
00:09:55,350 --> 00:09:57,510
roads are already abstract concept if

203
00:09:57,510 --> 00:09:59,190
you look up from Hardware point of view

204
00:09:59,190 --> 00:10:01,380
and on top of that like it doesn't make

205
00:10:01,380 --> 00:10:03,930
any sense process what's process

206
00:10:03,930 --> 00:10:05,700
visualize like the way it's like a lot

207
00:10:05,700 --> 00:10:08,010
of people write like a literal threads

208
00:10:08,010 --> 00:10:10,170
on the screen but like I don't know to

209
00:10:10,170 --> 00:10:13,590
me it didn't click so just imagine the

210
00:10:13,590 --> 00:10:20,280
process is a unit on CPU that is letting

211
00:10:20,280 --> 00:10:23,250
your applications and the threads that's

212
00:10:23,250 --> 00:10:26,730
inside of the process and thread is the

213
00:10:26,730 --> 00:10:30,540
one actually executing that code for the

214
00:10:30,540 --> 00:10:34,740
process so if you start a any

215
00:10:34,740 --> 00:10:37,589
application the windows open up behind

216
00:10:37,589 --> 00:10:40,890
the scenes of that UI is the CPU starts

217
00:10:40,890 --> 00:10:45,450
a process process use memory so whatever

218
00:10:45,450 --> 00:10:47,490
you do on the application

219
00:10:47,490 --> 00:10:50,250
that gets saved into memory in the

220
00:10:50,250 --> 00:10:52,500
meantime of you learning the application

221
00:10:52,500 --> 00:10:54,170
and if you cool start application

222
00:10:54,170 --> 00:10:56,759
process goes away then morning at 3:00

223
00:10:56,759 --> 00:10:59,970
and then later for other operations the

224
00:10:59,970 --> 00:11:03,569
process can also store a another process

225
00:11:03,569 --> 00:11:08,069
to kind of like divide the work focus so

226
00:11:08,069 --> 00:11:10,740
they start they use different location

227
00:11:10,740 --> 00:11:13,470
of the memory and they walk together by

228
00:11:13,470 --> 00:11:15,810
communicating single inter process

229
00:11:15,810 --> 00:11:19,079
communication or sometimes a IPC and

230
00:11:19,079 --> 00:11:22,170
good thing about this it's that if one

231
00:11:22,170 --> 00:11:24,060
of the process gets hung up with

232
00:11:24,060 --> 00:11:26,519
something the bug or something and then

233
00:11:26,519 --> 00:11:29,519
just becomes unresponsible then you just

234
00:11:29,519 --> 00:11:31,860
close it and then the original process

235
00:11:31,860 --> 00:11:33,990
to live so your application might as

236
00:11:33,990 --> 00:11:36,089
well still be in running with a few

237
00:11:36,089 --> 00:11:39,149
blocking bits of UI while that other

238
00:11:39,149 --> 00:11:43,199
process comes back up so what the

239
00:11:43,199 --> 00:11:46,019
browser is process and threads look like

240
00:11:46,019 --> 00:11:48,720
so one browser might look like this the

241
00:11:48,720 --> 00:11:52,769
one giant process and many threads

242
00:11:52,769 --> 00:11:55,709
inside or might look like this with a

243
00:11:55,709 --> 00:11:59,490
few other processes and few threads

244
00:11:59,490 --> 00:12:02,759
inside of them or it might look like

245
00:12:02,759 --> 00:12:07,259
this many many more processes and kind

246
00:12:07,259 --> 00:12:10,470
of like a divided work in fact this is

247
00:12:10,470 --> 00:12:12,899
where Chrome's architecture is moving

248
00:12:12,899 --> 00:12:16,199
towards now the idea is that each of the

249
00:12:16,199 --> 00:12:20,370
tasks or service so that if you are

250
00:12:20,370 --> 00:12:25,319
learning chrome on low powered device

251
00:12:25,319 --> 00:12:28,829
member process takes up memory they can

252
00:12:28,829 --> 00:12:31,559
consolidate them so that there is a less

253
00:12:31,559 --> 00:12:35,130
process to provide the experience but if

254
00:12:35,130 --> 00:12:37,110
you were on Mac or something that is

255
00:12:37,110 --> 00:12:39,540
powerful then they can spin up more

256
00:12:39,540 --> 00:12:42,920
processes to do a better efficient work

257
00:12:42,920 --> 00:12:45,720
so for the purpose of the talk I'm going

258
00:12:45,720 --> 00:12:51,660
to talk about a this model which is mmm

259
00:12:51,660 --> 00:12:55,019
Colin may be near past architecture or

260
00:12:55,019 --> 00:12:59,009
bacome which is one browser process it's

261
00:12:59,009 --> 00:13:00,899
at the top that kicks

262
00:13:00,899 --> 00:13:04,709
whew multiple of Landru process they

263
00:13:04,709 --> 00:13:07,110
also kicks a plugin process GPU and then

264
00:13:07,110 --> 00:13:13,069
of course utility I am it's important to

265
00:13:13,069 --> 00:13:20,149
mention that this is a this is a

266
00:13:20,149 --> 00:13:22,829
implementation detail there is no speck

267
00:13:22,829 --> 00:13:25,230
how to write over browser there is a

268
00:13:25,230 --> 00:13:27,749
speck way CMS ESS but there's no spec

269
00:13:27,749 --> 00:13:29,220
for how many processes the browser

270
00:13:29,220 --> 00:13:31,529
should use so Firefox might be different

271
00:13:31,529 --> 00:13:33,269
it might be different or might be

272
00:13:33,269 --> 00:13:34,079
different

273
00:13:34,079 --> 00:13:36,839
I'm only choosing this model because I

274
00:13:36,839 --> 00:13:40,290
work for them so it was a lot easier to

275
00:13:40,290 --> 00:13:43,759
answer questions if I had them so

276
00:13:43,759 --> 00:13:46,170
looking at this is very abstract so

277
00:13:46,170 --> 00:13:47,999
let's put it into what you can see in

278
00:13:47,999 --> 00:13:50,790
visual so imagine you're like your old

279
00:13:50,790 --> 00:13:56,160
web browser this part everything outside

280
00:13:56,160 --> 00:13:58,850
of the content that you provide is

281
00:13:58,850 --> 00:14:01,529
called sometimes called chrome of the

282
00:14:01,529 --> 00:14:03,809
application where I believe we're named

283
00:14:03,809 --> 00:14:07,009
chrome come from that browser process

284
00:14:07,009 --> 00:14:09,839
responsibility they have UI thread that

285
00:14:09,839 --> 00:14:12,660
controls UI they have networks where to

286
00:14:12,660 --> 00:14:15,420
get data from network and then the part

287
00:14:15,420 --> 00:14:18,870
that yoko demands web content or the tab

288
00:14:18,870 --> 00:14:22,470
is and reprocessed responsibility if

289
00:14:22,470 --> 00:14:25,589
inside of them have a plugin say flash

290
00:14:25,589 --> 00:14:27,990
and that is controlled by plugging

291
00:14:27,990 --> 00:14:31,220
process and then on top of that

292
00:14:31,220 --> 00:14:35,370
everything visually happening both a the

293
00:14:35,370 --> 00:14:37,410
chrome part of the application and a web

294
00:14:37,410 --> 00:14:39,540
content part of the application is

295
00:14:39,540 --> 00:14:44,459
helped and powered by GPU process cool

296
00:14:44,459 --> 00:14:49,670
yeah so i mentioned that the multiple

297
00:14:49,670 --> 00:14:52,889
lender processes for chrome so what does

298
00:14:52,889 --> 00:14:54,929
that look like well in simple term it

299
00:14:54,929 --> 00:14:58,079
means that each type that you open it's

300
00:14:58,079 --> 00:15:01,379
one process with main thread and worker

301
00:15:01,379 --> 00:15:03,689
thread and you know things like you

302
00:15:03,689 --> 00:15:07,910
might heard from multi in Chris talk so

303
00:15:07,910 --> 00:15:11,339
separating these processes into each tab

304
00:15:11,339 --> 00:15:13,709
gets a little good benefit for this like

305
00:15:13,709 --> 00:15:14,420
you know

306
00:15:14,420 --> 00:15:17,900
we know to top two types don't share a

307
00:15:17,900 --> 00:15:20,500
memory so there is no fear of leaking

308
00:15:20,500 --> 00:15:24,410
and then if you know one tab gets

309
00:15:24,410 --> 00:15:28,220
unresponsible some bug memory week

310
00:15:28,220 --> 00:15:30,170
whatever and then just you know

311
00:15:30,170 --> 00:15:32,780
completely shuts off you just close them

312
00:15:32,780 --> 00:15:37,880
and other drought tabs still works right

313
00:15:37,880 --> 00:15:40,850
I kind of like roughly mentioned that

314
00:15:40,850 --> 00:15:43,040
one tab process but if you have many

315
00:15:43,040 --> 00:15:47,000
many toughs like I do Chrome kind of

316
00:15:47,000 --> 00:15:50,060
starts to be assigning different sites

317
00:15:50,060 --> 00:15:52,160
into same processes so there is

318
00:15:52,160 --> 00:15:54,650
depending on the kind of resource that

319
00:15:54,650 --> 00:15:57,080
your hardware have there is a small

320
00:15:57,080 --> 00:15:59,210
threshold of how many other processes

321
00:15:59,210 --> 00:16:02,330
that they this is reason why if you have

322
00:16:02,330 --> 00:16:04,760
a hundred tabs and then you kill one tub

323
00:16:04,760 --> 00:16:06,410
because it wasn't responsible

324
00:16:06,410 --> 00:16:08,060
all of a sudden fifty other tabs die

325
00:16:08,060 --> 00:16:12,320
right so if all of the tabs were run by

326
00:16:12,320 --> 00:16:14,360
one process then the process and many

327
00:16:14,360 --> 00:16:18,380
threads then if one of them gets busy or

328
00:16:18,380 --> 00:16:20,810
responsible then you have to kill them

329
00:16:20,810 --> 00:16:23,900
all you have to call the browser so

330
00:16:23,900 --> 00:16:27,800
that's the idea of multiple process for

331
00:16:27,800 --> 00:16:32,180
when rendering so let's we now we

332
00:16:32,180 --> 00:16:35,240
covered a how process works on their

333
00:16:35,240 --> 00:16:38,060
knees let's cover how those processes

334
00:16:38,060 --> 00:16:40,730
communicate in order to display whatever

335
00:16:40,730 --> 00:16:44,000
the code that you give it to browsers so

336
00:16:44,000 --> 00:16:46,190
today we're going to look at a very

337
00:16:46,190 --> 00:16:49,310
simple case of loading some website

338
00:16:49,310 --> 00:16:52,190
loading content download an image and

339
00:16:52,190 --> 00:16:56,150
then a little bit of scrolling so I

340
00:16:56,150 --> 00:16:58,340
talked about that the top part of the

341
00:16:58,340 --> 00:17:00,680
browser is controlled by Landru process

342
00:17:00,680 --> 00:17:03,680
so I'm sorry browser process browser

343
00:17:03,680 --> 00:17:05,120
process have a few different threads

344
00:17:05,120 --> 00:17:07,640
like UI thread that controls all the UI

345
00:17:07,640 --> 00:17:10,310
built a network thread that goes out to

346
00:17:10,310 --> 00:17:12,589
get the data from the network and then

347
00:17:12,589 --> 00:17:15,980
store stories thread basically access to

348
00:17:15,980 --> 00:17:17,660
your file access Hey and then I'm sure

349
00:17:17,660 --> 00:17:20,959
there's many more so when you are typing

350
00:17:20,959 --> 00:17:23,570
things into that omnibox that's browser

351
00:17:23,570 --> 00:17:26,530
process responsibility because that's UI

352
00:17:26,530 --> 00:17:28,720
and you already looks at that input

353
00:17:28,720 --> 00:17:30,520
saying like it's this search query or

354
00:17:30,520 --> 00:17:33,220
URL because in comm you can either a

355
00:17:33,220 --> 00:17:35,110
search query and go to a search engine

356
00:17:35,110 --> 00:17:38,200
or you can request a website and in this

357
00:17:38,200 --> 00:17:40,600
case it looks like website so it's a URL

358
00:17:40,600 --> 00:17:42,820
your voicethread calls up a network

359
00:17:42,820 --> 00:17:45,280
thread saying like hey so this

360
00:17:45,280 --> 00:17:47,409
navigation is about the start can you go

361
00:17:47,409 --> 00:17:50,620
get the site and then it works sa thank

362
00:17:50,620 --> 00:17:53,620
you a lot you thought so they go out and

363
00:17:53,620 --> 00:17:56,650
get the data by the way this part is the

364
00:17:56,650 --> 00:17:58,390
very commonly known software engineering

365
00:17:58,390 --> 00:18:00,460
interview question and what what happens

366
00:18:00,460 --> 00:18:03,100
when you are type google.com into a

367
00:18:03,100 --> 00:18:05,230
browser you know go through if you're

368
00:18:05,230 --> 00:18:07,299
like a hot name and DNS and everything I

369
00:18:07,299 --> 00:18:10,929
am skipping all of that just you know

370
00:18:10,929 --> 00:18:13,570
masculine hondo by network thread and

371
00:18:13,570 --> 00:18:16,570
then when the little bit of data comes

372
00:18:16,570 --> 00:18:18,760
back maybe server responds with a

373
00:18:18,760 --> 00:18:21,309
soberly direct so networks the rest this

374
00:18:21,309 --> 00:18:22,750
to you I hate this

375
00:18:22,750 --> 00:18:24,580
you know server says to me direct and I

376
00:18:24,580 --> 00:18:26,200
knew I thoroughly turns same thing I was

377
00:18:26,200 --> 00:18:28,120
like okay then navigate to that Lee

378
00:18:28,120 --> 00:18:31,419
direct them but if the actual content

379
00:18:31,419 --> 00:18:33,640
start to come back the network process

380
00:18:33,640 --> 00:18:35,890
kind of sniff the beginning of the file

381
00:18:35,890 --> 00:18:38,740
by mime type sniffing to make sure the

382
00:18:38,740 --> 00:18:41,049
file that they say they are is the file

383
00:18:41,049 --> 00:18:44,830
they are and you know in case they are

384
00:18:44,830 --> 00:18:48,010
getting image file then you don't they

385
00:18:48,010 --> 00:18:49,750
don't need to lender the page it is a

386
00:18:49,750 --> 00:18:52,539
downloaded quest so they would pass it

387
00:18:52,539 --> 00:18:56,770
on to a storage thread I'm sure and this

388
00:18:56,770 --> 00:18:59,140
is where Safe Browsing check happens so

389
00:18:59,140 --> 00:19:01,809
I'm sure you might have seen who access

390
00:19:01,809 --> 00:19:05,049
one some site and then chrome suddenly

391
00:19:05,049 --> 00:19:08,500
says this might be fishing you might not

392
00:19:08,500 --> 00:19:10,510
want to click through this is where the

393
00:19:10,510 --> 00:19:12,820
check happens like if it is much to the

394
00:19:12,820 --> 00:19:15,400
known malicious content and then the LMS

395
00:19:15,400 --> 00:19:17,500
is yet so but in this case it looks

396
00:19:17,500 --> 00:19:20,049
legit so the network's racist I got what

397
00:19:20,049 --> 00:19:22,120
you requested and browser process

398
00:19:22,120 --> 00:19:24,429
returns like let me get a render process

399
00:19:24,429 --> 00:19:27,909
remember be content web content and the

400
00:19:27,909 --> 00:19:31,630
chrome is a different process so then

401
00:19:31,630 --> 00:19:33,790
at this point on UI thread mine update

402
00:19:33,790 --> 00:19:37,630
to like secure UI shows up and then

403
00:19:37,630 --> 00:19:39,880
you're back and forward button

404
00:19:39,880 --> 00:19:43,150
navigation gets committed the lender

405
00:19:43,150 --> 00:19:45,910
process wake up your wife's recess into

406
00:19:45,910 --> 00:19:47,350
process communication

407
00:19:47,350 --> 00:19:49,600
hey please render this page and then the

408
00:19:49,600 --> 00:19:53,290
process says ok get me that HTML we talk

409
00:19:53,290 --> 00:19:55,060
to network thread and a network thread

410
00:19:55,060 --> 00:19:59,140
forward stuff stream of HTML into a

411
00:19:59,140 --> 00:20:01,570
vendor process Landru takes all of that

412
00:20:01,570 --> 00:20:05,110
do its magic which we will get into and

413
00:20:05,110 --> 00:20:10,720
then returns be event saying hey page

414
00:20:10,720 --> 00:20:12,460
has loaded at this point the spinner

415
00:20:12,460 --> 00:20:15,310
stops spinning and then from browsers

416
00:20:15,310 --> 00:20:18,460
point of view navigation is complete you

417
00:20:18,460 --> 00:20:20,710
have the site at this point if you

418
00:20:20,710 --> 00:20:24,280
decide to type in other URL because as

419
00:20:24,280 --> 00:20:26,380
Java screen

420
00:20:26,380 --> 00:20:31,360
on load handler event handler somebody

421
00:20:31,360 --> 00:20:35,080
types new site again browser UI thread

422
00:20:35,080 --> 00:20:37,090
wakes up and saying like hey did you

423
00:20:37,090 --> 00:20:39,550
want to handle this event and then then

424
00:20:39,550 --> 00:20:41,650
we process looks at it and then like huh

425
00:20:41,650 --> 00:20:43,330
I might have they been hundred for that

426
00:20:43,330 --> 00:20:46,690
and then you know they might block that

427
00:20:46,690 --> 00:20:48,430
navigation or they proceed with

428
00:20:48,430 --> 00:20:52,780
navigation what gets tricky is a

429
00:20:52,780 --> 00:20:54,430
introduction of Service Worker so

430
00:20:54,430 --> 00:20:58,800
Service Worker is a way to write a

431
00:20:58,800 --> 00:21:02,320
caching and banette Makka pakka sea from

432
00:21:02,320 --> 00:21:03,820
your front end code so you write

433
00:21:03,820 --> 00:21:05,950
JavaScript to define which kind of

434
00:21:05,950 --> 00:21:08,440
resource needs to go to cache needs to

435
00:21:08,440 --> 00:21:10,720
go out from the network and you write

436
00:21:10,720 --> 00:21:12,580
your code and then you ship it with your

437
00:21:12,580 --> 00:21:14,830
application this is your Java square

438
00:21:14,830 --> 00:21:17,350
which means it lives on the lander

439
00:21:17,350 --> 00:21:20,830
process but the navigation is handled by

440
00:21:20,830 --> 00:21:24,940
a browser process so the when site is

441
00:21:24,940 --> 00:21:27,250
requested a browser process or the UI

442
00:21:27,250 --> 00:21:30,340
thread checks for known service worker

443
00:21:30,340 --> 00:21:34,000
scope so the browser process have a left

444
00:21:34,000 --> 00:21:36,130
France to a known installed

445
00:21:36,130 --> 00:21:39,700
scope basically a domain of the site and

446
00:21:39,700 --> 00:21:42,610
then checks for it and now you see oh

447
00:21:42,610 --> 00:21:43,470
there

448
00:21:43,470 --> 00:21:47,070
it is a scope serviceworker is installed

449
00:21:47,070 --> 00:21:49,529
so in this case browser process have to

450
00:21:49,529 --> 00:21:51,570
wake up the render process asking hey

451
00:21:51,570 --> 00:21:53,879
you need to align your serviceworker

452
00:21:53,879 --> 00:21:56,759
code and then the process do that and

453
00:21:56,759 --> 00:21:58,620
then turns out lando process wanted to

454
00:21:58,620 --> 00:22:00,659
get a fresh content back so they say

455
00:22:00,659 --> 00:22:02,879
actually the me like please give me

456
00:22:02,879 --> 00:22:04,320
about lee service from the freshly

457
00:22:04,320 --> 00:22:06,629
network and your wife's racist here we

458
00:22:06,629 --> 00:22:09,090
go get that to network process you might

459
00:22:09,090 --> 00:22:11,639
see this round trip is unnecessary these

460
00:22:11,639 --> 00:22:14,549
like possibly making it 0 and this is

461
00:22:14,549 --> 00:22:16,110
reason why sometimes you see article

462
00:22:16,110 --> 00:22:17,759
about like serviceworker startup time

463
00:22:17,759 --> 00:22:20,700
problem there is a proposed both there

464
00:22:20,700 --> 00:22:23,009
is a new feature that is coming into

465
00:22:23,009 --> 00:22:25,110
browser called navigation preload which

466
00:22:25,110 --> 00:22:28,440
basically starting the network request

467
00:22:28,440 --> 00:22:30,690
while they were checking with

468
00:22:30,690 --> 00:22:33,809
serviceworker my teammate Jake or wrote

469
00:22:33,809 --> 00:22:37,110
a great introduction and how to order

470
00:22:37,110 --> 00:22:39,710
call so if you're curious check that out

471
00:22:39,710 --> 00:22:44,240
so now moving on to an under process

472
00:22:44,240 --> 00:22:47,009
where we learn the process have a walk

473
00:22:47,009 --> 00:22:48,450
with rest that you've might heard of

474
00:22:48,450 --> 00:22:50,789
from the beginning talk before me and

475
00:22:50,789 --> 00:22:52,889
they also have compositor thread and

476
00:22:52,889 --> 00:22:55,320
lustrous thread that we will go and to

477
00:22:55,320 --> 00:22:58,740
get into but the make oh I need to

478
00:22:58,740 --> 00:23:00,960
purchase this day that this part is

479
00:23:00,960 --> 00:23:04,289
where when people talk about website

480
00:23:04,289 --> 00:23:07,830
performance goes in so there are so many

481
00:23:07,830 --> 00:23:10,950
details in-depth knowledge many many

482
00:23:10,950 --> 00:23:14,700
many articles even within my team's own

483
00:23:14,700 --> 00:23:16,110
documentation site there is like

484
00:23:16,110 --> 00:23:18,269
hundreds of them so if you're curious of

485
00:23:18,269 --> 00:23:20,669
any of that bit I recommend you to go

486
00:23:20,669 --> 00:23:23,039
check that out and just to make sure

487
00:23:23,039 --> 00:23:25,279
that I'm not just plugging my team

488
00:23:25,279 --> 00:23:28,169
Mozilla has nearly great blog posts

489
00:23:28,169 --> 00:23:29,700
especially with the release of serve

490
00:23:29,700 --> 00:23:32,840
servo and web blender their new engine

491
00:23:32,840 --> 00:23:35,340
especially when Clark has been writing a

492
00:23:35,340 --> 00:23:37,789
lot of great explanation

493
00:23:37,789 --> 00:23:41,100
WebKit blog in between daily beast notes

494
00:23:41,100 --> 00:23:43,559
they also writes amazing documentation

495
00:23:43,559 --> 00:23:46,470
about how internal browser works so if

496
00:23:46,470 --> 00:23:48,000
you're curious about any of this from

497
00:23:48,000 --> 00:23:50,100
this talk I highly recommend check that

498
00:23:50,100 --> 00:23:53,700
out so under process last time we talked

499
00:23:53,700 --> 00:23:56,240
about you know the feed coming in

500
00:23:56,240 --> 00:23:59,270
but the blender process especially main

501
00:23:59,270 --> 00:24:02,840
threads job is to get the data and turn

502
00:24:02,840 --> 00:24:05,660
them into something that's this variable

503
00:24:05,660 --> 00:24:09,440
on the screen so how does that work the

504
00:24:09,440 --> 00:24:12,290
first step is loading and parsing as you

505
00:24:12,290 --> 00:24:14,750
sew they start receiving a stream and

506
00:24:14,750 --> 00:24:18,230
they start leading them from the top to

507
00:24:18,230 --> 00:24:20,780
the bottom and then if the browser the

508
00:24:20,780 --> 00:24:23,600
main thread sees that the link or image

509
00:24:23,600 --> 00:24:25,370
your script that needs to get out to get

510
00:24:25,370 --> 00:24:27,350
it they send the request to the network

511
00:24:27,350 --> 00:24:30,490
thread in browser process together but

512
00:24:30,490 --> 00:24:34,370
result of this process parsing is a Dom

513
00:24:34,370 --> 00:24:38,210
tree that we all know this is a browsers

514
00:24:38,210 --> 00:24:40,640
internal representation of the site as

515
00:24:40,640 --> 00:24:45,140
well as a API another position to ask

516
00:24:45,140 --> 00:24:47,090
JavaScript developer interact with via

517
00:24:47,090 --> 00:24:54,440
JavaScript so in this process if a main

518
00:24:54,440 --> 00:24:57,170
thread is a JavaScript then they need to

519
00:24:57,170 --> 00:24:59,390
pause the parsing and then they need to

520
00:24:59,390 --> 00:25:01,250
get the JavaScript don't know them parse

521
00:25:01,250 --> 00:25:03,410
them execute them and then once

522
00:25:03,410 --> 00:25:05,090
everything is done they can go back to

523
00:25:05,090 --> 00:25:08,690
the list of HTML because javascript can

524
00:25:08,690 --> 00:25:12,560
modify dong so you know am I do a little

525
00:25:12,560 --> 00:25:14,300
bit of HTML and you're feeling good and

526
00:25:14,300 --> 00:25:17,270
then like brow JavaScript comes in and

527
00:25:17,270 --> 00:25:19,190
document light everything that's

528
00:25:19,190 --> 00:25:23,240
possibility so they need to stop that's

529
00:25:23,240 --> 00:25:25,220
this is why a lot of like a kind of

530
00:25:25,220 --> 00:25:26,690
water wisdom about I could put the

531
00:25:26,690 --> 00:25:28,550
JavaScript at the bottom comes from and

532
00:25:28,550 --> 00:25:31,970
then you know modern browsers or more on

533
00:25:31,970 --> 00:25:33,860
web api is has been introducing a lot of

534
00:25:33,860 --> 00:25:37,190
ways to hint to the browser how to treat

535
00:25:37,190 --> 00:25:39,380
those things so if you were sure that

536
00:25:39,380 --> 00:25:41,720
your JavaScript code is now going to

537
00:25:41,720 --> 00:25:43,400
interact with Dom then you can put a

538
00:25:43,400 --> 00:25:45,500
single tree view because that's not

539
00:25:45,500 --> 00:25:47,840
gonna block a evander if you're curious

540
00:25:47,840 --> 00:25:50,270
about those resource priority my

541
00:25:50,270 --> 00:25:51,920
teammate what about those on the same

542
00:25:51,920 --> 00:25:56,900
site that I'd be showing so now that the

543
00:25:56,900 --> 00:26:00,080
dome is there the only Dom is not gonna

544
00:26:00,080 --> 00:26:02,600
construct a website they need style so

545
00:26:02,600 --> 00:26:06,440
the LED CSS and then they curricula it's

546
00:26:06,440 --> 00:26:08,000
what's called a computed style

547
00:26:08,000 --> 00:26:09,080
it's basically

548
00:26:09,080 --> 00:26:12,020
matching of what kind of CSS is applied

549
00:26:12,020 --> 00:26:16,340
to this one given domnode you can see

550
00:26:16,340 --> 00:26:20,270
those in a depth was ha

551
00:26:20,270 --> 00:26:23,960
you see oops you see their computer part

552
00:26:23,960 --> 00:26:25,820
that's what you were seeing the computed

553
00:26:25,820 --> 00:26:31,130
style and once that's done is it

554
00:26:31,130 --> 00:26:33,920
possible to render the page not really I

555
00:26:33,920 --> 00:26:35,690
mean I'm looking at it there is a paper

556
00:26:35,690 --> 00:26:38,330
on top of that paper there's a phone I

557
00:26:38,330 --> 00:26:40,790
can't really describe how it is a placed

558
00:26:40,790 --> 00:26:43,730
or it is so they need to figure out

559
00:26:43,730 --> 00:26:47,090
layout the geometry of the page so the

560
00:26:47,090 --> 00:26:49,250
main thread goes through like you know

561
00:26:49,250 --> 00:26:51,890
oh and the layout is tricky like even

562
00:26:51,890 --> 00:26:54,080
with a simple website like this they

563
00:26:54,080 --> 00:26:55,550
need to figure out where the line blake

564
00:26:55,550 --> 00:26:58,070
is going to be and if they line break on

565
00:26:58,070 --> 00:27:00,440
that point then the top of the box

566
00:27:00,440 --> 00:27:02,990
expands which means the subsequent box

567
00:27:02,990 --> 00:27:07,250
all moves down so there is a vertical

568
00:27:07,250 --> 00:27:10,730
writing on the CSS there is a float and

569
00:27:10,730 --> 00:27:13,070
flex and layout is quite complicated

570
00:27:13,070 --> 00:27:16,550
tasks but they work through that and

571
00:27:16,550 --> 00:27:18,950
then creates what's called layer tree

572
00:27:18,950 --> 00:27:21,230
it's important to note that layer tree

573
00:27:21,230 --> 00:27:24,230
is not equal to dom tree sometimes looks

574
00:27:24,230 --> 00:27:27,020
like it's the same but they all make use

575
00:27:27,020 --> 00:27:28,850
of all the things that's going to be on

576
00:27:28,850 --> 00:27:31,760
the screen so they omit the things like

577
00:27:31,760 --> 00:27:33,800
display now and they add things that's

578
00:27:33,800 --> 00:27:36,410
not in the dom like a pseudo content

579
00:27:36,410 --> 00:27:41,920
from CSS so then it's time to paint

580
00:27:41,920 --> 00:27:45,500
because we have geometry and what's in

581
00:27:45,500 --> 00:27:47,390
them and style of them you might think

582
00:27:47,390 --> 00:27:49,910
that you can pay draw the picture

583
00:27:49,910 --> 00:27:52,220
already but if i'm having this like

584
00:27:52,220 --> 00:27:54,560
human fax machine game is like Sue's

585
00:27:54,560 --> 00:27:56,420
who's my friend sitting in front of me i

586
00:27:56,420 --> 00:27:59,360
can't still can't media just explain

587
00:27:59,360 --> 00:28:01,940
what exactly i am saying in front of me

588
00:28:01,940 --> 00:28:04,700
because of the index and all of the

589
00:28:04,700 --> 00:28:08,120
complicated CSS stuff so if i go through

590
00:28:08,120 --> 00:28:11,300
this by dumb order then i would paint a

591
00:28:11,300 --> 00:28:14,780
header and then next is div and the next

592
00:28:14,780 --> 00:28:17,660
is another div but then there's a d'

593
00:28:17,660 --> 00:28:20,180
index so this is totally messed up

594
00:28:20,180 --> 00:28:20,780
so the

595
00:28:20,780 --> 00:28:24,080
need to figure out exactly how to paint

596
00:28:24,080 --> 00:28:26,990
the page and that process is called

597
00:28:26,990 --> 00:28:30,020
paint they go through the layout tree

598
00:28:30,020 --> 00:28:32,060
and then create what's called a paint Li

599
00:28:32,060 --> 00:28:33,890
course and it's kind of like if you look

600
00:28:33,890 --> 00:28:37,370
at used a canvas API then it's similar

601
00:28:37,370 --> 00:28:39,980
to that you just like have a do this do

602
00:28:39,980 --> 00:28:43,670
that do this to the create the page it's

603
00:28:43,670 --> 00:28:47,240
really important to note that in each

604
00:28:47,240 --> 00:28:49,820
steps the input is from the previous

605
00:28:49,820 --> 00:28:53,270
step so if you mess something up in the

606
00:28:53,270 --> 00:28:55,910
middle of this pixel pipeline then all

607
00:28:55,910 --> 00:28:59,240
of the subsequent trees and data

608
00:28:59,240 --> 00:29:02,570
structures needs to be regenerated if

609
00:29:02,570 --> 00:29:04,280
it's like at the end of their maybe it's

610
00:29:04,280 --> 00:29:06,380
okay but if you do a deep in the lending

611
00:29:06,380 --> 00:29:08,840
process then you know there's a lot of

612
00:29:08,840 --> 00:29:11,300
computation to be done and if you were

613
00:29:11,300 --> 00:29:12,830
doing this kind of thing for your

614
00:29:12,830 --> 00:29:15,620
animation say then you know you're in

615
00:29:15,620 --> 00:29:19,520
problem because our display refreshes

616
00:29:19,520 --> 00:29:23,300
sixteen sixty times a second so you need

617
00:29:23,300 --> 00:29:25,160
to make sure that all the calculation is

618
00:29:25,160 --> 00:29:28,310
catching up to that cadence so you might

619
00:29:28,310 --> 00:29:30,200
be feeling good but then oh you missed a

620
00:29:30,200 --> 00:29:33,920
frame and page chunks or you know am I

621
00:29:33,920 --> 00:29:36,290
feeling good you have like a tiny change

622
00:29:36,290 --> 00:29:38,720
is going in but then keep in mind this

623
00:29:38,720 --> 00:29:41,120
is main thread so it's also hungry in

624
00:29:41,120 --> 00:29:42,890
your JavaScript code and your JavaScript

625
00:29:42,890 --> 00:29:45,080
code is start to throw a heavy

626
00:29:45,080 --> 00:29:47,150
computation thing and then you make a

627
00:29:47,150 --> 00:29:51,950
frame and pin chunks there's a way to

628
00:29:51,950 --> 00:29:54,200
get that timing by calling

629
00:29:54,200 --> 00:29:56,600
requestanimationframe and there's a way

630
00:29:56,600 --> 00:29:58,970
to like divide your heavy JavaScript

631
00:29:58,970 --> 00:30:00,320
tasks so that it doesn't block

632
00:30:00,320 --> 00:30:02,420
calendaring there is heavily documented

633
00:30:02,420 --> 00:30:04,340
on optimizing JavaScript execution

634
00:30:04,340 --> 00:30:08,390
documentation so now that we have all of

635
00:30:08,390 --> 00:30:10,760
the draw orders and everything maybe

636
00:30:10,760 --> 00:30:13,160
it's time to draw or last revised the

637
00:30:13,160 --> 00:30:16,130
page how would you do that well you

638
00:30:16,130 --> 00:30:19,220
might go through naive way like okay I

639
00:30:19,220 --> 00:30:21,470
know the viewport I know the layout I

640
00:30:21,470 --> 00:30:23,750
know how to paint those layout so I'm

641
00:30:23,750 --> 00:30:26,210
gonna lay them up if person's clothes

642
00:30:26,210 --> 00:30:29,810
then I'm gonna fill in the list and if

643
00:30:29,810 --> 00:30:34,190
the UI moves like you know the menu bar

644
00:30:34,190 --> 00:30:34,740
slides

645
00:30:34,740 --> 00:30:36,570
something I'm gonna invalidate that

646
00:30:36,570 --> 00:30:38,429
changed apart and nearly drawn them

647
00:30:38,429 --> 00:30:41,370
again but you can see this kids kind of

648
00:30:41,370 --> 00:30:44,070
like a lot of work if you were trying to

649
00:30:44,070 --> 00:30:46,110
do a 60 frames per second so a modern

650
00:30:46,110 --> 00:30:49,800
browser have a way to do this a little

651
00:30:49,800 --> 00:30:53,040
more and efficiently called a composite

652
00:30:53,040 --> 00:30:55,830
so the idea of composite is that they're

653
00:30:55,830 --> 00:30:58,380
going to divide all of your elements

654
00:30:58,380 --> 00:31:00,510
into layers like Photoshop layers and

655
00:31:00,510 --> 00:31:05,010
they'll a stir them all together that's

656
00:31:05,010 --> 00:31:07,830
why it's already last Erised image so

657
00:31:07,830 --> 00:31:10,320
all the browser has to do is moving and

658
00:31:10,320 --> 00:31:11,309
layering them

659
00:31:11,309 --> 00:31:14,190
so changing the scrolling doesn't matter

660
00:31:14,190 --> 00:31:16,800
moving the things that is already in one

661
00:31:16,800 --> 00:31:20,250
layer as a murderer walk smoothly so

662
00:31:20,250 --> 00:31:22,740
here's a video of you can check this

663
00:31:22,740 --> 00:31:25,050
layer on your dev tool so here's a video

664
00:31:25,050 --> 00:31:27,450
of application that I made which is

665
00:31:27,450 --> 00:31:30,330
visualizing your image input as a new

666
00:31:30,330 --> 00:31:32,910
fabric you can see there are two layers

667
00:31:32,910 --> 00:31:35,370
as I move them you can see that layer

668
00:31:35,370 --> 00:31:39,179
box is moving I am going to soon turn on

669
00:31:39,179 --> 00:31:42,120
the paint in flashing which basically is

670
00:31:42,120 --> 00:31:44,700
a hint see to see which part of the

671
00:31:44,700 --> 00:31:47,100
lesion of the page is painted oh it's

672
00:31:47,100 --> 00:31:51,600
just it is a green paint happen so there

673
00:31:51,600 --> 00:31:52,650
might be some kind of performance

674
00:31:52,650 --> 00:31:54,870
problem that I have but you can see I

675
00:31:54,870 --> 00:31:58,320
move all of my pictures and no paint is

676
00:31:58,320 --> 00:32:00,090
happening it's already last Royce and

677
00:32:00,090 --> 00:32:02,910
it's just moving so that's the composite

678
00:32:02,910 --> 00:32:06,510
in order to do this the browser go

679
00:32:06,510 --> 00:32:09,720
through a layer tree to create a layer

680
00:32:09,720 --> 00:32:14,040
tree and once that layer tree is created

681
00:32:14,040 --> 00:32:16,890
they can composite sometimes you might

682
00:32:16,890 --> 00:32:19,080
find parts of your application that you

683
00:32:19,080 --> 00:32:22,080
think is a layer might not get layer in

684
00:32:22,080 --> 00:32:23,790
that case you can hint to the browser

685
00:32:23,790 --> 00:32:26,220
hey this will change and then bake we're

686
00:32:26,220 --> 00:32:28,410
there for you for the world change and

687
00:32:28,410 --> 00:32:31,860
it's tempting to they're all the things

688
00:32:31,860 --> 00:32:33,660
because it's gonna be plea bastard and

689
00:32:33,660 --> 00:32:35,790
it's just moving them but that man is

690
00:32:35,790 --> 00:32:38,070
old in a another performance junk so

691
00:32:38,070 --> 00:32:39,750
it's always important to measure your

692
00:32:39,750 --> 00:32:41,820
performance runtime performance before

693
00:32:41,820 --> 00:32:45,690
deciding how to use those attributes so

694
00:32:45,690 --> 00:32:48,190
now that all of the trees

695
00:32:48,190 --> 00:32:51,159
paint order is in main thread' calls up

696
00:32:51,159 --> 00:32:53,799
a compositor threat which is specialized

697
00:32:53,799 --> 00:32:56,289
to Honduran dis compositing they commit

698
00:32:56,289 --> 00:32:58,679
that data and say goal display this page

699
00:32:58,679 --> 00:33:04,360
so then compositor thread try to Laster

700
00:33:04,360 --> 00:33:06,909
the page but as you can see the page is

701
00:33:06,909 --> 00:33:09,490
now bigger it's not just beautiful so

702
00:33:09,490 --> 00:33:11,379
they have a mechanism to divide that up

703
00:33:11,379 --> 00:33:14,830
into tile and each of the tile is last

704
00:33:14,830 --> 00:33:18,039
rise using Laster thread what the last

705
00:33:18,039 --> 00:33:19,960
of thread is doing is that getting the

706
00:33:19,960 --> 00:33:24,730
small quad of the page making into a GPU

707
00:33:24,730 --> 00:33:27,190
texture map and put it into GPU memory

708
00:33:27,190 --> 00:33:30,539
also keeping the love friends in a

709
00:33:30,539 --> 00:33:33,789
compositor thread so compositor spread

710
00:33:33,789 --> 00:33:35,620
also have a idea of where the viewport

711
00:33:35,620 --> 00:33:39,129
is so they might schedules the around

712
00:33:39,129 --> 00:33:41,649
the viewport earlier than the one on the

713
00:33:41,649 --> 00:33:43,059
bottom so they are a little more

714
00:33:43,059 --> 00:33:45,789
sophisticated but now you have all of

715
00:33:45,789 --> 00:33:48,730
the draw was compositor thread composite

716
00:33:48,730 --> 00:33:51,070
the page and then create what's called a

717
00:33:51,070 --> 00:33:53,289
compositor frame this is the frame of

718
00:33:53,289 --> 00:33:54,659
your application that you're showing

719
00:33:54,659 --> 00:33:58,049
this one gets sent to a browser process

720
00:33:58,049 --> 00:34:01,299
your IPC same vendor this and browser

721
00:34:01,299 --> 00:34:03,220
process UI process might add another

722
00:34:03,220 --> 00:34:06,370
composite frame you know to display the

723
00:34:06,370 --> 00:34:09,429
UI part of the thing and then sent it to

724
00:34:09,429 --> 00:34:13,359
GPU if the screw comes in remember the

725
00:34:13,359 --> 00:34:16,389
school input comes in the UI thread says

726
00:34:16,389 --> 00:34:19,149
hey there is inter compositor thread

727
00:34:19,149 --> 00:34:21,310
goes no problem I know how to layer

728
00:34:21,310 --> 00:34:23,500
these things so they create another

729
00:34:23,500 --> 00:34:27,190
compositor frame send it to GPU and you

730
00:34:27,190 --> 00:34:28,659
know small screwing because the most

731
00:34:28,659 --> 00:34:30,730
important part is that a compositor

732
00:34:30,730 --> 00:34:32,889
surrett could handle all of this they

733
00:34:32,889 --> 00:34:35,440
didn't need to bother a main thread they

734
00:34:35,440 --> 00:34:39,099
didn't junk the page so but sometimes

735
00:34:39,099 --> 00:34:40,389
you might have this kind of application

736
00:34:40,389 --> 00:34:45,190
where you want to like you know clip the

737
00:34:45,190 --> 00:34:47,290
only horizontal scroll to one region and

738
00:34:47,290 --> 00:34:48,700
you might add other event listener and

739
00:34:48,700 --> 00:34:50,290
and prevent default and then kind of

740
00:34:50,290 --> 00:34:54,579
trying to force the scroll well that

741
00:34:54,579 --> 00:34:56,530
event handler lives in the main thread

742
00:34:56,530 --> 00:34:59,079
in JavaScript so how does dart handled

743
00:34:59,079 --> 00:35:01,280
so compositor thread

744
00:35:01,280 --> 00:35:03,859
when their last raising and compositing

745
00:35:03,859 --> 00:35:06,530
them they mark that part as a known fast

746
00:35:06,530 --> 00:35:08,720
goal of Allegiant which basically means

747
00:35:08,720 --> 00:35:11,000
that if an even happens on this point

748
00:35:11,000 --> 00:35:14,480
then tell me and then I need to ask my

749
00:35:14,480 --> 00:35:17,569
main threat pause the scroll they say

750
00:35:17,569 --> 00:35:19,790
hey you need something maybe I might say

751
00:35:19,790 --> 00:35:22,099
yeah there is event handler so I'm gonna

752
00:35:22,099 --> 00:35:26,990
block that default move right but there

753
00:35:26,990 --> 00:35:28,940
is a common technique in JavaScript

754
00:35:28,940 --> 00:35:31,819
which is event delegation you put it one

755
00:35:31,819 --> 00:35:34,130
event listener on the top or the big

756
00:35:34,130 --> 00:35:36,200
lesion of it and then you check which of

757
00:35:36,200 --> 00:35:38,630
the target it is in this case it's a

758
00:35:38,630 --> 00:35:40,849
problem everything becomes known fast

759
00:35:40,849 --> 00:35:43,069
scrollable legion and compositors

760
00:35:43,069 --> 00:35:45,230
threader is basically just dispatching

761
00:35:45,230 --> 00:35:47,300
the message to main threat like you need

762
00:35:47,300 --> 00:35:50,390
it like even though main threat actually

763
00:35:50,390 --> 00:35:52,760
didn't need those part they need to ask

764
00:35:52,760 --> 00:35:56,359
to them so as a web developer it's a big

765
00:35:56,359 --> 00:35:59,329
chunk so as a web developer we can put a

766
00:35:59,329 --> 00:36:04,490
passive true options and that makes you

767
00:36:04,490 --> 00:36:08,270
Legion not read basically what it means

768
00:36:08,270 --> 00:36:10,369
is that I still want to hear about the

769
00:36:10,369 --> 00:36:12,260
event on the main threat but you can go

770
00:36:12,260 --> 00:36:14,990
ahead and start scrolling if you want to

771
00:36:14,990 --> 00:36:19,069
and there is a CSS attribute like touch

772
00:36:19,069 --> 00:36:21,170
action panics which basically you don't

773
00:36:21,170 --> 00:36:23,960
need to write any JavaScript logic to

774
00:36:23,960 --> 00:36:25,640
prevent default and then clip it to

775
00:36:25,640 --> 00:36:27,349
whatever the gesture that you want just

776
00:36:27,349 --> 00:36:30,109
write a CSS and browser takes care for

777
00:36:30,109 --> 00:36:34,430
you so those things also document it on

778
00:36:34,430 --> 00:36:36,890
our side if you want to check that out

779
00:36:36,890 --> 00:36:39,800
so hopefully this didn't overwhelm you

780
00:36:39,800 --> 00:36:46,010
with like so many things I need to know

781
00:36:46,010 --> 00:36:48,680
well there is a little bit of tools to

782
00:36:48,680 --> 00:36:50,660
help you when you are trying to develop

783
00:36:50,660 --> 00:36:53,990
so one is lighthouse lighthouse is a

784
00:36:53,990 --> 00:36:56,630
plug-in also tool that lives within the

785
00:36:56,630 --> 00:36:59,540
chrome developer tool if you go open the

786
00:36:59,540 --> 00:37:02,270
audits tab they run the audit over your

787
00:37:02,270 --> 00:37:04,460
site and then tells you the score and a

788
00:37:04,460 --> 00:37:05,930
lot of people cares about the score and

789
00:37:05,930 --> 00:37:08,270
getting hundred but what I find more

790
00:37:08,270 --> 00:37:11,030
interesting is a explanation of each

791
00:37:11,030 --> 00:37:12,610
audit

792
00:37:12,610 --> 00:37:15,400
and when I started at this team home

793
00:37:15,400 --> 00:37:17,500
develop operations first thing I did was

794
00:37:17,500 --> 00:37:19,570
going through all of the audit to learn

795
00:37:19,570 --> 00:37:22,210
what browser cares about as a

796
00:37:22,210 --> 00:37:24,750
performance or any other business area

797
00:37:24,750 --> 00:37:26,920
other thing that's coming to the

798
00:37:26,920 --> 00:37:29,140
platform is a feature policy so future

799
00:37:29,140 --> 00:37:31,450
potty is like a content security policy

800
00:37:31,450 --> 00:37:33,970
but for your feature so you put a little

801
00:37:33,970 --> 00:37:37,690
bit of a snippet in your header then it

802
00:37:37,690 --> 00:37:41,290
will block the feature so you might have

803
00:37:41,290 --> 00:37:43,180
things like fast animation feature

804
00:37:43,180 --> 00:37:46,690
policy where every CSS animation that is

805
00:37:46,690 --> 00:37:49,330
not performing it's blocked there is a

806
00:37:49,330 --> 00:37:52,810
feature policy demos up comm that has

807
00:37:52,810 --> 00:37:55,720
all of the try and eller type of thing

808
00:37:55,720 --> 00:37:58,120
and this is super this is very new and

809
00:37:58,120 --> 00:37:59,980
it's really interesting to see what kind

810
00:37:59,980 --> 00:38:02,200
of feature policies proposed because it

811
00:38:02,200 --> 00:38:04,450
tells what kind of performance problems

812
00:38:04,450 --> 00:38:06,040
what kind of feature problem that the

813
00:38:06,040 --> 00:38:07,720
web developer and browser engineers are

814
00:38:07,720 --> 00:38:12,010
having so hopefully through this you

815
00:38:12,010 --> 00:38:13,480
might thought that oh I already knew

816
00:38:13,480 --> 00:38:16,000
that you are on the behind the side of

817
00:38:16,000 --> 00:38:19,960
the browser I was the front side if you

818
00:38:19,960 --> 00:38:21,760
are like me who is like this is

819
00:38:21,760 --> 00:38:24,010
interesting but I don't know where to

820
00:38:24,010 --> 00:38:26,620
start I recommend just building

821
00:38:26,620 --> 00:38:30,760
applications it doesn't have to be to do

822
00:38:30,760 --> 00:38:32,890
MVC it doesn't have to be Hakone use

823
00:38:32,890 --> 00:38:34,810
clone you can pick whatever the thing

824
00:38:34,810 --> 00:38:37,510
you want to do I like knitting so for

825
00:38:37,510 --> 00:38:39,970
three years since last year's comes I

826
00:38:39,970 --> 00:38:42,370
made more than five I'm sure I'm

827
00:38:42,370 --> 00:38:46,360
forgetting knitting related application

828
00:38:46,360 --> 00:38:48,790
which all of them have idea of compilers

829
00:38:48,790 --> 00:38:53,590
a bit operations UI transform smooth

830
00:38:53,590 --> 00:38:56,230
scrolling all of it and like by the time

831
00:38:56,230 --> 00:38:58,240
the fifth one knitter if I this is the

832
00:38:58,240 --> 00:39:00,250
only one that I can proudly say to my

833
00:39:00,250 --> 00:39:02,170
friend hey use this sauce vacation it's

834
00:39:02,170 --> 00:39:05,170
actually kind of cool so it takes time

835
00:39:05,170 --> 00:39:07,540
it's really frustrating but I highly

836
00:39:07,540 --> 00:39:10,360
recommend learning them and if you

837
00:39:10,360 --> 00:39:13,060
didn't get anything from it I hope this

838
00:39:13,060 --> 00:39:16,000
image of q-thruster now engrave into

839
00:39:16,000 --> 00:39:17,980
your brain and you think about them

840
00:39:17,980 --> 00:39:21,580
every time you open a browser this has

841
00:39:21,580 --> 00:39:23,470
been me Marco that's my twitter handle

842
00:39:23,470 --> 00:39:25,339
this slide is super eye

843
00:39:25,339 --> 00:39:27,140
in heavy I am planning on publishing

844
00:39:27,140 --> 00:39:29,930
static version later and all of the

845
00:39:29,930 --> 00:39:32,029
reference I mean I counted this morning

846
00:39:32,029 --> 00:39:36,140
I had a 48 tabs of resources to us so

847
00:39:36,140 --> 00:39:37,910
dough will be coming soon if you took

848
00:39:37,910 --> 00:39:39,410
any of the pictures or you want to use

849
00:39:39,410 --> 00:39:42,440
the slice later I consider all of my

850
00:39:42,440 --> 00:39:46,609
drawing to be CC by NC s a 4.0 whatever

851
00:39:46,609 --> 00:39:48,589
that was I forgot I decided that was the

852
00:39:48,589 --> 00:39:51,890
license I'm going to use so if you use

853
00:39:51,890 --> 00:39:53,839
them in your talk or education no blog

854
00:39:53,839 --> 00:39:57,259
or whatever do they mean oh please use

855
00:39:57,259 --> 00:39:58,820
away thank you very much

