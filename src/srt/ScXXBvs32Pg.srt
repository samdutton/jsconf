1
00:00:16,220 --> 00:00:18,350

so I'm gonna be talking about

2
00:00:18,350 --> 00:00:22,859
performance user interfaces using CSS

3
00:00:22,859 --> 00:00:24,420
magic so kind of trying to take that

4
00:00:24,420 --> 00:00:27,330
magic of CSS and trying to explain what

5
00:00:27,330 --> 00:00:29,210
is actually going on and how you can

6
00:00:29,210 --> 00:00:31,700
make and use the dev tools to measure

7
00:00:31,700 --> 00:00:34,590
performance and define where performance

8
00:00:34,590 --> 00:00:36,210
bottlenecks are etc and find issues

9
00:00:36,210 --> 00:00:37,739
using the different tools we have

10
00:00:37,739 --> 00:00:41,129
available so yeah I'm Ryan Sedin from

11
00:00:41,129 --> 00:00:44,280
Melbourne Australia I did a fun little

12
00:00:44,280 --> 00:00:46,739
animation they're going to call play

13
00:00:46,739 --> 00:00:49,170
with it works on touch as well and just

14
00:00:49,170 --> 00:00:51,809
to show that like performance is more

15
00:00:51,809 --> 00:00:54,870
than just about HTTP it's about the user

16
00:00:54,870 --> 00:00:57,690
experience and also about how fast you

17
00:00:57,690 --> 00:00:59,609
can paint to the screen so there's sort

18
00:00:59,609 --> 00:01:02,129
of two sides to it I'm mostly going to

19
00:01:02,129 --> 00:01:04,229
like the the technical side of it but

20
00:01:04,229 --> 00:01:05,220
i'll cover slightly some of the

21
00:01:05,220 --> 00:01:09,810
animation side so animation can improve

22
00:01:09,810 --> 00:01:11,580
performance whether you're a technical

23
00:01:11,580 --> 00:01:13,860
person and you like you like you look at

24
00:01:13,860 --> 00:01:15,270
the animation you think I this is really

25
00:01:15,270 --> 00:01:16,920
well executed or you're just a general

26
00:01:16,920 --> 00:01:18,330
user and you sort of get some delight

27
00:01:18,330 --> 00:01:21,960
out of it well executed animation it

28
00:01:21,960 --> 00:01:24,150
really instills the perception of like a

29
00:01:24,150 --> 00:01:26,250
really well performing application well

30
00:01:26,250 --> 00:01:28,799
that's on the web and mobile and it's

31
00:01:28,799 --> 00:01:31,860
not the bad old days of 22nd transitions

32
00:01:31,860 --> 00:01:35,360
and flash this is about like to enhance

33
00:01:35,360 --> 00:01:38,939
the animations and the user experience a

34
00:01:38,939 --> 00:01:40,710
really great example that I've seen is

35
00:01:40,710 --> 00:01:44,310
the stripe check out page I'm going to

36
00:01:44,310 --> 00:01:46,140
Adam Atticus there you can see that

37
00:01:46,140 --> 00:01:47,549
comes in really nicely and it looks so

38
00:01:47,549 --> 00:01:48,960
really cool and how everything sort of

39
00:01:48,960 --> 00:01:50,430
interacts and like sort of like it's got

40
00:01:50,430 --> 00:01:54,420
a pseudo physics pace set up um necron

41
00:01:54,420 --> 00:01:55,649
it looks really perform it and looks

42
00:01:55,649 --> 00:01:57,840
like that it's like a really nice user

43
00:01:57,840 --> 00:02:00,750
experience to use so how could you do

44
00:02:00,750 --> 00:02:04,469
this yourself a not sure how strive did

45
00:02:04,469 --> 00:02:05,790
a technically themselves but there is a

46
00:02:05,790 --> 00:02:08,550
couple tools that I've seen one called

47
00:02:08,550 --> 00:02:10,619
bass chairs and that allows you to do is

48
00:02:10,619 --> 00:02:11,970
sort of like pseudo based physics

49
00:02:11,970 --> 00:02:13,980
animation so you can do like Springs

50
00:02:13,980 --> 00:02:16,110
staff interferes with each other and you

51
00:02:16,110 --> 00:02:17,580
get that sort of nice spring emotion

52
00:02:17,580 --> 00:02:20,580
natural sort of movement in your

53
00:02:20,580 --> 00:02:23,519
application and the web is capable of

54
00:02:23,519 --> 00:02:24,989
native performance I ain't using that

55
00:02:24,989 --> 00:02:26,459
word Nettie's performance but they've

56
00:02:26,459 --> 00:02:28,849
sort of set the bar of what users expect

57
00:02:28,849 --> 00:02:30,959
but it's a lot harder on the web because

58
00:02:30,959 --> 00:02:32,310
it's really easy to degrade performance

59
00:02:32,310 --> 00:02:37,290
and not no way so that's kind of

60
00:02:37,290 --> 00:02:38,549
animation side so I'm going to go into

61
00:02:38,549 --> 00:02:41,129
sort of like a case study this is like a

62
00:02:41,129 --> 00:02:43,170
little project I built and we had a

63
00:02:43,170 --> 00:02:44,310
performance issue with it and I couldn't

64
00:02:44,310 --> 00:02:45,690
figure out what so sort of like my

65
00:02:45,690 --> 00:02:47,160
journey and how I discovered what was

66
00:02:47,160 --> 00:02:48,900
going on and sort of what the browser

67
00:02:48,900 --> 00:02:52,349
does so I read this library called

68
00:02:52,349 --> 00:02:54,090
scroll this view so just be too

69
00:02:54,090 --> 00:02:55,650
background on it it's kind of like a put

70
00:02:55,650 --> 00:02:57,840
the idea was a performance scrolling

71
00:02:57,840 --> 00:03:00,720
library it's not like I scroller doesn't

72
00:03:00,720 --> 00:03:02,640
do like the bathroom stuff but what it

73
00:03:02,640 --> 00:03:06,569
does is it basically works like in iOS

74
00:03:06,569 --> 00:03:08,180
development they've got the UI tableview

75
00:03:08,180 --> 00:03:11,010
essentially it'll display as many cells

76
00:03:11,010 --> 00:03:12,569
that needs to to fit the viewport and

77
00:03:12,569 --> 00:03:15,030
then only a few more either side and as

78
00:03:15,030 --> 00:03:16,940
you scroll it sort of reorders the cells

79
00:03:16,940 --> 00:03:19,349
and I'll show you an animation of that

80
00:03:19,349 --> 00:03:22,349
second mi own uses the flexbox order

81
00:03:22,349 --> 00:03:24,090
property so rather than using like

82
00:03:24,090 --> 00:03:26,419
transformed to or position up to loop to

83
00:03:26,419 --> 00:03:29,099
reposition an element or even ripping

84
00:03:29,099 --> 00:03:30,599
out of the dolmen replacing it down the

85
00:03:30,599 --> 00:03:32,849
bottom we can rely on the algorithm that

86
00:03:32,849 --> 00:03:35,639
flexbox has and this has had more

87
00:03:35,639 --> 00:03:37,380
benefits where I can have variable

88
00:03:37,380 --> 00:03:39,450
height cells so a lot of those a lot of

89
00:03:39,450 --> 00:03:41,010
the scrolling values you'll see that I

90
00:03:41,010 --> 00:03:43,169
always have a fixed fight and with the

91
00:03:43,169 --> 00:03:45,840
flexi-box order property you can you can

92
00:03:45,840 --> 00:03:49,340
do some really cool stuff this is a

93
00:03:49,340 --> 00:03:53,730
animated gif you can see I this is a

94
00:03:53,730 --> 00:03:55,319
chrome tracing so this is like a really

95
00:03:55,319 --> 00:03:57,930
low level tool but more importantly I

96
00:03:57,930 --> 00:03:58,799
just wanted to show like how the

97
00:03:58,799 --> 00:04:01,799
scrolling work so you can see up here as

98
00:04:01,799 --> 00:04:04,379
I scroll the cells move down bottom here

99
00:04:04,379 --> 00:04:06,239
it's kind of replacing and that's the

100
00:04:06,239 --> 00:04:08,040
flexbox order property being changed on

101
00:04:08,040 --> 00:04:09,329
those elements and so look this

102
00:04:09,329 --> 00:04:11,160
experience painting that's kind of like

103
00:04:11,160 --> 00:04:13,650
a 3d view so that's the scroll container

104
00:04:13,650 --> 00:04:15,540
and that's like the browser window you

105
00:04:15,540 --> 00:04:17,699
see it gives you like a frame-by-frame

106
00:04:17,699 --> 00:04:19,199
look at what's going on in the browser

107
00:04:19,199 --> 00:04:20,970
but it was a nice way to demonstrate

108
00:04:20,970 --> 00:04:23,849
what it's actually doing I wrote an

109
00:04:23,849 --> 00:04:25,530
article about this so you can check out

110
00:04:25,530 --> 00:04:27,450
my blog the CSS dinger if you want to

111
00:04:27,450 --> 00:04:32,700
have a look and there was a problem so

112
00:04:32,700 --> 00:04:35,450
let me actually show you a live demo of

113
00:04:35,450 --> 00:04:39,870
it here so you can see the the scrolling

114
00:04:39,870 --> 00:04:41,790
here I've got like a list item in here

115
00:04:41,790 --> 00:04:44,130
so this initially has 20 items but to

116
00:04:44,130 --> 00:04:46,110
just feel the viewport its renders 8

117
00:04:46,110 --> 00:04:48,390
list items and you can see I put the

118
00:04:48,390 --> 00:04:50,690
order property on there so as I scroll

119
00:04:50,690 --> 00:04:53,310
and see that adjusts and now that's down

120
00:04:53,310 --> 00:04:54,570
to bottom so it's going to disagree

121
00:04:54,570 --> 00:04:56,130
ordering as you go and just adds up

122
00:04:56,130 --> 00:04:57,300
adding to the top so you keep that

123
00:04:57,300 --> 00:04:58,980
scroll position so you can scroll

124
00:04:58,980 --> 00:05:02,100
through a lot of stuffs and it works

125
00:05:02,100 --> 00:05:08,610
pretty well so it doesn't sales and

126
00:05:08,610 --> 00:05:10,590
performance problem with it so as I

127
00:05:10,590 --> 00:05:11,790
showed you there it works pretty well it

128
00:05:11,790 --> 00:05:13,830
works fine and good example working at

129
00:05:13,830 --> 00:05:15,930
mobile and it works well so as you like

130
00:05:15,930 --> 00:05:17,610
normal as a user that goes through their

131
00:05:17,610 --> 00:05:19,320
Facebook feed or Twitter feed a sort of

132
00:05:19,320 --> 00:05:22,410
scroll at a steady pace but when you

133
00:05:22,410 --> 00:05:23,520
start to do high-velocity solar

134
00:05:23,520 --> 00:05:24,870
scrolling so you get to the bottom of

135
00:05:24,870 --> 00:05:25,740
the list and then you want to scroll

136
00:05:25,740 --> 00:05:27,990
really quickly the top and you build

137
00:05:27,990 --> 00:05:30,780
momentum of the scroll the screen starts

138
00:05:30,780 --> 00:05:32,700
like whiting up I see who they like it

139
00:05:32,700 --> 00:05:33,870
just goes blank and doesn't render

140
00:05:33,870 --> 00:05:37,890
anything and I didn't know why so I'll

141
00:05:37,890 --> 00:05:41,250
go back and I'll show you demo so if i

142
00:05:41,250 --> 00:05:44,400
drag the scroll bar you can see it's

143
00:05:44,400 --> 00:05:46,050
kind of just wiped out there and not

144
00:05:46,050 --> 00:05:47,160
sure why if i scroll a little bit

145
00:05:47,160 --> 00:05:49,440
suddenly repainting it and it's kind of

146
00:05:49,440 --> 00:05:52,020
confusing why that's happened there's

147
00:05:52,020 --> 00:05:53,730
like steady pace it's fine but then when

148
00:05:53,730 --> 00:05:55,350
you start like really getting some

149
00:05:55,350 --> 00:05:57,240
movement happening it sort of like

150
00:05:57,240 --> 00:06:00,270
renders what's that and something is

151
00:06:00,270 --> 00:06:06,630
going on and that's animated gifs of

152
00:06:06,630 --> 00:06:07,920
showing it so it's null scrolling and

153
00:06:07,920 --> 00:06:09,240
then just drag it you can see you like

154
00:06:09,240 --> 00:06:13,320
it just gets white with family so why is

155
00:06:13,320 --> 00:06:16,500
that so to understand why we need to

156
00:06:16,500 --> 00:06:18,960
sort of take a step back and understand

157
00:06:18,960 --> 00:06:21,180
the performance the cost of changing its

158
00:06:21,180 --> 00:06:24,180
CSS property there's a few things that

159
00:06:24,180 --> 00:06:25,530
happen and ending on what's this is

160
00:06:25,530 --> 00:06:26,730
probably you change different things

161
00:06:26,730 --> 00:06:28,890
happen really good website you should

162
00:06:28,890 --> 00:06:32,070
check out is CSS triggers calm so this

163
00:06:32,070 --> 00:06:33,900
is basically like a nice little search

164
00:06:33,900 --> 00:06:35,430
tool you can search recessive property

165
00:06:35,430 --> 00:06:37,740
and a layout and tell you like this it

166
00:06:37,740 --> 00:06:40,480
caused a paint that's caused a reflow

167
00:06:40,480 --> 00:06:44,130
or does it just cause a composite and

168
00:06:44,130 --> 00:06:45,940
looking up the order property

169
00:06:45,940 --> 00:06:47,740
essentially order when you have you

170
00:06:47,740 --> 00:06:49,540
change it update it it causes a reflow

171
00:06:49,540 --> 00:06:51,220
and a paint which is expensive in the

172
00:06:51,220 --> 00:06:53,740
browser and it if it needs to do a lot

173
00:06:53,740 --> 00:06:56,880
then then some things can happen

174
00:06:56,880 --> 00:06:59,050
essentially the only really safe

175
00:06:59,050 --> 00:07:00,580
properties you can do we are updating a

176
00:07:00,580 --> 00:07:04,230
lot transform so like scale rotate

177
00:07:04,230 --> 00:07:07,090
translate and a past Atia there are only

178
00:07:07,090 --> 00:07:09,310
really safe ones to do because what the

179
00:07:09,310 --> 00:07:11,200
browser does that composite it to the

180
00:07:11,200 --> 00:07:13,240
GPU and the GPU then handles that and

181
00:07:13,240 --> 00:07:14,830
there's no sort of reflow your paints

182
00:07:14,830 --> 00:07:16,890
happening and if you're translating

183
00:07:16,890 --> 00:07:19,230
elements using those two properties

184
00:07:19,230 --> 00:07:21,100
otherwise everything else is kind of

185
00:07:21,100 --> 00:07:23,800
detrimental and will will degrade

186
00:07:23,800 --> 00:07:27,580
performance and that is a screen grab

187
00:07:27,580 --> 00:07:29,200
from the CSS triggers so you can see

188
00:07:29,200 --> 00:07:32,080
like order on when it initializes and

189
00:07:32,080 --> 00:07:33,490
went to updates the causes the layout

190
00:07:33,490 --> 00:07:36,250
paint and composite and you kind of want

191
00:07:36,250 --> 00:07:37,420
to stick to just properties of do

192
00:07:37,420 --> 00:07:41,760
composites for a performance-based us

193
00:07:41,760 --> 00:07:43,540
another side of it is knowing your

194
00:07:43,540 --> 00:07:45,040
paints versus reflow so it's kind of

195
00:07:45,040 --> 00:07:46,920
rudimentary knowledge of the browser

196
00:07:46,920 --> 00:07:49,030
it's two different diets so a pain is

197
00:07:49,030 --> 00:07:50,650
like a non geometric change so that's

198
00:07:50,650 --> 00:07:52,240
when you change out the background color

199
00:07:52,240 --> 00:07:54,100
or the background image something it

200
00:07:54,100 --> 00:07:56,050
doesn't affect like the dimensions of

201
00:07:56,050 --> 00:07:58,420
the page a reflow the other side so when

202
00:07:58,420 --> 00:08:01,960
you affect the dimension so you change

203
00:08:01,960 --> 00:08:04,570
the font size you change a margin got a

204
00:08:04,570 --> 00:08:06,100
border etc anything that where the

205
00:08:06,100 --> 00:08:08,020
browser needs to recalculate little

206
00:08:08,020 --> 00:08:11,950
stuff is missing an example so encourage

207
00:08:11,950 --> 00:08:14,140
so toggling like visibility that's just

208
00:08:14,140 --> 00:08:16,330
the paint because it's not it's a non

209
00:08:16,330 --> 00:08:19,120
geometric change whereas totaling the

210
00:08:19,120 --> 00:08:20,860
font size will cause a paint in a reflow

211
00:08:20,860 --> 00:08:24,400
so it is the reflow to calculate where

212
00:08:24,400 --> 00:08:25,450
everything's position now because the

213
00:08:25,450 --> 00:08:27,340
font size increased and then it needs to

214
00:08:27,340 --> 00:08:30,400
paint it to the screen and then you can

215
00:08:30,400 --> 00:08:31,780
also have properties where you access

216
00:08:31,780 --> 00:08:33,760
where it forces the browser to do a

217
00:08:33,760 --> 00:08:35,500
reflow to the browser probably

218
00:08:35,500 --> 00:08:36,910
intelligent tries to queue up a lot of

219
00:08:36,910 --> 00:08:38,880
this stuff for you but there's certain

220
00:08:38,880 --> 00:08:41,200
bits are out has two black flush the

221
00:08:41,200 --> 00:08:43,330
queue and it has to like cause a reflow

222
00:08:43,330 --> 00:08:45,640
so one of those is like offset left so

223
00:08:45,640 --> 00:08:47,470
you have to get the correct dimension

224
00:08:47,470 --> 00:08:49,930
back otherwise the browser could be

225
00:08:49,930 --> 00:08:51,130
lying to you so they need to cause a

226
00:08:51,130 --> 00:08:53,650
tree slow so you kind of need casts all

227
00:08:53,650 --> 00:08:55,290
those property

228
00:08:55,290 --> 00:08:57,370
you can see here this is a screenshot

229
00:08:57,370 --> 00:08:59,440
from the chrome timeline dev tools and

230
00:08:59,440 --> 00:09:01,450
it kind of shows you what happened so

231
00:09:01,450 --> 00:09:03,340
like you do it you do a change that the

232
00:09:03,340 --> 00:09:04,750
function call happens it'll change to

233
00:09:04,750 --> 00:09:07,930
recalculate the styles and then any of

234
00:09:07,930 --> 00:09:09,640
the properties like wit pipe margin left

235
00:09:09,640 --> 00:09:12,160
and top can cause a layout any of the

236
00:09:12,160 --> 00:09:15,460
other properties in the green bar screen

237
00:09:15,460 --> 00:09:17,590
bar here can cause I box-shadow border

238
00:09:17,590 --> 00:09:20,080
radius those things that don't do a

239
00:09:20,080 --> 00:09:21,220
geometric change and you can see you

240
00:09:21,220 --> 00:09:23,020
lastly the composite layer which is like

241
00:09:23,020 --> 00:09:25,390
transform and opacity it's like handled

242
00:09:25,390 --> 00:09:30,040
by the GPU so that's really fast so one

243
00:09:30,040 --> 00:09:31,390
of the key things you should do is

244
00:09:31,390 --> 00:09:34,750
batting so you need to batch you read

245
00:09:34,750 --> 00:09:36,310
and write so you'll want to read write

246
00:09:36,310 --> 00:09:37,480
read write read by other words the

247
00:09:37,480 --> 00:09:38,890
browser needs to reflow repaint real

248
00:09:38,890 --> 00:09:40,420
slow the paint and you get that sort of

249
00:09:40,420 --> 00:09:42,840
junk that a lot of people talk about and

250
00:09:42,840 --> 00:09:45,940
that's it up so you want the only one

251
00:09:45,940 --> 00:09:47,650
layout and paint it happen once per tick

252
00:09:47,650 --> 00:09:50,710
so it's kind of like you will use

253
00:09:50,710 --> 00:09:52,240
something like requestanimationframe so

254
00:09:52,240 --> 00:09:54,880
that works that doesn't call back every

255
00:09:54,880 --> 00:09:57,420
time the screen refreshes so the average

256
00:09:57,420 --> 00:09:59,770
refresh rate my screen is like 60 Hertz

257
00:09:59,770 --> 00:10:01,630
nuts without 60 frames a second come

258
00:10:01,630 --> 00:10:03,400
from so I want to execute 60 times a

259
00:10:03,400 --> 00:10:06,580
second so that way you can like queue up

260
00:10:06,580 --> 00:10:07,930
a lot of stuff and have it happened fast

261
00:10:07,930 --> 00:10:09,700
and it won't like make your app seems

262
00:10:09,700 --> 00:10:11,770
slow because it's happening a lot but

263
00:10:11,770 --> 00:10:13,839
you'll get like this is what they call

264
00:10:13,839 --> 00:10:17,680
layout thrashing they're on a controller

265
00:10:17,680 --> 00:10:19,030
in minimize so the best way to do that

266
00:10:19,030 --> 00:10:21,970
is use a doll abstraction like because

267
00:10:21,970 --> 00:10:25,540
it's really easy to degrade performance

268
00:10:25,540 --> 00:10:27,339
you kind of need an abstraction on top

269
00:10:27,339 --> 00:10:30,280
it's really thinking about that kind of

270
00:10:30,280 --> 00:10:31,390
paved the way in that thinking with

271
00:10:31,390 --> 00:10:33,850
their virtual Dom and kind of their

272
00:10:33,850 --> 00:10:35,650
representation of the Dom that you write

273
00:10:35,650 --> 00:10:37,690
and they sort of angle writing to it so

274
00:10:37,690 --> 00:10:40,420
it's pretty good amber has HTML bars

275
00:10:40,420 --> 00:10:43,290
which is like a lot of similar thinking

276
00:10:43,290 --> 00:10:45,910
to react so they're kind of doing a lot

277
00:10:45,910 --> 00:10:46,990
of performance stuff there and their

278
00:10:46,990 --> 00:10:50,700
latest release and if you don't use a

279
00:10:50,700 --> 00:10:53,710
application sort of framework there's a

280
00:10:53,710 --> 00:10:55,870
library called fast on which hooks into

281
00:10:55,870 --> 00:10:57,580
like requestanimationframe so all your

282
00:10:57,580 --> 00:10:59,050
reads and writes is Dom you do through

283
00:10:59,050 --> 00:11:00,850
this library and that will bat it up and

284
00:11:00,850 --> 00:11:03,330
do it in a performant way for you and

285
00:11:03,330 --> 00:11:05,560
you can't opt into a framework it's

286
00:11:05,560 --> 00:11:07,680
pretty good one

287
00:11:07,680 --> 00:11:12,530
so how do we measure you I performance

288
00:11:12,540 --> 00:11:14,950
recently so for a long time will Dailey

289
00:11:14,950 --> 00:11:16,690
really chrome that offered the ability

290
00:11:16,690 --> 00:11:20,200
to do that but now like I Elevens firing

291
00:11:20,200 --> 00:11:21,880
Firefox will have really great support

292
00:11:21,880 --> 00:11:24,339
to extract in performance seeing what

293
00:11:24,339 --> 00:11:26,350
Spain what's reflow and kind of giving

294
00:11:26,350 --> 00:11:29,410
you like a frame rate and they all offer

295
00:11:29,410 --> 00:11:31,779
a timeline I just checked out I Elevens

296
00:11:31,779 --> 00:11:34,240
tools and they're like really really

297
00:11:34,240 --> 00:11:36,100
good they're up there with chrome for

298
00:11:36,100 --> 00:11:38,200
getting performance information addict

299
00:11:38,200 --> 00:11:40,570
like your website they give it a really

300
00:11:40,570 --> 00:11:43,930
nice interface for it so let's let's go

301
00:11:43,930 --> 00:11:45,700
back to that issue of the scroll this

302
00:11:45,700 --> 00:11:49,060
view was waitting out and we can sort of

303
00:11:49,060 --> 00:11:52,209
discover what's going on so first thing

304
00:11:52,209 --> 00:11:55,089
we'll do is a timeline in chrome and

305
00:11:55,089 --> 00:11:57,040
this will like I showed no other

306
00:11:57,040 --> 00:11:58,060
screenshot i'll show you like the

307
00:11:58,060 --> 00:11:59,529
reflows paints and will give you like a

308
00:11:59,529 --> 00:12:03,430
frame rate but when we do that and I'll

309
00:12:03,430 --> 00:12:05,709
share a screenshot of a profile i took

310
00:12:05,709 --> 00:12:07,720
it doesn't eliminate why the way that is

311
00:12:07,720 --> 00:12:09,579
happening so as far as the timeline is

312
00:12:09,579 --> 00:12:10,510
concerned it looks like it's really

313
00:12:10,510 --> 00:12:12,010
performant it's not doing much the

314
00:12:12,010 --> 00:12:14,500
browsers like handily okay but it

315
00:12:14,500 --> 00:12:16,959
doesn't make it clear why suddenly

316
00:12:16,959 --> 00:12:19,170
everything is disappearing off the page

317
00:12:19,170 --> 00:12:22,060
so it doesn't it doesn't help and that's

318
00:12:22,060 --> 00:12:23,350
the same for all the browsers they're

319
00:12:23,350 --> 00:12:25,269
kind of say it's ticking on 60 frames a

320
00:12:25,269 --> 00:12:29,019
second and everything according to the

321
00:12:29,019 --> 00:12:30,550
timeline is fine but it's still you can

322
00:12:30,550 --> 00:12:32,290
see it's not fine because it's not

323
00:12:32,290 --> 00:12:36,160
displaying the data so that's a timeline

324
00:12:36,160 --> 00:12:37,449
i did of the scrolling thing you can see

325
00:12:37,449 --> 00:12:40,300
it's it's below the 60 frames a second

326
00:12:40,300 --> 00:12:41,649
which is up here so you want to be below

327
00:12:41,649 --> 00:12:43,480
this line so that's ticking along and

328
00:12:43,480 --> 00:12:44,529
then you can see sort of the bars

329
00:12:44,529 --> 00:12:45,940
happening there it's like doing some

330
00:12:45,940 --> 00:12:47,529
paints and composites and they're really

331
00:12:47,529 --> 00:12:49,470
small and it happening with the past and

332
00:12:49,470 --> 00:12:51,730
better still problem so it doesn't

333
00:12:51,730 --> 00:12:56,709
doesn't always help this is where Safari

334
00:12:56,709 --> 00:12:58,600
sort of has some really hidden tools for

335
00:12:58,600 --> 00:13:01,000
a long time this feature called show

336
00:13:01,000 --> 00:13:03,430
compositing borders was hidden behind a

337
00:13:03,430 --> 00:13:05,890
flag you had launched safari in the

338
00:13:05,890 --> 00:13:07,360
command line to get it happening but now

339
00:13:07,360 --> 00:13:09,730
they've exposed it in a debug menu and

340
00:13:09,730 --> 00:13:12,910
I'll show that in a second and show that

341
00:13:12,910 --> 00:13:15,759
Nia

342
00:13:15,769 --> 00:13:27,280
refresh that

343
00:13:27,290 --> 00:13:32,780
one second

344
00:13:32,790 --> 00:13:47,310
so

345
00:13:47,320 --> 00:13:50,800
what

346
00:13:50,810 --> 00:13:54,540
so to show this this you can see it's

347
00:13:54,540 --> 00:13:58,050
got these borders and essentially these

348
00:13:58,050 --> 00:14:00,509
are like the the textures that upload to

349
00:14:00,509 --> 00:14:02,279
the GPU it finally gives you some

350
00:14:02,279 --> 00:14:04,620
numbers here so you can expose that by

351
00:14:04,620 --> 00:14:07,980
going to debug draw compositing flags

352
00:14:07,980 --> 00:14:09,810
and then down here show so it's kind of

353
00:14:09,810 --> 00:14:12,240
hidden behind these these menu options

354
00:14:12,240 --> 00:14:13,620
but you can get to but what actually

355
00:14:13,620 --> 00:14:16,290
illuminates is as I scroll you can see

356
00:14:16,290 --> 00:14:19,920
that number is increasing a lot what

357
00:14:19,920 --> 00:14:21,420
that means is that's uploading a texture

358
00:14:21,420 --> 00:14:23,310
to the GPU but every time and it's

359
00:14:23,310 --> 00:14:25,110
happening a lot because we are paying

360
00:14:25,110 --> 00:14:27,300
order property so like I start to scroll

361
00:14:27,300 --> 00:14:30,420
that really fast you get the wire

362
00:14:30,420 --> 00:14:31,889
happening and you see like the number of

363
00:14:31,889 --> 00:14:35,130
creases exponentially and that's that's

364
00:14:35,130 --> 00:14:38,910
kind of like what what is happening in

365
00:14:38,910 --> 00:14:40,829
the browser so Straits of textures are

366
00:14:40,829 --> 00:14:42,990
being sent to the GPU and that number

367
00:14:42,990 --> 00:14:45,180
should be small so if that's big then

368
00:14:45,180 --> 00:14:46,440
you've got a you've got an issue where

369
00:14:46,440 --> 00:14:48,949
like the GPU is getting overloaded

370
00:14:48,949 --> 00:14:51,259
things here I took a screenshot here

371
00:14:51,259 --> 00:14:53,190
essentially what we're doing is we're

372
00:14:53,190 --> 00:14:55,260
flooding the GPU so kind of and good

373
00:14:55,260 --> 00:14:57,360
analogy is like a big sports game and a

374
00:14:57,360 --> 00:14:59,490
stadiums finished and all the crowd is

375
00:14:59,490 --> 00:15:00,810
coming out to the door kind of a really

376
00:15:00,810 --> 00:15:02,790
slows down so you're trying to upload

377
00:15:02,790 --> 00:15:04,589
way too many textures to the jeep you

378
00:15:04,589 --> 00:15:06,750
and I just can't handle it or just just

379
00:15:06,750 --> 00:15:08,250
wiped out and it just like stopped

380
00:15:08,250 --> 00:15:09,720
rendering in fact keep up because you're

381
00:15:09,720 --> 00:15:13,350
doing too much for it to handle and just

382
00:15:13,350 --> 00:15:14,699
you know you're technically overloading

383
00:15:14,699 --> 00:15:17,370
the GPU bus with too many textures for

384
00:15:17,370 --> 00:15:19,529
it to handle properly to be able to

385
00:15:19,529 --> 00:15:22,649
painter the screen in the browser and

386
00:15:22,649 --> 00:15:24,930
that's the Atari ever answer to the

387
00:15:24,930 --> 00:15:27,060
white out so it's kind of get a bit of a

388
00:15:27,060 --> 00:15:30,720
journey the tools a bit immature to get

389
00:15:30,720 --> 00:15:32,190
to it and they're kind of hidden behind

390
00:15:32,190 --> 00:15:34,709
probably some confusing names but once

391
00:15:34,709 --> 00:15:35,730
you start to learn it they make a lot

392
00:15:35,730 --> 00:15:37,500
more sense there's a good article about

393
00:15:37,500 --> 00:15:40,319
this very subject of using that to debug

394
00:15:40,319 --> 00:15:46,470
performance and Safari and basically the

395
00:15:46,470 --> 00:15:47,759
conclusion we come to is the order

396
00:15:47,759 --> 00:15:50,009
property isn't performant option when

397
00:15:50,009 --> 00:15:51,389
you want to do high velocity scrolling

398
00:15:51,389 --> 00:15:52,949
like it has a lot of other benefits but

399
00:15:52,949 --> 00:15:55,139
when it comes to like writing out that's

400
00:15:55,139 --> 00:15:57,000
kind of like a no-go so it's kind of

401
00:15:57,000 --> 00:15:59,399
like you have to avoid it but offers so

402
00:15:59,399 --> 00:16:02,340
much which is unfortunate

403
00:16:02,340 --> 00:16:04,630
so it's not easy like the dev tools are

404
00:16:04,630 --> 00:16:07,210
still immature whether they where they

405
00:16:07,210 --> 00:16:09,460
do Excel is you know inspecting and

406
00:16:09,460 --> 00:16:12,880
looking CSS JavaScript profiling but in

407
00:16:12,880 --> 00:16:14,290
a lot of like the UI performance stuff

408
00:16:14,290 --> 00:16:16,630
the stool likes and some blank areas

409
00:16:16,630 --> 00:16:18,400
where they don't cover it work where you

410
00:16:18,400 --> 00:16:19,990
kind of get stuck is only because Safari

411
00:16:19,990 --> 00:16:22,000
expose that that I was able to discover

412
00:16:22,000 --> 00:16:23,100
what was actually happening and

413
00:16:23,100 --> 00:16:25,150
otherwise I'd just be I wouldn't know

414
00:16:25,150 --> 00:16:28,110
what what was going on and

415
00:16:28,110 --> 00:16:30,700
high-performance user interfaces are

416
00:16:30,700 --> 00:16:33,760
really hard on the web especially

417
00:16:33,760 --> 00:16:35,470
because it's so easy to degrade but you

418
00:16:35,470 --> 00:16:36,850
can do simple things like just change

419
00:16:36,850 --> 00:16:39,160
the CSS property and then suddenly like

420
00:16:39,160 --> 00:16:41,770
everything comes crashing down but it's

421
00:16:41,770 --> 00:16:46,480
not impossible so like I said before if

422
00:16:46,480 --> 00:16:48,190
you want to do native like performance

423
00:16:48,190 --> 00:16:50,320
really fast and you kind of need to use

424
00:16:50,320 --> 00:16:51,880
an abstraction where they're really

425
00:16:51,880 --> 00:16:53,770
thinking about this for you and you kind

426
00:16:53,770 --> 00:16:56,440
of just define your application and a

427
00:16:56,440 --> 00:16:58,000
really good one that I've seen lately is

428
00:16:58,000 --> 00:17:01,180
called famous the kind of stews all

429
00:17:01,180 --> 00:17:02,920
these ideas into soft instruction where

430
00:17:02,920 --> 00:17:06,520
they really think about performance and

431
00:17:06,520 --> 00:17:07,329
you should have described your

432
00:17:07,329 --> 00:17:09,430
application in JavaScript and it sort of

433
00:17:09,430 --> 00:17:12,030
handles the rendering to the Dom for you

434
00:17:12,030 --> 00:17:14,170
and now you so they use a number of

435
00:17:14,170 --> 00:17:16,690
strategies so they use a flat Dom so the

436
00:17:16,690 --> 00:17:18,550
Dom structure is really like flat so

437
00:17:18,550 --> 00:17:20,380
it's easy for the style recalculation to

438
00:17:20,380 --> 00:17:21,820
happen so the more complex the Dom you

439
00:17:21,820 --> 00:17:23,650
have the more work to grouse has to do

440
00:17:23,650 --> 00:17:25,390
when it needs to recalculate installs it

441
00:17:25,390 --> 00:17:28,060
means to traverse all the notes in your

442
00:17:28,060 --> 00:17:30,850
document they use your first animation

443
00:17:30,850 --> 00:17:34,090
frame to do it 60 times a second they

444
00:17:34,090 --> 00:17:35,170
make sure everything's put on for the

445
00:17:35,170 --> 00:17:37,210
GPU so they use the matrix Freddy

446
00:17:37,210 --> 00:17:39,340
transform and also have it built in

447
00:17:39,340 --> 00:17:40,660
physics engine so you can get that nice

448
00:17:40,660 --> 00:17:43,510
stuff so that where I was dragging my

449
00:17:43,510 --> 00:17:44,920
head around before that was using the

450
00:17:44,920 --> 00:17:46,330
famous same thing you like the sort of

451
00:17:46,330 --> 00:17:49,420
spring physics happening it's really

452
00:17:49,420 --> 00:17:53,110
quite good the other benefit is too is

453
00:17:53,110 --> 00:17:55,000
because you described in a in their

454
00:17:55,000 --> 00:17:57,960
framework you can render it to other

455
00:17:57,960 --> 00:18:00,490
endpoint so you can range the Dom you

456
00:18:00,490 --> 00:18:02,860
can do SVG and they even have WebGL so

457
00:18:02,860 --> 00:18:05,230
that sort of Brewster performance again

458
00:18:05,230 --> 00:18:08,170
and you can start to do more cool

459
00:18:08,170 --> 00:18:10,150
animations with in reggio that's all

460
00:18:10,150 --> 00:18:11,650
possible in the doll so you can do like

461
00:18:11,650 --> 00:18:15,310
cloth based off

462
00:18:15,320 --> 00:18:18,990
so before it is fragile it's very easy

463
00:18:18,990 --> 00:18:21,360
of us said many times to degrade

464
00:18:21,360 --> 00:18:23,850
performance now you really need to put

465
00:18:23,850 --> 00:18:27,090
an abstraction in front hand rolling

466
00:18:27,090 --> 00:18:29,610
always end in tears so if you're working

467
00:18:29,610 --> 00:18:31,200
by itself maybe that will work for you

468
00:18:31,200 --> 00:18:33,960
but if you're in a team really trying to

469
00:18:33,960 --> 00:18:36,000
like not degrade performance is really

470
00:18:36,000 --> 00:18:37,140
hard when you're working with many

471
00:18:37,140 --> 00:18:40,020
people and basically the dollars of West

472
00:18:40,020 --> 00:18:42,179
it's a worse for performance is not was

473
00:18:42,179 --> 00:18:43,650
never intended to do like the sort of

474
00:18:43,650 --> 00:18:44,820
application level stuff that we're doing

475
00:18:44,820 --> 00:18:46,200
now but that's what we've got to work

476
00:18:46,200 --> 00:18:50,270
with though we have to work with it and

477
00:18:50,270 --> 00:18:52,620
what we really need is the web platforms

478
00:18:52,620 --> 00:18:54,330
kind of needs is low level control so

479
00:18:54,330 --> 00:18:55,890
people who really want to extract the

480
00:18:55,890 --> 00:18:57,630
most performance out of their web apps

481
00:18:57,630 --> 00:18:59,520
they really kind of need to trust from

482
00:18:59,520 --> 00:19:01,050
the browser that then they know what

483
00:19:01,050 --> 00:19:03,240
they're doing so there's a few things

484
00:19:03,240 --> 00:19:04,679
where you could control you could

485
00:19:04,679 --> 00:19:06,960
isolate something on the page to know to

486
00:19:06,960 --> 00:19:09,030
say I know when it needs to paint and

487
00:19:09,030 --> 00:19:12,300
when it needs to reflow but that's sort

488
00:19:12,300 --> 00:19:14,340
of not available there's there's some

489
00:19:14,340 --> 00:19:16,050
specifications like there's a CSS

490
00:19:16,050 --> 00:19:17,850
containment specification which you can

491
00:19:17,850 --> 00:19:21,240
isolate some stuff to do that but that's

492
00:19:21,240 --> 00:19:23,640
all early days and just just a it's not

493
00:19:23,640 --> 00:19:26,850
even in any browsers so yeah isolate

494
00:19:26,850 --> 00:19:29,910
opponents pretty much we need the

495
00:19:29,910 --> 00:19:31,559
functionality of an iframe but without

496
00:19:31,559 --> 00:19:34,830
the baggage so I frame has obviously has

497
00:19:34,830 --> 00:19:36,809
a lot of baggage around it we kind of

498
00:19:36,809 --> 00:19:40,170
need the benefits of that but in a nicer

499
00:19:40,170 --> 00:19:43,559
way so we can do we can start getting so

500
00:19:43,559 --> 00:19:46,220
extracting really good performance

501
00:19:46,220 --> 00:19:52,740
that's it thanks you're living with

502
00:19:52,740 --> 00:19:56,280
ember it's in this man ah yeah yep do

503
00:19:56,280 --> 00:19:57,990
you have issues with repo'ing we've got

504
00:19:57,990 --> 00:20:00,690
a bunch of them having issues with

505
00:20:00,690 --> 00:20:03,360
things don't have the right time or seem

506
00:20:03,360 --> 00:20:06,960
a bit slow are you doing Oh

507
00:20:06,960 --> 00:20:08,760
optimizations or is it just changes to

508
00:20:08,760 --> 00:20:10,350
imitate it going through going to sleep

509
00:20:10,350 --> 00:20:13,470
set up so I don't work with that day

510
00:20:13,470 --> 00:20:16,050
today but I think HTML bars kind of like

511
00:20:16,050 --> 00:20:18,240
fixes a lot of the problems that the the

512
00:20:18,240 --> 00:20:19,410
other templating engine they used

513
00:20:19,410 --> 00:20:22,050
previously and they're kind of taking

514
00:20:22,050 --> 00:20:26,700
some cues from react

515
00:20:26,710 --> 00:20:31,600
hi great talk with all the amazing

516
00:20:31,600 --> 00:20:33,070
performance that you've shown do you

517
00:20:33,070 --> 00:20:33,940
think there's reason to be optimistic

518
00:20:33,940 --> 00:20:37,029
enough to think that web applications

519
00:20:37,029 --> 00:20:38,230
will at some point become better than

520
00:20:38,230 --> 00:20:42,940
meet us in terms of performance yeah I'm

521
00:20:42,940 --> 00:20:44,710
pretty optimistic about it I think I

522
00:20:44,710 --> 00:20:47,830
think the it's capable they're like

523
00:20:47,830 --> 00:20:49,270
there's a lot of work being done in

524
00:20:49,270 --> 00:20:50,980
discovering performance issues as well

525
00:20:50,980 --> 00:20:53,940
as like helping increase performance so

526
00:20:53,940 --> 00:20:57,909
a lot of like the frameworks are kind of

527
00:20:57,909 --> 00:21:00,190
like fixing that for us by retracting us

528
00:21:00,190 --> 00:21:02,020
away from that like fine-tuning their

529
00:21:02,020 --> 00:21:05,049
they're working on the fine-tuning as to

530
00:21:05,049 --> 00:21:07,570
whether we ever get like native maybe

531
00:21:07,570 --> 00:21:10,299
we'll be close you know mozillas doing a

532
00:21:10,299 --> 00:21:11,860
lot of work with their as I'm jeaious

533
00:21:11,860 --> 00:21:14,409
for high-performing games in the browser

534
00:21:14,409 --> 00:21:16,899
and Java scripts getting faster and

535
00:21:16,899 --> 00:21:20,799
faster all the time and the nailing so

536
00:21:20,799 --> 00:21:22,630
though I'm pretty hopeful that the web

537
00:21:22,630 --> 00:21:26,320
will be like the the one true place I

538
00:21:26,320 --> 00:21:31,029
hope hi I'm that was an awesome talk can

539
00:21:31,029 --> 00:21:32,470
you you mentioned a little bit about how

540
00:21:32,470 --> 00:21:34,929
the Safari dev tools that you that you

541
00:21:34,929 --> 00:21:36,070
see repaints but then there's stuff in

542
00:21:36,070 --> 00:21:37,419
the chrome devtools jump like a

543
00:21:37,419 --> 00:21:39,130
suggestion of your preferred workflow of

544
00:21:39,130 --> 00:21:40,809
like we're developing in chrome and

545
00:21:40,809 --> 00:21:44,679
safari or so yeah I tend to mix between

546
00:21:44,679 --> 00:21:47,799
firefox and chrome like Rome because

547
00:21:47,799 --> 00:21:50,200
Derek on the first ones to surface that

548
00:21:50,200 --> 00:21:52,450
sort of timeline user interface

549
00:21:52,450 --> 00:21:55,090
performance stuff and I've only just

550
00:21:55,090 --> 00:21:56,649
been recently looking into Safari

551
00:21:56,649 --> 00:21:58,059
because they've got some extra stuff

552
00:21:58,059 --> 00:22:00,370
that other browsers don't that's really

553
00:22:00,370 --> 00:22:02,110
focused on like seeing what's happening

554
00:22:02,110 --> 00:22:03,700
with the GPU like when you're doing like

555
00:22:03,700 --> 00:22:08,140
transform stuff there yeah so I mostly

556
00:22:08,140 --> 00:22:09,700
work in chrome with my looks like i

557
00:22:09,700 --> 00:22:11,380
don't really i kind of just jump around

558
00:22:11,380 --> 00:22:12,700
browsers depending on what i need to

559
00:22:12,700 --> 00:22:15,159
discover it have been kind of nice to

560
00:22:15,159 --> 00:22:16,740
have like a unified to the devtools

