1
00:00:08,600 --> 00:00:11,520

thank you so the title of the talk is

2
00:00:11,520 --> 00:00:13,800
kick-ass code editing and enter of

3
00:00:13,800 --> 00:00:15,510
end-to-end JavaScript debugging

4
00:00:15,510 --> 00:00:18,540
my name is five any are cops if you want

5
00:00:18,540 --> 00:00:22,529
you can follow me on Twitter and let's

6
00:00:22,529 --> 00:00:27,570
get started so we say code editing and

7
00:00:27,570 --> 00:00:32,279
debugging why do we do this yeah we are

8
00:00:32,279 --> 00:00:36,270
building an IDE we building an IDE for

9
00:00:36,270 --> 00:00:40,800
the web and we called the baby

10
00:00:40,800 --> 00:00:44,250
cloud9 IDE and what I'm going to do now

11
00:00:44,250 --> 00:00:47,519
is are today is present the vision of

12
00:00:47,519 --> 00:00:51,989
cloud9 IDE but even more I described

13
00:00:51,989 --> 00:00:54,120
some of the technical details in

14
00:00:54,120 --> 00:00:55,859
building this because there is a tech

15
00:00:55,859 --> 00:00:57,359
conference this is not a product

16
00:00:57,359 --> 00:01:00,510
conference you can follow a cloud or de

17
00:01:00,510 --> 00:01:07,890
on cloud9 IDE alright so the overview

18
00:01:07,890 --> 00:01:10,800
for this talk will be the code editor we

19
00:01:10,800 --> 00:01:12,930
use for the IDE so technical details of

20
00:01:12,930 --> 00:01:17,190
the code editor what how plugins work

21
00:01:17,190 --> 00:01:21,330
and a showcase of how how we can debug

22
00:01:21,330 --> 00:01:25,230
code in the cloud so let me to get

23
00:01:25,230 --> 00:01:28,680
started let me give you a small demo how

24
00:01:28,680 --> 00:01:37,020
this looks like ok so this is the IDE

25
00:01:37,020 --> 00:01:41,100
just looks very familiar and one of the

26
00:01:41,100 --> 00:01:43,530
basic things you should be able to do

27
00:01:43,530 --> 00:01:48,990
with our ideas create files like so

28
00:01:48,990 --> 00:01:51,990
let's create a hello world is and the

29
00:01:51,990 --> 00:01:53,370
other thing is you should be able to

30
00:01:53,370 --> 00:02:01,060
edit files

31
00:02:01,070 --> 00:02:06,750
okay it's all nice but just having files

32
00:02:06,750 --> 00:02:08,880
on the server doesn't help you sir let's

33
00:02:08,880 --> 00:02:11,970
run this beast and you see well it's

34
00:02:11,970 --> 00:02:13,590
printing something in the console but

35
00:02:13,590 --> 00:02:15,630
where does it actually run so this could

36
00:02:15,630 --> 00:02:18,000
could be run in the browser but it's

37
00:02:18,000 --> 00:02:20,670
actually run a run on the server in a

38
00:02:20,670 --> 00:02:22,740
node instance and I can prove it to you

39
00:02:22,740 --> 00:02:25,380
by changing this to the hello world

40
00:02:25,380 --> 00:02:27,270
version of node does anyone know about

41
00:02:27,270 --> 00:02:30,540
the hello world version of notice right

42
00:02:30,540 --> 00:02:39,420
HTTP so that's required GDP create

43
00:02:39,420 --> 00:02:44,820
server and this one takes a callback

44
00:02:44,820 --> 00:02:52,210
with a request and a response object

45
00:02:52,220 --> 00:03:02,340
alright and then rewrite success so we

46
00:03:02,340 --> 00:03:12,020
can do this and

47
00:03:12,030 --> 00:03:15,640
and clothes the response of course we

48
00:03:15,640 --> 00:03:24,310
have to listen excuse me

49
00:03:24,310 --> 00:03:33,880
oh yes and yes yes and so we see what's

50
00:03:33,880 --> 00:03:46,180
doing we say HTTP all right save the

51
00:03:46,180 --> 00:04:04,120
Beast and I don't see something oh okay

52
00:04:04,120 --> 00:04:16,340
let's kill it oh I guess I've just

53
00:04:16,350 --> 00:04:17,609
hooray

54
00:04:17,609 --> 00:04:21,310
here we go Wow looking we run it on the

55
00:04:21,310 --> 00:04:23,530
server so it actually runs a node

56
00:04:23,530 --> 00:04:25,990
instance on the server we can edit it

57
00:04:25,990 --> 00:04:27,490
from here we can start it from here and

58
00:04:27,490 --> 00:04:30,540
we can stop it from here so that's the

59
00:04:30,540 --> 00:04:33,550
basic overview how the IDE is going to

60
00:04:33,550 --> 00:04:33,820
work

61
00:04:33,820 --> 00:04:35,710
of course I've used absolute as you've

62
00:04:35,710 --> 00:04:38,110
seen this is still a tech preview this

63
00:04:38,110 --> 00:04:40,750
is far from being a complete product but

64
00:04:40,750 --> 00:04:42,430
nonetheless we just want to get out

65
00:04:42,430 --> 00:04:44,919
early and show what we what we think

66
00:04:44,919 --> 00:04:47,229
could be the next step in in writing

67
00:04:47,229 --> 00:04:54,100
code in the cloud so yeah so nobody

68
00:04:54,100 --> 00:04:56,470
really will use an IDE of the editor

69
00:04:56,470 --> 00:04:59,680
sucks so everyone has his editor with VI

70
00:04:59,680 --> 00:05:02,470
emails texts made maybe eclipse on

71
00:05:02,470 --> 00:05:06,400
NetBeans and one one of the key parts of

72
00:05:06,400 --> 00:05:10,990
the IDE is an editor that actually works

73
00:05:10,990 --> 00:05:15,280
my aim for the editor was that it should

74
00:05:15,280 --> 00:05:18,280
at least replace text made for me so all

75
00:05:18,280 --> 00:05:19,750
the features I love from text made

76
00:05:19,750 --> 00:05:23,140
should eventually be available in the in

77
00:05:23,140 --> 00:05:27,700
the code editor are the same for for

78
00:05:27,700 --> 00:05:29,169
some of the Eclipse features that I

79
00:05:29,169 --> 00:05:32,110
really like so what are the requirements

80
00:05:32,110 --> 00:05:34,060
for for code editor

81
00:05:34,060 --> 00:05:35,380
well first of all it should be cross

82
00:05:35,380 --> 00:05:37,110
browser

83
00:05:37,110 --> 00:05:39,190
shouldn't should not be a big

84
00:05:39,190 --> 00:05:41,410
restriction on which for us it runs so

85
00:05:41,410 --> 00:05:44,740
including ie7 i8 should be fully

86
00:05:44,740 --> 00:05:46,540
featured sheriff all the features we

87
00:05:46,540 --> 00:05:48,940
need should be configurable that like

88
00:05:48,940 --> 00:05:51,790
users won't want to show the hidden

89
00:05:51,790 --> 00:05:53,770
hidden characters like spaces and tabs

90
00:05:53,770 --> 00:05:56,200
or don't want to see them and all kinds

91
00:05:56,200 --> 00:05:57,730
of stuff that should be able to be

92
00:05:57,730 --> 00:05:59,710
configured by the user should be

93
00:05:59,710 --> 00:06:03,280
scalable it shouldn't break down on

94
00:06:03,280 --> 00:06:05,950
really large files like their their

95
00:06:05,950 --> 00:06:08,050
files that are like 10,000 lines long

96
00:06:08,050 --> 00:06:10,930
and should just be able to handle it and

97
00:06:10,930 --> 00:06:13,390
should be hackable that means if someone

98
00:06:13,390 --> 00:06:15,340
wants to to add a functionality that's

99
00:06:15,340 --> 00:06:18,040
not there any seasoned JavaScript check

100
00:06:18,040 --> 00:06:21,010
I should be able to just implement it so

101
00:06:21,010 --> 00:06:24,250
why not Best Buy that's obvious almost

102
00:06:24,250 --> 00:06:27,190
all of this is already implement our

103
00:06:27,190 --> 00:06:31,360
best thing sorry skywriter stick to best

104
00:06:31,360 --> 00:06:35,320
but you think best man has a really

105
00:06:35,320 --> 00:06:36,850
excellent has done a really excellent

106
00:06:36,850 --> 00:06:41,260
job - - pioneering in this area to show

107
00:06:41,260 --> 00:06:43,510
that it's actually possible to to do

108
00:06:43,510 --> 00:06:45,430
advanced text editing or code editing in

109
00:06:45,430 --> 00:06:47,580
the browser or there are some things

110
00:06:47,580 --> 00:06:51,400
that didn't fit for our things one is

111
00:06:51,400 --> 00:06:53,740
that's inefficient if it's scaled to

112
00:06:53,740 --> 00:06:57,280
really big canvas because it has to do

113
00:06:57,280 --> 00:06:59,170
to draw all the pieces individually

114
00:06:59,170 --> 00:07:02,490
that's like what Paul Bako said for the

115
00:07:02,490 --> 00:07:05,680
phones game engine it's similar to to

116
00:07:05,680 --> 00:07:08,530
the code editor it's not cross browser

117
00:07:08,530 --> 00:07:10,960
because it's using canvas obviously so

118
00:07:10,960 --> 00:07:16,300
no ie ie 708 is 6 if you want to but I

119
00:07:16,300 --> 00:07:19,600
don't really care and when we started

120
00:07:19,600 --> 00:07:21,340
had a big dependency on spot colors like

121
00:07:21,340 --> 00:07:24,160
500k external dependency on an on

122
00:07:24,160 --> 00:07:26,500
library we don't use on ourself so in

123
00:07:26,500 --> 00:07:28,690
today's jquery which is a lot better in

124
00:07:28,690 --> 00:07:31,000
terms of code size but still something

125
00:07:31,000 --> 00:07:36,760
we don't need for the ide so so that's

126
00:07:36,760 --> 00:07:38,710
why we didn't use best friend so we

127
00:07:38,710 --> 00:07:40,990
choose to you to implement our own code

128
00:07:40,990 --> 00:07:43,960
editor so there are several options you

129
00:07:43,960 --> 00:07:45,990
can you can take and in doing this you

130
00:07:45,990 --> 00:07:49,280
can have content editable you can

131
00:07:49,280 --> 00:07:50,930
using canvas as best benders or you can

132
00:07:50,930 --> 00:07:52,970
use pure Dom methods to render

133
00:07:52,970 --> 00:07:56,450
everything that's a quick look at it so

134
00:07:56,450 --> 00:08:00,290
content editable well it doesn't really

135
00:08:00,290 --> 00:08:02,210
give you enough control to do advanced

136
00:08:02,210 --> 00:08:05,720
stuff it has a lot of issues to get

137
00:08:05,720 --> 00:08:07,880
right cross browser and we really want

138
00:08:07,880 --> 00:08:10,490
you to do like fancy stuff with a

139
00:08:10,490 --> 00:08:12,590
selection we want to support in the

140
00:08:12,590 --> 00:08:14,780
future like rectangular selections like

141
00:08:14,780 --> 00:08:16,669
text meters and there's no way you can

142
00:08:16,669 --> 00:08:18,380
do this with content edit editable and

143
00:08:18,380 --> 00:08:20,240
current editable was really designed to

144
00:08:20,240 --> 00:08:22,520
do weeks rich text editing which we

145
00:08:22,520 --> 00:08:25,040
don't really need so it's not worth it

146
00:08:25,040 --> 00:08:28,580
exploring it for for code editing well

147
00:08:28,580 --> 00:08:30,740
of course there's canvas canvas is nice

148
00:08:30,740 --> 00:08:33,140
because you have full control about what

149
00:08:33,140 --> 00:08:35,930
you want to display so you can can do

150
00:08:35,930 --> 00:08:38,719
anything but seriously for code editor I

151
00:08:38,719 --> 00:08:41,419
don't care if I can do fancy stuff I

152
00:08:41,419 --> 00:08:43,760
just need some some rectangles and lines

153
00:08:43,760 --> 00:08:45,650
and text so I don't really need all of

154
00:08:45,650 --> 00:08:48,860
this and it also means that you you

155
00:08:48,860 --> 00:08:52,839
cannot run it on all current ie versions

156
00:08:52,839 --> 00:08:56,089
excluding the but except the ie9 beta

157
00:08:56,089 --> 00:09:00,080
but that's not all yet another point is

158
00:09:00,080 --> 00:09:01,970
if you use canvas you have to implement

159
00:09:01,970 --> 00:09:03,740
all the key and mouse interaction

160
00:09:03,740 --> 00:09:06,200
yourself because there's nothing you can

161
00:09:06,200 --> 00:09:08,900
you can use leverage but that's not

162
00:09:08,900 --> 00:09:10,370
actually a bad thing because it means

163
00:09:10,370 --> 00:09:13,190
you can do you have full control over

164
00:09:13,190 --> 00:09:16,730
everything what happens I know my very

165
00:09:16,730 --> 00:09:19,310
unscientific big o-notation is the

166
00:09:19,310 --> 00:09:21,440
canvas Kay it's roughly where the number

167
00:09:21,440 --> 00:09:23,600
of visible pixels that means if you have

168
00:09:23,600 --> 00:09:25,970
a small canvas it's all good and fine if

169
00:09:25,970 --> 00:09:27,620
the canvas is really big

170
00:09:27,620 --> 00:09:32,620
yeah well that's it's going to be slower

171
00:09:32,620 --> 00:09:35,690
and then there's pure Dom so what is

172
00:09:35,690 --> 00:09:38,000
pure don't give us give us drawing text

173
00:09:38,000 --> 00:09:40,910
lines drawing text drawing lines drawing

174
00:09:40,910 --> 00:09:43,550
rectangles all with different colors

175
00:09:43,550 --> 00:09:48,260
borders that's all we need so it should

176
00:09:48,260 --> 00:09:52,490
be able to be done but also like with

177
00:09:52,490 --> 00:09:54,380
the canvas since we are not using a

178
00:09:54,380 --> 00:09:59,450
predefined editor form we have to do all

179
00:09:59,450 --> 00:10:02,540
the all the event stuff ourselves so

180
00:10:02,540 --> 00:10:05,690
have to define exactly what happens if

181
00:10:05,690 --> 00:10:08,990
you do shift cursor down or shift page

182
00:10:08,990 --> 00:10:12,230
up and control left control right all

183
00:10:12,230 --> 00:10:14,510
this has to be implemented manually the

184
00:10:14,510 --> 00:10:18,020
same is for most interaction and the

185
00:10:18,020 --> 00:10:21,230
naive implementation scales roughly with

186
00:10:21,230 --> 00:10:23,300
a number of lines in the document so the

187
00:10:23,300 --> 00:10:25,910
naive implementation would be put

188
00:10:25,910 --> 00:10:28,810
everything in one big HTML document

189
00:10:28,810 --> 00:10:30,800
which means if you have a very large

190
00:10:30,800 --> 00:10:34,520
document the speed degrades but there's

191
00:10:34,520 --> 00:10:37,310
a better way to do this which scales

192
00:10:37,310 --> 00:10:38,960
with the number of visible lines which

193
00:10:38,960 --> 00:10:43,220
is much much nicer so and this is by

194
00:10:43,220 --> 00:10:45,680
using a virtual viewport so the idea is

195
00:10:45,680 --> 00:10:49,190
really simple you always only see a

196
00:10:49,190 --> 00:10:52,040
small fraction of the of the document so

197
00:10:52,040 --> 00:10:54,260
there's no reason to generate any HTML

198
00:10:54,260 --> 00:10:57,050
markup for the whole document you can

199
00:10:57,050 --> 00:10:59,540
just render generate the HTML markup for

200
00:10:59,540 --> 00:11:02,060
the the viewport for the thing that you

201
00:11:02,060 --> 00:11:06,380
see so as I said rendering a full

202
00:11:06,380 --> 00:11:08,780
document and Dom doesn't scale so we

203
00:11:08,780 --> 00:11:10,730
only render the visible rows and if we

204
00:11:10,730 --> 00:11:14,960
scroll like this we just always update

205
00:11:14,960 --> 00:11:17,230
the contents so the updating itself of

206
00:11:17,230 --> 00:11:19,790
course is a little bit expensive because

207
00:11:19,790 --> 00:11:23,720
we have to really easy to implement so

208
00:11:23,720 --> 00:11:27,110
our Endre we have a strategy of reuse of

209
00:11:27,110 --> 00:11:30,080
Dom for drawing only so we don't store

210
00:11:30,080 --> 00:11:32,840
any state in the DOM and we never read

211
00:11:32,840 --> 00:11:35,870
the Dom so we just use the Dom as a

212
00:11:35,870 --> 00:11:38,420
painting API like we would do with SVG

213
00:11:38,420 --> 00:11:44,780
always over canvas right now by using

214
00:11:44,780 --> 00:11:47,540
the Dom we can we can use the the

215
00:11:47,540 --> 00:11:50,090
composition features of the Dom so like

216
00:11:50,090 --> 00:11:52,760
we can have different layers which are

217
00:11:52,760 --> 00:11:55,160
divs which are stacked behind each other

218
00:11:55,160 --> 00:11:56,750
and each of the layers can draw a

219
00:11:56,750 --> 00:12:00,320
different element of the of the document

220
00:12:00,320 --> 00:12:01,850
like we have a layer for the selection

221
00:12:01,850 --> 00:12:03,440
we have a layer for the curves or we

222
00:12:03,440 --> 00:12:05,120
have a layer for the text and if you

223
00:12:05,120 --> 00:12:06,770
move the cursor you only have to update

224
00:12:06,770 --> 00:12:08,570
the cursor layer and you don't have to

225
00:12:08,570 --> 00:12:11,060
update the text so it's really efficient

226
00:12:11,060 --> 00:12:13,310
to to change the selection or to move

227
00:12:13,310 --> 00:12:14,810
the cursor because it doesn't

228
00:12:14,810 --> 00:12:20,000
of any any costly operations and then

229
00:12:20,000 --> 00:12:21,950
you just put it all on top of each other

230
00:12:21,950 --> 00:12:27,800
and that's how the editor looks like of

231
00:12:27,800 --> 00:12:32,089
course I'd like to to show you some of

232
00:12:32,089 --> 00:12:40,700
the features of the editor not perfect

233
00:12:40,700 --> 00:12:44,450
yet okay so now we have an HTML document

234
00:12:44,450 --> 00:12:46,339
so one of the features of the document

235
00:12:46,339 --> 00:12:48,680
the editor is that it looks like

236
00:12:48,680 --> 00:12:51,200
highlighting of course but it also has

237
00:12:51,200 --> 00:12:53,630
nested syntax highlighting like we have

238
00:12:53,630 --> 00:12:55,940
an HTML file but then there is a CSS

239
00:12:55,940 --> 00:12:58,339
block and we switch the son expediting

240
00:12:58,339 --> 00:13:01,010
mode to CSS and a little bit further

241
00:13:01,010 --> 00:13:05,089
down we have a script mark and the

242
00:13:05,089 --> 00:13:08,150
inside of the script block we switch the

243
00:13:08,150 --> 00:13:10,820
highlighting to use javascript

244
00:13:10,820 --> 00:13:12,980
highlighting and then we as I said I

245
00:13:12,980 --> 00:13:16,300
want to have all the the features that a

246
00:13:16,300 --> 00:13:19,640
normal code editor gives me like let's

247
00:13:19,640 --> 00:13:24,140
assume I want to indent this within the

248
00:13:24,140 --> 00:13:28,160
script block so I can select this hit

249
00:13:28,160 --> 00:13:30,380
tab so I can all to indent it okay

250
00:13:30,380 --> 00:13:33,710
that's much nicer and let's say okay the

251
00:13:33,710 --> 00:13:37,220
on resize method I think has a buck so

252
00:13:37,220 --> 00:13:41,330
what I usually do is I create a copy of

253
00:13:41,330 --> 00:13:43,490
this as a reference and then comment it

254
00:13:43,490 --> 00:13:48,110
out and I say okay let's do something

255
00:13:48,110 --> 00:13:53,960
else the Lord as you see the cursor

256
00:13:53,960 --> 00:13:55,610
jumps to the right position so we have

257
00:13:55,610 --> 00:13:57,980
auto indenting so usually in a normal

258
00:13:57,980 --> 00:13:59,810
text editor or in the normal text field

259
00:13:59,810 --> 00:14:01,670
to cover jump to the beginning of the

260
00:14:01,670 --> 00:14:05,300
line and I'm closing it and I have

261
00:14:05,300 --> 00:14:09,020
authorization and also you see I don't

262
00:14:09,020 --> 00:14:10,670
know if it's visible that it's

263
00:14:10,670 --> 00:14:13,570
highlighting the matching parentheses

264
00:14:13,570 --> 00:14:17,690
okay well well that's not really fixed

265
00:14:17,690 --> 00:14:21,110
thing so I can its reverted so it also

266
00:14:21,110 --> 00:14:24,470
has full undo stack and this is of

267
00:14:24,470 --> 00:14:25,610
course something that you have to

268
00:14:25,610 --> 00:14:27,830
implement yourself as well because our

269
00:14:27,830 --> 00:14:28,750
we are not

270
00:14:28,750 --> 00:14:32,290
is just dumb notes and all the the

271
00:14:32,290 --> 00:14:34,270
changes are just changes through the Dom

272
00:14:34,270 --> 00:14:38,440
by reacting on the events also the cause

273
00:14:38,440 --> 00:14:41,800
is just a blip a small diff that's

274
00:14:41,800 --> 00:14:47,710
hidden and shown again it again and the

275
00:14:47,710 --> 00:14:49,990
other thing was yeah I claimed that

276
00:14:49,990 --> 00:14:51,490
should be able to handle really large

277
00:14:51,490 --> 00:14:55,180
files so this is a file from from our

278
00:14:55,180 --> 00:14:58,210
project that's I think it's generated

279
00:14:58,210 --> 00:15:01,330
but it has like like sixteen thousand

280
00:15:01,330 --> 00:15:03,400
files so in scrolling in this in this

281
00:15:03,400 --> 00:15:06,540
file and opening it a writing code in it

282
00:15:06,540 --> 00:15:11,700
that's really no difference to a file

283
00:15:11,700 --> 00:15:16,180
which is which is only 20 or 100 aligns

284
00:15:16,180 --> 00:15:18,580
long because all that matters for our

285
00:15:18,580 --> 00:15:21,220
father for scaling is how big the

286
00:15:21,220 --> 00:15:23,440
viewport is so if I hadn't had a really

287
00:15:23,440 --> 00:15:26,080
large screen then of course crawling and

288
00:15:26,080 --> 00:15:28,330
doing stuff would be would be slower

289
00:15:28,330 --> 00:15:30,700
because I have to riri render stuff but

290
00:15:30,700 --> 00:15:33,310
this is this it it is even bigger for

291
00:15:33,310 --> 00:15:37,750
for using canvas canvas degrades for

292
00:15:37,750 --> 00:15:39,850
really large screens a lot more than

293
00:15:39,850 --> 00:15:43,030
than the Dom and we only are concerned

294
00:15:43,030 --> 00:15:46,810
about the the vertical hate and not

295
00:15:46,810 --> 00:15:56,440
about the horizontal width alright so

296
00:15:56,440 --> 00:16:05,320
this is the editor yeah plugins to have

297
00:16:05,320 --> 00:16:07,270
an IDE to be really successful you need

298
00:16:07,270 --> 00:16:10,690
a way to to plug in external external

299
00:16:10,690 --> 00:16:13,210
functionality because there is no way

300
00:16:13,210 --> 00:16:15,280
that a small company like Ajax orc and

301
00:16:15,280 --> 00:16:17,290
could implement all the functionality

302
00:16:17,290 --> 00:16:20,860
that any developer would want so we can

303
00:16:20,860 --> 00:16:23,140
concentrate on the core features and

304
00:16:23,140 --> 00:16:26,230
everything else should be plugins and in

305
00:16:26,230 --> 00:16:28,600
this case we designed it so everything

306
00:16:28,600 --> 00:16:30,850
as a plugin search as a plugin file

307
00:16:30,850 --> 00:16:32,560
system as a plug in the new file

308
00:16:32,560 --> 00:16:35,020
dialogues plug-in even the editor is a

309
00:16:35,020 --> 00:16:36,910
plug-in so if you don't like the editor

310
00:16:36,910 --> 00:16:39,630
you can replace it with a different one

311
00:16:39,630 --> 00:16:42,790
the language mods are Plex plugins

312
00:16:42,790 --> 00:16:45,210
the syntax highlighting and indentation

313
00:16:45,210 --> 00:16:50,650
stuff like this all these are plugins so

314
00:16:50,650 --> 00:16:53,650
and the plug-in is very simple it's just

315
00:16:53,650 --> 00:16:56,800
a JavaScript file for the client code

316
00:16:56,800 --> 00:16:59,140
it's JavaScript for the server-side code

317
00:16:59,140 --> 00:17:01,270
since we're running a note and it's some

318
00:17:01,270 --> 00:17:06,160
XML to describe the UI and we at Ajax

319
00:17:06,160 --> 00:17:09,280
org we have a UI framework called APF

320
00:17:09,280 --> 00:17:12,699
Atrix or platform which we use to build

321
00:17:12,699 --> 00:17:16,209
this application and this XML is on HX

322
00:17:16,209 --> 00:17:19,390
or platform XML that you need to to

323
00:17:19,390 --> 00:17:25,060
write the UI so I've prepared a little

324
00:17:25,060 --> 00:17:33,310
video so it's it's poisonous so to give

325
00:17:33,310 --> 00:17:34,740
you some context what's happening now

326
00:17:34,740 --> 00:17:37,840
what's happening now is that we are

327
00:17:37,840 --> 00:17:40,800
going to write a small plugin which

328
00:17:40,800 --> 00:17:42,940
takes the current selection in the

329
00:17:42,940 --> 00:17:47,500
editor which should be JSON and does a

330
00:17:47,500 --> 00:17:49,420
pretty printing of the selection so

331
00:17:49,420 --> 00:17:52,600
essentially it does a a JSON pass and

332
00:17:52,600 --> 00:17:54,940
then json stringify with the indentation

333
00:17:54,940 --> 00:18:00,280
string so what you see here it's just

334
00:18:00,280 --> 00:18:02,050
the template you have the JavaScript

335
00:18:02,050 --> 00:18:08,170
file for the client-side code it's a

336
00:18:08,170 --> 00:18:10,480
template so we replace template with a

337
00:18:10,480 --> 00:18:20,550
format Jason right we save the file and

338
00:18:20,550 --> 00:18:23,290
the UI in this case is an empty window

339
00:18:23,290 --> 00:18:28,120
so and we add to this window VBox for

340
00:18:28,120 --> 00:18:31,000
for the controls for the controls we

341
00:18:31,000 --> 00:18:32,770
want in and the if you click the button

342
00:18:32,770 --> 00:18:36,070
it would call it will actually call the

343
00:18:36,070 --> 00:18:40,110
format function in the JavaScript file

344
00:18:40,110 --> 00:18:46,120
it's ok no so now we are going to write

345
00:18:46,120 --> 00:18:47,680
the the format function it takes this

346
00:18:47,680 --> 00:18:51,549
argument invitation

347
00:18:51,559 --> 00:18:59,269
it takes the current editor so it picks

348
00:18:59,269 --> 00:19:03,080
the current editor and to do this we

349
00:19:03,080 --> 00:19:04,899
need a little little information we need

350
00:19:04,899 --> 00:19:10,610
some of the editor API and so we are we

351
00:19:10,610 --> 00:19:12,740
are accessing there the range object

352
00:19:12,740 --> 00:19:15,440
like you see this is all using requirejs

353
00:19:15,440 --> 00:19:21,529
to to load the files ok so this is the

354
00:19:21,529 --> 00:19:22,869
code

355
00:19:22,869 --> 00:19:28,309
stop it a moment and here you see the

356
00:19:28,309 --> 00:19:31,429
actual like business logic json

357
00:19:31,429 --> 00:19:34,429
stringify json.parse with indentation as

358
00:19:34,429 --> 00:19:42,019
third argument and at the bottom we yeah

359
00:19:42,019 --> 00:19:44,149
we get the range we get the value from

360
00:19:44,149 --> 00:19:46,970
the range stringify it and then we do

361
00:19:46,970 --> 00:19:49,190
document replace and then we update the

362
00:19:49,190 --> 00:19:54,259
selection ok and now the button the

363
00:19:54,259 --> 00:19:56,029
bottom there's a little bit of like

364
00:19:56,029 --> 00:19:57,559
lifecycle management so there are

365
00:19:57,559 --> 00:19:59,539
functions which are called when the

366
00:19:59,539 --> 00:20:02,690
plug-in is enabled disabled initialize

367
00:20:02,690 --> 00:20:09,139
and stuff like that ok so so the UI is

368
00:20:09,139 --> 00:20:16,249
completed yeah now we are gone we can go

369
00:20:16,249 --> 00:20:19,309
to the plugin manager and since we edit

370
00:20:19,309 --> 00:20:22,580
this within the IDE we can immediately

371
00:20:22,580 --> 00:20:25,159
enable the plugin so we add the plugin

372
00:20:25,159 --> 00:20:27,740
requirejs loads the plugin that we just

373
00:20:27,740 --> 00:20:29,509
just written and now the plug-in is

374
00:20:29,509 --> 00:20:37,019
enabled and now let's go to in JSON file

375
00:20:37,029 --> 00:20:42,679
and there's the menu option and here we

376
00:20:42,679 --> 00:20:47,290
go so that's

377
00:20:47,290 --> 00:20:51,940
how how the how essentially all of the

378
00:20:51,940 --> 00:20:54,490
idea is implemented all of the IDE core

379
00:20:54,490 --> 00:20:56,280
functionality besides the basic

380
00:20:56,280 --> 00:20:59,710
workspace is done using plugins like

381
00:20:59,710 --> 00:21:09,130
this oh all right so now let's go to the

382
00:21:09,130 --> 00:21:12,310
debugger how would you do debugging in

383
00:21:12,310 --> 00:21:14,410
the cloud so that is a big big question

384
00:21:14,410 --> 00:21:16,660
because if you host something in the

385
00:21:16,660 --> 00:21:19,300
cloud and run it on the server

386
00:21:19,300 --> 00:21:21,250
how can you debug the code that's

387
00:21:21,250 --> 00:21:25,210
running on the server and this is really

388
00:21:25,210 --> 00:21:29,080
crucial because if you don't really have

389
00:21:29,080 --> 00:21:30,520
a handle to the application you can

390
00:21:30,520 --> 00:21:32,440
really touch it so we need a way to

391
00:21:32,440 --> 00:21:34,900
expose that and the way we are doing

392
00:21:34,900 --> 00:21:38,410
this is by using the v8 debugger

393
00:21:38,410 --> 00:21:41,410
protocol which node fortunately supports

394
00:21:41,410 --> 00:21:44,650
so what we do is we the IDE server

395
00:21:44,650 --> 00:21:47,650
starts a node process with the dash dash

396
00:21:47,650 --> 00:21:50,520
debug argument and then connects to the

397
00:21:50,520 --> 00:21:54,130
debugger port was a small TCP client and

398
00:21:54,130 --> 00:21:57,910
the IDE server then simply proxies the

399
00:21:57,910 --> 00:22:02,050
debugger protocol over socket IO which

400
00:22:02,050 --> 00:22:05,350
is a really nice framework to do to do

401
00:22:05,350 --> 00:22:07,900
server push from the server to the

402
00:22:07,900 --> 00:22:12,010
client to proxy the v8 protocol to the

403
00:22:12,010 --> 00:22:13,960
client and essentially the client

404
00:22:13,960 --> 00:22:16,210
implements the whole via a debugger

405
00:22:16,210 --> 00:22:18,580
protocol handling it passes the messages

406
00:22:18,580 --> 00:22:21,730
and keeps the state and stuff and also

407
00:22:21,730 --> 00:22:25,690
issues commands to the debugger so this

408
00:22:25,690 --> 00:22:29,070
is how we can debug the node application

409
00:22:29,070 --> 00:22:33,820
so there's one missing link that is what

410
00:22:33,820 --> 00:22:36,030
if you want to also debug the

411
00:22:36,030 --> 00:22:38,500
client-side application like the

412
00:22:38,500 --> 00:22:40,840
javascript in the browser so there is a

413
00:22:40,840 --> 00:22:43,570
way to do this but it's a little bit

414
00:22:43,570 --> 00:22:46,990
tricky to get to get to get it running

415
00:22:46,990 --> 00:22:49,810
because and that is by using chrome

416
00:22:49,810 --> 00:22:52,990
chrome also exposes the same debugger

417
00:22:52,990 --> 00:22:54,940
protocol but first of all chrome is we

418
00:22:54,940 --> 00:22:56,830
started with a command line argument so

419
00:22:56,830 --> 00:22:57,790
you have the way

420
00:22:57,790 --> 00:22:59,920
have to have a way to start chrome and

421
00:22:59,920 --> 00:23:02,500
then well you need to need a way to

422
00:23:02,500 --> 00:23:06,540
connect to the Chrome browser which is

423
00:23:06,540 --> 00:23:09,010
which is freaky because the server

424
00:23:09,010 --> 00:23:11,470
cannot do it so the client has to do it

425
00:23:11,470 --> 00:23:13,540
and to do this the client would have to

426
00:23:13,540 --> 00:23:18,220
have a plug-in or something ok but so we

427
00:23:18,220 --> 00:23:20,290
had a prototype showing showing chrome

428
00:23:20,290 --> 00:23:22,900
debugging but it's not in the IDE yet so

429
00:23:22,900 --> 00:23:24,580
this is something that that's going to

430
00:23:24,580 --> 00:23:33,010
come ok let's do a small demo again so

431
00:23:33,010 --> 00:23:34,870
this is really the most exciting demo

432
00:23:34,870 --> 00:23:41,050
for me okay so let's go back to our our

433
00:23:41,050 --> 00:23:48,990
application that we've written before I

434
00:23:48,990 --> 00:24:00,410
happen to have this open let's

435
00:24:00,420 --> 00:24:13,140
running okay

436
00:24:13,150 --> 00:24:26,060
all right

437
00:24:26,070 --> 00:24:29,710
okay we put it here so we can see it can

438
00:24:29,710 --> 00:24:38,299
hit it reload

439
00:24:38,309 --> 00:24:43,270
all right ah so but but instead of

440
00:24:43,270 --> 00:24:45,730
hitting run we can also hit debug what

441
00:24:45,730 --> 00:24:48,429
this does is it makes the viewport very

442
00:24:48,429 --> 00:24:51,280
small but also it starts the node

443
00:24:51,280 --> 00:24:53,260
process with was a debugger argument and

444
00:24:53,260 --> 00:24:56,920
connects to it so what I can do now is I

445
00:24:56,920 --> 00:24:59,440
can set a breakpoint here and if I hit

446
00:24:59,440 --> 00:25:06,340
reload I can it breaks at this

447
00:25:06,340 --> 00:25:08,050
breakpoint I can just stuff like

448
00:25:08,050 --> 00:25:10,660
navigating the call stack let's see it's

449
00:25:10,660 --> 00:25:13,300
called by event emitter and this comes

450
00:25:13,300 --> 00:25:18,460
from HTTP and this comes from socket and

451
00:25:18,460 --> 00:25:21,940
this also shows our code that you know

452
00:25:21,940 --> 00:25:23,860
that you usually don't see on the on the

453
00:25:23,860 --> 00:25:27,100
hard disk because because it's compiled

454
00:25:27,100 --> 00:25:29,050
into note but the debugger where our

455
00:25:29,050 --> 00:25:31,809
protocol also exposes it and what you

456
00:25:31,809 --> 00:25:34,450
can do as well is let's go back of

457
00:25:34,450 --> 00:25:38,440
course also inspect the local the local

458
00:25:38,440 --> 00:25:42,070
scope like you can go to the request can

459
00:25:42,070 --> 00:25:44,080
take a look at the headers stuff like

460
00:25:44,080 --> 00:25:49,360
that well and then of course you can do

461
00:25:49,360 --> 00:25:52,000
stuff like step into this little bit

462
00:25:52,000 --> 00:25:55,150
smaller so I'm now stepping into into

463
00:25:55,150 --> 00:25:56,710
node I'm not really interesting I can

464
00:25:56,710 --> 00:25:59,980
step out and then I can say okay let's

465
00:25:59,980 --> 00:26:04,510
continue so this is how can do debugging

466
00:26:04,510 --> 00:26:06,880
but there's also one one

467
00:26:06,880 --> 00:26:08,320
so that makes it a little bit more

468
00:26:08,320 --> 00:27:20,510
interesting to you

469
00:27:20,520 --> 00:27:25,780
and I can click on it and inspect it but

470
00:27:25,780 --> 00:27:27,910
I cannot only inspect stuff I can also

471
00:27:27,910 --> 00:27:32,160
change stuff like I can say message is

472
00:27:32,160 --> 00:27:38,620
Yahoo Jay is Cohen so what this means I

473
00:27:38,620 --> 00:27:40,750
evaluate this code in the current

474
00:27:40,750 --> 00:27:42,970
context that means I'm changing the

475
00:27:42,970 --> 00:27:45,430
variable in the closure and if I

476
00:27:45,430 --> 00:27:56,070
continue now you see Yahoo J's comes

477
00:27:56,080 --> 00:28:02,049
I pretty amazing yeah so let's let's

478
00:28:02,049 --> 00:28:05,230
continue and if I reload of course now

479
00:28:05,230 --> 00:28:07,059
it will always return you who JS count

480
00:28:07,059 --> 00:28:10,700
because it's now stalled in the closure

481
00:28:10,710 --> 00:28:15,519
so it is so but but this is this is just

482
00:28:15,519 --> 00:28:17,590
the beginning you've seen that still has

483
00:28:17,590 --> 00:28:19,809
a lot of edge cases it's not not a

484
00:28:19,809 --> 00:28:23,049
product yet but I still think it's nice

485
00:28:23,049 --> 00:28:24,880
to show what you can actually do in

486
00:28:24,880 --> 00:28:27,370
running stuff on the web at the moment

487
00:28:27,370 --> 00:28:30,460
this runs totally locally so there's

488
00:28:30,460 --> 00:28:31,929
something you can install locally on

489
00:28:31,929 --> 00:28:35,440
your machine and then immediately start

490
00:28:35,440 --> 00:28:37,289
working on your code on your machine

491
00:28:37,289 --> 00:28:45,820
yeah we have an nvm package yes and yes

492
00:28:45,820 --> 00:28:53,720
you can install it with an NB a-- npm

493
00:28:53,730 --> 00:28:56,950
right so that was the demo so we can

494
00:28:56,950 --> 00:28:59,620
come over closing words so our vision is

495
00:28:59,620 --> 00:29:02,440
to be to eclipse with Google Docs is to

496
00:29:02,440 --> 00:29:04,330
word that means all the important

497
00:29:04,330 --> 00:29:06,880
features plus all the features all the

498
00:29:06,880 --> 00:29:10,299
benefits of being in the cloud so we

499
00:29:10,299 --> 00:29:12,279
really want the next step will be to

500
00:29:12,279 --> 00:29:14,889
move this on to the hosted servers to

501
00:29:14,889 --> 00:29:16,510
run it directly from the server at the

502
00:29:16,510 --> 00:29:20,740
moment it's all local and we would like

503
00:29:20,740 --> 00:29:23,919
to thank the community since we are

504
00:29:23,919 --> 00:29:25,750
using a lot of stuff that you guys have

505
00:29:25,750 --> 00:29:29,409
built we are using connect as node web

506
00:29:29,409 --> 00:29:31,029
framework we use socket iOS to

507
00:29:31,029 --> 00:29:33,700
communicate from service server to

508
00:29:33,700 --> 00:29:36,880
client of course we use nodejs and we

509
00:29:36,880 --> 00:29:39,460
use requirejs to to do the the

510
00:29:39,460 --> 00:29:41,200
client-side loading and plug-in loading

511
00:29:41,200 --> 00:29:44,769
and I really love to use requirejs I

512
00:29:44,769 --> 00:29:47,169
would even love it more if I could use

513
00:29:47,169 --> 00:29:50,169
requires modules directly a note that's

514
00:29:50,169 --> 00:29:53,740
maybe that's happening and then of

515
00:29:53,740 --> 00:29:55,750
course we are also contributing stuff

516
00:29:55,750 --> 00:29:58,830
back there's a lot of code that we

517
00:29:58,830 --> 00:30:01,149
release as open source as well or

518
00:30:01,149 --> 00:30:03,220
maintained as open source that's for one

519
00:30:03,220 --> 00:30:06,760
APF the UI framework that's junior staff

520
00:30:06,760 --> 00:30:07,260
there

521
00:30:07,260 --> 00:30:09,270
my colleague Mike has done it's a

522
00:30:09,270 --> 00:30:13,770
node-based web dev server which we use

523
00:30:13,770 --> 00:30:16,530
to use the file system stuff for the

524
00:30:16,530 --> 00:30:19,140
file system tree we have not all three

525
00:30:19,140 --> 00:30:21,480
XML we're not using it yet

526
00:30:21,480 --> 00:30:26,220
it's a wrapper for lip XML and a fast

527
00:30:26,220 --> 00:30:30,600
wrapper for Pugi XML which is very fast

528
00:30:30,600 --> 00:30:32,250
it's in the library with a slightly

529
00:30:32,250 --> 00:30:34,620
limited feature set we're going to use

530
00:30:34,620 --> 00:30:36,630
not github that github that's a library

531
00:30:36,630 --> 00:30:38,760
that I've written to access the github

532
00:30:38,760 --> 00:30:42,090
API and we using async s it's a very

533
00:30:42,090 --> 00:30:44,970
small library by me too which basically

534
00:30:44,970 --> 00:30:48,120
wraps the the note filesystem API on top

535
00:30:48,120 --> 00:30:52,080
of this we are releasing the full editor

536
00:30:52,080 --> 00:30:54,180
source code today as open source which

537
00:30:54,180 --> 00:30:55,800
also contains implementation of the

538
00:30:55,800 --> 00:31:00,890
debugger the 80 bug our protocol oh

539
00:31:00,890 --> 00:31:02,370
that's not it

540
00:31:02,370 --> 00:31:05,160
so we also release the full source code

541
00:31:05,160 --> 00:31:08,070
of the IDE today so you can go now to

542
00:31:08,070 --> 00:31:11,880
get up check out the source code it will

543
00:31:11,880 --> 00:31:15,210
probably break in in in a lot of cases

544
00:31:15,210 --> 00:31:18,060
but you can try try to take a look at

545
00:31:18,060 --> 00:31:22,770
the source code and hang on it so the

546
00:31:22,770 --> 00:31:25,170
servers are up and the project on github

547
00:31:25,170 --> 00:31:28,970
are open now so really would like to

548
00:31:28,970 --> 00:31:32,490
like you to join us in building the Java

549
00:31:32,490 --> 00:31:35,760
Script IDE for Java Script / developers

550
00:31:35,760 --> 00:31:37,560
why JavaScript developers that's our

551
00:31:37,560 --> 00:31:41,310
vision and that's it

552
00:31:41,310 --> 00:31:52,870
thank you

553
00:31:52,880 --> 00:31:55,539
okay

554
00:31:55,549 --> 00:31:57,799
are there any questions

555
00:31:57,799 --> 00:32:03,179
Martin the idea itself will at the

556
00:32:03,179 --> 00:32:05,990
beginning be GPL

557
00:32:05,990 --> 00:32:11,570
the editor and the no debugger are LGPL

558
00:32:11,570 --> 00:32:15,690
now we are considering in using more

559
00:32:15,690 --> 00:32:17,370
liberal license later but at the moment

560
00:32:17,370 --> 00:32:20,520
we want to want to stick to two GPL for

561
00:32:20,520 --> 00:32:29,730
the ID yes yeah one one of the design

562
00:32:29,730 --> 00:32:32,940
goals for the editor was to not have a

563
00:32:32,940 --> 00:32:34,830
big dependency on anything else the

564
00:32:34,830 --> 00:32:36,059
editor itself has no external

565
00:32:36,059 --> 00:32:37,950
dependencies besides require.js

566
00:32:37,950 --> 00:32:43,559
so we don't use any external now we are

567
00:32:43,559 --> 00:32:47,330
not doing it right now but we are really

568
00:32:47,330 --> 00:32:49,679
really want to have this in the future

569
00:32:49,679 --> 00:32:52,169
that you have some collaboration on code

570
00:32:52,169 --> 00:32:55,140
editing that's part of our plan it's not

571
00:32:55,140 --> 00:33:11,359
implemented yet it was yeah

572
00:33:11,369 --> 00:33:14,919
yes we do want this we don't have it now

573
00:33:14,919 --> 00:33:16,840
at the moment it's something you can

574
00:33:16,840 --> 00:33:19,269
install on your PC and edit your local

575
00:33:19,269 --> 00:33:21,940
files with the local file server but we

576
00:33:21,940 --> 00:33:23,799
definitely want you to make it a hosted

577
00:33:23,799 --> 00:33:25,989
service and we definitely want to have

578
00:33:25,989 --> 00:33:27,489
some collaboration features where you

579
00:33:27,489 --> 00:33:29,980
can work on the same source code maybe

580
00:33:29,980 --> 00:33:33,610
with a chat window on the side at the

581
00:33:33,610 --> 00:33:42,309
same time yes I'm pretty sure it's not

582
00:33:42,309 --> 00:33:46,929
working on the iPad it's I haven't

583
00:33:46,929 --> 00:33:50,460
tested the iPad yet but since we are

584
00:33:50,460 --> 00:33:58,379
going heavily on the UI interactions to

585
00:33:58,379 --> 00:34:01,600
interpret what's happening manually I'm

586
00:34:01,600 --> 00:34:03,249
pretty sure it's not working on the iPad

587
00:34:03,249 --> 00:34:04,869
yet but if you want to make it work on

588
00:34:04,869 --> 00:34:06,960
the iPad but we would be really happy

589
00:34:06,960 --> 00:34:15,669
sir alright then thank you for listening

