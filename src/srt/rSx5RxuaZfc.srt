1
00:00:14,480 --> 00:00:17,940

hi and welcome back from lunch am I too

2
00:00:17,940 --> 00:00:23,789
loud yes no alright so let's talk about

3
00:00:23,789 --> 00:00:27,330
how we build messenger calm and if you

4
00:00:27,330 --> 00:00:30,029
don't know messengers calm is a full

5
00:00:30,029 --> 00:00:33,120
page react application on which you can

6
00:00:33,120 --> 00:00:35,460
send and receive facebook messenger

7
00:00:35,460 --> 00:00:39,149
messages um why would we build such a

8
00:00:39,149 --> 00:00:40,590
thing when you already have chat on

9
00:00:40,590 --> 00:00:42,989
facebook well when we launched it we

10
00:00:42,989 --> 00:00:44,250
gave all the reasons in the press

11
00:00:44,250 --> 00:00:47,280
release and they're so true something

12
00:00:47,280 --> 00:00:49,980
nice happen is a side effect a lot of

13
00:00:49,980 --> 00:00:51,780
corporations for instance block access

14
00:00:51,780 --> 00:00:54,570
to facebook on their corporate networks

15
00:00:54,570 --> 00:00:55,649
because they want people to be

16
00:00:55,649 --> 00:00:59,399
productive but they don't block access

17
00:00:59,399 --> 00:01:01,500
to messenger calm at least not yet so

18
00:01:01,500 --> 00:01:04,739
there's that but also we thought it

19
00:01:04,739 --> 00:01:07,680
would be very cool to build and how do I

20
00:01:07,680 --> 00:01:10,979
get to work on it I was just lucky I i

21
00:01:10,979 --> 00:01:13,140
joined facebook right about the time it

22
00:01:13,140 --> 00:01:16,009
was started and the web messages team

23
00:01:16,009 --> 00:01:18,330
pitched the project i liked it and i

24
00:01:18,330 --> 00:01:21,750
joined and I never looked back before we

25
00:01:21,750 --> 00:01:24,299
get into actual messenger com I want to

26
00:01:24,299 --> 00:01:26,130
take them over and talk about how we

27
00:01:26,130 --> 00:01:28,860
front in that facebook and I think it's

28
00:01:28,860 --> 00:01:30,570
time we use front-end as a verb it's

29
00:01:30,570 --> 00:01:34,140
hard to talk otherwise but as most

30
00:01:34,140 --> 00:01:38,369
companies do we use modules small

31
00:01:38,369 --> 00:01:40,200
components this is the thing that makes

32
00:01:40,200 --> 00:01:42,630
sense everyone knows everyone agrees I

33
00:01:42,630 --> 00:01:45,750
think how we make modules is the same as

34
00:01:45,750 --> 00:01:47,790
everyone else we will define one just

35
00:01:47,790 --> 00:01:50,460
messenger foo it lives in the file that

36
00:01:50,460 --> 00:01:53,040
has the same name messenger foo we just

37
00:01:53,040 --> 00:01:55,350
add this doc block to the beginning of

38
00:01:55,350 --> 00:01:59,549
the CSS file and ready to get started we

39
00:01:59,549 --> 00:02:01,380
had our rules but we have a special kind

40
00:02:01,380 --> 00:02:04,320
of syntax as you can see we use the name

41
00:02:04,320 --> 00:02:06,149
of the module and a slash and then the

42
00:02:06,149 --> 00:02:08,819
actual rule name this makes it very easy

43
00:02:08,819 --> 00:02:11,220
to whenever you look at the class name

44
00:02:11,220 --> 00:02:13,470
to know what it belongs to

45
00:02:13,470 --> 00:02:16,730
and we have it so that you can only use

46
00:02:16,730 --> 00:02:19,860
rules and class names that belong to

47
00:02:19,860 --> 00:02:21,600
this module over here so if we try to

48
00:02:21,600 --> 00:02:24,510
use messenger bar this will be a lint

49
00:02:24,510 --> 00:02:26,250
error why would you want to change

50
00:02:26,250 --> 00:02:29,130
messenger bar rules from with a

51
00:02:29,130 --> 00:02:32,280
messenger foo we do this for

52
00:02:32,280 --> 00:02:33,660
encapsulation purposes and to try to

53
00:02:33,660 --> 00:02:36,350
make our CSS components small and very

54
00:02:36,350 --> 00:02:39,150
focus on one thing so we can compose

55
00:02:39,150 --> 00:02:41,850
multiple if we need to however sometimes

56
00:02:41,850 --> 00:02:43,230
you do need to style something from

57
00:02:43,230 --> 00:02:44,640
another component so we have a thing

58
00:02:44,640 --> 00:02:47,670
called public classes we just define

59
00:02:47,670 --> 00:02:49,620
them in a way that you can use in a

60
00:02:49,620 --> 00:02:51,450
different module because sometimes you

61
00:02:51,450 --> 00:02:52,770
do need to style things differently

62
00:02:52,770 --> 00:02:55,260
depending on how you can post things but

63
00:02:55,260 --> 00:02:57,840
this will really make a lot of sense why

64
00:02:57,840 --> 00:02:59,550
would we always overwrite the public

65
00:02:59,550 --> 00:03:02,150
class of another module we just

66
00:03:02,150 --> 00:03:05,310
concatenate with our rule it's very

67
00:03:05,310 --> 00:03:07,470
simple it just takes some getting used

68
00:03:07,470 --> 00:03:09,540
to especially with a slash in the rule

69
00:03:09,540 --> 00:03:11,730
name which is not valid syntax I don't

70
00:03:11,730 --> 00:03:14,010
think well you don't even need to use

71
00:03:14,010 --> 00:03:16,200
all that a simple rule like that is all

72
00:03:16,200 --> 00:03:18,300
you need for a mile to exist we don't

73
00:03:18,300 --> 00:03:19,830
even need a rule you just need to put

74
00:03:19,830 --> 00:03:21,269
the module there and everything will be

75
00:03:21,269 --> 00:03:24,180
public and it is how we would use it in

76
00:03:24,180 --> 00:03:26,640
JavaScript we have a simple mark

77
00:03:26,640 --> 00:03:29,640
messenger foo react component we have an

78
00:03:29,640 --> 00:03:31,290
h1 and we want to just use the title

79
00:03:31,290 --> 00:03:35,220
class name on it we just right you know

80
00:03:35,220 --> 00:03:37,680
react does anyone here use react I'm

81
00:03:37,680 --> 00:03:39,630
sure you do yes there we go put your

82
00:03:39,630 --> 00:03:44,519
hands down but we can do more complex

83
00:03:44,519 --> 00:03:46,320
things instead of saying just use this

84
00:03:46,320 --> 00:03:48,780
class name we can pass it some JSON and

85
00:03:48,780 --> 00:03:51,660
this in this JSON the property names are

86
00:03:51,660 --> 00:03:53,459
the actual class names that we want to

87
00:03:53,459 --> 00:03:56,280
use and the values are booleans and the

88
00:03:56,280 --> 00:03:58,290
signal whether or not to include this

89
00:03:58,290 --> 00:04:01,799
class in the class list and let's focus

90
00:04:01,799 --> 00:04:04,470
on the the weird thing over there that's

91
00:04:04,470 --> 00:04:10,380
CX CX is our class transform function it

92
00:04:10,380 --> 00:04:12,780
serves multiple purposes for one thing

93
00:04:12,780 --> 00:04:14,790
it actually evaluates the logic of which

94
00:04:14,790 --> 00:04:16,830
classes to include based on the boolean

95
00:04:16,830 --> 00:04:20,310
values for jasons but it's always there

96
00:04:20,310 --> 00:04:23,640
we always have to use it so we know that

97
00:04:23,640 --> 00:04:25,780
we can search for it

98
00:04:25,780 --> 00:04:28,810
and we look for instances of CX and we

99
00:04:28,810 --> 00:04:31,060
find out which modules do we need to

100
00:04:31,060 --> 00:04:32,950
include in this case we need to include

101
00:04:32,950 --> 00:04:35,740
messenger foo and messenger bar that CSS

102
00:04:35,740 --> 00:04:38,620
these two modules and we do this not at

103
00:04:38,620 --> 00:04:39,700
runtime because that will be very

104
00:04:39,700 --> 00:04:41,950
inefficient we do this through static

105
00:04:41,950 --> 00:04:45,700
analysis at build time we just parts all

106
00:04:45,700 --> 00:04:47,320
our JavaScript files and we see which

107
00:04:47,320 --> 00:04:49,600
modules are being referenced and then

108
00:04:49,600 --> 00:04:51,340
whenever the module will be loaded we

109
00:04:51,340 --> 00:04:53,800
already have the CSS loaded side by side

110
00:04:53,800 --> 00:04:56,260
with it it's on a package and all

111
00:04:56,260 --> 00:04:58,780
required and this is great because you

112
00:04:58,780 --> 00:05:01,530
never forget to include your modules and

113
00:05:01,530 --> 00:05:04,840
it saves you love you know time hassled

114
00:05:04,840 --> 00:05:08,110
debugging effort and this enables us to

115
00:05:08,110 --> 00:05:11,169
do very cool things that have to do with

116
00:05:11,169 --> 00:05:13,630
the two modes and now I'm not talking

117
00:05:13,630 --> 00:05:16,120
about you read software more than you

118
00:05:16,120 --> 00:05:18,970
write software even when you're writing

119
00:05:18,970 --> 00:05:20,470
software or when you're reading software

120
00:05:20,470 --> 00:05:22,990
a code or when you're debugging it

121
00:05:22,990 --> 00:05:25,630
you're still in the human mode it's you

122
00:05:25,630 --> 00:05:27,130
interacting with the code that you or

123
00:05:27,130 --> 00:05:29,740
somebody else is written the other mode

124
00:05:29,740 --> 00:05:32,500
is the Machine mode is the machine when

125
00:05:32,500 --> 00:05:34,660
it executes your code and it has to do

126
00:05:34,660 --> 00:05:38,490
something with has to understand it our

127
00:05:38,490 --> 00:05:41,380
our static strength our static tools our

128
00:05:41,380 --> 00:05:43,240
psyche transforms and analysis allow us

129
00:05:43,240 --> 00:05:44,560
to do things there are good both for

130
00:05:44,560 --> 00:05:46,350
humans and for machines for instance

131
00:05:46,350 --> 00:05:49,539
this is all we need to type to get all

132
00:05:49,539 --> 00:05:52,150
the prefixes these get added at build

133
00:05:52,150 --> 00:05:55,000
time automatically this is an

134
00:05:55,000 --> 00:05:57,460
optimization done for humans it's very

135
00:05:57,460 --> 00:05:59,350
unpleasant to have to type these manuals

136
00:05:59,350 --> 00:06:01,240
I'm sure you know and you'll use prefix

137
00:06:01,240 --> 00:06:03,460
free or something of the sort we go a

138
00:06:03,460 --> 00:06:04,960
step further we also optimized for

139
00:06:04,960 --> 00:06:07,150
machine at this level as well more or

140
00:06:07,150 --> 00:06:11,169
less when a person loads our page they

141
00:06:11,169 --> 00:06:13,750
load it with a browser so if I'm using

142
00:06:13,750 --> 00:06:17,110
Firefox and I load messenger com why

143
00:06:17,110 --> 00:06:19,630
would I get the MS transform and the

144
00:06:19,630 --> 00:06:21,370
WebKit transform declarations they make

145
00:06:21,370 --> 00:06:22,840
no sense the browser will ignore them

146
00:06:22,840 --> 00:06:25,180
they're wasted bites we actually don't

147
00:06:25,180 --> 00:06:27,940
even send them we look at what browser

148
00:06:27,940 --> 00:06:29,440
you're using and we only send you the

149
00:06:29,440 --> 00:06:31,660
rules that you will understand which is

150
00:06:31,660 --> 00:06:33,310
very cool because this saves a lot of

151
00:06:33,310 --> 00:06:36,450
bites and bites save energy in fact I

152
00:06:36,450 --> 00:06:39,320
estimated just by this thing

153
00:06:39,320 --> 00:06:41,210
we save enough energy which is

154
00:06:41,210 --> 00:06:43,430
equivalent to about half a Hiroshima

155
00:06:43,430 --> 00:06:45,620
every day to put it in a different

156
00:06:45,620 --> 00:06:49,700
perspective it's enough energy to warm

157
00:06:49,700 --> 00:06:52,430
up this room to a temperature of 214

158
00:06:52,430 --> 00:06:56,800
cats for about a week that's a lot

159
00:06:56,800 --> 00:06:59,210
another thing we do and this is actually

160
00:06:59,210 --> 00:07:02,180
a pet peeve of mine it doesn't matter if

161
00:07:02,180 --> 00:07:06,500
an element is 0 pixels or 0% or zero

162
00:07:06,500 --> 00:07:08,720
elephants from the right it's smack on

163
00:07:08,720 --> 00:07:10,790
the right we don't need the unit there

164
00:07:10,790 --> 00:07:13,250
we actually do remove it the static

165
00:07:13,250 --> 00:07:16,310
analysis and this again saves bytes

166
00:07:16,310 --> 00:07:19,700
white save energy this simple say by

167
00:07:19,700 --> 00:07:22,430
removing the unit from zero allows 200

168
00:07:22,430 --> 00:07:24,170
stray cats to find a new home every

169
00:07:24,170 --> 00:07:28,730
single day that's my estimation and this

170
00:07:28,730 --> 00:07:31,330
managing is something we do for machines

171
00:07:31,330 --> 00:07:34,220
because I am a human I'm sure your human

172
00:07:34,220 --> 00:07:37,190
as well most of you and we need

173
00:07:37,190 --> 00:07:40,100
something like this we need a rule that

174
00:07:40,100 --> 00:07:42,470
makes sense when you read it this is the

175
00:07:42,470 --> 00:07:44,480
title rule belonging to the messenger

176
00:07:44,480 --> 00:07:48,170
for component a machine doesn't care a

177
00:07:48,170 --> 00:07:51,770
machine needs a unique string so why not

178
00:07:51,770 --> 00:07:54,160
make it something very very short a

179
00:07:54,160 --> 00:07:56,900
machine will do just fine and we never

180
00:07:56,900 --> 00:07:58,580
have to read this this just happens

181
00:07:58,580 --> 00:08:00,890
between machines so back to our

182
00:08:00,890 --> 00:08:05,540
JavaScript example this whole thing gets

183
00:08:05,540 --> 00:08:08,150
evaluated and say we also have the

184
00:08:08,150 --> 00:08:10,990
subtitle it will be those two classes

185
00:08:10,990 --> 00:08:13,430
but this is after build time when this

186
00:08:13,430 --> 00:08:16,190
actually runs so it's not that big long

187
00:08:16,190 --> 00:08:17,780
string in the class this is just

188
00:08:17,780 --> 00:08:20,660
something small like this now the

189
00:08:20,660 --> 00:08:23,410
compound savings from all these bites

190
00:08:23,410 --> 00:08:27,410
arteries are enough to boil all the

191
00:08:27,410 --> 00:08:29,810
coffee that has and ever will be

192
00:08:29,810 --> 00:08:32,120
consumed that all the CSS cons would

193
00:08:32,120 --> 00:08:35,810
ever ever happen but we're not over I

194
00:08:35,810 --> 00:08:37,550
mean this is just writing and maybe

195
00:08:37,550 --> 00:08:40,700
debugging a but yes we're shipping code

196
00:08:40,700 --> 00:08:42,650
we're shipping our code to the the users

197
00:08:42,650 --> 00:08:43,880
and they're loading in their browsers

198
00:08:43,880 --> 00:08:46,610
but we're not done we have another thing

199
00:08:46,610 --> 00:08:48,560
it's called machine learning which we

200
00:08:48,560 --> 00:08:49,970
can use we have this cool thing called

201
00:08:49,970 --> 00:08:52,490
packager and remember how we reference

202
00:08:52,490 --> 00:08:53,030
to

203
00:08:53,030 --> 00:08:56,060
ss modules in our example messenger foo

204
00:08:56,060 --> 00:08:58,730
and messenger bar well packager we'll

205
00:08:58,730 --> 00:09:00,380
look at how messenger full and messenger

206
00:09:00,380 --> 00:09:02,840
bar are loaded especially in relation to

207
00:09:02,840 --> 00:09:05,750
messenger food out Jas and we'll see

208
00:09:05,750 --> 00:09:07,310
that whenever we request messenger foo

209
00:09:07,310 --> 00:09:09,500
we also request messenger bar so it

210
00:09:09,500 --> 00:09:11,540
makes sense to turn these two files into

211
00:09:11,540 --> 00:09:14,690
one single file and the file name will

212
00:09:14,690 --> 00:09:17,150
also be very small again fewer bytes and

213
00:09:17,150 --> 00:09:19,460
fewer bytes and this is these are just

214
00:09:19,460 --> 00:09:24,130
randomly generated hashes but even even

215
00:09:24,130 --> 00:09:28,220
machines can make mistakes two weeks ago

216
00:09:28,220 --> 00:09:31,610
or so this file was generated based on

217
00:09:31,610 --> 00:09:35,780
packagers heuristics and I'm sure some

218
00:09:35,780 --> 00:09:38,810
of you already see the problem some

219
00:09:38,810 --> 00:09:42,170
people couldn't chat for a considerable

220
00:09:42,170 --> 00:09:44,540
amount of time because ad blockers

221
00:09:44,540 --> 00:09:46,490
thought this was an ad when in fact it

222
00:09:46,490 --> 00:09:48,140
was just a couple of our modules that we

223
00:09:48,140 --> 00:09:52,040
kind of need for chats work machines are

224
00:09:52,040 --> 00:09:56,480
silly but that's why we're here and here

225
00:09:56,480 --> 00:09:58,370
today yesterday and just in general

226
00:09:58,370 --> 00:10:00,440
people ask me a lot whether we use less

227
00:10:00,440 --> 00:10:01,850
or SAS and which one would prefer at

228
00:10:01,850 --> 00:10:04,520
Facebook or do we use tieless we use

229
00:10:04,520 --> 00:10:08,390
nothing because using one of these make

230
00:10:08,390 --> 00:10:10,610
it harder for people who just start to

231
00:10:10,610 --> 00:10:12,830
get into the groove anyone who's ever

232
00:10:12,830 --> 00:10:15,020
written a web page can work at Facebook

233
00:10:15,020 --> 00:10:18,110
and they instantly know everything they

234
00:10:18,110 --> 00:10:19,640
do need to know to be able to be

235
00:10:19,640 --> 00:10:23,510
efficient we use plain old CSS however

236
00:10:23,510 --> 00:10:25,550
we do have the static analysis and style

237
00:10:25,550 --> 00:10:28,100
transform step in our build system so we

238
00:10:28,100 --> 00:10:29,720
can do some funny things we use

239
00:10:29,720 --> 00:10:31,850
variables of course we call him

240
00:10:31,850 --> 00:10:33,170
constants though because they're not

241
00:10:33,170 --> 00:10:36,110
really variable and this is how you use

242
00:10:36,110 --> 00:10:41,390
a constant what it's a bar but anyway it

243
00:10:41,390 --> 00:10:42,920
builds stuff we will replace it with his

244
00:10:42,920 --> 00:10:45,530
actual value this is great so you don't

245
00:10:45,530 --> 00:10:48,680
have to always remember you know fo six

246
00:10:48,680 --> 00:10:50,990
for a magenta you can just say messenger

247
00:10:50,990 --> 00:10:54,080
magenta and that will be great now the

248
00:10:54,080 --> 00:10:57,350
rule that you have to use to you know to

249
00:10:57,350 --> 00:11:00,500
go from a actual explicit hex value to a

250
00:11:00,500 --> 00:11:03,140
constant or after how many repetitions

251
00:11:03,140 --> 00:11:06,470
do you use that the rule

252
00:11:06,470 --> 00:11:07,970
I still don't know it but I'll find out

253
00:11:07,970 --> 00:11:10,190
and I'll tell you but that's enough

254
00:11:10,190 --> 00:11:12,710
about how we we actually you know ship

255
00:11:12,710 --> 00:11:15,530
code I think you got a pretty okay idea

256
00:11:15,530 --> 00:11:18,290
of what happens hopefully otherwise

257
00:11:18,290 --> 00:11:20,690
let's talk later but let's get back to

258
00:11:20,690 --> 00:11:23,420
messenger calm because it all actually

259
00:11:23,420 --> 00:11:25,700
started a long time ago when we rewrote

260
00:11:25,700 --> 00:11:28,430
chat the facebook chat with this in a

261
00:11:28,430 --> 00:11:30,650
very special way we thought let's make

262
00:11:30,650 --> 00:11:33,230
some components that have no styling

263
00:11:33,230 --> 00:11:34,880
they just get the data they need and

264
00:11:34,880 --> 00:11:36,980
then we have different components that

265
00:11:36,980 --> 00:11:39,800
will present the data this is not a new

266
00:11:39,800 --> 00:11:42,410
concept but we decided to apply this

267
00:11:42,410 --> 00:11:45,050
religiously through chat we call these

268
00:11:45,050 --> 00:11:47,060
Stalag gnostic components containers and

269
00:11:47,060 --> 00:11:49,490
everything is a container and needs a

270
00:11:49,490 --> 00:11:51,580
presenter to actually display the data

271
00:11:51,580 --> 00:11:54,560
so you wrap a you know a normal

272
00:11:54,560 --> 00:11:56,150
presenter in a container and you wrap

273
00:11:56,150 --> 00:11:57,980
that you know what multiple lists of

274
00:11:57,980 --> 00:11:59,390
them in another container and so on you

275
00:11:59,390 --> 00:12:02,180
go up and go up we call this shawarma

276
00:12:02,180 --> 00:12:03,920
driven development because everything is

277
00:12:03,920 --> 00:12:07,850
a rap as a simple example let's say we

278
00:12:07,850 --> 00:12:09,890
would hypothetically have a list of

279
00:12:09,890 --> 00:12:11,960
recent conversations that we'll just

280
00:12:11,960 --> 00:12:15,920
call the style agnostic threadless we

281
00:12:15,920 --> 00:12:18,140
give us some parameters we give it a

282
00:12:18,140 --> 00:12:20,060
presenter which is something again we

283
00:12:20,060 --> 00:12:21,860
control and we give it a class name just

284
00:12:21,860 --> 00:12:24,440
so we have a hook so we can use its

285
00:12:24,440 --> 00:12:26,720
public classes to style things and we're

286
00:12:26,720 --> 00:12:29,450
done it goes down one level it calls the

287
00:12:29,450 --> 00:12:31,940
class the component we pass in and then

288
00:12:31,940 --> 00:12:34,130
again we for every conversation we just

289
00:12:34,130 --> 00:12:37,400
add a new container pass down to how the

290
00:12:37,400 --> 00:12:39,890
classes have the hooks and so on until

291
00:12:39,890 --> 00:12:43,600
we have the whole tree shawarma and

292
00:12:43,600 --> 00:12:45,860
because this was a new thing right this

293
00:12:45,860 --> 00:12:48,080
is facebook com and facebook com has

294
00:12:48,080 --> 00:12:50,450
been there for a while we believe that

295
00:12:50,450 --> 00:12:52,010
everybody should be able to use facebook

296
00:12:52,010 --> 00:12:53,930
so we support a large amount of browsers

297
00:12:53,930 --> 00:12:56,590
but messenger come was a new thing and

298
00:12:56,590 --> 00:12:59,150
by definition it is niche it's people

299
00:12:59,150 --> 00:13:00,710
who really want to use messenger and

300
00:13:00,710 --> 00:13:02,780
they want to have a nice environment to

301
00:13:02,780 --> 00:13:04,550
do so and Icefall this type of

302
00:13:04,550 --> 00:13:07,730
environment so we decided to not support

303
00:13:07,730 --> 00:13:09,380
the old browsers and that meant we could

304
00:13:09,380 --> 00:13:11,720
use the new CSS stuff we were finally

305
00:13:11,720 --> 00:13:14,210
free to use flex box and suffolk CSS

306
00:13:14,210 --> 00:13:16,970
grid for layout and whatnot except we

307
00:13:16,970 --> 00:13:19,880
weren't because we want to

308
00:13:19,880 --> 00:13:22,070
have something that looks like this and

309
00:13:22,070 --> 00:13:25,940
with a CSS only solution it didn't work

310
00:13:25,940 --> 00:13:28,850
out that well as Leah mentioned in her

311
00:13:28,850 --> 00:13:32,030
talk just having the CSS only solution

312
00:13:32,030 --> 00:13:34,220
doesn't help you is just so you can say

313
00:13:34,220 --> 00:13:35,780
that you have it but it doesn't do

314
00:13:35,780 --> 00:13:37,910
anything else than be and sometimes it's

315
00:13:37,910 --> 00:13:40,310
wrong as well so instead of using

316
00:13:40,310 --> 00:13:42,410
flexbox and CSS to it we went back to

317
00:13:42,410 --> 00:13:44,720
using an old component of ours it's a

318
00:13:44,720 --> 00:13:47,660
layout component and it is JavaScript

319
00:13:47,660 --> 00:13:51,020
based but it's battle-tested we've been

320
00:13:51,020 --> 00:13:53,300
using this for a long time we figured

321
00:13:53,300 --> 00:13:54,980
out the bugs people who are much smarter

322
00:13:54,980 --> 00:13:59,120
than me fix the bugs and we ship with

323
00:13:59,120 --> 00:14:01,400
this and later after it was ship when we

324
00:14:01,400 --> 00:14:03,680
had more time we went back and found out

325
00:14:03,680 --> 00:14:06,080
what was wrong with flexbox it turns out

326
00:14:06,080 --> 00:14:08,510
that because flexbox has changed so much

327
00:14:08,510 --> 00:14:09,980
over time it's you know its

328
00:14:09,980 --> 00:14:11,510
specification and all that and the

329
00:14:11,510 --> 00:14:15,830
standard it still isn't we had some

330
00:14:15,830 --> 00:14:17,150
static transform tools that were

331
00:14:17,150 --> 00:14:20,270
conflicting with each other and chrome

332
00:14:20,270 --> 00:14:21,680
would sometimes get the new version of

333
00:14:21,680 --> 00:14:24,290
flexbox automatically transform but for

334
00:14:24,290 --> 00:14:25,730
Safari you would get the old version

335
00:14:25,730 --> 00:14:28,190
with the WebKit box and of course that

336
00:14:28,190 --> 00:14:30,020
wouldn't work well what once you figure

337
00:14:30,020 --> 00:14:33,410
out those issues it was okay except for

338
00:14:33,410 --> 00:14:35,540
you know Internet Explorer because

339
00:14:35,540 --> 00:14:37,460
engine explore is to need to specify ms

340
00:14:37,460 --> 00:14:41,420
flex in a 1 10 pixels and it needs to

341
00:14:41,420 --> 00:14:42,920
have pixels there because if you just

342
00:14:42,920 --> 00:14:44,630
say 0 it doesn't know that it doesn't

343
00:14:44,630 --> 00:14:46,310
know what you mean I remember our rule

344
00:14:46,310 --> 00:14:49,250
that strips away the unit from pixels so

345
00:14:49,250 --> 00:14:50,660
we just added a couple of exceptions and

346
00:14:50,660 --> 00:14:53,650
we were fine to go with flexbox flexbox

347
00:14:53,650 --> 00:14:55,550
well we weren't out of the woods yet

348
00:14:55,550 --> 00:14:59,120
because it's a bit product even though

349
00:14:59,120 --> 00:15:01,250
it's it sounds simple it actually has

350
00:15:01,250 --> 00:15:03,830
very many moving parts the shawarma wrap

351
00:15:03,830 --> 00:15:07,280
is very deep and I'm sure you can see

352
00:15:07,280 --> 00:15:10,250
the problem with this and if you miss it

353
00:15:10,250 --> 00:15:13,820
let me blow it up for you as you're

354
00:15:13,820 --> 00:15:17,710
typing in a right-to-left language and

355
00:15:17,710 --> 00:15:20,930
you type in comma space as you do to add

356
00:15:20,930 --> 00:15:24,490
a comma the college's jumps

357
00:15:24,490 --> 00:15:26,860
this is weird we never understood why

358
00:15:26,860 --> 00:15:28,360
and we spend a lot of time just

359
00:15:28,360 --> 00:15:30,580
debugging why this happened we thought

360
00:15:30,580 --> 00:15:33,450
were supposed to some old archaic

361
00:15:33,450 --> 00:15:35,920
components that we weren't including by

362
00:15:35,920 --> 00:15:40,330
mistake but it turned out that it was

363
00:15:40,330 --> 00:15:42,279
our over optimization as many websites

364
00:15:42,279 --> 00:15:44,230
as many web applications we have just

365
00:15:44,230 --> 00:15:46,330
one font definition it's a font family

366
00:15:46,330 --> 00:15:47,589
we have a fun stack and everything's

367
00:15:47,589 --> 00:15:50,670
fine we were using helvetica neue

368
00:15:50,670 --> 00:15:52,810
Helvetica neue actually has this problem

369
00:15:52,810 --> 00:15:54,190
that if you're typing in right to left

370
00:15:54,190 --> 00:15:56,080
and you've having a character character

371
00:15:56,080 --> 00:15:59,080
character comma space character space

372
00:15:59,080 --> 00:16:01,209
and comma will just invert and that

373
00:16:01,209 --> 00:16:03,520
looks very horrible if you're a user

374
00:16:03,520 --> 00:16:06,190
that you know speaks in a right-to-left

375
00:16:06,190 --> 00:16:09,760
written language so instead of using her

376
00:16:09,760 --> 00:16:12,610
veticon know which is the cool thing we

377
00:16:12,610 --> 00:16:14,080
detected if you're using right to left

378
00:16:14,080 --> 00:16:15,490
we don't want you to have a better

379
00:16:15,490 --> 00:16:17,529
experience so we just fall back to REO

380
00:16:17,529 --> 00:16:21,580
REO the old boring REO but the old

381
00:16:21,580 --> 00:16:23,890
boring battle-tested area which has been

382
00:16:23,890 --> 00:16:25,570
improved over time and works well with

383
00:16:25,570 --> 00:16:29,200
anything you throw at it and this was

384
00:16:29,200 --> 00:16:30,339
just something that we just happen to

385
00:16:30,339 --> 00:16:32,640
find out Helvetica neue has this problem

386
00:16:32,640 --> 00:16:34,839
but there are some things within

387
00:16:34,839 --> 00:16:39,940
facebook that got in our way java

388
00:16:39,940 --> 00:16:42,399
subcomponents really like pixels as size

389
00:16:42,399 --> 00:16:45,940
dimensions as they should but remember

390
00:16:45,940 --> 00:16:48,959
we're a full page application pixels

391
00:16:48,959 --> 00:16:51,100
don't work well because you resize the

392
00:16:51,100 --> 00:16:53,620
page a lot you might want to dock it to

393
00:16:53,620 --> 00:16:56,380
the lift and not only that but we need

394
00:16:56,380 --> 00:16:58,899
to accurately display what you have sent

395
00:16:58,899 --> 00:17:00,279
to the other person with which you're

396
00:17:00,279 --> 00:17:02,770
talking if you send them an image we

397
00:17:02,770 --> 00:17:04,809
need to display like this or if you send

398
00:17:04,809 --> 00:17:08,350
more images each case has a different

399
00:17:08,350 --> 00:17:11,740
grid on different sizing and we need to

400
00:17:11,740 --> 00:17:14,740
kind of make it look nice and if we try

401
00:17:14,740 --> 00:17:16,150
to stretch images they will look

402
00:17:16,150 --> 00:17:17,890
horrible and we needed a different

403
00:17:17,890 --> 00:17:20,650
approach also they're always about

404
00:17:20,650 --> 00:17:24,189
roughly half of the other conversation

405
00:17:24,189 --> 00:17:27,250
window even if they're six or just one

406
00:17:27,250 --> 00:17:29,740
in short we needed to be responsive and

407
00:17:29,740 --> 00:17:30,970
that's very hard to do if you're using

408
00:17:30,970 --> 00:17:35,860
pixels so we had to add our own

409
00:17:35,860 --> 00:17:38,880
containers again just so we could

410
00:17:38,880 --> 00:17:41,800
use different CSS classes that were

411
00:17:41,800 --> 00:17:44,140
based on percentages and we couldn't use

412
00:17:44,140 --> 00:17:46,060
a lot of the building blocks that people

413
00:17:46,060 --> 00:17:47,560
on facebook com use out of the box

414
00:17:47,560 --> 00:17:50,950
because they only work with pixels still

415
00:17:50,950 --> 00:17:52,710
though we have four break points oh

416
00:17:52,710 --> 00:17:55,390
that's not a lot but it's kind of a lot

417
00:17:55,390 --> 00:17:58,660
because it's four and we change small

418
00:17:58,660 --> 00:18:01,180
things that every one of them the bigger

419
00:18:01,180 --> 00:18:03,730
thing that you'll notice is the right

420
00:18:03,730 --> 00:18:06,340
hand side information panel if we detect

421
00:18:06,340 --> 00:18:07,840
that we don't that you don't have enough

422
00:18:07,840 --> 00:18:09,730
space to comfortably displayed and also

423
00:18:09,730 --> 00:18:11,260
view the conversation will just

424
00:18:11,260 --> 00:18:12,610
automatically close it for you you can

425
00:18:12,610 --> 00:18:14,380
still open it if you want we have the

426
00:18:14,380 --> 00:18:16,990
button and again if as you expand and

427
00:18:16,990 --> 00:18:19,030
you have more space we automatically

428
00:18:19,030 --> 00:18:22,240
open it for you actually the day we

429
00:18:22,240 --> 00:18:23,590
released we got featured on good

430
00:18:23,590 --> 00:18:25,600
products as you do and a person

431
00:18:25,600 --> 00:18:28,480
literally spent enough time resizing is

432
00:18:28,480 --> 00:18:32,410
browser window back-engineering how we

433
00:18:32,410 --> 00:18:34,750
what the rules for this are and he was

434
00:18:34,750 --> 00:18:37,060
so impressed that we took the time to do

435
00:18:37,060 --> 00:18:38,650
this but this is actually something very

436
00:18:38,650 --> 00:18:41,530
simple it makes a big difference but

437
00:18:41,530 --> 00:18:43,300
it's something simple you can do but if

438
00:18:43,300 --> 00:18:45,160
something is very in your face you can

439
00:18:45,160 --> 00:18:48,240
also be responsive at a smaller scale

440
00:18:48,240 --> 00:18:50,920
titles and messenger even on your phone

441
00:18:50,920 --> 00:18:53,890
app are there centered so we Center the

442
00:18:53,890 --> 00:18:55,510
page title which is messenger but we

443
00:18:55,510 --> 00:18:57,220
also Center the conversation title in

444
00:18:57,220 --> 00:19:00,340
this case it's an unnamed group between

445
00:19:00,340 --> 00:19:03,480
me and two other people with long names

446
00:19:03,480 --> 00:19:05,740
what if you want to dock your window to

447
00:19:05,740 --> 00:19:10,060
the left of your screen truncating

448
00:19:10,060 --> 00:19:11,950
centered text is weird especially if you

449
00:19:11,950 --> 00:19:13,600
have icons on the other side because

450
00:19:13,600 --> 00:19:15,550
they will take up space on evenly and

451
00:19:15,550 --> 00:19:17,800
we'll just look weird and you can't do

452
00:19:17,800 --> 00:19:20,440
it you can't use a CSS only solution for

453
00:19:20,440 --> 00:19:22,150
this because it's not dependent on the

454
00:19:22,150 --> 00:19:23,770
size of the viewport is depend on the

455
00:19:23,770 --> 00:19:26,530
size of the name and the element that

456
00:19:26,530 --> 00:19:27,880
contains in the name and not even

457
00:19:27,880 --> 00:19:30,580
element query if we ever get it will

458
00:19:30,580 --> 00:19:32,560
help us here for this you need of a

459
00:19:32,560 --> 00:19:33,940
hybrid solution you need to measure the

460
00:19:33,940 --> 00:19:36,310
size of the text and measure the size of

461
00:19:36,310 --> 00:19:37,900
the container and when there's not

462
00:19:37,900 --> 00:19:40,000
enough room just change a class named

463
00:19:40,000 --> 00:19:42,010
float everything to the left and apply a

464
00:19:42,010 --> 00:19:45,250
truncation if you need to now we do a

465
00:19:45,250 --> 00:19:47,740
lot of these small things on break

466
00:19:47,740 --> 00:19:49,360
points or when we detect that you don't

467
00:19:49,360 --> 00:19:52,060
have enough space just so everything

468
00:19:52,060 --> 00:19:54,250
nicely and looks nicely it's supposed to

469
00:19:54,250 --> 00:19:56,110
be an app that's on par with the native

470
00:19:56,110 --> 00:19:58,660
experience and that means you need to do

471
00:19:58,660 --> 00:20:00,540
a lot of these little polishing and

472
00:20:00,540 --> 00:20:04,720
speaking of polishing and how we know

473
00:20:04,720 --> 00:20:07,450
titles messenger are centered that's an

474
00:20:07,450 --> 00:20:10,330
interface guide and we have an interface

475
00:20:10,330 --> 00:20:14,980
guy for facebook now please please tell

476
00:20:14,980 --> 00:20:17,200
me you know what this is just say what

477
00:20:17,200 --> 00:20:20,350
it is yes it's a fig right the Facebook

478
00:20:20,350 --> 00:20:23,020
interface guy to fig I showed this to

479
00:20:23,020 --> 00:20:25,840
Americans and they just had no idea what

480
00:20:25,840 --> 00:20:30,100
it was they had not seen figs I went hot

481
00:20:30,100 --> 00:20:31,900
air ballooning and the person though the

482
00:20:31,900 --> 00:20:34,030
pilot dropped the balloon so we could

483
00:20:34,030 --> 00:20:36,670
just brush against some walnut trees you

484
00:20:36,670 --> 00:20:39,010
know walnuts and he said you know if you

485
00:20:39,010 --> 00:20:40,180
reach how you can actually grab some

486
00:20:40,180 --> 00:20:41,770
walnut so I did and I grabbed the walnut

487
00:20:41,770 --> 00:20:44,320
and was all still green and only me and

488
00:20:44,320 --> 00:20:46,240
the pilot knew that that's what walnuts

489
00:20:46,240 --> 00:20:48,010
looked like Americans are weird they

490
00:20:48,010 --> 00:20:49,570
don't know what fruit looks like in any

491
00:20:49,570 --> 00:20:51,070
case that's the fig that's the facebook

492
00:20:51,070 --> 00:20:52,660
in your face guide and we have a

493
00:20:52,660 --> 00:20:54,760
different product it's a messenger thing

494
00:20:54,760 --> 00:20:57,520
so you get the reference i'm trying to

495
00:20:57,520 --> 00:21:01,570
make we have the mig the messenger

496
00:21:01,570 --> 00:21:05,350
interface guide and that's just a visual

497
00:21:05,350 --> 00:21:07,240
style guide of how things should look

498
00:21:07,240 --> 00:21:09,250
like a different combinations and all

499
00:21:09,250 --> 00:21:12,370
that normally it's made by a designer we

500
00:21:12,370 --> 00:21:13,840
found that it's a lot better to be made

501
00:21:13,840 --> 00:21:16,240
by people who are working on the product

502
00:21:16,240 --> 00:21:17,740
not just the design is not just the

503
00:21:17,740 --> 00:21:19,540
developers with everybody involved

504
00:21:19,540 --> 00:21:21,940
because some things make sense the

505
00:21:21,940 --> 00:21:23,290
designers somethings are very cool to

506
00:21:23,290 --> 00:21:25,060
design two designers but don't make

507
00:21:25,060 --> 00:21:26,590
sense to implement or just don't make

508
00:21:26,590 --> 00:21:29,290
sense for people to use in any case we

509
00:21:29,290 --> 00:21:31,560
took some of the facebook components and

510
00:21:31,560 --> 00:21:33,700
turn them into our own components

511
00:21:33,700 --> 00:21:37,830
remember how when Chad was rewritten

512
00:21:37,830 --> 00:21:40,120
everything was a container and a

513
00:21:40,120 --> 00:21:42,370
presenter that's kind of how we do

514
00:21:42,370 --> 00:21:45,820
components everywhere we have an

515
00:21:45,820 --> 00:21:47,410
abstract thing and something that gives

516
00:21:47,410 --> 00:21:50,170
a presentation and we were able to take

517
00:21:50,170 --> 00:21:51,760
the Facebook button turn into a

518
00:21:51,760 --> 00:21:54,070
messenger button which looks a lot like

519
00:21:54,070 --> 00:21:57,160
a button I know I'm sorry but you can

520
00:21:57,160 --> 00:21:59,200
see you know facebook facebook on the

521
00:21:59,200 --> 00:22:01,270
left messenger on the right even though

522
00:22:01,270 --> 00:22:03,190
it's the same component underneath and

523
00:22:03,190 --> 00:22:05,380
that's great because the facebook

524
00:22:05,380 --> 00:22:06,010
components

525
00:22:06,010 --> 00:22:07,480
have undergone a lot of work to make

526
00:22:07,480 --> 00:22:09,340
them accessible you have we have a lot

527
00:22:09,340 --> 00:22:12,820
of customization for Aria roles and for

528
00:22:12,820 --> 00:22:14,200
screen readers to be able to properly

529
00:22:14,200 --> 00:22:16,060
detect them and their states and we

530
00:22:16,060 --> 00:22:18,280
wanted to get all that good stuff over

531
00:22:18,280 --> 00:22:20,590
the messenger I want to take just a

532
00:22:20,590 --> 00:22:24,310
short time to emphasize accessibility we

533
00:22:24,310 --> 00:22:26,380
need more of this doesn't matter if it

534
00:22:26,380 --> 00:22:28,960
looks good if you can't see it you need

535
00:22:28,960 --> 00:22:33,190
to be able to use something and another

536
00:22:33,190 --> 00:22:35,380
thing that's bad also focus ability but

537
00:22:35,380 --> 00:22:38,230
just bad as an element is my new

538
00:22:38,230 --> 00:22:41,500
favorite element the hate lets the image

539
00:22:41,500 --> 00:22:45,970
tag let's go back to this example the

540
00:22:45,970 --> 00:22:47,860
images here are you know the basically

541
00:22:47,860 --> 00:22:51,400
shawarmas but they're each a different

542
00:22:51,400 --> 00:22:52,870
image but we need to display them in a

543
00:22:52,870 --> 00:22:54,910
nice grid if we would have a jagged

544
00:22:54,910 --> 00:22:56,530
thing it would be horrible if we display

545
00:22:56,530 --> 00:22:58,060
them one by one it would take up too

546
00:22:58,060 --> 00:22:59,530
much space and use your contacts of your

547
00:22:59,530 --> 00:23:03,070
conversation so we need to you know

548
00:23:03,070 --> 00:23:05,020
sighs them evenly which is not always

549
00:23:05,020 --> 00:23:07,570
possible with image tags if you also

550
00:23:07,570 --> 00:23:09,790
want to make the images look nice and

551
00:23:09,790 --> 00:23:13,420
then we have other use cases where with

552
00:23:13,420 --> 00:23:14,560
your share a link will show you a

553
00:23:14,560 --> 00:23:16,200
preview of what that link is and

554
00:23:16,200 --> 00:23:18,280
sometimes the link will have a thumbnail

555
00:23:18,280 --> 00:23:21,040
in this case yes hot-plug that's me I'm

556
00:23:21,040 --> 00:23:25,570
sexy but I have a square image as my

557
00:23:25,570 --> 00:23:28,420
profile although over here is displayed

558
00:23:28,420 --> 00:23:31,780
in this nice wide ratio that we decided

559
00:23:31,780 --> 00:23:33,430
would look best for all images there are

560
00:23:33,430 --> 00:23:36,310
big enough to be displayed like this but

561
00:23:36,310 --> 00:23:37,630
it's a square image being displayed as

562
00:23:37,630 --> 00:23:39,340
wide but what happens if you don't have

563
00:23:39,340 --> 00:23:41,470
a big enough image well we fall back to

564
00:23:41,470 --> 00:23:44,230
a different more in line version we just

565
00:23:44,230 --> 00:23:46,360
use the icon and we stretch it in a

566
00:23:46,360 --> 00:23:48,730
different way you can't do this with

567
00:23:48,730 --> 00:23:52,480
images and live a sane life so we just

568
00:23:52,480 --> 00:23:54,730
obviously use background size we still

569
00:23:54,730 --> 00:23:57,400
have invisible images on top so you can

570
00:23:57,400 --> 00:23:59,200
still drag and drop things and we still

571
00:23:59,200 --> 00:24:00,820
have links around them so you can open a

572
00:24:00,820 --> 00:24:02,830
new tab right there so the accessibility

573
00:24:02,830 --> 00:24:03,940
there is still there but the

574
00:24:03,940 --> 00:24:05,140
presentation there well it looks like

575
00:24:05,140 --> 00:24:07,810
the people who can see it's a lot nicer

576
00:24:07,810 --> 00:24:10,450
and it's also something we control and

577
00:24:10,450 --> 00:24:12,520
that is MIG compliant the messager

578
00:24:12,520 --> 00:24:14,920
interface guide and we do everything we

579
00:24:14,920 --> 00:24:16,960
can CSS to make sure to set it up and

580
00:24:16,960 --> 00:24:19,190
then we close the deal in Chavez

581
00:24:19,190 --> 00:24:21,500
some things you can't do in CSS like

582
00:24:21,500 --> 00:24:23,450
this especially if you have a lot of

583
00:24:23,450 --> 00:24:25,880
dynamic data and because we have these

584
00:24:25,880 --> 00:24:28,550
polite little building blocks we can do

585
00:24:28,550 --> 00:24:31,880
cool things I have interactive maps that

586
00:24:31,880 --> 00:24:33,830
respect are an interface guide and

587
00:24:33,830 --> 00:24:35,180
respect the Facebook interface guide on

588
00:24:35,180 --> 00:24:37,550
facebook look at the look at the corners

589
00:24:37,550 --> 00:24:39,050
they're all nice and rounded therefore

590
00:24:39,050 --> 00:24:40,610
when the corners meet up there in the

591
00:24:40,610 --> 00:24:43,490
top this is also partly interface guide

592
00:24:43,490 --> 00:24:44,960
but you get this for free if you just

593
00:24:44,960 --> 00:24:46,460
use our components because they're all

594
00:24:46,460 --> 00:24:48,290
very small and all do just one little

595
00:24:48,290 --> 00:24:51,590
thing you can have simple attachments

596
00:24:51,590 --> 00:24:53,740
that just say hey here's my opinion or

597
00:24:53,740 --> 00:24:57,020
you can have nice stunning-looking

598
00:24:57,020 --> 00:25:00,920
images that retailers would like you to

599
00:25:00,920 --> 00:25:03,080
still experience after you've left their

600
00:25:03,080 --> 00:25:05,180
shop and you get notifications yes you

601
00:25:05,180 --> 00:25:07,190
know you bought this belt is on its way

602
00:25:07,190 --> 00:25:10,400
great and people who have built these

603
00:25:10,400 --> 00:25:12,860
things that aren't on our team tell us

604
00:25:12,860 --> 00:25:14,150
that they really enjoy building stuff

605
00:25:14,150 --> 00:25:15,650
from messenger calm because of how easy

606
00:25:15,650 --> 00:25:17,690
it is just use the small components that

607
00:25:17,690 --> 00:25:19,840
we've built and the CSS is very small

608
00:25:19,840 --> 00:25:24,230
but does its job very well but that's

609
00:25:24,230 --> 00:25:25,970
not the best thing the best thing that

610
00:25:25,970 --> 00:25:29,210
we've we feel that we've done is we were

611
00:25:29,210 --> 00:25:32,030
the first secondary domain everything

612
00:25:32,030 --> 00:25:34,220
you saw is basically Facebook code

613
00:25:34,220 --> 00:25:36,800
running on a domain that is in facebook

614
00:25:36,800 --> 00:25:38,660
and they'll never be able to take that

615
00:25:38,660 --> 00:25:41,480
away from us so do try messenger calm

616
00:25:41,480 --> 00:25:43,790
and let us know what you think we'll be

